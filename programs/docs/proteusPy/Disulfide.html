<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 13.0.0"/>
    <title>proteusPy.Disulfide API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../proteusPy.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;proteusPy</a>

            <img src="./logo.png" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



        <h2>API Documentation</h2>
            <ul class="memberlist">
            <li>
                    <a class="class" href="#Disulfide">Disulfide</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Disulfide.__init__">Disulfide</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.bounding_box">bounding_box</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.build_model">build_model</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.cofmass">cofmass</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.copy">copy</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.compute_extents">compute_extents</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.compute_local_coords">compute_local_coords</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.compute_torsional_energy">compute_torsional_energy</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.display">display</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.Distance_neighbors">Distance_neighbors</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.Distance_RMS">Distance_RMS</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.get_chains">get_chains</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.get_permissive">get_permissive</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.get_full_id">get_full_id</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.initialize_disulfide_from_chain">initialize_disulfide_from_chain</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.internal_coords">internal_coords</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.internal_coords_res">internal_coords_res</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.make_movie">make_movie</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.pprint">pprint</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.pprint_all">pprint_all</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.repr_ss_info">repr_ss_info</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.repr_ss_coords">repr_ss_coords</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.repr_ss_conformation">repr_ss_conformation</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.repr_ss_local_coords">repr_ss_local_coords</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.repr_ss_chain_ids">repr_ss_chain_ids</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.repr_ss_ca_dist">repr_ss_ca_dist</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.repr_ss_cb_dist">repr_ss_cb_dist</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.repr_ss_torsion_length">repr_ss_torsion_length</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.repr_all">repr_all</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.repr_compact">repr_compact</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.repr_conformation">repr_conformation</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.repr_coords">repr_coords</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.repr_internal_coords">repr_internal_coords</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.repr_chain_ids">repr_chain_ids</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.compute_rho">compute_rho</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.reset">reset</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.same_chains">same_chains</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.screenshot">screenshot</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.set_permissive">set_permissive</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.set_positions">set_positions</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.set_dihedrals">set_dihedrals</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.set_name">set_name</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.set_resnum">set_resnum</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.Torsion_Length">Torsion_Length</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.Torsion_Distance">Torsion_Distance</a>
                        </li>
                        <li>
                                <a class="function" href="#Disulfide.Torsion_neighbors">Torsion_neighbors</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#parse_ssbond_header_rec">parse_ssbond_header_rec</a>
            </li>
            <li>
                    <a class="function" href="#Download_Disulfides">Download_Disulfides</a>
            </li>
            <li>
                    <a class="function" href="#Extract_Disulfides">Extract_Disulfides</a>
            </li>
            <li>
                    <a class="function" href="#check_header_from_file">check_header_from_file</a>
            </li>
            <li>
                    <a class="function" href="#check_header_from_id">check_header_from_id</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../proteusPy.html">proteusPy</a><wbr>.Disulfide    </h1>

                        <div class="docstring"><p>This module, <em>Disulfide</em>, is part of the proteusPy package, a Python package for 
the analysis and modeling of protein structures, with an emphasis on disulfide bonds.
It represents the core of the current implementation of <em>proteusPy</em>.</p>

<p>This work is based on the original C/C++ implementation by Eric G. Suchanek. </p>

<p>Author: Eric G. Suchanek, PhD
Last revision: 2/14/2023</p>
</div>

                        <input id="mod-Disulfide-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-Disulfide-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="sd">This module, *Disulfide*, is part of the proteusPy package, a Python package for </span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="sd">the analysis and modeling of protein structures, with an emphasis on disulfide bonds.</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="sd">It represents the core of the current implementation of *proteusPy*.</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="sd">This work is based on the original C/C++ implementation by Eric G. Suchanek. \n</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="sd">Author: Eric G. Suchanek, PhD</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="sd">Last revision: 2/14/2023</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="c1"># Cα N, Cα, Cβ, C&#39;, Sγ Å ° ρ</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="n">__pdoc__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;__all__&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="kn">import</span> <span class="nn">math</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="kn">import</span> <span class="nn">copy</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">cos</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a><span class="kn">import</span> <span class="nn">pickle</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="kn">import</span> <span class="nn">pyvista</span> <span class="k">as</span> <span class="nn">pv</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="n">pv</span><span class="o">.</span><span class="n">global_theme</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a><span class="kn">import</span> <span class="nn">proteusPy</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="kn">from</span> <span class="nn">proteusPy</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a><span class="kn">from</span> <span class="nn">proteusPy.atoms</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a><span class="kn">from</span> <span class="nn">proteusPy.data</span> <span class="kn">import</span> <span class="n">SS_DICT_PICKLE_FILE</span><span class="p">,</span> <span class="n">SS_ID_FILE</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="kn">from</span> <span class="nn">proteusPy.data</span> <span class="kn">import</span> <span class="n">SS_PICKLE_FILE</span><span class="p">,</span> <span class="n">SS_TORSIONS_FILE</span><span class="p">,</span> <span class="n">PROBLEM_ID_FILE</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a><span class="kn">from</span> <span class="nn">proteusPy.DisulfideExceptions</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="kn">from</span> <span class="nn">proteusPy.DisulfideList</span> <span class="kn">import</span> <span class="n">DisulfideList</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a><span class="kn">from</span> <span class="nn">proteusPy.utility</span> <span class="kn">import</span> <span class="n">distance3d</span><span class="p">,</span> <span class="n">prune_extra_ss</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a><span class="kn">from</span> <span class="nn">proteusPy.ProteusGlobals</span> <span class="kn">import</span> <span class="n">PDB_DIR</span><span class="p">,</span> <span class="n">MODEL_DIR</span><span class="p">,</span> <span class="n">WINSIZE</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a><span class="kn">from</span> <span class="nn">Bio.PDB</span> <span class="kn">import</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">PDBParser</span><span class="p">,</span> <span class="n">PDBList</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a><span class="kn">from</span> <span class="nn">Bio.PDB.vectors</span> <span class="kn">import</span> <span class="n">calc_dihedral</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a><span class="c1"># float init for class </span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a><span class="n">_FLOAT_INIT</span> <span class="o">=</span> <span class="o">-</span><span class="mf">999.9</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a><span class="n">_ANG_INIT</span> <span class="o">=</span> <span class="o">-</span><span class="mf">180.0</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="c1"># tqdm progress bar width</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a><span class="kn">from</span> <span class="nn">proteusPy.ProteusGlobals</span> <span class="kn">import</span> <span class="n">PBAR_COLS</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a><span class="c1"># columns for the torsions file dataframe.</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a><span class="k">global</span> <span class="n">Torsion_DF_Cols</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a><span class="n">Torsion_DF_Cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">,</span> <span class="s1">&#39;ss_id&#39;</span><span class="p">,</span> <span class="s1">&#39;proximal&#39;</span><span class="p">,</span> <span class="s1">&#39;distal&#39;</span><span class="p">,</span> <span class="s1">&#39;chi1&#39;</span><span class="p">,</span> <span class="s1">&#39;chi2&#39;</span><span class="p">,</span> <span class="s1">&#39;chi3&#39;</span><span class="p">,</span> <span class="s1">&#39;chi4&#39;</span><span class="p">,</span> \
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a>           <span class="s1">&#39;chi5&#39;</span><span class="p">,</span> <span class="s1">&#39;energy&#39;</span><span class="p">,</span> <span class="s1">&#39;ca_distance&#39;</span><span class="p">,</span><span class="s1">&#39;cb_distance&#39;</span><span class="p">,</span> <span class="s1">&#39;phi_prox&#39;</span><span class="p">,</span> <span class="s1">&#39;psi_prox&#39;</span><span class="p">,</span> <span class="s1">&#39;phi_dist&#39;</span><span class="p">,</span>\
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>           <span class="s1">&#39;psi_dist&#39;</span><span class="p">,</span> <span class="s1">&#39;torsion_length&#39;</span><span class="p">,</span> <span class="s1">&#39;rho&#39;</span><span class="p">]</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a><span class="k">class</span> <span class="nc">Disulfide</span><span class="p">:</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a><span class="sd">    This class provides a Python object and methods representing a physical disulfide bond </span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a><span class="sd">    either extracted from the RCSB protein databank or built using the </span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a><span class="sd">    [proteusPy.Turtle3D](turtle3D.html) class. The disulfide bond is an important</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a><span class="sd">    intermolecular stabilizing structural element and is characterized by:</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a><span class="sd">    * Atomic coordinates for the atoms N, Cα, Cβ, C&#39;, Sγ for both residues. </span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a><span class="sd">    These are stored as both raw atomic coordinates as read from the RCSB file </span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="sd">    and internal local coordinates.</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a><span class="sd">    * The dihedral angles Χ1 - Χ5 for the disulfide bond</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a><span class="sd">    * A name, by default {pdb_id}{prox_resnumb}{prox_chain}_{distal_resnum}{distal_chain} </span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a><span class="sd">    * Proximal residue number</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="sd">    * Distal residue number</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a><span class="sd">    * Approximate bond torsional energy (kcal/mol):</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a><span class="sd">    </span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a><span class="sd">    $$ </span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a><span class="sd">    E_{kcal/mol} \\approx 2.0 * cos(3.0 * \\chi_{1}) + cos(3.0 * \\chi_{5}) + cos(3.0 * \\chi_{2}) + </span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a><span class="sd">    $$</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a><span class="sd">    $$</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a><span class="sd">    cos(3.0 * \\chi_{4}) + 3.5 * cos(2.0 * \\chi_{3}) + 0.6 * cos(3.0 * \\chi_{3}) + 10.1 </span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a><span class="sd">    $$</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a><span class="sd">    </span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a><span class="sd">    The equation embodies the typical 3-fold rotation barriers associated with single bonds,</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a><span class="sd">    (Χ1, Χ5, Χ2, Χ4) and a high 2-fold barrier for Χ3, resulting from the partial double bond</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a><span class="sd">    character of the S-S bond. This property leads to two major disulfide families, characterized</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a><span class="sd">    by the sign of Χ3. *Left-handed* disulfides have Χ3 &lt; 0° and *right-handed* disulfides have</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a><span class="sd">    Χ3 &gt; 0°. Within this breakdown there are numerous subfamilies, broadly known as the *hook*,</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a><span class="sd">    *spiral* and *staple*. These are under characgterization.</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a><span class="sd">    * Euclidean length of the dihedral angles (degrees) defined as:</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a><span class="sd">    $$\\sqrt(\\chi_{1}^{2} + \\chi_{2}^{2} + \\chi_{3}^{2} + \\chi_{4}^{2} + \\chi_{5}^{2})$$</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a><span class="sd">    * Cα - Cα distance (Å)</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a><span class="sd">    * The previous C&#39; and next N for both the proximal and distal residues. These are needed</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a><span class="sd">    to calculate the backbone dihedral angles Φ and Ψ.</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a><span class="sd">    * Backbone dihedral angles Φ and Ψ, when possible. Not all structures are complete and</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a><span class="sd">    in those cases the atoms needed may be undefined. In this case the Φ and Ψ angles are set</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a><span class="sd">    to -180°.</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a><span class="sd">    </span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a><span class="sd">    The class also provides a rendering capabilities using the excellent [PyVista](https://pyvista.org)</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a><span class="sd">    library, and can display disulfides interactively in a variety of display styles:</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a><span class="sd">    * &#39;sb&#39; - Split Bonds style - bonds colored by their atom type</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a><span class="sd">    * &#39;bs&#39; - Ball and Stick style - split bond coloring with small atoms</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a><span class="sd">    * &#39;pd&#39; - Proximal/Distal style - bonds colored *Red* for proximal residue and *Green* for</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a><span class="sd">    the distal residue.</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a><span class="sd">    * &#39;cpk&#39; - CPK style rendering, colored by atom type:</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a><span class="sd">        * Carbon   - Grey</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a><span class="sd">        * Nitrogen - Blue</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a><span class="sd">        * Sulfur   - Yellow</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a><span class="sd">        * Oxygen   - Red</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a><span class="sd">        * Hydrogen - White </span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a><span class="sd">    </span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a><span class="sd">    Individual displays can be saved to a file, and animations created.</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;SSBOND&quot;</span><span class="p">,</span> <span class="n">proximal</span><span class="p">:</span> <span class="nb">int</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a>                <span class="n">distal</span><span class="p">:</span> <span class="nb">int</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">proximal_chain</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a>                <span class="n">distal_chain</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">pdb_id</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;1egs&#39;</span><span class="p">,</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a>                <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">permissive</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>                <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a><span class="sd">        __init__ Initialize the class to defined internal values.</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a><span class="sd">        :param name: Disulfide name, by default &quot;SSBOND&quot;</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a><span class="sd">            </span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal</span> <span class="o">=</span> <span class="n">proximal</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal</span> <span class="o">=</span> <span class="n">distal</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="n">_FLOAT_INIT</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal_chain</span> <span class="o">=</span> <span class="n">proximal_chain</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal_chain</span> <span class="o">=</span> <span class="n">distal_chain</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_id</span> <span class="o">=</span> <span class="n">pdb_id</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal_residue_fullid</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal_residue_fullid</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">PERMISSIVE</span> <span class="o">=</span> <span class="n">permissive</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">QUIET</span> <span class="o">=</span> <span class="n">quiet</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span> <span class="o">=</span> <span class="n">_FLOAT_INIT</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_distance</span> <span class="o">=</span> <span class="n">_FLOAT_INIT</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">_ANG_INIT</span><span class="p">,</span> <span class="n">_ANG_INIT</span><span class="p">,</span> <span class="n">_ANG_INIT</span><span class="p">,</span> 
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a>        								  <span class="n">_ANG_INIT</span><span class="p">,</span> <span class="n">_ANG_INIT</span><span class="p">))</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">phiprox</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">psiprox</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">phidist</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">psidist</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>        <span class="c1"># global coordinates for the Disulfide, typically as </span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>        <span class="c1"># returned from the PDB file</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">o_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">o_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>        <span class="c1"># set when we can&#39;t find previous or next prox or distal</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>        <span class="c1"># C&#39; or N atoms.</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">missing_atoms</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modelled</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>        <span class="c1"># need these to calculate backbone dihedral angles</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prev_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_next_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prev_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_next_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>        <span class="c1"># local coordinates for the Disulfide, computed using the Turtle3D in </span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>        <span class="c1"># Orientation #1. these are generally private.</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ca_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_o_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cb_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sg_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sg_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cb_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ca_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_o_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>        <span class="c1"># need these to calculate backbone dihedral angles</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_prev_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_next_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_prev_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_next_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>        <span class="c1"># Dihedral angles for the disulfide bond itself, set to _ANG_INIT</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi1</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi2</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi4</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi5</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span> <span class="n">_ANG_INIT</span> <span class="c1"># new dihedral angle: Nprox - Ca_prox - Ca_dist - N_dist</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span> <span class="o">=</span> <span class="n">_FLOAT_INIT</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>    
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a>    <span class="c1"># comparison operators, used for sorting. keyed to SS bond energy</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a>    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Disulfide</span><span class="p">):</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">energy</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Disulfide</span><span class="p">):</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">energy</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>    
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Disulfide</span><span class="p">):</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">energy</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Disulfide</span><span class="p">):</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">energy</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Disulfide</span><span class="p">):</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">energy</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Disulfide</span><span class="p">):</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">energy</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>    
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a><span class="sd">        Representation for the Disulfide class</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_info</span><span class="p">()</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s1</span><span class="si">}</span><span class="s1">&gt;&#39;</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>    
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>    <span class="k">def</span> <span class="nf">_render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pvplot</span><span class="p">:</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;bs&#39;</span><span class="p">,</span> <span class="n">plain</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>            <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>            <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>            <span class="n">bond_radius</span><span class="o">=</span><span class="n">BOND_RADIUS</span><span class="p">,</span> <span class="n">res</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a><span class="sd">        Update the passed pyVista plotter() object with the mesh data for the</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a><span class="sd">        input Disulfide Bond. Used internally</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a><span class="sd">        Parameters</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a><span class="sd">        ----------</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a><span class="sd">        pvplot : pv.Plotter</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a><span class="sd">            pyvista.Plotter object</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a><span class="sd">        style : str, optional</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a><span class="sd">            Rendering style, by default &#39;bs&#39;. One of &#39;bs&#39;, &#39;st&#39;, &#39;cpk&#39;, Render as \</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a><span class="sd">            CPK, ball-and-stick or stick. Bonds are colored by atom color, unless \</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a><span class="sd">            &#39;plain&#39; is specified.</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a><span class="sd">        plain : bool, optional</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a><span class="sd">            Used internally, by default False</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a><span class="sd">        bondcolor : pyVista color name, optional bond color for simple bonds, by default BOND_COLOR</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a><span class="sd">        bs_scale : float, optional</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a><span class="sd">            scale factor (0-1) to reduce the atom sizes for ball and stick, by default BS_SCALE</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a><span class="sd">        </span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a><span class="sd">        spec : float, optional</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a><span class="sd">            specularity (0-1), where 1 is totally smooth and 0 is rough, by default SPECULARITY</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a><span class="sd">        specpow : int, optional</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a><span class="sd">            exponent used for specularity calculations, by default SPEC_POWER</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a><span class="sd">        translate : bool, optional</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a><span class="sd">            Flag used internally to indicate if we should translate \</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a><span class="sd">            the disulfide to its geometric center of mass, by default True.</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a><span class="sd">        Returns</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a><span class="sd">        -------</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a><span class="sd">        pv.Plotter</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a><span class="sd">            Updated pv.Plotter object with atoms and bonds.</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>        
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>        <span class="n">_bradius</span> <span class="o">=</span> <span class="n">bond_radius</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>        <span class="n">coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_coords</span><span class="p">()</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>        <span class="n">missing_atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing_atoms</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>        <span class="n">clen</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modelled</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>        <span class="k">if</span> <span class="n">model</span><span class="p">:</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>            <span class="n">all_atoms</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>            <span class="n">all_atoms</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>        <span class="k">if</span> <span class="n">translate</span><span class="p">:</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>            <span class="n">cofmass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cofmass</span><span class="p">()</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">clen</span><span class="p">):</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>                <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">cofmass</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>        
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>        <span class="n">atoms</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;SG&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>        		 <span class="s1">&#39;SG&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">)</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a>        <span class="n">pvp</span> <span class="o">=</span> <span class="n">pvplot</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a>        
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a>        <span class="c1"># bond connection table with atoms in the specific order shown above: </span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>        <span class="c1"># returned by ss.get_internal_coords()</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a>        
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>        <span class="k">def</span> <span class="nf">draw_bonds</span><span class="p">(</span><span class="n">pvp</span><span class="p">,</span> <span class="n">bradius</span><span class="o">=</span><span class="n">BOND_RADIUS</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span> 
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>        			   <span class="n">bcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">all_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>                       <span class="n">res</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>            <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a><span class="sd">            Generate the appropriate pyVista cylinder objects to represent</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a><span class="sd">            a particular disulfide bond. This utilizes a connection table </span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a><span class="sd">            for the starting and ending atoms and a color table for the </span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a><span class="sd">            bond colors. Used internally.</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a><span class="sd">            :param pvp: input plotter object to be updated</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a><span class="sd">            :param bradius: bond radius</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a><span class="sd">            :param style: bond style. One of sb, plain, pd</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a><span class="sd">            :param bcolor: pyvista color</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a><span class="sd">            :param missing: True if atoms are missing, False othersie</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a><span class="sd">            :param all_atoms: True if rendering O, False if only backbone rendered</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a><span class="sd">            </span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a><span class="sd">            :return pvp: Updated Plotter object.</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a><span class="sd">                </span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a><span class="sd">            &#39;&#39;&#39;</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>            <span class="n">_bond_conn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>            <span class="p">[</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>                <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># n-ca</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>                <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="c1"># ca-c</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>                <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="c1"># c-o</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>                <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="c1"># ca-cb</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>                <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="c1"># cb-sg</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>                <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="c1"># n-ca</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>                <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="c1"># ca-c</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>                <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="c1"># c-o</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>                <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="c1"># ca-cb</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a>                <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="c1"># cb-sg</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>                <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>  <span class="c1"># sg -sg</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a>                <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># cprev_prox-n</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a>                <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>  <span class="c1"># c-nnext_prox</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a>                <span class="p">[</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>   <span class="c1"># cprev_dist-n_dist</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>                <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">15</span><span class="p">]</span>    <span class="c1"># c-nnext_dist</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>            <span class="p">])</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a>            <span class="c1"># modeled disulfides only have backbone atoms since</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>            <span class="c1"># phi and psi are undefined, which makes the carbonyl</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a>            <span class="c1"># oxygen (O) undefined as well. Their previous and next N</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a>            <span class="c1"># are also undefined.</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>            <span class="n">_bond_conn_backbone</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>            <span class="p">[</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a>                <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># n-ca</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>                <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="c1"># ca-c</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>                <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="c1"># ca-cb</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>                <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="c1"># cb-sg</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>                <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="c1"># n-ca</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a>                <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="c1"># ca-c</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a>                <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="c1"># ca-cb</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>                <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="c1"># cb-sg</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>                <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>  <span class="c1"># sg -sg</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>            <span class="p">])</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>            
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>            <span class="c1"># colors for the bonds. Index into ATOM_COLORS array</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>            <span class="n">_bond_split_colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>                <span class="p">[</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>                    <span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">),</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;SG&#39;</span><span class="p">),</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>                    <span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">),</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;SG&#39;</span><span class="p">),</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>                    <span class="p">(</span><span class="s1">&#39;SG&#39;</span><span class="p">,</span> <span class="s1">&#39;SG&#39;</span><span class="p">),</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>                    <span class="c1"># prev and next C-N bonds - color by atom Z</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">),</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">),</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">),</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">)</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>                <span class="p">]</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>            <span class="p">)</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>            <span class="n">_bond_split_colors_backbone</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>                <span class="p">[</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>                    <span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;SG&#39;</span><span class="p">),</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>                    <span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;SG&#39;</span><span class="p">),</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>                    <span class="p">(</span><span class="s1">&#39;SG&#39;</span><span class="p">,</span> <span class="s1">&#39;SG&#39;</span><span class="p">),</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>                <span class="p">]</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>            <span class="p">)</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>            <span class="c1"># work through connectivity and colors</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>            <span class="n">orig_col</span> <span class="o">=</span> <span class="n">dest_col</span> <span class="o">=</span> <span class="n">bcolor</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>            <span class="k">if</span> <span class="n">all_atoms</span><span class="p">:</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>                <span class="n">bond_conn</span> <span class="o">=</span> <span class="n">_bond_conn</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>                <span class="n">bond_split_colors</span> <span class="o">=</span> <span class="n">_bond_split_colors</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>                <span class="n">bond_conn</span> <span class="o">=</span> <span class="n">_bond_conn_backbone</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>                <span class="n">bond_split_colors</span> <span class="o">=</span> <span class="n">_bond_split_colors_backbone</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bond_conn</span><span class="p">)):</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>                <span class="k">if</span> <span class="n">all_atoms</span><span class="p">:</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="ow">and</span> <span class="n">missing_atoms</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> <span class="c1"># skip missing atoms</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>                        <span class="k">continue</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>                
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>                <span class="n">bond</span> <span class="o">=</span> <span class="n">bond_conn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>                <span class="c1"># get the indices for the origin and destination atoms</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>                <span class="n">orig</span> <span class="o">=</span> <span class="n">bond</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>                <span class="n">dest</span> <span class="o">=</span> <span class="n">bond</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>                <span class="n">col</span> <span class="o">=</span> <span class="n">bond_split_colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>                <span class="c1"># get the coords</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>                <span class="n">prox_pos</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="n">orig</span><span class="p">]</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>                <span class="n">distal_pos</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="n">dest</span><span class="p">]</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a>                
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>                <span class="c1"># compute a direction vector</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>                <span class="n">direction</span> <span class="o">=</span> <span class="n">distal_pos</span> <span class="o">-</span> <span class="n">prox_pos</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>                <span class="c1"># compute vector length. divide by 2 since split bond</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>                <span class="n">height</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">prox_pos</span><span class="p">,</span> <span class="n">distal_pos</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>				<span class="c1"># the cylinder origins are actually in the </span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a>				<span class="c1"># middle so we translate</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>                
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>                <span class="n">origin</span> <span class="o">=</span> <span class="n">prox_pos</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">direction</span> <span class="c1"># for a single plain bond</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>                <span class="n">origin1</span> <span class="o">=</span> <span class="n">prox_pos</span> <span class="o">+</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">direction</span> 
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>                <span class="n">origin2</span> <span class="o">=</span> <span class="n">prox_pos</span> <span class="o">+</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="n">direction</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>                
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>                <span class="n">bradius</span> <span class="o">=</span> <span class="n">_bradius</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>                <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;plain&#39;</span><span class="p">:</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>                    <span class="n">orig_col</span> <span class="o">=</span> <span class="n">dest_col</span> <span class="o">=</span> <span class="n">bcolor</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>                
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>                <span class="c1"># proximal-distal red/green coloring</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>                <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;pd&#39;</span><span class="p">:</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>                    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">4</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">11</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>                        <span class="n">orig_col</span> <span class="o">=</span> <span class="n">dest_col</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>                        <span class="n">orig_col</span> <span class="o">=</span> <span class="n">dest_col</span><span class="o">=</span> <span class="s1">&#39;green&#39;</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>                        <span class="n">orig_col</span> <span class="o">=</span> <span class="n">dest_col</span><span class="o">=</span> <span class="s1">&#39;yellow&#39;</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>                    <span class="n">orig_col</span> <span class="o">=</span> <span class="n">ATOM_COLORS</span><span class="p">[</span><span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>                    <span class="n">dest_col</span> <span class="o">=</span> <span class="n">ATOM_COLORS</span><span class="p">[</span><span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">11</span><span class="p">:</span> <span class="c1"># prev and next residue atoms for phi/psi calcs</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>                    <span class="n">bradius</span> <span class="o">=</span> <span class="n">_bradius</span> <span class="o">*</span> <span class="mf">.5</span> <span class="c1"># make smaller to distinguish</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>                
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>                <span class="n">cap1</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Sphere</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">prox_pos</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">bradius</span><span class="p">)</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>                <span class="n">cap2</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Sphere</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">distal_pos</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">bradius</span><span class="p">)</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>                <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;plain&#39;</span><span class="p">:</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>                    <span class="n">cyl</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Cylinder</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">bradius</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="o">*</span><span class="mf">2.0</span><span class="p">)</span> 
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>                    <span class="n">pvp</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">cyl</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">orig_col</span><span class="p">)</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>                    <span class="n">cyl1</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Cylinder</span><span class="p">(</span><span class="n">origin1</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">bradius</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="n">capping</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="n">res</span><span class="p">)</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>                    <span class="n">cyl2</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Cylinder</span><span class="p">(</span><span class="n">origin2</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">bradius</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="n">capping</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="n">res</span><span class="p">)</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>                    <span class="n">pvp</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">cyl1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">orig_col</span><span class="p">)</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>                    <span class="n">pvp</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">cyl2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">dest_col</span><span class="p">)</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>        
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>                <span class="n">pvp</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">cap1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">orig_col</span><span class="p">)</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>                <span class="n">pvp</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">cap2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">dest_col</span><span class="p">)</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>            <span class="k">return</span> <span class="n">pvp</span> <span class="c1"># end draw_bonds</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>        
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>        <span class="k">if</span> <span class="n">style</span><span class="o">==</span><span class="s1">&#39;cpk&#39;</span><span class="p">:</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>            <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">:</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>                <span class="n">rad</span> <span class="o">=</span> <span class="n">ATOM_RADII_CPK</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>                <span class="n">pvp</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">pv</span><span class="o">.</span><span class="n">Sphere</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">radius</span><span class="o">=</span><span class="n">rad</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">ATOM_COLORS</span><span class="p">[</span><span class="n">atom</span><span class="p">],</span> 
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>                             <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">specular</span><span class="o">=</span><span class="n">spec</span><span class="p">,</span> <span class="n">specular_power</span><span class="o">=</span><span class="n">specpow</span><span class="p">)</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>        
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>        <span class="k">elif</span> <span class="n">style</span><span class="o">==</span><span class="s1">&#39;cov&#39;</span><span class="p">:</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>            <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">:</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>                <span class="n">rad</span> <span class="o">=</span> <span class="n">ATOM_RADII_COVALENT</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>                <span class="n">pvp</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">pv</span><span class="o">.</span><span class="n">Sphere</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">radius</span><span class="o">=</span><span class="n">rad</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">ATOM_COLORS</span><span class="p">[</span><span class="n">atom</span><span class="p">],</span> 
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>                            <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">specular</span><span class="o">=</span><span class="n">spec</span><span class="p">,</span> <span class="n">specular_power</span><span class="o">=</span><span class="n">specpow</span><span class="p">)</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;bs&#39;</span><span class="p">:</span> <span class="c1"># ball and stick</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>            <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">:</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>                <span class="n">rad</span> <span class="o">=</span> <span class="n">ATOM_RADII_CPK</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span> <span class="o">*</span> <span class="n">bs_scale</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">11</span><span class="p">:</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>                    <span class="n">rad</span> <span class="o">=</span> <span class="n">rad</span> <span class="o">*</span> <span class="mf">.75</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>                
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>                <span class="n">pvp</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">pv</span><span class="o">.</span><span class="n">Sphere</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">radius</span><span class="o">=</span><span class="n">rad</span><span class="p">),</span> 
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>                			 <span class="n">color</span><span class="o">=</span><span class="n">ATOM_COLORS</span><span class="p">[</span><span class="n">atom</span><span class="p">],</span> <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>                			 <span class="n">specular</span><span class="o">=</span><span class="n">spec</span><span class="p">,</span> <span class="n">specular_power</span><span class="o">=</span><span class="n">specpow</span><span class="p">)</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>            <span class="n">pvp</span> <span class="o">=</span> <span class="n">draw_bonds</span><span class="p">(</span><span class="n">pvp</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;bs&#39;</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="n">missing_atoms</span><span class="p">,</span> 
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>                            <span class="n">all_atoms</span><span class="o">=</span><span class="n">all_atoms</span><span class="p">)</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;sb&#39;</span><span class="p">:</span> <span class="c1"># splitbonds</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>            <span class="n">pvp</span> <span class="o">=</span> <span class="n">draw_bonds</span><span class="p">(</span><span class="n">pvp</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="n">missing_atoms</span><span class="p">,</span> 
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>                            <span class="n">all_atoms</span><span class="o">=</span><span class="n">all_atoms</span><span class="p">)</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>        
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;pd&#39;</span><span class="p">:</span> <span class="c1"># proximal-distal</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>            <span class="n">pvp</span> <span class="o">=</span> <span class="n">draw_bonds</span><span class="p">(</span><span class="n">pvp</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;pd&#39;</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="n">missing_atoms</span><span class="p">,</span> 
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>                            <span class="n">all_atoms</span><span class="o">=</span><span class="n">all_atoms</span><span class="p">)</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>        <span class="k">else</span><span class="p">:</span> <span class="c1"># plain</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>            <span class="n">pvp</span> <span class="o">=</span> <span class="n">draw_bonds</span><span class="p">(</span><span class="n">pvp</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;plain&#39;</span><span class="p">,</span> <span class="n">bcolor</span><span class="o">=</span><span class="n">bondcolor</span><span class="p">,</span> 
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>                            <span class="n">missing</span><span class="o">=</span><span class="n">missing_atoms</span><span class="p">,</span> <span class="n">all_atoms</span><span class="o">=</span><span class="n">all_atoms</span><span class="p">)</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>            
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>        <span class="k">return</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>    
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>    <span class="k">def</span> <span class="nf">_handle_SS_exception</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a><span class="sd">        This method catches an exception that occurs in the Disulfide</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a><span class="sd">        object (if PERMISSIVE), or raises it again, this time adding the</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a><span class="sd">        PDB line number to the error message. (private).</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a><span class="sd">        :param message: Error message</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a><span class="sd">        :raises DisulfideConstructionException: Fatal construction exception.</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a><span class="sd">            </span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>        <span class="c1"># message = &quot;%s at line %i.&quot; % (message)</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">PERMISSIVE</span><span class="p">:</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>            <span class="c1"># just print a warning - some residues/atoms may be missing</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>                <span class="s2">&quot;DisulfideConstructionException: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>                <span class="s2">&quot;Exception ignored.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>                <span class="s2">&quot;Some atoms may be missing in the data structure.&quot;</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>                <span class="o">%</span> <span class="n">message</span><span class="p">,</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>                <span class="n">DisulfideConstructionWarning</span><span class="p">,</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>            <span class="p">)</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>            <span class="c1"># exceptions are fatal - raise again with new message (including line nr)</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>            <span class="k">raise</span> <span class="n">DisulfideConstructionException</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>    
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>    <span class="k">def</span> <span class="nf">bounding_box</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a><span class="sd">        Return the bounding box array for the given disulfide</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a><span class="sd">        Returns</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a><span class="sd">        -------</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a><span class="sd">        :return: np.Array(3,2): Array containing the min, max for X, Y, and Z respectively. </span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a><span class="sd">        Does not currently take the atom&#39;s radius into account.</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a><span class="sd">    </span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_extents</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_extents</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>        <span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_extents</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>        <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">]</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>        <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">]</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a>        <span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span><span class="p">]</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a>    <span class="k">def</span> <span class="nf">build_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chi1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">chi2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> 
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a>                    <span class="n">chi3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">chi4</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">chi5</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a><span class="sd">        Build a model Disulfide based on the input dihedral angles.</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a><span class="sd">        Routine assumes turtle is in orientation #1 (at Ca, headed toward</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a><span class="sd">        Cb, with N on left), builds disulfide, and updates the object&#39;s internal</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a><span class="sd">        coordinates. It also adds the distal protein backbone,</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a><span class="sd">        and computes the disulfide conformational energy.</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a><span class="sd">        :param chi1: Chi1 (degrees)</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a><span class="sd">        :param chi2: Chi2 (degrees)</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a><span class="sd">        :param chi3: Chi3 (degrees)</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a><span class="sd">        :param chi4: Chi4 (degrees)</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a><span class="sd">        :param chi5: Chi5 (degrees)</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_dihedrals</span><span class="p">(</span><span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="p">,</span> <span class="n">chi3</span><span class="p">,</span> <span class="n">chi4</span><span class="p">,</span> <span class="n">chi5</span><span class="p">)</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>        <span class="n">tmp</span> <span class="o">=</span> <span class="n">Turtle3D</span><span class="p">(</span><span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">Orientation</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>        <span class="n">ca</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>        <span class="n">cb</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">_position</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">schain_to_bbone</span><span class="p">()</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>        <span class="n">n</span><span class="p">,</span> <span class="n">ca</span><span class="p">,</span> <span class="n">cb</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">build_residue</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_prox</span> <span class="o">=</span> <span class="n">n</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span> <span class="o">=</span> <span class="n">ca</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prox</span> <span class="o">=</span> <span class="n">c</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span> <span class="o">=</span> <span class="n">cb</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">bbone_to_schain</span><span class="p">()</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">1.53</span><span class="p">)</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi1</span><span class="p">)</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">yaw</span><span class="p">(</span><span class="mf">112.8</span><span class="p">)</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">_position</span><span class="p">)</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">1.86</span><span class="p">)</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi2</span><span class="p">)</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">yaw</span><span class="p">(</span><span class="mf">103.8</span><span class="p">)</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">_position</span><span class="p">)</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">2.044</span><span class="p">)</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi3</span><span class="p">)</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">yaw</span><span class="p">(</span><span class="mf">103.8</span><span class="p">)</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">_position</span><span class="p">)</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">1.86</span><span class="p">)</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi4</span><span class="p">)</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">yaw</span><span class="p">(</span><span class="mf">112.8</span><span class="p">)</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">_position</span><span class="p">)</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">1.53</span><span class="p">)</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi5</span><span class="p">)</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">pitch</span><span class="p">(</span><span class="mf">180.0</span><span class="p">)</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">schain_to_bbone</span><span class="p">()</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>        <span class="n">n</span><span class="p">,</span> <span class="n">ca</span><span class="p">,</span> <span class="n">cb</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">build_residue</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_dist</span> <span class="o">=</span> <span class="n">n</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span> <span class="o">=</span> <span class="n">ca</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_dist</span> <span class="o">=</span> <span class="n">c</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">compute_torsional_energy</span><span class="p">()</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">compute_local_coords</span><span class="p">()</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span> <span class="o">=</span> <span class="n">distance3d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span><span class="p">)</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_distance</span> <span class="o">=</span> <span class="n">distance3d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cb_dist</span><span class="p">)</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">chi1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span><span class="p">,</span> 
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">chi4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi5</span><span class="p">))</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Torsion_Length</span><span class="p">()</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">compute_rho</span><span class="p">()</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">missing_atoms</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modelled</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>    
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>    <span class="k">def</span> <span class="nf">cofmass</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a><span class="sd">        Returns the geometric center of mass for the internal coordinates of</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a><span class="sd">        the given Disulfide. Missing atoms are not included.</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a><span class="sd">        :return: 3D array for the geometric center of mass</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_coords</span><span class="p">()</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>        <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>    
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a><span class="sd">        Copy the Disulfide.</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a><span class="sd">        :return: A copy of self.  </span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>    
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>    <span class="k">def</span> <span class="nf">compute_extents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">):</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a><span class="sd">        Calculate the internal coordinate extents for the input axis.</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a><span class="sd">        </span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a><span class="sd">        :param dim: Axis, one of &#39;x&#39;, &#39;y&#39;, &#39;z&#39;, by default &#39;z&#39;</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a><span class="sd">        :return: min, max</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>        <span class="n">ic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_coords</span><span class="p">()</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>        <span class="c1"># set default index to &#39;z&#39;</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>        <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>            <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>        <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>            <span class="n">idx</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>        <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>            <span class="n">idx</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>        
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>        <span class="n">_min</span> <span class="o">=</span> <span class="n">ic</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>        <span class="n">_max</span> <span class="o">=</span> <span class="n">ic</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>        <span class="k">return</span> <span class="n">_min</span><span class="p">,</span> <span class="n">_max</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>    <span class="k">def</span> <span class="nf">compute_local_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a><span class="sd">        Compute the internal coordinates for a properly initialized Disulfide Object.</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a><span class="sd">        </span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a><span class="sd">        :param self: SS initialized Disulfide object</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a><span class="sd">        :returns: None, modifies internal state of the input</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>        <span class="n">turt</span> <span class="o">=</span> <span class="n">Turtle3D</span><span class="p">(</span><span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>        <span class="c1"># get the coordinates as np.array for Turtle3D use.</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>        <span class="n">cpp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_prev_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>        <span class="n">nnp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_next_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>        <span class="n">ca</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>        <span class="n">cb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a>        <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">o_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a>        <span class="n">sg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sg_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>        <span class="n">sg2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sg_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>        <span class="n">cb2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cb_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>        <span class="n">ca2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>        <span class="n">c2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>        <span class="n">n2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>        <span class="n">o2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">o_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>        <span class="n">cpd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_prev_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>        <span class="n">nnd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_next_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>        
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>        <span class="n">turt</span><span class="o">.</span><span class="n">orient_from_backbone</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">ca</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">cb</span><span class="p">,</span> <span class="n">ORIENT_SIDECHAIN</span><span class="p">)</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>        
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>        <span class="c1"># internal (local) coordinates, stored as Vector objects</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>        <span class="c1"># to_local returns np.array objects</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>        
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ca_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">ca</span><span class="p">))</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_o_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">o</span><span class="p">))</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cb_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">cb</span><span class="p">))</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sg_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">sg</span><span class="p">))</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_prev_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">cpp</span><span class="p">))</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_next_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">nnp</span><span class="p">))</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_prev_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">cpd</span><span class="p">))</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_next_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">nnd</span><span class="p">))</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">n2</span><span class="p">))</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ca_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">ca2</span><span class="p">))</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">c2</span><span class="p">))</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_o_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">o2</span><span class="p">))</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cb_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">cb2</span><span class="p">))</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sg_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">sg2</span><span class="p">))</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>    <span class="k">def</span> <span class="nf">compute_torsional_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a><span class="sd">        Compute the approximate torsional energy for the Disulfide&#39;s</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a><span class="sd">        conformation and sets its internal state.</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a><span class="sd">        </span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a><span class="sd">        :return: Energy (kcal/mol)</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>        <span class="c1"># @TODO find citation for the ss bond energy calculation</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>        <span class="k">def</span> <span class="nf">torad</span><span class="p">(</span><span class="n">deg</span><span class="p">):</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>            <span class="k">return</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">deg</span><span class="p">))</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>        <span class="n">chi1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi1</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>        <span class="n">chi2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi2</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>        <span class="n">chi3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>        <span class="n">chi4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi4</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>        <span class="n">chi5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi5</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>        <span class="n">energy</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">torad</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">chi1</span><span class="p">))</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">torad</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">chi5</span><span class="p">)))</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>        <span class="n">energy</span> <span class="o">+=</span> <span class="n">cos</span><span class="p">(</span><span class="n">torad</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">chi2</span><span class="p">))</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">torad</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">chi4</span><span class="p">))</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>        <span class="n">energy</span> <span class="o">+=</span> <span class="mf">3.5</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">torad</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">chi3</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">torad</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">chi3</span><span class="p">))</span> <span class="o">+</span> <span class="mf">10.1</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a>        <span class="k">return</span> <span class="n">energy</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a>    
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span> <span class="n">light</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shadows</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a><span class="sd">        Display the Disulfide bond in the specific rendering style.</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a><span class="sd">        :param single: Display the bond in a single panel in the specific style. </span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a><span class="sd">        :param style:  Rendering style: One of:</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a><span class="sd">            * &#39;sb&#39; - split bonds</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a><span class="sd">            * &#39;bs&#39; - ball and stick</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a><span class="sd">            * &#39;cpk&#39; - CPK style</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a><span class="sd">            * &#39;pd&#39; - Proximal/Distal style - Red=proximal, Green=Distal</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a><span class="sd">            * &#39;plain&#39; - boring single color</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a><span class="sd">        :param light: If True, light background, if False, dark</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a><span class="sd">        Example:</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a><span class="sd">        &gt;&gt;&gt; import proteusPy</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.Disulfide import Disulfide</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideLoader import DisulfideLoader</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = DisulfideLoader(verbose=False, subset=True)</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a><span class="sd">        &gt;&gt;&gt; ss = PDB_SS[0]</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a><span class="sd">        &gt;&gt;&gt; ss.display(style=&#39;cpk&#39;)</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a><span class="sd">        &gt;&gt;&gt; ss.screenshot(style=&#39;bs&#39;, fname=&#39;proteus_logo_sb.png&#39;)</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>        <span class="n">src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>        <span class="n">enrg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">src</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal_chain</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal_chain</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">enrg</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol. Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å Cβ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å Tors: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">°&#39;</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>        <span class="k">if</span> <span class="n">light</span><span class="p">:</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>            <span class="n">pv</span><span class="o">.</span><span class="n">set_plot_theme</span><span class="p">(</span><span class="s1">&#39;document&#39;</span><span class="p">)</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>            <span class="n">pv</span><span class="o">.</span><span class="n">set_plot_theme</span><span class="p">(</span><span class="s1">&#39;dark&#39;</span><span class="p">)</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>        
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a>        <span class="k">if</span> <span class="n">single</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>            <span class="n">_pl</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="n">WINSIZE</span><span class="p">)</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>            <span class="n">_pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>            <span class="n">_pl</span><span class="o">.</span><span class="n">enable_anti_aliasing</span><span class="p">(</span><span class="s1">&#39;msaa&#39;</span><span class="p">)</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>            <span class="n">_pl</span><span class="o">.</span><span class="n">add_camera_orientation_widget</span><span class="p">()</span>            
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">_pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> 
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>                        <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>        
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>            <span class="n">_pl</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>            <span class="k">if</span> <span class="n">shadows</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>                <span class="n">_pl</span><span class="o">.</span><span class="n">enable_shadows</span><span class="p">()</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>            <span class="n">_pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>            <span class="n">pl</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="n">WINSIZE</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>            
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">enable_anti_aliasing</span><span class="p">(</span><span class="s1">&#39;msaa&#39;</span><span class="p">)</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_camera_orientation_widget</span><span class="p">()</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a>            
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;cpk&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a>            
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;bs&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>            
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>            
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;pd&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">link_views</span><span class="p">()</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>            <span class="k">if</span> <span class="n">shadows</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>                <span class="n">pl</span><span class="o">.</span><span class="n">enable_shadows</span><span class="p">()</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>        <span class="k">return</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>    
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>    <span class="k">def</span> <span class="nf">Distance_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">others</span><span class="p">:</span> <span class="n">DisulfideList</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a><span class="sd">        Returns list of Disulfides whose RMS atomic distance is within </span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a><span class="sd">        the cutoff (Å) in the others list.</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a><span class="sd">        :param others: DisulfideList to search</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a><span class="sd">        :param cutoff: Distance cutoff (Å)</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a><span class="sd">        :return: DisulfideList within the cutoff</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">ss</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">others</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Distance_RMS</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">cutoff</span><span class="p">]</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>        <span class="k">return</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s1">&#39;neighbors&#39;</span><span class="p">)</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>    
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>    <span class="k">def</span> <span class="nf">Distance_RMS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a><span class="sd">        Calculate the RMS distance between the internal coordinates of self and another Disulfide.</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a><span class="sd">        :param other: Comparison Disulfide</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a><span class="sd">        :return: RMS distance (Å)</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a>        <span class="c1"># Get internal coordinates of both objects</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a>        <span class="n">ic1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_coords</span><span class="p">()</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a>        <span class="n">ic2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">internal_coords</span><span class="p">()</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>        <span class="c1"># Compute the sum of squared distances between corresponding internal coordinates</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>        <span class="n">totsq</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ic1</span><span class="p">,</span> <span class="n">ic2</span><span class="p">))</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>        <span class="c1"># Compute the mean of the squared distances</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>        <span class="n">totsq</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ic1</span><span class="p">)</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>        <span class="c1"># Take the square root of the mean to get the RMS distance</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">totsq</span><span class="p">)</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>    <span class="k">def</span> <span class="nf">get_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a><span class="sd">        Return the proximal and distal chain IDs for the Disulfide.</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a><span class="sd">        :return: tuple (proximal, distal) chain IDs</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>        <span class="n">prox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proximal_chain</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>        <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distal_chain</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">prox</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>    
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>    <span class="k">def</span> <span class="nf">get_permissive</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a><span class="sd">        Return the Permissive flag state. (Used in PDB parsing)</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a><span class="sd">        :return: Permissive state</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">PERMISIVE</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>    <span class="k">def</span> <span class="nf">get_full_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a><span class="sd">        Return the Disulfide full IDs (Used with BIO.PDB)</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a><span class="sd">        :return: Disulfide full IDs</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>        <span class="k">return</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal_residue_fullid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distal_residue_fullid</span><span class="p">))</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>    <span class="k">def</span> <span class="nf">initialize_disulfide_from_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chain1</span><span class="p">,</span> <span class="n">chain2</span><span class="p">,</span> <span class="n">proximal</span><span class="p">,</span> 
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>    									<span class="n">distal</span><span class="p">,</span> <span class="n">resolution</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a><span class="sd">        Initialize a new Disulfide object with atomic coordinates from </span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a><span class="sd">        the proximal and distal coordinates, typically taken from a PDB file.</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a><span class="sd">        This routine is primarily used internally when building the compressed</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a><span class="sd">        database.</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a><span class="sd">        :param chain1: list of Residues in the model, eg: chain = model[&#39;A&#39;]</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a><span class="sd">        :param chain2: list of Residues in the model, eg: chain = model[&#39;A&#39;]</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a><span class="sd">        :param proximal: proximal residue sequence ID</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a><span class="sd">        :param distal: distal residue sequence ID</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a><span class="sd">        :param resolution: structure resolution</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a><span class="sd">        :param quiet: Quiet or noisy parsing, defaults to True</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a><span class="sd">        :raises DisulfideConstructionWarning: Raised when not parsed correctly</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>        <span class="nb">id</span> <span class="o">=</span> <span class="n">chain1</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_id</span> <span class="o">=</span> <span class="nb">id</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>        
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>        <span class="n">chi1</span> <span class="o">=</span> <span class="n">chi2</span> <span class="o">=</span> <span class="n">chi3</span> <span class="o">=</span> <span class="n">chi4</span> <span class="o">=</span> <span class="n">chi5</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>        <span class="n">prox</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">proximal</span><span class="p">)</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>        <span class="n">dist</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">distal</span><span class="p">)</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>        <span class="n">prox_residue</span> <span class="o">=</span> <span class="n">chain1</span><span class="p">[</span><span class="n">prox</span><span class="p">]</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>        <span class="n">dist_residue</span> <span class="o">=</span> <span class="n">chain2</span><span class="p">[</span><span class="n">dist</span><span class="p">]</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">prox_residue</span><span class="o">.</span><span class="n">get_resname</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;CYS&#39;</span> <span class="ow">or</span> <span class="n">dist_residue</span><span class="o">.</span><span class="n">get_resname</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;CYS&#39;</span><span class="p">):</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;build_disulfide() requires CYS at both residues: </span><span class="si">{</span><span class="n">prox</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">prox_residue</span><span class="o">.</span><span class="n">get_resname</span><span class="p">()</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">dist</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">dist_residue</span><span class="o">.</span><span class="n">get_resname</span><span class="p">()</span><span class="si">}</span><span class="s1"> Chain: </span><span class="si">{</span><span class="n">prox_residue</span><span class="o">.</span><span class="n">get_segid</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>        <span class="c1"># set the objects proximal and distal values</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_resnum</span><span class="p">(</span><span class="n">proximal</span><span class="p">,</span> <span class="n">distal</span><span class="p">)</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>    
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>        <span class="k">if</span> <span class="n">resolution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="n">resolution</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal_chain</span> <span class="o">=</span> <span class="n">chain1</span><span class="o">.</span><span class="n">get_id</span><span class="p">()</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal_chain</span> <span class="o">=</span> <span class="n">chain2</span><span class="o">.</span><span class="n">get_id</span><span class="p">()</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal_residue_fullid</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal_residue_fullid</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>        <span class="k">if</span> <span class="n">quiet</span><span class="p">:</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">DisulfideConstructionWarning</span><span class="p">)</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;always&quot;</span><span class="p">)</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>        <span class="c1"># grab the coordinates for the proximal and distal residues as vectors </span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>        <span class="c1"># so we can do math on them later</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>        <span class="c1"># proximal residue</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>        
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>            <span class="n">n1</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>            <span class="n">ca1</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>            <span class="n">c1</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>            <span class="n">o1</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>            <span class="n">cb1</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="p">[</span><span class="s1">&#39;CB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>            <span class="n">sg1</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="p">[</span><span class="s1">&#39;SG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>            
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>            <span class="k">raise</span> <span class="n">DisulfideConstructionWarning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid or missing coordinates for proximal residue </span><span class="si">{</span><span class="n">proximal</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>        
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>        <span class="c1"># distal residue</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>            <span class="n">n2</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>            <span class="n">ca2</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>            <span class="n">c2</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>            <span class="n">o2</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>            <span class="n">cb2</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="p">[</span><span class="s1">&#39;CB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>            <span class="n">sg2</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="p">[</span><span class="s1">&#39;SG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>            <span class="k">raise</span> <span class="n">DisulfideConstructionWarning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid or missing coordinates for distal residue </span><span class="si">{</span><span class="n">distal</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>        
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>        <span class="c1"># previous residue and next residue - optional, used for phi, psi calculations</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>            <span class="n">prevprox</span> <span class="o">=</span> <span class="n">chain1</span><span class="p">[</span><span class="n">prox</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>            <span class="n">nextprox</span> <span class="o">=</span> <span class="n">chain1</span><span class="p">[</span><span class="n">prox</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>            <span class="n">prevdist</span> <span class="o">=</span> <span class="n">chain2</span><span class="p">[</span><span class="n">dist</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>            <span class="n">nextdist</span> <span class="o">=</span> <span class="n">chain2</span><span class="p">[</span><span class="n">dist</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>            <span class="n">cprev_prox</span> <span class="o">=</span> <span class="n">prevprox</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>            <span class="n">nnext_prox</span> <span class="o">=</span> <span class="n">nextprox</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>            <span class="n">cprev_dist</span> <span class="o">=</span> <span class="n">prevdist</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>            <span class="n">nnext_dist</span> <span class="o">=</span> <span class="n">nextdist</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>            <span class="c1"># compute phi, psi for prox and distal</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">phiprox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">cprev_prox</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">ca1</span><span class="p">,</span> <span class="n">c1</span><span class="p">))</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">psiprox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">ca1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">nnext_prox</span><span class="p">))</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">phidist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">cprev_dist</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">ca2</span><span class="p">,</span> <span class="n">c2</span><span class="p">))</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">psidist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">n2</span><span class="p">,</span> <span class="n">ca2</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">nnext_dist</span><span class="p">))</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>            <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Missing coords for: </span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">prox</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s1"> or </span><span class="si">{</span><span class="n">dist</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1"> for SS </span><span class="si">{</span><span class="n">proximal</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">distal</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>            <span class="n">cprev_prox</span> <span class="o">=</span> <span class="n">nnext_prox</span> <span class="o">=</span> <span class="n">cprev_dist</span> <span class="o">=</span> <span class="n">nnext_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">missing_atoms</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">,</span> <span class="n">DisulfideConstructionWarning</span><span class="p">)</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>        <span class="c1"># update the positions and conformation</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_positions</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">ca1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">o1</span><span class="p">,</span> <span class="n">cb1</span><span class="p">,</span> <span class="n">sg1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">ca2</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">o2</span><span class="p">,</span> <span class="n">cb2</span><span class="p">,</span> 
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>                           <span class="n">sg2</span><span class="p">,</span> <span class="n">cprev_prox</span><span class="p">,</span> <span class="n">nnext_prox</span><span class="p">,</span> <span class="n">cprev_dist</span><span class="p">,</span> <span class="n">nnext_dist</span><span class="p">)</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>        
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>        <span class="c1"># calculate and set the disulfide dihedral angles</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">ca1</span><span class="p">,</span> <span class="n">cb1</span><span class="p">,</span> <span class="n">sg1</span><span class="p">))</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">ca1</span><span class="p">,</span> <span class="n">cb1</span><span class="p">,</span> <span class="n">sg1</span><span class="p">,</span> <span class="n">sg2</span><span class="p">))</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">cb1</span><span class="p">,</span> <span class="n">sg1</span><span class="p">,</span> <span class="n">sg2</span><span class="p">,</span> <span class="n">cb2</span><span class="p">))</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">sg1</span><span class="p">,</span> <span class="n">sg2</span><span class="p">,</span> <span class="n">cb2</span><span class="p">,</span> <span class="n">ca2</span><span class="p">))</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">sg2</span><span class="p">,</span> <span class="n">cb2</span><span class="p">,</span> <span class="n">ca2</span><span class="p">,</span> <span class="n">n2</span><span class="p">))</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">ca1</span><span class="p">,</span> <span class="n">ca2</span><span class="p">,</span> <span class="n">n2</span><span class="p">))</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span> <span class="o">=</span> <span class="n">distance3d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span><span class="p">)</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_distance</span> <span class="o">=</span> <span class="n">distance3d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span><span class="p">)</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">chi1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span><span class="p">,</span> 
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">chi4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi5</span><span class="p">))</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Torsion_Length</span><span class="p">()</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>        <span class="c1"># calculate and set the SS bond torsional energy</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">compute_torsional_energy</span><span class="p">()</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>        <span class="c1"># compute and set the local coordinates</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">compute_local_coords</span><span class="p">()</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>    <span class="k">def</span> <span class="nf">internal_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a><span class="sd">        Returns the internal coordinates for the Disulfide.</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a><span class="sd">        If there are missing atoms the extra atoms for the proximal</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a><span class="sd">        and distal N and C are set to [0,0,0]. This is needed for the center of</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a><span class="sd">        mass calculations, used when rendering.</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a><span class="sd">        :return: Array containing the coordinates, [16][3].</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>        
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a>        <span class="c1"># if we don&#39;t have the prior and next atoms we initialize those</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>        <span class="c1"># atoms to the origin so as to not effect the center of mass calculations</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing_atoms</span><span class="p">:</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a>            <span class="n">res_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_ca_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_o_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cb_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sg_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_ca_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_o_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cb_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sg_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a>                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a>                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a>                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a>                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>            <span class="p">))</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a>            <span class="n">res_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_ca_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_o_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cb_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sg_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_ca_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_o_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cb_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sg_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_prev_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_next_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_prev_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_next_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>            <span class="p">))</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a>        <span class="k">return</span> <span class="n">res_array</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a>    
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>    <span class="k">def</span> <span class="nf">internal_coords_res</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resnumb</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a><span class="sd">        Returns the internal coordinates for the internal coordinates of</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a><span class="sd">        the given Disulfide. Missing atoms are not included.</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a><span class="sd">        :param resnumb: Residue number for disulfide</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a><span class="sd">        :raises DisulfideConstructionWarning: Warning raised if the residue number is invalid</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a><span class="sd">        :return: Array containing the internal coordinates for the disulfide</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>        <span class="n">res_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>        <span class="k">if</span> <span class="n">resnumb</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">proximal</span><span class="p">:</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>            <span class="n">res_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_ca_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_o_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cb_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sg_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>            <span class="p">))</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>            <span class="k">return</span> <span class="n">res_array</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>        <span class="k">elif</span> <span class="n">resnumb</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">distal</span><span class="p">:</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>            <span class="n">res_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_ca_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_o_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cb_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sg_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>            <span class="p">))</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>            <span class="k">return</span> <span class="n">res_array</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a>            <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;-&gt; Disulfide.internal_coords(): Invalid argument. </span><span class="se">\</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a><span class="s1">             Unable to find residue: </span><span class="si">{</span><span class="n">resnumb</span><span class="si">}</span><span class="s1"> &#39;</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a>            <span class="k">raise</span> <span class="n">DisulfideConstructionWarning</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a>    <span class="k">def</span> <span class="nf">make_movie</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;ssbond.mp4&#39;</span><span class="p">,</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a>                   <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">360</span><span class="p">):</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a><span class="sd">        Create an animation for ```self``` rotating one revolution about the Y axis,</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a><span class="sd">        in the given ```style```, saving to ```filename```.</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a><span class="sd">        :param style: Rendering style, defaults to &#39;sb&#39;, one of:</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a><span class="sd">        * &#39;sb&#39; - split bonds</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a><span class="sd">        * &#39;bs&#39; - ball and stick</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a><span class="sd">        * &#39;cpk&#39; - CPK style</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a><span class="sd">        * &#39;pd&#39; - Proximal/Distal style - Red=proximal, Green=Distal</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a><span class="sd">        * &#39;plain&#39; - boring single color</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a><span class="sd">        </span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a><span class="sd">        :param fname: Output filename, defaults to ```ssbond.mp4```</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a><span class="sd">        :param verbose: Verbosity, defaults to False</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a><span class="sd">        :param steps: Number of steps for one complete rotation, defaults to 360.</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a>        <span class="n">src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a>        <span class="n">enrg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a>        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">src</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal_chain</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal_chain</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">enrg</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol, Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å, Tors: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a>        
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Rendering animation to </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">)</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a>        <span class="n">pl</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="n">WINSIZE</span><span class="p">,</span> <span class="n">off_screen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">open_movie</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">quality</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">generate_orbital_path</span><span class="p">(</span><span class="n">n_points</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">enable_anti_aliasing</span><span class="p">(</span><span class="s1">&#39;msaa&#39;</span><span class="p">)</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a>        <span class="c1"># pl.add_camera_orientation_widget()</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>        <span class="n">pl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a>                    <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">orbit_on_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">write_frames</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Saved mp4 animation to: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>    
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a>    <span class="k">def</span> <span class="nf">pprint</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a><span class="sd">        Pretty print general info for the Disulfide</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_info</span><span class="p">()</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a>        <span class="n">s2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_ca_dist</span><span class="p">()</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a>        <span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_conformation</span><span class="p">()</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>        <span class="n">s4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_torsion_length</span><span class="p">()</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s1</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="si">{</span><span class="n">s3</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="si">{</span><span class="n">s2</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="si">{</span><span class="n">s4</span><span class="si">}</span><span class="s1">&gt;&#39;</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a>    
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a>    <span class="k">def</span> <span class="nf">pprint_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a><span class="sd">        Pretty print all info for the Disulfide</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_info</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>        <span class="n">s2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_coords</span><span class="p">()</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>        <span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_local_coords</span><span class="p">()</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>        <span class="n">s4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_conformation</span><span class="p">()</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>        <span class="n">s5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_chain_ids</span><span class="p">()</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>        <span class="n">s6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_ca_dist</span><span class="p">()</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>        <span class="n">s7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_torsion_length</span><span class="p">()</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s1</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s5</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s2</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s3</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s4</span><span class="si">}</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">s6</span><span class="si">}</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">s7</span><span class="si">}</span><span class="s1">&gt;&#39;</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a>    
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a>    <span class="c1"># repr functions. The class is large, so I split it up into sections</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a>    <span class="k">def</span> <span class="nf">repr_ss_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a><span class="sd">        Representation for the Disulfide class</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&lt;Disulfide </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">, Source: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pdb_id</span><span class="si">}</span><span class="s1">, Resolution: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">resolution</span><span class="si">}</span><span class="s1"> Å&#39;</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a>        <span class="k">return</span> <span class="n">s1</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a>    
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a>    <span class="k">def</span> <span class="nf">repr_ss_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a><span class="sd">        Representation for Disulfide coordinates</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a>        <span class="n">s2</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Proximal Coordinates:</span><span class="se">\n</span><span class="s1">   N: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   C: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">c_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   O: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">o_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cβ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Sγ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sg_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cprev </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">c_prev_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Nnext: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_next_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a>        <span class="n">s3</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Distal Coordinates:</span><span class="se">\n</span><span class="s1">   N: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   C: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">c_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   O: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">o_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cβ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Sγ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sg_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cprev </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">c_prev_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Nnext: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_next_dist</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">&#39;</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a>        <span class="n">stot</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s2</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s3</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a>        <span class="k">return</span> <span class="n">stot</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a>    <span class="k">def</span> <span class="nf">repr_ss_conformation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a><span class="sd">        Representation for Disulfide conformation</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a>        <span class="n">s4</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Χ1-Χ5: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">chi1</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">°, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">chi2</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">°, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">chi3</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">°, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">chi4</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">° </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">chi5</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">°, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">°, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol&#39;</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a>        <span class="n">stot</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s4</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a>        <span class="k">return</span> <span class="n">stot</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a>    <span class="k">def</span> <span class="nf">repr_ss_local_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a><span class="sd">        Representation for the Disulfide internal coordinates.</span>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a>        <span class="n">s2i</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Proximal Internal Coords:</span><span class="se">\n</span><span class="s1">   N: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_ca_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   C: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   O: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_o_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cβ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_cb_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Sγ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_sg_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cprev </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">c_prev_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Nnext: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_next_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a>        <span class="n">s3i</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Distal Internal Coords:</span><span class="se">\n</span><span class="s1">   N: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_ca_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   C: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   O: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_o_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cβ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_cb_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Sγ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_sg_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cprev </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">c_prev_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Nnext: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_next_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a>        <span class="n">stot</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s2i</span><span class="si">}{</span><span class="n">s3i</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a>        <span class="k">return</span> <span class="n">stot</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a>    
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a>    <span class="k">def</span> <span class="nf">repr_ss_chain_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a><span class="sd">        Representation for Disulfide chain IDs</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a>        <span class="k">return</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Proximal Chain fullID: &lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal_residue_fullid</span><span class="si">}</span><span class="s1">&gt; Distal Chain fullID: &lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal_residue_fullid</span><span class="si">}</span><span class="s1">&gt;&#39;</span><span class="p">)</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a>    <span class="k">def</span> <span class="nf">repr_ss_ca_dist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a><span class="sd">        Representation for Disulfide Ca distance</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Cα Distance: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å&#39;</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a>        <span class="k">return</span> <span class="n">s1</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a>    
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a>    <span class="k">def</span> <span class="nf">repr_ss_cb_dist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a><span class="sd">        Representation for Disulfide Ca distance</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Cβ Distance: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å&#39;</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a>        <span class="k">return</span> <span class="n">s1</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a>    
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a>    <span class="k">def</span> <span class="nf">repr_ss_torsion_length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a><span class="sd">        Representation for Disulfide torsion length</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Torsion length: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> deg&#39;</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a>        <span class="k">return</span> <span class="n">s1</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a>    
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a>    <span class="k">def</span> <span class="nf">repr_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a><span class="sd">        Return a string representation for all Disulfide information</span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a><span class="sd">        contained in self.</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a>        
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_info</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a>        <span class="n">s2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_coords</span><span class="p">()</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a>        <span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_local_coords</span><span class="p">()</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a>        <span class="n">s4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_conformation</span><span class="p">()</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a>        <span class="n">s5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_chain_ids</span><span class="p">()</span>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a>        <span class="n">s6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_ca_dist</span><span class="p">()</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a>        <span class="n">s8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_cb_dist</span><span class="p">()</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a>        <span class="n">s7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_torsion_length</span><span class="p">()</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s1</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s5</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s2</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s3</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s4</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s6</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s7</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s8</span><span class="si">}</span><span class="s1">&gt;&#39;</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a>    
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a>    <span class="k">def</span> <span class="nf">repr_compact</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a><span class="sd">        Return a compact representation of the Disulfide object</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a><span class="sd">        :return: string</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a>        <span class="k">return</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_info</span><span class="p">()</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_conformation</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a>    <span class="k">def</span> <span class="nf">repr_conformation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a><span class="sd">        Return a string representation of the Disulfide object&#39;s conformation.</span>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a><span class="sd">        :return: string</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a>        <span class="k">return</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_conformation</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a>    
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a>    <span class="k">def</span> <span class="nf">repr_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a><span class="sd">        Return a string representation of the Disulfide object&#39;s coordinates.</span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a><span class="sd">        :return: string</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a>        <span class="k">return</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_coords</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a>    <span class="k">def</span> <span class="nf">repr_internal_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a><span class="sd">        Return a string representation of the Disulfide object&#39;s internal coordinaes.</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a><span class="sd">        :return: string</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a>        <span class="k">return</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_local_coords</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a>    <span class="k">def</span> <span class="nf">repr_chain_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a><span class="sd">        Return a string representation of the Disulfide object&#39;s chain ids.</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a><span class="sd">        :return: string</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a>        <span class="k">return</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_chain_ids</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a>    <span class="k">def</span> <span class="nf">compute_rho</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span> <span class="n">calc_dihedral</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_prox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_dist</span><span class="p">)</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a><span class="sd">        Resets the disulfide object to its initial state. All distances, </span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a><span class="sd">        angles and positions are reset. The name is unchanged.</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a>        <span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a>        
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a>    <span class="k">def</span> <span class="nf">same_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a><span class="sd">        Function checks if the Disulfide is cross-chain or not.</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a><span class="sd">        Returns</span>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a><span class="sd">        -------</span>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a><span class="sd">        bool \n</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a><span class="sd">            True if the proximal and distal residues are on the same chains,</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a><span class="sd">            False otherwise.</span>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a>        <span class="p">(</span><span class="n">prox</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_chains</span><span class="p">()</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a>        <span class="k">return</span> <span class="n">prox</span> <span class="o">==</span> <span class="n">dist</span>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a>    <span class="k">def</span> <span class="nf">screenshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;ssbond.png&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shadows</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">light</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a><span class="sd">        Create and save a screenshot of the Disulfide in the given style</span>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a><span class="sd">        and filename</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a><span class="sd">        :param single: Display a single vs panel view, defaults to True</span>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a><span class="sd">        :param style: Rendering style, one of:</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a><span class="sd">        * &#39;sb&#39; - split bonds</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a><span class="sd">        * &#39;bs&#39; - ball and stick</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a><span class="sd">        * &#39;cpk&#39; - CPK style</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a><span class="sd">        * &#39;pd&#39; - Proximal/Distal style - Red=proximal, Green=Distal</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a><span class="sd">        * &#39;plain&#39; - boring single color,</span>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a><span class="sd">        :param fname: output filename,, defaults to &#39;ssbond.png&#39;</span>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a><span class="sd">        :param verbose: Verbosit, defaults to False</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a><span class="sd">        :param shadows: Enable shadows, defaults to False</span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a>        <span class="n">src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a>        <span class="n">enrg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a>        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">src</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal_chain</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal_chain</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">enrg</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol, Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å, Cβ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å, Tors: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a>        <span class="k">if</span> <span class="n">light</span><span class="p">:</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a>            <span class="n">pv</span><span class="o">.</span><span class="n">set_plot_theme</span><span class="p">(</span><span class="s1">&#39;document&#39;</span><span class="p">)</span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a>            <span class="n">pv</span><span class="o">.</span><span class="n">set_plot_theme</span><span class="p">(</span><span class="s1">&#39;dark&#39;</span><span class="p">)</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a>            
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; screenshot(): Rendering screenshot to file </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a>        <span class="k">if</span> <span class="n">single</span><span class="p">:</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a>            <span class="n">pl</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="n">WINSIZE</span><span class="p">)</span>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">enable_anti_aliasing</span><span class="p">(</span><span class="s1">&#39;msaa&#39;</span><span class="p">)</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_camera_orientation_widget</span><span class="p">()</span>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a>            <span class="k">if</span> <span class="n">shadows</span><span class="p">:</span>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a>                <span class="n">pl</span><span class="o">.</span><span class="n">enable_shadows</span><span class="p">()</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a>            
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">auto_close</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">screenshot</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a>            <span class="n">pl</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="n">WINSIZE</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a>            
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">enable_anti_aliasing</span><span class="p">(</span><span class="s1">&#39;msaa&#39;</span><span class="p">)</span>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_camera_orientation_widget</span><span class="p">()</span>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;cpk&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;pd&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;bs&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a>            
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">link_views</span><span class="p">()</span>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a>            <span class="k">if</span> <span class="n">shadows</span><span class="p">:</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a>                <span class="n">pl</span><span class="o">.</span><span class="n">enable_shadows</span><span class="p">()</span>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">auto_close</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">screenshot</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a>        
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Saved: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a>    
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a>    <span class="k">def</span> <span class="nf">set_permissive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">perm</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos">1425</span></a><span class="sd">        Sets PERMISSIVE flag for Disulfide parsing</span>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos">1426</span></a><span class="sd">        :return: None</span>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos">1427</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos">1428</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">PERMISSIVE</span> <span class="o">=</span> <span class="n">perm</span>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos">1429</span></a>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos">1430</span></a>    <span class="k">def</span> <span class="nf">set_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">ca_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">c_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos">1431</span></a>                      <span class="n">o_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">cb_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">sg_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> 
</span><span id="L-1432"><a href="#L-1432"><span class="linenos">1432</span></a>                      <span class="n">n_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">ca_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">c_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos">1433</span></a>                      <span class="n">o_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">cb_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">sg_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos">1434</span></a>                      <span class="n">c_prev_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">n_next_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos">1435</span></a>                      <span class="n">c_prev_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">n_next_dist</span><span class="p">:</span> <span class="n">Vector</span>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos">1436</span></a>                      <span class="p">):</span>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos">1437</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos">1438</span></a><span class="sd">        Set the atomic coordinates for all atoms in the Disulfide object.</span>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos">1439</span></a>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos">1440</span></a><span class="sd">        :param n_prox: Proximal N position</span>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos">1441</span></a><span class="sd">        :param ca_prox: Proximal Cα position</span>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos">1442</span></a><span class="sd">        :param c_prox: Proximal C&#39; position</span>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos">1443</span></a><span class="sd">        :param o_prox: Proximal O position</span>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos">1444</span></a><span class="sd">        :param cb_prox: Proximal Cβ position</span>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos">1445</span></a><span class="sd">        :param sg_prox: Proximal Sγ position</span>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos">1446</span></a><span class="sd">        :param n_dist: Distal N position</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos">1447</span></a><span class="sd">        :param ca_dist: Distal Cα position</span>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos">1448</span></a><span class="sd">        :param c_dist: Distal C&#39; position</span>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos">1449</span></a><span class="sd">        :param o_dist: Distal O position</span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos">1450</span></a><span class="sd">        :param cb_dist: Distal Cβ position</span>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos">1451</span></a><span class="sd">        :param sg_dist: Distal Sγ position</span>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos">1452</span></a><span class="sd">        :param c_prev_prox: Proximal previous C&#39;</span>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos">1453</span></a><span class="sd">        :param n_next_prox: Proximal next N</span>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos">1454</span></a><span class="sd">        :param c_prev_dist: Distal previous C&#39;</span>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos">1455</span></a><span class="sd">        :param n_next_dist: Distal next N</span>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos">1456</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos">1457</span></a>        
</span><span id="L-1458"><a href="#L-1458"><span class="linenos">1458</span></a>        <span class="c1"># deep copy</span>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos">1459</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_prox</span> <span class="o">=</span> <span class="n">n_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos">1460</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span> <span class="o">=</span> <span class="n">ca_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos">1461</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prox</span> <span class="o">=</span> <span class="n">c_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos">1462</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">o_prox</span> <span class="o">=</span> <span class="n">o_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos">1463</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span> <span class="o">=</span> <span class="n">cb_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos">1464</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_prox</span> <span class="o">=</span> <span class="n">sg_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos">1465</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_dist</span> <span class="o">=</span> <span class="n">sg_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos">1466</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_dist</span> <span class="o">=</span> <span class="n">cb_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos">1467</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span> <span class="o">=</span> <span class="n">ca_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos">1468</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_dist</span> <span class="o">=</span> <span class="n">n_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos">1469</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_dist</span> <span class="o">=</span> <span class="n">c_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos">1470</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">o_dist</span> <span class="o">=</span> <span class="n">o_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos">1471</span></a>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos">1472</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prev_prox</span> <span class="o">=</span> <span class="n">c_prev_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos">1473</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_next_prox</span> <span class="o">=</span> <span class="n">n_next_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos">1474</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prev_dist</span> <span class="o">=</span> <span class="n">c_prev_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos">1475</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_next_dist</span> <span class="o">=</span> <span class="n">n_next_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-1476"><a href="#L-1476"><span class="linenos">1476</span></a>       
</span><span id="L-1477"><a href="#L-1477"><span class="linenos">1477</span></a>    <span class="k">def</span> <span class="nf">set_dihedrals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chi1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">chi2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">chi3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-1478"><a href="#L-1478"><span class="linenos">1478</span></a>                    <span class="n">chi4</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">chi5</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="L-1479"><a href="#L-1479"><span class="linenos">1479</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1480"><a href="#L-1480"><span class="linenos">1480</span></a><span class="sd">        Set the disulfide&#39;s dihedral angles, Chi1-Chi5. -180 - 180 degrees.</span>
</span><span id="L-1481"><a href="#L-1481"><span class="linenos">1481</span></a>
</span><span id="L-1482"><a href="#L-1482"><span class="linenos">1482</span></a><span class="sd">        :param chi1: Chi1</span>
</span><span id="L-1483"><a href="#L-1483"><span class="linenos">1483</span></a><span class="sd">        :param chi2: Chi2</span>
</span><span id="L-1484"><a href="#L-1484"><span class="linenos">1484</span></a><span class="sd">        :param chi3: Chi3</span>
</span><span id="L-1485"><a href="#L-1485"><span class="linenos">1485</span></a><span class="sd">        :param chi4: Chi4</span>
</span><span id="L-1486"><a href="#L-1486"><span class="linenos">1486</span></a><span class="sd">        :param chi5: Chi5</span>
</span><span id="L-1487"><a href="#L-1487"><span class="linenos">1487</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1488"><a href="#L-1488"><span class="linenos">1488</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi1</span> <span class="o">=</span> <span class="n">chi1</span>
</span><span id="L-1489"><a href="#L-1489"><span class="linenos">1489</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi2</span> <span class="o">=</span> <span class="n">chi2</span>
</span><span id="L-1490"><a href="#L-1490"><span class="linenos">1490</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span> <span class="o">=</span> <span class="n">chi3</span>
</span><span id="L-1491"><a href="#L-1491"><span class="linenos">1491</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi4</span> <span class="o">=</span> <span class="n">chi4</span>
</span><span id="L-1492"><a href="#L-1492"><span class="linenos">1492</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi5</span> <span class="o">=</span> <span class="n">chi5</span>
</span><span id="L-1493"><a href="#L-1493"><span class="linenos">1493</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="p">,</span> <span class="n">chi3</span><span class="p">,</span> <span class="n">chi4</span><span class="p">,</span> <span class="n">chi5</span><span class="p">])</span>
</span><span id="L-1494"><a href="#L-1494"><span class="linenos">1494</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">compute_torsional_energy</span><span class="p">()</span>
</span><span id="L-1495"><a href="#L-1495"><span class="linenos">1495</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Torsion_Length</span><span class="p">()</span>
</span><span id="L-1496"><a href="#L-1496"><span class="linenos">1496</span></a>
</span><span id="L-1497"><a href="#L-1497"><span class="linenos">1497</span></a>    <span class="k">def</span> <span class="nf">set_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">namestr</span><span class="o">=</span><span class="s2">&quot;Disulfide&quot;</span><span class="p">):</span>
</span><span id="L-1498"><a href="#L-1498"><span class="linenos">1498</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1499"><a href="#L-1499"><span class="linenos">1499</span></a><span class="sd">        Set&#39;s the Disulfide&#39;s name</span>
</span><span id="L-1500"><a href="#L-1500"><span class="linenos">1500</span></a>
</span><span id="L-1501"><a href="#L-1501"><span class="linenos">1501</span></a><span class="sd">        :param namestr: Name, by default &quot;Disulfide&quot;</span>
</span><span id="L-1502"><a href="#L-1502"><span class="linenos">1502</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1503"><a href="#L-1503"><span class="linenos">1503</span></a>
</span><span id="L-1504"><a href="#L-1504"><span class="linenos">1504</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">namestr</span>
</span><span id="L-1505"><a href="#L-1505"><span class="linenos">1505</span></a>
</span><span id="L-1506"><a href="#L-1506"><span class="linenos">1506</span></a>    <span class="k">def</span> <span class="nf">set_resnum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proximal</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">distal</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1507"><a href="#L-1507"><span class="linenos">1507</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1508"><a href="#L-1508"><span class="linenos">1508</span></a><span class="sd">        Set the proximal and residue numbers for the Disulfide.</span>
</span><span id="L-1509"><a href="#L-1509"><span class="linenos">1509</span></a>
</span><span id="L-1510"><a href="#L-1510"><span class="linenos">1510</span></a><span class="sd">        :param proximal: Proximal residue number</span>
</span><span id="L-1511"><a href="#L-1511"><span class="linenos">1511</span></a><span class="sd">        :param distal: Distal residue number</span>
</span><span id="L-1512"><a href="#L-1512"><span class="linenos">1512</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1513"><a href="#L-1513"><span class="linenos">1513</span></a>
</span><span id="L-1514"><a href="#L-1514"><span class="linenos">1514</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal</span> <span class="o">=</span> <span class="n">proximal</span>
</span><span id="L-1515"><a href="#L-1515"><span class="linenos">1515</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal</span> <span class="o">=</span> <span class="n">distal</span>
</span><span id="L-1516"><a href="#L-1516"><span class="linenos">1516</span></a>
</span><span id="L-1517"><a href="#L-1517"><span class="linenos">1517</span></a>    <span class="k">def</span> <span class="nf">Torsion_Length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-1518"><a href="#L-1518"><span class="linenos">1518</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1519"><a href="#L-1519"><span class="linenos">1519</span></a><span class="sd">        Compute the 5D Euclidean length of the Disulfide object</span>
</span><span id="L-1520"><a href="#L-1520"><span class="linenos">1520</span></a><span class="sd">        and update the Disulfide internal state.</span>
</span><span id="L-1521"><a href="#L-1521"><span class="linenos">1521</span></a>
</span><span id="L-1522"><a href="#L-1522"><span class="linenos">1522</span></a><span class="sd">        :return: Torsion length (Degrees)</span>
</span><span id="L-1523"><a href="#L-1523"><span class="linenos">1523</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1524"><a href="#L-1524"><span class="linenos">1524</span></a>
</span><span id="L-1525"><a href="#L-1525"><span class="linenos">1525</span></a>        <span class="c1"># Use numpy array to compute element-wise square</span>
</span><span id="L-1526"><a href="#L-1526"><span class="linenos">1526</span></a>        <span class="n">tors2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span><span class="p">)</span>
</span><span id="L-1527"><a href="#L-1527"><span class="linenos">1527</span></a>
</span><span id="L-1528"><a href="#L-1528"><span class="linenos">1528</span></a>        <span class="c1"># Compute the sum of squares using numpy&#39;s sum function</span>
</span><span id="L-1529"><a href="#L-1529"><span class="linenos">1529</span></a>        <span class="n">dist</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">tors2</span><span class="p">))</span>
</span><span id="L-1530"><a href="#L-1530"><span class="linenos">1530</span></a>
</span><span id="L-1531"><a href="#L-1531"><span class="linenos">1531</span></a>        <span class="c1"># Update the internal state</span>
</span><span id="L-1532"><a href="#L-1532"><span class="linenos">1532</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span> <span class="o">=</span> <span class="n">dist</span>
</span><span id="L-1533"><a href="#L-1533"><span class="linenos">1533</span></a>
</span><span id="L-1534"><a href="#L-1534"><span class="linenos">1534</span></a>        <span class="k">return</span> <span class="n">dist</span>
</span><span id="L-1535"><a href="#L-1535"><span class="linenos">1535</span></a>
</span><span id="L-1536"><a href="#L-1536"><span class="linenos">1536</span></a>    <span class="k">def</span> <span class="nf">Torsion_Distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-1537"><a href="#L-1537"><span class="linenos">1537</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1538"><a href="#L-1538"><span class="linenos">1538</span></a><span class="sd">        Calculate the 5D Euclidean distance between ```self``` and another Disulfide</span>
</span><span id="L-1539"><a href="#L-1539"><span class="linenos">1539</span></a><span class="sd">        object. This is used to compare Disulfide Bond torsion angles to </span>
</span><span id="L-1540"><a href="#L-1540"><span class="linenos">1540</span></a><span class="sd">        determine their torsional similarity via a 5-Dimensional Euclidean distance metric.</span>
</span><span id="L-1541"><a href="#L-1541"><span class="linenos">1541</span></a>
</span><span id="L-1542"><a href="#L-1542"><span class="linenos">1542</span></a><span class="sd">        :param other: Comparison Disulfide</span>
</span><span id="L-1543"><a href="#L-1543"><span class="linenos">1543</span></a><span class="sd">        :raises ProteusPyWarning: Warning if ```other``` is not a Disulfide object</span>
</span><span id="L-1544"><a href="#L-1544"><span class="linenos">1544</span></a><span class="sd">        :return: Euclidean distance (Degrees) between ```self``` and ```other```.</span>
</span><span id="L-1545"><a href="#L-1545"><span class="linenos">1545</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1546"><a href="#L-1546"><span class="linenos">1546</span></a>
</span><span id="L-1547"><a href="#L-1547"><span class="linenos">1547</span></a>        <span class="c1"># Check length of torsion arrays</span>
</span><span id="L-1548"><a href="#L-1548"><span class="linenos">1548</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">5</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">torsion_array</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="L-1549"><a href="#L-1549"><span class="linenos">1549</span></a>            <span class="k">raise</span> <span class="n">ProteusPyWarning</span><span class="p">(</span><span class="s2">&quot;--&gt; Torsion_Distance() requires vectors of length 5!&quot;</span><span class="p">)</span>
</span><span id="L-1550"><a href="#L-1550"><span class="linenos">1550</span></a>
</span><span id="L-1551"><a href="#L-1551"><span class="linenos">1551</span></a>        <span class="c1"># Convert to numpy arrays and add 180 to each element</span>
</span><span id="L-1552"><a href="#L-1552"><span class="linenos">1552</span></a>        <span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span><span class="p">)</span> <span class="o">+</span> <span class="mf">180.0</span>
</span><span id="L-1553"><a href="#L-1553"><span class="linenos">1553</span></a>        <span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">torsion_array</span><span class="p">)</span> <span class="o">+</span> <span class="mf">180.0</span>
</span><span id="L-1554"><a href="#L-1554"><span class="linenos">1554</span></a>
</span><span id="L-1555"><a href="#L-1555"><span class="linenos">1555</span></a>        <span class="c1"># Compute the 5D Euclidean distance using numpy&#39;s linalg.norm function</span>
</span><span id="L-1556"><a href="#L-1556"><span class="linenos">1556</span></a>        <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p1</span> <span class="o">-</span> <span class="n">p2</span><span class="p">)</span>
</span><span id="L-1557"><a href="#L-1557"><span class="linenos">1557</span></a>
</span><span id="L-1558"><a href="#L-1558"><span class="linenos">1558</span></a>        <span class="k">return</span> <span class="n">dist</span>
</span><span id="L-1559"><a href="#L-1559"><span class="linenos">1559</span></a>
</span><span id="L-1560"><a href="#L-1560"><span class="linenos">1560</span></a>    <span class="k">def</span> <span class="nf">Torsion_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">others</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">):</span>
</span><span id="L-1561"><a href="#L-1561"><span class="linenos">1561</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1562"><a href="#L-1562"><span class="linenos">1562</span></a><span class="sd">        Returns list of Disulfides within the angular cutoff in the others list.</span>
</span><span id="L-1563"><a href="#L-1563"><span class="linenos">1563</span></a><span class="sd">        This routine is used to find Disulfides having the same torsion length</span>
</span><span id="L-1564"><a href="#L-1564"><span class="linenos">1564</span></a><span class="sd">        within the others list. This is used to find families of Disulfides with</span>
</span><span id="L-1565"><a href="#L-1565"><span class="linenos">1565</span></a><span class="sd">        similar conformations. Assumes self is properly initialized.</span>
</span><span id="L-1566"><a href="#L-1566"><span class="linenos">1566</span></a><span class="sd">        </span>
</span><span id="L-1567"><a href="#L-1567"><span class="linenos">1567</span></a><span class="sd">        *NB* The routine will not distinguish between +/-</span>
</span><span id="L-1568"><a href="#L-1568"><span class="linenos">1568</span></a><span class="sd">        dihedral angles. *i.e.* [-60, -60, -90, -60, -60] would have the same</span>
</span><span id="L-1569"><a href="#L-1569"><span class="linenos">1569</span></a><span class="sd">        torsion length as [60, 60, 90, 60, 60], two clearly different structures.</span>
</span><span id="L-1570"><a href="#L-1570"><span class="linenos">1570</span></a>
</span><span id="L-1571"><a href="#L-1571"><span class="linenos">1571</span></a><span class="sd">        :param others: ```DisulfideList``` to search</span>
</span><span id="L-1572"><a href="#L-1572"><span class="linenos">1572</span></a><span class="sd">        :param cutoff: Dihedral angle degree cutoff</span>
</span><span id="L-1573"><a href="#L-1573"><span class="linenos">1573</span></a><span class="sd">        :return: DisulfideList within the cutoff</span>
</span><span id="L-1574"><a href="#L-1574"><span class="linenos">1574</span></a>
</span><span id="L-1575"><a href="#L-1575"><span class="linenos">1575</span></a><span class="sd">        Example:</span>
</span><span id="L-1576"><a href="#L-1576"><span class="linenos">1576</span></a><span class="sd">        In this example we load the disulfide database subset, find the disulfides with</span>
</span><span id="L-1577"><a href="#L-1577"><span class="linenos">1577</span></a><span class="sd">        the lowest and highest energies, and then find the nearest conformational neighbors.</span>
</span><span id="L-1578"><a href="#L-1578"><span class="linenos">1578</span></a><span class="sd">        Finally, we display the neighbors overlaid against a common reference frame.</span>
</span><span id="L-1579"><a href="#L-1579"><span class="linenos">1579</span></a>
</span><span id="L-1580"><a href="#L-1580"><span class="linenos">1580</span></a><span class="sd">        &gt;&gt;&gt; import proteusPy</span>
</span><span id="L-1581"><a href="#L-1581"><span class="linenos">1581</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideLoader import DisulfideLoader</span>
</span><span id="L-1582"><a href="#L-1582"><span class="linenos">1582</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideList import DisulfideList</span>
</span><span id="L-1583"><a href="#L-1583"><span class="linenos">1583</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.Disulfide import Disulfide</span>
</span><span id="L-1584"><a href="#L-1584"><span class="linenos">1584</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = None</span>
</span><span id="L-1585"><a href="#L-1585"><span class="linenos">1585</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = Load_PDB_SS(verbose=False, subset=True)</span>
</span><span id="L-1586"><a href="#L-1586"><span class="linenos">1586</span></a><span class="sd">        &gt;&gt;&gt; ss_list = DisulfideList([], &#39;tmp&#39;)</span>
</span><span id="L-1587"><a href="#L-1587"><span class="linenos">1587</span></a>
</span><span id="L-1588"><a href="#L-1588"><span class="linenos">1588</span></a><span class="sd">        We point to the complete list to search for lowest and highest energies.</span>
</span><span id="L-1589"><a href="#L-1589"><span class="linenos">1589</span></a><span class="sd">        &gt;&gt;&gt; sslist = PDB_SS.SSList</span>
</span><span id="L-1590"><a href="#L-1590"><span class="linenos">1590</span></a><span class="sd">        &gt;&gt;&gt; ssmin_enrg, ssmax_enrg = PDB_SS.SSList.minmax_energy()</span>
</span><span id="L-1591"><a href="#L-1591"><span class="linenos">1591</span></a>
</span><span id="L-1592"><a href="#L-1592"><span class="linenos">1592</span></a><span class="sd">        Make an empty list and find the nearest neighbors within 10 degrees avg RMS in</span>
</span><span id="L-1593"><a href="#L-1593"><span class="linenos">1593</span></a><span class="sd">        sidechain dihedral angle space.</span>
</span><span id="L-1594"><a href="#L-1594"><span class="linenos">1594</span></a>
</span><span id="L-1595"><a href="#L-1595"><span class="linenos">1595</span></a><span class="sd">        &gt;&gt;&gt; low_energy_neighbors = DisulfideList([],&#39;Neighbors&#39;)</span>
</span><span id="L-1596"><a href="#L-1596"><span class="linenos">1596</span></a><span class="sd">        &gt;&gt;&gt; low_energy_neighbors = ssmin_enrg.Torsion_neighbors(sslist, 10)</span>
</span><span id="L-1597"><a href="#L-1597"><span class="linenos">1597</span></a>
</span><span id="L-1598"><a href="#L-1598"><span class="linenos">1598</span></a><span class="sd">        Display the number found, and then display them overlaid onto their common reference frame.</span>
</span><span id="L-1599"><a href="#L-1599"><span class="linenos">1599</span></a>
</span><span id="L-1600"><a href="#L-1600"><span class="linenos">1600</span></a><span class="sd">        &gt;&gt;&gt; tot = low_energy_neighbors.length</span>
</span><span id="L-1601"><a href="#L-1601"><span class="linenos">1601</span></a><span class="sd">        &gt;&gt;&gt; print(f&#39;Neighbors: {tot}&#39;)</span>
</span><span id="L-1602"><a href="#L-1602"><span class="linenos">1602</span></a><span class="sd">        Neighbors: 2</span>
</span><span id="L-1603"><a href="#L-1603"><span class="linenos">1603</span></a><span class="sd">        &gt;&gt;&gt; low_energy_neighbors.display_overlay()</span>
</span><span id="L-1604"><a href="#L-1604"><span class="linenos">1604</span></a>
</span><span id="L-1605"><a href="#L-1605"><span class="linenos">1605</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1606"><a href="#L-1606"><span class="linenos">1606</span></a>        
</span><span id="L-1607"><a href="#L-1607"><span class="linenos">1607</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">ss</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">others</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Torsion_Distance</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">cutoff</span><span class="p">]</span>
</span><span id="L-1608"><a href="#L-1608"><span class="linenos">1608</span></a>        <span class="k">return</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s1">&#39;neighbors&#39;</span><span class="p">)</span>
</span><span id="L-1609"><a href="#L-1609"><span class="linenos">1609</span></a>        
</span><span id="L-1610"><a href="#L-1610"><span class="linenos">1610</span></a><span class="c1"># Class defination ends</span>
</span><span id="L-1611"><a href="#L-1611"><span class="linenos">1611</span></a>
</span><span id="L-1612"><a href="#L-1612"><span class="linenos">1612</span></a>
</span><span id="L-1613"><a href="#L-1613"><span class="linenos">1613</span></a><span class="k">def</span> <span class="nf">parse_ssbond_header_rec</span><span class="p">(</span><span class="n">ssbond_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-1614"><a href="#L-1614"><span class="linenos">1614</span></a>    <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1615"><a href="#L-1615"><span class="linenos">1615</span></a><span class="sd">    Parse the SSBOND dict returned by parse_pdb_header. </span>
</span><span id="L-1616"><a href="#L-1616"><span class="linenos">1616</span></a><span class="sd">    NB: Requires EGS-Modified BIO.parse_pdb_header.py.</span>
</span><span id="L-1617"><a href="#L-1617"><span class="linenos">1617</span></a><span class="sd">    This is used internally.</span>
</span><span id="L-1618"><a href="#L-1618"><span class="linenos">1618</span></a>
</span><span id="L-1619"><a href="#L-1619"><span class="linenos">1619</span></a><span class="sd">    :param ssbond_dict: the input SSBOND dict</span>
</span><span id="L-1620"><a href="#L-1620"><span class="linenos">1620</span></a><span class="sd">    :return: A list of tuples representing the proximal, </span>
</span><span id="L-1621"><a href="#L-1621"><span class="linenos">1621</span></a><span class="sd">        distal residue ids for the Disulfide.</span>
</span><span id="L-1622"><a href="#L-1622"><span class="linenos">1622</span></a><span class="sd">        </span>
</span><span id="L-1623"><a href="#L-1623"><span class="linenos">1623</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-1624"><a href="#L-1624"><span class="linenos">1624</span></a>    <span class="n">disulfide_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1625"><a href="#L-1625"><span class="linenos">1625</span></a>    <span class="k">for</span> <span class="n">ssb</span> <span class="ow">in</span> <span class="n">ssbond_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-1626"><a href="#L-1626"><span class="linenos">1626</span></a>        <span class="n">disulfide_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ssb</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-1627"><a href="#L-1627"><span class="linenos">1627</span></a>
</span><span id="L-1628"><a href="#L-1628"><span class="linenos">1628</span></a>    <span class="k">return</span> <span class="n">disulfide_list</span>
</span><span id="L-1629"><a href="#L-1629"><span class="linenos">1629</span></a>
</span><span id="L-1630"><a href="#L-1630"><span class="linenos">1630</span></a><span class="c1">#</span>
</span><span id="L-1631"><a href="#L-1631"><span class="linenos">1631</span></a><span class="c1"># function reads a comma separated list of PDB IDs and download the corresponding</span>
</span><span id="L-1632"><a href="#L-1632"><span class="linenos">1632</span></a><span class="c1"># .ent files to the PDB_DIR global. </span>
</span><span id="L-1633"><a href="#L-1633"><span class="linenos">1633</span></a><span class="c1"># Used to download the list of proteins containing at least one SS bond</span>
</span><span id="L-1634"><a href="#L-1634"><span class="linenos">1634</span></a><span class="c1"># with the ID list generated from: http://www.rcsb.org/</span>
</span><span id="L-1635"><a href="#L-1635"><span class="linenos">1635</span></a><span class="c1">#</span>
</span><span id="L-1636"><a href="#L-1636"><span class="linenos">1636</span></a>
</span><span id="L-1637"><a href="#L-1637"><span class="linenos">1637</span></a><span class="k">def</span> <span class="nf">Download_Disulfides</span><span class="p">(</span><span class="n">pdb_home</span><span class="o">=</span><span class="n">PDB_DIR</span><span class="p">,</span> <span class="n">model_home</span><span class="o">=</span><span class="n">MODEL_DIR</span><span class="p">,</span> 
</span><span id="L-1638"><a href="#L-1638"><span class="linenos">1638</span></a>                       <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1639"><a href="#L-1639"><span class="linenos">1639</span></a>    <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1640"><a href="#L-1640"><span class="linenos">1640</span></a><span class="sd">    Reads a comma separated list of PDB IDs and downloads them</span>
</span><span id="L-1641"><a href="#L-1641"><span class="linenos">1641</span></a><span class="sd">    to the pdb_home path. </span>
</span><span id="L-1642"><a href="#L-1642"><span class="linenos">1642</span></a>
</span><span id="L-1643"><a href="#L-1643"><span class="linenos">1643</span></a><span class="sd">    This utility function is used to download proteins containing at least </span>
</span><span id="L-1644"><a href="#L-1644"><span class="linenos">1644</span></a><span class="sd">    one SS bond with the ID list generated from: http://www.rcsb.org/.</span>
</span><span id="L-1645"><a href="#L-1645"><span class="linenos">1645</span></a>
</span><span id="L-1646"><a href="#L-1646"><span class="linenos">1646</span></a><span class="sd">    This is the primary data loader for the proteusPy Disulfide </span>
</span><span id="L-1647"><a href="#L-1647"><span class="linenos">1647</span></a><span class="sd">    analysis package. The list of IDs represents files in the </span>
</span><span id="L-1648"><a href="#L-1648"><span class="linenos">1648</span></a><span class="sd">    RCSB containing &gt; 1 disulfide bond, and it contains</span>
</span><span id="L-1649"><a href="#L-1649"><span class="linenos">1649</span></a><span class="sd">    over 39000 structures. The total download takes about 12 hours. The</span>
</span><span id="L-1650"><a href="#L-1650"><span class="linenos">1650</span></a><span class="sd">    function keeps track of downloaded files so it&#39;s possible to interrupt and</span>
</span><span id="L-1651"><a href="#L-1651"><span class="linenos">1651</span></a><span class="sd">    restart the download without duplicating effort.</span>
</span><span id="L-1652"><a href="#L-1652"><span class="linenos">1652</span></a>
</span><span id="L-1653"><a href="#L-1653"><span class="linenos">1653</span></a><span class="sd">    :param pdb_home: Path for downloaded files, defaults to PDB_DIR</span>
</span><span id="L-1654"><a href="#L-1654"><span class="linenos">1654</span></a><span class="sd">    :param model_home: Path for extracted data, defaults to MODEL_DIR</span>
</span><span id="L-1655"><a href="#L-1655"><span class="linenos">1655</span></a><span class="sd">    :param verbose: Verbosity, defaults to False</span>
</span><span id="L-1656"><a href="#L-1656"><span class="linenos">1656</span></a><span class="sd">    :param reset: Reset the downloaded files index. Used to restart the download.</span>
</span><span id="L-1657"><a href="#L-1657"><span class="linenos">1657</span></a><span class="sd">    :raises DisulfideIOException: I/O error raised when the PDB file is not found.</span>
</span><span id="L-1658"><a href="#L-1658"><span class="linenos">1658</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-1659"><a href="#L-1659"><span class="linenos">1659</span></a>    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-1660"><a href="#L-1660"><span class="linenos">1660</span></a>    <span class="n">donelines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1661"><a href="#L-1661"><span class="linenos">1661</span></a>    <span class="n">SS_done</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1662"><a href="#L-1662"><span class="linenos">1662</span></a>    <span class="n">ssfile</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1663"><a href="#L-1663"><span class="linenos">1663</span></a>    
</span><span id="L-1664"><a href="#L-1664"><span class="linenos">1664</span></a>    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</span><span id="L-1665"><a href="#L-1665"><span class="linenos">1665</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">pdb_home</span><span class="p">)</span>
</span><span id="L-1666"><a href="#L-1666"><span class="linenos">1666</span></a>
</span><span id="L-1667"><a href="#L-1667"><span class="linenos">1667</span></a>    <span class="n">pdblist</span> <span class="o">=</span> <span class="n">PDBList</span><span class="p">(</span><span class="n">pdb</span><span class="o">=</span><span class="n">pdb_home</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="L-1668"><a href="#L-1668"><span class="linenos">1668</span></a>    <span class="n">ssfilename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_home</span><span class="si">}{</span><span class="n">SS_ID_FILE</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-1669"><a href="#L-1669"><span class="linenos">1669</span></a>    <span class="nb">print</span><span class="p">(</span><span class="n">ssfilename</span><span class="p">)</span>
</span><span id="L-1670"><a href="#L-1670"><span class="linenos">1670</span></a>    
</span><span id="L-1671"><a href="#L-1671"><span class="linenos">1671</span></a>    <span class="c1"># list of IDs containing &gt;1 SSBond record</span>
</span><span id="L-1672"><a href="#L-1672"><span class="linenos">1672</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-1673"><a href="#L-1673"><span class="linenos">1673</span></a>        <span class="n">ssfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">ssfilename</span><span class="p">)</span>
</span><span id="L-1674"><a href="#L-1674"><span class="linenos">1674</span></a>        <span class="n">Line</span> <span class="o">=</span> <span class="n">ssfile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="L-1675"><a href="#L-1675"><span class="linenos">1675</span></a>    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="L-1676"><a href="#L-1676"><span class="linenos">1676</span></a>        <span class="k">raise</span> <span class="n">DisulfideIOException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot open file: </span><span class="si">{</span><span class="n">ssfile</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1677"><a href="#L-1677"><span class="linenos">1677</span></a>
</span><span id="L-1678"><a href="#L-1678"><span class="linenos">1678</span></a>    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="L-1679"><a href="#L-1679"><span class="linenos">1679</span></a>        <span class="n">entries</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span><span id="L-1680"><a href="#L-1680"><span class="linenos">1680</span></a>
</span><span id="L-1681"><a href="#L-1681"><span class="linenos">1681</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Found: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span><span class="si">}</span><span class="s1"> entries&#39;</span><span class="p">)</span>
</span><span id="L-1682"><a href="#L-1682"><span class="linenos">1682</span></a>    <span class="n">completed</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xxx&#39;</span><span class="p">}</span> <span class="c1"># set to keep track of downloaded</span>
</span><span id="L-1683"><a href="#L-1683"><span class="linenos">1683</span></a>
</span><span id="L-1684"><a href="#L-1684"><span class="linenos">1684</span></a>    <span class="c1"># file to track already downloaded entries.</span>
</span><span id="L-1685"><a href="#L-1685"><span class="linenos">1685</span></a>    <span class="k">if</span> <span class="n">reset</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
</span><span id="L-1686"><a href="#L-1686"><span class="linenos">1686</span></a>        <span class="n">completed_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_home</span><span class="si">}</span><span class="s1">ss_completed.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="L-1687"><a href="#L-1687"><span class="linenos">1687</span></a>        <span class="n">donelines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1688"><a href="#L-1688"><span class="linenos">1688</span></a>        <span class="n">SS_DONE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1689"><a href="#L-1689"><span class="linenos">1689</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1690"><a href="#L-1690"><span class="linenos">1690</span></a>        <span class="n">completed_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_home</span><span class="si">}</span><span class="s1">ss_completed.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w+&#39;</span><span class="p">)</span>
</span><span id="L-1691"><a href="#L-1691"><span class="linenos">1691</span></a>        <span class="n">donelines</span> <span class="o">=</span> <span class="n">completed_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="L-1692"><a href="#L-1692"><span class="linenos">1692</span></a>
</span><span id="L-1693"><a href="#L-1693"><span class="linenos">1693</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">donelines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1694"><a href="#L-1694"><span class="linenos">1694</span></a>        <span class="k">for</span> <span class="n">dl</span> <span class="ow">in</span> <span class="n">donelines</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="L-1695"><a href="#L-1695"><span class="linenos">1695</span></a>            <span class="c1"># create a list of pdb id already downloaded</span>
</span><span id="L-1696"><a href="#L-1696"><span class="linenos">1696</span></a>            <span class="n">SS_done</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span><span id="L-1697"><a href="#L-1697"><span class="linenos">1697</span></a>
</span><span id="L-1698"><a href="#L-1698"><span class="linenos">1698</span></a>    <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">SS_done</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-1699"><a href="#L-1699"><span class="linenos">1699</span></a>    <span class="n">completed</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">SS_done</span><span class="p">)</span> <span class="c1"># update the completed set with what&#39;s downloaded</span>
</span><span id="L-1700"><a href="#L-1700"><span class="linenos">1700</span></a>
</span><span id="L-1701"><a href="#L-1701"><span class="linenos">1701</span></a>    <span class="c1"># Loop over all entries, </span>
</span><span id="L-1702"><a href="#L-1702"><span class="linenos">1702</span></a>    <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">PBAR_COLS</span><span class="p">)</span>
</span><span id="L-1703"><a href="#L-1703"><span class="linenos">1703</span></a>    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">pbar</span><span class="p">:</span>
</span><span id="L-1704"><a href="#L-1704"><span class="linenos">1704</span></a>        <span class="n">pbar</span><span class="o">.</span><span class="n">set_postfix</span><span class="p">({</span><span class="s1">&#39;Entry&#39;</span><span class="p">:</span> <span class="n">entry</span><span class="p">})</span>
</span><span id="L-1705"><a href="#L-1705"><span class="linenos">1705</span></a>        <span class="k">if</span> <span class="n">entry</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">completed</span><span class="p">:</span>
</span><span id="L-1706"><a href="#L-1706"><span class="linenos">1706</span></a>            <span class="k">if</span> <span class="n">pdblist</span><span class="o">.</span><span class="n">retrieve_pdb_file</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s1">&#39;pdb&#39;</span><span class="p">,</span> <span class="n">pdir</span><span class="o">=</span><span class="n">pdb_home</span><span class="p">):</span>
</span><span id="L-1707"><a href="#L-1707"><span class="linenos">1707</span></a>                <span class="n">completed</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span><span id="L-1708"><a href="#L-1708"><span class="linenos">1708</span></a>                <span class="n">completed_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">,&#39;</span><span class="p">)</span>
</span><span id="L-1709"><a href="#L-1709"><span class="linenos">1709</span></a>                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-1710"><a href="#L-1710"><span class="linenos">1710</span></a>
</span><span id="L-1711"><a href="#L-1711"><span class="linenos">1711</span></a>    <span class="n">completed_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-1712"><a href="#L-1712"><span class="linenos">1712</span></a>
</span><span id="L-1713"><a href="#L-1713"><span class="linenos">1713</span></a>    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-1714"><a href="#L-1714"><span class="linenos">1714</span></a>    <span class="n">elapsed</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>
</span><span id="L-1715"><a href="#L-1715"><span class="linenos">1715</span></a>
</span><span id="L-1716"><a href="#L-1716"><span class="linenos">1716</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Overall files processed: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1717"><a href="#L-1717"><span class="linenos">1717</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Complete. Elapsed time: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed</span><span class="p">)</span><span class="si">}</span><span class="s1"> (h:m:s)&#39;</span><span class="p">)</span>
</span><span id="L-1718"><a href="#L-1718"><span class="linenos">1718</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
</span><span id="L-1719"><a href="#L-1719"><span class="linenos">1719</span></a>    <span class="k">return</span>
</span><span id="L-1720"><a href="#L-1720"><span class="linenos">1720</span></a>
</span><span id="L-1721"><a href="#L-1721"><span class="linenos">1721</span></a><span class="k">def</span> <span class="nf">Extract_Disulfides</span><span class="p">(</span><span class="n">numb</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pdbdir</span><span class="o">=</span><span class="n">PDB_DIR</span><span class="p">,</span> 
</span><span id="L-1722"><a href="#L-1722"><span class="linenos">1722</span></a>                        <span class="n">datadir</span><span class="o">=</span><span class="n">MODEL_DIR</span><span class="p">,</span> <span class="n">picklefile</span><span class="o">=</span><span class="n">SS_PICKLE_FILE</span><span class="p">,</span>
</span><span id="L-1723"><a href="#L-1723"><span class="linenos">1723</span></a>                        <span class="n">torsionfile</span><span class="o">=</span><span class="n">SS_TORSIONS_FILE</span><span class="p">,</span> 
</span><span id="L-1724"><a href="#L-1724"><span class="linenos">1724</span></a>                        <span class="n">problemfile</span><span class="o">=</span><span class="n">PROBLEM_ID_FILE</span><span class="p">,</span>
</span><span id="L-1725"><a href="#L-1725"><span class="linenos">1725</span></a>                        <span class="n">dictfile</span><span class="o">=</span><span class="n">SS_DICT_PICKLE_FILE</span><span class="p">,</span>
</span><span id="L-1726"><a href="#L-1726"><span class="linenos">1726</span></a>                        <span class="n">dist_cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1727"><a href="#L-1727"><span class="linenos">1727</span></a>    <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1728"><a href="#L-1728"><span class="linenos">1728</span></a><span class="sd">    This function creates .pkl files needed for the </span>
</span><span id="L-1729"><a href="#L-1729"><span class="linenos">1729</span></a><span class="sd">    proteusPy.DisulfideLoader.DisulfideLoader class. </span>
</span><span id="L-1730"><a href="#L-1730"><span class="linenos">1730</span></a><span class="sd">    The ```Disulfide``` objects are contained in a ```DisulfideList``` object and </span>
</span><span id="L-1731"><a href="#L-1731"><span class="linenos">1731</span></a><span class="sd">    ```Dict``` within these files. In addition, .csv files containing all of </span>
</span><span id="L-1732"><a href="#L-1732"><span class="linenos">1732</span></a><span class="sd">    the torsions for the disulfides and problem IDs are written. The optional</span>
</span><span id="L-1733"><a href="#L-1733"><span class="linenos">1733</span></a><span class="sd">    ```dist_cutoff``` allows for removal of Disufides whose Cα-Cα distance is &gt;</span>
</span><span id="L-1734"><a href="#L-1734"><span class="linenos">1734</span></a><span class="sd">    than the cutoff value. If it&#39;s -1.0 then the function keeps all Disulfides.</span>
</span><span id="L-1735"><a href="#L-1735"><span class="linenos">1735</span></a>
</span><span id="L-1736"><a href="#L-1736"><span class="linenos">1736</span></a><span class="sd">    :param numb:           number of entries to process, defaults to all</span>
</span><span id="L-1737"><a href="#L-1737"><span class="linenos">1737</span></a><span class="sd">    :param verbose:        more messages</span>
</span><span id="L-1738"><a href="#L-1738"><span class="linenos">1738</span></a><span class="sd">    :param quiet:          turns off DisulfideConstruction warnings</span>
</span><span id="L-1739"><a href="#L-1739"><span class="linenos">1739</span></a><span class="sd">    :param pdbdir:         path to PDB files</span>
</span><span id="L-1740"><a href="#L-1740"><span class="linenos">1740</span></a><span class="sd">    :param datadir:        path to resulting .pkl files</span>
</span><span id="L-1741"><a href="#L-1741"><span class="linenos">1741</span></a><span class="sd">    :param picklefile:     name of the disulfide .pkl file</span>
</span><span id="L-1742"><a href="#L-1742"><span class="linenos">1742</span></a><span class="sd">    :param torsionfile:    name of the disulfide torsion file .csv created</span>
</span><span id="L-1743"><a href="#L-1743"><span class="linenos">1743</span></a><span class="sd">    :param problemfile:    name of the .csv file containing problem ids</span>
</span><span id="L-1744"><a href="#L-1744"><span class="linenos">1744</span></a><span class="sd">    :param dictfile:       name of the .pkl file</span>
</span><span id="L-1745"><a href="#L-1745"><span class="linenos">1745</span></a><span class="sd">    :param dist_cutoff:    Ca distance cutoff to reject a Disulfide.</span>
</span><span id="L-1746"><a href="#L-1746"><span class="linenos">1746</span></a><span class="sd">    </span>
</span><span id="L-1747"><a href="#L-1747"><span class="linenos">1747</span></a><span class="sd">    The following examples illustrate some basic functions of the disulfide classes:</span>
</span><span id="L-1748"><a href="#L-1748"><span class="linenos">1748</span></a>
</span><span id="L-1749"><a href="#L-1749"><span class="linenos">1749</span></a><span class="sd">    &gt;&gt;&gt; from proteusPy.Disulfide import Disulfide </span>
</span><span id="L-1750"><a href="#L-1750"><span class="linenos">1750</span></a><span class="sd">    &gt;&gt;&gt; from proteusPy.DisulfideLoader import DisulfideLoader</span>
</span><span id="L-1751"><a href="#L-1751"><span class="linenos">1751</span></a><span class="sd">    &gt;&gt;&gt; from proteusPy.DisulfideList import DisulfideList</span>
</span><span id="L-1752"><a href="#L-1752"><span class="linenos">1752</span></a><span class="sd">        </span>
</span><span id="L-1753"><a href="#L-1753"><span class="linenos">1753</span></a><span class="sd">    Instantiate some variables. Note: the list is initialized with an iterable and a name (optional)</span>
</span><span id="L-1754"><a href="#L-1754"><span class="linenos">1754</span></a>
</span><span id="L-1755"><a href="#L-1755"><span class="linenos">1755</span></a><span class="sd">    &gt;&gt;&gt; SS = Disulfide(&#39;tmp&#39;)</span>
</span><span id="L-1756"><a href="#L-1756"><span class="linenos">1756</span></a><span class="sd">    &gt;&gt;&gt; SSlist = DisulfideList([],&#39;ss&#39;)</span>
</span><span id="L-1757"><a href="#L-1757"><span class="linenos">1757</span></a><span class="sd">    </span>
</span><span id="L-1758"><a href="#L-1758"><span class="linenos">1758</span></a><span class="sd">    Load the Disulfide subset database. This contains around 8300 disulfides and loads</span>
</span><span id="L-1759"><a href="#L-1759"><span class="linenos">1759</span></a><span class="sd">    fairly quickly.</span>
</span><span id="L-1760"><a href="#L-1760"><span class="linenos">1760</span></a>
</span><span id="L-1761"><a href="#L-1761"><span class="linenos">1761</span></a><span class="sd">    &gt;&gt;&gt; PDB_SS = DisulfideLoader(verbose=False, subset=True)</span>
</span><span id="L-1762"><a href="#L-1762"><span class="linenos">1762</span></a>
</span><span id="L-1763"><a href="#L-1763"><span class="linenos">1763</span></a><span class="sd">    The dataset can be indexed numerically, up to index: PDB_SS.Length(). Get the first SS:</span>
</span><span id="L-1764"><a href="#L-1764"><span class="linenos">1764</span></a><span class="sd">    &gt;&gt;&gt; SS = PDB_SS[0]</span>
</span><span id="L-1765"><a href="#L-1765"><span class="linenos">1765</span></a><span class="sd">    &gt;&gt;&gt; SS</span>
</span><span id="L-1766"><a href="#L-1766"><span class="linenos">1766</span></a><span class="sd">    &lt;Disulfide 4yys_22A_65A, Source: 4yys, Resolution: 1.35 Å&gt;</span>
</span><span id="L-1767"><a href="#L-1767"><span class="linenos">1767</span></a>
</span><span id="L-1768"><a href="#L-1768"><span class="linenos">1768</span></a><span class="sd">    The dataset can also be indexed by PDB ID. Get the DisulfideList for ID 4yys:</span>
</span><span id="L-1769"><a href="#L-1769"><span class="linenos">1769</span></a>
</span><span id="L-1770"><a href="#L-1770"><span class="linenos">1770</span></a><span class="sd">    &gt;&gt;&gt; SS4yys = PDB_SS[&#39;4yys&#39;]</span>
</span><span id="L-1771"><a href="#L-1771"><span class="linenos">1771</span></a><span class="sd">    &gt;&gt;&gt; SS4yys</span>
</span><span id="L-1772"><a href="#L-1772"><span class="linenos">1772</span></a><span class="sd">    [&lt;Disulfide 4yys_22A_65A, Source: 4yys, Resolution: 1.35 Å&gt;, &lt;Disulfide 4yys_56A_98A, Source: 4yys, Resolution: 1.35 Å&gt;, &lt;Disulfide 4yys_156A_207A, Source: 4yys, Resolution: 1.35 Å&gt;]</span>
</span><span id="L-1773"><a href="#L-1773"><span class="linenos">1773</span></a>
</span><span id="L-1774"><a href="#L-1774"><span class="linenos">1774</span></a><span class="sd">    Make some empty disulfides:</span>
</span><span id="L-1775"><a href="#L-1775"><span class="linenos">1775</span></a>
</span><span id="L-1776"><a href="#L-1776"><span class="linenos">1776</span></a><span class="sd">    &gt;&gt;&gt; ss1 = Disulfide(&#39;ss1&#39;)</span>
</span><span id="L-1777"><a href="#L-1777"><span class="linenos">1777</span></a><span class="sd">    &gt;&gt;&gt; ss2 = Disulfide(&#39;ss2&#39;)</span>
</span><span id="L-1778"><a href="#L-1778"><span class="linenos">1778</span></a>
</span><span id="L-1779"><a href="#L-1779"><span class="linenos">1779</span></a><span class="sd">    Make a DisulfideList containing ss1, named &#39;tmp&#39;:</span>
</span><span id="L-1780"><a href="#L-1780"><span class="linenos">1780</span></a>
</span><span id="L-1781"><a href="#L-1781"><span class="linenos">1781</span></a><span class="sd">    &gt;&gt;&gt; sslist = DisulfideList([ss1], &#39;tmp&#39;)</span>
</span><span id="L-1782"><a href="#L-1782"><span class="linenos">1782</span></a>
</span><span id="L-1783"><a href="#L-1783"><span class="linenos">1783</span></a><span class="sd">    Append ss2:</span>
</span><span id="L-1784"><a href="#L-1784"><span class="linenos">1784</span></a><span class="sd">    &gt;&gt;&gt; sslist.append(ss2)</span>
</span><span id="L-1785"><a href="#L-1785"><span class="linenos">1785</span></a>
</span><span id="L-1786"><a href="#L-1786"><span class="linenos">1786</span></a><span class="sd">    Extract the first disulfide and print it:</span>
</span><span id="L-1787"><a href="#L-1787"><span class="linenos">1787</span></a>
</span><span id="L-1788"><a href="#L-1788"><span class="linenos">1788</span></a><span class="sd">    &gt;&gt;&gt; ss1 = PDB_SS[0]</span>
</span><span id="L-1789"><a href="#L-1789"><span class="linenos">1789</span></a><span class="sd">    &gt;&gt;&gt; ss1.pprint_all()</span>
</span><span id="L-1790"><a href="#L-1790"><span class="linenos">1790</span></a><span class="sd">    &lt;Disulfide 4yys_22A_65A, Source: 4yys, Resolution: 1.35 Å</span>
</span><span id="L-1791"><a href="#L-1791"><span class="linenos">1791</span></a><span class="sd">     Proximal Chain fullID: &lt;(&#39;4yys&#39;, 0, &#39;A&#39;, (&#39; &#39;, 22, &#39; &#39;))&gt; Distal Chain fullID: &lt;(&#39;4yys&#39;, 0, &#39;A&#39;, (&#39; &#39;, 65, &#39; &#39;))&gt; </span>
</span><span id="L-1792"><a href="#L-1792"><span class="linenos">1792</span></a><span class="sd">    Proximal Coordinates:</span>
</span><span id="L-1793"><a href="#L-1793"><span class="linenos">1793</span></a><span class="sd">       N: &lt;Vector -2.36, -20.48, 5.21&gt;</span>
</span><span id="L-1794"><a href="#L-1794"><span class="linenos">1794</span></a><span class="sd">       Cα: &lt;Vector -2.10, -19.89, 3.90&gt;</span>
</span><span id="L-1795"><a href="#L-1795"><span class="linenos">1795</span></a><span class="sd">       C: &lt;Vector -1.12, -18.78, 4.12&gt;</span>
</span><span id="L-1796"><a href="#L-1796"><span class="linenos">1796</span></a><span class="sd">       O: &lt;Vector -1.30, -17.96, 5.03&gt;</span>
</span><span id="L-1797"><a href="#L-1797"><span class="linenos">1797</span></a><span class="sd">       Cβ: &lt;Vector -3.38, -19.31, 3.32&gt;</span>
</span><span id="L-1798"><a href="#L-1798"><span class="linenos">1798</span></a><span class="sd">       Sγ: &lt;Vector -3.24, -18.40, 1.76&gt;</span>
</span><span id="L-1799"><a href="#L-1799"><span class="linenos">1799</span></a><span class="sd">       Cprev &lt;Vector -2.67, -21.75, 5.36&gt;</span>
</span><span id="L-1800"><a href="#L-1800"><span class="linenos">1800</span></a><span class="sd">       Nnext: &lt;Vector -0.02, -18.76, 3.36&gt;</span>
</span><span id="L-1801"><a href="#L-1801"><span class="linenos">1801</span></a><span class="sd">     Distal Coordinates:</span>
</span><span id="L-1802"><a href="#L-1802"><span class="linenos">1802</span></a><span class="sd">       N: &lt;Vector -0.60, -18.71, -1.62&gt;</span>
</span><span id="L-1803"><a href="#L-1803"><span class="linenos">1803</span></a><span class="sd">       Cα: &lt;Vector -0.48, -19.10, -0.22&gt;</span>
</span><span id="L-1804"><a href="#L-1804"><span class="linenos">1804</span></a><span class="sd">       C: &lt;Vector 0.92, -19.52, 0.18&gt;</span>
</span><span id="L-1805"><a href="#L-1805"><span class="linenos">1805</span></a><span class="sd">       O: &lt;Vector 1.10, -20.09, 1.25&gt;</span>
</span><span id="L-1806"><a href="#L-1806"><span class="linenos">1806</span></a><span class="sd">       Cβ: &lt;Vector -1.48, -20.23, 0.08&gt;</span>
</span><span id="L-1807"><a href="#L-1807"><span class="linenos">1807</span></a><span class="sd">       Sγ: &lt;Vector -3.22, -19.69, 0.18&gt;</span>
</span><span id="L-1808"><a href="#L-1808"><span class="linenos">1808</span></a><span class="sd">       Cprev &lt;Vector -0.73, -17.44, -2.01&gt;</span>
</span><span id="L-1809"><a href="#L-1809"><span class="linenos">1809</span></a><span class="sd">       Nnext: &lt;Vector 1.92, -19.18, -0.63&gt;</span>
</span><span id="L-1810"><a href="#L-1810"><span class="linenos">1810</span></a><span class="sd">    &lt;BLANKLINE&gt;</span>
</span><span id="L-1811"><a href="#L-1811"><span class="linenos">1811</span></a><span class="sd">     Proximal Internal Coords:</span>
</span><span id="L-1812"><a href="#L-1812"><span class="linenos">1812</span></a><span class="sd">       N: &lt;Vector -0.41, 1.40, -0.00&gt;</span>
</span><span id="L-1813"><a href="#L-1813"><span class="linenos">1813</span></a><span class="sd">       Cα: &lt;Vector 0.00, 0.00, 0.00&gt;</span>
</span><span id="L-1814"><a href="#L-1814"><span class="linenos">1814</span></a><span class="sd">       C: &lt;Vector 1.50, 0.00, 0.00&gt;</span>
</span><span id="L-1815"><a href="#L-1815"><span class="linenos">1815</span></a><span class="sd">       O: &lt;Vector 2.12, 0.71, -0.80&gt;</span>
</span><span id="L-1816"><a href="#L-1816"><span class="linenos">1816</span></a><span class="sd">       Cβ: &lt;Vector -0.50, -0.70, -1.25&gt;</span>
</span><span id="L-1817"><a href="#L-1817"><span class="linenos">1817</span></a><span class="sd">       Sγ: &lt;Vector 0.04, -2.41, -1.50&gt;</span>
</span><span id="L-1818"><a href="#L-1818"><span class="linenos">1818</span></a><span class="sd">       Cprev &lt;Vector -2.67, -21.75, 5.36&gt;</span>
</span><span id="L-1819"><a href="#L-1819"><span class="linenos">1819</span></a><span class="sd">       Nnext: &lt;Vector -0.02, -18.76, 3.36&gt;</span>
</span><span id="L-1820"><a href="#L-1820"><span class="linenos">1820</span></a><span class="sd">    Distal Internal Coords:</span>
</span><span id="L-1821"><a href="#L-1821"><span class="linenos">1821</span></a><span class="sd">       N: &lt;Vector 1.04, -5.63, 1.17&gt;</span>
</span><span id="L-1822"><a href="#L-1822"><span class="linenos">1822</span></a><span class="sd">       Cα: &lt;Vector 1.04, -4.18, 1.31&gt;</span>
</span><span id="L-1823"><a href="#L-1823"><span class="linenos">1823</span></a><span class="sd">       C: &lt;Vector 1.72, -3.68, 2.57&gt;</span>
</span><span id="L-1824"><a href="#L-1824"><span class="linenos">1824</span></a><span class="sd">       O: &lt;Vector 1.57, -2.51, 2.92&gt;</span>
</span><span id="L-1825"><a href="#L-1825"><span class="linenos">1825</span></a><span class="sd">       Cβ: &lt;Vector -0.41, -3.66, 1.24&gt;</span>
</span><span id="L-1826"><a href="#L-1826"><span class="linenos">1826</span></a><span class="sd">       Sγ: &lt;Vector -1.14, -3.69, -0.43&gt;</span>
</span><span id="L-1827"><a href="#L-1827"><span class="linenos">1827</span></a><span class="sd">       Cprev &lt;Vector -0.73, -17.44, -2.01&gt;</span>
</span><span id="L-1828"><a href="#L-1828"><span class="linenos">1828</span></a><span class="sd">       Nnext: &lt;Vector 1.92, -19.18, -0.63&gt;</span>
</span><span id="L-1829"><a href="#L-1829"><span class="linenos">1829</span></a><span class="sd">     Χ1-Χ5: 174.63°, 82.52°, -83.32°, -62.52° -73.83°, 1.70 kcal/mol</span>
</span><span id="L-1830"><a href="#L-1830"><span class="linenos">1830</span></a><span class="sd">     Cα Distance: 4.50 Å</span>
</span><span id="L-1831"><a href="#L-1831"><span class="linenos">1831</span></a><span class="sd">     Torsion length: 231.53 deg&gt;</span>
</span><span id="L-1832"><a href="#L-1832"><span class="linenos">1832</span></a>
</span><span id="L-1833"><a href="#L-1833"><span class="linenos">1833</span></a><span class="sd">    Get a list of disulfides via slicing and display them oriented against a common</span>
</span><span id="L-1834"><a href="#L-1834"><span class="linenos">1834</span></a><span class="sd">    reference frame (the proximal N, Cα, C&#39;).</span>
</span><span id="L-1835"><a href="#L-1835"><span class="linenos">1835</span></a>
</span><span id="L-1836"><a href="#L-1836"><span class="linenos">1836</span></a><span class="sd">    &gt;&gt;&gt; subset = DisulfideList(PDB_SS[0:10],&#39;subset&#39;)</span>
</span><span id="L-1837"><a href="#L-1837"><span class="linenos">1837</span></a><span class="sd">    &gt;&gt;&gt; subset.display_overlay()</span>
</span><span id="L-1838"><a href="#L-1838"><span class="linenos">1838</span></a>
</span><span id="L-1839"><a href="#L-1839"><span class="linenos">1839</span></a><span class="sd">    Take a screenshot. You can position the orientation, then close the window:</span>
</span><span id="L-1840"><a href="#L-1840"><span class="linenos">1840</span></a><span class="sd">    &gt;&gt;&gt; subset.screenshot(style=&#39;sb&#39;, fname=&#39;subset.png&#39;)</span>
</span><span id="L-1841"><a href="#L-1841"><span class="linenos">1841</span></a><span class="sd">    ---&gt; screenshot(): Saving file: subset.png</span>
</span><span id="L-1842"><a href="#L-1842"><span class="linenos">1842</span></a><span class="sd">    ---&gt; screenshot(): Saved file: subset.png</span>
</span><span id="L-1843"><a href="#L-1843"><span class="linenos">1843</span></a>
</span><span id="L-1844"><a href="#L-1844"><span class="linenos">1844</span></a><span class="sd">    Browse the documentation for more functionality. The display functions are particularly useful.</span>
</span><span id="L-1845"><a href="#L-1845"><span class="linenos">1845</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-1846"><a href="#L-1846"><span class="linenos">1846</span></a>
</span><span id="L-1847"><a href="#L-1847"><span class="linenos">1847</span></a>    <span class="k">def</span> <span class="nf">name_to_id</span><span class="p">(</span><span class="n">fname</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1848"><a href="#L-1848"><span class="linenos">1848</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1849"><a href="#L-1849"><span class="linenos">1849</span></a><span class="sd">        Returns the PDB ID from the filename.</span>
</span><span id="L-1850"><a href="#L-1850"><span class="linenos">1850</span></a>
</span><span id="L-1851"><a href="#L-1851"><span class="linenos">1851</span></a><span class="sd">        :param fname: Complete PDB filename</span>
</span><span id="L-1852"><a href="#L-1852"><span class="linenos">1852</span></a><span class="sd">        :return: PDB ID</span>
</span><span id="L-1853"><a href="#L-1853"><span class="linenos">1853</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-1854"><a href="#L-1854"><span class="linenos">1854</span></a>        <span class="n">ent</span> <span class="o">=</span> <span class="n">fname</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
</span><span id="L-1855"><a href="#L-1855"><span class="linenos">1855</span></a>        <span class="k">return</span> <span class="n">ent</span>
</span><span id="L-1856"><a href="#L-1856"><span class="linenos">1856</span></a>
</span><span id="L-1857"><a href="#L-1857"><span class="linenos">1857</span></a>    <span class="n">entrylist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1858"><a href="#L-1858"><span class="linenos">1858</span></a>    <span class="n">problem_ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1859"><a href="#L-1859"><span class="linenos">1859</span></a>    <span class="n">bad</span> <span class="o">=</span> <span class="n">bad_dist</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1860"><a href="#L-1860"><span class="linenos">1860</span></a>
</span><span id="L-1861"><a href="#L-1861"><span class="linenos">1861</span></a>    <span class="c1"># we use the specialized list class DisulfideList to contain our disulfides</span>
</span><span id="L-1862"><a href="#L-1862"><span class="linenos">1862</span></a>    <span class="c1"># we&#39;ll use a dict to store DisulfideList objects, indexed by the structure ID</span>
</span><span id="L-1863"><a href="#L-1863"><span class="linenos">1863</span></a>    <span class="n">All_ss_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1864"><a href="#L-1864"><span class="linenos">1864</span></a>    <span class="n">All_ss_list</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span><span class="s1">&#39;PDB_SS&#39;</span><span class="p">)</span>
</span><span id="L-1865"><a href="#L-1865"><span class="linenos">1865</span></a>    <span class="n">All_ss_dict2</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># new dict of pointers to indices</span>
</span><span id="L-1866"><a href="#L-1866"><span class="linenos">1866</span></a>
</span><span id="L-1867"><a href="#L-1867"><span class="linenos">1867</span></a>    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-1868"><a href="#L-1868"><span class="linenos">1868</span></a>    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</span><span id="L-1869"><a href="#L-1869"><span class="linenos">1869</span></a>
</span><span id="L-1870"><a href="#L-1870"><span class="linenos">1870</span></a>    <span class="c1"># Build a list of PDB files in PDB_DIR that are readable. These files were downloaded</span>
</span><span id="L-1871"><a href="#L-1871"><span class="linenos">1871</span></a>    <span class="c1"># via the RCSB web query interface for structures containing &gt;= 1 SS Bond.</span>
</span><span id="L-1872"><a href="#L-1872"><span class="linenos">1872</span></a>
</span><span id="L-1873"><a href="#L-1873"><span class="linenos">1873</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">pdbdir</span><span class="p">)</span>
</span><span id="L-1874"><a href="#L-1874"><span class="linenos">1874</span></a>
</span><span id="L-1875"><a href="#L-1875"><span class="linenos">1875</span></a>    <span class="n">ss_filelist</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;*.ent&#39;</span><span class="p">)</span>
</span><span id="L-1876"><a href="#L-1876"><span class="linenos">1876</span></a>    <span class="n">tot</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ss_filelist</span><span class="p">)</span>
</span><span id="L-1877"><a href="#L-1877"><span class="linenos">1877</span></a>
</span><span id="L-1878"><a href="#L-1878"><span class="linenos">1878</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1879"><a href="#L-1879"><span class="linenos">1879</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PDB Directory </span><span class="si">{</span><span class="n">pdbdir</span><span class="si">}</span><span class="s1"> contains: </span><span class="si">{</span><span class="n">tot</span><span class="si">}</span><span class="s1"> files&#39;</span><span class="p">)</span>
</span><span id="L-1880"><a href="#L-1880"><span class="linenos">1880</span></a>
</span><span id="L-1881"><a href="#L-1881"><span class="linenos">1881</span></a>    <span class="c1"># the filenames are in the form pdb{entry}.ent, I loop through them and extract</span>
</span><span id="L-1882"><a href="#L-1882"><span class="linenos">1882</span></a>    <span class="c1"># the PDB ID, with Disulfide.name_to_id(), then add to entrylist.</span>
</span><span id="L-1883"><a href="#L-1883"><span class="linenos">1883</span></a>
</span><span id="L-1884"><a href="#L-1884"><span class="linenos">1884</span></a>    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">ss_filelist</span><span class="p">:</span>
</span><span id="L-1885"><a href="#L-1885"><span class="linenos">1885</span></a>        <span class="n">entrylist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name_to_id</span><span class="p">(</span><span class="n">entry</span><span class="p">))</span>
</span><span id="L-1886"><a href="#L-1886"><span class="linenos">1886</span></a>
</span><span id="L-1887"><a href="#L-1887"><span class="linenos">1887</span></a>    <span class="c1"># create a dataframe with the following columns for the disulfide conformations </span>
</span><span id="L-1888"><a href="#L-1888"><span class="linenos">1888</span></a>    <span class="c1"># extracted from the structure</span>
</span><span id="L-1889"><a href="#L-1889"><span class="linenos">1889</span></a>    
</span><span id="L-1890"><a href="#L-1890"><span class="linenos">1890</span></a>    <span class="n">SS_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">Torsion_DF_Cols</span><span class="p">)</span>
</span><span id="L-1891"><a href="#L-1891"><span class="linenos">1891</span></a>
</span><span id="L-1892"><a href="#L-1892"><span class="linenos">1892</span></a>    <span class="c1"># define a tqdm progressbar using the fully loaded entrylist list. </span>
</span><span id="L-1893"><a href="#L-1893"><span class="linenos">1893</span></a>    <span class="c1"># If numb is passed then</span>
</span><span id="L-1894"><a href="#L-1894"><span class="linenos">1894</span></a>    <span class="c1"># only do the last numb entries.</span>
</span><span id="L-1895"><a href="#L-1895"><span class="linenos">1895</span></a>    
</span><span id="L-1896"><a href="#L-1896"><span class="linenos">1896</span></a>    <span class="k">if</span> <span class="n">numb</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1897"><a href="#L-1897"><span class="linenos">1897</span></a>        <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">entrylist</span><span class="p">[:</span><span class="n">numb</span><span class="p">],</span> <span class="n">ncols</span><span class="o">=</span><span class="n">PBAR_COLS</span><span class="p">)</span>
</span><span id="L-1898"><a href="#L-1898"><span class="linenos">1898</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1899"><a href="#L-1899"><span class="linenos">1899</span></a>        <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">entrylist</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">PBAR_COLS</span><span class="p">)</span>
</span><span id="L-1900"><a href="#L-1900"><span class="linenos">1900</span></a>
</span><span id="L-1901"><a href="#L-1901"><span class="linenos">1901</span></a>    <span class="n">tot</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1902"><a href="#L-1902"><span class="linenos">1902</span></a>    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1903"><a href="#L-1903"><span class="linenos">1903</span></a>    <span class="c1"># loop over ss_filelist, create disulfides and initialize them</span>
</span><span id="L-1904"><a href="#L-1904"><span class="linenos">1904</span></a>    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">pbar</span><span class="p">:</span>
</span><span id="L-1905"><a href="#L-1905"><span class="linenos">1905</span></a>        <span class="n">pbar</span><span class="o">.</span><span class="n">set_postfix</span><span class="p">({</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="n">entry</span><span class="p">,</span> <span class="s1">&#39;Bad&#39;</span><span class="p">:</span> <span class="n">bad</span><span class="p">,</span> <span class="s1">&#39;Ca&#39;</span><span class="p">:</span> <span class="n">bad_dist</span><span class="p">,</span> <span class="s1">&#39;Cnt&#39;</span><span class="p">:</span> <span class="n">tot</span><span class="p">})</span> <span class="c1"># update the progress bar</span>
</span><span id="L-1906"><a href="#L-1906"><span class="linenos">1906</span></a>
</span><span id="L-1907"><a href="#L-1907"><span class="linenos">1907</span></a>        <span class="c1"># returns an empty list if none are found.</span>
</span><span id="L-1908"><a href="#L-1908"><span class="linenos">1908</span></a>        <span class="n">_sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="n">entry</span><span class="p">)</span>
</span><span id="L-1909"><a href="#L-1909"><span class="linenos">1909</span></a>        <span class="n">_sslist</span> <span class="o">=</span> <span class="n">proteusPy</span><span class="o">.</span><span class="n">DisulfideList</span><span class="o">.</span><span class="n">load_disulfides_from_id</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> 
</span><span id="L-1910"><a href="#L-1910"><span class="linenos">1910</span></a>                                                                <span class="n">model_numb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
</span><span id="L-1911"><a href="#L-1911"><span class="linenos">1911</span></a>                                                                <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> 
</span><span id="L-1912"><a href="#L-1912"><span class="linenos">1912</span></a>                                                                <span class="n">quiet</span><span class="o">=</span><span class="n">quiet</span><span class="p">,</span> 
</span><span id="L-1913"><a href="#L-1913"><span class="linenos">1913</span></a>                                                                <span class="n">pdb_dir</span><span class="o">=</span><span class="n">pdbdir</span><span class="p">)</span>
</span><span id="L-1914"><a href="#L-1914"><span class="linenos">1914</span></a>        <span class="n">sslist</span><span class="p">,</span> <span class="n">xchain</span> <span class="o">=</span> <span class="n">prune_extra_ss</span><span class="p">(</span><span class="n">_sslist</span><span class="p">)</span>
</span><span id="L-1915"><a href="#L-1915"><span class="linenos">1915</span></a>
</span><span id="L-1916"><a href="#L-1916"><span class="linenos">1916</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sslist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1917"><a href="#L-1917"><span class="linenos">1917</span></a>            <span class="n">sslist2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># list to hold indices for ss_dict2</span>
</span><span id="L-1918"><a href="#L-1918"><span class="linenos">1918</span></a>            <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">:</span>
</span><span id="L-1919"><a href="#L-1919"><span class="linenos">1919</span></a>                <span class="c1"># Ca distance cutoff</span>
</span><span id="L-1920"><a href="#L-1920"><span class="linenos">1920</span></a>                <span class="n">dist</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">ca_distance</span>
</span><span id="L-1921"><a href="#L-1921"><span class="linenos">1921</span></a>                <span class="k">if</span> <span class="n">dist</span> <span class="o">&gt;=</span> <span class="n">dist_cutoff</span> <span class="ow">and</span> <span class="n">dist_cutoff</span> <span class="o">!=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">:</span>
</span><span id="L-1922"><a href="#L-1922"><span class="linenos">1922</span></a>                    <span class="n">bad_dist</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-1923"><a href="#L-1923"><span class="linenos">1923</span></a>                    <span class="k">continue</span>
</span><span id="L-1924"><a href="#L-1924"><span class="linenos">1924</span></a>
</span><span id="L-1925"><a href="#L-1925"><span class="linenos">1925</span></a>                <span class="n">All_ss_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
</span><span id="L-1926"><a href="#L-1926"><span class="linenos">1926</span></a>                <span class="n">new_row</span> <span class="o">=</span> <span class="p">[</span><span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">proximal</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">distal</span><span class="p">,</span> 
</span><span id="L-1927"><a href="#L-1927"><span class="linenos">1927</span></a>                		  <span class="n">ss</span><span class="o">.</span><span class="n">chi1</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">chi2</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">chi3</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">chi4</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">chi5</span><span class="p">,</span> 
</span><span id="L-1928"><a href="#L-1928"><span class="linenos">1928</span></a>                		  <span class="n">ss</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">ca_distance</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">cb_distance</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">phiprox</span><span class="p">,</span> 
</span><span id="L-1929"><a href="#L-1929"><span class="linenos">1929</span></a>                          <span class="n">ss</span><span class="o">.</span><span class="n">psiprox</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">phidist</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">psidist</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">torsion_length</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">rho</span><span class="p">]</span>
</span><span id="L-1930"><a href="#L-1930"><span class="linenos">1930</span></a>                          
</span><span id="L-1931"><a href="#L-1931"><span class="linenos">1931</span></a>                <span class="c1"># add the row to the end of the dataframe</span>
</span><span id="L-1932"><a href="#L-1932"><span class="linenos">1932</span></a>                <span class="n">SS_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">SS_df</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span> <span class="o">=</span> <span class="n">new_row</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># deep copy</span>
</span><span id="L-1933"><a href="#L-1933"><span class="linenos">1933</span></a>                <span class="n">sslist2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
</span><span id="L-1934"><a href="#L-1934"><span class="linenos">1934</span></a>                <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-1935"><a href="#L-1935"><span class="linenos">1935</span></a>                <span class="n">tot</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-1936"><a href="#L-1936"><span class="linenos">1936</span></a>
</span><span id="L-1937"><a href="#L-1937"><span class="linenos">1937</span></a>            <span class="c1"># All_ss_dict[entry] = sslist</span>
</span><span id="L-1938"><a href="#L-1938"><span class="linenos">1938</span></a>            <span class="c1"># print(f&#39;Entry: {entry}. Dict indices: {sslist2}&#39;)</span>
</span><span id="L-1939"><a href="#L-1939"><span class="linenos">1939</span></a>            <span class="n">All_ss_dict2</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span> <span class="o">=</span> <span class="n">sslist2</span>
</span><span id="L-1940"><a href="#L-1940"><span class="linenos">1940</span></a>            <span class="c1"># print(f&#39;{entry} ss dict adding: {sslist2}&#39;)</span>
</span><span id="L-1941"><a href="#L-1941"><span class="linenos">1941</span></a>
</span><span id="L-1942"><a href="#L-1942"><span class="linenos">1942</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1943"><a href="#L-1943"><span class="linenos">1943</span></a>            <span class="c1"># at this point I really shouldn&#39;t have any bad non-parsible file</span>
</span><span id="L-1944"><a href="#L-1944"><span class="linenos">1944</span></a>            <span class="n">bad</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-1945"><a href="#L-1945"><span class="linenos">1945</span></a>            <span class="n">problem_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span><span id="L-1946"><a href="#L-1946"><span class="linenos">1946</span></a>            <span class="c1">#os.remove(f&#39;pdb{entry}.ent&#39;)</span>
</span><span id="L-1947"><a href="#L-1947"><span class="linenos">1947</span></a>    
</span><span id="L-1948"><a href="#L-1948"><span class="linenos">1948</span></a>    <span class="k">if</span> <span class="n">bad</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1949"><a href="#L-1949"><span class="linenos">1949</span></a>        <span class="n">prob_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
</span><span id="L-1950"><a href="#L-1950"><span class="linenos">1950</span></a>        <span class="n">problem_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">prob_cols</span><span class="p">)</span>
</span><span id="L-1951"><a href="#L-1951"><span class="linenos">1951</span></a>        <span class="n">problem_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">problem_ids</span>
</span><span id="L-1952"><a href="#L-1952"><span class="linenos">1952</span></a>
</span><span id="L-1953"><a href="#L-1953"><span class="linenos">1953</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; Extract_Disulfides(): Found and removed: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">problem_ids</span><span class="p">)</span><span class="si">}</span><span class="s1"> non-parsable structures.&#39;</span><span class="p">)</span>
</span><span id="L-1954"><a href="#L-1954"><span class="linenos">1954</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; Extract_Disulfides(): Saving problem IDs to file: </span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">problemfile</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1955"><a href="#L-1955"><span class="linenos">1955</span></a>
</span><span id="L-1956"><a href="#L-1956"><span class="linenos">1956</span></a>        <span class="n">problem_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">problemfile</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1957"><a href="#L-1957"><span class="linenos">1957</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1958"><a href="#L-1958"><span class="linenos">1958</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1959"><a href="#L-1959"><span class="linenos">1959</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&gt; Extract_Disulfides(): No non-parsable structures found.&#39;</span><span class="p">)</span>
</span><span id="L-1960"><a href="#L-1960"><span class="linenos">1960</span></a>
</span><span id="L-1961"><a href="#L-1961"><span class="linenos">1961</span></a>    <span class="k">if</span> <span class="n">bad_dist</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1962"><a href="#L-1962"><span class="linenos">1962</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; Extract_Disulfides(): Found and ignored: </span><span class="si">{</span><span class="n">bad_dist</span><span class="si">}</span><span class="s1"> long SS bonds.&#39;</span><span class="p">)</span>
</span><span id="L-1963"><a href="#L-1963"><span class="linenos">1963</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1964"><a href="#L-1964"><span class="linenos">1964</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1965"><a href="#L-1965"><span class="linenos">1965</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No problems found.&#39;</span><span class="p">)</span>
</span><span id="L-1966"><a href="#L-1966"><span class="linenos">1966</span></a>
</span><span id="L-1967"><a href="#L-1967"><span class="linenos">1967</span></a>    <span class="c1"># dump the all_ss list of disulfides to a .pkl file. ~520 MB.</span>
</span><span id="L-1968"><a href="#L-1968"><span class="linenos">1968</span></a>    <span class="n">fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">picklefile</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-1969"><a href="#L-1969"><span class="linenos">1969</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; Extract_Disulfides(): Saving </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">All_ss_list</span><span class="p">)</span><span class="si">}</span><span class="s1"> Disulfides to file: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1970"><a href="#L-1970"><span class="linenos">1970</span></a>    
</span><span id="L-1971"><a href="#L-1971"><span class="linenos">1971</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;wb+&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-1972"><a href="#L-1972"><span class="linenos">1972</span></a>        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">All_ss_list</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="L-1973"><a href="#L-1973"><span class="linenos">1973</span></a>
</span><span id="L-1974"><a href="#L-1974"><span class="linenos">1974</span></a>    <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-1975"><a href="#L-1975"><span class="linenos">1975</span></a><span class="sd">    SS_SUBSET_DICT_PICKLE_FILE</span>
</span><span id="L-1976"><a href="#L-1976"><span class="linenos">1976</span></a><span class="sd">    # dump the dict of disulfides to a .pkl file. ~520 MB.</span>
</span><span id="L-1977"><a href="#L-1977"><span class="linenos">1977</span></a><span class="sd">    dict_len = len(All_ss_dict)</span>
</span><span id="L-1978"><a href="#L-1978"><span class="linenos">1978</span></a><span class="sd">    fname = f&#39;{datadir}{dictfile}&#39;</span>
</span><span id="L-1979"><a href="#L-1979"><span class="linenos">1979</span></a><span class="sd">    print(f&#39;-&gt; Extract_Disulfides(): Saving {dict_len} Disulfide-containing PDB IDs to file: {fname}&#39;)</span>
</span><span id="L-1980"><a href="#L-1980"><span class="linenos">1980</span></a>
</span><span id="L-1981"><a href="#L-1981"><span class="linenos">1981</span></a><span class="sd">    with open(fname, &#39;wb+&#39;) as f:</span>
</span><span id="L-1982"><a href="#L-1982"><span class="linenos">1982</span></a><span class="sd">        pickle.dump(All_ss_dict, f)</span>
</span><span id="L-1983"><a href="#L-1983"><span class="linenos">1983</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-1984"><a href="#L-1984"><span class="linenos">1984</span></a>
</span><span id="L-1985"><a href="#L-1985"><span class="linenos">1985</span></a>    <span class="c1"># dump the dict2 disulfides to a .pkl file. ~520 MB.</span>
</span><span id="L-1986"><a href="#L-1986"><span class="linenos">1986</span></a>    <span class="n">dict_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">All_ss_dict2</span><span class="p">)</span>
</span><span id="L-1987"><a href="#L-1987"><span class="linenos">1987</span></a>    <span class="n">fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">dictfile</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-1988"><a href="#L-1988"><span class="linenos">1988</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; Extract_Disulfides(): Saving indices of </span><span class="si">{</span><span class="n">dict_len</span><span class="si">}</span><span class="s1"> Disulfide-containing PDB IDs to file: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1989"><a href="#L-1989"><span class="linenos">1989</span></a>
</span><span id="L-1990"><a href="#L-1990"><span class="linenos">1990</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;wb+&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-1991"><a href="#L-1991"><span class="linenos">1991</span></a>        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">All_ss_dict2</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="L-1992"><a href="#L-1992"><span class="linenos">1992</span></a>
</span><span id="L-1993"><a href="#L-1993"><span class="linenos">1993</span></a>    <span class="c1"># save the torsions</span>
</span><span id="L-1994"><a href="#L-1994"><span class="linenos">1994</span></a>    <span class="n">fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">torsionfile</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-1995"><a href="#L-1995"><span class="linenos">1995</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; Extract_Disulfides(): Saving torsions to file: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-1996"><a href="#L-1996"><span class="linenos">1996</span></a>    <span class="n">SS_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
</span><span id="L-1997"><a href="#L-1997"><span class="linenos">1997</span></a>
</span><span id="L-1998"><a href="#L-1998"><span class="linenos">1998</span></a>    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-1999"><a href="#L-1999"><span class="linenos">1999</span></a>    <span class="n">elapsed</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>
</span><span id="L-2000"><a href="#L-2000"><span class="linenos">2000</span></a>
</span><span id="L-2001"><a href="#L-2001"><span class="linenos">2001</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; Extract_Disulfides(): Disulfide Extraction complete! Elapsed time:</span><span class="se">\</span>
</span><span id="L-2002"><a href="#L-2002"><span class="linenos">2002</span></a><span class="s1">    	 </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed</span><span class="p">)</span><span class="si">}</span><span class="s1"> (h:m:s)&#39;</span><span class="p">)</span>
</span><span id="L-2003"><a href="#L-2003"><span class="linenos">2003</span></a>
</span><span id="L-2004"><a href="#L-2004"><span class="linenos">2004</span></a>    <span class="c1"># return to original directory</span>
</span><span id="L-2005"><a href="#L-2005"><span class="linenos">2005</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
</span><span id="L-2006"><a href="#L-2006"><span class="linenos">2006</span></a>    <span class="k">return</span>
</span><span id="L-2007"><a href="#L-2007"><span class="linenos">2007</span></a>
</span><span id="L-2008"><a href="#L-2008"><span class="linenos">2008</span></a><span class="k">def</span> <span class="nf">check_header_from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">model_numb</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
</span><span id="L-2009"><a href="#L-2009"><span class="linenos">2009</span></a>                            <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">dbg</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-2010"><a href="#L-2010"><span class="linenos">2010</span></a>    <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-2011"><a href="#L-2011"><span class="linenos">2011</span></a><span class="sd">    Checks the Disulfides by PDB ID and initializes the Disulfide objects.</span>
</span><span id="L-2012"><a href="#L-2012"><span class="linenos">2012</span></a><span class="sd">    Assumes the file is downloaded in the pdb_dir path.</span>
</span><span id="L-2013"><a href="#L-2013"><span class="linenos">2013</span></a><span class="sd">    </span>
</span><span id="L-2014"><a href="#L-2014"><span class="linenos">2014</span></a><span class="sd">    NB: Requires EGS-Modified BIO.parse_pdb_header.py from https://github.com/suchanek/biopython/</span>
</span><span id="L-2015"><a href="#L-2015"><span class="linenos">2015</span></a>
</span><span id="L-2016"><a href="#L-2016"><span class="linenos">2016</span></a><span class="sd">    :param struct_name: the name of the PDB entry.</span>
</span><span id="L-2017"><a href="#L-2017"><span class="linenos">2017</span></a><span class="sd">    :param pdb_dir: path to the PDB files, defaults to ```MODEL_DIR```</span>
</span><span id="L-2018"><a href="#L-2018"><span class="linenos">2018</span></a><span class="sd">    :param model_numb: model number to use, defaults to 0 for single structure files.</span>
</span><span id="L-2019"><a href="#L-2019"><span class="linenos">2019</span></a><span class="sd">    :param verbose: print info while parsing</span>
</span><span id="L-2020"><a href="#L-2020"><span class="linenos">2020</span></a><span class="sd">    :return: True if parsable</span>
</span><span id="L-2021"><a href="#L-2021"><span class="linenos">2021</span></a><span class="sd">    </span>
</span><span id="L-2022"><a href="#L-2022"><span class="linenos">2022</span></a><span class="sd">    Example:</span>
</span><span id="L-2023"><a href="#L-2023"><span class="linenos">2023</span></a><span class="sd">      Assuming ```MODEL_DIR``` has the pdb5rsa.ent file we can load the disulfides</span>
</span><span id="L-2024"><a href="#L-2024"><span class="linenos">2024</span></a><span class="sd">      with the following:</span>
</span><span id="L-2025"><a href="#L-2025"><span class="linenos">2025</span></a>
</span><span id="L-2026"><a href="#L-2026"><span class="linenos">2026</span></a><span class="sd">    &gt;&gt;&gt; from proteusPy.Disulfide import Disulfide, check_header_from_file</span>
</span><span id="L-2027"><a href="#L-2027"><span class="linenos">2027</span></a><span class="sd">    &gt;&gt;&gt; MODEL_DIR = &#39;/Users/egs/PDB/good/&#39;</span>
</span><span id="L-2028"><a href="#L-2028"><span class="linenos">2028</span></a><span class="sd">    &gt;&gt;&gt; OK = False</span>
</span><span id="L-2029"><a href="#L-2029"><span class="linenos">2029</span></a><span class="sd">    &gt;&gt;&gt; OK = check_header_from_file(f&#39;{MODEL_DIR}pdb5rsa.ent&#39;, verbose=True)</span>
</span><span id="L-2030"><a href="#L-2030"><span class="linenos">2030</span></a><span class="sd">    -&gt; check_header_from_file() - Parsing file: /Users/egs/PDB/good/pdb5rsa.ent:</span>
</span><span id="L-2031"><a href="#L-2031"><span class="linenos">2031</span></a><span class="sd">     -&gt; SSBond: 1: tmp: 26A - 84A</span>
</span><span id="L-2032"><a href="#L-2032"><span class="linenos">2032</span></a><span class="sd">     -&gt; SSBond: 2: tmp: 40A - 95A</span>
</span><span id="L-2033"><a href="#L-2033"><span class="linenos">2033</span></a><span class="sd">     -&gt; SSBond: 3: tmp: 58A - 110A</span>
</span><span id="L-2034"><a href="#L-2034"><span class="linenos">2034</span></a><span class="sd">     -&gt; SSBond: 4: tmp: 65A - 72A</span>
</span><span id="L-2035"><a href="#L-2035"><span class="linenos">2035</span></a><span class="sd">    &gt;&gt;&gt; OK</span>
</span><span id="L-2036"><a href="#L-2036"><span class="linenos">2036</span></a><span class="sd">    True</span>
</span><span id="L-2037"><a href="#L-2037"><span class="linenos">2037</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-2038"><a href="#L-2038"><span class="linenos">2038</span></a>
</span><span id="L-2039"><a href="#L-2039"><span class="linenos">2039</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-2040"><a href="#L-2040"><span class="linenos">2040</span></a>    <span class="n">proximal</span> <span class="o">=</span> <span class="n">distal</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="L-2041"><a href="#L-2041"><span class="linenos">2041</span></a>    <span class="n">SSList</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2042"><a href="#L-2042"><span class="linenos">2042</span></a>    <span class="n">_chaina</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-2043"><a href="#L-2043"><span class="linenos">2043</span></a>    <span class="n">_chainb</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-2044"><a href="#L-2044"><span class="linenos">2044</span></a>
</span><span id="L-2045"><a href="#L-2045"><span class="linenos">2045</span></a>    <span class="n">parser</span> <span class="o">=</span> <span class="n">PDBParser</span><span class="p">(</span><span class="n">PERMISSIVE</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-2046"><a href="#L-2046"><span class="linenos">2046</span></a>    
</span><span id="L-2047"><a href="#L-2047"><span class="linenos">2047</span></a>    <span class="c1"># Biopython uses the Structure -&gt; Model -&gt; Chain hierarchy to organize</span>
</span><span id="L-2048"><a href="#L-2048"><span class="linenos">2048</span></a>    <span class="c1"># structures. All are iterable.</span>
</span><span id="L-2049"><a href="#L-2049"><span class="linenos">2049</span></a>
</span><span id="L-2050"><a href="#L-2050"><span class="linenos">2050</span></a>    <span class="n">structure</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="s1">&#39;tmp&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>
</span><span id="L-2051"><a href="#L-2051"><span class="linenos">2051</span></a>    <span class="n">struct_name</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">get_id</span><span class="p">()</span>
</span><span id="L-2052"><a href="#L-2052"><span class="linenos">2052</span></a>    
</span><span id="L-2053"><a href="#L-2053"><span class="linenos">2053</span></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">structure</span><span class="p">[</span><span class="n">model_numb</span><span class="p">]</span>
</span><span id="L-2054"><a href="#L-2054"><span class="linenos">2054</span></a>
</span><span id="L-2055"><a href="#L-2055"><span class="linenos">2055</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-2056"><a href="#L-2056"><span class="linenos">2056</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; check_header_from_file() - Parsing file: </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">:&#39;</span><span class="p">)</span>
</span><span id="L-2057"><a href="#L-2057"><span class="linenos">2057</span></a>
</span><span id="L-2058"><a href="#L-2058"><span class="linenos">2058</span></a>    <span class="n">ssbond_dict</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;ssbond&#39;</span><span class="p">]</span> <span class="c1"># NB: this requires the modified code</span>
</span><span id="L-2059"><a href="#L-2059"><span class="linenos">2059</span></a>
</span><span id="L-2060"><a href="#L-2060"><span class="linenos">2060</span></a>    <span class="c1"># list of tuples with (proximal distal chaina chainb)</span>
</span><span id="L-2061"><a href="#L-2061"><span class="linenos">2061</span></a>    <span class="n">ssbonds</span> <span class="o">=</span> <span class="n">parse_ssbond_header_rec</span><span class="p">(</span><span class="n">ssbond_dict</span><span class="p">)</span> 
</span><span id="L-2062"><a href="#L-2062"><span class="linenos">2062</span></a>
</span><span id="L-2063"><a href="#L-2063"><span class="linenos">2063</span></a>    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">ssbonds</span><span class="p">:</span>
</span><span id="L-2064"><a href="#L-2064"><span class="linenos">2064</span></a>        <span class="c1"># in the form (proximal, distal, chain)</span>
</span><span id="L-2065"><a href="#L-2065"><span class="linenos">2065</span></a>        <span class="n">proximal</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
</span><span id="L-2066"><a href="#L-2066"><span class="linenos">2066</span></a>        <span class="n">distal</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2067"><a href="#L-2067"><span class="linenos">2067</span></a>
</span><span id="L-2068"><a href="#L-2068"><span class="linenos">2068</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">proximal</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">distal</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
</span><span id="L-2069"><a href="#L-2069"><span class="linenos">2069</span></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-2070"><a href="#L-2070"><span class="linenos">2070</span></a>                <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39; ! Cannot parse SSBond record (non-numeric IDs):</span><span class="se">\</span>
</span><span id="L-2071"><a href="#L-2071"><span class="linenos">2071</span></a><span class="s1">                 </span><span class="si">{</span><span class="n">struct_name</span><span class="si">}</span><span class="s1"> Prox:  </span><span class="si">{</span><span class="n">proximal</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">chain1_id</span><span class="si">}</span><span class="s1"> Dist: </span><span class="si">{</span><span class="n">distal</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">chain2_id</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-2072"><a href="#L-2072"><span class="linenos">2072</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">,</span> <span class="n">DisulfideParseWarning</span><span class="p">)</span>
</span><span id="L-2073"><a href="#L-2073"><span class="linenos">2073</span></a>            <span class="k">continue</span> <span class="c1"># was pass</span>
</span><span id="L-2074"><a href="#L-2074"><span class="linenos">2074</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-2075"><a href="#L-2075"><span class="linenos">2075</span></a>            <span class="n">proximal</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">proximal</span><span class="p">)</span>
</span><span id="L-2076"><a href="#L-2076"><span class="linenos">2076</span></a>            <span class="n">distal</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">distal</span><span class="p">)</span>
</span><span id="L-2077"><a href="#L-2077"><span class="linenos">2077</span></a>        
</span><span id="L-2078"><a href="#L-2078"><span class="linenos">2078</span></a>        <span class="n">chain1_id</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-2079"><a href="#L-2079"><span class="linenos">2079</span></a>        <span class="n">chain2_id</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="L-2080"><a href="#L-2080"><span class="linenos">2080</span></a>
</span><span id="L-2081"><a href="#L-2081"><span class="linenos">2081</span></a>        <span class="n">_chaina</span> <span class="o">=</span> <span class="n">model</span><span class="p">[</span><span class="n">chain1_id</span><span class="p">]</span>
</span><span id="L-2082"><a href="#L-2082"><span class="linenos">2082</span></a>        <span class="n">_chainb</span> <span class="o">=</span> <span class="n">model</span><span class="p">[</span><span class="n">chain2_id</span><span class="p">]</span>
</span><span id="L-2083"><a href="#L-2083"><span class="linenos">2083</span></a>
</span><span id="L-2084"><a href="#L-2084"><span class="linenos">2084</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">chain1_id</span> <span class="o">!=</span> <span class="n">chain2_id</span><span class="p">):</span>
</span><span id="L-2085"><a href="#L-2085"><span class="linenos">2085</span></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-2086"><a href="#L-2086"><span class="linenos">2086</span></a>                <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39; -&gt; Cross Chain SS for: Prox: </span><span class="si">{</span><span class="n">proximal</span><span class="si">}{</span><span class="n">chain1_id</span><span class="si">}</span><span class="s1"> Dist: </span><span class="si">{</span><span class="n">distal</span><span class="si">}{</span><span class="n">chain2_id</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-2087"><a href="#L-2087"><span class="linenos">2087</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">,</span> <span class="n">DisulfideParseWarning</span><span class="p">)</span>
</span><span id="L-2088"><a href="#L-2088"><span class="linenos">2088</span></a>                <span class="k">pass</span> <span class="c1"># was break</span>
</span><span id="L-2089"><a href="#L-2089"><span class="linenos">2089</span></a>
</span><span id="L-2090"><a href="#L-2090"><span class="linenos">2090</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-2091"><a href="#L-2091"><span class="linenos">2091</span></a>            <span class="n">prox_res</span> <span class="o">=</span> <span class="n">_chaina</span><span class="p">[</span><span class="n">proximal</span><span class="p">]</span>
</span><span id="L-2092"><a href="#L-2092"><span class="linenos">2092</span></a>            <span class="n">dist_res</span> <span class="o">=</span> <span class="n">_chainb</span><span class="p">[</span><span class="n">distal</span><span class="p">]</span>
</span><span id="L-2093"><a href="#L-2093"><span class="linenos">2093</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="L-2094"><a href="#L-2094"><span class="linenos">2094</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; ! Cannot parse SSBond record (KeyError): </span><span class="si">{</span><span class="n">struct_name</span><span class="si">}</span><span class="s1"> Prox: &lt;</span><span class="si">{</span><span class="n">proximal</span><span class="si">}</span><span class="s1">&gt; </span><span class="si">{</span><span class="n">chain1_id</span><span class="si">}</span><span class="s1"> Dist: &lt;</span><span class="si">{</span><span class="n">distal</span><span class="si">}</span><span class="s1">&gt; </span><span class="si">{</span><span class="n">chain2_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-2095"><a href="#L-2095"><span class="linenos">2095</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-2096"><a href="#L-2096"><span class="linenos">2096</span></a>        
</span><span id="L-2097"><a href="#L-2097"><span class="linenos">2097</span></a>        <span class="c1"># make a new Disulfide object, name them based on proximal and distal</span>
</span><span id="L-2098"><a href="#L-2098"><span class="linenos">2098</span></a>        <span class="c1"># initialize SS bond from the proximal, distal coordinates</span>
</span><span id="L-2099"><a href="#L-2099"><span class="linenos">2099</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">_chaina</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">_chainb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-2100"><a href="#L-2100"><span class="linenos">2100</span></a>            <span class="k">if</span> <span class="n">_chaina</span><span class="p">[</span><span class="n">proximal</span><span class="p">]</span><span class="o">.</span><span class="n">is_disordered</span><span class="p">()</span> <span class="ow">or</span> <span class="n">_chainb</span><span class="p">[</span><span class="n">distal</span><span class="p">]</span><span class="o">.</span><span class="n">is_disordered</span><span class="p">():</span>
</span><span id="L-2101"><a href="#L-2101"><span class="linenos">2101</span></a>                <span class="k">continue</span>
</span><span id="L-2102"><a href="#L-2102"><span class="linenos">2102</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-2103"><a href="#L-2103"><span class="linenos">2103</span></a>                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-2104"><a href="#L-2104"><span class="linenos">2104</span></a>                   <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; -&gt; SSBond: </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">struct_name</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">proximal</span><span class="si">}{</span><span class="n">chain1_id</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">distal</span><span class="si">}{</span><span class="n">chain2_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-2105"><a href="#L-2105"><span class="linenos">2105</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-2106"><a href="#L-2106"><span class="linenos">2106</span></a>            <span class="k">if</span> <span class="n">dbg</span><span class="p">:</span>
</span><span id="L-2107"><a href="#L-2107"><span class="linenos">2107</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; -&gt; NULL chain(s): </span><span class="si">{</span><span class="n">struct_name</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">proximal</span><span class="si">}{</span><span class="n">chain1_id</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">distal</span><span class="si">}{</span><span class="n">chain2_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-2108"><a href="#L-2108"><span class="linenos">2108</span></a>        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-2109"><a href="#L-2109"><span class="linenos">2109</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-2110"><a href="#L-2110"><span class="linenos">2110</span></a>
</span><span id="L-2111"><a href="#L-2111"><span class="linenos">2111</span></a><span class="k">def</span> <span class="nf">check_header_from_id</span><span class="p">(</span><span class="n">struct_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pdb_dir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">model_numb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-2112"><a href="#L-2112"><span class="linenos">2112</span></a>                        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dbg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-2113"><a href="#L-2113"><span class="linenos">2113</span></a>    <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-2114"><a href="#L-2114"><span class="linenos">2114</span></a><span class="sd">    Checks parsability PDB ID and initializes the Disulfide objects.</span>
</span><span id="L-2115"><a href="#L-2115"><span class="linenos">2115</span></a><span class="sd">    Assumes the file is downloaded in ```MODEL_DIR``` path.</span>
</span><span id="L-2116"><a href="#L-2116"><span class="linenos">2116</span></a><span class="sd">    </span>
</span><span id="L-2117"><a href="#L-2117"><span class="linenos">2117</span></a><span class="sd">    NB: Requires EGS-Modified BIO.parse_pdb_header.py from https://github.com/suchanek/biopython/</span>
</span><span id="L-2118"><a href="#L-2118"><span class="linenos">2118</span></a>
</span><span id="L-2119"><a href="#L-2119"><span class="linenos">2119</span></a><span class="sd">    :param struct_name: the name of the PDB entry.</span>
</span><span id="L-2120"><a href="#L-2120"><span class="linenos">2120</span></a><span class="sd">    :param pdb_dir: path to the PDB files, defaults to PDB_DIR</span>
</span><span id="L-2121"><a href="#L-2121"><span class="linenos">2121</span></a><span class="sd">    :param model_numb: model number to use, defaults to 0 for single structure files.</span>
</span><span id="L-2122"><a href="#L-2122"><span class="linenos">2122</span></a><span class="sd">    :param verbose: print info while parsing</span>
</span><span id="L-2123"><a href="#L-2123"><span class="linenos">2123</span></a><span class="sd">    :param dbg: Debugging Flag</span>
</span><span id="L-2124"><a href="#L-2124"><span class="linenos">2124</span></a><span class="sd">    :return: True if OK, False otherwise</span>
</span><span id="L-2125"><a href="#L-2125"><span class="linenos">2125</span></a><span class="sd">    </span>
</span><span id="L-2126"><a href="#L-2126"><span class="linenos">2126</span></a><span class="sd">    Example:</span>
</span><span id="L-2127"><a href="#L-2127"><span class="linenos">2127</span></a><span class="sd">      Assuming the PDB_DIR has the pdb5rsa.ent file we can check the file thusly:</span>
</span><span id="L-2128"><a href="#L-2128"><span class="linenos">2128</span></a>
</span><span id="L-2129"><a href="#L-2129"><span class="linenos">2129</span></a><span class="sd">    &gt;&gt;&gt; from proteusPy.Disulfide import Disulfide, check_header_from_id</span>
</span><span id="L-2130"><a href="#L-2130"><span class="linenos">2130</span></a><span class="sd">    &gt;&gt;&gt; MODEL_DIR = &#39;/Users/egs/PDB/good/&#39;</span>
</span><span id="L-2131"><a href="#L-2131"><span class="linenos">2131</span></a><span class="sd">    &gt;&gt;&gt; OK = False</span>
</span><span id="L-2132"><a href="#L-2132"><span class="linenos">2132</span></a><span class="sd">    &gt;&gt;&gt; OK = check_header_from_id(&#39;5rsa&#39;, pdb_dir=MODEL_DIR, verbose=True)</span>
</span><span id="L-2133"><a href="#L-2133"><span class="linenos">2133</span></a><span class="sd">     -&gt; SSBond: 1: 5rsa: 26A - 84A</span>
</span><span id="L-2134"><a href="#L-2134"><span class="linenos">2134</span></a><span class="sd">     -&gt; SSBond: 2: 5rsa: 40A - 95A</span>
</span><span id="L-2135"><a href="#L-2135"><span class="linenos">2135</span></a><span class="sd">     -&gt; SSBond: 3: 5rsa: 58A - 110A</span>
</span><span id="L-2136"><a href="#L-2136"><span class="linenos">2136</span></a><span class="sd">     -&gt; SSBond: 4: 5rsa: 65A - 72A</span>
</span><span id="L-2137"><a href="#L-2137"><span class="linenos">2137</span></a><span class="sd">    &gt;&gt;&gt; OK</span>
</span><span id="L-2138"><a href="#L-2138"><span class="linenos">2138</span></a><span class="sd">    True</span>
</span><span id="L-2139"><a href="#L-2139"><span class="linenos">2139</span></a><span class="sd">   &#39;&#39;&#39;</span>
</span><span id="L-2140"><a href="#L-2140"><span class="linenos">2140</span></a>
</span><span id="L-2141"><a href="#L-2141"><span class="linenos">2141</span></a>    <span class="n">parser</span> <span class="o">=</span> <span class="n">PDBParser</span><span class="p">(</span><span class="n">PERMISSIVE</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">QUIET</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-2142"><a href="#L-2142"><span class="linenos">2142</span></a>    <span class="n">structure</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="n">struct_name</span><span class="p">,</span> 
</span><span id="L-2143"><a href="#L-2143"><span class="linenos">2143</span></a>    								 <span class="n">file</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pdb_dir</span><span class="si">}</span><span class="s1">pdb</span><span class="si">{</span><span class="n">struct_name</span><span class="si">}</span><span class="s1">.ent&#39;</span><span class="p">)</span>
</span><span id="L-2144"><a href="#L-2144"><span class="linenos">2144</span></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">structure</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-2145"><a href="#L-2145"><span class="linenos">2145</span></a>
</span><span id="L-2146"><a href="#L-2146"><span class="linenos">2146</span></a>    <span class="n">ssbond_dict</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;ssbond&#39;</span><span class="p">]</span> <span class="c1"># NB: this requires the modified code</span>
</span><span id="L-2147"><a href="#L-2147"><span class="linenos">2147</span></a>
</span><span id="L-2148"><a href="#L-2148"><span class="linenos">2148</span></a>    <span class="n">bondlist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-2149"><a href="#L-2149"><span class="linenos">2149</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-2150"><a href="#L-2150"><span class="linenos">2150</span></a>
</span><span id="L-2151"><a href="#L-2151"><span class="linenos">2151</span></a>    <span class="c1"># get a list of tuples containing the proximal, distal residue IDs for </span>
</span><span id="L-2152"><a href="#L-2152"><span class="linenos">2152</span></a>    <span class="c1"># all SSBonds in the chain.</span>
</span><span id="L-2153"><a href="#L-2153"><span class="linenos">2153</span></a>    <span class="n">bondlist</span> <span class="o">=</span> <span class="n">parse_ssbond_header_rec</span><span class="p">(</span><span class="n">ssbond_dict</span><span class="p">)</span>
</span><span id="L-2154"><a href="#L-2154"><span class="linenos">2154</span></a>    
</span><span id="L-2155"><a href="#L-2155"><span class="linenos">2155</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bondlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-2156"><a href="#L-2156"><span class="linenos">2156</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">verbose</span><span class="p">):</span>
</span><span id="L-2157"><a href="#L-2157"><span class="linenos">2157</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; check_header_from_id(): no bonds found in bondlist.&#39;</span><span class="p">)</span>
</span><span id="L-2158"><a href="#L-2158"><span class="linenos">2158</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-2159"><a href="#L-2159"><span class="linenos">2159</span></a>    
</span><span id="L-2160"><a href="#L-2160"><span class="linenos">2160</span></a>    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">bondlist</span><span class="p">:</span>
</span><span id="L-2161"><a href="#L-2161"><span class="linenos">2161</span></a>        <span class="c1"># in the form (proximal, distal, chain)</span>
</span><span id="L-2162"><a href="#L-2162"><span class="linenos">2162</span></a>        <span class="n">proximal</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-2163"><a href="#L-2163"><span class="linenos">2163</span></a>        <span class="n">distal</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2164"><a href="#L-2164"><span class="linenos">2164</span></a>        <span class="n">chain1</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-2165"><a href="#L-2165"><span class="linenos">2165</span></a>        <span class="n">chain2</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="L-2166"><a href="#L-2166"><span class="linenos">2166</span></a>
</span><span id="L-2167"><a href="#L-2167"><span class="linenos">2167</span></a>        <span class="n">chaina</span> <span class="o">=</span> <span class="n">model</span><span class="p">[</span><span class="n">chain1</span><span class="p">]</span>
</span><span id="L-2168"><a href="#L-2168"><span class="linenos">2168</span></a>        <span class="n">chainb</span> <span class="o">=</span> <span class="n">model</span><span class="p">[</span><span class="n">chain2</span><span class="p">]</span>
</span><span id="L-2169"><a href="#L-2169"><span class="linenos">2169</span></a>
</span><span id="L-2170"><a href="#L-2170"><span class="linenos">2170</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-2171"><a href="#L-2171"><span class="linenos">2171</span></a>            <span class="n">prox_residue</span> <span class="o">=</span> <span class="n">chaina</span><span class="p">[</span><span class="n">proximal</span><span class="p">]</span>
</span><span id="L-2172"><a href="#L-2172"><span class="linenos">2172</span></a>            <span class="n">dist_residue</span> <span class="o">=</span> <span class="n">chainb</span><span class="p">[</span><span class="n">distal</span><span class="p">]</span>
</span><span id="L-2173"><a href="#L-2173"><span class="linenos">2173</span></a>            
</span><span id="L-2174"><a href="#L-2174"><span class="linenos">2174</span></a>            <span class="n">prox_residue</span><span class="o">.</span><span class="n">disordered_select</span><span class="p">(</span><span class="s2">&quot;CYS&quot;</span><span class="p">)</span>
</span><span id="L-2175"><a href="#L-2175"><span class="linenos">2175</span></a>            <span class="n">dist_residue</span><span class="o">.</span><span class="n">disordered_select</span><span class="p">(</span><span class="s2">&quot;CYS&quot;</span><span class="p">)</span>
</span><span id="L-2176"><a href="#L-2176"><span class="linenos">2176</span></a>
</span><span id="L-2177"><a href="#L-2177"><span class="linenos">2177</span></a>            <span class="k">if</span> <span class="n">prox_residue</span><span class="o">.</span><span class="n">get_resname</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;CYS&#39;</span> <span class="ow">or</span> <span class="n">dist_residue</span><span class="o">.</span><span class="n">get_resname</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;CYS&#39;</span><span class="p">:</span>
</span><span id="L-2178"><a href="#L-2178"><span class="linenos">2178</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">verbose</span><span class="p">):</span>
</span><span id="L-2179"><a href="#L-2179"><span class="linenos">2179</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;build_disulfide() requires CYS at both residues:</span><span class="se">\</span>
</span><span id="L-2180"><a href="#L-2180"><span class="linenos">2180</span></a><span class="s1">                     </span><span class="si">{</span><span class="n">prox_residue</span><span class="o">.</span><span class="n">get_resname</span><span class="p">()</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">dist_residue</span><span class="o">.</span><span class="n">get_resname</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-2181"><a href="#L-2181"><span class="linenos">2181</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-2182"><a href="#L-2182"><span class="linenos">2182</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="L-2183"><a href="#L-2183"><span class="linenos">2183</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">dbg</span><span class="p">):</span>
</span><span id="L-2184"><a href="#L-2184"><span class="linenos">2184</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Keyerror: </span><span class="si">{</span><span class="n">struct_name</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">proximal</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">chain1</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">distal</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">chain2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-2185"><a href="#L-2185"><span class="linenos">2185</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-2186"><a href="#L-2186"><span class="linenos">2186</span></a> 
</span><span id="L-2187"><a href="#L-2187"><span class="linenos">2187</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-2188"><a href="#L-2188"><span class="linenos">2188</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; -&gt; SSBond: </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">struct_name</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">proximal</span><span class="si">}{</span><span class="n">chain1</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">distal</span><span class="si">}{</span><span class="n">chain2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-2189"><a href="#L-2189"><span class="linenos">2189</span></a>
</span><span id="L-2190"><a href="#L-2190"><span class="linenos">2190</span></a>        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-2191"><a href="#L-2191"><span class="linenos">2191</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-2192"><a href="#L-2192"><span class="linenos">2192</span></a>
</span><span id="L-2193"><a href="#L-2193"><span class="linenos">2193</span></a>
</span><span id="L-2194"><a href="#L-2194"><span class="linenos">2194</span></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="L-2195"><a href="#L-2195"><span class="linenos">2195</span></a>    <span class="kn">import</span> <span class="nn">doctest</span>
</span><span id="L-2196"><a href="#L-2196"><span class="linenos">2196</span></a>    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">()</span>
</span><span id="L-2197"><a href="#L-2197"><span class="linenos">2197</span></a>
</span><span id="L-2198"><a href="#L-2198"><span class="linenos">2198</span></a><span class="c1"># End of file</span>
</span></pre></div>


            </section>
                <section id="Disulfide">
                            <input id="Disulfide-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Disulfide</span>:

                <label class="view-source-button" for="Disulfide-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide-61"><a href="#Disulfide-61"><span class="linenos">  61</span></a><span class="k">class</span> <span class="nc">Disulfide</span><span class="p">:</span>
</span><span id="Disulfide-62"><a href="#Disulfide-62"><span class="linenos">  62</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide-63"><a href="#Disulfide-63"><span class="linenos">  63</span></a><span class="sd">    This class provides a Python object and methods representing a physical disulfide bond </span>
</span><span id="Disulfide-64"><a href="#Disulfide-64"><span class="linenos">  64</span></a><span class="sd">    either extracted from the RCSB protein databank or built using the </span>
</span><span id="Disulfide-65"><a href="#Disulfide-65"><span class="linenos">  65</span></a><span class="sd">    [proteusPy.Turtle3D](turtle3D.html) class. The disulfide bond is an important</span>
</span><span id="Disulfide-66"><a href="#Disulfide-66"><span class="linenos">  66</span></a><span class="sd">    intermolecular stabilizing structural element and is characterized by:</span>
</span><span id="Disulfide-67"><a href="#Disulfide-67"><span class="linenos">  67</span></a>
</span><span id="Disulfide-68"><a href="#Disulfide-68"><span class="linenos">  68</span></a><span class="sd">    * Atomic coordinates for the atoms N, Cα, Cβ, C&#39;, Sγ for both residues. </span>
</span><span id="Disulfide-69"><a href="#Disulfide-69"><span class="linenos">  69</span></a><span class="sd">    These are stored as both raw atomic coordinates as read from the RCSB file </span>
</span><span id="Disulfide-70"><a href="#Disulfide-70"><span class="linenos">  70</span></a><span class="sd">    and internal local coordinates.</span>
</span><span id="Disulfide-71"><a href="#Disulfide-71"><span class="linenos">  71</span></a><span class="sd">    * The dihedral angles Χ1 - Χ5 for the disulfide bond</span>
</span><span id="Disulfide-72"><a href="#Disulfide-72"><span class="linenos">  72</span></a><span class="sd">    * A name, by default {pdb_id}{prox_resnumb}{prox_chain}_{distal_resnum}{distal_chain} </span>
</span><span id="Disulfide-73"><a href="#Disulfide-73"><span class="linenos">  73</span></a><span class="sd">    * Proximal residue number</span>
</span><span id="Disulfide-74"><a href="#Disulfide-74"><span class="linenos">  74</span></a><span class="sd">    * Distal residue number</span>
</span><span id="Disulfide-75"><a href="#Disulfide-75"><span class="linenos">  75</span></a><span class="sd">    * Approximate bond torsional energy (kcal/mol):</span>
</span><span id="Disulfide-76"><a href="#Disulfide-76"><span class="linenos">  76</span></a><span class="sd">    </span>
</span><span id="Disulfide-77"><a href="#Disulfide-77"><span class="linenos">  77</span></a><span class="sd">    $$ </span>
</span><span id="Disulfide-78"><a href="#Disulfide-78"><span class="linenos">  78</span></a><span class="sd">    E_{kcal/mol} \\approx 2.0 * cos(3.0 * \\chi_{1}) + cos(3.0 * \\chi_{5}) + cos(3.0 * \\chi_{2}) + </span>
</span><span id="Disulfide-79"><a href="#Disulfide-79"><span class="linenos">  79</span></a><span class="sd">    $$</span>
</span><span id="Disulfide-80"><a href="#Disulfide-80"><span class="linenos">  80</span></a>
</span><span id="Disulfide-81"><a href="#Disulfide-81"><span class="linenos">  81</span></a><span class="sd">    $$</span>
</span><span id="Disulfide-82"><a href="#Disulfide-82"><span class="linenos">  82</span></a><span class="sd">    cos(3.0 * \\chi_{4}) + 3.5 * cos(2.0 * \\chi_{3}) + 0.6 * cos(3.0 * \\chi_{3}) + 10.1 </span>
</span><span id="Disulfide-83"><a href="#Disulfide-83"><span class="linenos">  83</span></a><span class="sd">    $$</span>
</span><span id="Disulfide-84"><a href="#Disulfide-84"><span class="linenos">  84</span></a><span class="sd">    </span>
</span><span id="Disulfide-85"><a href="#Disulfide-85"><span class="linenos">  85</span></a><span class="sd">    The equation embodies the typical 3-fold rotation barriers associated with single bonds,</span>
</span><span id="Disulfide-86"><a href="#Disulfide-86"><span class="linenos">  86</span></a><span class="sd">    (Χ1, Χ5, Χ2, Χ4) and a high 2-fold barrier for Χ3, resulting from the partial double bond</span>
</span><span id="Disulfide-87"><a href="#Disulfide-87"><span class="linenos">  87</span></a><span class="sd">    character of the S-S bond. This property leads to two major disulfide families, characterized</span>
</span><span id="Disulfide-88"><a href="#Disulfide-88"><span class="linenos">  88</span></a><span class="sd">    by the sign of Χ3. *Left-handed* disulfides have Χ3 &lt; 0° and *right-handed* disulfides have</span>
</span><span id="Disulfide-89"><a href="#Disulfide-89"><span class="linenos">  89</span></a><span class="sd">    Χ3 &gt; 0°. Within this breakdown there are numerous subfamilies, broadly known as the *hook*,</span>
</span><span id="Disulfide-90"><a href="#Disulfide-90"><span class="linenos">  90</span></a><span class="sd">    *spiral* and *staple*. These are under characgterization.</span>
</span><span id="Disulfide-91"><a href="#Disulfide-91"><span class="linenos">  91</span></a>
</span><span id="Disulfide-92"><a href="#Disulfide-92"><span class="linenos">  92</span></a><span class="sd">    * Euclidean length of the dihedral angles (degrees) defined as:</span>
</span><span id="Disulfide-93"><a href="#Disulfide-93"><span class="linenos">  93</span></a><span class="sd">    $$\\sqrt(\\chi_{1}^{2} + \\chi_{2}^{2} + \\chi_{3}^{2} + \\chi_{4}^{2} + \\chi_{5}^{2})$$</span>
</span><span id="Disulfide-94"><a href="#Disulfide-94"><span class="linenos">  94</span></a><span class="sd">    * Cα - Cα distance (Å)</span>
</span><span id="Disulfide-95"><a href="#Disulfide-95"><span class="linenos">  95</span></a><span class="sd">    * The previous C&#39; and next N for both the proximal and distal residues. These are needed</span>
</span><span id="Disulfide-96"><a href="#Disulfide-96"><span class="linenos">  96</span></a><span class="sd">    to calculate the backbone dihedral angles Φ and Ψ.</span>
</span><span id="Disulfide-97"><a href="#Disulfide-97"><span class="linenos">  97</span></a><span class="sd">    * Backbone dihedral angles Φ and Ψ, when possible. Not all structures are complete and</span>
</span><span id="Disulfide-98"><a href="#Disulfide-98"><span class="linenos">  98</span></a><span class="sd">    in those cases the atoms needed may be undefined. In this case the Φ and Ψ angles are set</span>
</span><span id="Disulfide-99"><a href="#Disulfide-99"><span class="linenos">  99</span></a><span class="sd">    to -180°.</span>
</span><span id="Disulfide-100"><a href="#Disulfide-100"><span class="linenos"> 100</span></a><span class="sd">    </span>
</span><span id="Disulfide-101"><a href="#Disulfide-101"><span class="linenos"> 101</span></a><span class="sd">    The class also provides a rendering capabilities using the excellent [PyVista](https://pyvista.org)</span>
</span><span id="Disulfide-102"><a href="#Disulfide-102"><span class="linenos"> 102</span></a><span class="sd">    library, and can display disulfides interactively in a variety of display styles:</span>
</span><span id="Disulfide-103"><a href="#Disulfide-103"><span class="linenos"> 103</span></a><span class="sd">    * &#39;sb&#39; - Split Bonds style - bonds colored by their atom type</span>
</span><span id="Disulfide-104"><a href="#Disulfide-104"><span class="linenos"> 104</span></a><span class="sd">    * &#39;bs&#39; - Ball and Stick style - split bond coloring with small atoms</span>
</span><span id="Disulfide-105"><a href="#Disulfide-105"><span class="linenos"> 105</span></a><span class="sd">    * &#39;pd&#39; - Proximal/Distal style - bonds colored *Red* for proximal residue and *Green* for</span>
</span><span id="Disulfide-106"><a href="#Disulfide-106"><span class="linenos"> 106</span></a><span class="sd">    the distal residue.</span>
</span><span id="Disulfide-107"><a href="#Disulfide-107"><span class="linenos"> 107</span></a><span class="sd">    * &#39;cpk&#39; - CPK style rendering, colored by atom type:</span>
</span><span id="Disulfide-108"><a href="#Disulfide-108"><span class="linenos"> 108</span></a><span class="sd">        * Carbon   - Grey</span>
</span><span id="Disulfide-109"><a href="#Disulfide-109"><span class="linenos"> 109</span></a><span class="sd">        * Nitrogen - Blue</span>
</span><span id="Disulfide-110"><a href="#Disulfide-110"><span class="linenos"> 110</span></a><span class="sd">        * Sulfur   - Yellow</span>
</span><span id="Disulfide-111"><a href="#Disulfide-111"><span class="linenos"> 111</span></a><span class="sd">        * Oxygen   - Red</span>
</span><span id="Disulfide-112"><a href="#Disulfide-112"><span class="linenos"> 112</span></a><span class="sd">        * Hydrogen - White </span>
</span><span id="Disulfide-113"><a href="#Disulfide-113"><span class="linenos"> 113</span></a><span class="sd">    </span>
</span><span id="Disulfide-114"><a href="#Disulfide-114"><span class="linenos"> 114</span></a><span class="sd">    Individual displays can be saved to a file, and animations created.</span>
</span><span id="Disulfide-115"><a href="#Disulfide-115"><span class="linenos"> 115</span></a>
</span><span id="Disulfide-116"><a href="#Disulfide-116"><span class="linenos"> 116</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Disulfide-117"><a href="#Disulfide-117"><span class="linenos"> 117</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;SSBOND&quot;</span><span class="p">,</span> <span class="n">proximal</span><span class="p">:</span> <span class="nb">int</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Disulfide-118"><a href="#Disulfide-118"><span class="linenos"> 118</span></a>                <span class="n">distal</span><span class="p">:</span> <span class="nb">int</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">proximal_chain</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span>
</span><span id="Disulfide-119"><a href="#Disulfide-119"><span class="linenos"> 119</span></a>                <span class="n">distal_chain</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">pdb_id</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;1egs&#39;</span><span class="p">,</span>
</span><span id="Disulfide-120"><a href="#Disulfide-120"><span class="linenos"> 120</span></a>                <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">permissive</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
</span><span id="Disulfide-121"><a href="#Disulfide-121"><span class="linenos"> 121</span></a>                <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Disulfide-122"><a href="#Disulfide-122"><span class="linenos"> 122</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-123"><a href="#Disulfide-123"><span class="linenos"> 123</span></a><span class="sd">        __init__ Initialize the class to defined internal values.</span>
</span><span id="Disulfide-124"><a href="#Disulfide-124"><span class="linenos"> 124</span></a>
</span><span id="Disulfide-125"><a href="#Disulfide-125"><span class="linenos"> 125</span></a><span class="sd">        :param name: Disulfide name, by default &quot;SSBOND&quot;</span>
</span><span id="Disulfide-126"><a href="#Disulfide-126"><span class="linenos"> 126</span></a><span class="sd">            </span>
</span><span id="Disulfide-127"><a href="#Disulfide-127"><span class="linenos"> 127</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-128"><a href="#Disulfide-128"><span class="linenos"> 128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="Disulfide-129"><a href="#Disulfide-129"><span class="linenos"> 129</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal</span> <span class="o">=</span> <span class="n">proximal</span>
</span><span id="Disulfide-130"><a href="#Disulfide-130"><span class="linenos"> 130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal</span> <span class="o">=</span> <span class="n">distal</span>
</span><span id="Disulfide-131"><a href="#Disulfide-131"><span class="linenos"> 131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="n">_FLOAT_INIT</span>
</span><span id="Disulfide-132"><a href="#Disulfide-132"><span class="linenos"> 132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal_chain</span> <span class="o">=</span> <span class="n">proximal_chain</span>
</span><span id="Disulfide-133"><a href="#Disulfide-133"><span class="linenos"> 133</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal_chain</span> <span class="o">=</span> <span class="n">distal_chain</span>
</span><span id="Disulfide-134"><a href="#Disulfide-134"><span class="linenos"> 134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_id</span> <span class="o">=</span> <span class="n">pdb_id</span>
</span><span id="Disulfide-135"><a href="#Disulfide-135"><span class="linenos"> 135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal_residue_fullid</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Disulfide-136"><a href="#Disulfide-136"><span class="linenos"> 136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal_residue_fullid</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Disulfide-137"><a href="#Disulfide-137"><span class="linenos"> 137</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">PERMISSIVE</span> <span class="o">=</span> <span class="n">permissive</span>
</span><span id="Disulfide-138"><a href="#Disulfide-138"><span class="linenos"> 138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">QUIET</span> <span class="o">=</span> <span class="n">quiet</span>
</span><span id="Disulfide-139"><a href="#Disulfide-139"><span class="linenos"> 139</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span> <span class="o">=</span> <span class="n">_FLOAT_INIT</span>
</span><span id="Disulfide-140"><a href="#Disulfide-140"><span class="linenos"> 140</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_distance</span> <span class="o">=</span> <span class="n">_FLOAT_INIT</span>
</span><span id="Disulfide-141"><a href="#Disulfide-141"><span class="linenos"> 141</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">_ANG_INIT</span><span class="p">,</span> <span class="n">_ANG_INIT</span><span class="p">,</span> <span class="n">_ANG_INIT</span><span class="p">,</span> 
</span><span id="Disulfide-142"><a href="#Disulfide-142"><span class="linenos"> 142</span></a>        								  <span class="n">_ANG_INIT</span><span class="p">,</span> <span class="n">_ANG_INIT</span><span class="p">))</span>
</span><span id="Disulfide-143"><a href="#Disulfide-143"><span class="linenos"> 143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">phiprox</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="Disulfide-144"><a href="#Disulfide-144"><span class="linenos"> 144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">psiprox</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="Disulfide-145"><a href="#Disulfide-145"><span class="linenos"> 145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">phidist</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="Disulfide-146"><a href="#Disulfide-146"><span class="linenos"> 146</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">psidist</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="Disulfide-147"><a href="#Disulfide-147"><span class="linenos"> 147</span></a>
</span><span id="Disulfide-148"><a href="#Disulfide-148"><span class="linenos"> 148</span></a>        <span class="c1"># global coordinates for the Disulfide, typically as </span>
</span><span id="Disulfide-149"><a href="#Disulfide-149"><span class="linenos"> 149</span></a>        <span class="c1"># returned from the PDB file</span>
</span><span id="Disulfide-150"><a href="#Disulfide-150"><span class="linenos"> 150</span></a>
</span><span id="Disulfide-151"><a href="#Disulfide-151"><span class="linenos"> 151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-152"><a href="#Disulfide-152"><span class="linenos"> 152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-153"><a href="#Disulfide-153"><span class="linenos"> 153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-154"><a href="#Disulfide-154"><span class="linenos"> 154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">o_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-155"><a href="#Disulfide-155"><span class="linenos"> 155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-156"><a href="#Disulfide-156"><span class="linenos"> 156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-157"><a href="#Disulfide-157"><span class="linenos"> 157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-158"><a href="#Disulfide-158"><span class="linenos"> 158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-159"><a href="#Disulfide-159"><span class="linenos"> 159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-160"><a href="#Disulfide-160"><span class="linenos"> 160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-161"><a href="#Disulfide-161"><span class="linenos"> 161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-162"><a href="#Disulfide-162"><span class="linenos"> 162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">o_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-163"><a href="#Disulfide-163"><span class="linenos"> 163</span></a>
</span><span id="Disulfide-164"><a href="#Disulfide-164"><span class="linenos"> 164</span></a>        <span class="c1"># set when we can&#39;t find previous or next prox or distal</span>
</span><span id="Disulfide-165"><a href="#Disulfide-165"><span class="linenos"> 165</span></a>        <span class="c1"># C&#39; or N atoms.</span>
</span><span id="Disulfide-166"><a href="#Disulfide-166"><span class="linenos"> 166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">missing_atoms</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Disulfide-167"><a href="#Disulfide-167"><span class="linenos"> 167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modelled</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Disulfide-168"><a href="#Disulfide-168"><span class="linenos"> 168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
</span><span id="Disulfide-169"><a href="#Disulfide-169"><span class="linenos"> 169</span></a>
</span><span id="Disulfide-170"><a href="#Disulfide-170"><span class="linenos"> 170</span></a>        <span class="c1"># need these to calculate backbone dihedral angles</span>
</span><span id="Disulfide-171"><a href="#Disulfide-171"><span class="linenos"> 171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prev_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-172"><a href="#Disulfide-172"><span class="linenos"> 172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_next_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-173"><a href="#Disulfide-173"><span class="linenos"> 173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prev_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-174"><a href="#Disulfide-174"><span class="linenos"> 174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_next_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-175"><a href="#Disulfide-175"><span class="linenos"> 175</span></a>
</span><span id="Disulfide-176"><a href="#Disulfide-176"><span class="linenos"> 176</span></a>        <span class="c1"># local coordinates for the Disulfide, computed using the Turtle3D in </span>
</span><span id="Disulfide-177"><a href="#Disulfide-177"><span class="linenos"> 177</span></a>        <span class="c1"># Orientation #1. these are generally private.</span>
</span><span id="Disulfide-178"><a href="#Disulfide-178"><span class="linenos"> 178</span></a>
</span><span id="Disulfide-179"><a href="#Disulfide-179"><span class="linenos"> 179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-180"><a href="#Disulfide-180"><span class="linenos"> 180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ca_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-181"><a href="#Disulfide-181"><span class="linenos"> 181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-182"><a href="#Disulfide-182"><span class="linenos"> 182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_o_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-183"><a href="#Disulfide-183"><span class="linenos"> 183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cb_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-184"><a href="#Disulfide-184"><span class="linenos"> 184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sg_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-185"><a href="#Disulfide-185"><span class="linenos"> 185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sg_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-186"><a href="#Disulfide-186"><span class="linenos"> 186</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cb_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-187"><a href="#Disulfide-187"><span class="linenos"> 187</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ca_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-188"><a href="#Disulfide-188"><span class="linenos"> 188</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-189"><a href="#Disulfide-189"><span class="linenos"> 189</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-190"><a href="#Disulfide-190"><span class="linenos"> 190</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_o_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-191"><a href="#Disulfide-191"><span class="linenos"> 191</span></a>
</span><span id="Disulfide-192"><a href="#Disulfide-192"><span class="linenos"> 192</span></a>        <span class="c1"># need these to calculate backbone dihedral angles</span>
</span><span id="Disulfide-193"><a href="#Disulfide-193"><span class="linenos"> 193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_prev_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-194"><a href="#Disulfide-194"><span class="linenos"> 194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_next_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-195"><a href="#Disulfide-195"><span class="linenos"> 195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_prev_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-196"><a href="#Disulfide-196"><span class="linenos"> 196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_next_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-197"><a href="#Disulfide-197"><span class="linenos"> 197</span></a>
</span><span id="Disulfide-198"><a href="#Disulfide-198"><span class="linenos"> 198</span></a>        <span class="c1"># Dihedral angles for the disulfide bond itself, set to _ANG_INIT</span>
</span><span id="Disulfide-199"><a href="#Disulfide-199"><span class="linenos"> 199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi1</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="Disulfide-200"><a href="#Disulfide-200"><span class="linenos"> 200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi2</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="Disulfide-201"><a href="#Disulfide-201"><span class="linenos"> 201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="Disulfide-202"><a href="#Disulfide-202"><span class="linenos"> 202</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi4</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="Disulfide-203"><a href="#Disulfide-203"><span class="linenos"> 203</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi5</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="Disulfide-204"><a href="#Disulfide-204"><span class="linenos"> 204</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span> <span class="n">_ANG_INIT</span> <span class="c1"># new dihedral angle: Nprox - Ca_prox - Ca_dist - N_dist</span>
</span><span id="Disulfide-205"><a href="#Disulfide-205"><span class="linenos"> 205</span></a>
</span><span id="Disulfide-206"><a href="#Disulfide-206"><span class="linenos"> 206</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span> <span class="o">=</span> <span class="n">_FLOAT_INIT</span>
</span><span id="Disulfide-207"><a href="#Disulfide-207"><span class="linenos"> 207</span></a>    
</span><span id="Disulfide-208"><a href="#Disulfide-208"><span class="linenos"> 208</span></a>    <span class="c1"># comparison operators, used for sorting. keyed to SS bond energy</span>
</span><span id="Disulfide-209"><a href="#Disulfide-209"><span class="linenos"> 209</span></a>    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Disulfide-210"><a href="#Disulfide-210"><span class="linenos"> 210</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Disulfide</span><span class="p">):</span>
</span><span id="Disulfide-211"><a href="#Disulfide-211"><span class="linenos"> 211</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">energy</span>
</span><span id="Disulfide-212"><a href="#Disulfide-212"><span class="linenos"> 212</span></a>
</span><span id="Disulfide-213"><a href="#Disulfide-213"><span class="linenos"> 213</span></a>    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Disulfide-214"><a href="#Disulfide-214"><span class="linenos"> 214</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Disulfide</span><span class="p">):</span>
</span><span id="Disulfide-215"><a href="#Disulfide-215"><span class="linenos"> 215</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">energy</span>
</span><span id="Disulfide-216"><a href="#Disulfide-216"><span class="linenos"> 216</span></a>    
</span><span id="Disulfide-217"><a href="#Disulfide-217"><span class="linenos"> 217</span></a>    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Disulfide-218"><a href="#Disulfide-218"><span class="linenos"> 218</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Disulfide</span><span class="p">):</span>
</span><span id="Disulfide-219"><a href="#Disulfide-219"><span class="linenos"> 219</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">energy</span>
</span><span id="Disulfide-220"><a href="#Disulfide-220"><span class="linenos"> 220</span></a>
</span><span id="Disulfide-221"><a href="#Disulfide-221"><span class="linenos"> 221</span></a>    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Disulfide-222"><a href="#Disulfide-222"><span class="linenos"> 222</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Disulfide</span><span class="p">):</span>
</span><span id="Disulfide-223"><a href="#Disulfide-223"><span class="linenos"> 223</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">energy</span>
</span><span id="Disulfide-224"><a href="#Disulfide-224"><span class="linenos"> 224</span></a>
</span><span id="Disulfide-225"><a href="#Disulfide-225"><span class="linenos"> 225</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Disulfide-226"><a href="#Disulfide-226"><span class="linenos"> 226</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Disulfide</span><span class="p">):</span>
</span><span id="Disulfide-227"><a href="#Disulfide-227"><span class="linenos"> 227</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">energy</span>
</span><span id="Disulfide-228"><a href="#Disulfide-228"><span class="linenos"> 228</span></a>
</span><span id="Disulfide-229"><a href="#Disulfide-229"><span class="linenos"> 229</span></a>    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Disulfide-230"><a href="#Disulfide-230"><span class="linenos"> 230</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Disulfide</span><span class="p">):</span>
</span><span id="Disulfide-231"><a href="#Disulfide-231"><span class="linenos"> 231</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">energy</span>
</span><span id="Disulfide-232"><a href="#Disulfide-232"><span class="linenos"> 232</span></a>    
</span><span id="Disulfide-233"><a href="#Disulfide-233"><span class="linenos"> 233</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide-234"><a href="#Disulfide-234"><span class="linenos"> 234</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide-235"><a href="#Disulfide-235"><span class="linenos"> 235</span></a><span class="sd">        Representation for the Disulfide class</span>
</span><span id="Disulfide-236"><a href="#Disulfide-236"><span class="linenos"> 236</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide-237"><a href="#Disulfide-237"><span class="linenos"> 237</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_info</span><span class="p">()</span>
</span><span id="Disulfide-238"><a href="#Disulfide-238"><span class="linenos"> 238</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s1</span><span class="si">}</span><span class="s1">&gt;&#39;</span>
</span><span id="Disulfide-239"><a href="#Disulfide-239"><span class="linenos"> 239</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="Disulfide-240"><a href="#Disulfide-240"><span class="linenos"> 240</span></a>    
</span><span id="Disulfide-241"><a href="#Disulfide-241"><span class="linenos"> 241</span></a>    <span class="k">def</span> <span class="nf">_render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pvplot</span><span class="p">:</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;bs&#39;</span><span class="p">,</span> <span class="n">plain</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Disulfide-242"><a href="#Disulfide-242"><span class="linenos"> 242</span></a>            <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="Disulfide-243"><a href="#Disulfide-243"><span class="linenos"> 243</span></a>            <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Disulfide-244"><a href="#Disulfide-244"><span class="linenos"> 244</span></a>            <span class="n">bond_radius</span><span class="o">=</span><span class="n">BOND_RADIUS</span><span class="p">,</span> <span class="n">res</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
</span><span id="Disulfide-245"><a href="#Disulfide-245"><span class="linenos"> 245</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-246"><a href="#Disulfide-246"><span class="linenos"> 246</span></a><span class="sd">        Update the passed pyVista plotter() object with the mesh data for the</span>
</span><span id="Disulfide-247"><a href="#Disulfide-247"><span class="linenos"> 247</span></a><span class="sd">        input Disulfide Bond. Used internally</span>
</span><span id="Disulfide-248"><a href="#Disulfide-248"><span class="linenos"> 248</span></a>
</span><span id="Disulfide-249"><a href="#Disulfide-249"><span class="linenos"> 249</span></a><span class="sd">        Parameters</span>
</span><span id="Disulfide-250"><a href="#Disulfide-250"><span class="linenos"> 250</span></a><span class="sd">        ----------</span>
</span><span id="Disulfide-251"><a href="#Disulfide-251"><span class="linenos"> 251</span></a><span class="sd">        pvplot : pv.Plotter</span>
</span><span id="Disulfide-252"><a href="#Disulfide-252"><span class="linenos"> 252</span></a><span class="sd">            pyvista.Plotter object</span>
</span><span id="Disulfide-253"><a href="#Disulfide-253"><span class="linenos"> 253</span></a>
</span><span id="Disulfide-254"><a href="#Disulfide-254"><span class="linenos"> 254</span></a><span class="sd">        style : str, optional</span>
</span><span id="Disulfide-255"><a href="#Disulfide-255"><span class="linenos"> 255</span></a><span class="sd">            Rendering style, by default &#39;bs&#39;. One of &#39;bs&#39;, &#39;st&#39;, &#39;cpk&#39;, Render as \</span>
</span><span id="Disulfide-256"><a href="#Disulfide-256"><span class="linenos"> 256</span></a><span class="sd">            CPK, ball-and-stick or stick. Bonds are colored by atom color, unless \</span>
</span><span id="Disulfide-257"><a href="#Disulfide-257"><span class="linenos"> 257</span></a><span class="sd">            &#39;plain&#39; is specified.</span>
</span><span id="Disulfide-258"><a href="#Disulfide-258"><span class="linenos"> 258</span></a>
</span><span id="Disulfide-259"><a href="#Disulfide-259"><span class="linenos"> 259</span></a><span class="sd">        plain : bool, optional</span>
</span><span id="Disulfide-260"><a href="#Disulfide-260"><span class="linenos"> 260</span></a><span class="sd">            Used internally, by default False</span>
</span><span id="Disulfide-261"><a href="#Disulfide-261"><span class="linenos"> 261</span></a>
</span><span id="Disulfide-262"><a href="#Disulfide-262"><span class="linenos"> 262</span></a><span class="sd">        bondcolor : pyVista color name, optional bond color for simple bonds, by default BOND_COLOR</span>
</span><span id="Disulfide-263"><a href="#Disulfide-263"><span class="linenos"> 263</span></a>
</span><span id="Disulfide-264"><a href="#Disulfide-264"><span class="linenos"> 264</span></a><span class="sd">        bs_scale : float, optional</span>
</span><span id="Disulfide-265"><a href="#Disulfide-265"><span class="linenos"> 265</span></a><span class="sd">            scale factor (0-1) to reduce the atom sizes for ball and stick, by default BS_SCALE</span>
</span><span id="Disulfide-266"><a href="#Disulfide-266"><span class="linenos"> 266</span></a><span class="sd">        </span>
</span><span id="Disulfide-267"><a href="#Disulfide-267"><span class="linenos"> 267</span></a><span class="sd">        spec : float, optional</span>
</span><span id="Disulfide-268"><a href="#Disulfide-268"><span class="linenos"> 268</span></a><span class="sd">            specularity (0-1), where 1 is totally smooth and 0 is rough, by default SPECULARITY</span>
</span><span id="Disulfide-269"><a href="#Disulfide-269"><span class="linenos"> 269</span></a>
</span><span id="Disulfide-270"><a href="#Disulfide-270"><span class="linenos"> 270</span></a><span class="sd">        specpow : int, optional</span>
</span><span id="Disulfide-271"><a href="#Disulfide-271"><span class="linenos"> 271</span></a><span class="sd">            exponent used for specularity calculations, by default SPEC_POWER</span>
</span><span id="Disulfide-272"><a href="#Disulfide-272"><span class="linenos"> 272</span></a>
</span><span id="Disulfide-273"><a href="#Disulfide-273"><span class="linenos"> 273</span></a><span class="sd">        translate : bool, optional</span>
</span><span id="Disulfide-274"><a href="#Disulfide-274"><span class="linenos"> 274</span></a><span class="sd">            Flag used internally to indicate if we should translate \</span>
</span><span id="Disulfide-275"><a href="#Disulfide-275"><span class="linenos"> 275</span></a><span class="sd">            the disulfide to its geometric center of mass, by default True.</span>
</span><span id="Disulfide-276"><a href="#Disulfide-276"><span class="linenos"> 276</span></a>
</span><span id="Disulfide-277"><a href="#Disulfide-277"><span class="linenos"> 277</span></a><span class="sd">        Returns</span>
</span><span id="Disulfide-278"><a href="#Disulfide-278"><span class="linenos"> 278</span></a><span class="sd">        -------</span>
</span><span id="Disulfide-279"><a href="#Disulfide-279"><span class="linenos"> 279</span></a><span class="sd">        pv.Plotter</span>
</span><span id="Disulfide-280"><a href="#Disulfide-280"><span class="linenos"> 280</span></a><span class="sd">            Updated pv.Plotter object with atoms and bonds.</span>
</span><span id="Disulfide-281"><a href="#Disulfide-281"><span class="linenos"> 281</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-282"><a href="#Disulfide-282"><span class="linenos"> 282</span></a>        
</span><span id="Disulfide-283"><a href="#Disulfide-283"><span class="linenos"> 283</span></a>        <span class="n">_bradius</span> <span class="o">=</span> <span class="n">bond_radius</span>
</span><span id="Disulfide-284"><a href="#Disulfide-284"><span class="linenos"> 284</span></a>        <span class="n">coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_coords</span><span class="p">()</span>
</span><span id="Disulfide-285"><a href="#Disulfide-285"><span class="linenos"> 285</span></a>        <span class="n">missing_atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing_atoms</span>
</span><span id="Disulfide-286"><a href="#Disulfide-286"><span class="linenos"> 286</span></a>        <span class="n">clen</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Disulfide-287"><a href="#Disulfide-287"><span class="linenos"> 287</span></a>
</span><span id="Disulfide-288"><a href="#Disulfide-288"><span class="linenos"> 288</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modelled</span>
</span><span id="Disulfide-289"><a href="#Disulfide-289"><span class="linenos"> 289</span></a>        <span class="k">if</span> <span class="n">model</span><span class="p">:</span>
</span><span id="Disulfide-290"><a href="#Disulfide-290"><span class="linenos"> 290</span></a>            <span class="n">all_atoms</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Disulfide-291"><a href="#Disulfide-291"><span class="linenos"> 291</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Disulfide-292"><a href="#Disulfide-292"><span class="linenos"> 292</span></a>            <span class="n">all_atoms</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Disulfide-293"><a href="#Disulfide-293"><span class="linenos"> 293</span></a>
</span><span id="Disulfide-294"><a href="#Disulfide-294"><span class="linenos"> 294</span></a>        <span class="k">if</span> <span class="n">translate</span><span class="p">:</span>
</span><span id="Disulfide-295"><a href="#Disulfide-295"><span class="linenos"> 295</span></a>            <span class="n">cofmass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cofmass</span><span class="p">()</span>
</span><span id="Disulfide-296"><a href="#Disulfide-296"><span class="linenos"> 296</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">clen</span><span class="p">):</span>
</span><span id="Disulfide-297"><a href="#Disulfide-297"><span class="linenos"> 297</span></a>                <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">cofmass</span>
</span><span id="Disulfide-298"><a href="#Disulfide-298"><span class="linenos"> 298</span></a>        
</span><span id="Disulfide-299"><a href="#Disulfide-299"><span class="linenos"> 299</span></a>        <span class="n">atoms</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;SG&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
</span><span id="Disulfide-300"><a href="#Disulfide-300"><span class="linenos"> 300</span></a>        		 <span class="s1">&#39;SG&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">)</span>
</span><span id="Disulfide-301"><a href="#Disulfide-301"><span class="linenos"> 301</span></a>        <span class="n">pvp</span> <span class="o">=</span> <span class="n">pvplot</span>
</span><span id="Disulfide-302"><a href="#Disulfide-302"><span class="linenos"> 302</span></a>        
</span><span id="Disulfide-303"><a href="#Disulfide-303"><span class="linenos"> 303</span></a>        <span class="c1"># bond connection table with atoms in the specific order shown above: </span>
</span><span id="Disulfide-304"><a href="#Disulfide-304"><span class="linenos"> 304</span></a>        <span class="c1"># returned by ss.get_internal_coords()</span>
</span><span id="Disulfide-305"><a href="#Disulfide-305"><span class="linenos"> 305</span></a>        
</span><span id="Disulfide-306"><a href="#Disulfide-306"><span class="linenos"> 306</span></a>        <span class="k">def</span> <span class="nf">draw_bonds</span><span class="p">(</span><span class="n">pvp</span><span class="p">,</span> <span class="n">bradius</span><span class="o">=</span><span class="n">BOND_RADIUS</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span> 
</span><span id="Disulfide-307"><a href="#Disulfide-307"><span class="linenos"> 307</span></a>        			   <span class="n">bcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">all_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Disulfide-308"><a href="#Disulfide-308"><span class="linenos"> 308</span></a>                       <span class="n">res</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
</span><span id="Disulfide-309"><a href="#Disulfide-309"><span class="linenos"> 309</span></a>            <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-310"><a href="#Disulfide-310"><span class="linenos"> 310</span></a><span class="sd">            Generate the appropriate pyVista cylinder objects to represent</span>
</span><span id="Disulfide-311"><a href="#Disulfide-311"><span class="linenos"> 311</span></a><span class="sd">            a particular disulfide bond. This utilizes a connection table </span>
</span><span id="Disulfide-312"><a href="#Disulfide-312"><span class="linenos"> 312</span></a><span class="sd">            for the starting and ending atoms and a color table for the </span>
</span><span id="Disulfide-313"><a href="#Disulfide-313"><span class="linenos"> 313</span></a><span class="sd">            bond colors. Used internally.</span>
</span><span id="Disulfide-314"><a href="#Disulfide-314"><span class="linenos"> 314</span></a>
</span><span id="Disulfide-315"><a href="#Disulfide-315"><span class="linenos"> 315</span></a><span class="sd">            :param pvp: input plotter object to be updated</span>
</span><span id="Disulfide-316"><a href="#Disulfide-316"><span class="linenos"> 316</span></a><span class="sd">            :param bradius: bond radius</span>
</span><span id="Disulfide-317"><a href="#Disulfide-317"><span class="linenos"> 317</span></a><span class="sd">            :param style: bond style. One of sb, plain, pd</span>
</span><span id="Disulfide-318"><a href="#Disulfide-318"><span class="linenos"> 318</span></a><span class="sd">            :param bcolor: pyvista color</span>
</span><span id="Disulfide-319"><a href="#Disulfide-319"><span class="linenos"> 319</span></a><span class="sd">            :param missing: True if atoms are missing, False othersie</span>
</span><span id="Disulfide-320"><a href="#Disulfide-320"><span class="linenos"> 320</span></a><span class="sd">            :param all_atoms: True if rendering O, False if only backbone rendered</span>
</span><span id="Disulfide-321"><a href="#Disulfide-321"><span class="linenos"> 321</span></a><span class="sd">            </span>
</span><span id="Disulfide-322"><a href="#Disulfide-322"><span class="linenos"> 322</span></a><span class="sd">            :return pvp: Updated Plotter object.</span>
</span><span id="Disulfide-323"><a href="#Disulfide-323"><span class="linenos"> 323</span></a><span class="sd">                </span>
</span><span id="Disulfide-324"><a href="#Disulfide-324"><span class="linenos"> 324</span></a><span class="sd">            &#39;&#39;&#39;</span>
</span><span id="Disulfide-325"><a href="#Disulfide-325"><span class="linenos"> 325</span></a>            <span class="n">_bond_conn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="Disulfide-326"><a href="#Disulfide-326"><span class="linenos"> 326</span></a>            <span class="p">[</span>
</span><span id="Disulfide-327"><a href="#Disulfide-327"><span class="linenos"> 327</span></a>                <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># n-ca</span>
</span><span id="Disulfide-328"><a href="#Disulfide-328"><span class="linenos"> 328</span></a>                <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="c1"># ca-c</span>
</span><span id="Disulfide-329"><a href="#Disulfide-329"><span class="linenos"> 329</span></a>                <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="c1"># c-o</span>
</span><span id="Disulfide-330"><a href="#Disulfide-330"><span class="linenos"> 330</span></a>                <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="c1"># ca-cb</span>
</span><span id="Disulfide-331"><a href="#Disulfide-331"><span class="linenos"> 331</span></a>                <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="c1"># cb-sg</span>
</span><span id="Disulfide-332"><a href="#Disulfide-332"><span class="linenos"> 332</span></a>                <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="c1"># n-ca</span>
</span><span id="Disulfide-333"><a href="#Disulfide-333"><span class="linenos"> 333</span></a>                <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="c1"># ca-c</span>
</span><span id="Disulfide-334"><a href="#Disulfide-334"><span class="linenos"> 334</span></a>                <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="c1"># c-o</span>
</span><span id="Disulfide-335"><a href="#Disulfide-335"><span class="linenos"> 335</span></a>                <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="c1"># ca-cb</span>
</span><span id="Disulfide-336"><a href="#Disulfide-336"><span class="linenos"> 336</span></a>                <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="c1"># cb-sg</span>
</span><span id="Disulfide-337"><a href="#Disulfide-337"><span class="linenos"> 337</span></a>                <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>  <span class="c1"># sg -sg</span>
</span><span id="Disulfide-338"><a href="#Disulfide-338"><span class="linenos"> 338</span></a>                <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># cprev_prox-n</span>
</span><span id="Disulfide-339"><a href="#Disulfide-339"><span class="linenos"> 339</span></a>                <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>  <span class="c1"># c-nnext_prox</span>
</span><span id="Disulfide-340"><a href="#Disulfide-340"><span class="linenos"> 340</span></a>                <span class="p">[</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>   <span class="c1"># cprev_dist-n_dist</span>
</span><span id="Disulfide-341"><a href="#Disulfide-341"><span class="linenos"> 341</span></a>                <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">15</span><span class="p">]</span>    <span class="c1"># c-nnext_dist</span>
</span><span id="Disulfide-342"><a href="#Disulfide-342"><span class="linenos"> 342</span></a>            <span class="p">])</span>
</span><span id="Disulfide-343"><a href="#Disulfide-343"><span class="linenos"> 343</span></a>
</span><span id="Disulfide-344"><a href="#Disulfide-344"><span class="linenos"> 344</span></a>            <span class="c1"># modeled disulfides only have backbone atoms since</span>
</span><span id="Disulfide-345"><a href="#Disulfide-345"><span class="linenos"> 345</span></a>            <span class="c1"># phi and psi are undefined, which makes the carbonyl</span>
</span><span id="Disulfide-346"><a href="#Disulfide-346"><span class="linenos"> 346</span></a>            <span class="c1"># oxygen (O) undefined as well. Their previous and next N</span>
</span><span id="Disulfide-347"><a href="#Disulfide-347"><span class="linenos"> 347</span></a>            <span class="c1"># are also undefined.</span>
</span><span id="Disulfide-348"><a href="#Disulfide-348"><span class="linenos"> 348</span></a>
</span><span id="Disulfide-349"><a href="#Disulfide-349"><span class="linenos"> 349</span></a>            <span class="n">_bond_conn_backbone</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="Disulfide-350"><a href="#Disulfide-350"><span class="linenos"> 350</span></a>            <span class="p">[</span>
</span><span id="Disulfide-351"><a href="#Disulfide-351"><span class="linenos"> 351</span></a>                <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="c1"># n-ca</span>
</span><span id="Disulfide-352"><a href="#Disulfide-352"><span class="linenos"> 352</span></a>                <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="c1"># ca-c</span>
</span><span id="Disulfide-353"><a href="#Disulfide-353"><span class="linenos"> 353</span></a>                <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="c1"># ca-cb</span>
</span><span id="Disulfide-354"><a href="#Disulfide-354"><span class="linenos"> 354</span></a>                <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="c1"># cb-sg</span>
</span><span id="Disulfide-355"><a href="#Disulfide-355"><span class="linenos"> 355</span></a>                <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="c1"># n-ca</span>
</span><span id="Disulfide-356"><a href="#Disulfide-356"><span class="linenos"> 356</span></a>                <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="c1"># ca-c</span>
</span><span id="Disulfide-357"><a href="#Disulfide-357"><span class="linenos"> 357</span></a>                <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="c1"># ca-cb</span>
</span><span id="Disulfide-358"><a href="#Disulfide-358"><span class="linenos"> 358</span></a>                <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="c1"># cb-sg</span>
</span><span id="Disulfide-359"><a href="#Disulfide-359"><span class="linenos"> 359</span></a>                <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>  <span class="c1"># sg -sg</span>
</span><span id="Disulfide-360"><a href="#Disulfide-360"><span class="linenos"> 360</span></a>            <span class="p">])</span>
</span><span id="Disulfide-361"><a href="#Disulfide-361"><span class="linenos"> 361</span></a>            
</span><span id="Disulfide-362"><a href="#Disulfide-362"><span class="linenos"> 362</span></a>            <span class="c1"># colors for the bonds. Index into ATOM_COLORS array</span>
</span><span id="Disulfide-363"><a href="#Disulfide-363"><span class="linenos"> 363</span></a>            <span class="n">_bond_split_colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="Disulfide-364"><a href="#Disulfide-364"><span class="linenos"> 364</span></a>                <span class="p">[</span>
</span><span id="Disulfide-365"><a href="#Disulfide-365"><span class="linenos"> 365</span></a>                    <span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="Disulfide-366"><a href="#Disulfide-366"><span class="linenos"> 366</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="Disulfide-367"><a href="#Disulfide-367"><span class="linenos"> 367</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">),</span>
</span><span id="Disulfide-368"><a href="#Disulfide-368"><span class="linenos"> 368</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="Disulfide-369"><a href="#Disulfide-369"><span class="linenos"> 369</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;SG&#39;</span><span class="p">),</span>
</span><span id="Disulfide-370"><a href="#Disulfide-370"><span class="linenos"> 370</span></a>                    <span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="Disulfide-371"><a href="#Disulfide-371"><span class="linenos"> 371</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="Disulfide-372"><a href="#Disulfide-372"><span class="linenos"> 372</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">),</span>
</span><span id="Disulfide-373"><a href="#Disulfide-373"><span class="linenos"> 373</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="Disulfide-374"><a href="#Disulfide-374"><span class="linenos"> 374</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;SG&#39;</span><span class="p">),</span>
</span><span id="Disulfide-375"><a href="#Disulfide-375"><span class="linenos"> 375</span></a>                    <span class="p">(</span><span class="s1">&#39;SG&#39;</span><span class="p">,</span> <span class="s1">&#39;SG&#39;</span><span class="p">),</span>
</span><span id="Disulfide-376"><a href="#Disulfide-376"><span class="linenos"> 376</span></a>                    <span class="c1"># prev and next C-N bonds - color by atom Z</span>
</span><span id="Disulfide-377"><a href="#Disulfide-377"><span class="linenos"> 377</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">),</span>
</span><span id="Disulfide-378"><a href="#Disulfide-378"><span class="linenos"> 378</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">),</span>
</span><span id="Disulfide-379"><a href="#Disulfide-379"><span class="linenos"> 379</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">),</span>
</span><span id="Disulfide-380"><a href="#Disulfide-380"><span class="linenos"> 380</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">)</span>
</span><span id="Disulfide-381"><a href="#Disulfide-381"><span class="linenos"> 381</span></a>                <span class="p">]</span>
</span><span id="Disulfide-382"><a href="#Disulfide-382"><span class="linenos"> 382</span></a>            <span class="p">)</span>
</span><span id="Disulfide-383"><a href="#Disulfide-383"><span class="linenos"> 383</span></a>
</span><span id="Disulfide-384"><a href="#Disulfide-384"><span class="linenos"> 384</span></a>            <span class="n">_bond_split_colors_backbone</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="Disulfide-385"><a href="#Disulfide-385"><span class="linenos"> 385</span></a>                <span class="p">[</span>
</span><span id="Disulfide-386"><a href="#Disulfide-386"><span class="linenos"> 386</span></a>                    <span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="Disulfide-387"><a href="#Disulfide-387"><span class="linenos"> 387</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="Disulfide-388"><a href="#Disulfide-388"><span class="linenos"> 388</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="Disulfide-389"><a href="#Disulfide-389"><span class="linenos"> 389</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;SG&#39;</span><span class="p">),</span>
</span><span id="Disulfide-390"><a href="#Disulfide-390"><span class="linenos"> 390</span></a>                    <span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="Disulfide-391"><a href="#Disulfide-391"><span class="linenos"> 391</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="Disulfide-392"><a href="#Disulfide-392"><span class="linenos"> 392</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span>
</span><span id="Disulfide-393"><a href="#Disulfide-393"><span class="linenos"> 393</span></a>                    <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;SG&#39;</span><span class="p">),</span>
</span><span id="Disulfide-394"><a href="#Disulfide-394"><span class="linenos"> 394</span></a>                    <span class="p">(</span><span class="s1">&#39;SG&#39;</span><span class="p">,</span> <span class="s1">&#39;SG&#39;</span><span class="p">),</span>
</span><span id="Disulfide-395"><a href="#Disulfide-395"><span class="linenos"> 395</span></a>                <span class="p">]</span>
</span><span id="Disulfide-396"><a href="#Disulfide-396"><span class="linenos"> 396</span></a>            <span class="p">)</span>
</span><span id="Disulfide-397"><a href="#Disulfide-397"><span class="linenos"> 397</span></a>            <span class="c1"># work through connectivity and colors</span>
</span><span id="Disulfide-398"><a href="#Disulfide-398"><span class="linenos"> 398</span></a>            <span class="n">orig_col</span> <span class="o">=</span> <span class="n">dest_col</span> <span class="o">=</span> <span class="n">bcolor</span>
</span><span id="Disulfide-399"><a href="#Disulfide-399"><span class="linenos"> 399</span></a>
</span><span id="Disulfide-400"><a href="#Disulfide-400"><span class="linenos"> 400</span></a>            <span class="k">if</span> <span class="n">all_atoms</span><span class="p">:</span>
</span><span id="Disulfide-401"><a href="#Disulfide-401"><span class="linenos"> 401</span></a>                <span class="n">bond_conn</span> <span class="o">=</span> <span class="n">_bond_conn</span>
</span><span id="Disulfide-402"><a href="#Disulfide-402"><span class="linenos"> 402</span></a>                <span class="n">bond_split_colors</span> <span class="o">=</span> <span class="n">_bond_split_colors</span>
</span><span id="Disulfide-403"><a href="#Disulfide-403"><span class="linenos"> 403</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Disulfide-404"><a href="#Disulfide-404"><span class="linenos"> 404</span></a>                <span class="n">bond_conn</span> <span class="o">=</span> <span class="n">_bond_conn_backbone</span>
</span><span id="Disulfide-405"><a href="#Disulfide-405"><span class="linenos"> 405</span></a>                <span class="n">bond_split_colors</span> <span class="o">=</span> <span class="n">_bond_split_colors_backbone</span>
</span><span id="Disulfide-406"><a href="#Disulfide-406"><span class="linenos"> 406</span></a>
</span><span id="Disulfide-407"><a href="#Disulfide-407"><span class="linenos"> 407</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bond_conn</span><span class="p">)):</span>
</span><span id="Disulfide-408"><a href="#Disulfide-408"><span class="linenos"> 408</span></a>                <span class="k">if</span> <span class="n">all_atoms</span><span class="p">:</span>
</span><span id="Disulfide-409"><a href="#Disulfide-409"><span class="linenos"> 409</span></a>                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="ow">and</span> <span class="n">missing_atoms</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> <span class="c1"># skip missing atoms</span>
</span><span id="Disulfide-410"><a href="#Disulfide-410"><span class="linenos"> 410</span></a>                        <span class="k">continue</span>
</span><span id="Disulfide-411"><a href="#Disulfide-411"><span class="linenos"> 411</span></a>                
</span><span id="Disulfide-412"><a href="#Disulfide-412"><span class="linenos"> 412</span></a>                <span class="n">bond</span> <span class="o">=</span> <span class="n">bond_conn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="Disulfide-413"><a href="#Disulfide-413"><span class="linenos"> 413</span></a>
</span><span id="Disulfide-414"><a href="#Disulfide-414"><span class="linenos"> 414</span></a>                <span class="c1"># get the indices for the origin and destination atoms</span>
</span><span id="Disulfide-415"><a href="#Disulfide-415"><span class="linenos"> 415</span></a>                <span class="n">orig</span> <span class="o">=</span> <span class="n">bond</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Disulfide-416"><a href="#Disulfide-416"><span class="linenos"> 416</span></a>                <span class="n">dest</span> <span class="o">=</span> <span class="n">bond</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Disulfide-417"><a href="#Disulfide-417"><span class="linenos"> 417</span></a>
</span><span id="Disulfide-418"><a href="#Disulfide-418"><span class="linenos"> 418</span></a>                <span class="n">col</span> <span class="o">=</span> <span class="n">bond_split_colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="Disulfide-419"><a href="#Disulfide-419"><span class="linenos"> 419</span></a>
</span><span id="Disulfide-420"><a href="#Disulfide-420"><span class="linenos"> 420</span></a>                <span class="c1"># get the coords</span>
</span><span id="Disulfide-421"><a href="#Disulfide-421"><span class="linenos"> 421</span></a>                <span class="n">prox_pos</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="n">orig</span><span class="p">]</span>
</span><span id="Disulfide-422"><a href="#Disulfide-422"><span class="linenos"> 422</span></a>                <span class="n">distal_pos</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="n">dest</span><span class="p">]</span>
</span><span id="Disulfide-423"><a href="#Disulfide-423"><span class="linenos"> 423</span></a>                
</span><span id="Disulfide-424"><a href="#Disulfide-424"><span class="linenos"> 424</span></a>                <span class="c1"># compute a direction vector</span>
</span><span id="Disulfide-425"><a href="#Disulfide-425"><span class="linenos"> 425</span></a>                <span class="n">direction</span> <span class="o">=</span> <span class="n">distal_pos</span> <span class="o">-</span> <span class="n">prox_pos</span>
</span><span id="Disulfide-426"><a href="#Disulfide-426"><span class="linenos"> 426</span></a>
</span><span id="Disulfide-427"><a href="#Disulfide-427"><span class="linenos"> 427</span></a>                <span class="c1"># compute vector length. divide by 2 since split bond</span>
</span><span id="Disulfide-428"><a href="#Disulfide-428"><span class="linenos"> 428</span></a>                <span class="n">height</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">prox_pos</span><span class="p">,</span> <span class="n">distal_pos</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
</span><span id="Disulfide-429"><a href="#Disulfide-429"><span class="linenos"> 429</span></a>
</span><span id="Disulfide-430"><a href="#Disulfide-430"><span class="linenos"> 430</span></a>				<span class="c1"># the cylinder origins are actually in the </span>
</span><span id="Disulfide-431"><a href="#Disulfide-431"><span class="linenos"> 431</span></a>				<span class="c1"># middle so we translate</span>
</span><span id="Disulfide-432"><a href="#Disulfide-432"><span class="linenos"> 432</span></a>                
</span><span id="Disulfide-433"><a href="#Disulfide-433"><span class="linenos"> 433</span></a>                <span class="n">origin</span> <span class="o">=</span> <span class="n">prox_pos</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">direction</span> <span class="c1"># for a single plain bond</span>
</span><span id="Disulfide-434"><a href="#Disulfide-434"><span class="linenos"> 434</span></a>                <span class="n">origin1</span> <span class="o">=</span> <span class="n">prox_pos</span> <span class="o">+</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">direction</span> 
</span><span id="Disulfide-435"><a href="#Disulfide-435"><span class="linenos"> 435</span></a>                <span class="n">origin2</span> <span class="o">=</span> <span class="n">prox_pos</span> <span class="o">+</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="n">direction</span>
</span><span id="Disulfide-436"><a href="#Disulfide-436"><span class="linenos"> 436</span></a>                
</span><span id="Disulfide-437"><a href="#Disulfide-437"><span class="linenos"> 437</span></a>                <span class="n">bradius</span> <span class="o">=</span> <span class="n">_bradius</span>
</span><span id="Disulfide-438"><a href="#Disulfide-438"><span class="linenos"> 438</span></a>
</span><span id="Disulfide-439"><a href="#Disulfide-439"><span class="linenos"> 439</span></a>                <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;plain&#39;</span><span class="p">:</span>
</span><span id="Disulfide-440"><a href="#Disulfide-440"><span class="linenos"> 440</span></a>                    <span class="n">orig_col</span> <span class="o">=</span> <span class="n">dest_col</span> <span class="o">=</span> <span class="n">bcolor</span>
</span><span id="Disulfide-441"><a href="#Disulfide-441"><span class="linenos"> 441</span></a>                
</span><span id="Disulfide-442"><a href="#Disulfide-442"><span class="linenos"> 442</span></a>                <span class="c1"># proximal-distal red/green coloring</span>
</span><span id="Disulfide-443"><a href="#Disulfide-443"><span class="linenos"> 443</span></a>                <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;pd&#39;</span><span class="p">:</span>
</span><span id="Disulfide-444"><a href="#Disulfide-444"><span class="linenos"> 444</span></a>                    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">4</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">11</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
</span><span id="Disulfide-445"><a href="#Disulfide-445"><span class="linenos"> 445</span></a>                        <span class="n">orig_col</span> <span class="o">=</span> <span class="n">dest_col</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span>
</span><span id="Disulfide-446"><a href="#Disulfide-446"><span class="linenos"> 446</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Disulfide-447"><a href="#Disulfide-447"><span class="linenos"> 447</span></a>                        <span class="n">orig_col</span> <span class="o">=</span> <span class="n">dest_col</span><span class="o">=</span> <span class="s1">&#39;green&#39;</span>
</span><span id="Disulfide-448"><a href="#Disulfide-448"><span class="linenos"> 448</span></a>                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="Disulfide-449"><a href="#Disulfide-449"><span class="linenos"> 449</span></a>                        <span class="n">orig_col</span> <span class="o">=</span> <span class="n">dest_col</span><span class="o">=</span> <span class="s1">&#39;yellow&#39;</span>
</span><span id="Disulfide-450"><a href="#Disulfide-450"><span class="linenos"> 450</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Disulfide-451"><a href="#Disulfide-451"><span class="linenos"> 451</span></a>                    <span class="n">orig_col</span> <span class="o">=</span> <span class="n">ATOM_COLORS</span><span class="p">[</span><span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="Disulfide-452"><a href="#Disulfide-452"><span class="linenos"> 452</span></a>                    <span class="n">dest_col</span> <span class="o">=</span> <span class="n">ATOM_COLORS</span><span class="p">[</span><span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="Disulfide-453"><a href="#Disulfide-453"><span class="linenos"> 453</span></a>
</span><span id="Disulfide-454"><a href="#Disulfide-454"><span class="linenos"> 454</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">11</span><span class="p">:</span> <span class="c1"># prev and next residue atoms for phi/psi calcs</span>
</span><span id="Disulfide-455"><a href="#Disulfide-455"><span class="linenos"> 455</span></a>                    <span class="n">bradius</span> <span class="o">=</span> <span class="n">_bradius</span> <span class="o">*</span> <span class="mf">.5</span> <span class="c1"># make smaller to distinguish</span>
</span><span id="Disulfide-456"><a href="#Disulfide-456"><span class="linenos"> 456</span></a>                
</span><span id="Disulfide-457"><a href="#Disulfide-457"><span class="linenos"> 457</span></a>                <span class="n">cap1</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Sphere</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">prox_pos</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">bradius</span><span class="p">)</span>
</span><span id="Disulfide-458"><a href="#Disulfide-458"><span class="linenos"> 458</span></a>                <span class="n">cap2</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Sphere</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">distal_pos</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">bradius</span><span class="p">)</span>
</span><span id="Disulfide-459"><a href="#Disulfide-459"><span class="linenos"> 459</span></a>
</span><span id="Disulfide-460"><a href="#Disulfide-460"><span class="linenos"> 460</span></a>                <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;plain&#39;</span><span class="p">:</span>
</span><span id="Disulfide-461"><a href="#Disulfide-461"><span class="linenos"> 461</span></a>                    <span class="n">cyl</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Cylinder</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">bradius</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="o">*</span><span class="mf">2.0</span><span class="p">)</span> 
</span><span id="Disulfide-462"><a href="#Disulfide-462"><span class="linenos"> 462</span></a>                    <span class="n">pvp</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">cyl</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">orig_col</span><span class="p">)</span>
</span><span id="Disulfide-463"><a href="#Disulfide-463"><span class="linenos"> 463</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Disulfide-464"><a href="#Disulfide-464"><span class="linenos"> 464</span></a>                    <span class="n">cyl1</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Cylinder</span><span class="p">(</span><span class="n">origin1</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">bradius</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="n">capping</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="n">res</span><span class="p">)</span>
</span><span id="Disulfide-465"><a href="#Disulfide-465"><span class="linenos"> 465</span></a>                    <span class="n">cyl2</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Cylinder</span><span class="p">(</span><span class="n">origin2</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">bradius</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="n">capping</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="n">res</span><span class="p">)</span>
</span><span id="Disulfide-466"><a href="#Disulfide-466"><span class="linenos"> 466</span></a>                    <span class="n">pvp</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">cyl1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">orig_col</span><span class="p">)</span>
</span><span id="Disulfide-467"><a href="#Disulfide-467"><span class="linenos"> 467</span></a>                    <span class="n">pvp</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">cyl2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">dest_col</span><span class="p">)</span>
</span><span id="Disulfide-468"><a href="#Disulfide-468"><span class="linenos"> 468</span></a>        
</span><span id="Disulfide-469"><a href="#Disulfide-469"><span class="linenos"> 469</span></a>                <span class="n">pvp</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">cap1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">orig_col</span><span class="p">)</span>
</span><span id="Disulfide-470"><a href="#Disulfide-470"><span class="linenos"> 470</span></a>                <span class="n">pvp</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">cap2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">dest_col</span><span class="p">)</span>
</span><span id="Disulfide-471"><a href="#Disulfide-471"><span class="linenos"> 471</span></a>
</span><span id="Disulfide-472"><a href="#Disulfide-472"><span class="linenos"> 472</span></a>            <span class="k">return</span> <span class="n">pvp</span> <span class="c1"># end draw_bonds</span>
</span><span id="Disulfide-473"><a href="#Disulfide-473"><span class="linenos"> 473</span></a>        
</span><span id="Disulfide-474"><a href="#Disulfide-474"><span class="linenos"> 474</span></a>        <span class="k">if</span> <span class="n">style</span><span class="o">==</span><span class="s1">&#39;cpk&#39;</span><span class="p">:</span>
</span><span id="Disulfide-475"><a href="#Disulfide-475"><span class="linenos"> 475</span></a>            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Disulfide-476"><a href="#Disulfide-476"><span class="linenos"> 476</span></a>            <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">:</span>
</span><span id="Disulfide-477"><a href="#Disulfide-477"><span class="linenos"> 477</span></a>                <span class="n">rad</span> <span class="o">=</span> <span class="n">ATOM_RADII_CPK</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span>
</span><span id="Disulfide-478"><a href="#Disulfide-478"><span class="linenos"> 478</span></a>                <span class="n">pvp</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">pv</span><span class="o">.</span><span class="n">Sphere</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">radius</span><span class="o">=</span><span class="n">rad</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">ATOM_COLORS</span><span class="p">[</span><span class="n">atom</span><span class="p">],</span> 
</span><span id="Disulfide-479"><a href="#Disulfide-479"><span class="linenos"> 479</span></a>                             <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">specular</span><span class="o">=</span><span class="n">spec</span><span class="p">,</span> <span class="n">specular_power</span><span class="o">=</span><span class="n">specpow</span><span class="p">)</span>
</span><span id="Disulfide-480"><a href="#Disulfide-480"><span class="linenos"> 480</span></a>                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Disulfide-481"><a href="#Disulfide-481"><span class="linenos"> 481</span></a>        
</span><span id="Disulfide-482"><a href="#Disulfide-482"><span class="linenos"> 482</span></a>        <span class="k">elif</span> <span class="n">style</span><span class="o">==</span><span class="s1">&#39;cov&#39;</span><span class="p">:</span>
</span><span id="Disulfide-483"><a href="#Disulfide-483"><span class="linenos"> 483</span></a>            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Disulfide-484"><a href="#Disulfide-484"><span class="linenos"> 484</span></a>            <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">:</span>
</span><span id="Disulfide-485"><a href="#Disulfide-485"><span class="linenos"> 485</span></a>                <span class="n">rad</span> <span class="o">=</span> <span class="n">ATOM_RADII_COVALENT</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span>
</span><span id="Disulfide-486"><a href="#Disulfide-486"><span class="linenos"> 486</span></a>                <span class="n">pvp</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">pv</span><span class="o">.</span><span class="n">Sphere</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">radius</span><span class="o">=</span><span class="n">rad</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">ATOM_COLORS</span><span class="p">[</span><span class="n">atom</span><span class="p">],</span> 
</span><span id="Disulfide-487"><a href="#Disulfide-487"><span class="linenos"> 487</span></a>                            <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">specular</span><span class="o">=</span><span class="n">spec</span><span class="p">,</span> <span class="n">specular_power</span><span class="o">=</span><span class="n">specpow</span><span class="p">)</span>
</span><span id="Disulfide-488"><a href="#Disulfide-488"><span class="linenos"> 488</span></a>                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Disulfide-489"><a href="#Disulfide-489"><span class="linenos"> 489</span></a>
</span><span id="Disulfide-490"><a href="#Disulfide-490"><span class="linenos"> 490</span></a>        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;bs&#39;</span><span class="p">:</span> <span class="c1"># ball and stick</span>
</span><span id="Disulfide-491"><a href="#Disulfide-491"><span class="linenos"> 491</span></a>            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Disulfide-492"><a href="#Disulfide-492"><span class="linenos"> 492</span></a>            <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">:</span>
</span><span id="Disulfide-493"><a href="#Disulfide-493"><span class="linenos"> 493</span></a>                <span class="n">rad</span> <span class="o">=</span> <span class="n">ATOM_RADII_CPK</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span> <span class="o">*</span> <span class="n">bs_scale</span>
</span><span id="Disulfide-494"><a href="#Disulfide-494"><span class="linenos"> 494</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">11</span><span class="p">:</span>
</span><span id="Disulfide-495"><a href="#Disulfide-495"><span class="linenos"> 495</span></a>                    <span class="n">rad</span> <span class="o">=</span> <span class="n">rad</span> <span class="o">*</span> <span class="mf">.75</span>
</span><span id="Disulfide-496"><a href="#Disulfide-496"><span class="linenos"> 496</span></a>                
</span><span id="Disulfide-497"><a href="#Disulfide-497"><span class="linenos"> 497</span></a>                <span class="n">pvp</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">pv</span><span class="o">.</span><span class="n">Sphere</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">radius</span><span class="o">=</span><span class="n">rad</span><span class="p">),</span> 
</span><span id="Disulfide-498"><a href="#Disulfide-498"><span class="linenos"> 498</span></a>                			 <span class="n">color</span><span class="o">=</span><span class="n">ATOM_COLORS</span><span class="p">[</span><span class="n">atom</span><span class="p">],</span> <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
</span><span id="Disulfide-499"><a href="#Disulfide-499"><span class="linenos"> 499</span></a>                			 <span class="n">specular</span><span class="o">=</span><span class="n">spec</span><span class="p">,</span> <span class="n">specular_power</span><span class="o">=</span><span class="n">specpow</span><span class="p">)</span>
</span><span id="Disulfide-500"><a href="#Disulfide-500"><span class="linenos"> 500</span></a>                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Disulfide-501"><a href="#Disulfide-501"><span class="linenos"> 501</span></a>            <span class="n">pvp</span> <span class="o">=</span> <span class="n">draw_bonds</span><span class="p">(</span><span class="n">pvp</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;bs&#39;</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="n">missing_atoms</span><span class="p">,</span> 
</span><span id="Disulfide-502"><a href="#Disulfide-502"><span class="linenos"> 502</span></a>                            <span class="n">all_atoms</span><span class="o">=</span><span class="n">all_atoms</span><span class="p">)</span>
</span><span id="Disulfide-503"><a href="#Disulfide-503"><span class="linenos"> 503</span></a>
</span><span id="Disulfide-504"><a href="#Disulfide-504"><span class="linenos"> 504</span></a>        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;sb&#39;</span><span class="p">:</span> <span class="c1"># splitbonds</span>
</span><span id="Disulfide-505"><a href="#Disulfide-505"><span class="linenos"> 505</span></a>            <span class="n">pvp</span> <span class="o">=</span> <span class="n">draw_bonds</span><span class="p">(</span><span class="n">pvp</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="n">missing_atoms</span><span class="p">,</span> 
</span><span id="Disulfide-506"><a href="#Disulfide-506"><span class="linenos"> 506</span></a>                            <span class="n">all_atoms</span><span class="o">=</span><span class="n">all_atoms</span><span class="p">)</span>
</span><span id="Disulfide-507"><a href="#Disulfide-507"><span class="linenos"> 507</span></a>        
</span><span id="Disulfide-508"><a href="#Disulfide-508"><span class="linenos"> 508</span></a>        <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;pd&#39;</span><span class="p">:</span> <span class="c1"># proximal-distal</span>
</span><span id="Disulfide-509"><a href="#Disulfide-509"><span class="linenos"> 509</span></a>            <span class="n">pvp</span> <span class="o">=</span> <span class="n">draw_bonds</span><span class="p">(</span><span class="n">pvp</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;pd&#39;</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="n">missing_atoms</span><span class="p">,</span> 
</span><span id="Disulfide-510"><a href="#Disulfide-510"><span class="linenos"> 510</span></a>                            <span class="n">all_atoms</span><span class="o">=</span><span class="n">all_atoms</span><span class="p">)</span>
</span><span id="Disulfide-511"><a href="#Disulfide-511"><span class="linenos"> 511</span></a>
</span><span id="Disulfide-512"><a href="#Disulfide-512"><span class="linenos"> 512</span></a>        <span class="k">else</span><span class="p">:</span> <span class="c1"># plain</span>
</span><span id="Disulfide-513"><a href="#Disulfide-513"><span class="linenos"> 513</span></a>            <span class="n">pvp</span> <span class="o">=</span> <span class="n">draw_bonds</span><span class="p">(</span><span class="n">pvp</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;plain&#39;</span><span class="p">,</span> <span class="n">bcolor</span><span class="o">=</span><span class="n">bondcolor</span><span class="p">,</span> 
</span><span id="Disulfide-514"><a href="#Disulfide-514"><span class="linenos"> 514</span></a>                            <span class="n">missing</span><span class="o">=</span><span class="n">missing_atoms</span><span class="p">,</span> <span class="n">all_atoms</span><span class="o">=</span><span class="n">all_atoms</span><span class="p">)</span>
</span><span id="Disulfide-515"><a href="#Disulfide-515"><span class="linenos"> 515</span></a>            
</span><span id="Disulfide-516"><a href="#Disulfide-516"><span class="linenos"> 516</span></a>        <span class="k">return</span>
</span><span id="Disulfide-517"><a href="#Disulfide-517"><span class="linenos"> 517</span></a>
</span><span id="Disulfide-518"><a href="#Disulfide-518"><span class="linenos"> 518</span></a>    
</span><span id="Disulfide-519"><a href="#Disulfide-519"><span class="linenos"> 519</span></a>    <span class="k">def</span> <span class="nf">_handle_SS_exception</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Disulfide-520"><a href="#Disulfide-520"><span class="linenos"> 520</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-521"><a href="#Disulfide-521"><span class="linenos"> 521</span></a><span class="sd">        This method catches an exception that occurs in the Disulfide</span>
</span><span id="Disulfide-522"><a href="#Disulfide-522"><span class="linenos"> 522</span></a><span class="sd">        object (if PERMISSIVE), or raises it again, this time adding the</span>
</span><span id="Disulfide-523"><a href="#Disulfide-523"><span class="linenos"> 523</span></a><span class="sd">        PDB line number to the error message. (private).</span>
</span><span id="Disulfide-524"><a href="#Disulfide-524"><span class="linenos"> 524</span></a>
</span><span id="Disulfide-525"><a href="#Disulfide-525"><span class="linenos"> 525</span></a><span class="sd">        :param message: Error message</span>
</span><span id="Disulfide-526"><a href="#Disulfide-526"><span class="linenos"> 526</span></a><span class="sd">        :raises DisulfideConstructionException: Fatal construction exception.</span>
</span><span id="Disulfide-527"><a href="#Disulfide-527"><span class="linenos"> 527</span></a><span class="sd">            </span>
</span><span id="Disulfide-528"><a href="#Disulfide-528"><span class="linenos"> 528</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-529"><a href="#Disulfide-529"><span class="linenos"> 529</span></a>        <span class="c1"># message = &quot;%s at line %i.&quot; % (message)</span>
</span><span id="Disulfide-530"><a href="#Disulfide-530"><span class="linenos"> 530</span></a>        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Disulfide-531"><a href="#Disulfide-531"><span class="linenos"> 531</span></a>
</span><span id="Disulfide-532"><a href="#Disulfide-532"><span class="linenos"> 532</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">PERMISSIVE</span><span class="p">:</span>
</span><span id="Disulfide-533"><a href="#Disulfide-533"><span class="linenos"> 533</span></a>            <span class="c1"># just print a warning - some residues/atoms may be missing</span>
</span><span id="Disulfide-534"><a href="#Disulfide-534"><span class="linenos"> 534</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="Disulfide-535"><a href="#Disulfide-535"><span class="linenos"> 535</span></a>                <span class="s2">&quot;DisulfideConstructionException: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="Disulfide-536"><a href="#Disulfide-536"><span class="linenos"> 536</span></a>                <span class="s2">&quot;Exception ignored.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="Disulfide-537"><a href="#Disulfide-537"><span class="linenos"> 537</span></a>                <span class="s2">&quot;Some atoms may be missing in the data structure.&quot;</span>
</span><span id="Disulfide-538"><a href="#Disulfide-538"><span class="linenos"> 538</span></a>                <span class="o">%</span> <span class="n">message</span><span class="p">,</span>
</span><span id="Disulfide-539"><a href="#Disulfide-539"><span class="linenos"> 539</span></a>                <span class="n">DisulfideConstructionWarning</span><span class="p">,</span>
</span><span id="Disulfide-540"><a href="#Disulfide-540"><span class="linenos"> 540</span></a>            <span class="p">)</span>
</span><span id="Disulfide-541"><a href="#Disulfide-541"><span class="linenos"> 541</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Disulfide-542"><a href="#Disulfide-542"><span class="linenos"> 542</span></a>            <span class="c1"># exceptions are fatal - raise again with new message (including line nr)</span>
</span><span id="Disulfide-543"><a href="#Disulfide-543"><span class="linenos"> 543</span></a>            <span class="k">raise</span> <span class="n">DisulfideConstructionException</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>
</span><span id="Disulfide-544"><a href="#Disulfide-544"><span class="linenos"> 544</span></a>    
</span><span id="Disulfide-545"><a href="#Disulfide-545"><span class="linenos"> 545</span></a>    <span class="k">def</span> <span class="nf">bounding_box</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide-546"><a href="#Disulfide-546"><span class="linenos"> 546</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-547"><a href="#Disulfide-547"><span class="linenos"> 547</span></a><span class="sd">        Return the bounding box array for the given disulfide</span>
</span><span id="Disulfide-548"><a href="#Disulfide-548"><span class="linenos"> 548</span></a>
</span><span id="Disulfide-549"><a href="#Disulfide-549"><span class="linenos"> 549</span></a><span class="sd">        Returns</span>
</span><span id="Disulfide-550"><a href="#Disulfide-550"><span class="linenos"> 550</span></a><span class="sd">        -------</span>
</span><span id="Disulfide-551"><a href="#Disulfide-551"><span class="linenos"> 551</span></a><span class="sd">        :return: np.Array(3,2): Array containing the min, max for X, Y, and Z respectively. </span>
</span><span id="Disulfide-552"><a href="#Disulfide-552"><span class="linenos"> 552</span></a><span class="sd">        Does not currently take the atom&#39;s radius into account.</span>
</span><span id="Disulfide-553"><a href="#Disulfide-553"><span class="linenos"> 553</span></a><span class="sd">    </span>
</span><span id="Disulfide-554"><a href="#Disulfide-554"><span class="linenos"> 554</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-555"><a href="#Disulfide-555"><span class="linenos"> 555</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</span><span id="Disulfide-556"><a href="#Disulfide-556"><span class="linenos"> 556</span></a>        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_extents</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</span><span id="Disulfide-557"><a href="#Disulfide-557"><span class="linenos"> 557</span></a>        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_extents</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</span><span id="Disulfide-558"><a href="#Disulfide-558"><span class="linenos"> 558</span></a>        <span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_extents</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
</span><span id="Disulfide-559"><a href="#Disulfide-559"><span class="linenos"> 559</span></a>
</span><span id="Disulfide-560"><a href="#Disulfide-560"><span class="linenos"> 560</span></a>        <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">]</span>
</span><span id="Disulfide-561"><a href="#Disulfide-561"><span class="linenos"> 561</span></a>        <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">]</span>
</span><span id="Disulfide-562"><a href="#Disulfide-562"><span class="linenos"> 562</span></a>        <span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span><span class="p">]</span>
</span><span id="Disulfide-563"><a href="#Disulfide-563"><span class="linenos"> 563</span></a>
</span><span id="Disulfide-564"><a href="#Disulfide-564"><span class="linenos"> 564</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="Disulfide-565"><a href="#Disulfide-565"><span class="linenos"> 565</span></a>
</span><span id="Disulfide-566"><a href="#Disulfide-566"><span class="linenos"> 566</span></a>
</span><span id="Disulfide-567"><a href="#Disulfide-567"><span class="linenos"> 567</span></a>    <span class="k">def</span> <span class="nf">build_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chi1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">chi2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> 
</span><span id="Disulfide-568"><a href="#Disulfide-568"><span class="linenos"> 568</span></a>                    <span class="n">chi3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">chi4</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">chi5</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="Disulfide-569"><a href="#Disulfide-569"><span class="linenos"> 569</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-570"><a href="#Disulfide-570"><span class="linenos"> 570</span></a><span class="sd">        Build a model Disulfide based on the input dihedral angles.</span>
</span><span id="Disulfide-571"><a href="#Disulfide-571"><span class="linenos"> 571</span></a><span class="sd">        Routine assumes turtle is in orientation #1 (at Ca, headed toward</span>
</span><span id="Disulfide-572"><a href="#Disulfide-572"><span class="linenos"> 572</span></a><span class="sd">        Cb, with N on left), builds disulfide, and updates the object&#39;s internal</span>
</span><span id="Disulfide-573"><a href="#Disulfide-573"><span class="linenos"> 573</span></a><span class="sd">        coordinates. It also adds the distal protein backbone,</span>
</span><span id="Disulfide-574"><a href="#Disulfide-574"><span class="linenos"> 574</span></a><span class="sd">        and computes the disulfide conformational energy.</span>
</span><span id="Disulfide-575"><a href="#Disulfide-575"><span class="linenos"> 575</span></a>
</span><span id="Disulfide-576"><a href="#Disulfide-576"><span class="linenos"> 576</span></a><span class="sd">        :param chi1: Chi1 (degrees)</span>
</span><span id="Disulfide-577"><a href="#Disulfide-577"><span class="linenos"> 577</span></a><span class="sd">        :param chi2: Chi2 (degrees)</span>
</span><span id="Disulfide-578"><a href="#Disulfide-578"><span class="linenos"> 578</span></a><span class="sd">        :param chi3: Chi3 (degrees)</span>
</span><span id="Disulfide-579"><a href="#Disulfide-579"><span class="linenos"> 579</span></a><span class="sd">        :param chi4: Chi4 (degrees)</span>
</span><span id="Disulfide-580"><a href="#Disulfide-580"><span class="linenos"> 580</span></a><span class="sd">        :param chi5: Chi5 (degrees)</span>
</span><span id="Disulfide-581"><a href="#Disulfide-581"><span class="linenos"> 581</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-582"><a href="#Disulfide-582"><span class="linenos"> 582</span></a>
</span><span id="Disulfide-583"><a href="#Disulfide-583"><span class="linenos"> 583</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_dihedrals</span><span class="p">(</span><span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="p">,</span> <span class="n">chi3</span><span class="p">,</span> <span class="n">chi4</span><span class="p">,</span> <span class="n">chi5</span><span class="p">)</span>
</span><span id="Disulfide-584"><a href="#Disulfide-584"><span class="linenos"> 584</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Disulfide-585"><a href="#Disulfide-585"><span class="linenos"> 585</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Disulfide-586"><a href="#Disulfide-586"><span class="linenos"> 586</span></a>
</span><span id="Disulfide-587"><a href="#Disulfide-587"><span class="linenos"> 587</span></a>        <span class="n">tmp</span> <span class="o">=</span> <span class="n">Turtle3D</span><span class="p">(</span><span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
</span><span id="Disulfide-588"><a href="#Disulfide-588"><span class="linenos"> 588</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">Orientation</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Disulfide-589"><a href="#Disulfide-589"><span class="linenos"> 589</span></a>
</span><span id="Disulfide-590"><a href="#Disulfide-590"><span class="linenos"> 590</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-591"><a href="#Disulfide-591"><span class="linenos"> 591</span></a>        <span class="n">ca</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-592"><a href="#Disulfide-592"><span class="linenos"> 592</span></a>        <span class="n">cb</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-593"><a href="#Disulfide-593"><span class="linenos"> 593</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-594"><a href="#Disulfide-594"><span class="linenos"> 594</span></a>
</span><span id="Disulfide-595"><a href="#Disulfide-595"><span class="linenos"> 595</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">_position</span>
</span><span id="Disulfide-596"><a href="#Disulfide-596"><span class="linenos"> 596</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">schain_to_bbone</span><span class="p">()</span>
</span><span id="Disulfide-597"><a href="#Disulfide-597"><span class="linenos"> 597</span></a>        <span class="n">n</span><span class="p">,</span> <span class="n">ca</span><span class="p">,</span> <span class="n">cb</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">build_residue</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
</span><span id="Disulfide-598"><a href="#Disulfide-598"><span class="linenos"> 598</span></a>
</span><span id="Disulfide-599"><a href="#Disulfide-599"><span class="linenos"> 599</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_prox</span> <span class="o">=</span> <span class="n">n</span>
</span><span id="Disulfide-600"><a href="#Disulfide-600"><span class="linenos"> 600</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span> <span class="o">=</span> <span class="n">ca</span>
</span><span id="Disulfide-601"><a href="#Disulfide-601"><span class="linenos"> 601</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prox</span> <span class="o">=</span> <span class="n">c</span>
</span><span id="Disulfide-602"><a href="#Disulfide-602"><span class="linenos"> 602</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span> <span class="o">=</span> <span class="n">cb</span>
</span><span id="Disulfide-603"><a href="#Disulfide-603"><span class="linenos"> 603</span></a>
</span><span id="Disulfide-604"><a href="#Disulfide-604"><span class="linenos"> 604</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">bbone_to_schain</span><span class="p">()</span>
</span><span id="Disulfide-605"><a href="#Disulfide-605"><span class="linenos"> 605</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">1.53</span><span class="p">)</span>
</span><span id="Disulfide-606"><a href="#Disulfide-606"><span class="linenos"> 606</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi1</span><span class="p">)</span>
</span><span id="Disulfide-607"><a href="#Disulfide-607"><span class="linenos"> 607</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">yaw</span><span class="p">(</span><span class="mf">112.8</span><span class="p">)</span>
</span><span id="Disulfide-608"><a href="#Disulfide-608"><span class="linenos"> 608</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">_position</span><span class="p">)</span>
</span><span id="Disulfide-609"><a href="#Disulfide-609"><span class="linenos"> 609</span></a>
</span><span id="Disulfide-610"><a href="#Disulfide-610"><span class="linenos"> 610</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">1.86</span><span class="p">)</span>
</span><span id="Disulfide-611"><a href="#Disulfide-611"><span class="linenos"> 611</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi2</span><span class="p">)</span>
</span><span id="Disulfide-612"><a href="#Disulfide-612"><span class="linenos"> 612</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">yaw</span><span class="p">(</span><span class="mf">103.8</span><span class="p">)</span>
</span><span id="Disulfide-613"><a href="#Disulfide-613"><span class="linenos"> 613</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">_position</span><span class="p">)</span>
</span><span id="Disulfide-614"><a href="#Disulfide-614"><span class="linenos"> 614</span></a>
</span><span id="Disulfide-615"><a href="#Disulfide-615"><span class="linenos"> 615</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">2.044</span><span class="p">)</span>
</span><span id="Disulfide-616"><a href="#Disulfide-616"><span class="linenos"> 616</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi3</span><span class="p">)</span>
</span><span id="Disulfide-617"><a href="#Disulfide-617"><span class="linenos"> 617</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">yaw</span><span class="p">(</span><span class="mf">103.8</span><span class="p">)</span>
</span><span id="Disulfide-618"><a href="#Disulfide-618"><span class="linenos"> 618</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">_position</span><span class="p">)</span>
</span><span id="Disulfide-619"><a href="#Disulfide-619"><span class="linenos"> 619</span></a>
</span><span id="Disulfide-620"><a href="#Disulfide-620"><span class="linenos"> 620</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">1.86</span><span class="p">)</span>
</span><span id="Disulfide-621"><a href="#Disulfide-621"><span class="linenos"> 621</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi4</span><span class="p">)</span>
</span><span id="Disulfide-622"><a href="#Disulfide-622"><span class="linenos"> 622</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">yaw</span><span class="p">(</span><span class="mf">112.8</span><span class="p">)</span>
</span><span id="Disulfide-623"><a href="#Disulfide-623"><span class="linenos"> 623</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">_position</span><span class="p">)</span>
</span><span id="Disulfide-624"><a href="#Disulfide-624"><span class="linenos"> 624</span></a>
</span><span id="Disulfide-625"><a href="#Disulfide-625"><span class="linenos"> 625</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">1.53</span><span class="p">)</span>
</span><span id="Disulfide-626"><a href="#Disulfide-626"><span class="linenos"> 626</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi5</span><span class="p">)</span>
</span><span id="Disulfide-627"><a href="#Disulfide-627"><span class="linenos"> 627</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">pitch</span><span class="p">(</span><span class="mf">180.0</span><span class="p">)</span>
</span><span id="Disulfide-628"><a href="#Disulfide-628"><span class="linenos"> 628</span></a>
</span><span id="Disulfide-629"><a href="#Disulfide-629"><span class="linenos"> 629</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">schain_to_bbone</span><span class="p">()</span>
</span><span id="Disulfide-630"><a href="#Disulfide-630"><span class="linenos"> 630</span></a>
</span><span id="Disulfide-631"><a href="#Disulfide-631"><span class="linenos"> 631</span></a>        <span class="n">n</span><span class="p">,</span> <span class="n">ca</span><span class="p">,</span> <span class="n">cb</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">build_residue</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
</span><span id="Disulfide-632"><a href="#Disulfide-632"><span class="linenos"> 632</span></a>
</span><span id="Disulfide-633"><a href="#Disulfide-633"><span class="linenos"> 633</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_dist</span> <span class="o">=</span> <span class="n">n</span>
</span><span id="Disulfide-634"><a href="#Disulfide-634"><span class="linenos"> 634</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span> <span class="o">=</span> <span class="n">ca</span>
</span><span id="Disulfide-635"><a href="#Disulfide-635"><span class="linenos"> 635</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_dist</span> <span class="o">=</span> <span class="n">c</span>
</span><span id="Disulfide-636"><a href="#Disulfide-636"><span class="linenos"> 636</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">compute_torsional_energy</span><span class="p">()</span>
</span><span id="Disulfide-637"><a href="#Disulfide-637"><span class="linenos"> 637</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">compute_local_coords</span><span class="p">()</span>
</span><span id="Disulfide-638"><a href="#Disulfide-638"><span class="linenos"> 638</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span> <span class="o">=</span> <span class="n">distance3d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span><span class="p">)</span>
</span><span id="Disulfide-639"><a href="#Disulfide-639"><span class="linenos"> 639</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_distance</span> <span class="o">=</span> <span class="n">distance3d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cb_dist</span><span class="p">)</span>
</span><span id="Disulfide-640"><a href="#Disulfide-640"><span class="linenos"> 640</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">chi1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span><span class="p">,</span> 
</span><span id="Disulfide-641"><a href="#Disulfide-641"><span class="linenos"> 641</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">chi4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi5</span><span class="p">))</span>
</span><span id="Disulfide-642"><a href="#Disulfide-642"><span class="linenos"> 642</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Torsion_Length</span><span class="p">()</span>
</span><span id="Disulfide-643"><a href="#Disulfide-643"><span class="linenos"> 643</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">compute_rho</span><span class="p">()</span>
</span><span id="Disulfide-644"><a href="#Disulfide-644"><span class="linenos"> 644</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">missing_atoms</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Disulfide-645"><a href="#Disulfide-645"><span class="linenos"> 645</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modelled</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Disulfide-646"><a href="#Disulfide-646"><span class="linenos"> 646</span></a>    
</span><span id="Disulfide-647"><a href="#Disulfide-647"><span class="linenos"> 647</span></a>    <span class="k">def</span> <span class="nf">cofmass</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
</span><span id="Disulfide-648"><a href="#Disulfide-648"><span class="linenos"> 648</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-649"><a href="#Disulfide-649"><span class="linenos"> 649</span></a><span class="sd">        Returns the geometric center of mass for the internal coordinates of</span>
</span><span id="Disulfide-650"><a href="#Disulfide-650"><span class="linenos"> 650</span></a><span class="sd">        the given Disulfide. Missing atoms are not included.</span>
</span><span id="Disulfide-651"><a href="#Disulfide-651"><span class="linenos"> 651</span></a>
</span><span id="Disulfide-652"><a href="#Disulfide-652"><span class="linenos"> 652</span></a><span class="sd">        :return: 3D array for the geometric center of mass</span>
</span><span id="Disulfide-653"><a href="#Disulfide-653"><span class="linenos"> 653</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-654"><a href="#Disulfide-654"><span class="linenos"> 654</span></a>
</span><span id="Disulfide-655"><a href="#Disulfide-655"><span class="linenos"> 655</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_coords</span><span class="p">()</span>
</span><span id="Disulfide-656"><a href="#Disulfide-656"><span class="linenos"> 656</span></a>        <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-657"><a href="#Disulfide-657"><span class="linenos"> 657</span></a>    
</span><span id="Disulfide-658"><a href="#Disulfide-658"><span class="linenos"> 658</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide-659"><a href="#Disulfide-659"><span class="linenos"> 659</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-660"><a href="#Disulfide-660"><span class="linenos"> 660</span></a><span class="sd">        Copy the Disulfide.</span>
</span><span id="Disulfide-661"><a href="#Disulfide-661"><span class="linenos"> 661</span></a>
</span><span id="Disulfide-662"><a href="#Disulfide-662"><span class="linenos"> 662</span></a><span class="sd">        :return: A copy of self.  </span>
</span><span id="Disulfide-663"><a href="#Disulfide-663"><span class="linenos"> 663</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-664"><a href="#Disulfide-664"><span class="linenos"> 664</span></a>        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Disulfide-665"><a href="#Disulfide-665"><span class="linenos"> 665</span></a>    
</span><span id="Disulfide-666"><a href="#Disulfide-666"><span class="linenos"> 666</span></a>    <span class="k">def</span> <span class="nf">compute_extents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">):</span>
</span><span id="Disulfide-667"><a href="#Disulfide-667"><span class="linenos"> 667</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-668"><a href="#Disulfide-668"><span class="linenos"> 668</span></a><span class="sd">        Calculate the internal coordinate extents for the input axis.</span>
</span><span id="Disulfide-669"><a href="#Disulfide-669"><span class="linenos"> 669</span></a><span class="sd">        </span>
</span><span id="Disulfide-670"><a href="#Disulfide-670"><span class="linenos"> 670</span></a><span class="sd">        :param dim: Axis, one of &#39;x&#39;, &#39;y&#39;, &#39;z&#39;, by default &#39;z&#39;</span>
</span><span id="Disulfide-671"><a href="#Disulfide-671"><span class="linenos"> 671</span></a><span class="sd">        :return: min, max</span>
</span><span id="Disulfide-672"><a href="#Disulfide-672"><span class="linenos"> 672</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-673"><a href="#Disulfide-673"><span class="linenos"> 673</span></a>
</span><span id="Disulfide-674"><a href="#Disulfide-674"><span class="linenos"> 674</span></a>        <span class="n">ic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_coords</span><span class="p">()</span>
</span><span id="Disulfide-675"><a href="#Disulfide-675"><span class="linenos"> 675</span></a>        <span class="c1"># set default index to &#39;z&#39;</span>
</span><span id="Disulfide-676"><a href="#Disulfide-676"><span class="linenos"> 676</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Disulfide-677"><a href="#Disulfide-677"><span class="linenos"> 677</span></a>
</span><span id="Disulfide-678"><a href="#Disulfide-678"><span class="linenos"> 678</span></a>        <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
</span><span id="Disulfide-679"><a href="#Disulfide-679"><span class="linenos"> 679</span></a>            <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Disulfide-680"><a href="#Disulfide-680"><span class="linenos"> 680</span></a>        <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
</span><span id="Disulfide-681"><a href="#Disulfide-681"><span class="linenos"> 681</span></a>            <span class="n">idx</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Disulfide-682"><a href="#Disulfide-682"><span class="linenos"> 682</span></a>        <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span>
</span><span id="Disulfide-683"><a href="#Disulfide-683"><span class="linenos"> 683</span></a>            <span class="n">idx</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Disulfide-684"><a href="#Disulfide-684"><span class="linenos"> 684</span></a>        
</span><span id="Disulfide-685"><a href="#Disulfide-685"><span class="linenos"> 685</span></a>        <span class="n">_min</span> <span class="o">=</span> <span class="n">ic</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="Disulfide-686"><a href="#Disulfide-686"><span class="linenos"> 686</span></a>        <span class="n">_max</span> <span class="o">=</span> <span class="n">ic</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="Disulfide-687"><a href="#Disulfide-687"><span class="linenos"> 687</span></a>        <span class="k">return</span> <span class="n">_min</span><span class="p">,</span> <span class="n">_max</span>
</span><span id="Disulfide-688"><a href="#Disulfide-688"><span class="linenos"> 688</span></a>
</span><span id="Disulfide-689"><a href="#Disulfide-689"><span class="linenos"> 689</span></a>    <span class="k">def</span> <span class="nf">compute_local_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide-690"><a href="#Disulfide-690"><span class="linenos"> 690</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide-691"><a href="#Disulfide-691"><span class="linenos"> 691</span></a><span class="sd">        Compute the internal coordinates for a properly initialized Disulfide Object.</span>
</span><span id="Disulfide-692"><a href="#Disulfide-692"><span class="linenos"> 692</span></a><span class="sd">        </span>
</span><span id="Disulfide-693"><a href="#Disulfide-693"><span class="linenos"> 693</span></a><span class="sd">        :param self: SS initialized Disulfide object</span>
</span><span id="Disulfide-694"><a href="#Disulfide-694"><span class="linenos"> 694</span></a><span class="sd">        :returns: None, modifies internal state of the input</span>
</span><span id="Disulfide-695"><a href="#Disulfide-695"><span class="linenos"> 695</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide-696"><a href="#Disulfide-696"><span class="linenos"> 696</span></a>
</span><span id="Disulfide-697"><a href="#Disulfide-697"><span class="linenos"> 697</span></a>        <span class="n">turt</span> <span class="o">=</span> <span class="n">Turtle3D</span><span class="p">(</span><span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
</span><span id="Disulfide-698"><a href="#Disulfide-698"><span class="linenos"> 698</span></a>        <span class="c1"># get the coordinates as np.array for Turtle3D use.</span>
</span><span id="Disulfide-699"><a href="#Disulfide-699"><span class="linenos"> 699</span></a>        <span class="n">cpp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_prev_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide-700"><a href="#Disulfide-700"><span class="linenos"> 700</span></a>        <span class="n">nnp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_next_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide-701"><a href="#Disulfide-701"><span class="linenos"> 701</span></a>
</span><span id="Disulfide-702"><a href="#Disulfide-702"><span class="linenos"> 702</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide-703"><a href="#Disulfide-703"><span class="linenos"> 703</span></a>        <span class="n">ca</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide-704"><a href="#Disulfide-704"><span class="linenos"> 704</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide-705"><a href="#Disulfide-705"><span class="linenos"> 705</span></a>        <span class="n">cb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide-706"><a href="#Disulfide-706"><span class="linenos"> 706</span></a>        <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">o_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide-707"><a href="#Disulfide-707"><span class="linenos"> 707</span></a>        <span class="n">sg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sg_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide-708"><a href="#Disulfide-708"><span class="linenos"> 708</span></a>
</span><span id="Disulfide-709"><a href="#Disulfide-709"><span class="linenos"> 709</span></a>        <span class="n">sg2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sg_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide-710"><a href="#Disulfide-710"><span class="linenos"> 710</span></a>        <span class="n">cb2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cb_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide-711"><a href="#Disulfide-711"><span class="linenos"> 711</span></a>        <span class="n">ca2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide-712"><a href="#Disulfide-712"><span class="linenos"> 712</span></a>        <span class="n">c2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide-713"><a href="#Disulfide-713"><span class="linenos"> 713</span></a>        <span class="n">n2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide-714"><a href="#Disulfide-714"><span class="linenos"> 714</span></a>        <span class="n">o2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">o_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide-715"><a href="#Disulfide-715"><span class="linenos"> 715</span></a>
</span><span id="Disulfide-716"><a href="#Disulfide-716"><span class="linenos"> 716</span></a>        <span class="n">cpd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_prev_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide-717"><a href="#Disulfide-717"><span class="linenos"> 717</span></a>        <span class="n">nnd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_next_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide-718"><a href="#Disulfide-718"><span class="linenos"> 718</span></a>        
</span><span id="Disulfide-719"><a href="#Disulfide-719"><span class="linenos"> 719</span></a>        <span class="n">turt</span><span class="o">.</span><span class="n">orient_from_backbone</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">ca</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">cb</span><span class="p">,</span> <span class="n">ORIENT_SIDECHAIN</span><span class="p">)</span>
</span><span id="Disulfide-720"><a href="#Disulfide-720"><span class="linenos"> 720</span></a>        
</span><span id="Disulfide-721"><a href="#Disulfide-721"><span class="linenos"> 721</span></a>        <span class="c1"># internal (local) coordinates, stored as Vector objects</span>
</span><span id="Disulfide-722"><a href="#Disulfide-722"><span class="linenos"> 722</span></a>        <span class="c1"># to_local returns np.array objects</span>
</span><span id="Disulfide-723"><a href="#Disulfide-723"><span class="linenos"> 723</span></a>        
</span><span id="Disulfide-724"><a href="#Disulfide-724"><span class="linenos"> 724</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span><span id="Disulfide-725"><a href="#Disulfide-725"><span class="linenos"> 725</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ca_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">ca</span><span class="p">))</span>
</span><span id="Disulfide-726"><a href="#Disulfide-726"><span class="linenos"> 726</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
</span><span id="Disulfide-727"><a href="#Disulfide-727"><span class="linenos"> 727</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_o_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">o</span><span class="p">))</span>
</span><span id="Disulfide-728"><a href="#Disulfide-728"><span class="linenos"> 728</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cb_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">cb</span><span class="p">))</span>
</span><span id="Disulfide-729"><a href="#Disulfide-729"><span class="linenos"> 729</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sg_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">sg</span><span class="p">))</span>
</span><span id="Disulfide-730"><a href="#Disulfide-730"><span class="linenos"> 730</span></a>
</span><span id="Disulfide-731"><a href="#Disulfide-731"><span class="linenos"> 731</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_prev_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">cpp</span><span class="p">))</span>
</span><span id="Disulfide-732"><a href="#Disulfide-732"><span class="linenos"> 732</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_next_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">nnp</span><span class="p">))</span>
</span><span id="Disulfide-733"><a href="#Disulfide-733"><span class="linenos"> 733</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_prev_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">cpd</span><span class="p">))</span>
</span><span id="Disulfide-734"><a href="#Disulfide-734"><span class="linenos"> 734</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_next_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">nnd</span><span class="p">))</span>
</span><span id="Disulfide-735"><a href="#Disulfide-735"><span class="linenos"> 735</span></a>
</span><span id="Disulfide-736"><a href="#Disulfide-736"><span class="linenos"> 736</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">n2</span><span class="p">))</span>
</span><span id="Disulfide-737"><a href="#Disulfide-737"><span class="linenos"> 737</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ca_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">ca2</span><span class="p">))</span>
</span><span id="Disulfide-738"><a href="#Disulfide-738"><span class="linenos"> 738</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">c2</span><span class="p">))</span>
</span><span id="Disulfide-739"><a href="#Disulfide-739"><span class="linenos"> 739</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_o_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">o2</span><span class="p">))</span>
</span><span id="Disulfide-740"><a href="#Disulfide-740"><span class="linenos"> 740</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cb_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">cb2</span><span class="p">))</span>
</span><span id="Disulfide-741"><a href="#Disulfide-741"><span class="linenos"> 741</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sg_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">sg2</span><span class="p">))</span>
</span><span id="Disulfide-742"><a href="#Disulfide-742"><span class="linenos"> 742</span></a>
</span><span id="Disulfide-743"><a href="#Disulfide-743"><span class="linenos"> 743</span></a>    <span class="k">def</span> <span class="nf">compute_torsional_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Disulfide-744"><a href="#Disulfide-744"><span class="linenos"> 744</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-745"><a href="#Disulfide-745"><span class="linenos"> 745</span></a><span class="sd">        Compute the approximate torsional energy for the Disulfide&#39;s</span>
</span><span id="Disulfide-746"><a href="#Disulfide-746"><span class="linenos"> 746</span></a><span class="sd">        conformation and sets its internal state.</span>
</span><span id="Disulfide-747"><a href="#Disulfide-747"><span class="linenos"> 747</span></a><span class="sd">        </span>
</span><span id="Disulfide-748"><a href="#Disulfide-748"><span class="linenos"> 748</span></a><span class="sd">        :return: Energy (kcal/mol)</span>
</span><span id="Disulfide-749"><a href="#Disulfide-749"><span class="linenos"> 749</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-750"><a href="#Disulfide-750"><span class="linenos"> 750</span></a>        <span class="c1"># @TODO find citation for the ss bond energy calculation</span>
</span><span id="Disulfide-751"><a href="#Disulfide-751"><span class="linenos"> 751</span></a>
</span><span id="Disulfide-752"><a href="#Disulfide-752"><span class="linenos"> 752</span></a>        <span class="k">def</span> <span class="nf">torad</span><span class="p">(</span><span class="n">deg</span><span class="p">):</span>
</span><span id="Disulfide-753"><a href="#Disulfide-753"><span class="linenos"> 753</span></a>            <span class="k">return</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">deg</span><span class="p">))</span>
</span><span id="Disulfide-754"><a href="#Disulfide-754"><span class="linenos"> 754</span></a>
</span><span id="Disulfide-755"><a href="#Disulfide-755"><span class="linenos"> 755</span></a>        <span class="n">chi1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi1</span>
</span><span id="Disulfide-756"><a href="#Disulfide-756"><span class="linenos"> 756</span></a>        <span class="n">chi2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi2</span>
</span><span id="Disulfide-757"><a href="#Disulfide-757"><span class="linenos"> 757</span></a>        <span class="n">chi3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span>
</span><span id="Disulfide-758"><a href="#Disulfide-758"><span class="linenos"> 758</span></a>        <span class="n">chi4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi4</span>
</span><span id="Disulfide-759"><a href="#Disulfide-759"><span class="linenos"> 759</span></a>        <span class="n">chi5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi5</span>
</span><span id="Disulfide-760"><a href="#Disulfide-760"><span class="linenos"> 760</span></a>
</span><span id="Disulfide-761"><a href="#Disulfide-761"><span class="linenos"> 761</span></a>        <span class="n">energy</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">torad</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">chi1</span><span class="p">))</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">torad</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">chi5</span><span class="p">)))</span>
</span><span id="Disulfide-762"><a href="#Disulfide-762"><span class="linenos"> 762</span></a>        <span class="n">energy</span> <span class="o">+=</span> <span class="n">cos</span><span class="p">(</span><span class="n">torad</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">chi2</span><span class="p">))</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">torad</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">chi4</span><span class="p">))</span>
</span><span id="Disulfide-763"><a href="#Disulfide-763"><span class="linenos"> 763</span></a>        <span class="n">energy</span> <span class="o">+=</span> <span class="mf">3.5</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">torad</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">chi3</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">torad</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">chi3</span><span class="p">))</span> <span class="o">+</span> <span class="mf">10.1</span>
</span><span id="Disulfide-764"><a href="#Disulfide-764"><span class="linenos"> 764</span></a>
</span><span id="Disulfide-765"><a href="#Disulfide-765"><span class="linenos"> 765</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span>
</span><span id="Disulfide-766"><a href="#Disulfide-766"><span class="linenos"> 766</span></a>        <span class="k">return</span> <span class="n">energy</span>
</span><span id="Disulfide-767"><a href="#Disulfide-767"><span class="linenos"> 767</span></a>    
</span><span id="Disulfide-768"><a href="#Disulfide-768"><span class="linenos"> 768</span></a>
</span><span id="Disulfide-769"><a href="#Disulfide-769"><span class="linenos"> 769</span></a>    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span> <span class="n">light</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shadows</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Disulfide-770"><a href="#Disulfide-770"><span class="linenos"> 770</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-771"><a href="#Disulfide-771"><span class="linenos"> 771</span></a><span class="sd">        Display the Disulfide bond in the specific rendering style.</span>
</span><span id="Disulfide-772"><a href="#Disulfide-772"><span class="linenos"> 772</span></a>
</span><span id="Disulfide-773"><a href="#Disulfide-773"><span class="linenos"> 773</span></a><span class="sd">        :param single: Display the bond in a single panel in the specific style. </span>
</span><span id="Disulfide-774"><a href="#Disulfide-774"><span class="linenos"> 774</span></a><span class="sd">        :param style:  Rendering style: One of:</span>
</span><span id="Disulfide-775"><a href="#Disulfide-775"><span class="linenos"> 775</span></a><span class="sd">            * &#39;sb&#39; - split bonds</span>
</span><span id="Disulfide-776"><a href="#Disulfide-776"><span class="linenos"> 776</span></a><span class="sd">            * &#39;bs&#39; - ball and stick</span>
</span><span id="Disulfide-777"><a href="#Disulfide-777"><span class="linenos"> 777</span></a><span class="sd">            * &#39;cpk&#39; - CPK style</span>
</span><span id="Disulfide-778"><a href="#Disulfide-778"><span class="linenos"> 778</span></a><span class="sd">            * &#39;pd&#39; - Proximal/Distal style - Red=proximal, Green=Distal</span>
</span><span id="Disulfide-779"><a href="#Disulfide-779"><span class="linenos"> 779</span></a><span class="sd">            * &#39;plain&#39; - boring single color</span>
</span><span id="Disulfide-780"><a href="#Disulfide-780"><span class="linenos"> 780</span></a><span class="sd">        :param light: If True, light background, if False, dark</span>
</span><span id="Disulfide-781"><a href="#Disulfide-781"><span class="linenos"> 781</span></a>
</span><span id="Disulfide-782"><a href="#Disulfide-782"><span class="linenos"> 782</span></a><span class="sd">        Example:</span>
</span><span id="Disulfide-783"><a href="#Disulfide-783"><span class="linenos"> 783</span></a><span class="sd">        &gt;&gt;&gt; import proteusPy</span>
</span><span id="Disulfide-784"><a href="#Disulfide-784"><span class="linenos"> 784</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.Disulfide import Disulfide</span>
</span><span id="Disulfide-785"><a href="#Disulfide-785"><span class="linenos"> 785</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideLoader import DisulfideLoader</span>
</span><span id="Disulfide-786"><a href="#Disulfide-786"><span class="linenos"> 786</span></a>
</span><span id="Disulfide-787"><a href="#Disulfide-787"><span class="linenos"> 787</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = DisulfideLoader(verbose=False, subset=True)</span>
</span><span id="Disulfide-788"><a href="#Disulfide-788"><span class="linenos"> 788</span></a><span class="sd">        &gt;&gt;&gt; ss = PDB_SS[0]</span>
</span><span id="Disulfide-789"><a href="#Disulfide-789"><span class="linenos"> 789</span></a><span class="sd">        &gt;&gt;&gt; ss.display(style=&#39;cpk&#39;)</span>
</span><span id="Disulfide-790"><a href="#Disulfide-790"><span class="linenos"> 790</span></a><span class="sd">        &gt;&gt;&gt; ss.screenshot(style=&#39;bs&#39;, fname=&#39;proteus_logo_sb.png&#39;)</span>
</span><span id="Disulfide-791"><a href="#Disulfide-791"><span class="linenos"> 791</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-792"><a href="#Disulfide-792"><span class="linenos"> 792</span></a>        <span class="n">src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="Disulfide-793"><a href="#Disulfide-793"><span class="linenos"> 793</span></a>        <span class="n">enrg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span>
</span><span id="Disulfide-794"><a href="#Disulfide-794"><span class="linenos"> 794</span></a>
</span><span id="Disulfide-795"><a href="#Disulfide-795"><span class="linenos"> 795</span></a>        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">src</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal_chain</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal_chain</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">enrg</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol. Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å Cβ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å Tors: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">°&#39;</span>
</span><span id="Disulfide-796"><a href="#Disulfide-796"><span class="linenos"> 796</span></a>
</span><span id="Disulfide-797"><a href="#Disulfide-797"><span class="linenos"> 797</span></a>        <span class="k">if</span> <span class="n">light</span><span class="p">:</span>
</span><span id="Disulfide-798"><a href="#Disulfide-798"><span class="linenos"> 798</span></a>            <span class="n">pv</span><span class="o">.</span><span class="n">set_plot_theme</span><span class="p">(</span><span class="s1">&#39;document&#39;</span><span class="p">)</span>
</span><span id="Disulfide-799"><a href="#Disulfide-799"><span class="linenos"> 799</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Disulfide-800"><a href="#Disulfide-800"><span class="linenos"> 800</span></a>            <span class="n">pv</span><span class="o">.</span><span class="n">set_plot_theme</span><span class="p">(</span><span class="s1">&#39;dark&#39;</span><span class="p">)</span>
</span><span id="Disulfide-801"><a href="#Disulfide-801"><span class="linenos"> 801</span></a>        
</span><span id="Disulfide-802"><a href="#Disulfide-802"><span class="linenos"> 802</span></a>        <span class="k">if</span> <span class="n">single</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Disulfide-803"><a href="#Disulfide-803"><span class="linenos"> 803</span></a>            <span class="n">_pl</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="n">WINSIZE</span><span class="p">)</span>
</span><span id="Disulfide-804"><a href="#Disulfide-804"><span class="linenos"> 804</span></a>            <span class="n">_pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide-805"><a href="#Disulfide-805"><span class="linenos"> 805</span></a>            <span class="n">_pl</span><span class="o">.</span><span class="n">enable_anti_aliasing</span><span class="p">(</span><span class="s1">&#39;msaa&#39;</span><span class="p">)</span>
</span><span id="Disulfide-806"><a href="#Disulfide-806"><span class="linenos"> 806</span></a>            <span class="n">_pl</span><span class="o">.</span><span class="n">add_camera_orientation_widget</span><span class="p">()</span>            
</span><span id="Disulfide-807"><a href="#Disulfide-807"><span class="linenos"> 807</span></a>
</span><span id="Disulfide-808"><a href="#Disulfide-808"><span class="linenos"> 808</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">_pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> 
</span><span id="Disulfide-809"><a href="#Disulfide-809"><span class="linenos"> 809</span></a>                        <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>        
</span><span id="Disulfide-810"><a href="#Disulfide-810"><span class="linenos"> 810</span></a>            <span class="n">_pl</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="Disulfide-811"><a href="#Disulfide-811"><span class="linenos"> 811</span></a>            <span class="k">if</span> <span class="n">shadows</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Disulfide-812"><a href="#Disulfide-812"><span class="linenos"> 812</span></a>                <span class="n">_pl</span><span class="o">.</span><span class="n">enable_shadows</span><span class="p">()</span>
</span><span id="Disulfide-813"><a href="#Disulfide-813"><span class="linenos"> 813</span></a>            <span class="n">_pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="Disulfide-814"><a href="#Disulfide-814"><span class="linenos"> 814</span></a>
</span><span id="Disulfide-815"><a href="#Disulfide-815"><span class="linenos"> 815</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Disulfide-816"><a href="#Disulfide-816"><span class="linenos"> 816</span></a>            <span class="n">pl</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="n">WINSIZE</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</span><span id="Disulfide-817"><a href="#Disulfide-817"><span class="linenos"> 817</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-818"><a href="#Disulfide-818"><span class="linenos"> 818</span></a>            
</span><span id="Disulfide-819"><a href="#Disulfide-819"><span class="linenos"> 819</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide-820"><a href="#Disulfide-820"><span class="linenos"> 820</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">enable_anti_aliasing</span><span class="p">(</span><span class="s1">&#39;msaa&#39;</span><span class="p">)</span>
</span><span id="Disulfide-821"><a href="#Disulfide-821"><span class="linenos"> 821</span></a>
</span><span id="Disulfide-822"><a href="#Disulfide-822"><span class="linenos"> 822</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_camera_orientation_widget</span><span class="p">()</span>
</span><span id="Disulfide-823"><a href="#Disulfide-823"><span class="linenos"> 823</span></a>            
</span><span id="Disulfide-824"><a href="#Disulfide-824"><span class="linenos"> 824</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;cpk&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="Disulfide-825"><a href="#Disulfide-825"><span class="linenos"> 825</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="Disulfide-826"><a href="#Disulfide-826"><span class="linenos"> 826</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="Disulfide-827"><a href="#Disulfide-827"><span class="linenos"> 827</span></a>
</span><span id="Disulfide-828"><a href="#Disulfide-828"><span class="linenos"> 828</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Disulfide-829"><a href="#Disulfide-829"><span class="linenos"> 829</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide-830"><a href="#Disulfide-830"><span class="linenos"> 830</span></a>            
</span><span id="Disulfide-831"><a href="#Disulfide-831"><span class="linenos"> 831</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;bs&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="Disulfide-832"><a href="#Disulfide-832"><span class="linenos"> 832</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="Disulfide-833"><a href="#Disulfide-833"><span class="linenos"> 833</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="Disulfide-834"><a href="#Disulfide-834"><span class="linenos"> 834</span></a>
</span><span id="Disulfide-835"><a href="#Disulfide-835"><span class="linenos"> 835</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-836"><a href="#Disulfide-836"><span class="linenos"> 836</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide-837"><a href="#Disulfide-837"><span class="linenos"> 837</span></a>            
</span><span id="Disulfide-838"><a href="#Disulfide-838"><span class="linenos"> 838</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="Disulfide-839"><a href="#Disulfide-839"><span class="linenos"> 839</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="Disulfide-840"><a href="#Disulfide-840"><span class="linenos"> 840</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="Disulfide-841"><a href="#Disulfide-841"><span class="linenos"> 841</span></a>
</span><span id="Disulfide-842"><a href="#Disulfide-842"><span class="linenos"> 842</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Disulfide-843"><a href="#Disulfide-843"><span class="linenos"> 843</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide-844"><a href="#Disulfide-844"><span class="linenos"> 844</span></a>            
</span><span id="Disulfide-845"><a href="#Disulfide-845"><span class="linenos"> 845</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;pd&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="Disulfide-846"><a href="#Disulfide-846"><span class="linenos"> 846</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="Disulfide-847"><a href="#Disulfide-847"><span class="linenos"> 847</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="Disulfide-848"><a href="#Disulfide-848"><span class="linenos"> 848</span></a>
</span><span id="Disulfide-849"><a href="#Disulfide-849"><span class="linenos"> 849</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">link_views</span><span class="p">()</span>
</span><span id="Disulfide-850"><a href="#Disulfide-850"><span class="linenos"> 850</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="Disulfide-851"><a href="#Disulfide-851"><span class="linenos"> 851</span></a>            <span class="k">if</span> <span class="n">shadows</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Disulfide-852"><a href="#Disulfide-852"><span class="linenos"> 852</span></a>                <span class="n">pl</span><span class="o">.</span><span class="n">enable_shadows</span><span class="p">()</span>
</span><span id="Disulfide-853"><a href="#Disulfide-853"><span class="linenos"> 853</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="Disulfide-854"><a href="#Disulfide-854"><span class="linenos"> 854</span></a>        <span class="k">return</span>
</span><span id="Disulfide-855"><a href="#Disulfide-855"><span class="linenos"> 855</span></a>    
</span><span id="Disulfide-856"><a href="#Disulfide-856"><span class="linenos"> 856</span></a>    <span class="k">def</span> <span class="nf">Distance_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">others</span><span class="p">:</span> <span class="n">DisulfideList</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="Disulfide-857"><a href="#Disulfide-857"><span class="linenos"> 857</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-858"><a href="#Disulfide-858"><span class="linenos"> 858</span></a><span class="sd">        Returns list of Disulfides whose RMS atomic distance is within </span>
</span><span id="Disulfide-859"><a href="#Disulfide-859"><span class="linenos"> 859</span></a><span class="sd">        the cutoff (Å) in the others list.</span>
</span><span id="Disulfide-860"><a href="#Disulfide-860"><span class="linenos"> 860</span></a>
</span><span id="Disulfide-861"><a href="#Disulfide-861"><span class="linenos"> 861</span></a><span class="sd">        :param others: DisulfideList to search</span>
</span><span id="Disulfide-862"><a href="#Disulfide-862"><span class="linenos"> 862</span></a><span class="sd">        :param cutoff: Distance cutoff (Å)</span>
</span><span id="Disulfide-863"><a href="#Disulfide-863"><span class="linenos"> 863</span></a><span class="sd">        :return: DisulfideList within the cutoff</span>
</span><span id="Disulfide-864"><a href="#Disulfide-864"><span class="linenos"> 864</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-865"><a href="#Disulfide-865"><span class="linenos"> 865</span></a>
</span><span id="Disulfide-866"><a href="#Disulfide-866"><span class="linenos"> 866</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">ss</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">others</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Distance_RMS</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">cutoff</span><span class="p">]</span>
</span><span id="Disulfide-867"><a href="#Disulfide-867"><span class="linenos"> 867</span></a>        <span class="k">return</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s1">&#39;neighbors&#39;</span><span class="p">)</span>
</span><span id="Disulfide-868"><a href="#Disulfide-868"><span class="linenos"> 868</span></a>
</span><span id="Disulfide-869"><a href="#Disulfide-869"><span class="linenos"> 869</span></a>    
</span><span id="Disulfide-870"><a href="#Disulfide-870"><span class="linenos"> 870</span></a>    <span class="k">def</span> <span class="nf">Distance_RMS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Disulfide-871"><a href="#Disulfide-871"><span class="linenos"> 871</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-872"><a href="#Disulfide-872"><span class="linenos"> 872</span></a><span class="sd">        Calculate the RMS distance between the internal coordinates of self and another Disulfide.</span>
</span><span id="Disulfide-873"><a href="#Disulfide-873"><span class="linenos"> 873</span></a><span class="sd">        :param other: Comparison Disulfide</span>
</span><span id="Disulfide-874"><a href="#Disulfide-874"><span class="linenos"> 874</span></a><span class="sd">        :return: RMS distance (Å)</span>
</span><span id="Disulfide-875"><a href="#Disulfide-875"><span class="linenos"> 875</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-876"><a href="#Disulfide-876"><span class="linenos"> 876</span></a>
</span><span id="Disulfide-877"><a href="#Disulfide-877"><span class="linenos"> 877</span></a>        <span class="c1"># Get internal coordinates of both objects</span>
</span><span id="Disulfide-878"><a href="#Disulfide-878"><span class="linenos"> 878</span></a>        <span class="n">ic1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_coords</span><span class="p">()</span>
</span><span id="Disulfide-879"><a href="#Disulfide-879"><span class="linenos"> 879</span></a>        <span class="n">ic2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">internal_coords</span><span class="p">()</span>
</span><span id="Disulfide-880"><a href="#Disulfide-880"><span class="linenos"> 880</span></a>
</span><span id="Disulfide-881"><a href="#Disulfide-881"><span class="linenos"> 881</span></a>        <span class="c1"># Compute the sum of squared distances between corresponding internal coordinates</span>
</span><span id="Disulfide-882"><a href="#Disulfide-882"><span class="linenos"> 882</span></a>        <span class="n">totsq</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ic1</span><span class="p">,</span> <span class="n">ic2</span><span class="p">))</span>
</span><span id="Disulfide-883"><a href="#Disulfide-883"><span class="linenos"> 883</span></a>
</span><span id="Disulfide-884"><a href="#Disulfide-884"><span class="linenos"> 884</span></a>        <span class="c1"># Compute the mean of the squared distances</span>
</span><span id="Disulfide-885"><a href="#Disulfide-885"><span class="linenos"> 885</span></a>        <span class="n">totsq</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ic1</span><span class="p">)</span>
</span><span id="Disulfide-886"><a href="#Disulfide-886"><span class="linenos"> 886</span></a>
</span><span id="Disulfide-887"><a href="#Disulfide-887"><span class="linenos"> 887</span></a>        <span class="c1"># Take the square root of the mean to get the RMS distance</span>
</span><span id="Disulfide-888"><a href="#Disulfide-888"><span class="linenos"> 888</span></a>        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">totsq</span><span class="p">)</span>
</span><span id="Disulfide-889"><a href="#Disulfide-889"><span class="linenos"> 889</span></a>
</span><span id="Disulfide-890"><a href="#Disulfide-890"><span class="linenos"> 890</span></a>    <span class="k">def</span> <span class="nf">get_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Disulfide-891"><a href="#Disulfide-891"><span class="linenos"> 891</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-892"><a href="#Disulfide-892"><span class="linenos"> 892</span></a><span class="sd">        Return the proximal and distal chain IDs for the Disulfide.</span>
</span><span id="Disulfide-893"><a href="#Disulfide-893"><span class="linenos"> 893</span></a>
</span><span id="Disulfide-894"><a href="#Disulfide-894"><span class="linenos"> 894</span></a><span class="sd">        :return: tuple (proximal, distal) chain IDs</span>
</span><span id="Disulfide-895"><a href="#Disulfide-895"><span class="linenos"> 895</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-896"><a href="#Disulfide-896"><span class="linenos"> 896</span></a>        <span class="n">prox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proximal_chain</span>
</span><span id="Disulfide-897"><a href="#Disulfide-897"><span class="linenos"> 897</span></a>        <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distal_chain</span>
</span><span id="Disulfide-898"><a href="#Disulfide-898"><span class="linenos"> 898</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">prox</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</span><span id="Disulfide-899"><a href="#Disulfide-899"><span class="linenos"> 899</span></a>    
</span><span id="Disulfide-900"><a href="#Disulfide-900"><span class="linenos"> 900</span></a>    <span class="k">def</span> <span class="nf">get_permissive</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Disulfide-901"><a href="#Disulfide-901"><span class="linenos"> 901</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-902"><a href="#Disulfide-902"><span class="linenos"> 902</span></a><span class="sd">        Return the Permissive flag state. (Used in PDB parsing)</span>
</span><span id="Disulfide-903"><a href="#Disulfide-903"><span class="linenos"> 903</span></a>
</span><span id="Disulfide-904"><a href="#Disulfide-904"><span class="linenos"> 904</span></a><span class="sd">        :return: Permissive state</span>
</span><span id="Disulfide-905"><a href="#Disulfide-905"><span class="linenos"> 905</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-906"><a href="#Disulfide-906"><span class="linenos"> 906</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">PERMISIVE</span>
</span><span id="Disulfide-907"><a href="#Disulfide-907"><span class="linenos"> 907</span></a>
</span><span id="Disulfide-908"><a href="#Disulfide-908"><span class="linenos"> 908</span></a>    <span class="k">def</span> <span class="nf">get_full_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide-909"><a href="#Disulfide-909"><span class="linenos"> 909</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-910"><a href="#Disulfide-910"><span class="linenos"> 910</span></a><span class="sd">        Return the Disulfide full IDs (Used with BIO.PDB)</span>
</span><span id="Disulfide-911"><a href="#Disulfide-911"><span class="linenos"> 911</span></a>
</span><span id="Disulfide-912"><a href="#Disulfide-912"><span class="linenos"> 912</span></a><span class="sd">        :return: Disulfide full IDs</span>
</span><span id="Disulfide-913"><a href="#Disulfide-913"><span class="linenos"> 913</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-914"><a href="#Disulfide-914"><span class="linenos"> 914</span></a>        <span class="k">return</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal_residue_fullid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distal_residue_fullid</span><span class="p">))</span>
</span><span id="Disulfide-915"><a href="#Disulfide-915"><span class="linenos"> 915</span></a>
</span><span id="Disulfide-916"><a href="#Disulfide-916"><span class="linenos"> 916</span></a>    <span class="k">def</span> <span class="nf">initialize_disulfide_from_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chain1</span><span class="p">,</span> <span class="n">chain2</span><span class="p">,</span> <span class="n">proximal</span><span class="p">,</span> 
</span><span id="Disulfide-917"><a href="#Disulfide-917"><span class="linenos"> 917</span></a>    									<span class="n">distal</span><span class="p">,</span> <span class="n">resolution</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Disulfide-918"><a href="#Disulfide-918"><span class="linenos"> 918</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-919"><a href="#Disulfide-919"><span class="linenos"> 919</span></a><span class="sd">        Initialize a new Disulfide object with atomic coordinates from </span>
</span><span id="Disulfide-920"><a href="#Disulfide-920"><span class="linenos"> 920</span></a><span class="sd">        the proximal and distal coordinates, typically taken from a PDB file.</span>
</span><span id="Disulfide-921"><a href="#Disulfide-921"><span class="linenos"> 921</span></a><span class="sd">        This routine is primarily used internally when building the compressed</span>
</span><span id="Disulfide-922"><a href="#Disulfide-922"><span class="linenos"> 922</span></a><span class="sd">        database.</span>
</span><span id="Disulfide-923"><a href="#Disulfide-923"><span class="linenos"> 923</span></a>
</span><span id="Disulfide-924"><a href="#Disulfide-924"><span class="linenos"> 924</span></a><span class="sd">        :param chain1: list of Residues in the model, eg: chain = model[&#39;A&#39;]</span>
</span><span id="Disulfide-925"><a href="#Disulfide-925"><span class="linenos"> 925</span></a><span class="sd">        :param chain2: list of Residues in the model, eg: chain = model[&#39;A&#39;]</span>
</span><span id="Disulfide-926"><a href="#Disulfide-926"><span class="linenos"> 926</span></a><span class="sd">        :param proximal: proximal residue sequence ID</span>
</span><span id="Disulfide-927"><a href="#Disulfide-927"><span class="linenos"> 927</span></a><span class="sd">        :param distal: distal residue sequence ID</span>
</span><span id="Disulfide-928"><a href="#Disulfide-928"><span class="linenos"> 928</span></a><span class="sd">        :param resolution: structure resolution</span>
</span><span id="Disulfide-929"><a href="#Disulfide-929"><span class="linenos"> 929</span></a><span class="sd">        :param quiet: Quiet or noisy parsing, defaults to True</span>
</span><span id="Disulfide-930"><a href="#Disulfide-930"><span class="linenos"> 930</span></a><span class="sd">        :raises DisulfideConstructionWarning: Raised when not parsed correctly</span>
</span><span id="Disulfide-931"><a href="#Disulfide-931"><span class="linenos"> 931</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-932"><a href="#Disulfide-932"><span class="linenos"> 932</span></a>        <span class="nb">id</span> <span class="o">=</span> <span class="n">chain1</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Disulfide-933"><a href="#Disulfide-933"><span class="linenos"> 933</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_id</span> <span class="o">=</span> <span class="nb">id</span>
</span><span id="Disulfide-934"><a href="#Disulfide-934"><span class="linenos"> 934</span></a>        
</span><span id="Disulfide-935"><a href="#Disulfide-935"><span class="linenos"> 935</span></a>        <span class="n">chi1</span> <span class="o">=</span> <span class="n">chi2</span> <span class="o">=</span> <span class="n">chi3</span> <span class="o">=</span> <span class="n">chi4</span> <span class="o">=</span> <span class="n">chi5</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="Disulfide-936"><a href="#Disulfide-936"><span class="linenos"> 936</span></a>
</span><span id="Disulfide-937"><a href="#Disulfide-937"><span class="linenos"> 937</span></a>        <span class="n">prox</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">proximal</span><span class="p">)</span>
</span><span id="Disulfide-938"><a href="#Disulfide-938"><span class="linenos"> 938</span></a>        <span class="n">dist</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">distal</span><span class="p">)</span>
</span><span id="Disulfide-939"><a href="#Disulfide-939"><span class="linenos"> 939</span></a>
</span><span id="Disulfide-940"><a href="#Disulfide-940"><span class="linenos"> 940</span></a>        <span class="n">prox_residue</span> <span class="o">=</span> <span class="n">chain1</span><span class="p">[</span><span class="n">prox</span><span class="p">]</span>
</span><span id="Disulfide-941"><a href="#Disulfide-941"><span class="linenos"> 941</span></a>        <span class="n">dist_residue</span> <span class="o">=</span> <span class="n">chain2</span><span class="p">[</span><span class="n">dist</span><span class="p">]</span>
</span><span id="Disulfide-942"><a href="#Disulfide-942"><span class="linenos"> 942</span></a>
</span><span id="Disulfide-943"><a href="#Disulfide-943"><span class="linenos"> 943</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">prox_residue</span><span class="o">.</span><span class="n">get_resname</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;CYS&#39;</span> <span class="ow">or</span> <span class="n">dist_residue</span><span class="o">.</span><span class="n">get_resname</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;CYS&#39;</span><span class="p">):</span>
</span><span id="Disulfide-944"><a href="#Disulfide-944"><span class="linenos"> 944</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;build_disulfide() requires CYS at both residues: </span><span class="si">{</span><span class="n">prox</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">prox_residue</span><span class="o">.</span><span class="n">get_resname</span><span class="p">()</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">dist</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">dist_residue</span><span class="o">.</span><span class="n">get_resname</span><span class="p">()</span><span class="si">}</span><span class="s1"> Chain: </span><span class="si">{</span><span class="n">prox_residue</span><span class="o">.</span><span class="n">get_segid</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Disulfide-945"><a href="#Disulfide-945"><span class="linenos"> 945</span></a>
</span><span id="Disulfide-946"><a href="#Disulfide-946"><span class="linenos"> 946</span></a>        <span class="c1"># set the objects proximal and distal values</span>
</span><span id="Disulfide-947"><a href="#Disulfide-947"><span class="linenos"> 947</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_resnum</span><span class="p">(</span><span class="n">proximal</span><span class="p">,</span> <span class="n">distal</span><span class="p">)</span>
</span><span id="Disulfide-948"><a href="#Disulfide-948"><span class="linenos"> 948</span></a>    
</span><span id="Disulfide-949"><a href="#Disulfide-949"><span class="linenos"> 949</span></a>        <span class="k">if</span> <span class="n">resolution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Disulfide-950"><a href="#Disulfide-950"><span class="linenos"> 950</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="n">resolution</span>
</span><span id="Disulfide-951"><a href="#Disulfide-951"><span class="linenos"> 951</span></a>
</span><span id="Disulfide-952"><a href="#Disulfide-952"><span class="linenos"> 952</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal_chain</span> <span class="o">=</span> <span class="n">chain1</span><span class="o">.</span><span class="n">get_id</span><span class="p">()</span>
</span><span id="Disulfide-953"><a href="#Disulfide-953"><span class="linenos"> 953</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal_chain</span> <span class="o">=</span> <span class="n">chain2</span><span class="o">.</span><span class="n">get_id</span><span class="p">()</span>
</span><span id="Disulfide-954"><a href="#Disulfide-954"><span class="linenos"> 954</span></a>
</span><span id="Disulfide-955"><a href="#Disulfide-955"><span class="linenos"> 955</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal_residue_fullid</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()</span>
</span><span id="Disulfide-956"><a href="#Disulfide-956"><span class="linenos"> 956</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal_residue_fullid</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()</span>
</span><span id="Disulfide-957"><a href="#Disulfide-957"><span class="linenos"> 957</span></a>
</span><span id="Disulfide-958"><a href="#Disulfide-958"><span class="linenos"> 958</span></a>        <span class="k">if</span> <span class="n">quiet</span><span class="p">:</span>
</span><span id="Disulfide-959"><a href="#Disulfide-959"><span class="linenos"> 959</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">DisulfideConstructionWarning</span><span class="p">)</span>
</span><span id="Disulfide-960"><a href="#Disulfide-960"><span class="linenos"> 960</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Disulfide-961"><a href="#Disulfide-961"><span class="linenos"> 961</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;always&quot;</span><span class="p">)</span>
</span><span id="Disulfide-962"><a href="#Disulfide-962"><span class="linenos"> 962</span></a>
</span><span id="Disulfide-963"><a href="#Disulfide-963"><span class="linenos"> 963</span></a>        <span class="c1"># grab the coordinates for the proximal and distal residues as vectors </span>
</span><span id="Disulfide-964"><a href="#Disulfide-964"><span class="linenos"> 964</span></a>        <span class="c1"># so we can do math on them later</span>
</span><span id="Disulfide-965"><a href="#Disulfide-965"><span class="linenos"> 965</span></a>        <span class="c1"># proximal residue</span>
</span><span id="Disulfide-966"><a href="#Disulfide-966"><span class="linenos"> 966</span></a>        
</span><span id="Disulfide-967"><a href="#Disulfide-967"><span class="linenos"> 967</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Disulfide-968"><a href="#Disulfide-968"><span class="linenos"> 968</span></a>            <span class="n">n1</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide-969"><a href="#Disulfide-969"><span class="linenos"> 969</span></a>            <span class="n">ca1</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide-970"><a href="#Disulfide-970"><span class="linenos"> 970</span></a>            <span class="n">c1</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide-971"><a href="#Disulfide-971"><span class="linenos"> 971</span></a>            <span class="n">o1</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide-972"><a href="#Disulfide-972"><span class="linenos"> 972</span></a>            <span class="n">cb1</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="p">[</span><span class="s1">&#39;CB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide-973"><a href="#Disulfide-973"><span class="linenos"> 973</span></a>            <span class="n">sg1</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="p">[</span><span class="s1">&#39;SG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide-974"><a href="#Disulfide-974"><span class="linenos"> 974</span></a>            
</span><span id="Disulfide-975"><a href="#Disulfide-975"><span class="linenos"> 975</span></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="Disulfide-976"><a href="#Disulfide-976"><span class="linenos"> 976</span></a>            <span class="k">raise</span> <span class="n">DisulfideConstructionWarning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid or missing coordinates for proximal residue </span><span class="si">{</span><span class="n">proximal</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>
</span><span id="Disulfide-977"><a href="#Disulfide-977"><span class="linenos"> 977</span></a>        
</span><span id="Disulfide-978"><a href="#Disulfide-978"><span class="linenos"> 978</span></a>        <span class="c1"># distal residue</span>
</span><span id="Disulfide-979"><a href="#Disulfide-979"><span class="linenos"> 979</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Disulfide-980"><a href="#Disulfide-980"><span class="linenos"> 980</span></a>            <span class="n">n2</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide-981"><a href="#Disulfide-981"><span class="linenos"> 981</span></a>            <span class="n">ca2</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide-982"><a href="#Disulfide-982"><span class="linenos"> 982</span></a>            <span class="n">c2</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide-983"><a href="#Disulfide-983"><span class="linenos"> 983</span></a>            <span class="n">o2</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide-984"><a href="#Disulfide-984"><span class="linenos"> 984</span></a>            <span class="n">cb2</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="p">[</span><span class="s1">&#39;CB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide-985"><a href="#Disulfide-985"><span class="linenos"> 985</span></a>            <span class="n">sg2</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="p">[</span><span class="s1">&#39;SG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide-986"><a href="#Disulfide-986"><span class="linenos"> 986</span></a>
</span><span id="Disulfide-987"><a href="#Disulfide-987"><span class="linenos"> 987</span></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="Disulfide-988"><a href="#Disulfide-988"><span class="linenos"> 988</span></a>            <span class="k">raise</span> <span class="n">DisulfideConstructionWarning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid or missing coordinates for distal residue </span><span class="si">{</span><span class="n">distal</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>
</span><span id="Disulfide-989"><a href="#Disulfide-989"><span class="linenos"> 989</span></a>        
</span><span id="Disulfide-990"><a href="#Disulfide-990"><span class="linenos"> 990</span></a>        <span class="c1"># previous residue and next residue - optional, used for phi, psi calculations</span>
</span><span id="Disulfide-991"><a href="#Disulfide-991"><span class="linenos"> 991</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Disulfide-992"><a href="#Disulfide-992"><span class="linenos"> 992</span></a>            <span class="n">prevprox</span> <span class="o">=</span> <span class="n">chain1</span><span class="p">[</span><span class="n">prox</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Disulfide-993"><a href="#Disulfide-993"><span class="linenos"> 993</span></a>            <span class="n">nextprox</span> <span class="o">=</span> <span class="n">chain1</span><span class="p">[</span><span class="n">prox</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Disulfide-994"><a href="#Disulfide-994"><span class="linenos"> 994</span></a>
</span><span id="Disulfide-995"><a href="#Disulfide-995"><span class="linenos"> 995</span></a>            <span class="n">prevdist</span> <span class="o">=</span> <span class="n">chain2</span><span class="p">[</span><span class="n">dist</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Disulfide-996"><a href="#Disulfide-996"><span class="linenos"> 996</span></a>            <span class="n">nextdist</span> <span class="o">=</span> <span class="n">chain2</span><span class="p">[</span><span class="n">dist</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Disulfide-997"><a href="#Disulfide-997"><span class="linenos"> 997</span></a>
</span><span id="Disulfide-998"><a href="#Disulfide-998"><span class="linenos"> 998</span></a>            <span class="n">cprev_prox</span> <span class="o">=</span> <span class="n">prevprox</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide-999"><a href="#Disulfide-999"><span class="linenos"> 999</span></a>            <span class="n">nnext_prox</span> <span class="o">=</span> <span class="n">nextprox</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide-1000"><a href="#Disulfide-1000"><span class="linenos">1000</span></a>
</span><span id="Disulfide-1001"><a href="#Disulfide-1001"><span class="linenos">1001</span></a>            <span class="n">cprev_dist</span> <span class="o">=</span> <span class="n">prevdist</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide-1002"><a href="#Disulfide-1002"><span class="linenos">1002</span></a>            <span class="n">nnext_dist</span> <span class="o">=</span> <span class="n">nextdist</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide-1003"><a href="#Disulfide-1003"><span class="linenos">1003</span></a>
</span><span id="Disulfide-1004"><a href="#Disulfide-1004"><span class="linenos">1004</span></a>            <span class="c1"># compute phi, psi for prox and distal</span>
</span><span id="Disulfide-1005"><a href="#Disulfide-1005"><span class="linenos">1005</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">phiprox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">cprev_prox</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">ca1</span><span class="p">,</span> <span class="n">c1</span><span class="p">))</span>
</span><span id="Disulfide-1006"><a href="#Disulfide-1006"><span class="linenos">1006</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">psiprox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">ca1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">nnext_prox</span><span class="p">))</span>
</span><span id="Disulfide-1007"><a href="#Disulfide-1007"><span class="linenos">1007</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">phidist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">cprev_dist</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">ca2</span><span class="p">,</span> <span class="n">c2</span><span class="p">))</span>
</span><span id="Disulfide-1008"><a href="#Disulfide-1008"><span class="linenos">1008</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">psidist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">n2</span><span class="p">,</span> <span class="n">ca2</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">nnext_dist</span><span class="p">))</span>
</span><span id="Disulfide-1009"><a href="#Disulfide-1009"><span class="linenos">1009</span></a>
</span><span id="Disulfide-1010"><a href="#Disulfide-1010"><span class="linenos">1010</span></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="Disulfide-1011"><a href="#Disulfide-1011"><span class="linenos">1011</span></a>            <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Missing coords for: </span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">prox</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s1"> or </span><span class="si">{</span><span class="n">dist</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1"> for SS </span><span class="si">{</span><span class="n">proximal</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">distal</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Disulfide-1012"><a href="#Disulfide-1012"><span class="linenos">1012</span></a>            <span class="n">cprev_prox</span> <span class="o">=</span> <span class="n">nnext_prox</span> <span class="o">=</span> <span class="n">cprev_dist</span> <span class="o">=</span> <span class="n">nnext_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="Disulfide-1013"><a href="#Disulfide-1013"><span class="linenos">1013</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">missing_atoms</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Disulfide-1014"><a href="#Disulfide-1014"><span class="linenos">1014</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">,</span> <span class="n">DisulfideConstructionWarning</span><span class="p">)</span>
</span><span id="Disulfide-1015"><a href="#Disulfide-1015"><span class="linenos">1015</span></a>
</span><span id="Disulfide-1016"><a href="#Disulfide-1016"><span class="linenos">1016</span></a>        <span class="c1"># update the positions and conformation</span>
</span><span id="Disulfide-1017"><a href="#Disulfide-1017"><span class="linenos">1017</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_positions</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">ca1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">o1</span><span class="p">,</span> <span class="n">cb1</span><span class="p">,</span> <span class="n">sg1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">ca2</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">o2</span><span class="p">,</span> <span class="n">cb2</span><span class="p">,</span> 
</span><span id="Disulfide-1018"><a href="#Disulfide-1018"><span class="linenos">1018</span></a>                           <span class="n">sg2</span><span class="p">,</span> <span class="n">cprev_prox</span><span class="p">,</span> <span class="n">nnext_prox</span><span class="p">,</span> <span class="n">cprev_dist</span><span class="p">,</span> <span class="n">nnext_dist</span><span class="p">)</span>
</span><span id="Disulfide-1019"><a href="#Disulfide-1019"><span class="linenos">1019</span></a>        
</span><span id="Disulfide-1020"><a href="#Disulfide-1020"><span class="linenos">1020</span></a>        <span class="c1"># calculate and set the disulfide dihedral angles</span>
</span><span id="Disulfide-1021"><a href="#Disulfide-1021"><span class="linenos">1021</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">ca1</span><span class="p">,</span> <span class="n">cb1</span><span class="p">,</span> <span class="n">sg1</span><span class="p">))</span>
</span><span id="Disulfide-1022"><a href="#Disulfide-1022"><span class="linenos">1022</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">ca1</span><span class="p">,</span> <span class="n">cb1</span><span class="p">,</span> <span class="n">sg1</span><span class="p">,</span> <span class="n">sg2</span><span class="p">))</span>
</span><span id="Disulfide-1023"><a href="#Disulfide-1023"><span class="linenos">1023</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">cb1</span><span class="p">,</span> <span class="n">sg1</span><span class="p">,</span> <span class="n">sg2</span><span class="p">,</span> <span class="n">cb2</span><span class="p">))</span>
</span><span id="Disulfide-1024"><a href="#Disulfide-1024"><span class="linenos">1024</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">sg1</span><span class="p">,</span> <span class="n">sg2</span><span class="p">,</span> <span class="n">cb2</span><span class="p">,</span> <span class="n">ca2</span><span class="p">))</span>
</span><span id="Disulfide-1025"><a href="#Disulfide-1025"><span class="linenos">1025</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">sg2</span><span class="p">,</span> <span class="n">cb2</span><span class="p">,</span> <span class="n">ca2</span><span class="p">,</span> <span class="n">n2</span><span class="p">))</span>
</span><span id="Disulfide-1026"><a href="#Disulfide-1026"><span class="linenos">1026</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">ca1</span><span class="p">,</span> <span class="n">ca2</span><span class="p">,</span> <span class="n">n2</span><span class="p">))</span>
</span><span id="Disulfide-1027"><a href="#Disulfide-1027"><span class="linenos">1027</span></a>
</span><span id="Disulfide-1028"><a href="#Disulfide-1028"><span class="linenos">1028</span></a>
</span><span id="Disulfide-1029"><a href="#Disulfide-1029"><span class="linenos">1029</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span> <span class="o">=</span> <span class="n">distance3d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span><span class="p">)</span>
</span><span id="Disulfide-1030"><a href="#Disulfide-1030"><span class="linenos">1030</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_distance</span> <span class="o">=</span> <span class="n">distance3d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span><span class="p">)</span>
</span><span id="Disulfide-1031"><a href="#Disulfide-1031"><span class="linenos">1031</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">chi1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span><span class="p">,</span> 
</span><span id="Disulfide-1032"><a href="#Disulfide-1032"><span class="linenos">1032</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">chi4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi5</span><span class="p">))</span>
</span><span id="Disulfide-1033"><a href="#Disulfide-1033"><span class="linenos">1033</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Torsion_Length</span><span class="p">()</span>
</span><span id="Disulfide-1034"><a href="#Disulfide-1034"><span class="linenos">1034</span></a>
</span><span id="Disulfide-1035"><a href="#Disulfide-1035"><span class="linenos">1035</span></a>        <span class="c1"># calculate and set the SS bond torsional energy</span>
</span><span id="Disulfide-1036"><a href="#Disulfide-1036"><span class="linenos">1036</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">compute_torsional_energy</span><span class="p">()</span>
</span><span id="Disulfide-1037"><a href="#Disulfide-1037"><span class="linenos">1037</span></a>
</span><span id="Disulfide-1038"><a href="#Disulfide-1038"><span class="linenos">1038</span></a>        <span class="c1"># compute and set the local coordinates</span>
</span><span id="Disulfide-1039"><a href="#Disulfide-1039"><span class="linenos">1039</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">compute_local_coords</span><span class="p">()</span>
</span><span id="Disulfide-1040"><a href="#Disulfide-1040"><span class="linenos">1040</span></a>
</span><span id="Disulfide-1041"><a href="#Disulfide-1041"><span class="linenos">1041</span></a>    <span class="k">def</span> <span class="nf">internal_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
</span><span id="Disulfide-1042"><a href="#Disulfide-1042"><span class="linenos">1042</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-1043"><a href="#Disulfide-1043"><span class="linenos">1043</span></a><span class="sd">        Returns the internal coordinates for the Disulfide.</span>
</span><span id="Disulfide-1044"><a href="#Disulfide-1044"><span class="linenos">1044</span></a><span class="sd">        If there are missing atoms the extra atoms for the proximal</span>
</span><span id="Disulfide-1045"><a href="#Disulfide-1045"><span class="linenos">1045</span></a><span class="sd">        and distal N and C are set to [0,0,0]. This is needed for the center of</span>
</span><span id="Disulfide-1046"><a href="#Disulfide-1046"><span class="linenos">1046</span></a><span class="sd">        mass calculations, used when rendering.</span>
</span><span id="Disulfide-1047"><a href="#Disulfide-1047"><span class="linenos">1047</span></a>
</span><span id="Disulfide-1048"><a href="#Disulfide-1048"><span class="linenos">1048</span></a><span class="sd">        :return: Array containing the coordinates, [16][3].</span>
</span><span id="Disulfide-1049"><a href="#Disulfide-1049"><span class="linenos">1049</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-1050"><a href="#Disulfide-1050"><span class="linenos">1050</span></a>        
</span><span id="Disulfide-1051"><a href="#Disulfide-1051"><span class="linenos">1051</span></a>        <span class="c1"># if we don&#39;t have the prior and next atoms we initialize those</span>
</span><span id="Disulfide-1052"><a href="#Disulfide-1052"><span class="linenos">1052</span></a>        <span class="c1"># atoms to the origin so as to not effect the center of mass calculations</span>
</span><span id="Disulfide-1053"><a href="#Disulfide-1053"><span class="linenos">1053</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing_atoms</span><span class="p">:</span>
</span><span id="Disulfide-1054"><a href="#Disulfide-1054"><span class="linenos">1054</span></a>            <span class="n">res_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span>
</span><span id="Disulfide-1055"><a href="#Disulfide-1055"><span class="linenos">1055</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1056"><a href="#Disulfide-1056"><span class="linenos">1056</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_ca_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1057"><a href="#Disulfide-1057"><span class="linenos">1057</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1058"><a href="#Disulfide-1058"><span class="linenos">1058</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_o_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="Disulfide-1059"><a href="#Disulfide-1059"><span class="linenos">1059</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cb_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1060"><a href="#Disulfide-1060"><span class="linenos">1060</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sg_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1061"><a href="#Disulfide-1061"><span class="linenos">1061</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1062"><a href="#Disulfide-1062"><span class="linenos">1062</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_ca_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1063"><a href="#Disulfide-1063"><span class="linenos">1063</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="Disulfide-1064"><a href="#Disulfide-1064"><span class="linenos">1064</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_o_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="Disulfide-1065"><a href="#Disulfide-1065"><span class="linenos">1065</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cb_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1066"><a href="#Disulfide-1066"><span class="linenos">1066</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sg_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1067"><a href="#Disulfide-1067"><span class="linenos">1067</span></a>                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Disulfide-1068"><a href="#Disulfide-1068"><span class="linenos">1068</span></a>                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Disulfide-1069"><a href="#Disulfide-1069"><span class="linenos">1069</span></a>                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Disulfide-1070"><a href="#Disulfide-1070"><span class="linenos">1070</span></a>                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Disulfide-1071"><a href="#Disulfide-1071"><span class="linenos">1071</span></a>            <span class="p">))</span>
</span><span id="Disulfide-1072"><a href="#Disulfide-1072"><span class="linenos">1072</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Disulfide-1073"><a href="#Disulfide-1073"><span class="linenos">1073</span></a>            <span class="n">res_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span>
</span><span id="Disulfide-1074"><a href="#Disulfide-1074"><span class="linenos">1074</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1075"><a href="#Disulfide-1075"><span class="linenos">1075</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_ca_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1076"><a href="#Disulfide-1076"><span class="linenos">1076</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="Disulfide-1077"><a href="#Disulfide-1077"><span class="linenos">1077</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_o_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="Disulfide-1078"><a href="#Disulfide-1078"><span class="linenos">1078</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cb_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1079"><a href="#Disulfide-1079"><span class="linenos">1079</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sg_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1080"><a href="#Disulfide-1080"><span class="linenos">1080</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1081"><a href="#Disulfide-1081"><span class="linenos">1081</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_ca_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1082"><a href="#Disulfide-1082"><span class="linenos">1082</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="Disulfide-1083"><a href="#Disulfide-1083"><span class="linenos">1083</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_o_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="Disulfide-1084"><a href="#Disulfide-1084"><span class="linenos">1084</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cb_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1085"><a href="#Disulfide-1085"><span class="linenos">1085</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sg_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1086"><a href="#Disulfide-1086"><span class="linenos">1086</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_prev_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1087"><a href="#Disulfide-1087"><span class="linenos">1087</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_next_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1088"><a href="#Disulfide-1088"><span class="linenos">1088</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_prev_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1089"><a href="#Disulfide-1089"><span class="linenos">1089</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_next_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide-1090"><a href="#Disulfide-1090"><span class="linenos">1090</span></a>            <span class="p">))</span>
</span><span id="Disulfide-1091"><a href="#Disulfide-1091"><span class="linenos">1091</span></a>        <span class="k">return</span> <span class="n">res_array</span>
</span><span id="Disulfide-1092"><a href="#Disulfide-1092"><span class="linenos">1092</span></a>    
</span><span id="Disulfide-1093"><a href="#Disulfide-1093"><span class="linenos">1093</span></a>    <span class="k">def</span> <span class="nf">internal_coords_res</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resnumb</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
</span><span id="Disulfide-1094"><a href="#Disulfide-1094"><span class="linenos">1094</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-1095"><a href="#Disulfide-1095"><span class="linenos">1095</span></a><span class="sd">        Returns the internal coordinates for the internal coordinates of</span>
</span><span id="Disulfide-1096"><a href="#Disulfide-1096"><span class="linenos">1096</span></a><span class="sd">        the given Disulfide. Missing atoms are not included.</span>
</span><span id="Disulfide-1097"><a href="#Disulfide-1097"><span class="linenos">1097</span></a>
</span><span id="Disulfide-1098"><a href="#Disulfide-1098"><span class="linenos">1098</span></a><span class="sd">        :param resnumb: Residue number for disulfide</span>
</span><span id="Disulfide-1099"><a href="#Disulfide-1099"><span class="linenos">1099</span></a><span class="sd">        :raises DisulfideConstructionWarning: Warning raised if the residue number is invalid</span>
</span><span id="Disulfide-1100"><a href="#Disulfide-1100"><span class="linenos">1100</span></a><span class="sd">        :return: Array containing the internal coordinates for the disulfide</span>
</span><span id="Disulfide-1101"><a href="#Disulfide-1101"><span class="linenos">1101</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-1102"><a href="#Disulfide-1102"><span class="linenos">1102</span></a>        <span class="n">res_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</span><span id="Disulfide-1103"><a href="#Disulfide-1103"><span class="linenos">1103</span></a>
</span><span id="Disulfide-1104"><a href="#Disulfide-1104"><span class="linenos">1104</span></a>        <span class="k">if</span> <span class="n">resnumb</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">proximal</span><span class="p">:</span>
</span><span id="Disulfide-1105"><a href="#Disulfide-1105"><span class="linenos">1105</span></a>            <span class="n">res_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span>
</span><span id="Disulfide-1106"><a href="#Disulfide-1106"><span class="linenos">1106</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1107"><a href="#Disulfide-1107"><span class="linenos">1107</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_ca_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1108"><a href="#Disulfide-1108"><span class="linenos">1108</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="Disulfide-1109"><a href="#Disulfide-1109"><span class="linenos">1109</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_o_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="Disulfide-1110"><a href="#Disulfide-1110"><span class="linenos">1110</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cb_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1111"><a href="#Disulfide-1111"><span class="linenos">1111</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sg_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1112"><a href="#Disulfide-1112"><span class="linenos">1112</span></a>            <span class="p">))</span>
</span><span id="Disulfide-1113"><a href="#Disulfide-1113"><span class="linenos">1113</span></a>            <span class="k">return</span> <span class="n">res_array</span>
</span><span id="Disulfide-1114"><a href="#Disulfide-1114"><span class="linenos">1114</span></a>
</span><span id="Disulfide-1115"><a href="#Disulfide-1115"><span class="linenos">1115</span></a>        <span class="k">elif</span> <span class="n">resnumb</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">distal</span><span class="p">:</span>
</span><span id="Disulfide-1116"><a href="#Disulfide-1116"><span class="linenos">1116</span></a>            <span class="n">res_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span>
</span><span id="Disulfide-1117"><a href="#Disulfide-1117"><span class="linenos">1117</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1118"><a href="#Disulfide-1118"><span class="linenos">1118</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_ca_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1119"><a href="#Disulfide-1119"><span class="linenos">1119</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1120"><a href="#Disulfide-1120"><span class="linenos">1120</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_o_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="Disulfide-1121"><a href="#Disulfide-1121"><span class="linenos">1121</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cb_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1122"><a href="#Disulfide-1122"><span class="linenos">1122</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sg_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide-1123"><a href="#Disulfide-1123"><span class="linenos">1123</span></a>            <span class="p">))</span>
</span><span id="Disulfide-1124"><a href="#Disulfide-1124"><span class="linenos">1124</span></a>            <span class="k">return</span> <span class="n">res_array</span>
</span><span id="Disulfide-1125"><a href="#Disulfide-1125"><span class="linenos">1125</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Disulfide-1126"><a href="#Disulfide-1126"><span class="linenos">1126</span></a>            <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;-&gt; Disulfide.internal_coords(): Invalid argument. </span><span class="se">\</span>
</span><span id="Disulfide-1127"><a href="#Disulfide-1127"><span class="linenos">1127</span></a><span class="s1">             Unable to find residue: </span><span class="si">{</span><span class="n">resnumb</span><span class="si">}</span><span class="s1"> &#39;</span>
</span><span id="Disulfide-1128"><a href="#Disulfide-1128"><span class="linenos">1128</span></a>            <span class="k">raise</span> <span class="n">DisulfideConstructionWarning</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
</span><span id="Disulfide-1129"><a href="#Disulfide-1129"><span class="linenos">1129</span></a>
</span><span id="Disulfide-1130"><a href="#Disulfide-1130"><span class="linenos">1130</span></a>    <span class="k">def</span> <span class="nf">make_movie</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;ssbond.mp4&#39;</span><span class="p">,</span>
</span><span id="Disulfide-1131"><a href="#Disulfide-1131"><span class="linenos">1131</span></a>                   <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">360</span><span class="p">):</span>
</span><span id="Disulfide-1132"><a href="#Disulfide-1132"><span class="linenos">1132</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-1133"><a href="#Disulfide-1133"><span class="linenos">1133</span></a><span class="sd">        Create an animation for ```self``` rotating one revolution about the Y axis,</span>
</span><span id="Disulfide-1134"><a href="#Disulfide-1134"><span class="linenos">1134</span></a><span class="sd">        in the given ```style```, saving to ```filename```.</span>
</span><span id="Disulfide-1135"><a href="#Disulfide-1135"><span class="linenos">1135</span></a>
</span><span id="Disulfide-1136"><a href="#Disulfide-1136"><span class="linenos">1136</span></a><span class="sd">        :param style: Rendering style, defaults to &#39;sb&#39;, one of:</span>
</span><span id="Disulfide-1137"><a href="#Disulfide-1137"><span class="linenos">1137</span></a><span class="sd">        * &#39;sb&#39; - split bonds</span>
</span><span id="Disulfide-1138"><a href="#Disulfide-1138"><span class="linenos">1138</span></a><span class="sd">        * &#39;bs&#39; - ball and stick</span>
</span><span id="Disulfide-1139"><a href="#Disulfide-1139"><span class="linenos">1139</span></a><span class="sd">        * &#39;cpk&#39; - CPK style</span>
</span><span id="Disulfide-1140"><a href="#Disulfide-1140"><span class="linenos">1140</span></a><span class="sd">        * &#39;pd&#39; - Proximal/Distal style - Red=proximal, Green=Distal</span>
</span><span id="Disulfide-1141"><a href="#Disulfide-1141"><span class="linenos">1141</span></a><span class="sd">        * &#39;plain&#39; - boring single color</span>
</span><span id="Disulfide-1142"><a href="#Disulfide-1142"><span class="linenos">1142</span></a><span class="sd">        </span>
</span><span id="Disulfide-1143"><a href="#Disulfide-1143"><span class="linenos">1143</span></a><span class="sd">        :param fname: Output filename, defaults to ```ssbond.mp4```</span>
</span><span id="Disulfide-1144"><a href="#Disulfide-1144"><span class="linenos">1144</span></a><span class="sd">        :param verbose: Verbosity, defaults to False</span>
</span><span id="Disulfide-1145"><a href="#Disulfide-1145"><span class="linenos">1145</span></a><span class="sd">        :param steps: Number of steps for one complete rotation, defaults to 360.</span>
</span><span id="Disulfide-1146"><a href="#Disulfide-1146"><span class="linenos">1146</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-1147"><a href="#Disulfide-1147"><span class="linenos">1147</span></a>        <span class="n">src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="Disulfide-1148"><a href="#Disulfide-1148"><span class="linenos">1148</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
</span><span id="Disulfide-1149"><a href="#Disulfide-1149"><span class="linenos">1149</span></a>        <span class="n">enrg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span>
</span><span id="Disulfide-1150"><a href="#Disulfide-1150"><span class="linenos">1150</span></a>
</span><span id="Disulfide-1151"><a href="#Disulfide-1151"><span class="linenos">1151</span></a>        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">src</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal_chain</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal_chain</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">enrg</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol, Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å, Tors: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Disulfide-1152"><a href="#Disulfide-1152"><span class="linenos">1152</span></a>        
</span><span id="Disulfide-1153"><a href="#Disulfide-1153"><span class="linenos">1153</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Disulfide-1154"><a href="#Disulfide-1154"><span class="linenos">1154</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Rendering animation to </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">)</span>
</span><span id="Disulfide-1155"><a href="#Disulfide-1155"><span class="linenos">1155</span></a>
</span><span id="Disulfide-1156"><a href="#Disulfide-1156"><span class="linenos">1156</span></a>        <span class="n">pl</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="n">WINSIZE</span><span class="p">,</span> <span class="n">off_screen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Disulfide-1157"><a href="#Disulfide-1157"><span class="linenos">1157</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">open_movie</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">quality</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
</span><span id="Disulfide-1158"><a href="#Disulfide-1158"><span class="linenos">1158</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">generate_orbital_path</span><span class="p">(</span><span class="n">n_points</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
</span><span id="Disulfide-1159"><a href="#Disulfide-1159"><span class="linenos">1159</span></a>
</span><span id="Disulfide-1160"><a href="#Disulfide-1160"><span class="linenos">1160</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide-1161"><a href="#Disulfide-1161"><span class="linenos">1161</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">enable_anti_aliasing</span><span class="p">(</span><span class="s1">&#39;msaa&#39;</span><span class="p">)</span>
</span><span id="Disulfide-1162"><a href="#Disulfide-1162"><span class="linenos">1162</span></a>        <span class="c1"># pl.add_camera_orientation_widget()</span>
</span><span id="Disulfide-1163"><a href="#Disulfide-1163"><span class="linenos">1163</span></a>        <span class="n">pl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="Disulfide-1164"><a href="#Disulfide-1164"><span class="linenos">1164</span></a>                    <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="Disulfide-1165"><a href="#Disulfide-1165"><span class="linenos">1165</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="Disulfide-1166"><a href="#Disulfide-1166"><span class="linenos">1166</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">orbit_on_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">write_frames</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Disulfide-1167"><a href="#Disulfide-1167"><span class="linenos">1167</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Disulfide-1168"><a href="#Disulfide-1168"><span class="linenos">1168</span></a>
</span><span id="Disulfide-1169"><a href="#Disulfide-1169"><span class="linenos">1169</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Disulfide-1170"><a href="#Disulfide-1170"><span class="linenos">1170</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Saved mp4 animation to: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Disulfide-1171"><a href="#Disulfide-1171"><span class="linenos">1171</span></a>    
</span><span id="Disulfide-1172"><a href="#Disulfide-1172"><span class="linenos">1172</span></a>    <span class="k">def</span> <span class="nf">pprint</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Disulfide-1173"><a href="#Disulfide-1173"><span class="linenos">1173</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-1174"><a href="#Disulfide-1174"><span class="linenos">1174</span></a><span class="sd">        Pretty print general info for the Disulfide</span>
</span><span id="Disulfide-1175"><a href="#Disulfide-1175"><span class="linenos">1175</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-1176"><a href="#Disulfide-1176"><span class="linenos">1176</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_info</span><span class="p">()</span>
</span><span id="Disulfide-1177"><a href="#Disulfide-1177"><span class="linenos">1177</span></a>        <span class="n">s2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_ca_dist</span><span class="p">()</span>
</span><span id="Disulfide-1178"><a href="#Disulfide-1178"><span class="linenos">1178</span></a>        <span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_conformation</span><span class="p">()</span>
</span><span id="Disulfide-1179"><a href="#Disulfide-1179"><span class="linenos">1179</span></a>        <span class="n">s4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_torsion_length</span><span class="p">()</span>
</span><span id="Disulfide-1180"><a href="#Disulfide-1180"><span class="linenos">1180</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s1</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="si">{</span><span class="n">s3</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="si">{</span><span class="n">s2</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="si">{</span><span class="n">s4</span><span class="si">}</span><span class="s1">&gt;&#39;</span>
</span><span id="Disulfide-1181"><a href="#Disulfide-1181"><span class="linenos">1181</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="Disulfide-1182"><a href="#Disulfide-1182"><span class="linenos">1182</span></a>    
</span><span id="Disulfide-1183"><a href="#Disulfide-1183"><span class="linenos">1183</span></a>    <span class="k">def</span> <span class="nf">pprint_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Disulfide-1184"><a href="#Disulfide-1184"><span class="linenos">1184</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide-1185"><a href="#Disulfide-1185"><span class="linenos">1185</span></a><span class="sd">        Pretty print all info for the Disulfide</span>
</span><span id="Disulfide-1186"><a href="#Disulfide-1186"><span class="linenos">1186</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide-1187"><a href="#Disulfide-1187"><span class="linenos">1187</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_info</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="Disulfide-1188"><a href="#Disulfide-1188"><span class="linenos">1188</span></a>        <span class="n">s2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_coords</span><span class="p">()</span>
</span><span id="Disulfide-1189"><a href="#Disulfide-1189"><span class="linenos">1189</span></a>        <span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_local_coords</span><span class="p">()</span>
</span><span id="Disulfide-1190"><a href="#Disulfide-1190"><span class="linenos">1190</span></a>        <span class="n">s4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_conformation</span><span class="p">()</span>
</span><span id="Disulfide-1191"><a href="#Disulfide-1191"><span class="linenos">1191</span></a>        <span class="n">s5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_chain_ids</span><span class="p">()</span>
</span><span id="Disulfide-1192"><a href="#Disulfide-1192"><span class="linenos">1192</span></a>        <span class="n">s6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_ca_dist</span><span class="p">()</span>
</span><span id="Disulfide-1193"><a href="#Disulfide-1193"><span class="linenos">1193</span></a>        <span class="n">s7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_torsion_length</span><span class="p">()</span>
</span><span id="Disulfide-1194"><a href="#Disulfide-1194"><span class="linenos">1194</span></a>
</span><span id="Disulfide-1195"><a href="#Disulfide-1195"><span class="linenos">1195</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s1</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s5</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s2</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s3</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s4</span><span class="si">}</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">s6</span><span class="si">}</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">s7</span><span class="si">}</span><span class="s1">&gt;&#39;</span>
</span><span id="Disulfide-1196"><a href="#Disulfide-1196"><span class="linenos">1196</span></a>
</span><span id="Disulfide-1197"><a href="#Disulfide-1197"><span class="linenos">1197</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="Disulfide-1198"><a href="#Disulfide-1198"><span class="linenos">1198</span></a>    
</span><span id="Disulfide-1199"><a href="#Disulfide-1199"><span class="linenos">1199</span></a>    <span class="c1"># repr functions. The class is large, so I split it up into sections</span>
</span><span id="Disulfide-1200"><a href="#Disulfide-1200"><span class="linenos">1200</span></a>    <span class="k">def</span> <span class="nf">repr_ss_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide-1201"><a href="#Disulfide-1201"><span class="linenos">1201</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide-1202"><a href="#Disulfide-1202"><span class="linenos">1202</span></a><span class="sd">        Representation for the Disulfide class</span>
</span><span id="Disulfide-1203"><a href="#Disulfide-1203"><span class="linenos">1203</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide-1204"><a href="#Disulfide-1204"><span class="linenos">1204</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&lt;Disulfide </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">, Source: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pdb_id</span><span class="si">}</span><span class="s1">, Resolution: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">resolution</span><span class="si">}</span><span class="s1"> Å&#39;</span>
</span><span id="Disulfide-1205"><a href="#Disulfide-1205"><span class="linenos">1205</span></a>        <span class="k">return</span> <span class="n">s1</span>
</span><span id="Disulfide-1206"><a href="#Disulfide-1206"><span class="linenos">1206</span></a>    
</span><span id="Disulfide-1207"><a href="#Disulfide-1207"><span class="linenos">1207</span></a>    <span class="k">def</span> <span class="nf">repr_ss_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide-1208"><a href="#Disulfide-1208"><span class="linenos">1208</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide-1209"><a href="#Disulfide-1209"><span class="linenos">1209</span></a><span class="sd">        Representation for Disulfide coordinates</span>
</span><span id="Disulfide-1210"><a href="#Disulfide-1210"><span class="linenos">1210</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide-1211"><a href="#Disulfide-1211"><span class="linenos">1211</span></a>        <span class="n">s2</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Proximal Coordinates:</span><span class="se">\n</span><span class="s1">   N: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   C: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">c_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   O: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">o_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cβ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Sγ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sg_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cprev </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">c_prev_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Nnext: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_next_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="Disulfide-1212"><a href="#Disulfide-1212"><span class="linenos">1212</span></a>        <span class="n">s3</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Distal Coordinates:</span><span class="se">\n</span><span class="s1">   N: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   C: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">c_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   O: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">o_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cβ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Sγ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sg_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cprev </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">c_prev_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Nnext: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_next_dist</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">&#39;</span>
</span><span id="Disulfide-1213"><a href="#Disulfide-1213"><span class="linenos">1213</span></a>        <span class="n">stot</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s2</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s3</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Disulfide-1214"><a href="#Disulfide-1214"><span class="linenos">1214</span></a>        <span class="k">return</span> <span class="n">stot</span>
</span><span id="Disulfide-1215"><a href="#Disulfide-1215"><span class="linenos">1215</span></a>
</span><span id="Disulfide-1216"><a href="#Disulfide-1216"><span class="linenos">1216</span></a>    <span class="k">def</span> <span class="nf">repr_ss_conformation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide-1217"><a href="#Disulfide-1217"><span class="linenos">1217</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide-1218"><a href="#Disulfide-1218"><span class="linenos">1218</span></a><span class="sd">        Representation for Disulfide conformation</span>
</span><span id="Disulfide-1219"><a href="#Disulfide-1219"><span class="linenos">1219</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide-1220"><a href="#Disulfide-1220"><span class="linenos">1220</span></a>        <span class="n">s4</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Χ1-Χ5: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">chi1</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">°, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">chi2</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">°, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">chi3</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">°, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">chi4</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">° </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">chi5</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">°, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">°, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol&#39;</span>
</span><span id="Disulfide-1221"><a href="#Disulfide-1221"><span class="linenos">1221</span></a>        <span class="n">stot</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s4</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Disulfide-1222"><a href="#Disulfide-1222"><span class="linenos">1222</span></a>        <span class="k">return</span> <span class="n">stot</span>
</span><span id="Disulfide-1223"><a href="#Disulfide-1223"><span class="linenos">1223</span></a>
</span><span id="Disulfide-1224"><a href="#Disulfide-1224"><span class="linenos">1224</span></a>    <span class="k">def</span> <span class="nf">repr_ss_local_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide-1225"><a href="#Disulfide-1225"><span class="linenos">1225</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide-1226"><a href="#Disulfide-1226"><span class="linenos">1226</span></a><span class="sd">        Representation for the Disulfide internal coordinates.</span>
</span><span id="Disulfide-1227"><a href="#Disulfide-1227"><span class="linenos">1227</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide-1228"><a href="#Disulfide-1228"><span class="linenos">1228</span></a>        <span class="n">s2i</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Proximal Internal Coords:</span><span class="se">\n</span><span class="s1">   N: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_ca_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   C: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   O: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_o_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cβ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_cb_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Sγ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_sg_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cprev </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">c_prev_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Nnext: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_next_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="Disulfide-1229"><a href="#Disulfide-1229"><span class="linenos">1229</span></a>        <span class="n">s3i</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Distal Internal Coords:</span><span class="se">\n</span><span class="s1">   N: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_ca_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   C: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   O: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_o_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cβ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_cb_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Sγ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_sg_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cprev </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">c_prev_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Nnext: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_next_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="Disulfide-1230"><a href="#Disulfide-1230"><span class="linenos">1230</span></a>        <span class="n">stot</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s2i</span><span class="si">}{</span><span class="n">s3i</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Disulfide-1231"><a href="#Disulfide-1231"><span class="linenos">1231</span></a>        <span class="k">return</span> <span class="n">stot</span>
</span><span id="Disulfide-1232"><a href="#Disulfide-1232"><span class="linenos">1232</span></a>    
</span><span id="Disulfide-1233"><a href="#Disulfide-1233"><span class="linenos">1233</span></a>    <span class="k">def</span> <span class="nf">repr_ss_chain_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide-1234"><a href="#Disulfide-1234"><span class="linenos">1234</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide-1235"><a href="#Disulfide-1235"><span class="linenos">1235</span></a><span class="sd">        Representation for Disulfide chain IDs</span>
</span><span id="Disulfide-1236"><a href="#Disulfide-1236"><span class="linenos">1236</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide-1237"><a href="#Disulfide-1237"><span class="linenos">1237</span></a>        <span class="k">return</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Proximal Chain fullID: &lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal_residue_fullid</span><span class="si">}</span><span class="s1">&gt; Distal Chain fullID: &lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal_residue_fullid</span><span class="si">}</span><span class="s1">&gt;&#39;</span><span class="p">)</span>
</span><span id="Disulfide-1238"><a href="#Disulfide-1238"><span class="linenos">1238</span></a>
</span><span id="Disulfide-1239"><a href="#Disulfide-1239"><span class="linenos">1239</span></a>    <span class="k">def</span> <span class="nf">repr_ss_ca_dist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide-1240"><a href="#Disulfide-1240"><span class="linenos">1240</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide-1241"><a href="#Disulfide-1241"><span class="linenos">1241</span></a><span class="sd">        Representation for Disulfide Ca distance</span>
</span><span id="Disulfide-1242"><a href="#Disulfide-1242"><span class="linenos">1242</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide-1243"><a href="#Disulfide-1243"><span class="linenos">1243</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Cα Distance: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å&#39;</span>
</span><span id="Disulfide-1244"><a href="#Disulfide-1244"><span class="linenos">1244</span></a>        <span class="k">return</span> <span class="n">s1</span>
</span><span id="Disulfide-1245"><a href="#Disulfide-1245"><span class="linenos">1245</span></a>    
</span><span id="Disulfide-1246"><a href="#Disulfide-1246"><span class="linenos">1246</span></a>    <span class="k">def</span> <span class="nf">repr_ss_cb_dist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide-1247"><a href="#Disulfide-1247"><span class="linenos">1247</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide-1248"><a href="#Disulfide-1248"><span class="linenos">1248</span></a><span class="sd">        Representation for Disulfide Ca distance</span>
</span><span id="Disulfide-1249"><a href="#Disulfide-1249"><span class="linenos">1249</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide-1250"><a href="#Disulfide-1250"><span class="linenos">1250</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Cβ Distance: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å&#39;</span>
</span><span id="Disulfide-1251"><a href="#Disulfide-1251"><span class="linenos">1251</span></a>        <span class="k">return</span> <span class="n">s1</span>
</span><span id="Disulfide-1252"><a href="#Disulfide-1252"><span class="linenos">1252</span></a>    
</span><span id="Disulfide-1253"><a href="#Disulfide-1253"><span class="linenos">1253</span></a>    <span class="k">def</span> <span class="nf">repr_ss_torsion_length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide-1254"><a href="#Disulfide-1254"><span class="linenos">1254</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide-1255"><a href="#Disulfide-1255"><span class="linenos">1255</span></a><span class="sd">        Representation for Disulfide torsion length</span>
</span><span id="Disulfide-1256"><a href="#Disulfide-1256"><span class="linenos">1256</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide-1257"><a href="#Disulfide-1257"><span class="linenos">1257</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Torsion length: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> deg&#39;</span>
</span><span id="Disulfide-1258"><a href="#Disulfide-1258"><span class="linenos">1258</span></a>        <span class="k">return</span> <span class="n">s1</span>
</span><span id="Disulfide-1259"><a href="#Disulfide-1259"><span class="linenos">1259</span></a>    
</span><span id="Disulfide-1260"><a href="#Disulfide-1260"><span class="linenos">1260</span></a>    <span class="k">def</span> <span class="nf">repr_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Disulfide-1261"><a href="#Disulfide-1261"><span class="linenos">1261</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide-1262"><a href="#Disulfide-1262"><span class="linenos">1262</span></a><span class="sd">        Return a string representation for all Disulfide information</span>
</span><span id="Disulfide-1263"><a href="#Disulfide-1263"><span class="linenos">1263</span></a><span class="sd">        contained in self.</span>
</span><span id="Disulfide-1264"><a href="#Disulfide-1264"><span class="linenos">1264</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide-1265"><a href="#Disulfide-1265"><span class="linenos">1265</span></a>        
</span><span id="Disulfide-1266"><a href="#Disulfide-1266"><span class="linenos">1266</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_info</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="Disulfide-1267"><a href="#Disulfide-1267"><span class="linenos">1267</span></a>        <span class="n">s2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_coords</span><span class="p">()</span>
</span><span id="Disulfide-1268"><a href="#Disulfide-1268"><span class="linenos">1268</span></a>        <span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_local_coords</span><span class="p">()</span>
</span><span id="Disulfide-1269"><a href="#Disulfide-1269"><span class="linenos">1269</span></a>        <span class="n">s4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_conformation</span><span class="p">()</span>
</span><span id="Disulfide-1270"><a href="#Disulfide-1270"><span class="linenos">1270</span></a>        <span class="n">s5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_chain_ids</span><span class="p">()</span>
</span><span id="Disulfide-1271"><a href="#Disulfide-1271"><span class="linenos">1271</span></a>        <span class="n">s6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_ca_dist</span><span class="p">()</span>
</span><span id="Disulfide-1272"><a href="#Disulfide-1272"><span class="linenos">1272</span></a>        <span class="n">s8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_cb_dist</span><span class="p">()</span>
</span><span id="Disulfide-1273"><a href="#Disulfide-1273"><span class="linenos">1273</span></a>        <span class="n">s7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_torsion_length</span><span class="p">()</span>
</span><span id="Disulfide-1274"><a href="#Disulfide-1274"><span class="linenos">1274</span></a>
</span><span id="Disulfide-1275"><a href="#Disulfide-1275"><span class="linenos">1275</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s1</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s5</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s2</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s3</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s4</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s6</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s7</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s8</span><span class="si">}</span><span class="s1">&gt;&#39;</span>
</span><span id="Disulfide-1276"><a href="#Disulfide-1276"><span class="linenos">1276</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="Disulfide-1277"><a href="#Disulfide-1277"><span class="linenos">1277</span></a>    
</span><span id="Disulfide-1278"><a href="#Disulfide-1278"><span class="linenos">1278</span></a>    <span class="k">def</span> <span class="nf">repr_compact</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Disulfide-1279"><a href="#Disulfide-1279"><span class="linenos">1279</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-1280"><a href="#Disulfide-1280"><span class="linenos">1280</span></a><span class="sd">        Return a compact representation of the Disulfide object</span>
</span><span id="Disulfide-1281"><a href="#Disulfide-1281"><span class="linenos">1281</span></a><span class="sd">        :return: string</span>
</span><span id="Disulfide-1282"><a href="#Disulfide-1282"><span class="linenos">1282</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-1283"><a href="#Disulfide-1283"><span class="linenos">1283</span></a>        <span class="k">return</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_info</span><span class="p">()</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_conformation</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Disulfide-1284"><a href="#Disulfide-1284"><span class="linenos">1284</span></a>
</span><span id="Disulfide-1285"><a href="#Disulfide-1285"><span class="linenos">1285</span></a>    <span class="k">def</span> <span class="nf">repr_conformation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide-1286"><a href="#Disulfide-1286"><span class="linenos">1286</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-1287"><a href="#Disulfide-1287"><span class="linenos">1287</span></a><span class="sd">        Return a string representation of the Disulfide object&#39;s conformation.</span>
</span><span id="Disulfide-1288"><a href="#Disulfide-1288"><span class="linenos">1288</span></a><span class="sd">        :return: string</span>
</span><span id="Disulfide-1289"><a href="#Disulfide-1289"><span class="linenos">1289</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-1290"><a href="#Disulfide-1290"><span class="linenos">1290</span></a>        <span class="k">return</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_conformation</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Disulfide-1291"><a href="#Disulfide-1291"><span class="linenos">1291</span></a>    
</span><span id="Disulfide-1292"><a href="#Disulfide-1292"><span class="linenos">1292</span></a>    <span class="k">def</span> <span class="nf">repr_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide-1293"><a href="#Disulfide-1293"><span class="linenos">1293</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-1294"><a href="#Disulfide-1294"><span class="linenos">1294</span></a><span class="sd">        Return a string representation of the Disulfide object&#39;s coordinates.</span>
</span><span id="Disulfide-1295"><a href="#Disulfide-1295"><span class="linenos">1295</span></a><span class="sd">        :return: string</span>
</span><span id="Disulfide-1296"><a href="#Disulfide-1296"><span class="linenos">1296</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-1297"><a href="#Disulfide-1297"><span class="linenos">1297</span></a>        <span class="k">return</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_coords</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Disulfide-1298"><a href="#Disulfide-1298"><span class="linenos">1298</span></a>
</span><span id="Disulfide-1299"><a href="#Disulfide-1299"><span class="linenos">1299</span></a>    <span class="k">def</span> <span class="nf">repr_internal_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide-1300"><a href="#Disulfide-1300"><span class="linenos">1300</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-1301"><a href="#Disulfide-1301"><span class="linenos">1301</span></a><span class="sd">        Return a string representation of the Disulfide object&#39;s internal coordinaes.</span>
</span><span id="Disulfide-1302"><a href="#Disulfide-1302"><span class="linenos">1302</span></a><span class="sd">        :return: string</span>
</span><span id="Disulfide-1303"><a href="#Disulfide-1303"><span class="linenos">1303</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-1304"><a href="#Disulfide-1304"><span class="linenos">1304</span></a>        <span class="k">return</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_local_coords</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Disulfide-1305"><a href="#Disulfide-1305"><span class="linenos">1305</span></a>
</span><span id="Disulfide-1306"><a href="#Disulfide-1306"><span class="linenos">1306</span></a>    <span class="k">def</span> <span class="nf">repr_chain_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide-1307"><a href="#Disulfide-1307"><span class="linenos">1307</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-1308"><a href="#Disulfide-1308"><span class="linenos">1308</span></a><span class="sd">        Return a string representation of the Disulfide object&#39;s chain ids.</span>
</span><span id="Disulfide-1309"><a href="#Disulfide-1309"><span class="linenos">1309</span></a><span class="sd">        :return: string</span>
</span><span id="Disulfide-1310"><a href="#Disulfide-1310"><span class="linenos">1310</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-1311"><a href="#Disulfide-1311"><span class="linenos">1311</span></a>        <span class="k">return</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_chain_ids</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Disulfide-1312"><a href="#Disulfide-1312"><span class="linenos">1312</span></a>
</span><span id="Disulfide-1313"><a href="#Disulfide-1313"><span class="linenos">1313</span></a>    <span class="k">def</span> <span class="nf">compute_rho</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide-1314"><a href="#Disulfide-1314"><span class="linenos">1314</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span> <span class="n">calc_dihedral</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_prox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_dist</span><span class="p">)</span>
</span><span id="Disulfide-1315"><a href="#Disulfide-1315"><span class="linenos">1315</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span>
</span><span id="Disulfide-1316"><a href="#Disulfide-1316"><span class="linenos">1316</span></a>
</span><span id="Disulfide-1317"><a href="#Disulfide-1317"><span class="linenos">1317</span></a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Disulfide-1318"><a href="#Disulfide-1318"><span class="linenos">1318</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-1319"><a href="#Disulfide-1319"><span class="linenos">1319</span></a><span class="sd">        Resets the disulfide object to its initial state. All distances, </span>
</span><span id="Disulfide-1320"><a href="#Disulfide-1320"><span class="linenos">1320</span></a><span class="sd">        angles and positions are reset. The name is unchanged.</span>
</span><span id="Disulfide-1321"><a href="#Disulfide-1321"><span class="linenos">1321</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-1322"><a href="#Disulfide-1322"><span class="linenos">1322</span></a>        <span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Disulfide-1323"><a href="#Disulfide-1323"><span class="linenos">1323</span></a>        
</span><span id="Disulfide-1324"><a href="#Disulfide-1324"><span class="linenos">1324</span></a>    <span class="k">def</span> <span class="nf">same_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Disulfide-1325"><a href="#Disulfide-1325"><span class="linenos">1325</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-1326"><a href="#Disulfide-1326"><span class="linenos">1326</span></a><span class="sd">        Function checks if the Disulfide is cross-chain or not.</span>
</span><span id="Disulfide-1327"><a href="#Disulfide-1327"><span class="linenos">1327</span></a>
</span><span id="Disulfide-1328"><a href="#Disulfide-1328"><span class="linenos">1328</span></a><span class="sd">        Returns</span>
</span><span id="Disulfide-1329"><a href="#Disulfide-1329"><span class="linenos">1329</span></a><span class="sd">        -------</span>
</span><span id="Disulfide-1330"><a href="#Disulfide-1330"><span class="linenos">1330</span></a><span class="sd">        bool \n</span>
</span><span id="Disulfide-1331"><a href="#Disulfide-1331"><span class="linenos">1331</span></a><span class="sd">            True if the proximal and distal residues are on the same chains,</span>
</span><span id="Disulfide-1332"><a href="#Disulfide-1332"><span class="linenos">1332</span></a><span class="sd">            False otherwise.</span>
</span><span id="Disulfide-1333"><a href="#Disulfide-1333"><span class="linenos">1333</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-1334"><a href="#Disulfide-1334"><span class="linenos">1334</span></a>
</span><span id="Disulfide-1335"><a href="#Disulfide-1335"><span class="linenos">1335</span></a>        <span class="p">(</span><span class="n">prox</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_chains</span><span class="p">()</span>
</span><span id="Disulfide-1336"><a href="#Disulfide-1336"><span class="linenos">1336</span></a>        <span class="k">return</span> <span class="n">prox</span> <span class="o">==</span> <span class="n">dist</span>
</span><span id="Disulfide-1337"><a href="#Disulfide-1337"><span class="linenos">1337</span></a>
</span><span id="Disulfide-1338"><a href="#Disulfide-1338"><span class="linenos">1338</span></a>    <span class="k">def</span> <span class="nf">screenshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;ssbond.png&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shadows</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">light</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Disulfide-1339"><a href="#Disulfide-1339"><span class="linenos">1339</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-1340"><a href="#Disulfide-1340"><span class="linenos">1340</span></a><span class="sd">        Create and save a screenshot of the Disulfide in the given style</span>
</span><span id="Disulfide-1341"><a href="#Disulfide-1341"><span class="linenos">1341</span></a><span class="sd">        and filename</span>
</span><span id="Disulfide-1342"><a href="#Disulfide-1342"><span class="linenos">1342</span></a>
</span><span id="Disulfide-1343"><a href="#Disulfide-1343"><span class="linenos">1343</span></a><span class="sd">        :param single: Display a single vs panel view, defaults to True</span>
</span><span id="Disulfide-1344"><a href="#Disulfide-1344"><span class="linenos">1344</span></a><span class="sd">        :param style: Rendering style, one of:</span>
</span><span id="Disulfide-1345"><a href="#Disulfide-1345"><span class="linenos">1345</span></a><span class="sd">        * &#39;sb&#39; - split bonds</span>
</span><span id="Disulfide-1346"><a href="#Disulfide-1346"><span class="linenos">1346</span></a><span class="sd">        * &#39;bs&#39; - ball and stick</span>
</span><span id="Disulfide-1347"><a href="#Disulfide-1347"><span class="linenos">1347</span></a><span class="sd">        * &#39;cpk&#39; - CPK style</span>
</span><span id="Disulfide-1348"><a href="#Disulfide-1348"><span class="linenos">1348</span></a><span class="sd">        * &#39;pd&#39; - Proximal/Distal style - Red=proximal, Green=Distal</span>
</span><span id="Disulfide-1349"><a href="#Disulfide-1349"><span class="linenos">1349</span></a><span class="sd">        * &#39;plain&#39; - boring single color,</span>
</span><span id="Disulfide-1350"><a href="#Disulfide-1350"><span class="linenos">1350</span></a><span class="sd">        :param fname: output filename,, defaults to &#39;ssbond.png&#39;</span>
</span><span id="Disulfide-1351"><a href="#Disulfide-1351"><span class="linenos">1351</span></a><span class="sd">        :param verbose: Verbosit, defaults to False</span>
</span><span id="Disulfide-1352"><a href="#Disulfide-1352"><span class="linenos">1352</span></a><span class="sd">        :param shadows: Enable shadows, defaults to False</span>
</span><span id="Disulfide-1353"><a href="#Disulfide-1353"><span class="linenos">1353</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-1354"><a href="#Disulfide-1354"><span class="linenos">1354</span></a>        <span class="n">src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="Disulfide-1355"><a href="#Disulfide-1355"><span class="linenos">1355</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
</span><span id="Disulfide-1356"><a href="#Disulfide-1356"><span class="linenos">1356</span></a>        <span class="n">enrg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span>
</span><span id="Disulfide-1357"><a href="#Disulfide-1357"><span class="linenos">1357</span></a>
</span><span id="Disulfide-1358"><a href="#Disulfide-1358"><span class="linenos">1358</span></a>        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">src</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal_chain</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal_chain</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">enrg</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol, Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å, Cβ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å, Tors: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Disulfide-1359"><a href="#Disulfide-1359"><span class="linenos">1359</span></a>
</span><span id="Disulfide-1360"><a href="#Disulfide-1360"><span class="linenos">1360</span></a>        <span class="k">if</span> <span class="n">light</span><span class="p">:</span>
</span><span id="Disulfide-1361"><a href="#Disulfide-1361"><span class="linenos">1361</span></a>            <span class="n">pv</span><span class="o">.</span><span class="n">set_plot_theme</span><span class="p">(</span><span class="s1">&#39;document&#39;</span><span class="p">)</span>
</span><span id="Disulfide-1362"><a href="#Disulfide-1362"><span class="linenos">1362</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Disulfide-1363"><a href="#Disulfide-1363"><span class="linenos">1363</span></a>            <span class="n">pv</span><span class="o">.</span><span class="n">set_plot_theme</span><span class="p">(</span><span class="s1">&#39;dark&#39;</span><span class="p">)</span>
</span><span id="Disulfide-1364"><a href="#Disulfide-1364"><span class="linenos">1364</span></a>            
</span><span id="Disulfide-1365"><a href="#Disulfide-1365"><span class="linenos">1365</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Disulfide-1366"><a href="#Disulfide-1366"><span class="linenos">1366</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; screenshot(): Rendering screenshot to file </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Disulfide-1367"><a href="#Disulfide-1367"><span class="linenos">1367</span></a>
</span><span id="Disulfide-1368"><a href="#Disulfide-1368"><span class="linenos">1368</span></a>        <span class="k">if</span> <span class="n">single</span><span class="p">:</span>
</span><span id="Disulfide-1369"><a href="#Disulfide-1369"><span class="linenos">1369</span></a>            <span class="n">pl</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="n">WINSIZE</span><span class="p">)</span>
</span><span id="Disulfide-1370"><a href="#Disulfide-1370"><span class="linenos">1370</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide-1371"><a href="#Disulfide-1371"><span class="linenos">1371</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">enable_anti_aliasing</span><span class="p">(</span><span class="s1">&#39;msaa&#39;</span><span class="p">)</span>
</span><span id="Disulfide-1372"><a href="#Disulfide-1372"><span class="linenos">1372</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_camera_orientation_widget</span><span class="p">()</span>
</span><span id="Disulfide-1373"><a href="#Disulfide-1373"><span class="linenos">1373</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="Disulfide-1374"><a href="#Disulfide-1374"><span class="linenos">1374</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="Disulfide-1375"><a href="#Disulfide-1375"><span class="linenos">1375</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="Disulfide-1376"><a href="#Disulfide-1376"><span class="linenos">1376</span></a>            <span class="k">if</span> <span class="n">shadows</span><span class="p">:</span>
</span><span id="Disulfide-1377"><a href="#Disulfide-1377"><span class="linenos">1377</span></a>                <span class="n">pl</span><span class="o">.</span><span class="n">enable_shadows</span><span class="p">()</span>
</span><span id="Disulfide-1378"><a href="#Disulfide-1378"><span class="linenos">1378</span></a>            
</span><span id="Disulfide-1379"><a href="#Disulfide-1379"><span class="linenos">1379</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">auto_close</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Disulfide-1380"><a href="#Disulfide-1380"><span class="linenos">1380</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">screenshot</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
</span><span id="Disulfide-1381"><a href="#Disulfide-1381"><span class="linenos">1381</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="Disulfide-1382"><a href="#Disulfide-1382"><span class="linenos">1382</span></a>
</span><span id="Disulfide-1383"><a href="#Disulfide-1383"><span class="linenos">1383</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Disulfide-1384"><a href="#Disulfide-1384"><span class="linenos">1384</span></a>            <span class="n">pl</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="n">WINSIZE</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</span><span id="Disulfide-1385"><a href="#Disulfide-1385"><span class="linenos">1385</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-1386"><a href="#Disulfide-1386"><span class="linenos">1386</span></a>            
</span><span id="Disulfide-1387"><a href="#Disulfide-1387"><span class="linenos">1387</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide-1388"><a href="#Disulfide-1388"><span class="linenos">1388</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">enable_anti_aliasing</span><span class="p">(</span><span class="s1">&#39;msaa&#39;</span><span class="p">)</span>
</span><span id="Disulfide-1389"><a href="#Disulfide-1389"><span class="linenos">1389</span></a>
</span><span id="Disulfide-1390"><a href="#Disulfide-1390"><span class="linenos">1390</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_camera_orientation_widget</span><span class="p">()</span>
</span><span id="Disulfide-1391"><a href="#Disulfide-1391"><span class="linenos">1391</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;cpk&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="Disulfide-1392"><a href="#Disulfide-1392"><span class="linenos">1392</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="Disulfide-1393"><a href="#Disulfide-1393"><span class="linenos">1393</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="Disulfide-1394"><a href="#Disulfide-1394"><span class="linenos">1394</span></a>
</span><span id="Disulfide-1395"><a href="#Disulfide-1395"><span class="linenos">1395</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Disulfide-1396"><a href="#Disulfide-1396"><span class="linenos">1396</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide-1397"><a href="#Disulfide-1397"><span class="linenos">1397</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;pd&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="Disulfide-1398"><a href="#Disulfide-1398"><span class="linenos">1398</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="Disulfide-1399"><a href="#Disulfide-1399"><span class="linenos">1399</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="Disulfide-1400"><a href="#Disulfide-1400"><span class="linenos">1400</span></a>
</span><span id="Disulfide-1401"><a href="#Disulfide-1401"><span class="linenos">1401</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide-1402"><a href="#Disulfide-1402"><span class="linenos">1402</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide-1403"><a href="#Disulfide-1403"><span class="linenos">1403</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;bs&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="Disulfide-1404"><a href="#Disulfide-1404"><span class="linenos">1404</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="Disulfide-1405"><a href="#Disulfide-1405"><span class="linenos">1405</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="Disulfide-1406"><a href="#Disulfide-1406"><span class="linenos">1406</span></a>            
</span><span id="Disulfide-1407"><a href="#Disulfide-1407"><span class="linenos">1407</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Disulfide-1408"><a href="#Disulfide-1408"><span class="linenos">1408</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide-1409"><a href="#Disulfide-1409"><span class="linenos">1409</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="Disulfide-1410"><a href="#Disulfide-1410"><span class="linenos">1410</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="Disulfide-1411"><a href="#Disulfide-1411"><span class="linenos">1411</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="Disulfide-1412"><a href="#Disulfide-1412"><span class="linenos">1412</span></a>
</span><span id="Disulfide-1413"><a href="#Disulfide-1413"><span class="linenos">1413</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">link_views</span><span class="p">()</span>
</span><span id="Disulfide-1414"><a href="#Disulfide-1414"><span class="linenos">1414</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="Disulfide-1415"><a href="#Disulfide-1415"><span class="linenos">1415</span></a>            <span class="k">if</span> <span class="n">shadows</span><span class="p">:</span>
</span><span id="Disulfide-1416"><a href="#Disulfide-1416"><span class="linenos">1416</span></a>                <span class="n">pl</span><span class="o">.</span><span class="n">enable_shadows</span><span class="p">()</span>
</span><span id="Disulfide-1417"><a href="#Disulfide-1417"><span class="linenos">1417</span></a>
</span><span id="Disulfide-1418"><a href="#Disulfide-1418"><span class="linenos">1418</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">auto_close</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Disulfide-1419"><a href="#Disulfide-1419"><span class="linenos">1419</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">screenshot</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
</span><span id="Disulfide-1420"><a href="#Disulfide-1420"><span class="linenos">1420</span></a>        
</span><span id="Disulfide-1421"><a href="#Disulfide-1421"><span class="linenos">1421</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Disulfide-1422"><a href="#Disulfide-1422"><span class="linenos">1422</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Saved: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Disulfide-1423"><a href="#Disulfide-1423"><span class="linenos">1423</span></a>    
</span><span id="Disulfide-1424"><a href="#Disulfide-1424"><span class="linenos">1424</span></a>    <span class="k">def</span> <span class="nf">set_permissive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">perm</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Disulfide-1425"><a href="#Disulfide-1425"><span class="linenos">1425</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-1426"><a href="#Disulfide-1426"><span class="linenos">1426</span></a><span class="sd">        Sets PERMISSIVE flag for Disulfide parsing</span>
</span><span id="Disulfide-1427"><a href="#Disulfide-1427"><span class="linenos">1427</span></a><span class="sd">        :return: None</span>
</span><span id="Disulfide-1428"><a href="#Disulfide-1428"><span class="linenos">1428</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-1429"><a href="#Disulfide-1429"><span class="linenos">1429</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">PERMISSIVE</span> <span class="o">=</span> <span class="n">perm</span>
</span><span id="Disulfide-1430"><a href="#Disulfide-1430"><span class="linenos">1430</span></a>
</span><span id="Disulfide-1431"><a href="#Disulfide-1431"><span class="linenos">1431</span></a>    <span class="k">def</span> <span class="nf">set_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">ca_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">c_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span>
</span><span id="Disulfide-1432"><a href="#Disulfide-1432"><span class="linenos">1432</span></a>                      <span class="n">o_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">cb_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">sg_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> 
</span><span id="Disulfide-1433"><a href="#Disulfide-1433"><span class="linenos">1433</span></a>                      <span class="n">n_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">ca_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">c_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span>
</span><span id="Disulfide-1434"><a href="#Disulfide-1434"><span class="linenos">1434</span></a>                      <span class="n">o_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">cb_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">sg_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span>
</span><span id="Disulfide-1435"><a href="#Disulfide-1435"><span class="linenos">1435</span></a>                      <span class="n">c_prev_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">n_next_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span>
</span><span id="Disulfide-1436"><a href="#Disulfide-1436"><span class="linenos">1436</span></a>                      <span class="n">c_prev_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">n_next_dist</span><span class="p">:</span> <span class="n">Vector</span>
</span><span id="Disulfide-1437"><a href="#Disulfide-1437"><span class="linenos">1437</span></a>                      <span class="p">):</span>
</span><span id="Disulfide-1438"><a href="#Disulfide-1438"><span class="linenos">1438</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-1439"><a href="#Disulfide-1439"><span class="linenos">1439</span></a><span class="sd">        Set the atomic coordinates for all atoms in the Disulfide object.</span>
</span><span id="Disulfide-1440"><a href="#Disulfide-1440"><span class="linenos">1440</span></a>
</span><span id="Disulfide-1441"><a href="#Disulfide-1441"><span class="linenos">1441</span></a><span class="sd">        :param n_prox: Proximal N position</span>
</span><span id="Disulfide-1442"><a href="#Disulfide-1442"><span class="linenos">1442</span></a><span class="sd">        :param ca_prox: Proximal Cα position</span>
</span><span id="Disulfide-1443"><a href="#Disulfide-1443"><span class="linenos">1443</span></a><span class="sd">        :param c_prox: Proximal C&#39; position</span>
</span><span id="Disulfide-1444"><a href="#Disulfide-1444"><span class="linenos">1444</span></a><span class="sd">        :param o_prox: Proximal O position</span>
</span><span id="Disulfide-1445"><a href="#Disulfide-1445"><span class="linenos">1445</span></a><span class="sd">        :param cb_prox: Proximal Cβ position</span>
</span><span id="Disulfide-1446"><a href="#Disulfide-1446"><span class="linenos">1446</span></a><span class="sd">        :param sg_prox: Proximal Sγ position</span>
</span><span id="Disulfide-1447"><a href="#Disulfide-1447"><span class="linenos">1447</span></a><span class="sd">        :param n_dist: Distal N position</span>
</span><span id="Disulfide-1448"><a href="#Disulfide-1448"><span class="linenos">1448</span></a><span class="sd">        :param ca_dist: Distal Cα position</span>
</span><span id="Disulfide-1449"><a href="#Disulfide-1449"><span class="linenos">1449</span></a><span class="sd">        :param c_dist: Distal C&#39; position</span>
</span><span id="Disulfide-1450"><a href="#Disulfide-1450"><span class="linenos">1450</span></a><span class="sd">        :param o_dist: Distal O position</span>
</span><span id="Disulfide-1451"><a href="#Disulfide-1451"><span class="linenos">1451</span></a><span class="sd">        :param cb_dist: Distal Cβ position</span>
</span><span id="Disulfide-1452"><a href="#Disulfide-1452"><span class="linenos">1452</span></a><span class="sd">        :param sg_dist: Distal Sγ position</span>
</span><span id="Disulfide-1453"><a href="#Disulfide-1453"><span class="linenos">1453</span></a><span class="sd">        :param c_prev_prox: Proximal previous C&#39;</span>
</span><span id="Disulfide-1454"><a href="#Disulfide-1454"><span class="linenos">1454</span></a><span class="sd">        :param n_next_prox: Proximal next N</span>
</span><span id="Disulfide-1455"><a href="#Disulfide-1455"><span class="linenos">1455</span></a><span class="sd">        :param c_prev_dist: Distal previous C&#39;</span>
</span><span id="Disulfide-1456"><a href="#Disulfide-1456"><span class="linenos">1456</span></a><span class="sd">        :param n_next_dist: Distal next N</span>
</span><span id="Disulfide-1457"><a href="#Disulfide-1457"><span class="linenos">1457</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-1458"><a href="#Disulfide-1458"><span class="linenos">1458</span></a>        
</span><span id="Disulfide-1459"><a href="#Disulfide-1459"><span class="linenos">1459</span></a>        <span class="c1"># deep copy</span>
</span><span id="Disulfide-1460"><a href="#Disulfide-1460"><span class="linenos">1460</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_prox</span> <span class="o">=</span> <span class="n">n_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide-1461"><a href="#Disulfide-1461"><span class="linenos">1461</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span> <span class="o">=</span> <span class="n">ca_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide-1462"><a href="#Disulfide-1462"><span class="linenos">1462</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prox</span> <span class="o">=</span> <span class="n">c_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide-1463"><a href="#Disulfide-1463"><span class="linenos">1463</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">o_prox</span> <span class="o">=</span> <span class="n">o_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide-1464"><a href="#Disulfide-1464"><span class="linenos">1464</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span> <span class="o">=</span> <span class="n">cb_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide-1465"><a href="#Disulfide-1465"><span class="linenos">1465</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_prox</span> <span class="o">=</span> <span class="n">sg_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide-1466"><a href="#Disulfide-1466"><span class="linenos">1466</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_dist</span> <span class="o">=</span> <span class="n">sg_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide-1467"><a href="#Disulfide-1467"><span class="linenos">1467</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_dist</span> <span class="o">=</span> <span class="n">cb_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide-1468"><a href="#Disulfide-1468"><span class="linenos">1468</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span> <span class="o">=</span> <span class="n">ca_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide-1469"><a href="#Disulfide-1469"><span class="linenos">1469</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_dist</span> <span class="o">=</span> <span class="n">n_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide-1470"><a href="#Disulfide-1470"><span class="linenos">1470</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_dist</span> <span class="o">=</span> <span class="n">c_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide-1471"><a href="#Disulfide-1471"><span class="linenos">1471</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">o_dist</span> <span class="o">=</span> <span class="n">o_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide-1472"><a href="#Disulfide-1472"><span class="linenos">1472</span></a>
</span><span id="Disulfide-1473"><a href="#Disulfide-1473"><span class="linenos">1473</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prev_prox</span> <span class="o">=</span> <span class="n">c_prev_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide-1474"><a href="#Disulfide-1474"><span class="linenos">1474</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_next_prox</span> <span class="o">=</span> <span class="n">n_next_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide-1475"><a href="#Disulfide-1475"><span class="linenos">1475</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prev_dist</span> <span class="o">=</span> <span class="n">c_prev_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide-1476"><a href="#Disulfide-1476"><span class="linenos">1476</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_next_dist</span> <span class="o">=</span> <span class="n">n_next_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide-1477"><a href="#Disulfide-1477"><span class="linenos">1477</span></a>       
</span><span id="Disulfide-1478"><a href="#Disulfide-1478"><span class="linenos">1478</span></a>    <span class="k">def</span> <span class="nf">set_dihedrals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chi1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">chi2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">chi3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="Disulfide-1479"><a href="#Disulfide-1479"><span class="linenos">1479</span></a>                    <span class="n">chi4</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">chi5</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="Disulfide-1480"><a href="#Disulfide-1480"><span class="linenos">1480</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-1481"><a href="#Disulfide-1481"><span class="linenos">1481</span></a><span class="sd">        Set the disulfide&#39;s dihedral angles, Chi1-Chi5. -180 - 180 degrees.</span>
</span><span id="Disulfide-1482"><a href="#Disulfide-1482"><span class="linenos">1482</span></a>
</span><span id="Disulfide-1483"><a href="#Disulfide-1483"><span class="linenos">1483</span></a><span class="sd">        :param chi1: Chi1</span>
</span><span id="Disulfide-1484"><a href="#Disulfide-1484"><span class="linenos">1484</span></a><span class="sd">        :param chi2: Chi2</span>
</span><span id="Disulfide-1485"><a href="#Disulfide-1485"><span class="linenos">1485</span></a><span class="sd">        :param chi3: Chi3</span>
</span><span id="Disulfide-1486"><a href="#Disulfide-1486"><span class="linenos">1486</span></a><span class="sd">        :param chi4: Chi4</span>
</span><span id="Disulfide-1487"><a href="#Disulfide-1487"><span class="linenos">1487</span></a><span class="sd">        :param chi5: Chi5</span>
</span><span id="Disulfide-1488"><a href="#Disulfide-1488"><span class="linenos">1488</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-1489"><a href="#Disulfide-1489"><span class="linenos">1489</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi1</span> <span class="o">=</span> <span class="n">chi1</span>
</span><span id="Disulfide-1490"><a href="#Disulfide-1490"><span class="linenos">1490</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi2</span> <span class="o">=</span> <span class="n">chi2</span>
</span><span id="Disulfide-1491"><a href="#Disulfide-1491"><span class="linenos">1491</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span> <span class="o">=</span> <span class="n">chi3</span>
</span><span id="Disulfide-1492"><a href="#Disulfide-1492"><span class="linenos">1492</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi4</span> <span class="o">=</span> <span class="n">chi4</span>
</span><span id="Disulfide-1493"><a href="#Disulfide-1493"><span class="linenos">1493</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi5</span> <span class="o">=</span> <span class="n">chi5</span>
</span><span id="Disulfide-1494"><a href="#Disulfide-1494"><span class="linenos">1494</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="p">,</span> <span class="n">chi3</span><span class="p">,</span> <span class="n">chi4</span><span class="p">,</span> <span class="n">chi5</span><span class="p">])</span>
</span><span id="Disulfide-1495"><a href="#Disulfide-1495"><span class="linenos">1495</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">compute_torsional_energy</span><span class="p">()</span>
</span><span id="Disulfide-1496"><a href="#Disulfide-1496"><span class="linenos">1496</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Torsion_Length</span><span class="p">()</span>
</span><span id="Disulfide-1497"><a href="#Disulfide-1497"><span class="linenos">1497</span></a>
</span><span id="Disulfide-1498"><a href="#Disulfide-1498"><span class="linenos">1498</span></a>    <span class="k">def</span> <span class="nf">set_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">namestr</span><span class="o">=</span><span class="s2">&quot;Disulfide&quot;</span><span class="p">):</span>
</span><span id="Disulfide-1499"><a href="#Disulfide-1499"><span class="linenos">1499</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-1500"><a href="#Disulfide-1500"><span class="linenos">1500</span></a><span class="sd">        Set&#39;s the Disulfide&#39;s name</span>
</span><span id="Disulfide-1501"><a href="#Disulfide-1501"><span class="linenos">1501</span></a>
</span><span id="Disulfide-1502"><a href="#Disulfide-1502"><span class="linenos">1502</span></a><span class="sd">        :param namestr: Name, by default &quot;Disulfide&quot;</span>
</span><span id="Disulfide-1503"><a href="#Disulfide-1503"><span class="linenos">1503</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-1504"><a href="#Disulfide-1504"><span class="linenos">1504</span></a>
</span><span id="Disulfide-1505"><a href="#Disulfide-1505"><span class="linenos">1505</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">namestr</span>
</span><span id="Disulfide-1506"><a href="#Disulfide-1506"><span class="linenos">1506</span></a>
</span><span id="Disulfide-1507"><a href="#Disulfide-1507"><span class="linenos">1507</span></a>    <span class="k">def</span> <span class="nf">set_resnum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proximal</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">distal</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Disulfide-1508"><a href="#Disulfide-1508"><span class="linenos">1508</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-1509"><a href="#Disulfide-1509"><span class="linenos">1509</span></a><span class="sd">        Set the proximal and residue numbers for the Disulfide.</span>
</span><span id="Disulfide-1510"><a href="#Disulfide-1510"><span class="linenos">1510</span></a>
</span><span id="Disulfide-1511"><a href="#Disulfide-1511"><span class="linenos">1511</span></a><span class="sd">        :param proximal: Proximal residue number</span>
</span><span id="Disulfide-1512"><a href="#Disulfide-1512"><span class="linenos">1512</span></a><span class="sd">        :param distal: Distal residue number</span>
</span><span id="Disulfide-1513"><a href="#Disulfide-1513"><span class="linenos">1513</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-1514"><a href="#Disulfide-1514"><span class="linenos">1514</span></a>
</span><span id="Disulfide-1515"><a href="#Disulfide-1515"><span class="linenos">1515</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal</span> <span class="o">=</span> <span class="n">proximal</span>
</span><span id="Disulfide-1516"><a href="#Disulfide-1516"><span class="linenos">1516</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal</span> <span class="o">=</span> <span class="n">distal</span>
</span><span id="Disulfide-1517"><a href="#Disulfide-1517"><span class="linenos">1517</span></a>
</span><span id="Disulfide-1518"><a href="#Disulfide-1518"><span class="linenos">1518</span></a>    <span class="k">def</span> <span class="nf">Torsion_Length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Disulfide-1519"><a href="#Disulfide-1519"><span class="linenos">1519</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-1520"><a href="#Disulfide-1520"><span class="linenos">1520</span></a><span class="sd">        Compute the 5D Euclidean length of the Disulfide object</span>
</span><span id="Disulfide-1521"><a href="#Disulfide-1521"><span class="linenos">1521</span></a><span class="sd">        and update the Disulfide internal state.</span>
</span><span id="Disulfide-1522"><a href="#Disulfide-1522"><span class="linenos">1522</span></a>
</span><span id="Disulfide-1523"><a href="#Disulfide-1523"><span class="linenos">1523</span></a><span class="sd">        :return: Torsion length (Degrees)</span>
</span><span id="Disulfide-1524"><a href="#Disulfide-1524"><span class="linenos">1524</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-1525"><a href="#Disulfide-1525"><span class="linenos">1525</span></a>
</span><span id="Disulfide-1526"><a href="#Disulfide-1526"><span class="linenos">1526</span></a>        <span class="c1"># Use numpy array to compute element-wise square</span>
</span><span id="Disulfide-1527"><a href="#Disulfide-1527"><span class="linenos">1527</span></a>        <span class="n">tors2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span><span class="p">)</span>
</span><span id="Disulfide-1528"><a href="#Disulfide-1528"><span class="linenos">1528</span></a>
</span><span id="Disulfide-1529"><a href="#Disulfide-1529"><span class="linenos">1529</span></a>        <span class="c1"># Compute the sum of squares using numpy&#39;s sum function</span>
</span><span id="Disulfide-1530"><a href="#Disulfide-1530"><span class="linenos">1530</span></a>        <span class="n">dist</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">tors2</span><span class="p">))</span>
</span><span id="Disulfide-1531"><a href="#Disulfide-1531"><span class="linenos">1531</span></a>
</span><span id="Disulfide-1532"><a href="#Disulfide-1532"><span class="linenos">1532</span></a>        <span class="c1"># Update the internal state</span>
</span><span id="Disulfide-1533"><a href="#Disulfide-1533"><span class="linenos">1533</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span> <span class="o">=</span> <span class="n">dist</span>
</span><span id="Disulfide-1534"><a href="#Disulfide-1534"><span class="linenos">1534</span></a>
</span><span id="Disulfide-1535"><a href="#Disulfide-1535"><span class="linenos">1535</span></a>        <span class="k">return</span> <span class="n">dist</span>
</span><span id="Disulfide-1536"><a href="#Disulfide-1536"><span class="linenos">1536</span></a>
</span><span id="Disulfide-1537"><a href="#Disulfide-1537"><span class="linenos">1537</span></a>    <span class="k">def</span> <span class="nf">Torsion_Distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Disulfide-1538"><a href="#Disulfide-1538"><span class="linenos">1538</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-1539"><a href="#Disulfide-1539"><span class="linenos">1539</span></a><span class="sd">        Calculate the 5D Euclidean distance between ```self``` and another Disulfide</span>
</span><span id="Disulfide-1540"><a href="#Disulfide-1540"><span class="linenos">1540</span></a><span class="sd">        object. This is used to compare Disulfide Bond torsion angles to </span>
</span><span id="Disulfide-1541"><a href="#Disulfide-1541"><span class="linenos">1541</span></a><span class="sd">        determine their torsional similarity via a 5-Dimensional Euclidean distance metric.</span>
</span><span id="Disulfide-1542"><a href="#Disulfide-1542"><span class="linenos">1542</span></a>
</span><span id="Disulfide-1543"><a href="#Disulfide-1543"><span class="linenos">1543</span></a><span class="sd">        :param other: Comparison Disulfide</span>
</span><span id="Disulfide-1544"><a href="#Disulfide-1544"><span class="linenos">1544</span></a><span class="sd">        :raises ProteusPyWarning: Warning if ```other``` is not a Disulfide object</span>
</span><span id="Disulfide-1545"><a href="#Disulfide-1545"><span class="linenos">1545</span></a><span class="sd">        :return: Euclidean distance (Degrees) between ```self``` and ```other```.</span>
</span><span id="Disulfide-1546"><a href="#Disulfide-1546"><span class="linenos">1546</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-1547"><a href="#Disulfide-1547"><span class="linenos">1547</span></a>
</span><span id="Disulfide-1548"><a href="#Disulfide-1548"><span class="linenos">1548</span></a>        <span class="c1"># Check length of torsion arrays</span>
</span><span id="Disulfide-1549"><a href="#Disulfide-1549"><span class="linenos">1549</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">5</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">torsion_array</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Disulfide-1550"><a href="#Disulfide-1550"><span class="linenos">1550</span></a>            <span class="k">raise</span> <span class="n">ProteusPyWarning</span><span class="p">(</span><span class="s2">&quot;--&gt; Torsion_Distance() requires vectors of length 5!&quot;</span><span class="p">)</span>
</span><span id="Disulfide-1551"><a href="#Disulfide-1551"><span class="linenos">1551</span></a>
</span><span id="Disulfide-1552"><a href="#Disulfide-1552"><span class="linenos">1552</span></a>        <span class="c1"># Convert to numpy arrays and add 180 to each element</span>
</span><span id="Disulfide-1553"><a href="#Disulfide-1553"><span class="linenos">1553</span></a>        <span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span><span class="p">)</span> <span class="o">+</span> <span class="mf">180.0</span>
</span><span id="Disulfide-1554"><a href="#Disulfide-1554"><span class="linenos">1554</span></a>        <span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">torsion_array</span><span class="p">)</span> <span class="o">+</span> <span class="mf">180.0</span>
</span><span id="Disulfide-1555"><a href="#Disulfide-1555"><span class="linenos">1555</span></a>
</span><span id="Disulfide-1556"><a href="#Disulfide-1556"><span class="linenos">1556</span></a>        <span class="c1"># Compute the 5D Euclidean distance using numpy&#39;s linalg.norm function</span>
</span><span id="Disulfide-1557"><a href="#Disulfide-1557"><span class="linenos">1557</span></a>        <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p1</span> <span class="o">-</span> <span class="n">p2</span><span class="p">)</span>
</span><span id="Disulfide-1558"><a href="#Disulfide-1558"><span class="linenos">1558</span></a>
</span><span id="Disulfide-1559"><a href="#Disulfide-1559"><span class="linenos">1559</span></a>        <span class="k">return</span> <span class="n">dist</span>
</span><span id="Disulfide-1560"><a href="#Disulfide-1560"><span class="linenos">1560</span></a>
</span><span id="Disulfide-1561"><a href="#Disulfide-1561"><span class="linenos">1561</span></a>    <span class="k">def</span> <span class="nf">Torsion_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">others</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">):</span>
</span><span id="Disulfide-1562"><a href="#Disulfide-1562"><span class="linenos">1562</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide-1563"><a href="#Disulfide-1563"><span class="linenos">1563</span></a><span class="sd">        Returns list of Disulfides within the angular cutoff in the others list.</span>
</span><span id="Disulfide-1564"><a href="#Disulfide-1564"><span class="linenos">1564</span></a><span class="sd">        This routine is used to find Disulfides having the same torsion length</span>
</span><span id="Disulfide-1565"><a href="#Disulfide-1565"><span class="linenos">1565</span></a><span class="sd">        within the others list. This is used to find families of Disulfides with</span>
</span><span id="Disulfide-1566"><a href="#Disulfide-1566"><span class="linenos">1566</span></a><span class="sd">        similar conformations. Assumes self is properly initialized.</span>
</span><span id="Disulfide-1567"><a href="#Disulfide-1567"><span class="linenos">1567</span></a><span class="sd">        </span>
</span><span id="Disulfide-1568"><a href="#Disulfide-1568"><span class="linenos">1568</span></a><span class="sd">        *NB* The routine will not distinguish between +/-</span>
</span><span id="Disulfide-1569"><a href="#Disulfide-1569"><span class="linenos">1569</span></a><span class="sd">        dihedral angles. *i.e.* [-60, -60, -90, -60, -60] would have the same</span>
</span><span id="Disulfide-1570"><a href="#Disulfide-1570"><span class="linenos">1570</span></a><span class="sd">        torsion length as [60, 60, 90, 60, 60], two clearly different structures.</span>
</span><span id="Disulfide-1571"><a href="#Disulfide-1571"><span class="linenos">1571</span></a>
</span><span id="Disulfide-1572"><a href="#Disulfide-1572"><span class="linenos">1572</span></a><span class="sd">        :param others: ```DisulfideList``` to search</span>
</span><span id="Disulfide-1573"><a href="#Disulfide-1573"><span class="linenos">1573</span></a><span class="sd">        :param cutoff: Dihedral angle degree cutoff</span>
</span><span id="Disulfide-1574"><a href="#Disulfide-1574"><span class="linenos">1574</span></a><span class="sd">        :return: DisulfideList within the cutoff</span>
</span><span id="Disulfide-1575"><a href="#Disulfide-1575"><span class="linenos">1575</span></a>
</span><span id="Disulfide-1576"><a href="#Disulfide-1576"><span class="linenos">1576</span></a><span class="sd">        Example:</span>
</span><span id="Disulfide-1577"><a href="#Disulfide-1577"><span class="linenos">1577</span></a><span class="sd">        In this example we load the disulfide database subset, find the disulfides with</span>
</span><span id="Disulfide-1578"><a href="#Disulfide-1578"><span class="linenos">1578</span></a><span class="sd">        the lowest and highest energies, and then find the nearest conformational neighbors.</span>
</span><span id="Disulfide-1579"><a href="#Disulfide-1579"><span class="linenos">1579</span></a><span class="sd">        Finally, we display the neighbors overlaid against a common reference frame.</span>
</span><span id="Disulfide-1580"><a href="#Disulfide-1580"><span class="linenos">1580</span></a>
</span><span id="Disulfide-1581"><a href="#Disulfide-1581"><span class="linenos">1581</span></a><span class="sd">        &gt;&gt;&gt; import proteusPy</span>
</span><span id="Disulfide-1582"><a href="#Disulfide-1582"><span class="linenos">1582</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideLoader import DisulfideLoader</span>
</span><span id="Disulfide-1583"><a href="#Disulfide-1583"><span class="linenos">1583</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideList import DisulfideList</span>
</span><span id="Disulfide-1584"><a href="#Disulfide-1584"><span class="linenos">1584</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.Disulfide import Disulfide</span>
</span><span id="Disulfide-1585"><a href="#Disulfide-1585"><span class="linenos">1585</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = None</span>
</span><span id="Disulfide-1586"><a href="#Disulfide-1586"><span class="linenos">1586</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = Load_PDB_SS(verbose=False, subset=True)</span>
</span><span id="Disulfide-1587"><a href="#Disulfide-1587"><span class="linenos">1587</span></a><span class="sd">        &gt;&gt;&gt; ss_list = DisulfideList([], &#39;tmp&#39;)</span>
</span><span id="Disulfide-1588"><a href="#Disulfide-1588"><span class="linenos">1588</span></a>
</span><span id="Disulfide-1589"><a href="#Disulfide-1589"><span class="linenos">1589</span></a><span class="sd">        We point to the complete list to search for lowest and highest energies.</span>
</span><span id="Disulfide-1590"><a href="#Disulfide-1590"><span class="linenos">1590</span></a><span class="sd">        &gt;&gt;&gt; sslist = PDB_SS.SSList</span>
</span><span id="Disulfide-1591"><a href="#Disulfide-1591"><span class="linenos">1591</span></a><span class="sd">        &gt;&gt;&gt; ssmin_enrg, ssmax_enrg = PDB_SS.SSList.minmax_energy()</span>
</span><span id="Disulfide-1592"><a href="#Disulfide-1592"><span class="linenos">1592</span></a>
</span><span id="Disulfide-1593"><a href="#Disulfide-1593"><span class="linenos">1593</span></a><span class="sd">        Make an empty list and find the nearest neighbors within 10 degrees avg RMS in</span>
</span><span id="Disulfide-1594"><a href="#Disulfide-1594"><span class="linenos">1594</span></a><span class="sd">        sidechain dihedral angle space.</span>
</span><span id="Disulfide-1595"><a href="#Disulfide-1595"><span class="linenos">1595</span></a>
</span><span id="Disulfide-1596"><a href="#Disulfide-1596"><span class="linenos">1596</span></a><span class="sd">        &gt;&gt;&gt; low_energy_neighbors = DisulfideList([],&#39;Neighbors&#39;)</span>
</span><span id="Disulfide-1597"><a href="#Disulfide-1597"><span class="linenos">1597</span></a><span class="sd">        &gt;&gt;&gt; low_energy_neighbors = ssmin_enrg.Torsion_neighbors(sslist, 10)</span>
</span><span id="Disulfide-1598"><a href="#Disulfide-1598"><span class="linenos">1598</span></a>
</span><span id="Disulfide-1599"><a href="#Disulfide-1599"><span class="linenos">1599</span></a><span class="sd">        Display the number found, and then display them overlaid onto their common reference frame.</span>
</span><span id="Disulfide-1600"><a href="#Disulfide-1600"><span class="linenos">1600</span></a>
</span><span id="Disulfide-1601"><a href="#Disulfide-1601"><span class="linenos">1601</span></a><span class="sd">        &gt;&gt;&gt; tot = low_energy_neighbors.length</span>
</span><span id="Disulfide-1602"><a href="#Disulfide-1602"><span class="linenos">1602</span></a><span class="sd">        &gt;&gt;&gt; print(f&#39;Neighbors: {tot}&#39;)</span>
</span><span id="Disulfide-1603"><a href="#Disulfide-1603"><span class="linenos">1603</span></a><span class="sd">        Neighbors: 2</span>
</span><span id="Disulfide-1604"><a href="#Disulfide-1604"><span class="linenos">1604</span></a><span class="sd">        &gt;&gt;&gt; low_energy_neighbors.display_overlay()</span>
</span><span id="Disulfide-1605"><a href="#Disulfide-1605"><span class="linenos">1605</span></a>
</span><span id="Disulfide-1606"><a href="#Disulfide-1606"><span class="linenos">1606</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide-1607"><a href="#Disulfide-1607"><span class="linenos">1607</span></a>        
</span><span id="Disulfide-1608"><a href="#Disulfide-1608"><span class="linenos">1608</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">ss</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">others</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Torsion_Distance</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">cutoff</span><span class="p">]</span>
</span><span id="Disulfide-1609"><a href="#Disulfide-1609"><span class="linenos">1609</span></a>        <span class="k">return</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s1">&#39;neighbors&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>This class provides a Python object and methods representing a physical disulfide bond 
either extracted from the RCSB protein databank or built using the 
<a href="turtle3D.html">proteusPy.Turtle3D</a> class. The disulfide bond is an important
intermolecular stabilizing structural element and is characterized by:</p>

<ul>
<li>Atomic coordinates for the atoms N, Cα, Cβ, C', Sγ for both residues. 
These are stored as both raw atomic coordinates as read from the RCSB file 
and internal local coordinates.</li>
<li>The dihedral angles Χ1 - Χ5 for the disulfide bond</li>
<li>A name, by default {pdb_id}{prox_resnumb}{prox_chain}_{distal_resnum}{distal_chain} </li>
<li>Proximal residue number</li>
<li>Distal residue number</li>
<li>Approximate bond torsional energy (kcal/mol):</li>
</ul>

<p>$$ 
E_{kcal/mol} \approx 2.0 * cos(3.0 * \chi_{1}) + cos(3.0 * \chi_{5}) + cos(3.0 * \chi_{2}) + 
$$</p>

<p>$$
cos(3.0 * \chi_{4}) + 3.5 * cos(2.0 * \chi_{3}) + 0.6 * cos(3.0 * \chi_{3}) + 10.1 
$$</p>

<p>The equation embodies the typical 3-fold rotation barriers associated with single bonds,
(Χ1, Χ5, Χ2, Χ4) and a high 2-fold barrier for Χ3, resulting from the partial double bond
character of the S-S bond. This property leads to two major disulfide families, characterized
by the sign of Χ3. <em>Left-handed</em> disulfides have Χ3 &lt; 0° and <em>right-handed</em> disulfides have
Χ3 &gt; 0°. Within this breakdown there are numerous subfamilies, broadly known as the <em>hook</em>,
<em>spiral</em> and <em>staple</em>. These are under characgterization.</p>

<ul>
<li>Euclidean length of the dihedral angles (degrees) defined as:
$$\sqrt(\chi_{1}^{2} + \chi_{2}^{2} + \chi_{3}^{2} + \chi_{4}^{2} + \chi_{5}^{2})$$</li>
<li>Cα - Cα distance (Å)</li>
<li>The previous C' and next N for both the proximal and distal residues. These are needed
to calculate the backbone dihedral angles Φ and Ψ.</li>
<li>Backbone dihedral angles Φ and Ψ, when possible. Not all structures are complete and
in those cases the atoms needed may be undefined. In this case the Φ and Ψ angles are set
to -180°.</li>
</ul>

<p>The class also provides a rendering capabilities using the excellent <a href="https://pyvista.org">PyVista</a>
library, and can display disulfides interactively in a variety of display styles:</p>

<ul>
<li>'sb' - Split Bonds style - bonds colored by their atom type</li>
<li>'bs' - Ball and Stick style - split bond coloring with small atoms</li>
<li>'pd' - Proximal/Distal style - bonds colored <em>Red</em> for proximal residue and <em>Green</em> for
the distal residue.</li>
<li>'cpk' - CPK style rendering, colored by atom type:
<ul>
<li>Carbon   - Grey</li>
<li>Nitrogen - Blue</li>
<li>Sulfur   - Yellow</li>
<li>Oxygen   - Red</li>
<li>Hydrogen - White </li>
</ul></li>
</ul>

<p>Individual displays can be saved to a file, and animations created.</p>
</div>


                            <div id="Disulfide.__init__" class="classattr">
                                        <input id="Disulfide.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Disulfide</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;SSBOND&#39;</span>,</span><span class="param">	<span class="n">proximal</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>,</span><span class="param">	<span class="n">distal</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>,</span><span class="param">	<span class="n">proximal_chain</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>,</span><span class="param">	<span class="n">distal_chain</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>,</span><span class="param">	<span class="n">pdb_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;1egs&#39;</span>,</span><span class="param">	<span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">permissive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span>)</span>

                <label class="view-source-button" for="Disulfide.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.__init__-117"><a href="#Disulfide.__init__-117"><span class="linenos">117</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;SSBOND&quot;</span><span class="p">,</span> <span class="n">proximal</span><span class="p">:</span> <span class="nb">int</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Disulfide.__init__-118"><a href="#Disulfide.__init__-118"><span class="linenos">118</span></a>                <span class="n">distal</span><span class="p">:</span> <span class="nb">int</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">proximal_chain</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span>
</span><span id="Disulfide.__init__-119"><a href="#Disulfide.__init__-119"><span class="linenos">119</span></a>                <span class="n">distal_chain</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">pdb_id</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;1egs&#39;</span><span class="p">,</span>
</span><span id="Disulfide.__init__-120"><a href="#Disulfide.__init__-120"><span class="linenos">120</span></a>                <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">permissive</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
</span><span id="Disulfide.__init__-121"><a href="#Disulfide.__init__-121"><span class="linenos">121</span></a>                <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Disulfide.__init__-122"><a href="#Disulfide.__init__-122"><span class="linenos">122</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.__init__-123"><a href="#Disulfide.__init__-123"><span class="linenos">123</span></a><span class="sd">        __init__ Initialize the class to defined internal values.</span>
</span><span id="Disulfide.__init__-124"><a href="#Disulfide.__init__-124"><span class="linenos">124</span></a>
</span><span id="Disulfide.__init__-125"><a href="#Disulfide.__init__-125"><span class="linenos">125</span></a><span class="sd">        :param name: Disulfide name, by default &quot;SSBOND&quot;</span>
</span><span id="Disulfide.__init__-126"><a href="#Disulfide.__init__-126"><span class="linenos">126</span></a><span class="sd">            </span>
</span><span id="Disulfide.__init__-127"><a href="#Disulfide.__init__-127"><span class="linenos">127</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.__init__-128"><a href="#Disulfide.__init__-128"><span class="linenos">128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="Disulfide.__init__-129"><a href="#Disulfide.__init__-129"><span class="linenos">129</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal</span> <span class="o">=</span> <span class="n">proximal</span>
</span><span id="Disulfide.__init__-130"><a href="#Disulfide.__init__-130"><span class="linenos">130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal</span> <span class="o">=</span> <span class="n">distal</span>
</span><span id="Disulfide.__init__-131"><a href="#Disulfide.__init__-131"><span class="linenos">131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="n">_FLOAT_INIT</span>
</span><span id="Disulfide.__init__-132"><a href="#Disulfide.__init__-132"><span class="linenos">132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal_chain</span> <span class="o">=</span> <span class="n">proximal_chain</span>
</span><span id="Disulfide.__init__-133"><a href="#Disulfide.__init__-133"><span class="linenos">133</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal_chain</span> <span class="o">=</span> <span class="n">distal_chain</span>
</span><span id="Disulfide.__init__-134"><a href="#Disulfide.__init__-134"><span class="linenos">134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_id</span> <span class="o">=</span> <span class="n">pdb_id</span>
</span><span id="Disulfide.__init__-135"><a href="#Disulfide.__init__-135"><span class="linenos">135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal_residue_fullid</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Disulfide.__init__-136"><a href="#Disulfide.__init__-136"><span class="linenos">136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal_residue_fullid</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Disulfide.__init__-137"><a href="#Disulfide.__init__-137"><span class="linenos">137</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">PERMISSIVE</span> <span class="o">=</span> <span class="n">permissive</span>
</span><span id="Disulfide.__init__-138"><a href="#Disulfide.__init__-138"><span class="linenos">138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">QUIET</span> <span class="o">=</span> <span class="n">quiet</span>
</span><span id="Disulfide.__init__-139"><a href="#Disulfide.__init__-139"><span class="linenos">139</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span> <span class="o">=</span> <span class="n">_FLOAT_INIT</span>
</span><span id="Disulfide.__init__-140"><a href="#Disulfide.__init__-140"><span class="linenos">140</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_distance</span> <span class="o">=</span> <span class="n">_FLOAT_INIT</span>
</span><span id="Disulfide.__init__-141"><a href="#Disulfide.__init__-141"><span class="linenos">141</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">_ANG_INIT</span><span class="p">,</span> <span class="n">_ANG_INIT</span><span class="p">,</span> <span class="n">_ANG_INIT</span><span class="p">,</span> 
</span><span id="Disulfide.__init__-142"><a href="#Disulfide.__init__-142"><span class="linenos">142</span></a>        								  <span class="n">_ANG_INIT</span><span class="p">,</span> <span class="n">_ANG_INIT</span><span class="p">))</span>
</span><span id="Disulfide.__init__-143"><a href="#Disulfide.__init__-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">phiprox</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="Disulfide.__init__-144"><a href="#Disulfide.__init__-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">psiprox</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="Disulfide.__init__-145"><a href="#Disulfide.__init__-145"><span class="linenos">145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">phidist</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="Disulfide.__init__-146"><a href="#Disulfide.__init__-146"><span class="linenos">146</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">psidist</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="Disulfide.__init__-147"><a href="#Disulfide.__init__-147"><span class="linenos">147</span></a>
</span><span id="Disulfide.__init__-148"><a href="#Disulfide.__init__-148"><span class="linenos">148</span></a>        <span class="c1"># global coordinates for the Disulfide, typically as </span>
</span><span id="Disulfide.__init__-149"><a href="#Disulfide.__init__-149"><span class="linenos">149</span></a>        <span class="c1"># returned from the PDB file</span>
</span><span id="Disulfide.__init__-150"><a href="#Disulfide.__init__-150"><span class="linenos">150</span></a>
</span><span id="Disulfide.__init__-151"><a href="#Disulfide.__init__-151"><span class="linenos">151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-152"><a href="#Disulfide.__init__-152"><span class="linenos">152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-153"><a href="#Disulfide.__init__-153"><span class="linenos">153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-154"><a href="#Disulfide.__init__-154"><span class="linenos">154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">o_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-155"><a href="#Disulfide.__init__-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-156"><a href="#Disulfide.__init__-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-157"><a href="#Disulfide.__init__-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-158"><a href="#Disulfide.__init__-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-159"><a href="#Disulfide.__init__-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-160"><a href="#Disulfide.__init__-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-161"><a href="#Disulfide.__init__-161"><span class="linenos">161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-162"><a href="#Disulfide.__init__-162"><span class="linenos">162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">o_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-163"><a href="#Disulfide.__init__-163"><span class="linenos">163</span></a>
</span><span id="Disulfide.__init__-164"><a href="#Disulfide.__init__-164"><span class="linenos">164</span></a>        <span class="c1"># set when we can&#39;t find previous or next prox or distal</span>
</span><span id="Disulfide.__init__-165"><a href="#Disulfide.__init__-165"><span class="linenos">165</span></a>        <span class="c1"># C&#39; or N atoms.</span>
</span><span id="Disulfide.__init__-166"><a href="#Disulfide.__init__-166"><span class="linenos">166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">missing_atoms</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Disulfide.__init__-167"><a href="#Disulfide.__init__-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modelled</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Disulfide.__init__-168"><a href="#Disulfide.__init__-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
</span><span id="Disulfide.__init__-169"><a href="#Disulfide.__init__-169"><span class="linenos">169</span></a>
</span><span id="Disulfide.__init__-170"><a href="#Disulfide.__init__-170"><span class="linenos">170</span></a>        <span class="c1"># need these to calculate backbone dihedral angles</span>
</span><span id="Disulfide.__init__-171"><a href="#Disulfide.__init__-171"><span class="linenos">171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prev_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-172"><a href="#Disulfide.__init__-172"><span class="linenos">172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_next_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-173"><a href="#Disulfide.__init__-173"><span class="linenos">173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prev_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-174"><a href="#Disulfide.__init__-174"><span class="linenos">174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_next_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-175"><a href="#Disulfide.__init__-175"><span class="linenos">175</span></a>
</span><span id="Disulfide.__init__-176"><a href="#Disulfide.__init__-176"><span class="linenos">176</span></a>        <span class="c1"># local coordinates for the Disulfide, computed using the Turtle3D in </span>
</span><span id="Disulfide.__init__-177"><a href="#Disulfide.__init__-177"><span class="linenos">177</span></a>        <span class="c1"># Orientation #1. these are generally private.</span>
</span><span id="Disulfide.__init__-178"><a href="#Disulfide.__init__-178"><span class="linenos">178</span></a>
</span><span id="Disulfide.__init__-179"><a href="#Disulfide.__init__-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-180"><a href="#Disulfide.__init__-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ca_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-181"><a href="#Disulfide.__init__-181"><span class="linenos">181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-182"><a href="#Disulfide.__init__-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_o_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-183"><a href="#Disulfide.__init__-183"><span class="linenos">183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cb_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-184"><a href="#Disulfide.__init__-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sg_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-185"><a href="#Disulfide.__init__-185"><span class="linenos">185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sg_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-186"><a href="#Disulfide.__init__-186"><span class="linenos">186</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cb_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-187"><a href="#Disulfide.__init__-187"><span class="linenos">187</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ca_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-188"><a href="#Disulfide.__init__-188"><span class="linenos">188</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-189"><a href="#Disulfide.__init__-189"><span class="linenos">189</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-190"><a href="#Disulfide.__init__-190"><span class="linenos">190</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_o_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-191"><a href="#Disulfide.__init__-191"><span class="linenos">191</span></a>
</span><span id="Disulfide.__init__-192"><a href="#Disulfide.__init__-192"><span class="linenos">192</span></a>        <span class="c1"># need these to calculate backbone dihedral angles</span>
</span><span id="Disulfide.__init__-193"><a href="#Disulfide.__init__-193"><span class="linenos">193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_prev_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-194"><a href="#Disulfide.__init__-194"><span class="linenos">194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_next_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-195"><a href="#Disulfide.__init__-195"><span class="linenos">195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_prev_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-196"><a href="#Disulfide.__init__-196"><span class="linenos">196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_next_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.__init__-197"><a href="#Disulfide.__init__-197"><span class="linenos">197</span></a>
</span><span id="Disulfide.__init__-198"><a href="#Disulfide.__init__-198"><span class="linenos">198</span></a>        <span class="c1"># Dihedral angles for the disulfide bond itself, set to _ANG_INIT</span>
</span><span id="Disulfide.__init__-199"><a href="#Disulfide.__init__-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi1</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="Disulfide.__init__-200"><a href="#Disulfide.__init__-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi2</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="Disulfide.__init__-201"><a href="#Disulfide.__init__-201"><span class="linenos">201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="Disulfide.__init__-202"><a href="#Disulfide.__init__-202"><span class="linenos">202</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi4</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="Disulfide.__init__-203"><a href="#Disulfide.__init__-203"><span class="linenos">203</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi5</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="Disulfide.__init__-204"><a href="#Disulfide.__init__-204"><span class="linenos">204</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span> <span class="n">_ANG_INIT</span> <span class="c1"># new dihedral angle: Nprox - Ca_prox - Ca_dist - N_dist</span>
</span><span id="Disulfide.__init__-205"><a href="#Disulfide.__init__-205"><span class="linenos">205</span></a>
</span><span id="Disulfide.__init__-206"><a href="#Disulfide.__init__-206"><span class="linenos">206</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span> <span class="o">=</span> <span class="n">_FLOAT_INIT</span>
</span></pre></div>


            <div class="docstring"><p>__init__ Initialize the class to defined internal values.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong>:  Disulfide name, by default "SSBOND"</li>
</ul>
</div>


                            </div>
                            <div id="Disulfide.bounding_box" class="classattr">
                                        <input id="Disulfide.bounding_box-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">bounding_box</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.bounding_box-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.bounding_box"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.bounding_box-545"><a href="#Disulfide.bounding_box-545"><span class="linenos">545</span></a>    <span class="k">def</span> <span class="nf">bounding_box</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide.bounding_box-546"><a href="#Disulfide.bounding_box-546"><span class="linenos">546</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.bounding_box-547"><a href="#Disulfide.bounding_box-547"><span class="linenos">547</span></a><span class="sd">        Return the bounding box array for the given disulfide</span>
</span><span id="Disulfide.bounding_box-548"><a href="#Disulfide.bounding_box-548"><span class="linenos">548</span></a>
</span><span id="Disulfide.bounding_box-549"><a href="#Disulfide.bounding_box-549"><span class="linenos">549</span></a><span class="sd">        Returns</span>
</span><span id="Disulfide.bounding_box-550"><a href="#Disulfide.bounding_box-550"><span class="linenos">550</span></a><span class="sd">        -------</span>
</span><span id="Disulfide.bounding_box-551"><a href="#Disulfide.bounding_box-551"><span class="linenos">551</span></a><span class="sd">        :return: np.Array(3,2): Array containing the min, max for X, Y, and Z respectively. </span>
</span><span id="Disulfide.bounding_box-552"><a href="#Disulfide.bounding_box-552"><span class="linenos">552</span></a><span class="sd">        Does not currently take the atom&#39;s radius into account.</span>
</span><span id="Disulfide.bounding_box-553"><a href="#Disulfide.bounding_box-553"><span class="linenos">553</span></a><span class="sd">    </span>
</span><span id="Disulfide.bounding_box-554"><a href="#Disulfide.bounding_box-554"><span class="linenos">554</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.bounding_box-555"><a href="#Disulfide.bounding_box-555"><span class="linenos">555</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</span><span id="Disulfide.bounding_box-556"><a href="#Disulfide.bounding_box-556"><span class="linenos">556</span></a>        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_extents</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</span><span id="Disulfide.bounding_box-557"><a href="#Disulfide.bounding_box-557"><span class="linenos">557</span></a>        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_extents</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</span><span id="Disulfide.bounding_box-558"><a href="#Disulfide.bounding_box-558"><span class="linenos">558</span></a>        <span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_extents</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
</span><span id="Disulfide.bounding_box-559"><a href="#Disulfide.bounding_box-559"><span class="linenos">559</span></a>
</span><span id="Disulfide.bounding_box-560"><a href="#Disulfide.bounding_box-560"><span class="linenos">560</span></a>        <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">]</span>
</span><span id="Disulfide.bounding_box-561"><a href="#Disulfide.bounding_box-561"><span class="linenos">561</span></a>        <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">]</span>
</span><span id="Disulfide.bounding_box-562"><a href="#Disulfide.bounding_box-562"><span class="linenos">562</span></a>        <span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span><span class="p">]</span>
</span><span id="Disulfide.bounding_box-563"><a href="#Disulfide.bounding_box-563"><span class="linenos">563</span></a>
</span><span id="Disulfide.bounding_box-564"><a href="#Disulfide.bounding_box-564"><span class="linenos">564</span></a>        <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Return the bounding box array for the given disulfide</p>

<h2 id="returns">Returns</h2>

<h6 id="returns-2">Returns</h6>

<blockquote>
  <p>np.Array(3,2): Array containing the min, max for X, Y, and Z respectively. 
  Does not currently take the atom's radius into account.</p>
</blockquote>
</div>


                            </div>
                            <div id="Disulfide.build_model" class="classattr">
                                        <input id="Disulfide.build_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">build_model</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">chi1</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">chi2</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">chi3</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">chi4</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">chi5</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.build_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.build_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.build_model-567"><a href="#Disulfide.build_model-567"><span class="linenos">567</span></a>    <span class="k">def</span> <span class="nf">build_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chi1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">chi2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> 
</span><span id="Disulfide.build_model-568"><a href="#Disulfide.build_model-568"><span class="linenos">568</span></a>                    <span class="n">chi3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">chi4</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">chi5</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="Disulfide.build_model-569"><a href="#Disulfide.build_model-569"><span class="linenos">569</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.build_model-570"><a href="#Disulfide.build_model-570"><span class="linenos">570</span></a><span class="sd">        Build a model Disulfide based on the input dihedral angles.</span>
</span><span id="Disulfide.build_model-571"><a href="#Disulfide.build_model-571"><span class="linenos">571</span></a><span class="sd">        Routine assumes turtle is in orientation #1 (at Ca, headed toward</span>
</span><span id="Disulfide.build_model-572"><a href="#Disulfide.build_model-572"><span class="linenos">572</span></a><span class="sd">        Cb, with N on left), builds disulfide, and updates the object&#39;s internal</span>
</span><span id="Disulfide.build_model-573"><a href="#Disulfide.build_model-573"><span class="linenos">573</span></a><span class="sd">        coordinates. It also adds the distal protein backbone,</span>
</span><span id="Disulfide.build_model-574"><a href="#Disulfide.build_model-574"><span class="linenos">574</span></a><span class="sd">        and computes the disulfide conformational energy.</span>
</span><span id="Disulfide.build_model-575"><a href="#Disulfide.build_model-575"><span class="linenos">575</span></a>
</span><span id="Disulfide.build_model-576"><a href="#Disulfide.build_model-576"><span class="linenos">576</span></a><span class="sd">        :param chi1: Chi1 (degrees)</span>
</span><span id="Disulfide.build_model-577"><a href="#Disulfide.build_model-577"><span class="linenos">577</span></a><span class="sd">        :param chi2: Chi2 (degrees)</span>
</span><span id="Disulfide.build_model-578"><a href="#Disulfide.build_model-578"><span class="linenos">578</span></a><span class="sd">        :param chi3: Chi3 (degrees)</span>
</span><span id="Disulfide.build_model-579"><a href="#Disulfide.build_model-579"><span class="linenos">579</span></a><span class="sd">        :param chi4: Chi4 (degrees)</span>
</span><span id="Disulfide.build_model-580"><a href="#Disulfide.build_model-580"><span class="linenos">580</span></a><span class="sd">        :param chi5: Chi5 (degrees)</span>
</span><span id="Disulfide.build_model-581"><a href="#Disulfide.build_model-581"><span class="linenos">581</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.build_model-582"><a href="#Disulfide.build_model-582"><span class="linenos">582</span></a>
</span><span id="Disulfide.build_model-583"><a href="#Disulfide.build_model-583"><span class="linenos">583</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_dihedrals</span><span class="p">(</span><span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="p">,</span> <span class="n">chi3</span><span class="p">,</span> <span class="n">chi4</span><span class="p">,</span> <span class="n">chi5</span><span class="p">)</span>
</span><span id="Disulfide.build_model-584"><a href="#Disulfide.build_model-584"><span class="linenos">584</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Disulfide.build_model-585"><a href="#Disulfide.build_model-585"><span class="linenos">585</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Disulfide.build_model-586"><a href="#Disulfide.build_model-586"><span class="linenos">586</span></a>
</span><span id="Disulfide.build_model-587"><a href="#Disulfide.build_model-587"><span class="linenos">587</span></a>        <span class="n">tmp</span> <span class="o">=</span> <span class="n">Turtle3D</span><span class="p">(</span><span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
</span><span id="Disulfide.build_model-588"><a href="#Disulfide.build_model-588"><span class="linenos">588</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">Orientation</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Disulfide.build_model-589"><a href="#Disulfide.build_model-589"><span class="linenos">589</span></a>
</span><span id="Disulfide.build_model-590"><a href="#Disulfide.build_model-590"><span class="linenos">590</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.build_model-591"><a href="#Disulfide.build_model-591"><span class="linenos">591</span></a>        <span class="n">ca</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.build_model-592"><a href="#Disulfide.build_model-592"><span class="linenos">592</span></a>        <span class="n">cb</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.build_model-593"><a href="#Disulfide.build_model-593"><span class="linenos">593</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.build_model-594"><a href="#Disulfide.build_model-594"><span class="linenos">594</span></a>
</span><span id="Disulfide.build_model-595"><a href="#Disulfide.build_model-595"><span class="linenos">595</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">_position</span>
</span><span id="Disulfide.build_model-596"><a href="#Disulfide.build_model-596"><span class="linenos">596</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">schain_to_bbone</span><span class="p">()</span>
</span><span id="Disulfide.build_model-597"><a href="#Disulfide.build_model-597"><span class="linenos">597</span></a>        <span class="n">n</span><span class="p">,</span> <span class="n">ca</span><span class="p">,</span> <span class="n">cb</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">build_residue</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
</span><span id="Disulfide.build_model-598"><a href="#Disulfide.build_model-598"><span class="linenos">598</span></a>
</span><span id="Disulfide.build_model-599"><a href="#Disulfide.build_model-599"><span class="linenos">599</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_prox</span> <span class="o">=</span> <span class="n">n</span>
</span><span id="Disulfide.build_model-600"><a href="#Disulfide.build_model-600"><span class="linenos">600</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span> <span class="o">=</span> <span class="n">ca</span>
</span><span id="Disulfide.build_model-601"><a href="#Disulfide.build_model-601"><span class="linenos">601</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prox</span> <span class="o">=</span> <span class="n">c</span>
</span><span id="Disulfide.build_model-602"><a href="#Disulfide.build_model-602"><span class="linenos">602</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span> <span class="o">=</span> <span class="n">cb</span>
</span><span id="Disulfide.build_model-603"><a href="#Disulfide.build_model-603"><span class="linenos">603</span></a>
</span><span id="Disulfide.build_model-604"><a href="#Disulfide.build_model-604"><span class="linenos">604</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">bbone_to_schain</span><span class="p">()</span>
</span><span id="Disulfide.build_model-605"><a href="#Disulfide.build_model-605"><span class="linenos">605</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">1.53</span><span class="p">)</span>
</span><span id="Disulfide.build_model-606"><a href="#Disulfide.build_model-606"><span class="linenos">606</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi1</span><span class="p">)</span>
</span><span id="Disulfide.build_model-607"><a href="#Disulfide.build_model-607"><span class="linenos">607</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">yaw</span><span class="p">(</span><span class="mf">112.8</span><span class="p">)</span>
</span><span id="Disulfide.build_model-608"><a href="#Disulfide.build_model-608"><span class="linenos">608</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">_position</span><span class="p">)</span>
</span><span id="Disulfide.build_model-609"><a href="#Disulfide.build_model-609"><span class="linenos">609</span></a>
</span><span id="Disulfide.build_model-610"><a href="#Disulfide.build_model-610"><span class="linenos">610</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">1.86</span><span class="p">)</span>
</span><span id="Disulfide.build_model-611"><a href="#Disulfide.build_model-611"><span class="linenos">611</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi2</span><span class="p">)</span>
</span><span id="Disulfide.build_model-612"><a href="#Disulfide.build_model-612"><span class="linenos">612</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">yaw</span><span class="p">(</span><span class="mf">103.8</span><span class="p">)</span>
</span><span id="Disulfide.build_model-613"><a href="#Disulfide.build_model-613"><span class="linenos">613</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">_position</span><span class="p">)</span>
</span><span id="Disulfide.build_model-614"><a href="#Disulfide.build_model-614"><span class="linenos">614</span></a>
</span><span id="Disulfide.build_model-615"><a href="#Disulfide.build_model-615"><span class="linenos">615</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">2.044</span><span class="p">)</span>
</span><span id="Disulfide.build_model-616"><a href="#Disulfide.build_model-616"><span class="linenos">616</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi3</span><span class="p">)</span>
</span><span id="Disulfide.build_model-617"><a href="#Disulfide.build_model-617"><span class="linenos">617</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">yaw</span><span class="p">(</span><span class="mf">103.8</span><span class="p">)</span>
</span><span id="Disulfide.build_model-618"><a href="#Disulfide.build_model-618"><span class="linenos">618</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">_position</span><span class="p">)</span>
</span><span id="Disulfide.build_model-619"><a href="#Disulfide.build_model-619"><span class="linenos">619</span></a>
</span><span id="Disulfide.build_model-620"><a href="#Disulfide.build_model-620"><span class="linenos">620</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">1.86</span><span class="p">)</span>
</span><span id="Disulfide.build_model-621"><a href="#Disulfide.build_model-621"><span class="linenos">621</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi4</span><span class="p">)</span>
</span><span id="Disulfide.build_model-622"><a href="#Disulfide.build_model-622"><span class="linenos">622</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">yaw</span><span class="p">(</span><span class="mf">112.8</span><span class="p">)</span>
</span><span id="Disulfide.build_model-623"><a href="#Disulfide.build_model-623"><span class="linenos">623</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">_position</span><span class="p">)</span>
</span><span id="Disulfide.build_model-624"><a href="#Disulfide.build_model-624"><span class="linenos">624</span></a>
</span><span id="Disulfide.build_model-625"><a href="#Disulfide.build_model-625"><span class="linenos">625</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">1.53</span><span class="p">)</span>
</span><span id="Disulfide.build_model-626"><a href="#Disulfide.build_model-626"><span class="linenos">626</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chi5</span><span class="p">)</span>
</span><span id="Disulfide.build_model-627"><a href="#Disulfide.build_model-627"><span class="linenos">627</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">pitch</span><span class="p">(</span><span class="mf">180.0</span><span class="p">)</span>
</span><span id="Disulfide.build_model-628"><a href="#Disulfide.build_model-628"><span class="linenos">628</span></a>
</span><span id="Disulfide.build_model-629"><a href="#Disulfide.build_model-629"><span class="linenos">629</span></a>        <span class="n">tmp</span><span class="o">.</span><span class="n">schain_to_bbone</span><span class="p">()</span>
</span><span id="Disulfide.build_model-630"><a href="#Disulfide.build_model-630"><span class="linenos">630</span></a>
</span><span id="Disulfide.build_model-631"><a href="#Disulfide.build_model-631"><span class="linenos">631</span></a>        <span class="n">n</span><span class="p">,</span> <span class="n">ca</span><span class="p">,</span> <span class="n">cb</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">build_residue</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
</span><span id="Disulfide.build_model-632"><a href="#Disulfide.build_model-632"><span class="linenos">632</span></a>
</span><span id="Disulfide.build_model-633"><a href="#Disulfide.build_model-633"><span class="linenos">633</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_dist</span> <span class="o">=</span> <span class="n">n</span>
</span><span id="Disulfide.build_model-634"><a href="#Disulfide.build_model-634"><span class="linenos">634</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span> <span class="o">=</span> <span class="n">ca</span>
</span><span id="Disulfide.build_model-635"><a href="#Disulfide.build_model-635"><span class="linenos">635</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_dist</span> <span class="o">=</span> <span class="n">c</span>
</span><span id="Disulfide.build_model-636"><a href="#Disulfide.build_model-636"><span class="linenos">636</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">compute_torsional_energy</span><span class="p">()</span>
</span><span id="Disulfide.build_model-637"><a href="#Disulfide.build_model-637"><span class="linenos">637</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">compute_local_coords</span><span class="p">()</span>
</span><span id="Disulfide.build_model-638"><a href="#Disulfide.build_model-638"><span class="linenos">638</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span> <span class="o">=</span> <span class="n">distance3d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span><span class="p">)</span>
</span><span id="Disulfide.build_model-639"><a href="#Disulfide.build_model-639"><span class="linenos">639</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_distance</span> <span class="o">=</span> <span class="n">distance3d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cb_dist</span><span class="p">)</span>
</span><span id="Disulfide.build_model-640"><a href="#Disulfide.build_model-640"><span class="linenos">640</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">chi1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span><span class="p">,</span> 
</span><span id="Disulfide.build_model-641"><a href="#Disulfide.build_model-641"><span class="linenos">641</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">chi4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi5</span><span class="p">))</span>
</span><span id="Disulfide.build_model-642"><a href="#Disulfide.build_model-642"><span class="linenos">642</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Torsion_Length</span><span class="p">()</span>
</span><span id="Disulfide.build_model-643"><a href="#Disulfide.build_model-643"><span class="linenos">643</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">compute_rho</span><span class="p">()</span>
</span><span id="Disulfide.build_model-644"><a href="#Disulfide.build_model-644"><span class="linenos">644</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">missing_atoms</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Disulfide.build_model-645"><a href="#Disulfide.build_model-645"><span class="linenos">645</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modelled</span> <span class="o">=</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Build a model Disulfide based on the input dihedral angles.
Routine assumes turtle is in orientation #1 (at Ca, headed toward
Cb, with N on left), builds disulfide, and updates the object's internal
coordinates. It also adds the distal protein backbone,
and computes the disulfide conformational energy.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>chi1</strong>:  Chi1 (degrees)</li>
<li><strong>chi2</strong>:  Chi2 (degrees)</li>
<li><strong>chi3</strong>:  Chi3 (degrees)</li>
<li><strong>chi4</strong>:  Chi4 (degrees)</li>
<li><strong>chi5</strong>:  Chi5 (degrees)</li>
</ul>
</div>


                            </div>
                            <div id="Disulfide.cofmass" class="classattr">
                                        <input id="Disulfide.cofmass-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cofmass</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="n">array</span><span class="o">&gt;</span>:</span></span>

                <label class="view-source-button" for="Disulfide.cofmass-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.cofmass"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.cofmass-647"><a href="#Disulfide.cofmass-647"><span class="linenos">647</span></a>    <span class="k">def</span> <span class="nf">cofmass</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
</span><span id="Disulfide.cofmass-648"><a href="#Disulfide.cofmass-648"><span class="linenos">648</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.cofmass-649"><a href="#Disulfide.cofmass-649"><span class="linenos">649</span></a><span class="sd">        Returns the geometric center of mass for the internal coordinates of</span>
</span><span id="Disulfide.cofmass-650"><a href="#Disulfide.cofmass-650"><span class="linenos">650</span></a><span class="sd">        the given Disulfide. Missing atoms are not included.</span>
</span><span id="Disulfide.cofmass-651"><a href="#Disulfide.cofmass-651"><span class="linenos">651</span></a>
</span><span id="Disulfide.cofmass-652"><a href="#Disulfide.cofmass-652"><span class="linenos">652</span></a><span class="sd">        :return: 3D array for the geometric center of mass</span>
</span><span id="Disulfide.cofmass-653"><a href="#Disulfide.cofmass-653"><span class="linenos">653</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.cofmass-654"><a href="#Disulfide.cofmass-654"><span class="linenos">654</span></a>
</span><span id="Disulfide.cofmass-655"><a href="#Disulfide.cofmass-655"><span class="linenos">655</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_coords</span><span class="p">()</span>
</span><span id="Disulfide.cofmass-656"><a href="#Disulfide.cofmass-656"><span class="linenos">656</span></a>        <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the geometric center of mass for the internal coordinates of
the given Disulfide. Missing atoms are not included.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>3D array for the geometric center of mass</p>
</blockquote>
</div>


                            </div>
                            <div id="Disulfide.copy" class="classattr">
                                        <input id="Disulfide.copy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">copy</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.copy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.copy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.copy-658"><a href="#Disulfide.copy-658"><span class="linenos">658</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide.copy-659"><a href="#Disulfide.copy-659"><span class="linenos">659</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.copy-660"><a href="#Disulfide.copy-660"><span class="linenos">660</span></a><span class="sd">        Copy the Disulfide.</span>
</span><span id="Disulfide.copy-661"><a href="#Disulfide.copy-661"><span class="linenos">661</span></a>
</span><span id="Disulfide.copy-662"><a href="#Disulfide.copy-662"><span class="linenos">662</span></a><span class="sd">        :return: A copy of self.  </span>
</span><span id="Disulfide.copy-663"><a href="#Disulfide.copy-663"><span class="linenos">663</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.copy-664"><a href="#Disulfide.copy-664"><span class="linenos">664</span></a>        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Copy the Disulfide.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A copy of self.</p>
</blockquote>
</div>


                            </div>
                            <div id="Disulfide.compute_extents" class="classattr">
                                        <input id="Disulfide.compute_extents-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">compute_extents</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;z&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.compute_extents-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.compute_extents"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.compute_extents-666"><a href="#Disulfide.compute_extents-666"><span class="linenos">666</span></a>    <span class="k">def</span> <span class="nf">compute_extents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">):</span>
</span><span id="Disulfide.compute_extents-667"><a href="#Disulfide.compute_extents-667"><span class="linenos">667</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.compute_extents-668"><a href="#Disulfide.compute_extents-668"><span class="linenos">668</span></a><span class="sd">        Calculate the internal coordinate extents for the input axis.</span>
</span><span id="Disulfide.compute_extents-669"><a href="#Disulfide.compute_extents-669"><span class="linenos">669</span></a><span class="sd">        </span>
</span><span id="Disulfide.compute_extents-670"><a href="#Disulfide.compute_extents-670"><span class="linenos">670</span></a><span class="sd">        :param dim: Axis, one of &#39;x&#39;, &#39;y&#39;, &#39;z&#39;, by default &#39;z&#39;</span>
</span><span id="Disulfide.compute_extents-671"><a href="#Disulfide.compute_extents-671"><span class="linenos">671</span></a><span class="sd">        :return: min, max</span>
</span><span id="Disulfide.compute_extents-672"><a href="#Disulfide.compute_extents-672"><span class="linenos">672</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.compute_extents-673"><a href="#Disulfide.compute_extents-673"><span class="linenos">673</span></a>
</span><span id="Disulfide.compute_extents-674"><a href="#Disulfide.compute_extents-674"><span class="linenos">674</span></a>        <span class="n">ic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_coords</span><span class="p">()</span>
</span><span id="Disulfide.compute_extents-675"><a href="#Disulfide.compute_extents-675"><span class="linenos">675</span></a>        <span class="c1"># set default index to &#39;z&#39;</span>
</span><span id="Disulfide.compute_extents-676"><a href="#Disulfide.compute_extents-676"><span class="linenos">676</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Disulfide.compute_extents-677"><a href="#Disulfide.compute_extents-677"><span class="linenos">677</span></a>
</span><span id="Disulfide.compute_extents-678"><a href="#Disulfide.compute_extents-678"><span class="linenos">678</span></a>        <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
</span><span id="Disulfide.compute_extents-679"><a href="#Disulfide.compute_extents-679"><span class="linenos">679</span></a>            <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Disulfide.compute_extents-680"><a href="#Disulfide.compute_extents-680"><span class="linenos">680</span></a>        <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
</span><span id="Disulfide.compute_extents-681"><a href="#Disulfide.compute_extents-681"><span class="linenos">681</span></a>            <span class="n">idx</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Disulfide.compute_extents-682"><a href="#Disulfide.compute_extents-682"><span class="linenos">682</span></a>        <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span>
</span><span id="Disulfide.compute_extents-683"><a href="#Disulfide.compute_extents-683"><span class="linenos">683</span></a>            <span class="n">idx</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Disulfide.compute_extents-684"><a href="#Disulfide.compute_extents-684"><span class="linenos">684</span></a>        
</span><span id="Disulfide.compute_extents-685"><a href="#Disulfide.compute_extents-685"><span class="linenos">685</span></a>        <span class="n">_min</span> <span class="o">=</span> <span class="n">ic</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="Disulfide.compute_extents-686"><a href="#Disulfide.compute_extents-686"><span class="linenos">686</span></a>        <span class="n">_max</span> <span class="o">=</span> <span class="n">ic</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="Disulfide.compute_extents-687"><a href="#Disulfide.compute_extents-687"><span class="linenos">687</span></a>        <span class="k">return</span> <span class="n">_min</span><span class="p">,</span> <span class="n">_max</span>
</span></pre></div>


            <div class="docstring"><p>Calculate the internal coordinate extents for the input axis.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>dim</strong>:  Axis, one of 'x', 'y', 'z', by default 'z'</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>min, max</p>
</blockquote>
</div>


                            </div>
                            <div id="Disulfide.compute_local_coords" class="classattr">
                                        <input id="Disulfide.compute_local_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">compute_local_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.compute_local_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.compute_local_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.compute_local_coords-689"><a href="#Disulfide.compute_local_coords-689"><span class="linenos">689</span></a>    <span class="k">def</span> <span class="nf">compute_local_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide.compute_local_coords-690"><a href="#Disulfide.compute_local_coords-690"><span class="linenos">690</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide.compute_local_coords-691"><a href="#Disulfide.compute_local_coords-691"><span class="linenos">691</span></a><span class="sd">        Compute the internal coordinates for a properly initialized Disulfide Object.</span>
</span><span id="Disulfide.compute_local_coords-692"><a href="#Disulfide.compute_local_coords-692"><span class="linenos">692</span></a><span class="sd">        </span>
</span><span id="Disulfide.compute_local_coords-693"><a href="#Disulfide.compute_local_coords-693"><span class="linenos">693</span></a><span class="sd">        :param self: SS initialized Disulfide object</span>
</span><span id="Disulfide.compute_local_coords-694"><a href="#Disulfide.compute_local_coords-694"><span class="linenos">694</span></a><span class="sd">        :returns: None, modifies internal state of the input</span>
</span><span id="Disulfide.compute_local_coords-695"><a href="#Disulfide.compute_local_coords-695"><span class="linenos">695</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide.compute_local_coords-696"><a href="#Disulfide.compute_local_coords-696"><span class="linenos">696</span></a>
</span><span id="Disulfide.compute_local_coords-697"><a href="#Disulfide.compute_local_coords-697"><span class="linenos">697</span></a>        <span class="n">turt</span> <span class="o">=</span> <span class="n">Turtle3D</span><span class="p">(</span><span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
</span><span id="Disulfide.compute_local_coords-698"><a href="#Disulfide.compute_local_coords-698"><span class="linenos">698</span></a>        <span class="c1"># get the coordinates as np.array for Turtle3D use.</span>
</span><span id="Disulfide.compute_local_coords-699"><a href="#Disulfide.compute_local_coords-699"><span class="linenos">699</span></a>        <span class="n">cpp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_prev_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide.compute_local_coords-700"><a href="#Disulfide.compute_local_coords-700"><span class="linenos">700</span></a>        <span class="n">nnp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_next_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide.compute_local_coords-701"><a href="#Disulfide.compute_local_coords-701"><span class="linenos">701</span></a>
</span><span id="Disulfide.compute_local_coords-702"><a href="#Disulfide.compute_local_coords-702"><span class="linenos">702</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide.compute_local_coords-703"><a href="#Disulfide.compute_local_coords-703"><span class="linenos">703</span></a>        <span class="n">ca</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide.compute_local_coords-704"><a href="#Disulfide.compute_local_coords-704"><span class="linenos">704</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide.compute_local_coords-705"><a href="#Disulfide.compute_local_coords-705"><span class="linenos">705</span></a>        <span class="n">cb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide.compute_local_coords-706"><a href="#Disulfide.compute_local_coords-706"><span class="linenos">706</span></a>        <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">o_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide.compute_local_coords-707"><a href="#Disulfide.compute_local_coords-707"><span class="linenos">707</span></a>        <span class="n">sg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sg_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide.compute_local_coords-708"><a href="#Disulfide.compute_local_coords-708"><span class="linenos">708</span></a>
</span><span id="Disulfide.compute_local_coords-709"><a href="#Disulfide.compute_local_coords-709"><span class="linenos">709</span></a>        <span class="n">sg2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sg_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide.compute_local_coords-710"><a href="#Disulfide.compute_local_coords-710"><span class="linenos">710</span></a>        <span class="n">cb2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cb_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide.compute_local_coords-711"><a href="#Disulfide.compute_local_coords-711"><span class="linenos">711</span></a>        <span class="n">ca2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide.compute_local_coords-712"><a href="#Disulfide.compute_local_coords-712"><span class="linenos">712</span></a>        <span class="n">c2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide.compute_local_coords-713"><a href="#Disulfide.compute_local_coords-713"><span class="linenos">713</span></a>        <span class="n">n2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide.compute_local_coords-714"><a href="#Disulfide.compute_local_coords-714"><span class="linenos">714</span></a>        <span class="n">o2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">o_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide.compute_local_coords-715"><a href="#Disulfide.compute_local_coords-715"><span class="linenos">715</span></a>
</span><span id="Disulfide.compute_local_coords-716"><a href="#Disulfide.compute_local_coords-716"><span class="linenos">716</span></a>        <span class="n">cpd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_prev_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide.compute_local_coords-717"><a href="#Disulfide.compute_local_coords-717"><span class="linenos">717</span></a>        <span class="n">nnd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_next_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide.compute_local_coords-718"><a href="#Disulfide.compute_local_coords-718"><span class="linenos">718</span></a>        
</span><span id="Disulfide.compute_local_coords-719"><a href="#Disulfide.compute_local_coords-719"><span class="linenos">719</span></a>        <span class="n">turt</span><span class="o">.</span><span class="n">orient_from_backbone</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">ca</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">cb</span><span class="p">,</span> <span class="n">ORIENT_SIDECHAIN</span><span class="p">)</span>
</span><span id="Disulfide.compute_local_coords-720"><a href="#Disulfide.compute_local_coords-720"><span class="linenos">720</span></a>        
</span><span id="Disulfide.compute_local_coords-721"><a href="#Disulfide.compute_local_coords-721"><span class="linenos">721</span></a>        <span class="c1"># internal (local) coordinates, stored as Vector objects</span>
</span><span id="Disulfide.compute_local_coords-722"><a href="#Disulfide.compute_local_coords-722"><span class="linenos">722</span></a>        <span class="c1"># to_local returns np.array objects</span>
</span><span id="Disulfide.compute_local_coords-723"><a href="#Disulfide.compute_local_coords-723"><span class="linenos">723</span></a>        
</span><span id="Disulfide.compute_local_coords-724"><a href="#Disulfide.compute_local_coords-724"><span class="linenos">724</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span><span id="Disulfide.compute_local_coords-725"><a href="#Disulfide.compute_local_coords-725"><span class="linenos">725</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ca_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">ca</span><span class="p">))</span>
</span><span id="Disulfide.compute_local_coords-726"><a href="#Disulfide.compute_local_coords-726"><span class="linenos">726</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
</span><span id="Disulfide.compute_local_coords-727"><a href="#Disulfide.compute_local_coords-727"><span class="linenos">727</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_o_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">o</span><span class="p">))</span>
</span><span id="Disulfide.compute_local_coords-728"><a href="#Disulfide.compute_local_coords-728"><span class="linenos">728</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cb_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">cb</span><span class="p">))</span>
</span><span id="Disulfide.compute_local_coords-729"><a href="#Disulfide.compute_local_coords-729"><span class="linenos">729</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sg_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">sg</span><span class="p">))</span>
</span><span id="Disulfide.compute_local_coords-730"><a href="#Disulfide.compute_local_coords-730"><span class="linenos">730</span></a>
</span><span id="Disulfide.compute_local_coords-731"><a href="#Disulfide.compute_local_coords-731"><span class="linenos">731</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_prev_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">cpp</span><span class="p">))</span>
</span><span id="Disulfide.compute_local_coords-732"><a href="#Disulfide.compute_local_coords-732"><span class="linenos">732</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_next_prox</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">nnp</span><span class="p">))</span>
</span><span id="Disulfide.compute_local_coords-733"><a href="#Disulfide.compute_local_coords-733"><span class="linenos">733</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_prev_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">cpd</span><span class="p">))</span>
</span><span id="Disulfide.compute_local_coords-734"><a href="#Disulfide.compute_local_coords-734"><span class="linenos">734</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_next_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">nnd</span><span class="p">))</span>
</span><span id="Disulfide.compute_local_coords-735"><a href="#Disulfide.compute_local_coords-735"><span class="linenos">735</span></a>
</span><span id="Disulfide.compute_local_coords-736"><a href="#Disulfide.compute_local_coords-736"><span class="linenos">736</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">n2</span><span class="p">))</span>
</span><span id="Disulfide.compute_local_coords-737"><a href="#Disulfide.compute_local_coords-737"><span class="linenos">737</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ca_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">ca2</span><span class="p">))</span>
</span><span id="Disulfide.compute_local_coords-738"><a href="#Disulfide.compute_local_coords-738"><span class="linenos">738</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_c_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">c2</span><span class="p">))</span>
</span><span id="Disulfide.compute_local_coords-739"><a href="#Disulfide.compute_local_coords-739"><span class="linenos">739</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_o_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">o2</span><span class="p">))</span>
</span><span id="Disulfide.compute_local_coords-740"><a href="#Disulfide.compute_local_coords-740"><span class="linenos">740</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cb_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">cb2</span><span class="p">))</span>
</span><span id="Disulfide.compute_local_coords-741"><a href="#Disulfide.compute_local_coords-741"><span class="linenos">741</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sg_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">turt</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="n">sg2</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Compute the internal coordinates for a properly initialized Disulfide Object.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>self</strong>:  SS initialized Disulfide object
:returns: None, modifies internal state of the input</li>
</ul>
</div>


                            </div>
                            <div id="Disulfide.compute_torsional_energy" class="classattr">
                                        <input id="Disulfide.compute_torsional_energy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">compute_torsional_energy</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="Disulfide.compute_torsional_energy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.compute_torsional_energy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.compute_torsional_energy-743"><a href="#Disulfide.compute_torsional_energy-743"><span class="linenos">743</span></a>    <span class="k">def</span> <span class="nf">compute_torsional_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Disulfide.compute_torsional_energy-744"><a href="#Disulfide.compute_torsional_energy-744"><span class="linenos">744</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.compute_torsional_energy-745"><a href="#Disulfide.compute_torsional_energy-745"><span class="linenos">745</span></a><span class="sd">        Compute the approximate torsional energy for the Disulfide&#39;s</span>
</span><span id="Disulfide.compute_torsional_energy-746"><a href="#Disulfide.compute_torsional_energy-746"><span class="linenos">746</span></a><span class="sd">        conformation and sets its internal state.</span>
</span><span id="Disulfide.compute_torsional_energy-747"><a href="#Disulfide.compute_torsional_energy-747"><span class="linenos">747</span></a><span class="sd">        </span>
</span><span id="Disulfide.compute_torsional_energy-748"><a href="#Disulfide.compute_torsional_energy-748"><span class="linenos">748</span></a><span class="sd">        :return: Energy (kcal/mol)</span>
</span><span id="Disulfide.compute_torsional_energy-749"><a href="#Disulfide.compute_torsional_energy-749"><span class="linenos">749</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.compute_torsional_energy-750"><a href="#Disulfide.compute_torsional_energy-750"><span class="linenos">750</span></a>        <span class="c1"># @TODO find citation for the ss bond energy calculation</span>
</span><span id="Disulfide.compute_torsional_energy-751"><a href="#Disulfide.compute_torsional_energy-751"><span class="linenos">751</span></a>
</span><span id="Disulfide.compute_torsional_energy-752"><a href="#Disulfide.compute_torsional_energy-752"><span class="linenos">752</span></a>        <span class="k">def</span> <span class="nf">torad</span><span class="p">(</span><span class="n">deg</span><span class="p">):</span>
</span><span id="Disulfide.compute_torsional_energy-753"><a href="#Disulfide.compute_torsional_energy-753"><span class="linenos">753</span></a>            <span class="k">return</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">deg</span><span class="p">))</span>
</span><span id="Disulfide.compute_torsional_energy-754"><a href="#Disulfide.compute_torsional_energy-754"><span class="linenos">754</span></a>
</span><span id="Disulfide.compute_torsional_energy-755"><a href="#Disulfide.compute_torsional_energy-755"><span class="linenos">755</span></a>        <span class="n">chi1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi1</span>
</span><span id="Disulfide.compute_torsional_energy-756"><a href="#Disulfide.compute_torsional_energy-756"><span class="linenos">756</span></a>        <span class="n">chi2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi2</span>
</span><span id="Disulfide.compute_torsional_energy-757"><a href="#Disulfide.compute_torsional_energy-757"><span class="linenos">757</span></a>        <span class="n">chi3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span>
</span><span id="Disulfide.compute_torsional_energy-758"><a href="#Disulfide.compute_torsional_energy-758"><span class="linenos">758</span></a>        <span class="n">chi4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi4</span>
</span><span id="Disulfide.compute_torsional_energy-759"><a href="#Disulfide.compute_torsional_energy-759"><span class="linenos">759</span></a>        <span class="n">chi5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi5</span>
</span><span id="Disulfide.compute_torsional_energy-760"><a href="#Disulfide.compute_torsional_energy-760"><span class="linenos">760</span></a>
</span><span id="Disulfide.compute_torsional_energy-761"><a href="#Disulfide.compute_torsional_energy-761"><span class="linenos">761</span></a>        <span class="n">energy</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">torad</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">chi1</span><span class="p">))</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">torad</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">chi5</span><span class="p">)))</span>
</span><span id="Disulfide.compute_torsional_energy-762"><a href="#Disulfide.compute_torsional_energy-762"><span class="linenos">762</span></a>        <span class="n">energy</span> <span class="o">+=</span> <span class="n">cos</span><span class="p">(</span><span class="n">torad</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">chi2</span><span class="p">))</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">torad</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">chi4</span><span class="p">))</span>
</span><span id="Disulfide.compute_torsional_energy-763"><a href="#Disulfide.compute_torsional_energy-763"><span class="linenos">763</span></a>        <span class="n">energy</span> <span class="o">+=</span> <span class="mf">3.5</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">torad</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">chi3</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">torad</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">chi3</span><span class="p">))</span> <span class="o">+</span> <span class="mf">10.1</span>
</span><span id="Disulfide.compute_torsional_energy-764"><a href="#Disulfide.compute_torsional_energy-764"><span class="linenos">764</span></a>
</span><span id="Disulfide.compute_torsional_energy-765"><a href="#Disulfide.compute_torsional_energy-765"><span class="linenos">765</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="n">energy</span>
</span><span id="Disulfide.compute_torsional_energy-766"><a href="#Disulfide.compute_torsional_energy-766"><span class="linenos">766</span></a>        <span class="k">return</span> <span class="n">energy</span>
</span></pre></div>


            <div class="docstring"><p>Compute the approximate torsional energy for the Disulfide's
conformation and sets its internal state.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Energy (kcal/mol)</p>
</blockquote>
</div>


                            </div>
                            <div id="Disulfide.display" class="classattr">
                                        <input id="Disulfide.display-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">display</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">single</span><span class="o">=</span><span class="kc">True</span>, </span><span class="param"><span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span>, </span><span class="param"><span class="n">light</span><span class="o">=</span><span class="kc">True</span>, </span><span class="param"><span class="n">shadows</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.display-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.display"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.display-769"><a href="#Disulfide.display-769"><span class="linenos">769</span></a>    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span> <span class="n">light</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shadows</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Disulfide.display-770"><a href="#Disulfide.display-770"><span class="linenos">770</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.display-771"><a href="#Disulfide.display-771"><span class="linenos">771</span></a><span class="sd">        Display the Disulfide bond in the specific rendering style.</span>
</span><span id="Disulfide.display-772"><a href="#Disulfide.display-772"><span class="linenos">772</span></a>
</span><span id="Disulfide.display-773"><a href="#Disulfide.display-773"><span class="linenos">773</span></a><span class="sd">        :param single: Display the bond in a single panel in the specific style. </span>
</span><span id="Disulfide.display-774"><a href="#Disulfide.display-774"><span class="linenos">774</span></a><span class="sd">        :param style:  Rendering style: One of:</span>
</span><span id="Disulfide.display-775"><a href="#Disulfide.display-775"><span class="linenos">775</span></a><span class="sd">            * &#39;sb&#39; - split bonds</span>
</span><span id="Disulfide.display-776"><a href="#Disulfide.display-776"><span class="linenos">776</span></a><span class="sd">            * &#39;bs&#39; - ball and stick</span>
</span><span id="Disulfide.display-777"><a href="#Disulfide.display-777"><span class="linenos">777</span></a><span class="sd">            * &#39;cpk&#39; - CPK style</span>
</span><span id="Disulfide.display-778"><a href="#Disulfide.display-778"><span class="linenos">778</span></a><span class="sd">            * &#39;pd&#39; - Proximal/Distal style - Red=proximal, Green=Distal</span>
</span><span id="Disulfide.display-779"><a href="#Disulfide.display-779"><span class="linenos">779</span></a><span class="sd">            * &#39;plain&#39; - boring single color</span>
</span><span id="Disulfide.display-780"><a href="#Disulfide.display-780"><span class="linenos">780</span></a><span class="sd">        :param light: If True, light background, if False, dark</span>
</span><span id="Disulfide.display-781"><a href="#Disulfide.display-781"><span class="linenos">781</span></a>
</span><span id="Disulfide.display-782"><a href="#Disulfide.display-782"><span class="linenos">782</span></a><span class="sd">        Example:</span>
</span><span id="Disulfide.display-783"><a href="#Disulfide.display-783"><span class="linenos">783</span></a><span class="sd">        &gt;&gt;&gt; import proteusPy</span>
</span><span id="Disulfide.display-784"><a href="#Disulfide.display-784"><span class="linenos">784</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.Disulfide import Disulfide</span>
</span><span id="Disulfide.display-785"><a href="#Disulfide.display-785"><span class="linenos">785</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideLoader import DisulfideLoader</span>
</span><span id="Disulfide.display-786"><a href="#Disulfide.display-786"><span class="linenos">786</span></a>
</span><span id="Disulfide.display-787"><a href="#Disulfide.display-787"><span class="linenos">787</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = DisulfideLoader(verbose=False, subset=True)</span>
</span><span id="Disulfide.display-788"><a href="#Disulfide.display-788"><span class="linenos">788</span></a><span class="sd">        &gt;&gt;&gt; ss = PDB_SS[0]</span>
</span><span id="Disulfide.display-789"><a href="#Disulfide.display-789"><span class="linenos">789</span></a><span class="sd">        &gt;&gt;&gt; ss.display(style=&#39;cpk&#39;)</span>
</span><span id="Disulfide.display-790"><a href="#Disulfide.display-790"><span class="linenos">790</span></a><span class="sd">        &gt;&gt;&gt; ss.screenshot(style=&#39;bs&#39;, fname=&#39;proteus_logo_sb.png&#39;)</span>
</span><span id="Disulfide.display-791"><a href="#Disulfide.display-791"><span class="linenos">791</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.display-792"><a href="#Disulfide.display-792"><span class="linenos">792</span></a>        <span class="n">src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="Disulfide.display-793"><a href="#Disulfide.display-793"><span class="linenos">793</span></a>        <span class="n">enrg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span>
</span><span id="Disulfide.display-794"><a href="#Disulfide.display-794"><span class="linenos">794</span></a>
</span><span id="Disulfide.display-795"><a href="#Disulfide.display-795"><span class="linenos">795</span></a>        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">src</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal_chain</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal_chain</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">enrg</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol. Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å Cβ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å Tors: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">°&#39;</span>
</span><span id="Disulfide.display-796"><a href="#Disulfide.display-796"><span class="linenos">796</span></a>
</span><span id="Disulfide.display-797"><a href="#Disulfide.display-797"><span class="linenos">797</span></a>        <span class="k">if</span> <span class="n">light</span><span class="p">:</span>
</span><span id="Disulfide.display-798"><a href="#Disulfide.display-798"><span class="linenos">798</span></a>            <span class="n">pv</span><span class="o">.</span><span class="n">set_plot_theme</span><span class="p">(</span><span class="s1">&#39;document&#39;</span><span class="p">)</span>
</span><span id="Disulfide.display-799"><a href="#Disulfide.display-799"><span class="linenos">799</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Disulfide.display-800"><a href="#Disulfide.display-800"><span class="linenos">800</span></a>            <span class="n">pv</span><span class="o">.</span><span class="n">set_plot_theme</span><span class="p">(</span><span class="s1">&#39;dark&#39;</span><span class="p">)</span>
</span><span id="Disulfide.display-801"><a href="#Disulfide.display-801"><span class="linenos">801</span></a>        
</span><span id="Disulfide.display-802"><a href="#Disulfide.display-802"><span class="linenos">802</span></a>        <span class="k">if</span> <span class="n">single</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Disulfide.display-803"><a href="#Disulfide.display-803"><span class="linenos">803</span></a>            <span class="n">_pl</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="n">WINSIZE</span><span class="p">)</span>
</span><span id="Disulfide.display-804"><a href="#Disulfide.display-804"><span class="linenos">804</span></a>            <span class="n">_pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide.display-805"><a href="#Disulfide.display-805"><span class="linenos">805</span></a>            <span class="n">_pl</span><span class="o">.</span><span class="n">enable_anti_aliasing</span><span class="p">(</span><span class="s1">&#39;msaa&#39;</span><span class="p">)</span>
</span><span id="Disulfide.display-806"><a href="#Disulfide.display-806"><span class="linenos">806</span></a>            <span class="n">_pl</span><span class="o">.</span><span class="n">add_camera_orientation_widget</span><span class="p">()</span>            
</span><span id="Disulfide.display-807"><a href="#Disulfide.display-807"><span class="linenos">807</span></a>
</span><span id="Disulfide.display-808"><a href="#Disulfide.display-808"><span class="linenos">808</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">_pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> 
</span><span id="Disulfide.display-809"><a href="#Disulfide.display-809"><span class="linenos">809</span></a>                        <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>        
</span><span id="Disulfide.display-810"><a href="#Disulfide.display-810"><span class="linenos">810</span></a>            <span class="n">_pl</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="Disulfide.display-811"><a href="#Disulfide.display-811"><span class="linenos">811</span></a>            <span class="k">if</span> <span class="n">shadows</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Disulfide.display-812"><a href="#Disulfide.display-812"><span class="linenos">812</span></a>                <span class="n">_pl</span><span class="o">.</span><span class="n">enable_shadows</span><span class="p">()</span>
</span><span id="Disulfide.display-813"><a href="#Disulfide.display-813"><span class="linenos">813</span></a>            <span class="n">_pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="Disulfide.display-814"><a href="#Disulfide.display-814"><span class="linenos">814</span></a>
</span><span id="Disulfide.display-815"><a href="#Disulfide.display-815"><span class="linenos">815</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Disulfide.display-816"><a href="#Disulfide.display-816"><span class="linenos">816</span></a>            <span class="n">pl</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="n">WINSIZE</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</span><span id="Disulfide.display-817"><a href="#Disulfide.display-817"><span class="linenos">817</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.display-818"><a href="#Disulfide.display-818"><span class="linenos">818</span></a>            
</span><span id="Disulfide.display-819"><a href="#Disulfide.display-819"><span class="linenos">819</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide.display-820"><a href="#Disulfide.display-820"><span class="linenos">820</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">enable_anti_aliasing</span><span class="p">(</span><span class="s1">&#39;msaa&#39;</span><span class="p">)</span>
</span><span id="Disulfide.display-821"><a href="#Disulfide.display-821"><span class="linenos">821</span></a>
</span><span id="Disulfide.display-822"><a href="#Disulfide.display-822"><span class="linenos">822</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_camera_orientation_widget</span><span class="p">()</span>
</span><span id="Disulfide.display-823"><a href="#Disulfide.display-823"><span class="linenos">823</span></a>            
</span><span id="Disulfide.display-824"><a href="#Disulfide.display-824"><span class="linenos">824</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;cpk&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="Disulfide.display-825"><a href="#Disulfide.display-825"><span class="linenos">825</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="Disulfide.display-826"><a href="#Disulfide.display-826"><span class="linenos">826</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="Disulfide.display-827"><a href="#Disulfide.display-827"><span class="linenos">827</span></a>
</span><span id="Disulfide.display-828"><a href="#Disulfide.display-828"><span class="linenos">828</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Disulfide.display-829"><a href="#Disulfide.display-829"><span class="linenos">829</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide.display-830"><a href="#Disulfide.display-830"><span class="linenos">830</span></a>            
</span><span id="Disulfide.display-831"><a href="#Disulfide.display-831"><span class="linenos">831</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;bs&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="Disulfide.display-832"><a href="#Disulfide.display-832"><span class="linenos">832</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="Disulfide.display-833"><a href="#Disulfide.display-833"><span class="linenos">833</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="Disulfide.display-834"><a href="#Disulfide.display-834"><span class="linenos">834</span></a>
</span><span id="Disulfide.display-835"><a href="#Disulfide.display-835"><span class="linenos">835</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.display-836"><a href="#Disulfide.display-836"><span class="linenos">836</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide.display-837"><a href="#Disulfide.display-837"><span class="linenos">837</span></a>            
</span><span id="Disulfide.display-838"><a href="#Disulfide.display-838"><span class="linenos">838</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="Disulfide.display-839"><a href="#Disulfide.display-839"><span class="linenos">839</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="Disulfide.display-840"><a href="#Disulfide.display-840"><span class="linenos">840</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="Disulfide.display-841"><a href="#Disulfide.display-841"><span class="linenos">841</span></a>
</span><span id="Disulfide.display-842"><a href="#Disulfide.display-842"><span class="linenos">842</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Disulfide.display-843"><a href="#Disulfide.display-843"><span class="linenos">843</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide.display-844"><a href="#Disulfide.display-844"><span class="linenos">844</span></a>            
</span><span id="Disulfide.display-845"><a href="#Disulfide.display-845"><span class="linenos">845</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;pd&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="Disulfide.display-846"><a href="#Disulfide.display-846"><span class="linenos">846</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="Disulfide.display-847"><a href="#Disulfide.display-847"><span class="linenos">847</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="Disulfide.display-848"><a href="#Disulfide.display-848"><span class="linenos">848</span></a>
</span><span id="Disulfide.display-849"><a href="#Disulfide.display-849"><span class="linenos">849</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">link_views</span><span class="p">()</span>
</span><span id="Disulfide.display-850"><a href="#Disulfide.display-850"><span class="linenos">850</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="Disulfide.display-851"><a href="#Disulfide.display-851"><span class="linenos">851</span></a>            <span class="k">if</span> <span class="n">shadows</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Disulfide.display-852"><a href="#Disulfide.display-852"><span class="linenos">852</span></a>                <span class="n">pl</span><span class="o">.</span><span class="n">enable_shadows</span><span class="p">()</span>
</span><span id="Disulfide.display-853"><a href="#Disulfide.display-853"><span class="linenos">853</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="Disulfide.display-854"><a href="#Disulfide.display-854"><span class="linenos">854</span></a>        <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>Display the Disulfide bond in the specific rendering style.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>single</strong>:  Display the bond in a single panel in the specific style. </li>
<li><strong>style:  Rendering style: One of</strong>: 
<ul>
<li>'sb' - split bonds</li>
<li>'bs' - ball and stick</li>
<li>'cpk' - CPK style</li>
<li>'pd' - Proximal/Distal style - Red=proximal, Green=Distal</li>
<li>'plain' - boring single color</li>
</ul></li>
<li><strong>light</strong>:  If True, light background, if False, dark</li>
</ul>

<p>Example:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">proteusPy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="">proteusPy.Disulfide</a></span> <span class="kn">import</span> <span class="n">Disulfide</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="DisulfideLoader.html">proteusPy.DisulfideLoader</a></span> <span class="kn">import</span> <span class="n">DisulfideLoader</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">PDB_SS</span> <span class="o">=</span> <span class="n">DisulfideLoader</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ss</span> <span class="o">=</span> <span class="n">PDB_SS</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ss</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;cpk&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ss</span><span class="o">.</span><span class="n">screenshot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;bs&#39;</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;proteus_logo_sb.png&#39;</span><span class="p">)</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Disulfide.Distance_neighbors" class="classattr">
                                        <input id="Disulfide.Distance_neighbors-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">Distance_neighbors</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">others</span><span class="p">:</span> <span class="n"><a href="DisulfideList.html#DisulfideList">proteusPy.DisulfideList.DisulfideList</a></span>, </span><span class="param"><span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.Distance_neighbors-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.Distance_neighbors"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.Distance_neighbors-856"><a href="#Disulfide.Distance_neighbors-856"><span class="linenos">856</span></a>    <span class="k">def</span> <span class="nf">Distance_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">others</span><span class="p">:</span> <span class="n">DisulfideList</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="Disulfide.Distance_neighbors-857"><a href="#Disulfide.Distance_neighbors-857"><span class="linenos">857</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.Distance_neighbors-858"><a href="#Disulfide.Distance_neighbors-858"><span class="linenos">858</span></a><span class="sd">        Returns list of Disulfides whose RMS atomic distance is within </span>
</span><span id="Disulfide.Distance_neighbors-859"><a href="#Disulfide.Distance_neighbors-859"><span class="linenos">859</span></a><span class="sd">        the cutoff (Å) in the others list.</span>
</span><span id="Disulfide.Distance_neighbors-860"><a href="#Disulfide.Distance_neighbors-860"><span class="linenos">860</span></a>
</span><span id="Disulfide.Distance_neighbors-861"><a href="#Disulfide.Distance_neighbors-861"><span class="linenos">861</span></a><span class="sd">        :param others: DisulfideList to search</span>
</span><span id="Disulfide.Distance_neighbors-862"><a href="#Disulfide.Distance_neighbors-862"><span class="linenos">862</span></a><span class="sd">        :param cutoff: Distance cutoff (Å)</span>
</span><span id="Disulfide.Distance_neighbors-863"><a href="#Disulfide.Distance_neighbors-863"><span class="linenos">863</span></a><span class="sd">        :return: DisulfideList within the cutoff</span>
</span><span id="Disulfide.Distance_neighbors-864"><a href="#Disulfide.Distance_neighbors-864"><span class="linenos">864</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.Distance_neighbors-865"><a href="#Disulfide.Distance_neighbors-865"><span class="linenos">865</span></a>
</span><span id="Disulfide.Distance_neighbors-866"><a href="#Disulfide.Distance_neighbors-866"><span class="linenos">866</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">ss</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">others</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Distance_RMS</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">cutoff</span><span class="p">]</span>
</span><span id="Disulfide.Distance_neighbors-867"><a href="#Disulfide.Distance_neighbors-867"><span class="linenos">867</span></a>        <span class="k">return</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s1">&#39;neighbors&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns list of Disulfides whose RMS atomic distance is within 
the cutoff (Å) in the others list.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>others</strong>:  DisulfideList to search</li>
<li><strong>cutoff</strong>:  Distance cutoff (Å)</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>DisulfideList within the cutoff</p>
</blockquote>
</div>


                            </div>
                            <div id="Disulfide.Distance_RMS" class="classattr">
                                        <input id="Disulfide.Distance_RMS-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">Distance_RMS</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">other</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="Disulfide.Distance_RMS-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.Distance_RMS"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.Distance_RMS-870"><a href="#Disulfide.Distance_RMS-870"><span class="linenos">870</span></a>    <span class="k">def</span> <span class="nf">Distance_RMS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Disulfide.Distance_RMS-871"><a href="#Disulfide.Distance_RMS-871"><span class="linenos">871</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.Distance_RMS-872"><a href="#Disulfide.Distance_RMS-872"><span class="linenos">872</span></a><span class="sd">        Calculate the RMS distance between the internal coordinates of self and another Disulfide.</span>
</span><span id="Disulfide.Distance_RMS-873"><a href="#Disulfide.Distance_RMS-873"><span class="linenos">873</span></a><span class="sd">        :param other: Comparison Disulfide</span>
</span><span id="Disulfide.Distance_RMS-874"><a href="#Disulfide.Distance_RMS-874"><span class="linenos">874</span></a><span class="sd">        :return: RMS distance (Å)</span>
</span><span id="Disulfide.Distance_RMS-875"><a href="#Disulfide.Distance_RMS-875"><span class="linenos">875</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.Distance_RMS-876"><a href="#Disulfide.Distance_RMS-876"><span class="linenos">876</span></a>
</span><span id="Disulfide.Distance_RMS-877"><a href="#Disulfide.Distance_RMS-877"><span class="linenos">877</span></a>        <span class="c1"># Get internal coordinates of both objects</span>
</span><span id="Disulfide.Distance_RMS-878"><a href="#Disulfide.Distance_RMS-878"><span class="linenos">878</span></a>        <span class="n">ic1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_coords</span><span class="p">()</span>
</span><span id="Disulfide.Distance_RMS-879"><a href="#Disulfide.Distance_RMS-879"><span class="linenos">879</span></a>        <span class="n">ic2</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">internal_coords</span><span class="p">()</span>
</span><span id="Disulfide.Distance_RMS-880"><a href="#Disulfide.Distance_RMS-880"><span class="linenos">880</span></a>
</span><span id="Disulfide.Distance_RMS-881"><a href="#Disulfide.Distance_RMS-881"><span class="linenos">881</span></a>        <span class="c1"># Compute the sum of squared distances between corresponding internal coordinates</span>
</span><span id="Disulfide.Distance_RMS-882"><a href="#Disulfide.Distance_RMS-882"><span class="linenos">882</span></a>        <span class="n">totsq</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ic1</span><span class="p">,</span> <span class="n">ic2</span><span class="p">))</span>
</span><span id="Disulfide.Distance_RMS-883"><a href="#Disulfide.Distance_RMS-883"><span class="linenos">883</span></a>
</span><span id="Disulfide.Distance_RMS-884"><a href="#Disulfide.Distance_RMS-884"><span class="linenos">884</span></a>        <span class="c1"># Compute the mean of the squared distances</span>
</span><span id="Disulfide.Distance_RMS-885"><a href="#Disulfide.Distance_RMS-885"><span class="linenos">885</span></a>        <span class="n">totsq</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ic1</span><span class="p">)</span>
</span><span id="Disulfide.Distance_RMS-886"><a href="#Disulfide.Distance_RMS-886"><span class="linenos">886</span></a>
</span><span id="Disulfide.Distance_RMS-887"><a href="#Disulfide.Distance_RMS-887"><span class="linenos">887</span></a>        <span class="c1"># Take the square root of the mean to get the RMS distance</span>
</span><span id="Disulfide.Distance_RMS-888"><a href="#Disulfide.Distance_RMS-888"><span class="linenos">888</span></a>        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">totsq</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Calculate the RMS distance between the internal coordinates of self and another Disulfide.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>other</strong>:  Comparison Disulfide</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>RMS distance (Å)</p>
</blockquote>
</div>


                            </div>
                            <div id="Disulfide.get_chains" class="classattr">
                                        <input id="Disulfide.get_chains-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_chains</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">tuple</span>:</span></span>

                <label class="view-source-button" for="Disulfide.get_chains-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.get_chains"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.get_chains-890"><a href="#Disulfide.get_chains-890"><span class="linenos">890</span></a>    <span class="k">def</span> <span class="nf">get_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="Disulfide.get_chains-891"><a href="#Disulfide.get_chains-891"><span class="linenos">891</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.get_chains-892"><a href="#Disulfide.get_chains-892"><span class="linenos">892</span></a><span class="sd">        Return the proximal and distal chain IDs for the Disulfide.</span>
</span><span id="Disulfide.get_chains-893"><a href="#Disulfide.get_chains-893"><span class="linenos">893</span></a>
</span><span id="Disulfide.get_chains-894"><a href="#Disulfide.get_chains-894"><span class="linenos">894</span></a><span class="sd">        :return: tuple (proximal, distal) chain IDs</span>
</span><span id="Disulfide.get_chains-895"><a href="#Disulfide.get_chains-895"><span class="linenos">895</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.get_chains-896"><a href="#Disulfide.get_chains-896"><span class="linenos">896</span></a>        <span class="n">prox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proximal_chain</span>
</span><span id="Disulfide.get_chains-897"><a href="#Disulfide.get_chains-897"><span class="linenos">897</span></a>        <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distal_chain</span>
</span><span id="Disulfide.get_chains-898"><a href="#Disulfide.get_chains-898"><span class="linenos">898</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">prox</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the proximal and distal chain IDs for the Disulfide.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>tuple (proximal, distal) chain IDs</p>
</blockquote>
</div>


                            </div>
                            <div id="Disulfide.get_permissive" class="classattr">
                                        <input id="Disulfide.get_permissive-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_permissive</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="Disulfide.get_permissive-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.get_permissive"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.get_permissive-900"><a href="#Disulfide.get_permissive-900"><span class="linenos">900</span></a>    <span class="k">def</span> <span class="nf">get_permissive</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Disulfide.get_permissive-901"><a href="#Disulfide.get_permissive-901"><span class="linenos">901</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.get_permissive-902"><a href="#Disulfide.get_permissive-902"><span class="linenos">902</span></a><span class="sd">        Return the Permissive flag state. (Used in PDB parsing)</span>
</span><span id="Disulfide.get_permissive-903"><a href="#Disulfide.get_permissive-903"><span class="linenos">903</span></a>
</span><span id="Disulfide.get_permissive-904"><a href="#Disulfide.get_permissive-904"><span class="linenos">904</span></a><span class="sd">        :return: Permissive state</span>
</span><span id="Disulfide.get_permissive-905"><a href="#Disulfide.get_permissive-905"><span class="linenos">905</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.get_permissive-906"><a href="#Disulfide.get_permissive-906"><span class="linenos">906</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">PERMISIVE</span>
</span></pre></div>


            <div class="docstring"><p>Return the Permissive flag state. (Used in PDB parsing)</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Permissive state</p>
</blockquote>
</div>


                            </div>
                            <div id="Disulfide.get_full_id" class="classattr">
                                        <input id="Disulfide.get_full_id-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_full_id</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.get_full_id-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.get_full_id"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.get_full_id-908"><a href="#Disulfide.get_full_id-908"><span class="linenos">908</span></a>    <span class="k">def</span> <span class="nf">get_full_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide.get_full_id-909"><a href="#Disulfide.get_full_id-909"><span class="linenos">909</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.get_full_id-910"><a href="#Disulfide.get_full_id-910"><span class="linenos">910</span></a><span class="sd">        Return the Disulfide full IDs (Used with BIO.PDB)</span>
</span><span id="Disulfide.get_full_id-911"><a href="#Disulfide.get_full_id-911"><span class="linenos">911</span></a>
</span><span id="Disulfide.get_full_id-912"><a href="#Disulfide.get_full_id-912"><span class="linenos">912</span></a><span class="sd">        :return: Disulfide full IDs</span>
</span><span id="Disulfide.get_full_id-913"><a href="#Disulfide.get_full_id-913"><span class="linenos">913</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.get_full_id-914"><a href="#Disulfide.get_full_id-914"><span class="linenos">914</span></a>        <span class="k">return</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal_residue_fullid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distal_residue_fullid</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Return the Disulfide full IDs (Used with BIO.PDB)</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Disulfide full IDs</p>
</blockquote>
</div>


                            </div>
                            <div id="Disulfide.initialize_disulfide_from_chain" class="classattr">
                                        <input id="Disulfide.initialize_disulfide_from_chain-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">initialize_disulfide_from_chain</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">chain1</span>, </span><span class="param"><span class="n">chain2</span>, </span><span class="param"><span class="n">proximal</span>, </span><span class="param"><span class="n">distal</span>, </span><span class="param"><span class="n">resolution</span>, </span><span class="param"><span class="n">quiet</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.initialize_disulfide_from_chain-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.initialize_disulfide_from_chain"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.initialize_disulfide_from_chain-916"><a href="#Disulfide.initialize_disulfide_from_chain-916"><span class="linenos"> 916</span></a>    <span class="k">def</span> <span class="nf">initialize_disulfide_from_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chain1</span><span class="p">,</span> <span class="n">chain2</span><span class="p">,</span> <span class="n">proximal</span><span class="p">,</span> 
</span><span id="Disulfide.initialize_disulfide_from_chain-917"><a href="#Disulfide.initialize_disulfide_from_chain-917"><span class="linenos"> 917</span></a>    									<span class="n">distal</span><span class="p">,</span> <span class="n">resolution</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-918"><a href="#Disulfide.initialize_disulfide_from_chain-918"><span class="linenos"> 918</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-919"><a href="#Disulfide.initialize_disulfide_from_chain-919"><span class="linenos"> 919</span></a><span class="sd">        Initialize a new Disulfide object with atomic coordinates from </span>
</span><span id="Disulfide.initialize_disulfide_from_chain-920"><a href="#Disulfide.initialize_disulfide_from_chain-920"><span class="linenos"> 920</span></a><span class="sd">        the proximal and distal coordinates, typically taken from a PDB file.</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-921"><a href="#Disulfide.initialize_disulfide_from_chain-921"><span class="linenos"> 921</span></a><span class="sd">        This routine is primarily used internally when building the compressed</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-922"><a href="#Disulfide.initialize_disulfide_from_chain-922"><span class="linenos"> 922</span></a><span class="sd">        database.</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-923"><a href="#Disulfide.initialize_disulfide_from_chain-923"><span class="linenos"> 923</span></a>
</span><span id="Disulfide.initialize_disulfide_from_chain-924"><a href="#Disulfide.initialize_disulfide_from_chain-924"><span class="linenos"> 924</span></a><span class="sd">        :param chain1: list of Residues in the model, eg: chain = model[&#39;A&#39;]</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-925"><a href="#Disulfide.initialize_disulfide_from_chain-925"><span class="linenos"> 925</span></a><span class="sd">        :param chain2: list of Residues in the model, eg: chain = model[&#39;A&#39;]</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-926"><a href="#Disulfide.initialize_disulfide_from_chain-926"><span class="linenos"> 926</span></a><span class="sd">        :param proximal: proximal residue sequence ID</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-927"><a href="#Disulfide.initialize_disulfide_from_chain-927"><span class="linenos"> 927</span></a><span class="sd">        :param distal: distal residue sequence ID</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-928"><a href="#Disulfide.initialize_disulfide_from_chain-928"><span class="linenos"> 928</span></a><span class="sd">        :param resolution: structure resolution</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-929"><a href="#Disulfide.initialize_disulfide_from_chain-929"><span class="linenos"> 929</span></a><span class="sd">        :param quiet: Quiet or noisy parsing, defaults to True</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-930"><a href="#Disulfide.initialize_disulfide_from_chain-930"><span class="linenos"> 930</span></a><span class="sd">        :raises DisulfideConstructionWarning: Raised when not parsed correctly</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-931"><a href="#Disulfide.initialize_disulfide_from_chain-931"><span class="linenos"> 931</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-932"><a href="#Disulfide.initialize_disulfide_from_chain-932"><span class="linenos"> 932</span></a>        <span class="nb">id</span> <span class="o">=</span> <span class="n">chain1</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-933"><a href="#Disulfide.initialize_disulfide_from_chain-933"><span class="linenos"> 933</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_id</span> <span class="o">=</span> <span class="nb">id</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-934"><a href="#Disulfide.initialize_disulfide_from_chain-934"><span class="linenos"> 934</span></a>        
</span><span id="Disulfide.initialize_disulfide_from_chain-935"><a href="#Disulfide.initialize_disulfide_from_chain-935"><span class="linenos"> 935</span></a>        <span class="n">chi1</span> <span class="o">=</span> <span class="n">chi2</span> <span class="o">=</span> <span class="n">chi3</span> <span class="o">=</span> <span class="n">chi4</span> <span class="o">=</span> <span class="n">chi5</span> <span class="o">=</span> <span class="n">_ANG_INIT</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-936"><a href="#Disulfide.initialize_disulfide_from_chain-936"><span class="linenos"> 936</span></a>
</span><span id="Disulfide.initialize_disulfide_from_chain-937"><a href="#Disulfide.initialize_disulfide_from_chain-937"><span class="linenos"> 937</span></a>        <span class="n">prox</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">proximal</span><span class="p">)</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-938"><a href="#Disulfide.initialize_disulfide_from_chain-938"><span class="linenos"> 938</span></a>        <span class="n">dist</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">distal</span><span class="p">)</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-939"><a href="#Disulfide.initialize_disulfide_from_chain-939"><span class="linenos"> 939</span></a>
</span><span id="Disulfide.initialize_disulfide_from_chain-940"><a href="#Disulfide.initialize_disulfide_from_chain-940"><span class="linenos"> 940</span></a>        <span class="n">prox_residue</span> <span class="o">=</span> <span class="n">chain1</span><span class="p">[</span><span class="n">prox</span><span class="p">]</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-941"><a href="#Disulfide.initialize_disulfide_from_chain-941"><span class="linenos"> 941</span></a>        <span class="n">dist_residue</span> <span class="o">=</span> <span class="n">chain2</span><span class="p">[</span><span class="n">dist</span><span class="p">]</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-942"><a href="#Disulfide.initialize_disulfide_from_chain-942"><span class="linenos"> 942</span></a>
</span><span id="Disulfide.initialize_disulfide_from_chain-943"><a href="#Disulfide.initialize_disulfide_from_chain-943"><span class="linenos"> 943</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">prox_residue</span><span class="o">.</span><span class="n">get_resname</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;CYS&#39;</span> <span class="ow">or</span> <span class="n">dist_residue</span><span class="o">.</span><span class="n">get_resname</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;CYS&#39;</span><span class="p">):</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-944"><a href="#Disulfide.initialize_disulfide_from_chain-944"><span class="linenos"> 944</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;build_disulfide() requires CYS at both residues: </span><span class="si">{</span><span class="n">prox</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">prox_residue</span><span class="o">.</span><span class="n">get_resname</span><span class="p">()</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">dist</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">dist_residue</span><span class="o">.</span><span class="n">get_resname</span><span class="p">()</span><span class="si">}</span><span class="s1"> Chain: </span><span class="si">{</span><span class="n">prox_residue</span><span class="o">.</span><span class="n">get_segid</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-945"><a href="#Disulfide.initialize_disulfide_from_chain-945"><span class="linenos"> 945</span></a>
</span><span id="Disulfide.initialize_disulfide_from_chain-946"><a href="#Disulfide.initialize_disulfide_from_chain-946"><span class="linenos"> 946</span></a>        <span class="c1"># set the objects proximal and distal values</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-947"><a href="#Disulfide.initialize_disulfide_from_chain-947"><span class="linenos"> 947</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_resnum</span><span class="p">(</span><span class="n">proximal</span><span class="p">,</span> <span class="n">distal</span><span class="p">)</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-948"><a href="#Disulfide.initialize_disulfide_from_chain-948"><span class="linenos"> 948</span></a>    
</span><span id="Disulfide.initialize_disulfide_from_chain-949"><a href="#Disulfide.initialize_disulfide_from_chain-949"><span class="linenos"> 949</span></a>        <span class="k">if</span> <span class="n">resolution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-950"><a href="#Disulfide.initialize_disulfide_from_chain-950"><span class="linenos"> 950</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="n">resolution</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-951"><a href="#Disulfide.initialize_disulfide_from_chain-951"><span class="linenos"> 951</span></a>
</span><span id="Disulfide.initialize_disulfide_from_chain-952"><a href="#Disulfide.initialize_disulfide_from_chain-952"><span class="linenos"> 952</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal_chain</span> <span class="o">=</span> <span class="n">chain1</span><span class="o">.</span><span class="n">get_id</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-953"><a href="#Disulfide.initialize_disulfide_from_chain-953"><span class="linenos"> 953</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal_chain</span> <span class="o">=</span> <span class="n">chain2</span><span class="o">.</span><span class="n">get_id</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-954"><a href="#Disulfide.initialize_disulfide_from_chain-954"><span class="linenos"> 954</span></a>
</span><span id="Disulfide.initialize_disulfide_from_chain-955"><a href="#Disulfide.initialize_disulfide_from_chain-955"><span class="linenos"> 955</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal_residue_fullid</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-956"><a href="#Disulfide.initialize_disulfide_from_chain-956"><span class="linenos"> 956</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal_residue_fullid</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="o">.</span><span class="n">get_full_id</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-957"><a href="#Disulfide.initialize_disulfide_from_chain-957"><span class="linenos"> 957</span></a>
</span><span id="Disulfide.initialize_disulfide_from_chain-958"><a href="#Disulfide.initialize_disulfide_from_chain-958"><span class="linenos"> 958</span></a>        <span class="k">if</span> <span class="n">quiet</span><span class="p">:</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-959"><a href="#Disulfide.initialize_disulfide_from_chain-959"><span class="linenos"> 959</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">DisulfideConstructionWarning</span><span class="p">)</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-960"><a href="#Disulfide.initialize_disulfide_from_chain-960"><span class="linenos"> 960</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-961"><a href="#Disulfide.initialize_disulfide_from_chain-961"><span class="linenos"> 961</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;always&quot;</span><span class="p">)</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-962"><a href="#Disulfide.initialize_disulfide_from_chain-962"><span class="linenos"> 962</span></a>
</span><span id="Disulfide.initialize_disulfide_from_chain-963"><a href="#Disulfide.initialize_disulfide_from_chain-963"><span class="linenos"> 963</span></a>        <span class="c1"># grab the coordinates for the proximal and distal residues as vectors </span>
</span><span id="Disulfide.initialize_disulfide_from_chain-964"><a href="#Disulfide.initialize_disulfide_from_chain-964"><span class="linenos"> 964</span></a>        <span class="c1"># so we can do math on them later</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-965"><a href="#Disulfide.initialize_disulfide_from_chain-965"><span class="linenos"> 965</span></a>        <span class="c1"># proximal residue</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-966"><a href="#Disulfide.initialize_disulfide_from_chain-966"><span class="linenos"> 966</span></a>        
</span><span id="Disulfide.initialize_disulfide_from_chain-967"><a href="#Disulfide.initialize_disulfide_from_chain-967"><span class="linenos"> 967</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-968"><a href="#Disulfide.initialize_disulfide_from_chain-968"><span class="linenos"> 968</span></a>            <span class="n">n1</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-969"><a href="#Disulfide.initialize_disulfide_from_chain-969"><span class="linenos"> 969</span></a>            <span class="n">ca1</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-970"><a href="#Disulfide.initialize_disulfide_from_chain-970"><span class="linenos"> 970</span></a>            <span class="n">c1</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-971"><a href="#Disulfide.initialize_disulfide_from_chain-971"><span class="linenos"> 971</span></a>            <span class="n">o1</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-972"><a href="#Disulfide.initialize_disulfide_from_chain-972"><span class="linenos"> 972</span></a>            <span class="n">cb1</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="p">[</span><span class="s1">&#39;CB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-973"><a href="#Disulfide.initialize_disulfide_from_chain-973"><span class="linenos"> 973</span></a>            <span class="n">sg1</span> <span class="o">=</span> <span class="n">prox_residue</span><span class="p">[</span><span class="s1">&#39;SG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-974"><a href="#Disulfide.initialize_disulfide_from_chain-974"><span class="linenos"> 974</span></a>            
</span><span id="Disulfide.initialize_disulfide_from_chain-975"><a href="#Disulfide.initialize_disulfide_from_chain-975"><span class="linenos"> 975</span></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-976"><a href="#Disulfide.initialize_disulfide_from_chain-976"><span class="linenos"> 976</span></a>            <span class="k">raise</span> <span class="n">DisulfideConstructionWarning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid or missing coordinates for proximal residue </span><span class="si">{</span><span class="n">proximal</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-977"><a href="#Disulfide.initialize_disulfide_from_chain-977"><span class="linenos"> 977</span></a>        
</span><span id="Disulfide.initialize_disulfide_from_chain-978"><a href="#Disulfide.initialize_disulfide_from_chain-978"><span class="linenos"> 978</span></a>        <span class="c1"># distal residue</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-979"><a href="#Disulfide.initialize_disulfide_from_chain-979"><span class="linenos"> 979</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-980"><a href="#Disulfide.initialize_disulfide_from_chain-980"><span class="linenos"> 980</span></a>            <span class="n">n2</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-981"><a href="#Disulfide.initialize_disulfide_from_chain-981"><span class="linenos"> 981</span></a>            <span class="n">ca2</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-982"><a href="#Disulfide.initialize_disulfide_from_chain-982"><span class="linenos"> 982</span></a>            <span class="n">c2</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-983"><a href="#Disulfide.initialize_disulfide_from_chain-983"><span class="linenos"> 983</span></a>            <span class="n">o2</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-984"><a href="#Disulfide.initialize_disulfide_from_chain-984"><span class="linenos"> 984</span></a>            <span class="n">cb2</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="p">[</span><span class="s1">&#39;CB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-985"><a href="#Disulfide.initialize_disulfide_from_chain-985"><span class="linenos"> 985</span></a>            <span class="n">sg2</span> <span class="o">=</span> <span class="n">dist_residue</span><span class="p">[</span><span class="s1">&#39;SG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-986"><a href="#Disulfide.initialize_disulfide_from_chain-986"><span class="linenos"> 986</span></a>
</span><span id="Disulfide.initialize_disulfide_from_chain-987"><a href="#Disulfide.initialize_disulfide_from_chain-987"><span class="linenos"> 987</span></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-988"><a href="#Disulfide.initialize_disulfide_from_chain-988"><span class="linenos"> 988</span></a>            <span class="k">raise</span> <span class="n">DisulfideConstructionWarning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid or missing coordinates for distal residue </span><span class="si">{</span><span class="n">distal</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-989"><a href="#Disulfide.initialize_disulfide_from_chain-989"><span class="linenos"> 989</span></a>        
</span><span id="Disulfide.initialize_disulfide_from_chain-990"><a href="#Disulfide.initialize_disulfide_from_chain-990"><span class="linenos"> 990</span></a>        <span class="c1"># previous residue and next residue - optional, used for phi, psi calculations</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-991"><a href="#Disulfide.initialize_disulfide_from_chain-991"><span class="linenos"> 991</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-992"><a href="#Disulfide.initialize_disulfide_from_chain-992"><span class="linenos"> 992</span></a>            <span class="n">prevprox</span> <span class="o">=</span> <span class="n">chain1</span><span class="p">[</span><span class="n">prox</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-993"><a href="#Disulfide.initialize_disulfide_from_chain-993"><span class="linenos"> 993</span></a>            <span class="n">nextprox</span> <span class="o">=</span> <span class="n">chain1</span><span class="p">[</span><span class="n">prox</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-994"><a href="#Disulfide.initialize_disulfide_from_chain-994"><span class="linenos"> 994</span></a>
</span><span id="Disulfide.initialize_disulfide_from_chain-995"><a href="#Disulfide.initialize_disulfide_from_chain-995"><span class="linenos"> 995</span></a>            <span class="n">prevdist</span> <span class="o">=</span> <span class="n">chain2</span><span class="p">[</span><span class="n">dist</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-996"><a href="#Disulfide.initialize_disulfide_from_chain-996"><span class="linenos"> 996</span></a>            <span class="n">nextdist</span> <span class="o">=</span> <span class="n">chain2</span><span class="p">[</span><span class="n">dist</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-997"><a href="#Disulfide.initialize_disulfide_from_chain-997"><span class="linenos"> 997</span></a>
</span><span id="Disulfide.initialize_disulfide_from_chain-998"><a href="#Disulfide.initialize_disulfide_from_chain-998"><span class="linenos"> 998</span></a>            <span class="n">cprev_prox</span> <span class="o">=</span> <span class="n">prevprox</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-999"><a href="#Disulfide.initialize_disulfide_from_chain-999"><span class="linenos"> 999</span></a>            <span class="n">nnext_prox</span> <span class="o">=</span> <span class="n">nextprox</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1000"><a href="#Disulfide.initialize_disulfide_from_chain-1000"><span class="linenos">1000</span></a>
</span><span id="Disulfide.initialize_disulfide_from_chain-1001"><a href="#Disulfide.initialize_disulfide_from_chain-1001"><span class="linenos">1001</span></a>            <span class="n">cprev_dist</span> <span class="o">=</span> <span class="n">prevdist</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1002"><a href="#Disulfide.initialize_disulfide_from_chain-1002"><span class="linenos">1002</span></a>            <span class="n">nnext_dist</span> <span class="o">=</span> <span class="n">nextdist</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_vector</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1003"><a href="#Disulfide.initialize_disulfide_from_chain-1003"><span class="linenos">1003</span></a>
</span><span id="Disulfide.initialize_disulfide_from_chain-1004"><a href="#Disulfide.initialize_disulfide_from_chain-1004"><span class="linenos">1004</span></a>            <span class="c1"># compute phi, psi for prox and distal</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1005"><a href="#Disulfide.initialize_disulfide_from_chain-1005"><span class="linenos">1005</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">phiprox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">cprev_prox</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">ca1</span><span class="p">,</span> <span class="n">c1</span><span class="p">))</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1006"><a href="#Disulfide.initialize_disulfide_from_chain-1006"><span class="linenos">1006</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">psiprox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">ca1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">nnext_prox</span><span class="p">))</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1007"><a href="#Disulfide.initialize_disulfide_from_chain-1007"><span class="linenos">1007</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">phidist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">cprev_dist</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">ca2</span><span class="p">,</span> <span class="n">c2</span><span class="p">))</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1008"><a href="#Disulfide.initialize_disulfide_from_chain-1008"><span class="linenos">1008</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">psidist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">n2</span><span class="p">,</span> <span class="n">ca2</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">nnext_dist</span><span class="p">))</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1009"><a href="#Disulfide.initialize_disulfide_from_chain-1009"><span class="linenos">1009</span></a>
</span><span id="Disulfide.initialize_disulfide_from_chain-1010"><a href="#Disulfide.initialize_disulfide_from_chain-1010"><span class="linenos">1010</span></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1011"><a href="#Disulfide.initialize_disulfide_from_chain-1011"><span class="linenos">1011</span></a>            <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Missing coords for: </span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">prox</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s1"> or </span><span class="si">{</span><span class="n">dist</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1"> for SS </span><span class="si">{</span><span class="n">proximal</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">distal</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1012"><a href="#Disulfide.initialize_disulfide_from_chain-1012"><span class="linenos">1012</span></a>            <span class="n">cprev_prox</span> <span class="o">=</span> <span class="n">nnext_prox</span> <span class="o">=</span> <span class="n">cprev_dist</span> <span class="o">=</span> <span class="n">nnext_dist</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1013"><a href="#Disulfide.initialize_disulfide_from_chain-1013"><span class="linenos">1013</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">missing_atoms</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1014"><a href="#Disulfide.initialize_disulfide_from_chain-1014"><span class="linenos">1014</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">,</span> <span class="n">DisulfideConstructionWarning</span><span class="p">)</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1015"><a href="#Disulfide.initialize_disulfide_from_chain-1015"><span class="linenos">1015</span></a>
</span><span id="Disulfide.initialize_disulfide_from_chain-1016"><a href="#Disulfide.initialize_disulfide_from_chain-1016"><span class="linenos">1016</span></a>        <span class="c1"># update the positions and conformation</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1017"><a href="#Disulfide.initialize_disulfide_from_chain-1017"><span class="linenos">1017</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_positions</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">ca1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">o1</span><span class="p">,</span> <span class="n">cb1</span><span class="p">,</span> <span class="n">sg1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">ca2</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">o2</span><span class="p">,</span> <span class="n">cb2</span><span class="p">,</span> 
</span><span id="Disulfide.initialize_disulfide_from_chain-1018"><a href="#Disulfide.initialize_disulfide_from_chain-1018"><span class="linenos">1018</span></a>                           <span class="n">sg2</span><span class="p">,</span> <span class="n">cprev_prox</span><span class="p">,</span> <span class="n">nnext_prox</span><span class="p">,</span> <span class="n">cprev_dist</span><span class="p">,</span> <span class="n">nnext_dist</span><span class="p">)</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1019"><a href="#Disulfide.initialize_disulfide_from_chain-1019"><span class="linenos">1019</span></a>        
</span><span id="Disulfide.initialize_disulfide_from_chain-1020"><a href="#Disulfide.initialize_disulfide_from_chain-1020"><span class="linenos">1020</span></a>        <span class="c1"># calculate and set the disulfide dihedral angles</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1021"><a href="#Disulfide.initialize_disulfide_from_chain-1021"><span class="linenos">1021</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">ca1</span><span class="p">,</span> <span class="n">cb1</span><span class="p">,</span> <span class="n">sg1</span><span class="p">))</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1022"><a href="#Disulfide.initialize_disulfide_from_chain-1022"><span class="linenos">1022</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">ca1</span><span class="p">,</span> <span class="n">cb1</span><span class="p">,</span> <span class="n">sg1</span><span class="p">,</span> <span class="n">sg2</span><span class="p">))</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1023"><a href="#Disulfide.initialize_disulfide_from_chain-1023"><span class="linenos">1023</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">cb1</span><span class="p">,</span> <span class="n">sg1</span><span class="p">,</span> <span class="n">sg2</span><span class="p">,</span> <span class="n">cb2</span><span class="p">))</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1024"><a href="#Disulfide.initialize_disulfide_from_chain-1024"><span class="linenos">1024</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">sg1</span><span class="p">,</span> <span class="n">sg2</span><span class="p">,</span> <span class="n">cb2</span><span class="p">,</span> <span class="n">ca2</span><span class="p">))</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1025"><a href="#Disulfide.initialize_disulfide_from_chain-1025"><span class="linenos">1025</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">sg2</span><span class="p">,</span> <span class="n">cb2</span><span class="p">,</span> <span class="n">ca2</span><span class="p">,</span> <span class="n">n2</span><span class="p">))</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1026"><a href="#Disulfide.initialize_disulfide_from_chain-1026"><span class="linenos">1026</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">calc_dihedral</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">ca1</span><span class="p">,</span> <span class="n">ca2</span><span class="p">,</span> <span class="n">n2</span><span class="p">))</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1027"><a href="#Disulfide.initialize_disulfide_from_chain-1027"><span class="linenos">1027</span></a>
</span><span id="Disulfide.initialize_disulfide_from_chain-1028"><a href="#Disulfide.initialize_disulfide_from_chain-1028"><span class="linenos">1028</span></a>
</span><span id="Disulfide.initialize_disulfide_from_chain-1029"><a href="#Disulfide.initialize_disulfide_from_chain-1029"><span class="linenos">1029</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span> <span class="o">=</span> <span class="n">distance3d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span><span class="p">)</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1030"><a href="#Disulfide.initialize_disulfide_from_chain-1030"><span class="linenos">1030</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_distance</span> <span class="o">=</span> <span class="n">distance3d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span><span class="p">)</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1031"><a href="#Disulfide.initialize_disulfide_from_chain-1031"><span class="linenos">1031</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">chi1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span><span class="p">,</span> 
</span><span id="Disulfide.initialize_disulfide_from_chain-1032"><a href="#Disulfide.initialize_disulfide_from_chain-1032"><span class="linenos">1032</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">chi4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi5</span><span class="p">))</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1033"><a href="#Disulfide.initialize_disulfide_from_chain-1033"><span class="linenos">1033</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Torsion_Length</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1034"><a href="#Disulfide.initialize_disulfide_from_chain-1034"><span class="linenos">1034</span></a>
</span><span id="Disulfide.initialize_disulfide_from_chain-1035"><a href="#Disulfide.initialize_disulfide_from_chain-1035"><span class="linenos">1035</span></a>        <span class="c1"># calculate and set the SS bond torsional energy</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1036"><a href="#Disulfide.initialize_disulfide_from_chain-1036"><span class="linenos">1036</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">compute_torsional_energy</span><span class="p">()</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1037"><a href="#Disulfide.initialize_disulfide_from_chain-1037"><span class="linenos">1037</span></a>
</span><span id="Disulfide.initialize_disulfide_from_chain-1038"><a href="#Disulfide.initialize_disulfide_from_chain-1038"><span class="linenos">1038</span></a>        <span class="c1"># compute and set the local coordinates</span>
</span><span id="Disulfide.initialize_disulfide_from_chain-1039"><a href="#Disulfide.initialize_disulfide_from_chain-1039"><span class="linenos">1039</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">compute_local_coords</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Initialize a new Disulfide object with atomic coordinates from 
the proximal and distal coordinates, typically taken from a PDB file.
This routine is primarily used internally when building the compressed
database.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>chain1: list of Residues in the model, eg</strong>:  chain = model['A']</li>
<li><strong>chain2: list of Residues in the model, eg</strong>:  chain = model['A']</li>
<li><strong>proximal</strong>:  proximal residue sequence ID</li>
<li><strong>distal</strong>:  distal residue sequence ID</li>
<li><strong>resolution</strong>:  structure resolution</li>
<li><strong>quiet</strong>:  Quiet or noisy parsing, defaults to True</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>DisulfideConstructionWarning</strong>:  Raised when not parsed correctly</li>
</ul>
</div>


                            </div>
                            <div id="Disulfide.internal_coords" class="classattr">
                                        <input id="Disulfide.internal_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">internal_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="n">array</span><span class="o">&gt;</span>:</span></span>

                <label class="view-source-button" for="Disulfide.internal_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.internal_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.internal_coords-1041"><a href="#Disulfide.internal_coords-1041"><span class="linenos">1041</span></a>    <span class="k">def</span> <span class="nf">internal_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
</span><span id="Disulfide.internal_coords-1042"><a href="#Disulfide.internal_coords-1042"><span class="linenos">1042</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.internal_coords-1043"><a href="#Disulfide.internal_coords-1043"><span class="linenos">1043</span></a><span class="sd">        Returns the internal coordinates for the Disulfide.</span>
</span><span id="Disulfide.internal_coords-1044"><a href="#Disulfide.internal_coords-1044"><span class="linenos">1044</span></a><span class="sd">        If there are missing atoms the extra atoms for the proximal</span>
</span><span id="Disulfide.internal_coords-1045"><a href="#Disulfide.internal_coords-1045"><span class="linenos">1045</span></a><span class="sd">        and distal N and C are set to [0,0,0]. This is needed for the center of</span>
</span><span id="Disulfide.internal_coords-1046"><a href="#Disulfide.internal_coords-1046"><span class="linenos">1046</span></a><span class="sd">        mass calculations, used when rendering.</span>
</span><span id="Disulfide.internal_coords-1047"><a href="#Disulfide.internal_coords-1047"><span class="linenos">1047</span></a>
</span><span id="Disulfide.internal_coords-1048"><a href="#Disulfide.internal_coords-1048"><span class="linenos">1048</span></a><span class="sd">        :return: Array containing the coordinates, [16][3].</span>
</span><span id="Disulfide.internal_coords-1049"><a href="#Disulfide.internal_coords-1049"><span class="linenos">1049</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.internal_coords-1050"><a href="#Disulfide.internal_coords-1050"><span class="linenos">1050</span></a>        
</span><span id="Disulfide.internal_coords-1051"><a href="#Disulfide.internal_coords-1051"><span class="linenos">1051</span></a>        <span class="c1"># if we don&#39;t have the prior and next atoms we initialize those</span>
</span><span id="Disulfide.internal_coords-1052"><a href="#Disulfide.internal_coords-1052"><span class="linenos">1052</span></a>        <span class="c1"># atoms to the origin so as to not effect the center of mass calculations</span>
</span><span id="Disulfide.internal_coords-1053"><a href="#Disulfide.internal_coords-1053"><span class="linenos">1053</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">missing_atoms</span><span class="p">:</span>
</span><span id="Disulfide.internal_coords-1054"><a href="#Disulfide.internal_coords-1054"><span class="linenos">1054</span></a>            <span class="n">res_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span>
</span><span id="Disulfide.internal_coords-1055"><a href="#Disulfide.internal_coords-1055"><span class="linenos">1055</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords-1056"><a href="#Disulfide.internal_coords-1056"><span class="linenos">1056</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_ca_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords-1057"><a href="#Disulfide.internal_coords-1057"><span class="linenos">1057</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords-1058"><a href="#Disulfide.internal_coords-1058"><span class="linenos">1058</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_o_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="Disulfide.internal_coords-1059"><a href="#Disulfide.internal_coords-1059"><span class="linenos">1059</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cb_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords-1060"><a href="#Disulfide.internal_coords-1060"><span class="linenos">1060</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sg_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords-1061"><a href="#Disulfide.internal_coords-1061"><span class="linenos">1061</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords-1062"><a href="#Disulfide.internal_coords-1062"><span class="linenos">1062</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_ca_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords-1063"><a href="#Disulfide.internal_coords-1063"><span class="linenos">1063</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="Disulfide.internal_coords-1064"><a href="#Disulfide.internal_coords-1064"><span class="linenos">1064</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_o_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="Disulfide.internal_coords-1065"><a href="#Disulfide.internal_coords-1065"><span class="linenos">1065</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cb_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords-1066"><a href="#Disulfide.internal_coords-1066"><span class="linenos">1066</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sg_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords-1067"><a href="#Disulfide.internal_coords-1067"><span class="linenos">1067</span></a>                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Disulfide.internal_coords-1068"><a href="#Disulfide.internal_coords-1068"><span class="linenos">1068</span></a>                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Disulfide.internal_coords-1069"><a href="#Disulfide.internal_coords-1069"><span class="linenos">1069</span></a>                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
</span><span id="Disulfide.internal_coords-1070"><a href="#Disulfide.internal_coords-1070"><span class="linenos">1070</span></a>                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Disulfide.internal_coords-1071"><a href="#Disulfide.internal_coords-1071"><span class="linenos">1071</span></a>            <span class="p">))</span>
</span><span id="Disulfide.internal_coords-1072"><a href="#Disulfide.internal_coords-1072"><span class="linenos">1072</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Disulfide.internal_coords-1073"><a href="#Disulfide.internal_coords-1073"><span class="linenos">1073</span></a>            <span class="n">res_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span>
</span><span id="Disulfide.internal_coords-1074"><a href="#Disulfide.internal_coords-1074"><span class="linenos">1074</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords-1075"><a href="#Disulfide.internal_coords-1075"><span class="linenos">1075</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_ca_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords-1076"><a href="#Disulfide.internal_coords-1076"><span class="linenos">1076</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="Disulfide.internal_coords-1077"><a href="#Disulfide.internal_coords-1077"><span class="linenos">1077</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_o_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="Disulfide.internal_coords-1078"><a href="#Disulfide.internal_coords-1078"><span class="linenos">1078</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cb_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords-1079"><a href="#Disulfide.internal_coords-1079"><span class="linenos">1079</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sg_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords-1080"><a href="#Disulfide.internal_coords-1080"><span class="linenos">1080</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords-1081"><a href="#Disulfide.internal_coords-1081"><span class="linenos">1081</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_ca_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords-1082"><a href="#Disulfide.internal_coords-1082"><span class="linenos">1082</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="Disulfide.internal_coords-1083"><a href="#Disulfide.internal_coords-1083"><span class="linenos">1083</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_o_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="Disulfide.internal_coords-1084"><a href="#Disulfide.internal_coords-1084"><span class="linenos">1084</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cb_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords-1085"><a href="#Disulfide.internal_coords-1085"><span class="linenos">1085</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sg_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords-1086"><a href="#Disulfide.internal_coords-1086"><span class="linenos">1086</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_prev_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords-1087"><a href="#Disulfide.internal_coords-1087"><span class="linenos">1087</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_next_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords-1088"><a href="#Disulfide.internal_coords-1088"><span class="linenos">1088</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_prev_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords-1089"><a href="#Disulfide.internal_coords-1089"><span class="linenos">1089</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_next_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
</span><span id="Disulfide.internal_coords-1090"><a href="#Disulfide.internal_coords-1090"><span class="linenos">1090</span></a>            <span class="p">))</span>
</span><span id="Disulfide.internal_coords-1091"><a href="#Disulfide.internal_coords-1091"><span class="linenos">1091</span></a>        <span class="k">return</span> <span class="n">res_array</span>
</span></pre></div>


            <div class="docstring"><p>Returns the internal coordinates for the Disulfide.
If there are missing atoms the extra atoms for the proximal
and distal N and C are set to [0,0,0]. This is needed for the center of
mass calculations, used when rendering.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Array containing the coordinates, [16][3].</p>
</blockquote>
</div>


                            </div>
                            <div id="Disulfide.internal_coords_res" class="classattr">
                                        <input id="Disulfide.internal_coords_res-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">internal_coords_res</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">resnumb</span></span><span class="return-annotation">) -> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="n">array</span><span class="o">&gt;</span>:</span></span>

                <label class="view-source-button" for="Disulfide.internal_coords_res-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.internal_coords_res"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.internal_coords_res-1093"><a href="#Disulfide.internal_coords_res-1093"><span class="linenos">1093</span></a>    <span class="k">def</span> <span class="nf">internal_coords_res</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resnumb</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
</span><span id="Disulfide.internal_coords_res-1094"><a href="#Disulfide.internal_coords_res-1094"><span class="linenos">1094</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.internal_coords_res-1095"><a href="#Disulfide.internal_coords_res-1095"><span class="linenos">1095</span></a><span class="sd">        Returns the internal coordinates for the internal coordinates of</span>
</span><span id="Disulfide.internal_coords_res-1096"><a href="#Disulfide.internal_coords_res-1096"><span class="linenos">1096</span></a><span class="sd">        the given Disulfide. Missing atoms are not included.</span>
</span><span id="Disulfide.internal_coords_res-1097"><a href="#Disulfide.internal_coords_res-1097"><span class="linenos">1097</span></a>
</span><span id="Disulfide.internal_coords_res-1098"><a href="#Disulfide.internal_coords_res-1098"><span class="linenos">1098</span></a><span class="sd">        :param resnumb: Residue number for disulfide</span>
</span><span id="Disulfide.internal_coords_res-1099"><a href="#Disulfide.internal_coords_res-1099"><span class="linenos">1099</span></a><span class="sd">        :raises DisulfideConstructionWarning: Warning raised if the residue number is invalid</span>
</span><span id="Disulfide.internal_coords_res-1100"><a href="#Disulfide.internal_coords_res-1100"><span class="linenos">1100</span></a><span class="sd">        :return: Array containing the internal coordinates for the disulfide</span>
</span><span id="Disulfide.internal_coords_res-1101"><a href="#Disulfide.internal_coords_res-1101"><span class="linenos">1101</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.internal_coords_res-1102"><a href="#Disulfide.internal_coords_res-1102"><span class="linenos">1102</span></a>        <span class="n">res_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</span><span id="Disulfide.internal_coords_res-1103"><a href="#Disulfide.internal_coords_res-1103"><span class="linenos">1103</span></a>
</span><span id="Disulfide.internal_coords_res-1104"><a href="#Disulfide.internal_coords_res-1104"><span class="linenos">1104</span></a>        <span class="k">if</span> <span class="n">resnumb</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">proximal</span><span class="p">:</span>
</span><span id="Disulfide.internal_coords_res-1105"><a href="#Disulfide.internal_coords_res-1105"><span class="linenos">1105</span></a>            <span class="n">res_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span>
</span><span id="Disulfide.internal_coords_res-1106"><a href="#Disulfide.internal_coords_res-1106"><span class="linenos">1106</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords_res-1107"><a href="#Disulfide.internal_coords_res-1107"><span class="linenos">1107</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_ca_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords_res-1108"><a href="#Disulfide.internal_coords_res-1108"><span class="linenos">1108</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="Disulfide.internal_coords_res-1109"><a href="#Disulfide.internal_coords_res-1109"><span class="linenos">1109</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_o_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="Disulfide.internal_coords_res-1110"><a href="#Disulfide.internal_coords_res-1110"><span class="linenos">1110</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cb_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords_res-1111"><a href="#Disulfide.internal_coords_res-1111"><span class="linenos">1111</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sg_prox</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords_res-1112"><a href="#Disulfide.internal_coords_res-1112"><span class="linenos">1112</span></a>            <span class="p">))</span>
</span><span id="Disulfide.internal_coords_res-1113"><a href="#Disulfide.internal_coords_res-1113"><span class="linenos">1113</span></a>            <span class="k">return</span> <span class="n">res_array</span>
</span><span id="Disulfide.internal_coords_res-1114"><a href="#Disulfide.internal_coords_res-1114"><span class="linenos">1114</span></a>
</span><span id="Disulfide.internal_coords_res-1115"><a href="#Disulfide.internal_coords_res-1115"><span class="linenos">1115</span></a>        <span class="k">elif</span> <span class="n">resnumb</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">distal</span><span class="p">:</span>
</span><span id="Disulfide.internal_coords_res-1116"><a href="#Disulfide.internal_coords_res-1116"><span class="linenos">1116</span></a>            <span class="n">res_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span>
</span><span id="Disulfide.internal_coords_res-1117"><a href="#Disulfide.internal_coords_res-1117"><span class="linenos">1117</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_n_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords_res-1118"><a href="#Disulfide.internal_coords_res-1118"><span class="linenos">1118</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_ca_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords_res-1119"><a href="#Disulfide.internal_coords_res-1119"><span class="linenos">1119</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_c_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords_res-1120"><a href="#Disulfide.internal_coords_res-1120"><span class="linenos">1120</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_o_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span> 
</span><span id="Disulfide.internal_coords_res-1121"><a href="#Disulfide.internal_coords_res-1121"><span class="linenos">1121</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cb_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords_res-1122"><a href="#Disulfide.internal_coords_res-1122"><span class="linenos">1122</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_sg_dist</span><span class="o">.</span><span class="n">get_array</span><span class="p">(),</span>
</span><span id="Disulfide.internal_coords_res-1123"><a href="#Disulfide.internal_coords_res-1123"><span class="linenos">1123</span></a>            <span class="p">))</span>
</span><span id="Disulfide.internal_coords_res-1124"><a href="#Disulfide.internal_coords_res-1124"><span class="linenos">1124</span></a>            <span class="k">return</span> <span class="n">res_array</span>
</span><span id="Disulfide.internal_coords_res-1125"><a href="#Disulfide.internal_coords_res-1125"><span class="linenos">1125</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Disulfide.internal_coords_res-1126"><a href="#Disulfide.internal_coords_res-1126"><span class="linenos">1126</span></a>            <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;-&gt; Disulfide.internal_coords(): Invalid argument. </span><span class="se">\</span>
</span><span id="Disulfide.internal_coords_res-1127"><a href="#Disulfide.internal_coords_res-1127"><span class="linenos">1127</span></a><span class="s1">             Unable to find residue: </span><span class="si">{</span><span class="n">resnumb</span><span class="si">}</span><span class="s1"> &#39;</span>
</span><span id="Disulfide.internal_coords_res-1128"><a href="#Disulfide.internal_coords_res-1128"><span class="linenos">1128</span></a>            <span class="k">raise</span> <span class="n">DisulfideConstructionWarning</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the internal coordinates for the internal coordinates of
the given Disulfide. Missing atoms are not included.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>resnumb</strong>:  Residue number for disulfide</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>DisulfideConstructionWarning</strong>:  Warning raised if the residue number is invalid</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Array containing the internal coordinates for the disulfide</p>
</blockquote>
</div>


                            </div>
                            <div id="Disulfide.make_movie" class="classattr">
                                        <input id="Disulfide.make_movie-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">make_movie</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span>, </span><span class="param"><span class="n">fname</span><span class="o">=</span><span class="s1">&#39;ssbond.mp4&#39;</span>, </span><span class="param"><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="n">steps</span><span class="o">=</span><span class="mi">360</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.make_movie-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.make_movie"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.make_movie-1130"><a href="#Disulfide.make_movie-1130"><span class="linenos">1130</span></a>    <span class="k">def</span> <span class="nf">make_movie</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;ssbond.mp4&#39;</span><span class="p">,</span>
</span><span id="Disulfide.make_movie-1131"><a href="#Disulfide.make_movie-1131"><span class="linenos">1131</span></a>                   <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">360</span><span class="p">):</span>
</span><span id="Disulfide.make_movie-1132"><a href="#Disulfide.make_movie-1132"><span class="linenos">1132</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.make_movie-1133"><a href="#Disulfide.make_movie-1133"><span class="linenos">1133</span></a><span class="sd">        Create an animation for ```self``` rotating one revolution about the Y axis,</span>
</span><span id="Disulfide.make_movie-1134"><a href="#Disulfide.make_movie-1134"><span class="linenos">1134</span></a><span class="sd">        in the given ```style```, saving to ```filename```.</span>
</span><span id="Disulfide.make_movie-1135"><a href="#Disulfide.make_movie-1135"><span class="linenos">1135</span></a>
</span><span id="Disulfide.make_movie-1136"><a href="#Disulfide.make_movie-1136"><span class="linenos">1136</span></a><span class="sd">        :param style: Rendering style, defaults to &#39;sb&#39;, one of:</span>
</span><span id="Disulfide.make_movie-1137"><a href="#Disulfide.make_movie-1137"><span class="linenos">1137</span></a><span class="sd">        * &#39;sb&#39; - split bonds</span>
</span><span id="Disulfide.make_movie-1138"><a href="#Disulfide.make_movie-1138"><span class="linenos">1138</span></a><span class="sd">        * &#39;bs&#39; - ball and stick</span>
</span><span id="Disulfide.make_movie-1139"><a href="#Disulfide.make_movie-1139"><span class="linenos">1139</span></a><span class="sd">        * &#39;cpk&#39; - CPK style</span>
</span><span id="Disulfide.make_movie-1140"><a href="#Disulfide.make_movie-1140"><span class="linenos">1140</span></a><span class="sd">        * &#39;pd&#39; - Proximal/Distal style - Red=proximal, Green=Distal</span>
</span><span id="Disulfide.make_movie-1141"><a href="#Disulfide.make_movie-1141"><span class="linenos">1141</span></a><span class="sd">        * &#39;plain&#39; - boring single color</span>
</span><span id="Disulfide.make_movie-1142"><a href="#Disulfide.make_movie-1142"><span class="linenos">1142</span></a><span class="sd">        </span>
</span><span id="Disulfide.make_movie-1143"><a href="#Disulfide.make_movie-1143"><span class="linenos">1143</span></a><span class="sd">        :param fname: Output filename, defaults to ```ssbond.mp4```</span>
</span><span id="Disulfide.make_movie-1144"><a href="#Disulfide.make_movie-1144"><span class="linenos">1144</span></a><span class="sd">        :param verbose: Verbosity, defaults to False</span>
</span><span id="Disulfide.make_movie-1145"><a href="#Disulfide.make_movie-1145"><span class="linenos">1145</span></a><span class="sd">        :param steps: Number of steps for one complete rotation, defaults to 360.</span>
</span><span id="Disulfide.make_movie-1146"><a href="#Disulfide.make_movie-1146"><span class="linenos">1146</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.make_movie-1147"><a href="#Disulfide.make_movie-1147"><span class="linenos">1147</span></a>        <span class="n">src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="Disulfide.make_movie-1148"><a href="#Disulfide.make_movie-1148"><span class="linenos">1148</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
</span><span id="Disulfide.make_movie-1149"><a href="#Disulfide.make_movie-1149"><span class="linenos">1149</span></a>        <span class="n">enrg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span>
</span><span id="Disulfide.make_movie-1150"><a href="#Disulfide.make_movie-1150"><span class="linenos">1150</span></a>
</span><span id="Disulfide.make_movie-1151"><a href="#Disulfide.make_movie-1151"><span class="linenos">1151</span></a>        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">src</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal_chain</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal_chain</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">enrg</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol, Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å, Tors: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Disulfide.make_movie-1152"><a href="#Disulfide.make_movie-1152"><span class="linenos">1152</span></a>        
</span><span id="Disulfide.make_movie-1153"><a href="#Disulfide.make_movie-1153"><span class="linenos">1153</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Disulfide.make_movie-1154"><a href="#Disulfide.make_movie-1154"><span class="linenos">1154</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Rendering animation to </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">)</span>
</span><span id="Disulfide.make_movie-1155"><a href="#Disulfide.make_movie-1155"><span class="linenos">1155</span></a>
</span><span id="Disulfide.make_movie-1156"><a href="#Disulfide.make_movie-1156"><span class="linenos">1156</span></a>        <span class="n">pl</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="n">WINSIZE</span><span class="p">,</span> <span class="n">off_screen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Disulfide.make_movie-1157"><a href="#Disulfide.make_movie-1157"><span class="linenos">1157</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">open_movie</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">quality</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
</span><span id="Disulfide.make_movie-1158"><a href="#Disulfide.make_movie-1158"><span class="linenos">1158</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">generate_orbital_path</span><span class="p">(</span><span class="n">n_points</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
</span><span id="Disulfide.make_movie-1159"><a href="#Disulfide.make_movie-1159"><span class="linenos">1159</span></a>
</span><span id="Disulfide.make_movie-1160"><a href="#Disulfide.make_movie-1160"><span class="linenos">1160</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide.make_movie-1161"><a href="#Disulfide.make_movie-1161"><span class="linenos">1161</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">enable_anti_aliasing</span><span class="p">(</span><span class="s1">&#39;msaa&#39;</span><span class="p">)</span>
</span><span id="Disulfide.make_movie-1162"><a href="#Disulfide.make_movie-1162"><span class="linenos">1162</span></a>        <span class="c1"># pl.add_camera_orientation_widget()</span>
</span><span id="Disulfide.make_movie-1163"><a href="#Disulfide.make_movie-1163"><span class="linenos">1163</span></a>        <span class="n">pl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="Disulfide.make_movie-1164"><a href="#Disulfide.make_movie-1164"><span class="linenos">1164</span></a>                    <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="Disulfide.make_movie-1165"><a href="#Disulfide.make_movie-1165"><span class="linenos">1165</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="Disulfide.make_movie-1166"><a href="#Disulfide.make_movie-1166"><span class="linenos">1166</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">orbit_on_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">write_frames</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Disulfide.make_movie-1167"><a href="#Disulfide.make_movie-1167"><span class="linenos">1167</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Disulfide.make_movie-1168"><a href="#Disulfide.make_movie-1168"><span class="linenos">1168</span></a>
</span><span id="Disulfide.make_movie-1169"><a href="#Disulfide.make_movie-1169"><span class="linenos">1169</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Disulfide.make_movie-1170"><a href="#Disulfide.make_movie-1170"><span class="linenos">1170</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Saved mp4 animation to: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create an animation for <code>self</code> rotating one revolution about the Y axis,
in the given <code>style</code>, saving to <code>filename</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>style: Rendering style, defaults to 'sb', one of</strong>: </p>

<ul>
<li>'sb' - split bonds</li>
<li>'bs' - ball and stick</li>
<li>'cpk' - CPK style</li>
<li>'pd' - Proximal/Distal style - Red=proximal, Green=Distal</li>
<li>'plain' - boring single color</li>
</ul></li>
<li><p><strong>fname</strong>:  Output filename, defaults to <code>ssbond.mp4</code></p></li>
<li><strong>verbose</strong>:  Verbosity, defaults to False</li>
<li><strong>steps</strong>:  Number of steps for one complete rotation, defaults to 360.</li>
</ul>
</div>


                            </div>
                            <div id="Disulfide.pprint" class="classattr">
                                        <input id="Disulfide.pprint-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">pprint</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Disulfide.pprint-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.pprint"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.pprint-1172"><a href="#Disulfide.pprint-1172"><span class="linenos">1172</span></a>    <span class="k">def</span> <span class="nf">pprint</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Disulfide.pprint-1173"><a href="#Disulfide.pprint-1173"><span class="linenos">1173</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.pprint-1174"><a href="#Disulfide.pprint-1174"><span class="linenos">1174</span></a><span class="sd">        Pretty print general info for the Disulfide</span>
</span><span id="Disulfide.pprint-1175"><a href="#Disulfide.pprint-1175"><span class="linenos">1175</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.pprint-1176"><a href="#Disulfide.pprint-1176"><span class="linenos">1176</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_info</span><span class="p">()</span>
</span><span id="Disulfide.pprint-1177"><a href="#Disulfide.pprint-1177"><span class="linenos">1177</span></a>        <span class="n">s2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_ca_dist</span><span class="p">()</span>
</span><span id="Disulfide.pprint-1178"><a href="#Disulfide.pprint-1178"><span class="linenos">1178</span></a>        <span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_conformation</span><span class="p">()</span>
</span><span id="Disulfide.pprint-1179"><a href="#Disulfide.pprint-1179"><span class="linenos">1179</span></a>        <span class="n">s4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_torsion_length</span><span class="p">()</span>
</span><span id="Disulfide.pprint-1180"><a href="#Disulfide.pprint-1180"><span class="linenos">1180</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s1</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="si">{</span><span class="n">s3</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="si">{</span><span class="n">s2</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="si">{</span><span class="n">s4</span><span class="si">}</span><span class="s1">&gt;&#39;</span>
</span><span id="Disulfide.pprint-1181"><a href="#Disulfide.pprint-1181"><span class="linenos">1181</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Pretty print general info for the Disulfide</p>
</div>


                            </div>
                            <div id="Disulfide.pprint_all" class="classattr">
                                        <input id="Disulfide.pprint_all-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">pprint_all</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Disulfide.pprint_all-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.pprint_all"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.pprint_all-1183"><a href="#Disulfide.pprint_all-1183"><span class="linenos">1183</span></a>    <span class="k">def</span> <span class="nf">pprint_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Disulfide.pprint_all-1184"><a href="#Disulfide.pprint_all-1184"><span class="linenos">1184</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide.pprint_all-1185"><a href="#Disulfide.pprint_all-1185"><span class="linenos">1185</span></a><span class="sd">        Pretty print all info for the Disulfide</span>
</span><span id="Disulfide.pprint_all-1186"><a href="#Disulfide.pprint_all-1186"><span class="linenos">1186</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide.pprint_all-1187"><a href="#Disulfide.pprint_all-1187"><span class="linenos">1187</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_info</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="Disulfide.pprint_all-1188"><a href="#Disulfide.pprint_all-1188"><span class="linenos">1188</span></a>        <span class="n">s2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_coords</span><span class="p">()</span>
</span><span id="Disulfide.pprint_all-1189"><a href="#Disulfide.pprint_all-1189"><span class="linenos">1189</span></a>        <span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_local_coords</span><span class="p">()</span>
</span><span id="Disulfide.pprint_all-1190"><a href="#Disulfide.pprint_all-1190"><span class="linenos">1190</span></a>        <span class="n">s4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_conformation</span><span class="p">()</span>
</span><span id="Disulfide.pprint_all-1191"><a href="#Disulfide.pprint_all-1191"><span class="linenos">1191</span></a>        <span class="n">s5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_chain_ids</span><span class="p">()</span>
</span><span id="Disulfide.pprint_all-1192"><a href="#Disulfide.pprint_all-1192"><span class="linenos">1192</span></a>        <span class="n">s6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_ca_dist</span><span class="p">()</span>
</span><span id="Disulfide.pprint_all-1193"><a href="#Disulfide.pprint_all-1193"><span class="linenos">1193</span></a>        <span class="n">s7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_torsion_length</span><span class="p">()</span>
</span><span id="Disulfide.pprint_all-1194"><a href="#Disulfide.pprint_all-1194"><span class="linenos">1194</span></a>
</span><span id="Disulfide.pprint_all-1195"><a href="#Disulfide.pprint_all-1195"><span class="linenos">1195</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s1</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s5</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s2</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s3</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s4</span><span class="si">}</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">s6</span><span class="si">}</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">s7</span><span class="si">}</span><span class="s1">&gt;&#39;</span>
</span><span id="Disulfide.pprint_all-1196"><a href="#Disulfide.pprint_all-1196"><span class="linenos">1196</span></a>
</span><span id="Disulfide.pprint_all-1197"><a href="#Disulfide.pprint_all-1197"><span class="linenos">1197</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Pretty print all info for the Disulfide</p>
</div>


                            </div>
                            <div id="Disulfide.repr_ss_info" class="classattr">
                                        <input id="Disulfide.repr_ss_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">repr_ss_info</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.repr_ss_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.repr_ss_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.repr_ss_info-1200"><a href="#Disulfide.repr_ss_info-1200"><span class="linenos">1200</span></a>    <span class="k">def</span> <span class="nf">repr_ss_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide.repr_ss_info-1201"><a href="#Disulfide.repr_ss_info-1201"><span class="linenos">1201</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide.repr_ss_info-1202"><a href="#Disulfide.repr_ss_info-1202"><span class="linenos">1202</span></a><span class="sd">        Representation for the Disulfide class</span>
</span><span id="Disulfide.repr_ss_info-1203"><a href="#Disulfide.repr_ss_info-1203"><span class="linenos">1203</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide.repr_ss_info-1204"><a href="#Disulfide.repr_ss_info-1204"><span class="linenos">1204</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&lt;Disulfide </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">, Source: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pdb_id</span><span class="si">}</span><span class="s1">, Resolution: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">resolution</span><span class="si">}</span><span class="s1"> Å&#39;</span>
</span><span id="Disulfide.repr_ss_info-1205"><a href="#Disulfide.repr_ss_info-1205"><span class="linenos">1205</span></a>        <span class="k">return</span> <span class="n">s1</span>
</span></pre></div>


            <div class="docstring"><p>Representation for the Disulfide class</p>
</div>


                            </div>
                            <div id="Disulfide.repr_ss_coords" class="classattr">
                                        <input id="Disulfide.repr_ss_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">repr_ss_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.repr_ss_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.repr_ss_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.repr_ss_coords-1207"><a href="#Disulfide.repr_ss_coords-1207"><span class="linenos">1207</span></a>    <span class="k">def</span> <span class="nf">repr_ss_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide.repr_ss_coords-1208"><a href="#Disulfide.repr_ss_coords-1208"><span class="linenos">1208</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide.repr_ss_coords-1209"><a href="#Disulfide.repr_ss_coords-1209"><span class="linenos">1209</span></a><span class="sd">        Representation for Disulfide coordinates</span>
</span><span id="Disulfide.repr_ss_coords-1210"><a href="#Disulfide.repr_ss_coords-1210"><span class="linenos">1210</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide.repr_ss_coords-1211"><a href="#Disulfide.repr_ss_coords-1211"><span class="linenos">1211</span></a>        <span class="n">s2</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Proximal Coordinates:</span><span class="se">\n</span><span class="s1">   N: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   C: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">c_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   O: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">o_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cβ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Sγ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sg_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cprev </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">c_prev_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Nnext: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_next_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="Disulfide.repr_ss_coords-1212"><a href="#Disulfide.repr_ss_coords-1212"><span class="linenos">1212</span></a>        <span class="n">s3</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Distal Coordinates:</span><span class="se">\n</span><span class="s1">   N: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   C: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">c_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   O: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">o_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cβ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Sγ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sg_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cprev </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">c_prev_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Nnext: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_next_dist</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">&#39;</span>
</span><span id="Disulfide.repr_ss_coords-1213"><a href="#Disulfide.repr_ss_coords-1213"><span class="linenos">1213</span></a>        <span class="n">stot</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s2</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s3</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Disulfide.repr_ss_coords-1214"><a href="#Disulfide.repr_ss_coords-1214"><span class="linenos">1214</span></a>        <span class="k">return</span> <span class="n">stot</span>
</span></pre></div>


            <div class="docstring"><p>Representation for Disulfide coordinates</p>
</div>


                            </div>
                            <div id="Disulfide.repr_ss_conformation" class="classattr">
                                        <input id="Disulfide.repr_ss_conformation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">repr_ss_conformation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.repr_ss_conformation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.repr_ss_conformation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.repr_ss_conformation-1216"><a href="#Disulfide.repr_ss_conformation-1216"><span class="linenos">1216</span></a>    <span class="k">def</span> <span class="nf">repr_ss_conformation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide.repr_ss_conformation-1217"><a href="#Disulfide.repr_ss_conformation-1217"><span class="linenos">1217</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide.repr_ss_conformation-1218"><a href="#Disulfide.repr_ss_conformation-1218"><span class="linenos">1218</span></a><span class="sd">        Representation for Disulfide conformation</span>
</span><span id="Disulfide.repr_ss_conformation-1219"><a href="#Disulfide.repr_ss_conformation-1219"><span class="linenos">1219</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide.repr_ss_conformation-1220"><a href="#Disulfide.repr_ss_conformation-1220"><span class="linenos">1220</span></a>        <span class="n">s4</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Χ1-Χ5: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">chi1</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">°, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">chi2</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">°, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">chi3</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">°, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">chi4</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">° </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">chi5</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">°, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">°, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol&#39;</span>
</span><span id="Disulfide.repr_ss_conformation-1221"><a href="#Disulfide.repr_ss_conformation-1221"><span class="linenos">1221</span></a>        <span class="n">stot</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s4</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Disulfide.repr_ss_conformation-1222"><a href="#Disulfide.repr_ss_conformation-1222"><span class="linenos">1222</span></a>        <span class="k">return</span> <span class="n">stot</span>
</span></pre></div>


            <div class="docstring"><p>Representation for Disulfide conformation</p>
</div>


                            </div>
                            <div id="Disulfide.repr_ss_local_coords" class="classattr">
                                        <input id="Disulfide.repr_ss_local_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">repr_ss_local_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.repr_ss_local_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.repr_ss_local_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.repr_ss_local_coords-1224"><a href="#Disulfide.repr_ss_local_coords-1224"><span class="linenos">1224</span></a>    <span class="k">def</span> <span class="nf">repr_ss_local_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide.repr_ss_local_coords-1225"><a href="#Disulfide.repr_ss_local_coords-1225"><span class="linenos">1225</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide.repr_ss_local_coords-1226"><a href="#Disulfide.repr_ss_local_coords-1226"><span class="linenos">1226</span></a><span class="sd">        Representation for the Disulfide internal coordinates.</span>
</span><span id="Disulfide.repr_ss_local_coords-1227"><a href="#Disulfide.repr_ss_local_coords-1227"><span class="linenos">1227</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide.repr_ss_local_coords-1228"><a href="#Disulfide.repr_ss_local_coords-1228"><span class="linenos">1228</span></a>        <span class="n">s2i</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Proximal Internal Coords:</span><span class="se">\n</span><span class="s1">   N: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_ca_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   C: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   O: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_o_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cβ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_cb_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Sγ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_sg_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cprev </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">c_prev_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Nnext: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_next_prox</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="Disulfide.repr_ss_local_coords-1229"><a href="#Disulfide.repr_ss_local_coords-1229"><span class="linenos">1229</span></a>        <span class="n">s3i</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Distal Internal Coords:</span><span class="se">\n</span><span class="s1">   N: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_ca_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   C: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_c_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   O: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_o_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cβ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_cb_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Sγ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_sg_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Cprev </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">c_prev_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">   Nnext: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_next_dist</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="Disulfide.repr_ss_local_coords-1230"><a href="#Disulfide.repr_ss_local_coords-1230"><span class="linenos">1230</span></a>        <span class="n">stot</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s2i</span><span class="si">}{</span><span class="n">s3i</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Disulfide.repr_ss_local_coords-1231"><a href="#Disulfide.repr_ss_local_coords-1231"><span class="linenos">1231</span></a>        <span class="k">return</span> <span class="n">stot</span>
</span></pre></div>


            <div class="docstring"><p>Representation for the Disulfide internal coordinates.</p>
</div>


                            </div>
                            <div id="Disulfide.repr_ss_chain_ids" class="classattr">
                                        <input id="Disulfide.repr_ss_chain_ids-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">repr_ss_chain_ids</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.repr_ss_chain_ids-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.repr_ss_chain_ids"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.repr_ss_chain_ids-1233"><a href="#Disulfide.repr_ss_chain_ids-1233"><span class="linenos">1233</span></a>    <span class="k">def</span> <span class="nf">repr_ss_chain_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide.repr_ss_chain_ids-1234"><a href="#Disulfide.repr_ss_chain_ids-1234"><span class="linenos">1234</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide.repr_ss_chain_ids-1235"><a href="#Disulfide.repr_ss_chain_ids-1235"><span class="linenos">1235</span></a><span class="sd">        Representation for Disulfide chain IDs</span>
</span><span id="Disulfide.repr_ss_chain_ids-1236"><a href="#Disulfide.repr_ss_chain_ids-1236"><span class="linenos">1236</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide.repr_ss_chain_ids-1237"><a href="#Disulfide.repr_ss_chain_ids-1237"><span class="linenos">1237</span></a>        <span class="k">return</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Proximal Chain fullID: &lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal_residue_fullid</span><span class="si">}</span><span class="s1">&gt; Distal Chain fullID: &lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal_residue_fullid</span><span class="si">}</span><span class="s1">&gt;&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Representation for Disulfide chain IDs</p>
</div>


                            </div>
                            <div id="Disulfide.repr_ss_ca_dist" class="classattr">
                                        <input id="Disulfide.repr_ss_ca_dist-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">repr_ss_ca_dist</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.repr_ss_ca_dist-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.repr_ss_ca_dist"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.repr_ss_ca_dist-1239"><a href="#Disulfide.repr_ss_ca_dist-1239"><span class="linenos">1239</span></a>    <span class="k">def</span> <span class="nf">repr_ss_ca_dist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide.repr_ss_ca_dist-1240"><a href="#Disulfide.repr_ss_ca_dist-1240"><span class="linenos">1240</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide.repr_ss_ca_dist-1241"><a href="#Disulfide.repr_ss_ca_dist-1241"><span class="linenos">1241</span></a><span class="sd">        Representation for Disulfide Ca distance</span>
</span><span id="Disulfide.repr_ss_ca_dist-1242"><a href="#Disulfide.repr_ss_ca_dist-1242"><span class="linenos">1242</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide.repr_ss_ca_dist-1243"><a href="#Disulfide.repr_ss_ca_dist-1243"><span class="linenos">1243</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Cα Distance: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å&#39;</span>
</span><span id="Disulfide.repr_ss_ca_dist-1244"><a href="#Disulfide.repr_ss_ca_dist-1244"><span class="linenos">1244</span></a>        <span class="k">return</span> <span class="n">s1</span>
</span></pre></div>


            <div class="docstring"><p>Representation for Disulfide Ca distance</p>
</div>


                            </div>
                            <div id="Disulfide.repr_ss_cb_dist" class="classattr">
                                        <input id="Disulfide.repr_ss_cb_dist-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">repr_ss_cb_dist</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.repr_ss_cb_dist-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.repr_ss_cb_dist"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.repr_ss_cb_dist-1246"><a href="#Disulfide.repr_ss_cb_dist-1246"><span class="linenos">1246</span></a>    <span class="k">def</span> <span class="nf">repr_ss_cb_dist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide.repr_ss_cb_dist-1247"><a href="#Disulfide.repr_ss_cb_dist-1247"><span class="linenos">1247</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide.repr_ss_cb_dist-1248"><a href="#Disulfide.repr_ss_cb_dist-1248"><span class="linenos">1248</span></a><span class="sd">        Representation for Disulfide Ca distance</span>
</span><span id="Disulfide.repr_ss_cb_dist-1249"><a href="#Disulfide.repr_ss_cb_dist-1249"><span class="linenos">1249</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide.repr_ss_cb_dist-1250"><a href="#Disulfide.repr_ss_cb_dist-1250"><span class="linenos">1250</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Cβ Distance: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å&#39;</span>
</span><span id="Disulfide.repr_ss_cb_dist-1251"><a href="#Disulfide.repr_ss_cb_dist-1251"><span class="linenos">1251</span></a>        <span class="k">return</span> <span class="n">s1</span>
</span></pre></div>


            <div class="docstring"><p>Representation for Disulfide Ca distance</p>
</div>


                            </div>
                            <div id="Disulfide.repr_ss_torsion_length" class="classattr">
                                        <input id="Disulfide.repr_ss_torsion_length-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">repr_ss_torsion_length</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.repr_ss_torsion_length-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.repr_ss_torsion_length"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.repr_ss_torsion_length-1253"><a href="#Disulfide.repr_ss_torsion_length-1253"><span class="linenos">1253</span></a>    <span class="k">def</span> <span class="nf">repr_ss_torsion_length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide.repr_ss_torsion_length-1254"><a href="#Disulfide.repr_ss_torsion_length-1254"><span class="linenos">1254</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide.repr_ss_torsion_length-1255"><a href="#Disulfide.repr_ss_torsion_length-1255"><span class="linenos">1255</span></a><span class="sd">        Representation for Disulfide torsion length</span>
</span><span id="Disulfide.repr_ss_torsion_length-1256"><a href="#Disulfide.repr_ss_torsion_length-1256"><span class="linenos">1256</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide.repr_ss_torsion_length-1257"><a href="#Disulfide.repr_ss_torsion_length-1257"><span class="linenos">1257</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Torsion length: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> deg&#39;</span>
</span><span id="Disulfide.repr_ss_torsion_length-1258"><a href="#Disulfide.repr_ss_torsion_length-1258"><span class="linenos">1258</span></a>        <span class="k">return</span> <span class="n">s1</span>
</span></pre></div>


            <div class="docstring"><p>Representation for Disulfide torsion length</p>
</div>


                            </div>
                            <div id="Disulfide.repr_all" class="classattr">
                                        <input id="Disulfide.repr_all-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">repr_all</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="Disulfide.repr_all-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.repr_all"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.repr_all-1260"><a href="#Disulfide.repr_all-1260"><span class="linenos">1260</span></a>    <span class="k">def</span> <span class="nf">repr_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Disulfide.repr_all-1261"><a href="#Disulfide.repr_all-1261"><span class="linenos">1261</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Disulfide.repr_all-1262"><a href="#Disulfide.repr_all-1262"><span class="linenos">1262</span></a><span class="sd">        Return a string representation for all Disulfide information</span>
</span><span id="Disulfide.repr_all-1263"><a href="#Disulfide.repr_all-1263"><span class="linenos">1263</span></a><span class="sd">        contained in self.</span>
</span><span id="Disulfide.repr_all-1264"><a href="#Disulfide.repr_all-1264"><span class="linenos">1264</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Disulfide.repr_all-1265"><a href="#Disulfide.repr_all-1265"><span class="linenos">1265</span></a>        
</span><span id="Disulfide.repr_all-1266"><a href="#Disulfide.repr_all-1266"><span class="linenos">1266</span></a>        <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_info</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="Disulfide.repr_all-1267"><a href="#Disulfide.repr_all-1267"><span class="linenos">1267</span></a>        <span class="n">s2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_coords</span><span class="p">()</span>
</span><span id="Disulfide.repr_all-1268"><a href="#Disulfide.repr_all-1268"><span class="linenos">1268</span></a>        <span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_local_coords</span><span class="p">()</span>
</span><span id="Disulfide.repr_all-1269"><a href="#Disulfide.repr_all-1269"><span class="linenos">1269</span></a>        <span class="n">s4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_conformation</span><span class="p">()</span>
</span><span id="Disulfide.repr_all-1270"><a href="#Disulfide.repr_all-1270"><span class="linenos">1270</span></a>        <span class="n">s5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_chain_ids</span><span class="p">()</span>
</span><span id="Disulfide.repr_all-1271"><a href="#Disulfide.repr_all-1271"><span class="linenos">1271</span></a>        <span class="n">s6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_ca_dist</span><span class="p">()</span>
</span><span id="Disulfide.repr_all-1272"><a href="#Disulfide.repr_all-1272"><span class="linenos">1272</span></a>        <span class="n">s8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_cb_dist</span><span class="p">()</span>
</span><span id="Disulfide.repr_all-1273"><a href="#Disulfide.repr_all-1273"><span class="linenos">1273</span></a>        <span class="n">s7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_torsion_length</span><span class="p">()</span>
</span><span id="Disulfide.repr_all-1274"><a href="#Disulfide.repr_all-1274"><span class="linenos">1274</span></a>
</span><span id="Disulfide.repr_all-1275"><a href="#Disulfide.repr_all-1275"><span class="linenos">1275</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">s1</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s5</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s2</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s3</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s4</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s6</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s7</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">s8</span><span class="si">}</span><span class="s1">&gt;&#39;</span>
</span><span id="Disulfide.repr_all-1276"><a href="#Disulfide.repr_all-1276"><span class="linenos">1276</span></a>        <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Return a string representation for all Disulfide information
contained in self.</p>
</div>


                            </div>
                            <div id="Disulfide.repr_compact" class="classattr">
                                        <input id="Disulfide.repr_compact-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">repr_compact</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="Disulfide.repr_compact-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.repr_compact"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.repr_compact-1278"><a href="#Disulfide.repr_compact-1278"><span class="linenos">1278</span></a>    <span class="k">def</span> <span class="nf">repr_compact</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Disulfide.repr_compact-1279"><a href="#Disulfide.repr_compact-1279"><span class="linenos">1279</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.repr_compact-1280"><a href="#Disulfide.repr_compact-1280"><span class="linenos">1280</span></a><span class="sd">        Return a compact representation of the Disulfide object</span>
</span><span id="Disulfide.repr_compact-1281"><a href="#Disulfide.repr_compact-1281"><span class="linenos">1281</span></a><span class="sd">        :return: string</span>
</span><span id="Disulfide.repr_compact-1282"><a href="#Disulfide.repr_compact-1282"><span class="linenos">1282</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.repr_compact-1283"><a href="#Disulfide.repr_compact-1283"><span class="linenos">1283</span></a>        <span class="k">return</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_info</span><span class="p">()</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_conformation</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a compact representation of the Disulfide object</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>string</p>
</blockquote>
</div>


                            </div>
                            <div id="Disulfide.repr_conformation" class="classattr">
                                        <input id="Disulfide.repr_conformation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">repr_conformation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.repr_conformation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.repr_conformation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.repr_conformation-1285"><a href="#Disulfide.repr_conformation-1285"><span class="linenos">1285</span></a>    <span class="k">def</span> <span class="nf">repr_conformation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide.repr_conformation-1286"><a href="#Disulfide.repr_conformation-1286"><span class="linenos">1286</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.repr_conformation-1287"><a href="#Disulfide.repr_conformation-1287"><span class="linenos">1287</span></a><span class="sd">        Return a string representation of the Disulfide object&#39;s conformation.</span>
</span><span id="Disulfide.repr_conformation-1288"><a href="#Disulfide.repr_conformation-1288"><span class="linenos">1288</span></a><span class="sd">        :return: string</span>
</span><span id="Disulfide.repr_conformation-1289"><a href="#Disulfide.repr_conformation-1289"><span class="linenos">1289</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.repr_conformation-1290"><a href="#Disulfide.repr_conformation-1290"><span class="linenos">1290</span></a>        <span class="k">return</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_conformation</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a string representation of the Disulfide object's conformation.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>string</p>
</blockquote>
</div>


                            </div>
                            <div id="Disulfide.repr_coords" class="classattr">
                                        <input id="Disulfide.repr_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">repr_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.repr_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.repr_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.repr_coords-1292"><a href="#Disulfide.repr_coords-1292"><span class="linenos">1292</span></a>    <span class="k">def</span> <span class="nf">repr_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide.repr_coords-1293"><a href="#Disulfide.repr_coords-1293"><span class="linenos">1293</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.repr_coords-1294"><a href="#Disulfide.repr_coords-1294"><span class="linenos">1294</span></a><span class="sd">        Return a string representation of the Disulfide object&#39;s coordinates.</span>
</span><span id="Disulfide.repr_coords-1295"><a href="#Disulfide.repr_coords-1295"><span class="linenos">1295</span></a><span class="sd">        :return: string</span>
</span><span id="Disulfide.repr_coords-1296"><a href="#Disulfide.repr_coords-1296"><span class="linenos">1296</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.repr_coords-1297"><a href="#Disulfide.repr_coords-1297"><span class="linenos">1297</span></a>        <span class="k">return</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_coords</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a string representation of the Disulfide object's coordinates.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>string</p>
</blockquote>
</div>


                            </div>
                            <div id="Disulfide.repr_internal_coords" class="classattr">
                                        <input id="Disulfide.repr_internal_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">repr_internal_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.repr_internal_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.repr_internal_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.repr_internal_coords-1299"><a href="#Disulfide.repr_internal_coords-1299"><span class="linenos">1299</span></a>    <span class="k">def</span> <span class="nf">repr_internal_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide.repr_internal_coords-1300"><a href="#Disulfide.repr_internal_coords-1300"><span class="linenos">1300</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.repr_internal_coords-1301"><a href="#Disulfide.repr_internal_coords-1301"><span class="linenos">1301</span></a><span class="sd">        Return a string representation of the Disulfide object&#39;s internal coordinaes.</span>
</span><span id="Disulfide.repr_internal_coords-1302"><a href="#Disulfide.repr_internal_coords-1302"><span class="linenos">1302</span></a><span class="sd">        :return: string</span>
</span><span id="Disulfide.repr_internal_coords-1303"><a href="#Disulfide.repr_internal_coords-1303"><span class="linenos">1303</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.repr_internal_coords-1304"><a href="#Disulfide.repr_internal_coords-1304"><span class="linenos">1304</span></a>        <span class="k">return</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_local_coords</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a string representation of the Disulfide object's internal coordinaes.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>string</p>
</blockquote>
</div>


                            </div>
                            <div id="Disulfide.repr_chain_ids" class="classattr">
                                        <input id="Disulfide.repr_chain_ids-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">repr_chain_ids</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.repr_chain_ids-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.repr_chain_ids"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.repr_chain_ids-1306"><a href="#Disulfide.repr_chain_ids-1306"><span class="linenos">1306</span></a>    <span class="k">def</span> <span class="nf">repr_chain_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide.repr_chain_ids-1307"><a href="#Disulfide.repr_chain_ids-1307"><span class="linenos">1307</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.repr_chain_ids-1308"><a href="#Disulfide.repr_chain_ids-1308"><span class="linenos">1308</span></a><span class="sd">        Return a string representation of the Disulfide object&#39;s chain ids.</span>
</span><span id="Disulfide.repr_chain_ids-1309"><a href="#Disulfide.repr_chain_ids-1309"><span class="linenos">1309</span></a><span class="sd">        :return: string</span>
</span><span id="Disulfide.repr_chain_ids-1310"><a href="#Disulfide.repr_chain_ids-1310"><span class="linenos">1310</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.repr_chain_ids-1311"><a href="#Disulfide.repr_chain_ids-1311"><span class="linenos">1311</span></a>        <span class="k">return</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repr_ss_chain_ids</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a string representation of the Disulfide object's chain ids.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>string</p>
</blockquote>
</div>


                            </div>
                            <div id="Disulfide.compute_rho" class="classattr">
                                        <input id="Disulfide.compute_rho-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">compute_rho</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.compute_rho-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.compute_rho"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.compute_rho-1313"><a href="#Disulfide.compute_rho-1313"><span class="linenos">1313</span></a>    <span class="k">def</span> <span class="nf">compute_rho</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Disulfide.compute_rho-1314"><a href="#Disulfide.compute_rho-1314"><span class="linenos">1314</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span> <span class="n">calc_dihedral</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_prox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_dist</span><span class="p">)</span>
</span><span id="Disulfide.compute_rho-1315"><a href="#Disulfide.compute_rho-1315"><span class="linenos">1315</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span>
</span></pre></div>


    

                            </div>
                            <div id="Disulfide.reset" class="classattr">
                                        <input id="Disulfide.reset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">reset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Disulfide.reset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.reset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.reset-1317"><a href="#Disulfide.reset-1317"><span class="linenos">1317</span></a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Disulfide.reset-1318"><a href="#Disulfide.reset-1318"><span class="linenos">1318</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.reset-1319"><a href="#Disulfide.reset-1319"><span class="linenos">1319</span></a><span class="sd">        Resets the disulfide object to its initial state. All distances, </span>
</span><span id="Disulfide.reset-1320"><a href="#Disulfide.reset-1320"><span class="linenos">1320</span></a><span class="sd">        angles and positions are reset. The name is unchanged.</span>
</span><span id="Disulfide.reset-1321"><a href="#Disulfide.reset-1321"><span class="linenos">1321</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.reset-1322"><a href="#Disulfide.reset-1322"><span class="linenos">1322</span></a>        <span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Resets the disulfide object to its initial state. All distances, 
angles and positions are reset. The name is unchanged.</p>
</div>


                            </div>
                            <div id="Disulfide.same_chains" class="classattr">
                                        <input id="Disulfide.same_chains-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">same_chains</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="Disulfide.same_chains-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.same_chains"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.same_chains-1324"><a href="#Disulfide.same_chains-1324"><span class="linenos">1324</span></a>    <span class="k">def</span> <span class="nf">same_chains</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Disulfide.same_chains-1325"><a href="#Disulfide.same_chains-1325"><span class="linenos">1325</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.same_chains-1326"><a href="#Disulfide.same_chains-1326"><span class="linenos">1326</span></a><span class="sd">        Function checks if the Disulfide is cross-chain or not.</span>
</span><span id="Disulfide.same_chains-1327"><a href="#Disulfide.same_chains-1327"><span class="linenos">1327</span></a>
</span><span id="Disulfide.same_chains-1328"><a href="#Disulfide.same_chains-1328"><span class="linenos">1328</span></a><span class="sd">        Returns</span>
</span><span id="Disulfide.same_chains-1329"><a href="#Disulfide.same_chains-1329"><span class="linenos">1329</span></a><span class="sd">        -------</span>
</span><span id="Disulfide.same_chains-1330"><a href="#Disulfide.same_chains-1330"><span class="linenos">1330</span></a><span class="sd">        bool \n</span>
</span><span id="Disulfide.same_chains-1331"><a href="#Disulfide.same_chains-1331"><span class="linenos">1331</span></a><span class="sd">            True if the proximal and distal residues are on the same chains,</span>
</span><span id="Disulfide.same_chains-1332"><a href="#Disulfide.same_chains-1332"><span class="linenos">1332</span></a><span class="sd">            False otherwise.</span>
</span><span id="Disulfide.same_chains-1333"><a href="#Disulfide.same_chains-1333"><span class="linenos">1333</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.same_chains-1334"><a href="#Disulfide.same_chains-1334"><span class="linenos">1334</span></a>
</span><span id="Disulfide.same_chains-1335"><a href="#Disulfide.same_chains-1335"><span class="linenos">1335</span></a>        <span class="p">(</span><span class="n">prox</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_chains</span><span class="p">()</span>
</span><span id="Disulfide.same_chains-1336"><a href="#Disulfide.same_chains-1336"><span class="linenos">1336</span></a>        <span class="k">return</span> <span class="n">prox</span> <span class="o">==</span> <span class="n">dist</span>
</span></pre></div>


            <div class="docstring"><p>Function checks if the Disulfide is cross-chain or not.</p>

<h2 id="returns">Returns</h2>

<p>bool </p>

<pre><code>True if the proximal and distal residues are on the same chains,
False otherwise.
</code></pre>
</div>


                            </div>
                            <div id="Disulfide.screenshot" class="classattr">
                                        <input id="Disulfide.screenshot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">screenshot</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">single</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span>,</span><span class="param">	<span class="n">fname</span><span class="o">=</span><span class="s1">&#39;ssbond.png&#39;</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">shadows</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">light</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.screenshot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.screenshot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.screenshot-1338"><a href="#Disulfide.screenshot-1338"><span class="linenos">1338</span></a>    <span class="k">def</span> <span class="nf">screenshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;ssbond.png&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shadows</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">light</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Disulfide.screenshot-1339"><a href="#Disulfide.screenshot-1339"><span class="linenos">1339</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.screenshot-1340"><a href="#Disulfide.screenshot-1340"><span class="linenos">1340</span></a><span class="sd">        Create and save a screenshot of the Disulfide in the given style</span>
</span><span id="Disulfide.screenshot-1341"><a href="#Disulfide.screenshot-1341"><span class="linenos">1341</span></a><span class="sd">        and filename</span>
</span><span id="Disulfide.screenshot-1342"><a href="#Disulfide.screenshot-1342"><span class="linenos">1342</span></a>
</span><span id="Disulfide.screenshot-1343"><a href="#Disulfide.screenshot-1343"><span class="linenos">1343</span></a><span class="sd">        :param single: Display a single vs panel view, defaults to True</span>
</span><span id="Disulfide.screenshot-1344"><a href="#Disulfide.screenshot-1344"><span class="linenos">1344</span></a><span class="sd">        :param style: Rendering style, one of:</span>
</span><span id="Disulfide.screenshot-1345"><a href="#Disulfide.screenshot-1345"><span class="linenos">1345</span></a><span class="sd">        * &#39;sb&#39; - split bonds</span>
</span><span id="Disulfide.screenshot-1346"><a href="#Disulfide.screenshot-1346"><span class="linenos">1346</span></a><span class="sd">        * &#39;bs&#39; - ball and stick</span>
</span><span id="Disulfide.screenshot-1347"><a href="#Disulfide.screenshot-1347"><span class="linenos">1347</span></a><span class="sd">        * &#39;cpk&#39; - CPK style</span>
</span><span id="Disulfide.screenshot-1348"><a href="#Disulfide.screenshot-1348"><span class="linenos">1348</span></a><span class="sd">        * &#39;pd&#39; - Proximal/Distal style - Red=proximal, Green=Distal</span>
</span><span id="Disulfide.screenshot-1349"><a href="#Disulfide.screenshot-1349"><span class="linenos">1349</span></a><span class="sd">        * &#39;plain&#39; - boring single color,</span>
</span><span id="Disulfide.screenshot-1350"><a href="#Disulfide.screenshot-1350"><span class="linenos">1350</span></a><span class="sd">        :param fname: output filename,, defaults to &#39;ssbond.png&#39;</span>
</span><span id="Disulfide.screenshot-1351"><a href="#Disulfide.screenshot-1351"><span class="linenos">1351</span></a><span class="sd">        :param verbose: Verbosit, defaults to False</span>
</span><span id="Disulfide.screenshot-1352"><a href="#Disulfide.screenshot-1352"><span class="linenos">1352</span></a><span class="sd">        :param shadows: Enable shadows, defaults to False</span>
</span><span id="Disulfide.screenshot-1353"><a href="#Disulfide.screenshot-1353"><span class="linenos">1353</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.screenshot-1354"><a href="#Disulfide.screenshot-1354"><span class="linenos">1354</span></a>        <span class="n">src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="Disulfide.screenshot-1355"><a href="#Disulfide.screenshot-1355"><span class="linenos">1355</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
</span><span id="Disulfide.screenshot-1356"><a href="#Disulfide.screenshot-1356"><span class="linenos">1356</span></a>        <span class="n">enrg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span>
</span><span id="Disulfide.screenshot-1357"><a href="#Disulfide.screenshot-1357"><span class="linenos">1357</span></a>
</span><span id="Disulfide.screenshot-1358"><a href="#Disulfide.screenshot-1358"><span class="linenos">1358</span></a>        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">src</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">proximal_chain</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">distal_chain</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">enrg</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kcal/mol, Cα: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å, Cβ: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cb_distance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å, Tors: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Disulfide.screenshot-1359"><a href="#Disulfide.screenshot-1359"><span class="linenos">1359</span></a>
</span><span id="Disulfide.screenshot-1360"><a href="#Disulfide.screenshot-1360"><span class="linenos">1360</span></a>        <span class="k">if</span> <span class="n">light</span><span class="p">:</span>
</span><span id="Disulfide.screenshot-1361"><a href="#Disulfide.screenshot-1361"><span class="linenos">1361</span></a>            <span class="n">pv</span><span class="o">.</span><span class="n">set_plot_theme</span><span class="p">(</span><span class="s1">&#39;document&#39;</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1362"><a href="#Disulfide.screenshot-1362"><span class="linenos">1362</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Disulfide.screenshot-1363"><a href="#Disulfide.screenshot-1363"><span class="linenos">1363</span></a>            <span class="n">pv</span><span class="o">.</span><span class="n">set_plot_theme</span><span class="p">(</span><span class="s1">&#39;dark&#39;</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1364"><a href="#Disulfide.screenshot-1364"><span class="linenos">1364</span></a>            
</span><span id="Disulfide.screenshot-1365"><a href="#Disulfide.screenshot-1365"><span class="linenos">1365</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Disulfide.screenshot-1366"><a href="#Disulfide.screenshot-1366"><span class="linenos">1366</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; screenshot(): Rendering screenshot to file </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1367"><a href="#Disulfide.screenshot-1367"><span class="linenos">1367</span></a>
</span><span id="Disulfide.screenshot-1368"><a href="#Disulfide.screenshot-1368"><span class="linenos">1368</span></a>        <span class="k">if</span> <span class="n">single</span><span class="p">:</span>
</span><span id="Disulfide.screenshot-1369"><a href="#Disulfide.screenshot-1369"><span class="linenos">1369</span></a>            <span class="n">pl</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="n">WINSIZE</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1370"><a href="#Disulfide.screenshot-1370"><span class="linenos">1370</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1371"><a href="#Disulfide.screenshot-1371"><span class="linenos">1371</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">enable_anti_aliasing</span><span class="p">(</span><span class="s1">&#39;msaa&#39;</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1372"><a href="#Disulfide.screenshot-1372"><span class="linenos">1372</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_camera_orientation_widget</span><span class="p">()</span>
</span><span id="Disulfide.screenshot-1373"><a href="#Disulfide.screenshot-1373"><span class="linenos">1373</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="Disulfide.screenshot-1374"><a href="#Disulfide.screenshot-1374"><span class="linenos">1374</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1375"><a href="#Disulfide.screenshot-1375"><span class="linenos">1375</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="Disulfide.screenshot-1376"><a href="#Disulfide.screenshot-1376"><span class="linenos">1376</span></a>            <span class="k">if</span> <span class="n">shadows</span><span class="p">:</span>
</span><span id="Disulfide.screenshot-1377"><a href="#Disulfide.screenshot-1377"><span class="linenos">1377</span></a>                <span class="n">pl</span><span class="o">.</span><span class="n">enable_shadows</span><span class="p">()</span>
</span><span id="Disulfide.screenshot-1378"><a href="#Disulfide.screenshot-1378"><span class="linenos">1378</span></a>            
</span><span id="Disulfide.screenshot-1379"><a href="#Disulfide.screenshot-1379"><span class="linenos">1379</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">auto_close</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1380"><a href="#Disulfide.screenshot-1380"><span class="linenos">1380</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">screenshot</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1381"><a href="#Disulfide.screenshot-1381"><span class="linenos">1381</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="Disulfide.screenshot-1382"><a href="#Disulfide.screenshot-1382"><span class="linenos">1382</span></a>
</span><span id="Disulfide.screenshot-1383"><a href="#Disulfide.screenshot-1383"><span class="linenos">1383</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Disulfide.screenshot-1384"><a href="#Disulfide.screenshot-1384"><span class="linenos">1384</span></a>            <span class="n">pl</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="n">WINSIZE</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</span><span id="Disulfide.screenshot-1385"><a href="#Disulfide.screenshot-1385"><span class="linenos">1385</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1386"><a href="#Disulfide.screenshot-1386"><span class="linenos">1386</span></a>            
</span><span id="Disulfide.screenshot-1387"><a href="#Disulfide.screenshot-1387"><span class="linenos">1387</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1388"><a href="#Disulfide.screenshot-1388"><span class="linenos">1388</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">enable_anti_aliasing</span><span class="p">(</span><span class="s1">&#39;msaa&#39;</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1389"><a href="#Disulfide.screenshot-1389"><span class="linenos">1389</span></a>
</span><span id="Disulfide.screenshot-1390"><a href="#Disulfide.screenshot-1390"><span class="linenos">1390</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_camera_orientation_widget</span><span class="p">()</span>
</span><span id="Disulfide.screenshot-1391"><a href="#Disulfide.screenshot-1391"><span class="linenos">1391</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;cpk&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="Disulfide.screenshot-1392"><a href="#Disulfide.screenshot-1392"><span class="linenos">1392</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="Disulfide.screenshot-1393"><a href="#Disulfide.screenshot-1393"><span class="linenos">1393</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1394"><a href="#Disulfide.screenshot-1394"><span class="linenos">1394</span></a>
</span><span id="Disulfide.screenshot-1395"><a href="#Disulfide.screenshot-1395"><span class="linenos">1395</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1396"><a href="#Disulfide.screenshot-1396"><span class="linenos">1396</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1397"><a href="#Disulfide.screenshot-1397"><span class="linenos">1397</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;pd&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="Disulfide.screenshot-1398"><a href="#Disulfide.screenshot-1398"><span class="linenos">1398</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="Disulfide.screenshot-1399"><a href="#Disulfide.screenshot-1399"><span class="linenos">1399</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1400"><a href="#Disulfide.screenshot-1400"><span class="linenos">1400</span></a>
</span><span id="Disulfide.screenshot-1401"><a href="#Disulfide.screenshot-1401"><span class="linenos">1401</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1402"><a href="#Disulfide.screenshot-1402"><span class="linenos">1402</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1403"><a href="#Disulfide.screenshot-1403"><span class="linenos">1403</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;bs&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="Disulfide.screenshot-1404"><a href="#Disulfide.screenshot-1404"><span class="linenos">1404</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="Disulfide.screenshot-1405"><a href="#Disulfide.screenshot-1405"><span class="linenos">1405</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1406"><a href="#Disulfide.screenshot-1406"><span class="linenos">1406</span></a>            
</span><span id="Disulfide.screenshot-1407"><a href="#Disulfide.screenshot-1407"><span class="linenos">1407</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1408"><a href="#Disulfide.screenshot-1408"><span class="linenos">1408</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">FONTSIZE</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1409"><a href="#Disulfide.screenshot-1409"><span class="linenos">1409</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span> <span class="n">bondcolor</span><span class="o">=</span><span class="n">BOND_COLOR</span><span class="p">,</span> 
</span><span id="Disulfide.screenshot-1410"><a href="#Disulfide.screenshot-1410"><span class="linenos">1410</span></a>                        <span class="n">bs_scale</span><span class="o">=</span><span class="n">BS_SCALE</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="n">SPECULARITY</span><span class="p">,</span> 
</span><span id="Disulfide.screenshot-1411"><a href="#Disulfide.screenshot-1411"><span class="linenos">1411</span></a>                        <span class="n">specpow</span><span class="o">=</span><span class="n">SPEC_POWER</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1412"><a href="#Disulfide.screenshot-1412"><span class="linenos">1412</span></a>
</span><span id="Disulfide.screenshot-1413"><a href="#Disulfide.screenshot-1413"><span class="linenos">1413</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">link_views</span><span class="p">()</span>
</span><span id="Disulfide.screenshot-1414"><a href="#Disulfide.screenshot-1414"><span class="linenos">1414</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="Disulfide.screenshot-1415"><a href="#Disulfide.screenshot-1415"><span class="linenos">1415</span></a>            <span class="k">if</span> <span class="n">shadows</span><span class="p">:</span>
</span><span id="Disulfide.screenshot-1416"><a href="#Disulfide.screenshot-1416"><span class="linenos">1416</span></a>                <span class="n">pl</span><span class="o">.</span><span class="n">enable_shadows</span><span class="p">()</span>
</span><span id="Disulfide.screenshot-1417"><a href="#Disulfide.screenshot-1417"><span class="linenos">1417</span></a>
</span><span id="Disulfide.screenshot-1418"><a href="#Disulfide.screenshot-1418"><span class="linenos">1418</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">auto_close</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1419"><a href="#Disulfide.screenshot-1419"><span class="linenos">1419</span></a>            <span class="n">pl</span><span class="o">.</span><span class="n">screenshot</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
</span><span id="Disulfide.screenshot-1420"><a href="#Disulfide.screenshot-1420"><span class="linenos">1420</span></a>        
</span><span id="Disulfide.screenshot-1421"><a href="#Disulfide.screenshot-1421"><span class="linenos">1421</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Disulfide.screenshot-1422"><a href="#Disulfide.screenshot-1422"><span class="linenos">1422</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Saved: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create and save a screenshot of the Disulfide in the given style
and filename</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>single</strong>:  Display a single vs panel view, defaults to True</li>
<li><strong>style: Rendering style, one of</strong>: 
<ul>
<li>'sb' - split bonds</li>
<li>'bs' - ball and stick</li>
<li>'cpk' - CPK style</li>
<li>'pd' - Proximal/Distal style - Red=proximal, Green=Distal</li>
<li>'plain' - boring single color,</li>
</ul></li>
<li><strong>fname</strong>:  output filename,, defaults to 'ssbond.png'</li>
<li><strong>verbose</strong>:  Verbosit, defaults to False</li>
<li><strong>shadows</strong>:  Enable shadows, defaults to False</li>
</ul>
</div>


                            </div>
                            <div id="Disulfide.set_permissive" class="classattr">
                                        <input id="Disulfide.set_permissive-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_permissive</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">perm</span><span class="p">:</span> <span class="nb">bool</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Disulfide.set_permissive-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.set_permissive"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.set_permissive-1424"><a href="#Disulfide.set_permissive-1424"><span class="linenos">1424</span></a>    <span class="k">def</span> <span class="nf">set_permissive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">perm</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Disulfide.set_permissive-1425"><a href="#Disulfide.set_permissive-1425"><span class="linenos">1425</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.set_permissive-1426"><a href="#Disulfide.set_permissive-1426"><span class="linenos">1426</span></a><span class="sd">        Sets PERMISSIVE flag for Disulfide parsing</span>
</span><span id="Disulfide.set_permissive-1427"><a href="#Disulfide.set_permissive-1427"><span class="linenos">1427</span></a><span class="sd">        :return: None</span>
</span><span id="Disulfide.set_permissive-1428"><a href="#Disulfide.set_permissive-1428"><span class="linenos">1428</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.set_permissive-1429"><a href="#Disulfide.set_permissive-1429"><span class="linenos">1429</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">PERMISSIVE</span> <span class="o">=</span> <span class="n">perm</span>
</span></pre></div>


            <div class="docstring"><p>Sets PERMISSIVE flag for Disulfide parsing</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="Disulfide.set_positions" class="classattr">
                                        <input id="Disulfide.set_positions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_positions</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">n_prox</span><span class="p">:</span> <span class="n">Bio</span><span class="o">.</span><span class="n">PDB</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">Vector</span>,</span><span class="param">	<span class="n">ca_prox</span><span class="p">:</span> <span class="n">Bio</span><span class="o">.</span><span class="n">PDB</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">Vector</span>,</span><span class="param">	<span class="n">c_prox</span><span class="p">:</span> <span class="n">Bio</span><span class="o">.</span><span class="n">PDB</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">Vector</span>,</span><span class="param">	<span class="n">o_prox</span><span class="p">:</span> <span class="n">Bio</span><span class="o">.</span><span class="n">PDB</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">Vector</span>,</span><span class="param">	<span class="n">cb_prox</span><span class="p">:</span> <span class="n">Bio</span><span class="o">.</span><span class="n">PDB</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">Vector</span>,</span><span class="param">	<span class="n">sg_prox</span><span class="p">:</span> <span class="n">Bio</span><span class="o">.</span><span class="n">PDB</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">Vector</span>,</span><span class="param">	<span class="n">n_dist</span><span class="p">:</span> <span class="n">Bio</span><span class="o">.</span><span class="n">PDB</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">Vector</span>,</span><span class="param">	<span class="n">ca_dist</span><span class="p">:</span> <span class="n">Bio</span><span class="o">.</span><span class="n">PDB</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">Vector</span>,</span><span class="param">	<span class="n">c_dist</span><span class="p">:</span> <span class="n">Bio</span><span class="o">.</span><span class="n">PDB</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">Vector</span>,</span><span class="param">	<span class="n">o_dist</span><span class="p">:</span> <span class="n">Bio</span><span class="o">.</span><span class="n">PDB</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">Vector</span>,</span><span class="param">	<span class="n">cb_dist</span><span class="p">:</span> <span class="n">Bio</span><span class="o">.</span><span class="n">PDB</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">Vector</span>,</span><span class="param">	<span class="n">sg_dist</span><span class="p">:</span> <span class="n">Bio</span><span class="o">.</span><span class="n">PDB</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">Vector</span>,</span><span class="param">	<span class="n">c_prev_prox</span><span class="p">:</span> <span class="n">Bio</span><span class="o">.</span><span class="n">PDB</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">Vector</span>,</span><span class="param">	<span class="n">n_next_prox</span><span class="p">:</span> <span class="n">Bio</span><span class="o">.</span><span class="n">PDB</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">Vector</span>,</span><span class="param">	<span class="n">c_prev_dist</span><span class="p">:</span> <span class="n">Bio</span><span class="o">.</span><span class="n">PDB</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">Vector</span>,</span><span class="param">	<span class="n">n_next_dist</span><span class="p">:</span> <span class="n">Bio</span><span class="o">.</span><span class="n">PDB</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">Vector</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.set_positions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.set_positions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.set_positions-1431"><a href="#Disulfide.set_positions-1431"><span class="linenos">1431</span></a>    <span class="k">def</span> <span class="nf">set_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">ca_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">c_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span>
</span><span id="Disulfide.set_positions-1432"><a href="#Disulfide.set_positions-1432"><span class="linenos">1432</span></a>                      <span class="n">o_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">cb_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">sg_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> 
</span><span id="Disulfide.set_positions-1433"><a href="#Disulfide.set_positions-1433"><span class="linenos">1433</span></a>                      <span class="n">n_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">ca_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">c_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span>
</span><span id="Disulfide.set_positions-1434"><a href="#Disulfide.set_positions-1434"><span class="linenos">1434</span></a>                      <span class="n">o_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">cb_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">sg_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span>
</span><span id="Disulfide.set_positions-1435"><a href="#Disulfide.set_positions-1435"><span class="linenos">1435</span></a>                      <span class="n">c_prev_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">n_next_prox</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span>
</span><span id="Disulfide.set_positions-1436"><a href="#Disulfide.set_positions-1436"><span class="linenos">1436</span></a>                      <span class="n">c_prev_dist</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">n_next_dist</span><span class="p">:</span> <span class="n">Vector</span>
</span><span id="Disulfide.set_positions-1437"><a href="#Disulfide.set_positions-1437"><span class="linenos">1437</span></a>                      <span class="p">):</span>
</span><span id="Disulfide.set_positions-1438"><a href="#Disulfide.set_positions-1438"><span class="linenos">1438</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.set_positions-1439"><a href="#Disulfide.set_positions-1439"><span class="linenos">1439</span></a><span class="sd">        Set the atomic coordinates for all atoms in the Disulfide object.</span>
</span><span id="Disulfide.set_positions-1440"><a href="#Disulfide.set_positions-1440"><span class="linenos">1440</span></a>
</span><span id="Disulfide.set_positions-1441"><a href="#Disulfide.set_positions-1441"><span class="linenos">1441</span></a><span class="sd">        :param n_prox: Proximal N position</span>
</span><span id="Disulfide.set_positions-1442"><a href="#Disulfide.set_positions-1442"><span class="linenos">1442</span></a><span class="sd">        :param ca_prox: Proximal Cα position</span>
</span><span id="Disulfide.set_positions-1443"><a href="#Disulfide.set_positions-1443"><span class="linenos">1443</span></a><span class="sd">        :param c_prox: Proximal C&#39; position</span>
</span><span id="Disulfide.set_positions-1444"><a href="#Disulfide.set_positions-1444"><span class="linenos">1444</span></a><span class="sd">        :param o_prox: Proximal O position</span>
</span><span id="Disulfide.set_positions-1445"><a href="#Disulfide.set_positions-1445"><span class="linenos">1445</span></a><span class="sd">        :param cb_prox: Proximal Cβ position</span>
</span><span id="Disulfide.set_positions-1446"><a href="#Disulfide.set_positions-1446"><span class="linenos">1446</span></a><span class="sd">        :param sg_prox: Proximal Sγ position</span>
</span><span id="Disulfide.set_positions-1447"><a href="#Disulfide.set_positions-1447"><span class="linenos">1447</span></a><span class="sd">        :param n_dist: Distal N position</span>
</span><span id="Disulfide.set_positions-1448"><a href="#Disulfide.set_positions-1448"><span class="linenos">1448</span></a><span class="sd">        :param ca_dist: Distal Cα position</span>
</span><span id="Disulfide.set_positions-1449"><a href="#Disulfide.set_positions-1449"><span class="linenos">1449</span></a><span class="sd">        :param c_dist: Distal C&#39; position</span>
</span><span id="Disulfide.set_positions-1450"><a href="#Disulfide.set_positions-1450"><span class="linenos">1450</span></a><span class="sd">        :param o_dist: Distal O position</span>
</span><span id="Disulfide.set_positions-1451"><a href="#Disulfide.set_positions-1451"><span class="linenos">1451</span></a><span class="sd">        :param cb_dist: Distal Cβ position</span>
</span><span id="Disulfide.set_positions-1452"><a href="#Disulfide.set_positions-1452"><span class="linenos">1452</span></a><span class="sd">        :param sg_dist: Distal Sγ position</span>
</span><span id="Disulfide.set_positions-1453"><a href="#Disulfide.set_positions-1453"><span class="linenos">1453</span></a><span class="sd">        :param c_prev_prox: Proximal previous C&#39;</span>
</span><span id="Disulfide.set_positions-1454"><a href="#Disulfide.set_positions-1454"><span class="linenos">1454</span></a><span class="sd">        :param n_next_prox: Proximal next N</span>
</span><span id="Disulfide.set_positions-1455"><a href="#Disulfide.set_positions-1455"><span class="linenos">1455</span></a><span class="sd">        :param c_prev_dist: Distal previous C&#39;</span>
</span><span id="Disulfide.set_positions-1456"><a href="#Disulfide.set_positions-1456"><span class="linenos">1456</span></a><span class="sd">        :param n_next_dist: Distal next N</span>
</span><span id="Disulfide.set_positions-1457"><a href="#Disulfide.set_positions-1457"><span class="linenos">1457</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.set_positions-1458"><a href="#Disulfide.set_positions-1458"><span class="linenos">1458</span></a>        
</span><span id="Disulfide.set_positions-1459"><a href="#Disulfide.set_positions-1459"><span class="linenos">1459</span></a>        <span class="c1"># deep copy</span>
</span><span id="Disulfide.set_positions-1460"><a href="#Disulfide.set_positions-1460"><span class="linenos">1460</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_prox</span> <span class="o">=</span> <span class="n">n_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide.set_positions-1461"><a href="#Disulfide.set_positions-1461"><span class="linenos">1461</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_prox</span> <span class="o">=</span> <span class="n">ca_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide.set_positions-1462"><a href="#Disulfide.set_positions-1462"><span class="linenos">1462</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prox</span> <span class="o">=</span> <span class="n">c_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide.set_positions-1463"><a href="#Disulfide.set_positions-1463"><span class="linenos">1463</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">o_prox</span> <span class="o">=</span> <span class="n">o_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide.set_positions-1464"><a href="#Disulfide.set_positions-1464"><span class="linenos">1464</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_prox</span> <span class="o">=</span> <span class="n">cb_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide.set_positions-1465"><a href="#Disulfide.set_positions-1465"><span class="linenos">1465</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_prox</span> <span class="o">=</span> <span class="n">sg_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide.set_positions-1466"><a href="#Disulfide.set_positions-1466"><span class="linenos">1466</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_dist</span> <span class="o">=</span> <span class="n">sg_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide.set_positions-1467"><a href="#Disulfide.set_positions-1467"><span class="linenos">1467</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cb_dist</span> <span class="o">=</span> <span class="n">cb_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide.set_positions-1468"><a href="#Disulfide.set_positions-1468"><span class="linenos">1468</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ca_dist</span> <span class="o">=</span> <span class="n">ca_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide.set_positions-1469"><a href="#Disulfide.set_positions-1469"><span class="linenos">1469</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_dist</span> <span class="o">=</span> <span class="n">n_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide.set_positions-1470"><a href="#Disulfide.set_positions-1470"><span class="linenos">1470</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_dist</span> <span class="o">=</span> <span class="n">c_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide.set_positions-1471"><a href="#Disulfide.set_positions-1471"><span class="linenos">1471</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">o_dist</span> <span class="o">=</span> <span class="n">o_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide.set_positions-1472"><a href="#Disulfide.set_positions-1472"><span class="linenos">1472</span></a>
</span><span id="Disulfide.set_positions-1473"><a href="#Disulfide.set_positions-1473"><span class="linenos">1473</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prev_prox</span> <span class="o">=</span> <span class="n">c_prev_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide.set_positions-1474"><a href="#Disulfide.set_positions-1474"><span class="linenos">1474</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_next_prox</span> <span class="o">=</span> <span class="n">n_next_prox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide.set_positions-1475"><a href="#Disulfide.set_positions-1475"><span class="linenos">1475</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c_prev_dist</span> <span class="o">=</span> <span class="n">c_prev_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Disulfide.set_positions-1476"><a href="#Disulfide.set_positions-1476"><span class="linenos">1476</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_next_dist</span> <span class="o">=</span> <span class="n">n_next_dist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Set the atomic coordinates for all atoms in the Disulfide object.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>n_prox</strong>:  Proximal N position</li>
<li><strong>ca_prox</strong>:  Proximal Cα position</li>
<li><strong>c_prox</strong>:  Proximal C' position</li>
<li><strong>o_prox</strong>:  Proximal O position</li>
<li><strong>cb_prox</strong>:  Proximal Cβ position</li>
<li><strong>sg_prox</strong>:  Proximal Sγ position</li>
<li><strong>n_dist</strong>:  Distal N position</li>
<li><strong>ca_dist</strong>:  Distal Cα position</li>
<li><strong>c_dist</strong>:  Distal C' position</li>
<li><strong>o_dist</strong>:  Distal O position</li>
<li><strong>cb_dist</strong>:  Distal Cβ position</li>
<li><strong>sg_dist</strong>:  Distal Sγ position</li>
<li><strong>c_prev_prox</strong>:  Proximal previous C'</li>
<li><strong>n_next_prox</strong>:  Proximal next N</li>
<li><strong>c_prev_dist</strong>:  Distal previous C'</li>
<li><strong>n_next_dist</strong>:  Distal next N</li>
</ul>
</div>


                            </div>
                            <div id="Disulfide.set_dihedrals" class="classattr">
                                        <input id="Disulfide.set_dihedrals-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_dihedrals</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">chi1</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">chi2</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">chi3</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">chi4</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">chi5</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.set_dihedrals-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.set_dihedrals"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.set_dihedrals-1478"><a href="#Disulfide.set_dihedrals-1478"><span class="linenos">1478</span></a>    <span class="k">def</span> <span class="nf">set_dihedrals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chi1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">chi2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">chi3</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="Disulfide.set_dihedrals-1479"><a href="#Disulfide.set_dihedrals-1479"><span class="linenos">1479</span></a>                    <span class="n">chi4</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">chi5</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="Disulfide.set_dihedrals-1480"><a href="#Disulfide.set_dihedrals-1480"><span class="linenos">1480</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.set_dihedrals-1481"><a href="#Disulfide.set_dihedrals-1481"><span class="linenos">1481</span></a><span class="sd">        Set the disulfide&#39;s dihedral angles, Chi1-Chi5. -180 - 180 degrees.</span>
</span><span id="Disulfide.set_dihedrals-1482"><a href="#Disulfide.set_dihedrals-1482"><span class="linenos">1482</span></a>
</span><span id="Disulfide.set_dihedrals-1483"><a href="#Disulfide.set_dihedrals-1483"><span class="linenos">1483</span></a><span class="sd">        :param chi1: Chi1</span>
</span><span id="Disulfide.set_dihedrals-1484"><a href="#Disulfide.set_dihedrals-1484"><span class="linenos">1484</span></a><span class="sd">        :param chi2: Chi2</span>
</span><span id="Disulfide.set_dihedrals-1485"><a href="#Disulfide.set_dihedrals-1485"><span class="linenos">1485</span></a><span class="sd">        :param chi3: Chi3</span>
</span><span id="Disulfide.set_dihedrals-1486"><a href="#Disulfide.set_dihedrals-1486"><span class="linenos">1486</span></a><span class="sd">        :param chi4: Chi4</span>
</span><span id="Disulfide.set_dihedrals-1487"><a href="#Disulfide.set_dihedrals-1487"><span class="linenos">1487</span></a><span class="sd">        :param chi5: Chi5</span>
</span><span id="Disulfide.set_dihedrals-1488"><a href="#Disulfide.set_dihedrals-1488"><span class="linenos">1488</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.set_dihedrals-1489"><a href="#Disulfide.set_dihedrals-1489"><span class="linenos">1489</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi1</span> <span class="o">=</span> <span class="n">chi1</span>
</span><span id="Disulfide.set_dihedrals-1490"><a href="#Disulfide.set_dihedrals-1490"><span class="linenos">1490</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi2</span> <span class="o">=</span> <span class="n">chi2</span>
</span><span id="Disulfide.set_dihedrals-1491"><a href="#Disulfide.set_dihedrals-1491"><span class="linenos">1491</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi3</span> <span class="o">=</span> <span class="n">chi3</span>
</span><span id="Disulfide.set_dihedrals-1492"><a href="#Disulfide.set_dihedrals-1492"><span class="linenos">1492</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi4</span> <span class="o">=</span> <span class="n">chi4</span>
</span><span id="Disulfide.set_dihedrals-1493"><a href="#Disulfide.set_dihedrals-1493"><span class="linenos">1493</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chi5</span> <span class="o">=</span> <span class="n">chi5</span>
</span><span id="Disulfide.set_dihedrals-1494"><a href="#Disulfide.set_dihedrals-1494"><span class="linenos">1494</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="p">,</span> <span class="n">chi3</span><span class="p">,</span> <span class="n">chi4</span><span class="p">,</span> <span class="n">chi5</span><span class="p">])</span>
</span><span id="Disulfide.set_dihedrals-1495"><a href="#Disulfide.set_dihedrals-1495"><span class="linenos">1495</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">compute_torsional_energy</span><span class="p">()</span>
</span><span id="Disulfide.set_dihedrals-1496"><a href="#Disulfide.set_dihedrals-1496"><span class="linenos">1496</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Torsion_Length</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Set the disulfide's dihedral angles, Chi1-Chi5. -180 - 180 degrees.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>chi1</strong>:  Chi1</li>
<li><strong>chi2</strong>:  Chi2</li>
<li><strong>chi3</strong>:  Chi3</li>
<li><strong>chi4</strong>:  Chi4</li>
<li><strong>chi5</strong>:  Chi5</li>
</ul>
</div>


                            </div>
                            <div id="Disulfide.set_name" class="classattr">
                                        <input id="Disulfide.set_name-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_name</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">namestr</span><span class="o">=</span><span class="s1">&#39;Disulfide&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.set_name-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.set_name"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.set_name-1498"><a href="#Disulfide.set_name-1498"><span class="linenos">1498</span></a>    <span class="k">def</span> <span class="nf">set_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">namestr</span><span class="o">=</span><span class="s2">&quot;Disulfide&quot;</span><span class="p">):</span>
</span><span id="Disulfide.set_name-1499"><a href="#Disulfide.set_name-1499"><span class="linenos">1499</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.set_name-1500"><a href="#Disulfide.set_name-1500"><span class="linenos">1500</span></a><span class="sd">        Set&#39;s the Disulfide&#39;s name</span>
</span><span id="Disulfide.set_name-1501"><a href="#Disulfide.set_name-1501"><span class="linenos">1501</span></a>
</span><span id="Disulfide.set_name-1502"><a href="#Disulfide.set_name-1502"><span class="linenos">1502</span></a><span class="sd">        :param namestr: Name, by default &quot;Disulfide&quot;</span>
</span><span id="Disulfide.set_name-1503"><a href="#Disulfide.set_name-1503"><span class="linenos">1503</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.set_name-1504"><a href="#Disulfide.set_name-1504"><span class="linenos">1504</span></a>
</span><span id="Disulfide.set_name-1505"><a href="#Disulfide.set_name-1505"><span class="linenos">1505</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">namestr</span>
</span></pre></div>


            <div class="docstring"><p>Set's the Disulfide's name</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>namestr</strong>:  Name, by default "Disulfide"</li>
</ul>
</div>


                            </div>
                            <div id="Disulfide.set_resnum" class="classattr">
                                        <input id="Disulfide.set_resnum-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_resnum</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">proximal</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">distal</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Disulfide.set_resnum-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.set_resnum"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.set_resnum-1507"><a href="#Disulfide.set_resnum-1507"><span class="linenos">1507</span></a>    <span class="k">def</span> <span class="nf">set_resnum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proximal</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">distal</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Disulfide.set_resnum-1508"><a href="#Disulfide.set_resnum-1508"><span class="linenos">1508</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.set_resnum-1509"><a href="#Disulfide.set_resnum-1509"><span class="linenos">1509</span></a><span class="sd">        Set the proximal and residue numbers for the Disulfide.</span>
</span><span id="Disulfide.set_resnum-1510"><a href="#Disulfide.set_resnum-1510"><span class="linenos">1510</span></a>
</span><span id="Disulfide.set_resnum-1511"><a href="#Disulfide.set_resnum-1511"><span class="linenos">1511</span></a><span class="sd">        :param proximal: Proximal residue number</span>
</span><span id="Disulfide.set_resnum-1512"><a href="#Disulfide.set_resnum-1512"><span class="linenos">1512</span></a><span class="sd">        :param distal: Distal residue number</span>
</span><span id="Disulfide.set_resnum-1513"><a href="#Disulfide.set_resnum-1513"><span class="linenos">1513</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.set_resnum-1514"><a href="#Disulfide.set_resnum-1514"><span class="linenos">1514</span></a>
</span><span id="Disulfide.set_resnum-1515"><a href="#Disulfide.set_resnum-1515"><span class="linenos">1515</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proximal</span> <span class="o">=</span> <span class="n">proximal</span>
</span><span id="Disulfide.set_resnum-1516"><a href="#Disulfide.set_resnum-1516"><span class="linenos">1516</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distal</span> <span class="o">=</span> <span class="n">distal</span>
</span></pre></div>


            <div class="docstring"><p>Set the proximal and residue numbers for the Disulfide.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>proximal</strong>:  Proximal residue number</li>
<li><strong>distal</strong>:  Distal residue number</li>
</ul>
</div>


                            </div>
                            <div id="Disulfide.Torsion_Length" class="classattr">
                                        <input id="Disulfide.Torsion_Length-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">Torsion_Length</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="Disulfide.Torsion_Length-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.Torsion_Length"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.Torsion_Length-1518"><a href="#Disulfide.Torsion_Length-1518"><span class="linenos">1518</span></a>    <span class="k">def</span> <span class="nf">Torsion_Length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Disulfide.Torsion_Length-1519"><a href="#Disulfide.Torsion_Length-1519"><span class="linenos">1519</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.Torsion_Length-1520"><a href="#Disulfide.Torsion_Length-1520"><span class="linenos">1520</span></a><span class="sd">        Compute the 5D Euclidean length of the Disulfide object</span>
</span><span id="Disulfide.Torsion_Length-1521"><a href="#Disulfide.Torsion_Length-1521"><span class="linenos">1521</span></a><span class="sd">        and update the Disulfide internal state.</span>
</span><span id="Disulfide.Torsion_Length-1522"><a href="#Disulfide.Torsion_Length-1522"><span class="linenos">1522</span></a>
</span><span id="Disulfide.Torsion_Length-1523"><a href="#Disulfide.Torsion_Length-1523"><span class="linenos">1523</span></a><span class="sd">        :return: Torsion length (Degrees)</span>
</span><span id="Disulfide.Torsion_Length-1524"><a href="#Disulfide.Torsion_Length-1524"><span class="linenos">1524</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.Torsion_Length-1525"><a href="#Disulfide.Torsion_Length-1525"><span class="linenos">1525</span></a>
</span><span id="Disulfide.Torsion_Length-1526"><a href="#Disulfide.Torsion_Length-1526"><span class="linenos">1526</span></a>        <span class="c1"># Use numpy array to compute element-wise square</span>
</span><span id="Disulfide.Torsion_Length-1527"><a href="#Disulfide.Torsion_Length-1527"><span class="linenos">1527</span></a>        <span class="n">tors2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span><span class="p">)</span>
</span><span id="Disulfide.Torsion_Length-1528"><a href="#Disulfide.Torsion_Length-1528"><span class="linenos">1528</span></a>
</span><span id="Disulfide.Torsion_Length-1529"><a href="#Disulfide.Torsion_Length-1529"><span class="linenos">1529</span></a>        <span class="c1"># Compute the sum of squares using numpy&#39;s sum function</span>
</span><span id="Disulfide.Torsion_Length-1530"><a href="#Disulfide.Torsion_Length-1530"><span class="linenos">1530</span></a>        <span class="n">dist</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">tors2</span><span class="p">))</span>
</span><span id="Disulfide.Torsion_Length-1531"><a href="#Disulfide.Torsion_Length-1531"><span class="linenos">1531</span></a>
</span><span id="Disulfide.Torsion_Length-1532"><a href="#Disulfide.Torsion_Length-1532"><span class="linenos">1532</span></a>        <span class="c1"># Update the internal state</span>
</span><span id="Disulfide.Torsion_Length-1533"><a href="#Disulfide.Torsion_Length-1533"><span class="linenos">1533</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_length</span> <span class="o">=</span> <span class="n">dist</span>
</span><span id="Disulfide.Torsion_Length-1534"><a href="#Disulfide.Torsion_Length-1534"><span class="linenos">1534</span></a>
</span><span id="Disulfide.Torsion_Length-1535"><a href="#Disulfide.Torsion_Length-1535"><span class="linenos">1535</span></a>        <span class="k">return</span> <span class="n">dist</span>
</span></pre></div>


            <div class="docstring"><p>Compute the 5D Euclidean length of the Disulfide object
and update the Disulfide internal state.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Torsion length (Degrees)</p>
</blockquote>
</div>


                            </div>
                            <div id="Disulfide.Torsion_Distance" class="classattr">
                                        <input id="Disulfide.Torsion_Distance-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">Torsion_Distance</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">other</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="Disulfide.Torsion_Distance-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.Torsion_Distance"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.Torsion_Distance-1537"><a href="#Disulfide.Torsion_Distance-1537"><span class="linenos">1537</span></a>    <span class="k">def</span> <span class="nf">Torsion_Distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Disulfide.Torsion_Distance-1538"><a href="#Disulfide.Torsion_Distance-1538"><span class="linenos">1538</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.Torsion_Distance-1539"><a href="#Disulfide.Torsion_Distance-1539"><span class="linenos">1539</span></a><span class="sd">        Calculate the 5D Euclidean distance between ```self``` and another Disulfide</span>
</span><span id="Disulfide.Torsion_Distance-1540"><a href="#Disulfide.Torsion_Distance-1540"><span class="linenos">1540</span></a><span class="sd">        object. This is used to compare Disulfide Bond torsion angles to </span>
</span><span id="Disulfide.Torsion_Distance-1541"><a href="#Disulfide.Torsion_Distance-1541"><span class="linenos">1541</span></a><span class="sd">        determine their torsional similarity via a 5-Dimensional Euclidean distance metric.</span>
</span><span id="Disulfide.Torsion_Distance-1542"><a href="#Disulfide.Torsion_Distance-1542"><span class="linenos">1542</span></a>
</span><span id="Disulfide.Torsion_Distance-1543"><a href="#Disulfide.Torsion_Distance-1543"><span class="linenos">1543</span></a><span class="sd">        :param other: Comparison Disulfide</span>
</span><span id="Disulfide.Torsion_Distance-1544"><a href="#Disulfide.Torsion_Distance-1544"><span class="linenos">1544</span></a><span class="sd">        :raises ProteusPyWarning: Warning if ```other``` is not a Disulfide object</span>
</span><span id="Disulfide.Torsion_Distance-1545"><a href="#Disulfide.Torsion_Distance-1545"><span class="linenos">1545</span></a><span class="sd">        :return: Euclidean distance (Degrees) between ```self``` and ```other```.</span>
</span><span id="Disulfide.Torsion_Distance-1546"><a href="#Disulfide.Torsion_Distance-1546"><span class="linenos">1546</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.Torsion_Distance-1547"><a href="#Disulfide.Torsion_Distance-1547"><span class="linenos">1547</span></a>
</span><span id="Disulfide.Torsion_Distance-1548"><a href="#Disulfide.Torsion_Distance-1548"><span class="linenos">1548</span></a>        <span class="c1"># Check length of torsion arrays</span>
</span><span id="Disulfide.Torsion_Distance-1549"><a href="#Disulfide.Torsion_Distance-1549"><span class="linenos">1549</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">5</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">torsion_array</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Disulfide.Torsion_Distance-1550"><a href="#Disulfide.Torsion_Distance-1550"><span class="linenos">1550</span></a>            <span class="k">raise</span> <span class="n">ProteusPyWarning</span><span class="p">(</span><span class="s2">&quot;--&gt; Torsion_Distance() requires vectors of length 5!&quot;</span><span class="p">)</span>
</span><span id="Disulfide.Torsion_Distance-1551"><a href="#Disulfide.Torsion_Distance-1551"><span class="linenos">1551</span></a>
</span><span id="Disulfide.Torsion_Distance-1552"><a href="#Disulfide.Torsion_Distance-1552"><span class="linenos">1552</span></a>        <span class="c1"># Convert to numpy arrays and add 180 to each element</span>
</span><span id="Disulfide.Torsion_Distance-1553"><a href="#Disulfide.Torsion_Distance-1553"><span class="linenos">1553</span></a>        <span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_array</span><span class="p">)</span> <span class="o">+</span> <span class="mf">180.0</span>
</span><span id="Disulfide.Torsion_Distance-1554"><a href="#Disulfide.Torsion_Distance-1554"><span class="linenos">1554</span></a>        <span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">torsion_array</span><span class="p">)</span> <span class="o">+</span> <span class="mf">180.0</span>
</span><span id="Disulfide.Torsion_Distance-1555"><a href="#Disulfide.Torsion_Distance-1555"><span class="linenos">1555</span></a>
</span><span id="Disulfide.Torsion_Distance-1556"><a href="#Disulfide.Torsion_Distance-1556"><span class="linenos">1556</span></a>        <span class="c1"># Compute the 5D Euclidean distance using numpy&#39;s linalg.norm function</span>
</span><span id="Disulfide.Torsion_Distance-1557"><a href="#Disulfide.Torsion_Distance-1557"><span class="linenos">1557</span></a>        <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p1</span> <span class="o">-</span> <span class="n">p2</span><span class="p">)</span>
</span><span id="Disulfide.Torsion_Distance-1558"><a href="#Disulfide.Torsion_Distance-1558"><span class="linenos">1558</span></a>
</span><span id="Disulfide.Torsion_Distance-1559"><a href="#Disulfide.Torsion_Distance-1559"><span class="linenos">1559</span></a>        <span class="k">return</span> <span class="n">dist</span>
</span></pre></div>


            <div class="docstring"><p>Calculate the 5D Euclidean distance between <code>self</code> and another Disulfide
object. This is used to compare Disulfide Bond torsion angles to 
determine their torsional similarity via a 5-Dimensional Euclidean distance metric.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>other</strong>:  Comparison Disulfide</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ProteusPyWarning</strong>:  Warning if <code>other</code> is not a Disulfide object</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Euclidean distance (Degrees) between <code>self</code> and <code>other</code>.</p>
</blockquote>
</div>


                            </div>
                            <div id="Disulfide.Torsion_neighbors" class="classattr">
                                        <input id="Disulfide.Torsion_neighbors-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">Torsion_neighbors</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">others</span>, </span><span class="param"><span class="n">cutoff</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Disulfide.Torsion_neighbors-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Disulfide.Torsion_neighbors"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Disulfide.Torsion_neighbors-1561"><a href="#Disulfide.Torsion_neighbors-1561"><span class="linenos">1561</span></a>    <span class="k">def</span> <span class="nf">Torsion_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">others</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">):</span>
</span><span id="Disulfide.Torsion_neighbors-1562"><a href="#Disulfide.Torsion_neighbors-1562"><span class="linenos">1562</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Disulfide.Torsion_neighbors-1563"><a href="#Disulfide.Torsion_neighbors-1563"><span class="linenos">1563</span></a><span class="sd">        Returns list of Disulfides within the angular cutoff in the others list.</span>
</span><span id="Disulfide.Torsion_neighbors-1564"><a href="#Disulfide.Torsion_neighbors-1564"><span class="linenos">1564</span></a><span class="sd">        This routine is used to find Disulfides having the same torsion length</span>
</span><span id="Disulfide.Torsion_neighbors-1565"><a href="#Disulfide.Torsion_neighbors-1565"><span class="linenos">1565</span></a><span class="sd">        within the others list. This is used to find families of Disulfides with</span>
</span><span id="Disulfide.Torsion_neighbors-1566"><a href="#Disulfide.Torsion_neighbors-1566"><span class="linenos">1566</span></a><span class="sd">        similar conformations. Assumes self is properly initialized.</span>
</span><span id="Disulfide.Torsion_neighbors-1567"><a href="#Disulfide.Torsion_neighbors-1567"><span class="linenos">1567</span></a><span class="sd">        </span>
</span><span id="Disulfide.Torsion_neighbors-1568"><a href="#Disulfide.Torsion_neighbors-1568"><span class="linenos">1568</span></a><span class="sd">        *NB* The routine will not distinguish between +/-</span>
</span><span id="Disulfide.Torsion_neighbors-1569"><a href="#Disulfide.Torsion_neighbors-1569"><span class="linenos">1569</span></a><span class="sd">        dihedral angles. *i.e.* [-60, -60, -90, -60, -60] would have the same</span>
</span><span id="Disulfide.Torsion_neighbors-1570"><a href="#Disulfide.Torsion_neighbors-1570"><span class="linenos">1570</span></a><span class="sd">        torsion length as [60, 60, 90, 60, 60], two clearly different structures.</span>
</span><span id="Disulfide.Torsion_neighbors-1571"><a href="#Disulfide.Torsion_neighbors-1571"><span class="linenos">1571</span></a>
</span><span id="Disulfide.Torsion_neighbors-1572"><a href="#Disulfide.Torsion_neighbors-1572"><span class="linenos">1572</span></a><span class="sd">        :param others: ```DisulfideList``` to search</span>
</span><span id="Disulfide.Torsion_neighbors-1573"><a href="#Disulfide.Torsion_neighbors-1573"><span class="linenos">1573</span></a><span class="sd">        :param cutoff: Dihedral angle degree cutoff</span>
</span><span id="Disulfide.Torsion_neighbors-1574"><a href="#Disulfide.Torsion_neighbors-1574"><span class="linenos">1574</span></a><span class="sd">        :return: DisulfideList within the cutoff</span>
</span><span id="Disulfide.Torsion_neighbors-1575"><a href="#Disulfide.Torsion_neighbors-1575"><span class="linenos">1575</span></a>
</span><span id="Disulfide.Torsion_neighbors-1576"><a href="#Disulfide.Torsion_neighbors-1576"><span class="linenos">1576</span></a><span class="sd">        Example:</span>
</span><span id="Disulfide.Torsion_neighbors-1577"><a href="#Disulfide.Torsion_neighbors-1577"><span class="linenos">1577</span></a><span class="sd">        In this example we load the disulfide database subset, find the disulfides with</span>
</span><span id="Disulfide.Torsion_neighbors-1578"><a href="#Disulfide.Torsion_neighbors-1578"><span class="linenos">1578</span></a><span class="sd">        the lowest and highest energies, and then find the nearest conformational neighbors.</span>
</span><span id="Disulfide.Torsion_neighbors-1579"><a href="#Disulfide.Torsion_neighbors-1579"><span class="linenos">1579</span></a><span class="sd">        Finally, we display the neighbors overlaid against a common reference frame.</span>
</span><span id="Disulfide.Torsion_neighbors-1580"><a href="#Disulfide.Torsion_neighbors-1580"><span class="linenos">1580</span></a>
</span><span id="Disulfide.Torsion_neighbors-1581"><a href="#Disulfide.Torsion_neighbors-1581"><span class="linenos">1581</span></a><span class="sd">        &gt;&gt;&gt; import proteusPy</span>
</span><span id="Disulfide.Torsion_neighbors-1582"><a href="#Disulfide.Torsion_neighbors-1582"><span class="linenos">1582</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideLoader import DisulfideLoader</span>
</span><span id="Disulfide.Torsion_neighbors-1583"><a href="#Disulfide.Torsion_neighbors-1583"><span class="linenos">1583</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideList import DisulfideList</span>
</span><span id="Disulfide.Torsion_neighbors-1584"><a href="#Disulfide.Torsion_neighbors-1584"><span class="linenos">1584</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.Disulfide import Disulfide</span>
</span><span id="Disulfide.Torsion_neighbors-1585"><a href="#Disulfide.Torsion_neighbors-1585"><span class="linenos">1585</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = None</span>
</span><span id="Disulfide.Torsion_neighbors-1586"><a href="#Disulfide.Torsion_neighbors-1586"><span class="linenos">1586</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = Load_PDB_SS(verbose=False, subset=True)</span>
</span><span id="Disulfide.Torsion_neighbors-1587"><a href="#Disulfide.Torsion_neighbors-1587"><span class="linenos">1587</span></a><span class="sd">        &gt;&gt;&gt; ss_list = DisulfideList([], &#39;tmp&#39;)</span>
</span><span id="Disulfide.Torsion_neighbors-1588"><a href="#Disulfide.Torsion_neighbors-1588"><span class="linenos">1588</span></a>
</span><span id="Disulfide.Torsion_neighbors-1589"><a href="#Disulfide.Torsion_neighbors-1589"><span class="linenos">1589</span></a><span class="sd">        We point to the complete list to search for lowest and highest energies.</span>
</span><span id="Disulfide.Torsion_neighbors-1590"><a href="#Disulfide.Torsion_neighbors-1590"><span class="linenos">1590</span></a><span class="sd">        &gt;&gt;&gt; sslist = PDB_SS.SSList</span>
</span><span id="Disulfide.Torsion_neighbors-1591"><a href="#Disulfide.Torsion_neighbors-1591"><span class="linenos">1591</span></a><span class="sd">        &gt;&gt;&gt; ssmin_enrg, ssmax_enrg = PDB_SS.SSList.minmax_energy()</span>
</span><span id="Disulfide.Torsion_neighbors-1592"><a href="#Disulfide.Torsion_neighbors-1592"><span class="linenos">1592</span></a>
</span><span id="Disulfide.Torsion_neighbors-1593"><a href="#Disulfide.Torsion_neighbors-1593"><span class="linenos">1593</span></a><span class="sd">        Make an empty list and find the nearest neighbors within 10 degrees avg RMS in</span>
</span><span id="Disulfide.Torsion_neighbors-1594"><a href="#Disulfide.Torsion_neighbors-1594"><span class="linenos">1594</span></a><span class="sd">        sidechain dihedral angle space.</span>
</span><span id="Disulfide.Torsion_neighbors-1595"><a href="#Disulfide.Torsion_neighbors-1595"><span class="linenos">1595</span></a>
</span><span id="Disulfide.Torsion_neighbors-1596"><a href="#Disulfide.Torsion_neighbors-1596"><span class="linenos">1596</span></a><span class="sd">        &gt;&gt;&gt; low_energy_neighbors = DisulfideList([],&#39;Neighbors&#39;)</span>
</span><span id="Disulfide.Torsion_neighbors-1597"><a href="#Disulfide.Torsion_neighbors-1597"><span class="linenos">1597</span></a><span class="sd">        &gt;&gt;&gt; low_energy_neighbors = ssmin_enrg.Torsion_neighbors(sslist, 10)</span>
</span><span id="Disulfide.Torsion_neighbors-1598"><a href="#Disulfide.Torsion_neighbors-1598"><span class="linenos">1598</span></a>
</span><span id="Disulfide.Torsion_neighbors-1599"><a href="#Disulfide.Torsion_neighbors-1599"><span class="linenos">1599</span></a><span class="sd">        Display the number found, and then display them overlaid onto their common reference frame.</span>
</span><span id="Disulfide.Torsion_neighbors-1600"><a href="#Disulfide.Torsion_neighbors-1600"><span class="linenos">1600</span></a>
</span><span id="Disulfide.Torsion_neighbors-1601"><a href="#Disulfide.Torsion_neighbors-1601"><span class="linenos">1601</span></a><span class="sd">        &gt;&gt;&gt; tot = low_energy_neighbors.length</span>
</span><span id="Disulfide.Torsion_neighbors-1602"><a href="#Disulfide.Torsion_neighbors-1602"><span class="linenos">1602</span></a><span class="sd">        &gt;&gt;&gt; print(f&#39;Neighbors: {tot}&#39;)</span>
</span><span id="Disulfide.Torsion_neighbors-1603"><a href="#Disulfide.Torsion_neighbors-1603"><span class="linenos">1603</span></a><span class="sd">        Neighbors: 2</span>
</span><span id="Disulfide.Torsion_neighbors-1604"><a href="#Disulfide.Torsion_neighbors-1604"><span class="linenos">1604</span></a><span class="sd">        &gt;&gt;&gt; low_energy_neighbors.display_overlay()</span>
</span><span id="Disulfide.Torsion_neighbors-1605"><a href="#Disulfide.Torsion_neighbors-1605"><span class="linenos">1605</span></a>
</span><span id="Disulfide.Torsion_neighbors-1606"><a href="#Disulfide.Torsion_neighbors-1606"><span class="linenos">1606</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Disulfide.Torsion_neighbors-1607"><a href="#Disulfide.Torsion_neighbors-1607"><span class="linenos">1607</span></a>        
</span><span id="Disulfide.Torsion_neighbors-1608"><a href="#Disulfide.Torsion_neighbors-1608"><span class="linenos">1608</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">ss</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">others</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Torsion_Distance</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">cutoff</span><span class="p">]</span>
</span><span id="Disulfide.Torsion_neighbors-1609"><a href="#Disulfide.Torsion_neighbors-1609"><span class="linenos">1609</span></a>        <span class="k">return</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s1">&#39;neighbors&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns list of Disulfides within the angular cutoff in the others list.
This routine is used to find Disulfides having the same torsion length
within the others list. This is used to find families of Disulfides with
similar conformations. Assumes self is properly initialized.</p>

<p><em>NB</em> The routine will not distinguish between +/-
dihedral angles. <em>i.e.</em> [-60, -60, -90, -60, -60] would have the same
torsion length as [60, 60, 90, 60, 60], two clearly different structures.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>others</strong>:  <code>DisulfideList</code> to search</li>
<li><strong>cutoff</strong>:  Dihedral angle degree cutoff</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>DisulfideList within the cutoff</p>
</blockquote>

<p>Example:
In this example we load the disulfide database subset, find the disulfides with
the lowest and highest energies, and then find the nearest conformational neighbors.
Finally, we display the neighbors overlaid against a common reference frame.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">proteusPy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="DisulfideLoader.html">proteusPy.DisulfideLoader</a></span> <span class="kn">import</span> <span class="n">DisulfideLoader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="DisulfideList.html">proteusPy.DisulfideList</a></span> <span class="kn">import</span> <span class="n">DisulfideList</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="">proteusPy.Disulfide</a></span> <span class="kn">import</span> <span class="n">Disulfide</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PDB_SS</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PDB_SS</span> <span class="o">=</span> <span class="n">Load_PDB_SS</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ss_list</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
</code></pre>
</div>

<p>We point to the complete list to search for lowest and highest energies.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">sslist</span> <span class="o">=</span> <span class="n">PDB_SS</span><span class="o">.</span><span class="n">SSList</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssmin_enrg</span><span class="p">,</span> <span class="n">ssmax_enrg</span> <span class="o">=</span> <span class="n">PDB_SS</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">minmax_energy</span><span class="p">()</span>
</code></pre>
</div>

<p>Make an empty list and find the nearest neighbors within 10 degrees avg RMS in
sidechain dihedral angle space.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">low_energy_neighbors</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span><span class="s1">&#39;Neighbors&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">low_energy_neighbors</span> <span class="o">=</span> <span class="n">ssmin_enrg</span><span class="o">.</span><span class="n">Torsion_neighbors</span><span class="p">(</span><span class="n">sslist</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</code></pre>
</div>

<p>Display the number found, and then display them overlaid onto their common reference frame.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">tot</span> <span class="o">=</span> <span class="n">low_energy_neighbors</span><span class="o">.</span><span class="n">length</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Neighbors: </span><span class="si">{</span><span class="n">tot</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">Neighbors: 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">low_energy_neighbors</span><span class="o">.</span><span class="n">display_overlay</span><span class="p">()</span>
</code></pre>
</div>
</div>


                            </div>
                </section>
                <section id="parse_ssbond_header_rec">
                            <input id="parse_ssbond_header_rec-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parse_ssbond_header_rec</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">ssbond_dict</span><span class="p">:</span> <span class="nb">dict</span></span><span class="return-annotation">) -> <span class="nb">list</span>:</span></span>

                <label class="view-source-button" for="parse_ssbond_header_rec-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#parse_ssbond_header_rec"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="parse_ssbond_header_rec-1614"><a href="#parse_ssbond_header_rec-1614"><span class="linenos">1614</span></a><span class="k">def</span> <span class="nf">parse_ssbond_header_rec</span><span class="p">(</span><span class="n">ssbond_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="parse_ssbond_header_rec-1615"><a href="#parse_ssbond_header_rec-1615"><span class="linenos">1615</span></a>    <span class="sd">&#39;&#39;&#39;</span>
</span><span id="parse_ssbond_header_rec-1616"><a href="#parse_ssbond_header_rec-1616"><span class="linenos">1616</span></a><span class="sd">    Parse the SSBOND dict returned by parse_pdb_header. </span>
</span><span id="parse_ssbond_header_rec-1617"><a href="#parse_ssbond_header_rec-1617"><span class="linenos">1617</span></a><span class="sd">    NB: Requires EGS-Modified BIO.parse_pdb_header.py.</span>
</span><span id="parse_ssbond_header_rec-1618"><a href="#parse_ssbond_header_rec-1618"><span class="linenos">1618</span></a><span class="sd">    This is used internally.</span>
</span><span id="parse_ssbond_header_rec-1619"><a href="#parse_ssbond_header_rec-1619"><span class="linenos">1619</span></a>
</span><span id="parse_ssbond_header_rec-1620"><a href="#parse_ssbond_header_rec-1620"><span class="linenos">1620</span></a><span class="sd">    :param ssbond_dict: the input SSBOND dict</span>
</span><span id="parse_ssbond_header_rec-1621"><a href="#parse_ssbond_header_rec-1621"><span class="linenos">1621</span></a><span class="sd">    :return: A list of tuples representing the proximal, </span>
</span><span id="parse_ssbond_header_rec-1622"><a href="#parse_ssbond_header_rec-1622"><span class="linenos">1622</span></a><span class="sd">        distal residue ids for the Disulfide.</span>
</span><span id="parse_ssbond_header_rec-1623"><a href="#parse_ssbond_header_rec-1623"><span class="linenos">1623</span></a><span class="sd">        </span>
</span><span id="parse_ssbond_header_rec-1624"><a href="#parse_ssbond_header_rec-1624"><span class="linenos">1624</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="parse_ssbond_header_rec-1625"><a href="#parse_ssbond_header_rec-1625"><span class="linenos">1625</span></a>    <span class="n">disulfide_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="parse_ssbond_header_rec-1626"><a href="#parse_ssbond_header_rec-1626"><span class="linenos">1626</span></a>    <span class="k">for</span> <span class="n">ssb</span> <span class="ow">in</span> <span class="n">ssbond_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="parse_ssbond_header_rec-1627"><a href="#parse_ssbond_header_rec-1627"><span class="linenos">1627</span></a>        <span class="n">disulfide_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ssb</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="parse_ssbond_header_rec-1628"><a href="#parse_ssbond_header_rec-1628"><span class="linenos">1628</span></a>
</span><span id="parse_ssbond_header_rec-1629"><a href="#parse_ssbond_header_rec-1629"><span class="linenos">1629</span></a>    <span class="k">return</span> <span class="n">disulfide_list</span>
</span></pre></div>


            <div class="docstring"><p>Parse the SSBOND dict returned by parse_pdb_header. 
NB: Requires EGS-Modified BIO.parse_pdb_header.py.
This is used internally.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>ssbond_dict</strong>:  the input SSBOND dict</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A list of tuples representing the proximal, 
      distal residue ids for the Disulfide.</p>
</blockquote>
</div>


                </section>
                <section id="Download_Disulfides">
                            <input id="Download_Disulfides-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">Download_Disulfides</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">pdb_home</span><span class="o">=</span><span class="s1">&#39;/Users/egs/PDB/&#39;</span>,</span><span class="param">	<span class="n">model_home</span><span class="o">=</span><span class="s1">&#39;/Users/egs/PDB/good/&#39;</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">reset</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Download_Disulfides-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Download_Disulfides"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Download_Disulfides-1638"><a href="#Download_Disulfides-1638"><span class="linenos">1638</span></a><span class="k">def</span> <span class="nf">Download_Disulfides</span><span class="p">(</span><span class="n">pdb_home</span><span class="o">=</span><span class="n">PDB_DIR</span><span class="p">,</span> <span class="n">model_home</span><span class="o">=</span><span class="n">MODEL_DIR</span><span class="p">,</span> 
</span><span id="Download_Disulfides-1639"><a href="#Download_Disulfides-1639"><span class="linenos">1639</span></a>                       <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Download_Disulfides-1640"><a href="#Download_Disulfides-1640"><span class="linenos">1640</span></a>    <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Download_Disulfides-1641"><a href="#Download_Disulfides-1641"><span class="linenos">1641</span></a><span class="sd">    Reads a comma separated list of PDB IDs and downloads them</span>
</span><span id="Download_Disulfides-1642"><a href="#Download_Disulfides-1642"><span class="linenos">1642</span></a><span class="sd">    to the pdb_home path. </span>
</span><span id="Download_Disulfides-1643"><a href="#Download_Disulfides-1643"><span class="linenos">1643</span></a>
</span><span id="Download_Disulfides-1644"><a href="#Download_Disulfides-1644"><span class="linenos">1644</span></a><span class="sd">    This utility function is used to download proteins containing at least </span>
</span><span id="Download_Disulfides-1645"><a href="#Download_Disulfides-1645"><span class="linenos">1645</span></a><span class="sd">    one SS bond with the ID list generated from: http://www.rcsb.org/.</span>
</span><span id="Download_Disulfides-1646"><a href="#Download_Disulfides-1646"><span class="linenos">1646</span></a>
</span><span id="Download_Disulfides-1647"><a href="#Download_Disulfides-1647"><span class="linenos">1647</span></a><span class="sd">    This is the primary data loader for the proteusPy Disulfide </span>
</span><span id="Download_Disulfides-1648"><a href="#Download_Disulfides-1648"><span class="linenos">1648</span></a><span class="sd">    analysis package. The list of IDs represents files in the </span>
</span><span id="Download_Disulfides-1649"><a href="#Download_Disulfides-1649"><span class="linenos">1649</span></a><span class="sd">    RCSB containing &gt; 1 disulfide bond, and it contains</span>
</span><span id="Download_Disulfides-1650"><a href="#Download_Disulfides-1650"><span class="linenos">1650</span></a><span class="sd">    over 39000 structures. The total download takes about 12 hours. The</span>
</span><span id="Download_Disulfides-1651"><a href="#Download_Disulfides-1651"><span class="linenos">1651</span></a><span class="sd">    function keeps track of downloaded files so it&#39;s possible to interrupt and</span>
</span><span id="Download_Disulfides-1652"><a href="#Download_Disulfides-1652"><span class="linenos">1652</span></a><span class="sd">    restart the download without duplicating effort.</span>
</span><span id="Download_Disulfides-1653"><a href="#Download_Disulfides-1653"><span class="linenos">1653</span></a>
</span><span id="Download_Disulfides-1654"><a href="#Download_Disulfides-1654"><span class="linenos">1654</span></a><span class="sd">    :param pdb_home: Path for downloaded files, defaults to PDB_DIR</span>
</span><span id="Download_Disulfides-1655"><a href="#Download_Disulfides-1655"><span class="linenos">1655</span></a><span class="sd">    :param model_home: Path for extracted data, defaults to MODEL_DIR</span>
</span><span id="Download_Disulfides-1656"><a href="#Download_Disulfides-1656"><span class="linenos">1656</span></a><span class="sd">    :param verbose: Verbosity, defaults to False</span>
</span><span id="Download_Disulfides-1657"><a href="#Download_Disulfides-1657"><span class="linenos">1657</span></a><span class="sd">    :param reset: Reset the downloaded files index. Used to restart the download.</span>
</span><span id="Download_Disulfides-1658"><a href="#Download_Disulfides-1658"><span class="linenos">1658</span></a><span class="sd">    :raises DisulfideIOException: I/O error raised when the PDB file is not found.</span>
</span><span id="Download_Disulfides-1659"><a href="#Download_Disulfides-1659"><span class="linenos">1659</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="Download_Disulfides-1660"><a href="#Download_Disulfides-1660"><span class="linenos">1660</span></a>    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Download_Disulfides-1661"><a href="#Download_Disulfides-1661"><span class="linenos">1661</span></a>    <span class="n">donelines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Download_Disulfides-1662"><a href="#Download_Disulfides-1662"><span class="linenos">1662</span></a>    <span class="n">SS_done</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Download_Disulfides-1663"><a href="#Download_Disulfides-1663"><span class="linenos">1663</span></a>    <span class="n">ssfile</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Download_Disulfides-1664"><a href="#Download_Disulfides-1664"><span class="linenos">1664</span></a>    
</span><span id="Download_Disulfides-1665"><a href="#Download_Disulfides-1665"><span class="linenos">1665</span></a>    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</span><span id="Download_Disulfides-1666"><a href="#Download_Disulfides-1666"><span class="linenos">1666</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">pdb_home</span><span class="p">)</span>
</span><span id="Download_Disulfides-1667"><a href="#Download_Disulfides-1667"><span class="linenos">1667</span></a>
</span><span id="Download_Disulfides-1668"><a href="#Download_Disulfides-1668"><span class="linenos">1668</span></a>    <span class="n">pdblist</span> <span class="o">=</span> <span class="n">PDBList</span><span class="p">(</span><span class="n">pdb</span><span class="o">=</span><span class="n">pdb_home</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="Download_Disulfides-1669"><a href="#Download_Disulfides-1669"><span class="linenos">1669</span></a>    <span class="n">ssfilename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_home</span><span class="si">}{</span><span class="n">SS_ID_FILE</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Download_Disulfides-1670"><a href="#Download_Disulfides-1670"><span class="linenos">1670</span></a>    <span class="nb">print</span><span class="p">(</span><span class="n">ssfilename</span><span class="p">)</span>
</span><span id="Download_Disulfides-1671"><a href="#Download_Disulfides-1671"><span class="linenos">1671</span></a>    
</span><span id="Download_Disulfides-1672"><a href="#Download_Disulfides-1672"><span class="linenos">1672</span></a>    <span class="c1"># list of IDs containing &gt;1 SSBond record</span>
</span><span id="Download_Disulfides-1673"><a href="#Download_Disulfides-1673"><span class="linenos">1673</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="Download_Disulfides-1674"><a href="#Download_Disulfides-1674"><span class="linenos">1674</span></a>        <span class="n">ssfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">ssfilename</span><span class="p">)</span>
</span><span id="Download_Disulfides-1675"><a href="#Download_Disulfides-1675"><span class="linenos">1675</span></a>        <span class="n">Line</span> <span class="o">=</span> <span class="n">ssfile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="Download_Disulfides-1676"><a href="#Download_Disulfides-1676"><span class="linenos">1676</span></a>    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="Download_Disulfides-1677"><a href="#Download_Disulfides-1677"><span class="linenos">1677</span></a>        <span class="k">raise</span> <span class="n">DisulfideIOException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot open file: </span><span class="si">{</span><span class="n">ssfile</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Download_Disulfides-1678"><a href="#Download_Disulfides-1678"><span class="linenos">1678</span></a>
</span><span id="Download_Disulfides-1679"><a href="#Download_Disulfides-1679"><span class="linenos">1679</span></a>    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="Download_Disulfides-1680"><a href="#Download_Disulfides-1680"><span class="linenos">1680</span></a>        <span class="n">entries</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span><span id="Download_Disulfides-1681"><a href="#Download_Disulfides-1681"><span class="linenos">1681</span></a>
</span><span id="Download_Disulfides-1682"><a href="#Download_Disulfides-1682"><span class="linenos">1682</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Found: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span><span class="si">}</span><span class="s1"> entries&#39;</span><span class="p">)</span>
</span><span id="Download_Disulfides-1683"><a href="#Download_Disulfides-1683"><span class="linenos">1683</span></a>    <span class="n">completed</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xxx&#39;</span><span class="p">}</span> <span class="c1"># set to keep track of downloaded</span>
</span><span id="Download_Disulfides-1684"><a href="#Download_Disulfides-1684"><span class="linenos">1684</span></a>
</span><span id="Download_Disulfides-1685"><a href="#Download_Disulfides-1685"><span class="linenos">1685</span></a>    <span class="c1"># file to track already downloaded entries.</span>
</span><span id="Download_Disulfides-1686"><a href="#Download_Disulfides-1686"><span class="linenos">1686</span></a>    <span class="k">if</span> <span class="n">reset</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
</span><span id="Download_Disulfides-1687"><a href="#Download_Disulfides-1687"><span class="linenos">1687</span></a>        <span class="n">completed_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_home</span><span class="si">}</span><span class="s1">ss_completed.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="Download_Disulfides-1688"><a href="#Download_Disulfides-1688"><span class="linenos">1688</span></a>        <span class="n">donelines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Download_Disulfides-1689"><a href="#Download_Disulfides-1689"><span class="linenos">1689</span></a>        <span class="n">SS_DONE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Download_Disulfides-1690"><a href="#Download_Disulfides-1690"><span class="linenos">1690</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Download_Disulfides-1691"><a href="#Download_Disulfides-1691"><span class="linenos">1691</span></a>        <span class="n">completed_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_home</span><span class="si">}</span><span class="s1">ss_completed.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w+&#39;</span><span class="p">)</span>
</span><span id="Download_Disulfides-1692"><a href="#Download_Disulfides-1692"><span class="linenos">1692</span></a>        <span class="n">donelines</span> <span class="o">=</span> <span class="n">completed_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="Download_Disulfides-1693"><a href="#Download_Disulfides-1693"><span class="linenos">1693</span></a>
</span><span id="Download_Disulfides-1694"><a href="#Download_Disulfides-1694"><span class="linenos">1694</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">donelines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Download_Disulfides-1695"><a href="#Download_Disulfides-1695"><span class="linenos">1695</span></a>        <span class="k">for</span> <span class="n">dl</span> <span class="ow">in</span> <span class="n">donelines</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="Download_Disulfides-1696"><a href="#Download_Disulfides-1696"><span class="linenos">1696</span></a>            <span class="c1"># create a list of pdb id already downloaded</span>
</span><span id="Download_Disulfides-1697"><a href="#Download_Disulfides-1697"><span class="linenos">1697</span></a>            <span class="n">SS_done</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</span><span id="Download_Disulfides-1698"><a href="#Download_Disulfides-1698"><span class="linenos">1698</span></a>
</span><span id="Download_Disulfides-1699"><a href="#Download_Disulfides-1699"><span class="linenos">1699</span></a>    <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">SS_done</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Download_Disulfides-1700"><a href="#Download_Disulfides-1700"><span class="linenos">1700</span></a>    <span class="n">completed</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">SS_done</span><span class="p">)</span> <span class="c1"># update the completed set with what&#39;s downloaded</span>
</span><span id="Download_Disulfides-1701"><a href="#Download_Disulfides-1701"><span class="linenos">1701</span></a>
</span><span id="Download_Disulfides-1702"><a href="#Download_Disulfides-1702"><span class="linenos">1702</span></a>    <span class="c1"># Loop over all entries, </span>
</span><span id="Download_Disulfides-1703"><a href="#Download_Disulfides-1703"><span class="linenos">1703</span></a>    <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">PBAR_COLS</span><span class="p">)</span>
</span><span id="Download_Disulfides-1704"><a href="#Download_Disulfides-1704"><span class="linenos">1704</span></a>    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">pbar</span><span class="p">:</span>
</span><span id="Download_Disulfides-1705"><a href="#Download_Disulfides-1705"><span class="linenos">1705</span></a>        <span class="n">pbar</span><span class="o">.</span><span class="n">set_postfix</span><span class="p">({</span><span class="s1">&#39;Entry&#39;</span><span class="p">:</span> <span class="n">entry</span><span class="p">})</span>
</span><span id="Download_Disulfides-1706"><a href="#Download_Disulfides-1706"><span class="linenos">1706</span></a>        <span class="k">if</span> <span class="n">entry</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">completed</span><span class="p">:</span>
</span><span id="Download_Disulfides-1707"><a href="#Download_Disulfides-1707"><span class="linenos">1707</span></a>            <span class="k">if</span> <span class="n">pdblist</span><span class="o">.</span><span class="n">retrieve_pdb_file</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s1">&#39;pdb&#39;</span><span class="p">,</span> <span class="n">pdir</span><span class="o">=</span><span class="n">pdb_home</span><span class="p">):</span>
</span><span id="Download_Disulfides-1708"><a href="#Download_Disulfides-1708"><span class="linenos">1708</span></a>                <span class="n">completed</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span><span id="Download_Disulfides-1709"><a href="#Download_Disulfides-1709"><span class="linenos">1709</span></a>                <span class="n">completed_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">,&#39;</span><span class="p">)</span>
</span><span id="Download_Disulfides-1710"><a href="#Download_Disulfides-1710"><span class="linenos">1710</span></a>                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Download_Disulfides-1711"><a href="#Download_Disulfides-1711"><span class="linenos">1711</span></a>
</span><span id="Download_Disulfides-1712"><a href="#Download_Disulfides-1712"><span class="linenos">1712</span></a>    <span class="n">completed_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Download_Disulfides-1713"><a href="#Download_Disulfides-1713"><span class="linenos">1713</span></a>
</span><span id="Download_Disulfides-1714"><a href="#Download_Disulfides-1714"><span class="linenos">1714</span></a>    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Download_Disulfides-1715"><a href="#Download_Disulfides-1715"><span class="linenos">1715</span></a>    <span class="n">elapsed</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>
</span><span id="Download_Disulfides-1716"><a href="#Download_Disulfides-1716"><span class="linenos">1716</span></a>
</span><span id="Download_Disulfides-1717"><a href="#Download_Disulfides-1717"><span class="linenos">1717</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Overall files processed: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Download_Disulfides-1718"><a href="#Download_Disulfides-1718"><span class="linenos">1718</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Complete. Elapsed time: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed</span><span class="p">)</span><span class="si">}</span><span class="s1"> (h:m:s)&#39;</span><span class="p">)</span>
</span><span id="Download_Disulfides-1719"><a href="#Download_Disulfides-1719"><span class="linenos">1719</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
</span><span id="Download_Disulfides-1720"><a href="#Download_Disulfides-1720"><span class="linenos">1720</span></a>    <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>Reads a comma separated list of PDB IDs and downloads them
to the pdb_home path. </p>

<p>This utility function is used to download proteins containing at least 
one SS bond with the ID list generated from: <a href="http://www.rcsb.org/">http://www.rcsb.org/</a>.</p>

<p>This is the primary data loader for the proteusPy Disulfide 
analysis package. The list of IDs represents files in the 
RCSB containing &gt; 1 disulfide bond, and it contains
over 39000 structures. The total download takes about 12 hours. The
function keeps track of downloaded files so it's possible to interrupt and
restart the download without duplicating effort.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>pdb_home</strong>:  Path for downloaded files, defaults to PDB_DIR</li>
<li><strong>model_home</strong>:  Path for extracted data, defaults to MODEL_DIR</li>
<li><strong>verbose</strong>:  Verbosity, defaults to False</li>
<li><strong>reset</strong>:  Reset the downloaded files index. Used to restart the download.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>DisulfideIOException</strong>:  I/O error raised when the PDB file is not found.</li>
</ul>
</div>


                </section>
                <section id="Extract_Disulfides">
                            <input id="Extract_Disulfides-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">Extract_Disulfides</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">numb</span><span class="o">=-</span><span class="mi">1</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">quiet</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">pdbdir</span><span class="o">=</span><span class="s1">&#39;/Users/egs/PDB/&#39;</span>,</span><span class="param">	<span class="n">datadir</span><span class="o">=</span><span class="s1">&#39;/Users/egs/PDB/good/&#39;</span>,</span><span class="param">	<span class="n">picklefile</span><span class="o">=</span><span class="s1">&#39;PDB_all_ss.pkl&#39;</span>,</span><span class="param">	<span class="n">torsionfile</span><span class="o">=</span><span class="s1">&#39;PDB_all_SS_torsions.csv&#39;</span>,</span><span class="param">	<span class="n">problemfile</span><span class="o">=</span><span class="s1">&#39;PDB_all_SS_problems.csv&#39;</span>,</span><span class="param">	<span class="n">dictfile</span><span class="o">=</span><span class="s1">&#39;PDB_all_ss_dict.pkl&#39;</span>,</span><span class="param">	<span class="n">dist_cutoff</span><span class="o">=-</span><span class="mf">1.0</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Extract_Disulfides-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Extract_Disulfides"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Extract_Disulfides-1722"><a href="#Extract_Disulfides-1722"><span class="linenos">1722</span></a><span class="k">def</span> <span class="nf">Extract_Disulfides</span><span class="p">(</span><span class="n">numb</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pdbdir</span><span class="o">=</span><span class="n">PDB_DIR</span><span class="p">,</span> 
</span><span id="Extract_Disulfides-1723"><a href="#Extract_Disulfides-1723"><span class="linenos">1723</span></a>                        <span class="n">datadir</span><span class="o">=</span><span class="n">MODEL_DIR</span><span class="p">,</span> <span class="n">picklefile</span><span class="o">=</span><span class="n">SS_PICKLE_FILE</span><span class="p">,</span>
</span><span id="Extract_Disulfides-1724"><a href="#Extract_Disulfides-1724"><span class="linenos">1724</span></a>                        <span class="n">torsionfile</span><span class="o">=</span><span class="n">SS_TORSIONS_FILE</span><span class="p">,</span> 
</span><span id="Extract_Disulfides-1725"><a href="#Extract_Disulfides-1725"><span class="linenos">1725</span></a>                        <span class="n">problemfile</span><span class="o">=</span><span class="n">PROBLEM_ID_FILE</span><span class="p">,</span>
</span><span id="Extract_Disulfides-1726"><a href="#Extract_Disulfides-1726"><span class="linenos">1726</span></a>                        <span class="n">dictfile</span><span class="o">=</span><span class="n">SS_DICT_PICKLE_FILE</span><span class="p">,</span>
</span><span id="Extract_Disulfides-1727"><a href="#Extract_Disulfides-1727"><span class="linenos">1727</span></a>                        <span class="n">dist_cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Extract_Disulfides-1728"><a href="#Extract_Disulfides-1728"><span class="linenos">1728</span></a>    <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Extract_Disulfides-1729"><a href="#Extract_Disulfides-1729"><span class="linenos">1729</span></a><span class="sd">    This function creates .pkl files needed for the </span>
</span><span id="Extract_Disulfides-1730"><a href="#Extract_Disulfides-1730"><span class="linenos">1730</span></a><span class="sd">    proteusPy.DisulfideLoader.DisulfideLoader class. </span>
</span><span id="Extract_Disulfides-1731"><a href="#Extract_Disulfides-1731"><span class="linenos">1731</span></a><span class="sd">    The ```Disulfide``` objects are contained in a ```DisulfideList``` object and </span>
</span><span id="Extract_Disulfides-1732"><a href="#Extract_Disulfides-1732"><span class="linenos">1732</span></a><span class="sd">    ```Dict``` within these files. In addition, .csv files containing all of </span>
</span><span id="Extract_Disulfides-1733"><a href="#Extract_Disulfides-1733"><span class="linenos">1733</span></a><span class="sd">    the torsions for the disulfides and problem IDs are written. The optional</span>
</span><span id="Extract_Disulfides-1734"><a href="#Extract_Disulfides-1734"><span class="linenos">1734</span></a><span class="sd">    ```dist_cutoff``` allows for removal of Disufides whose Cα-Cα distance is &gt;</span>
</span><span id="Extract_Disulfides-1735"><a href="#Extract_Disulfides-1735"><span class="linenos">1735</span></a><span class="sd">    than the cutoff value. If it&#39;s -1.0 then the function keeps all Disulfides.</span>
</span><span id="Extract_Disulfides-1736"><a href="#Extract_Disulfides-1736"><span class="linenos">1736</span></a>
</span><span id="Extract_Disulfides-1737"><a href="#Extract_Disulfides-1737"><span class="linenos">1737</span></a><span class="sd">    :param numb:           number of entries to process, defaults to all</span>
</span><span id="Extract_Disulfides-1738"><a href="#Extract_Disulfides-1738"><span class="linenos">1738</span></a><span class="sd">    :param verbose:        more messages</span>
</span><span id="Extract_Disulfides-1739"><a href="#Extract_Disulfides-1739"><span class="linenos">1739</span></a><span class="sd">    :param quiet:          turns off DisulfideConstruction warnings</span>
</span><span id="Extract_Disulfides-1740"><a href="#Extract_Disulfides-1740"><span class="linenos">1740</span></a><span class="sd">    :param pdbdir:         path to PDB files</span>
</span><span id="Extract_Disulfides-1741"><a href="#Extract_Disulfides-1741"><span class="linenos">1741</span></a><span class="sd">    :param datadir:        path to resulting .pkl files</span>
</span><span id="Extract_Disulfides-1742"><a href="#Extract_Disulfides-1742"><span class="linenos">1742</span></a><span class="sd">    :param picklefile:     name of the disulfide .pkl file</span>
</span><span id="Extract_Disulfides-1743"><a href="#Extract_Disulfides-1743"><span class="linenos">1743</span></a><span class="sd">    :param torsionfile:    name of the disulfide torsion file .csv created</span>
</span><span id="Extract_Disulfides-1744"><a href="#Extract_Disulfides-1744"><span class="linenos">1744</span></a><span class="sd">    :param problemfile:    name of the .csv file containing problem ids</span>
</span><span id="Extract_Disulfides-1745"><a href="#Extract_Disulfides-1745"><span class="linenos">1745</span></a><span class="sd">    :param dictfile:       name of the .pkl file</span>
</span><span id="Extract_Disulfides-1746"><a href="#Extract_Disulfides-1746"><span class="linenos">1746</span></a><span class="sd">    :param dist_cutoff:    Ca distance cutoff to reject a Disulfide.</span>
</span><span id="Extract_Disulfides-1747"><a href="#Extract_Disulfides-1747"><span class="linenos">1747</span></a><span class="sd">    </span>
</span><span id="Extract_Disulfides-1748"><a href="#Extract_Disulfides-1748"><span class="linenos">1748</span></a><span class="sd">    The following examples illustrate some basic functions of the disulfide classes:</span>
</span><span id="Extract_Disulfides-1749"><a href="#Extract_Disulfides-1749"><span class="linenos">1749</span></a>
</span><span id="Extract_Disulfides-1750"><a href="#Extract_Disulfides-1750"><span class="linenos">1750</span></a><span class="sd">    &gt;&gt;&gt; from proteusPy.Disulfide import Disulfide </span>
</span><span id="Extract_Disulfides-1751"><a href="#Extract_Disulfides-1751"><span class="linenos">1751</span></a><span class="sd">    &gt;&gt;&gt; from proteusPy.DisulfideLoader import DisulfideLoader</span>
</span><span id="Extract_Disulfides-1752"><a href="#Extract_Disulfides-1752"><span class="linenos">1752</span></a><span class="sd">    &gt;&gt;&gt; from proteusPy.DisulfideList import DisulfideList</span>
</span><span id="Extract_Disulfides-1753"><a href="#Extract_Disulfides-1753"><span class="linenos">1753</span></a><span class="sd">        </span>
</span><span id="Extract_Disulfides-1754"><a href="#Extract_Disulfides-1754"><span class="linenos">1754</span></a><span class="sd">    Instantiate some variables. Note: the list is initialized with an iterable and a name (optional)</span>
</span><span id="Extract_Disulfides-1755"><a href="#Extract_Disulfides-1755"><span class="linenos">1755</span></a>
</span><span id="Extract_Disulfides-1756"><a href="#Extract_Disulfides-1756"><span class="linenos">1756</span></a><span class="sd">    &gt;&gt;&gt; SS = Disulfide(&#39;tmp&#39;)</span>
</span><span id="Extract_Disulfides-1757"><a href="#Extract_Disulfides-1757"><span class="linenos">1757</span></a><span class="sd">    &gt;&gt;&gt; SSlist = DisulfideList([],&#39;ss&#39;)</span>
</span><span id="Extract_Disulfides-1758"><a href="#Extract_Disulfides-1758"><span class="linenos">1758</span></a><span class="sd">    </span>
</span><span id="Extract_Disulfides-1759"><a href="#Extract_Disulfides-1759"><span class="linenos">1759</span></a><span class="sd">    Load the Disulfide subset database. This contains around 8300 disulfides and loads</span>
</span><span id="Extract_Disulfides-1760"><a href="#Extract_Disulfides-1760"><span class="linenos">1760</span></a><span class="sd">    fairly quickly.</span>
</span><span id="Extract_Disulfides-1761"><a href="#Extract_Disulfides-1761"><span class="linenos">1761</span></a>
</span><span id="Extract_Disulfides-1762"><a href="#Extract_Disulfides-1762"><span class="linenos">1762</span></a><span class="sd">    &gt;&gt;&gt; PDB_SS = DisulfideLoader(verbose=False, subset=True)</span>
</span><span id="Extract_Disulfides-1763"><a href="#Extract_Disulfides-1763"><span class="linenos">1763</span></a>
</span><span id="Extract_Disulfides-1764"><a href="#Extract_Disulfides-1764"><span class="linenos">1764</span></a><span class="sd">    The dataset can be indexed numerically, up to index: PDB_SS.Length(). Get the first SS:</span>
</span><span id="Extract_Disulfides-1765"><a href="#Extract_Disulfides-1765"><span class="linenos">1765</span></a><span class="sd">    &gt;&gt;&gt; SS = PDB_SS[0]</span>
</span><span id="Extract_Disulfides-1766"><a href="#Extract_Disulfides-1766"><span class="linenos">1766</span></a><span class="sd">    &gt;&gt;&gt; SS</span>
</span><span id="Extract_Disulfides-1767"><a href="#Extract_Disulfides-1767"><span class="linenos">1767</span></a><span class="sd">    &lt;Disulfide 4yys_22A_65A, Source: 4yys, Resolution: 1.35 Å&gt;</span>
</span><span id="Extract_Disulfides-1768"><a href="#Extract_Disulfides-1768"><span class="linenos">1768</span></a>
</span><span id="Extract_Disulfides-1769"><a href="#Extract_Disulfides-1769"><span class="linenos">1769</span></a><span class="sd">    The dataset can also be indexed by PDB ID. Get the DisulfideList for ID 4yys:</span>
</span><span id="Extract_Disulfides-1770"><a href="#Extract_Disulfides-1770"><span class="linenos">1770</span></a>
</span><span id="Extract_Disulfides-1771"><a href="#Extract_Disulfides-1771"><span class="linenos">1771</span></a><span class="sd">    &gt;&gt;&gt; SS4yys = PDB_SS[&#39;4yys&#39;]</span>
</span><span id="Extract_Disulfides-1772"><a href="#Extract_Disulfides-1772"><span class="linenos">1772</span></a><span class="sd">    &gt;&gt;&gt; SS4yys</span>
</span><span id="Extract_Disulfides-1773"><a href="#Extract_Disulfides-1773"><span class="linenos">1773</span></a><span class="sd">    [&lt;Disulfide 4yys_22A_65A, Source: 4yys, Resolution: 1.35 Å&gt;, &lt;Disulfide 4yys_56A_98A, Source: 4yys, Resolution: 1.35 Å&gt;, &lt;Disulfide 4yys_156A_207A, Source: 4yys, Resolution: 1.35 Å&gt;]</span>
</span><span id="Extract_Disulfides-1774"><a href="#Extract_Disulfides-1774"><span class="linenos">1774</span></a>
</span><span id="Extract_Disulfides-1775"><a href="#Extract_Disulfides-1775"><span class="linenos">1775</span></a><span class="sd">    Make some empty disulfides:</span>
</span><span id="Extract_Disulfides-1776"><a href="#Extract_Disulfides-1776"><span class="linenos">1776</span></a>
</span><span id="Extract_Disulfides-1777"><a href="#Extract_Disulfides-1777"><span class="linenos">1777</span></a><span class="sd">    &gt;&gt;&gt; ss1 = Disulfide(&#39;ss1&#39;)</span>
</span><span id="Extract_Disulfides-1778"><a href="#Extract_Disulfides-1778"><span class="linenos">1778</span></a><span class="sd">    &gt;&gt;&gt; ss2 = Disulfide(&#39;ss2&#39;)</span>
</span><span id="Extract_Disulfides-1779"><a href="#Extract_Disulfides-1779"><span class="linenos">1779</span></a>
</span><span id="Extract_Disulfides-1780"><a href="#Extract_Disulfides-1780"><span class="linenos">1780</span></a><span class="sd">    Make a DisulfideList containing ss1, named &#39;tmp&#39;:</span>
</span><span id="Extract_Disulfides-1781"><a href="#Extract_Disulfides-1781"><span class="linenos">1781</span></a>
</span><span id="Extract_Disulfides-1782"><a href="#Extract_Disulfides-1782"><span class="linenos">1782</span></a><span class="sd">    &gt;&gt;&gt; sslist = DisulfideList([ss1], &#39;tmp&#39;)</span>
</span><span id="Extract_Disulfides-1783"><a href="#Extract_Disulfides-1783"><span class="linenos">1783</span></a>
</span><span id="Extract_Disulfides-1784"><a href="#Extract_Disulfides-1784"><span class="linenos">1784</span></a><span class="sd">    Append ss2:</span>
</span><span id="Extract_Disulfides-1785"><a href="#Extract_Disulfides-1785"><span class="linenos">1785</span></a><span class="sd">    &gt;&gt;&gt; sslist.append(ss2)</span>
</span><span id="Extract_Disulfides-1786"><a href="#Extract_Disulfides-1786"><span class="linenos">1786</span></a>
</span><span id="Extract_Disulfides-1787"><a href="#Extract_Disulfides-1787"><span class="linenos">1787</span></a><span class="sd">    Extract the first disulfide and print it:</span>
</span><span id="Extract_Disulfides-1788"><a href="#Extract_Disulfides-1788"><span class="linenos">1788</span></a>
</span><span id="Extract_Disulfides-1789"><a href="#Extract_Disulfides-1789"><span class="linenos">1789</span></a><span class="sd">    &gt;&gt;&gt; ss1 = PDB_SS[0]</span>
</span><span id="Extract_Disulfides-1790"><a href="#Extract_Disulfides-1790"><span class="linenos">1790</span></a><span class="sd">    &gt;&gt;&gt; ss1.pprint_all()</span>
</span><span id="Extract_Disulfides-1791"><a href="#Extract_Disulfides-1791"><span class="linenos">1791</span></a><span class="sd">    &lt;Disulfide 4yys_22A_65A, Source: 4yys, Resolution: 1.35 Å</span>
</span><span id="Extract_Disulfides-1792"><a href="#Extract_Disulfides-1792"><span class="linenos">1792</span></a><span class="sd">     Proximal Chain fullID: &lt;(&#39;4yys&#39;, 0, &#39;A&#39;, (&#39; &#39;, 22, &#39; &#39;))&gt; Distal Chain fullID: &lt;(&#39;4yys&#39;, 0, &#39;A&#39;, (&#39; &#39;, 65, &#39; &#39;))&gt; </span>
</span><span id="Extract_Disulfides-1793"><a href="#Extract_Disulfides-1793"><span class="linenos">1793</span></a><span class="sd">    Proximal Coordinates:</span>
</span><span id="Extract_Disulfides-1794"><a href="#Extract_Disulfides-1794"><span class="linenos">1794</span></a><span class="sd">       N: &lt;Vector -2.36, -20.48, 5.21&gt;</span>
</span><span id="Extract_Disulfides-1795"><a href="#Extract_Disulfides-1795"><span class="linenos">1795</span></a><span class="sd">       Cα: &lt;Vector -2.10, -19.89, 3.90&gt;</span>
</span><span id="Extract_Disulfides-1796"><a href="#Extract_Disulfides-1796"><span class="linenos">1796</span></a><span class="sd">       C: &lt;Vector -1.12, -18.78, 4.12&gt;</span>
</span><span id="Extract_Disulfides-1797"><a href="#Extract_Disulfides-1797"><span class="linenos">1797</span></a><span class="sd">       O: &lt;Vector -1.30, -17.96, 5.03&gt;</span>
</span><span id="Extract_Disulfides-1798"><a href="#Extract_Disulfides-1798"><span class="linenos">1798</span></a><span class="sd">       Cβ: &lt;Vector -3.38, -19.31, 3.32&gt;</span>
</span><span id="Extract_Disulfides-1799"><a href="#Extract_Disulfides-1799"><span class="linenos">1799</span></a><span class="sd">       Sγ: &lt;Vector -3.24, -18.40, 1.76&gt;</span>
</span><span id="Extract_Disulfides-1800"><a href="#Extract_Disulfides-1800"><span class="linenos">1800</span></a><span class="sd">       Cprev &lt;Vector -2.67, -21.75, 5.36&gt;</span>
</span><span id="Extract_Disulfides-1801"><a href="#Extract_Disulfides-1801"><span class="linenos">1801</span></a><span class="sd">       Nnext: &lt;Vector -0.02, -18.76, 3.36&gt;</span>
</span><span id="Extract_Disulfides-1802"><a href="#Extract_Disulfides-1802"><span class="linenos">1802</span></a><span class="sd">     Distal Coordinates:</span>
</span><span id="Extract_Disulfides-1803"><a href="#Extract_Disulfides-1803"><span class="linenos">1803</span></a><span class="sd">       N: &lt;Vector -0.60, -18.71, -1.62&gt;</span>
</span><span id="Extract_Disulfides-1804"><a href="#Extract_Disulfides-1804"><span class="linenos">1804</span></a><span class="sd">       Cα: &lt;Vector -0.48, -19.10, -0.22&gt;</span>
</span><span id="Extract_Disulfides-1805"><a href="#Extract_Disulfides-1805"><span class="linenos">1805</span></a><span class="sd">       C: &lt;Vector 0.92, -19.52, 0.18&gt;</span>
</span><span id="Extract_Disulfides-1806"><a href="#Extract_Disulfides-1806"><span class="linenos">1806</span></a><span class="sd">       O: &lt;Vector 1.10, -20.09, 1.25&gt;</span>
</span><span id="Extract_Disulfides-1807"><a href="#Extract_Disulfides-1807"><span class="linenos">1807</span></a><span class="sd">       Cβ: &lt;Vector -1.48, -20.23, 0.08&gt;</span>
</span><span id="Extract_Disulfides-1808"><a href="#Extract_Disulfides-1808"><span class="linenos">1808</span></a><span class="sd">       Sγ: &lt;Vector -3.22, -19.69, 0.18&gt;</span>
</span><span id="Extract_Disulfides-1809"><a href="#Extract_Disulfides-1809"><span class="linenos">1809</span></a><span class="sd">       Cprev &lt;Vector -0.73, -17.44, -2.01&gt;</span>
</span><span id="Extract_Disulfides-1810"><a href="#Extract_Disulfides-1810"><span class="linenos">1810</span></a><span class="sd">       Nnext: &lt;Vector 1.92, -19.18, -0.63&gt;</span>
</span><span id="Extract_Disulfides-1811"><a href="#Extract_Disulfides-1811"><span class="linenos">1811</span></a><span class="sd">    &lt;BLANKLINE&gt;</span>
</span><span id="Extract_Disulfides-1812"><a href="#Extract_Disulfides-1812"><span class="linenos">1812</span></a><span class="sd">     Proximal Internal Coords:</span>
</span><span id="Extract_Disulfides-1813"><a href="#Extract_Disulfides-1813"><span class="linenos">1813</span></a><span class="sd">       N: &lt;Vector -0.41, 1.40, -0.00&gt;</span>
</span><span id="Extract_Disulfides-1814"><a href="#Extract_Disulfides-1814"><span class="linenos">1814</span></a><span class="sd">       Cα: &lt;Vector 0.00, 0.00, 0.00&gt;</span>
</span><span id="Extract_Disulfides-1815"><a href="#Extract_Disulfides-1815"><span class="linenos">1815</span></a><span class="sd">       C: &lt;Vector 1.50, 0.00, 0.00&gt;</span>
</span><span id="Extract_Disulfides-1816"><a href="#Extract_Disulfides-1816"><span class="linenos">1816</span></a><span class="sd">       O: &lt;Vector 2.12, 0.71, -0.80&gt;</span>
</span><span id="Extract_Disulfides-1817"><a href="#Extract_Disulfides-1817"><span class="linenos">1817</span></a><span class="sd">       Cβ: &lt;Vector -0.50, -0.70, -1.25&gt;</span>
</span><span id="Extract_Disulfides-1818"><a href="#Extract_Disulfides-1818"><span class="linenos">1818</span></a><span class="sd">       Sγ: &lt;Vector 0.04, -2.41, -1.50&gt;</span>
</span><span id="Extract_Disulfides-1819"><a href="#Extract_Disulfides-1819"><span class="linenos">1819</span></a><span class="sd">       Cprev &lt;Vector -2.67, -21.75, 5.36&gt;</span>
</span><span id="Extract_Disulfides-1820"><a href="#Extract_Disulfides-1820"><span class="linenos">1820</span></a><span class="sd">       Nnext: &lt;Vector -0.02, -18.76, 3.36&gt;</span>
</span><span id="Extract_Disulfides-1821"><a href="#Extract_Disulfides-1821"><span class="linenos">1821</span></a><span class="sd">    Distal Internal Coords:</span>
</span><span id="Extract_Disulfides-1822"><a href="#Extract_Disulfides-1822"><span class="linenos">1822</span></a><span class="sd">       N: &lt;Vector 1.04, -5.63, 1.17&gt;</span>
</span><span id="Extract_Disulfides-1823"><a href="#Extract_Disulfides-1823"><span class="linenos">1823</span></a><span class="sd">       Cα: &lt;Vector 1.04, -4.18, 1.31&gt;</span>
</span><span id="Extract_Disulfides-1824"><a href="#Extract_Disulfides-1824"><span class="linenos">1824</span></a><span class="sd">       C: &lt;Vector 1.72, -3.68, 2.57&gt;</span>
</span><span id="Extract_Disulfides-1825"><a href="#Extract_Disulfides-1825"><span class="linenos">1825</span></a><span class="sd">       O: &lt;Vector 1.57, -2.51, 2.92&gt;</span>
</span><span id="Extract_Disulfides-1826"><a href="#Extract_Disulfides-1826"><span class="linenos">1826</span></a><span class="sd">       Cβ: &lt;Vector -0.41, -3.66, 1.24&gt;</span>
</span><span id="Extract_Disulfides-1827"><a href="#Extract_Disulfides-1827"><span class="linenos">1827</span></a><span class="sd">       Sγ: &lt;Vector -1.14, -3.69, -0.43&gt;</span>
</span><span id="Extract_Disulfides-1828"><a href="#Extract_Disulfides-1828"><span class="linenos">1828</span></a><span class="sd">       Cprev &lt;Vector -0.73, -17.44, -2.01&gt;</span>
</span><span id="Extract_Disulfides-1829"><a href="#Extract_Disulfides-1829"><span class="linenos">1829</span></a><span class="sd">       Nnext: &lt;Vector 1.92, -19.18, -0.63&gt;</span>
</span><span id="Extract_Disulfides-1830"><a href="#Extract_Disulfides-1830"><span class="linenos">1830</span></a><span class="sd">     Χ1-Χ5: 174.63°, 82.52°, -83.32°, -62.52° -73.83°, 1.70 kcal/mol</span>
</span><span id="Extract_Disulfides-1831"><a href="#Extract_Disulfides-1831"><span class="linenos">1831</span></a><span class="sd">     Cα Distance: 4.50 Å</span>
</span><span id="Extract_Disulfides-1832"><a href="#Extract_Disulfides-1832"><span class="linenos">1832</span></a><span class="sd">     Torsion length: 231.53 deg&gt;</span>
</span><span id="Extract_Disulfides-1833"><a href="#Extract_Disulfides-1833"><span class="linenos">1833</span></a>
</span><span id="Extract_Disulfides-1834"><a href="#Extract_Disulfides-1834"><span class="linenos">1834</span></a><span class="sd">    Get a list of disulfides via slicing and display them oriented against a common</span>
</span><span id="Extract_Disulfides-1835"><a href="#Extract_Disulfides-1835"><span class="linenos">1835</span></a><span class="sd">    reference frame (the proximal N, Cα, C&#39;).</span>
</span><span id="Extract_Disulfides-1836"><a href="#Extract_Disulfides-1836"><span class="linenos">1836</span></a>
</span><span id="Extract_Disulfides-1837"><a href="#Extract_Disulfides-1837"><span class="linenos">1837</span></a><span class="sd">    &gt;&gt;&gt; subset = DisulfideList(PDB_SS[0:10],&#39;subset&#39;)</span>
</span><span id="Extract_Disulfides-1838"><a href="#Extract_Disulfides-1838"><span class="linenos">1838</span></a><span class="sd">    &gt;&gt;&gt; subset.display_overlay()</span>
</span><span id="Extract_Disulfides-1839"><a href="#Extract_Disulfides-1839"><span class="linenos">1839</span></a>
</span><span id="Extract_Disulfides-1840"><a href="#Extract_Disulfides-1840"><span class="linenos">1840</span></a><span class="sd">    Take a screenshot. You can position the orientation, then close the window:</span>
</span><span id="Extract_Disulfides-1841"><a href="#Extract_Disulfides-1841"><span class="linenos">1841</span></a><span class="sd">    &gt;&gt;&gt; subset.screenshot(style=&#39;sb&#39;, fname=&#39;subset.png&#39;)</span>
</span><span id="Extract_Disulfides-1842"><a href="#Extract_Disulfides-1842"><span class="linenos">1842</span></a><span class="sd">    ---&gt; screenshot(): Saving file: subset.png</span>
</span><span id="Extract_Disulfides-1843"><a href="#Extract_Disulfides-1843"><span class="linenos">1843</span></a><span class="sd">    ---&gt; screenshot(): Saved file: subset.png</span>
</span><span id="Extract_Disulfides-1844"><a href="#Extract_Disulfides-1844"><span class="linenos">1844</span></a>
</span><span id="Extract_Disulfides-1845"><a href="#Extract_Disulfides-1845"><span class="linenos">1845</span></a><span class="sd">    Browse the documentation for more functionality. The display functions are particularly useful.</span>
</span><span id="Extract_Disulfides-1846"><a href="#Extract_Disulfides-1846"><span class="linenos">1846</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="Extract_Disulfides-1847"><a href="#Extract_Disulfides-1847"><span class="linenos">1847</span></a>
</span><span id="Extract_Disulfides-1848"><a href="#Extract_Disulfides-1848"><span class="linenos">1848</span></a>    <span class="k">def</span> <span class="nf">name_to_id</span><span class="p">(</span><span class="n">fname</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Extract_Disulfides-1849"><a href="#Extract_Disulfides-1849"><span class="linenos">1849</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Extract_Disulfides-1850"><a href="#Extract_Disulfides-1850"><span class="linenos">1850</span></a><span class="sd">        Returns the PDB ID from the filename.</span>
</span><span id="Extract_Disulfides-1851"><a href="#Extract_Disulfides-1851"><span class="linenos">1851</span></a>
</span><span id="Extract_Disulfides-1852"><a href="#Extract_Disulfides-1852"><span class="linenos">1852</span></a><span class="sd">        :param fname: Complete PDB filename</span>
</span><span id="Extract_Disulfides-1853"><a href="#Extract_Disulfides-1853"><span class="linenos">1853</span></a><span class="sd">        :return: PDB ID</span>
</span><span id="Extract_Disulfides-1854"><a href="#Extract_Disulfides-1854"><span class="linenos">1854</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Extract_Disulfides-1855"><a href="#Extract_Disulfides-1855"><span class="linenos">1855</span></a>        <span class="n">ent</span> <span class="o">=</span> <span class="n">fname</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Extract_Disulfides-1856"><a href="#Extract_Disulfides-1856"><span class="linenos">1856</span></a>        <span class="k">return</span> <span class="n">ent</span>
</span><span id="Extract_Disulfides-1857"><a href="#Extract_Disulfides-1857"><span class="linenos">1857</span></a>
</span><span id="Extract_Disulfides-1858"><a href="#Extract_Disulfides-1858"><span class="linenos">1858</span></a>    <span class="n">entrylist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Extract_Disulfides-1859"><a href="#Extract_Disulfides-1859"><span class="linenos">1859</span></a>    <span class="n">problem_ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Extract_Disulfides-1860"><a href="#Extract_Disulfides-1860"><span class="linenos">1860</span></a>    <span class="n">bad</span> <span class="o">=</span> <span class="n">bad_dist</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Extract_Disulfides-1861"><a href="#Extract_Disulfides-1861"><span class="linenos">1861</span></a>
</span><span id="Extract_Disulfides-1862"><a href="#Extract_Disulfides-1862"><span class="linenos">1862</span></a>    <span class="c1"># we use the specialized list class DisulfideList to contain our disulfides</span>
</span><span id="Extract_Disulfides-1863"><a href="#Extract_Disulfides-1863"><span class="linenos">1863</span></a>    <span class="c1"># we&#39;ll use a dict to store DisulfideList objects, indexed by the structure ID</span>
</span><span id="Extract_Disulfides-1864"><a href="#Extract_Disulfides-1864"><span class="linenos">1864</span></a>    <span class="n">All_ss_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Extract_Disulfides-1865"><a href="#Extract_Disulfides-1865"><span class="linenos">1865</span></a>    <span class="n">All_ss_list</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span><span class="s1">&#39;PDB_SS&#39;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1866"><a href="#Extract_Disulfides-1866"><span class="linenos">1866</span></a>    <span class="n">All_ss_dict2</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># new dict of pointers to indices</span>
</span><span id="Extract_Disulfides-1867"><a href="#Extract_Disulfides-1867"><span class="linenos">1867</span></a>
</span><span id="Extract_Disulfides-1868"><a href="#Extract_Disulfides-1868"><span class="linenos">1868</span></a>    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Extract_Disulfides-1869"><a href="#Extract_Disulfides-1869"><span class="linenos">1869</span></a>    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</span><span id="Extract_Disulfides-1870"><a href="#Extract_Disulfides-1870"><span class="linenos">1870</span></a>
</span><span id="Extract_Disulfides-1871"><a href="#Extract_Disulfides-1871"><span class="linenos">1871</span></a>    <span class="c1"># Build a list of PDB files in PDB_DIR that are readable. These files were downloaded</span>
</span><span id="Extract_Disulfides-1872"><a href="#Extract_Disulfides-1872"><span class="linenos">1872</span></a>    <span class="c1"># via the RCSB web query interface for structures containing &gt;= 1 SS Bond.</span>
</span><span id="Extract_Disulfides-1873"><a href="#Extract_Disulfides-1873"><span class="linenos">1873</span></a>
</span><span id="Extract_Disulfides-1874"><a href="#Extract_Disulfides-1874"><span class="linenos">1874</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">pdbdir</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1875"><a href="#Extract_Disulfides-1875"><span class="linenos">1875</span></a>
</span><span id="Extract_Disulfides-1876"><a href="#Extract_Disulfides-1876"><span class="linenos">1876</span></a>    <span class="n">ss_filelist</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;*.ent&#39;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1877"><a href="#Extract_Disulfides-1877"><span class="linenos">1877</span></a>    <span class="n">tot</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ss_filelist</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1878"><a href="#Extract_Disulfides-1878"><span class="linenos">1878</span></a>
</span><span id="Extract_Disulfides-1879"><a href="#Extract_Disulfides-1879"><span class="linenos">1879</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Extract_Disulfides-1880"><a href="#Extract_Disulfides-1880"><span class="linenos">1880</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PDB Directory </span><span class="si">{</span><span class="n">pdbdir</span><span class="si">}</span><span class="s1"> contains: </span><span class="si">{</span><span class="n">tot</span><span class="si">}</span><span class="s1"> files&#39;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1881"><a href="#Extract_Disulfides-1881"><span class="linenos">1881</span></a>
</span><span id="Extract_Disulfides-1882"><a href="#Extract_Disulfides-1882"><span class="linenos">1882</span></a>    <span class="c1"># the filenames are in the form pdb{entry}.ent, I loop through them and extract</span>
</span><span id="Extract_Disulfides-1883"><a href="#Extract_Disulfides-1883"><span class="linenos">1883</span></a>    <span class="c1"># the PDB ID, with Disulfide.name_to_id(), then add to entrylist.</span>
</span><span id="Extract_Disulfides-1884"><a href="#Extract_Disulfides-1884"><span class="linenos">1884</span></a>
</span><span id="Extract_Disulfides-1885"><a href="#Extract_Disulfides-1885"><span class="linenos">1885</span></a>    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">ss_filelist</span><span class="p">:</span>
</span><span id="Extract_Disulfides-1886"><a href="#Extract_Disulfides-1886"><span class="linenos">1886</span></a>        <span class="n">entrylist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name_to_id</span><span class="p">(</span><span class="n">entry</span><span class="p">))</span>
</span><span id="Extract_Disulfides-1887"><a href="#Extract_Disulfides-1887"><span class="linenos">1887</span></a>
</span><span id="Extract_Disulfides-1888"><a href="#Extract_Disulfides-1888"><span class="linenos">1888</span></a>    <span class="c1"># create a dataframe with the following columns for the disulfide conformations </span>
</span><span id="Extract_Disulfides-1889"><a href="#Extract_Disulfides-1889"><span class="linenos">1889</span></a>    <span class="c1"># extracted from the structure</span>
</span><span id="Extract_Disulfides-1890"><a href="#Extract_Disulfides-1890"><span class="linenos">1890</span></a>    
</span><span id="Extract_Disulfides-1891"><a href="#Extract_Disulfides-1891"><span class="linenos">1891</span></a>    <span class="n">SS_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">Torsion_DF_Cols</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1892"><a href="#Extract_Disulfides-1892"><span class="linenos">1892</span></a>
</span><span id="Extract_Disulfides-1893"><a href="#Extract_Disulfides-1893"><span class="linenos">1893</span></a>    <span class="c1"># define a tqdm progressbar using the fully loaded entrylist list. </span>
</span><span id="Extract_Disulfides-1894"><a href="#Extract_Disulfides-1894"><span class="linenos">1894</span></a>    <span class="c1"># If numb is passed then</span>
</span><span id="Extract_Disulfides-1895"><a href="#Extract_Disulfides-1895"><span class="linenos">1895</span></a>    <span class="c1"># only do the last numb entries.</span>
</span><span id="Extract_Disulfides-1896"><a href="#Extract_Disulfides-1896"><span class="linenos">1896</span></a>    
</span><span id="Extract_Disulfides-1897"><a href="#Extract_Disulfides-1897"><span class="linenos">1897</span></a>    <span class="k">if</span> <span class="n">numb</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Extract_Disulfides-1898"><a href="#Extract_Disulfides-1898"><span class="linenos">1898</span></a>        <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">entrylist</span><span class="p">[:</span><span class="n">numb</span><span class="p">],</span> <span class="n">ncols</span><span class="o">=</span><span class="n">PBAR_COLS</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1899"><a href="#Extract_Disulfides-1899"><span class="linenos">1899</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Extract_Disulfides-1900"><a href="#Extract_Disulfides-1900"><span class="linenos">1900</span></a>        <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">entrylist</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">PBAR_COLS</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1901"><a href="#Extract_Disulfides-1901"><span class="linenos">1901</span></a>
</span><span id="Extract_Disulfides-1902"><a href="#Extract_Disulfides-1902"><span class="linenos">1902</span></a>    <span class="n">tot</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Extract_Disulfides-1903"><a href="#Extract_Disulfides-1903"><span class="linenos">1903</span></a>    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Extract_Disulfides-1904"><a href="#Extract_Disulfides-1904"><span class="linenos">1904</span></a>    <span class="c1"># loop over ss_filelist, create disulfides and initialize them</span>
</span><span id="Extract_Disulfides-1905"><a href="#Extract_Disulfides-1905"><span class="linenos">1905</span></a>    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">pbar</span><span class="p">:</span>
</span><span id="Extract_Disulfides-1906"><a href="#Extract_Disulfides-1906"><span class="linenos">1906</span></a>        <span class="n">pbar</span><span class="o">.</span><span class="n">set_postfix</span><span class="p">({</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="n">entry</span><span class="p">,</span> <span class="s1">&#39;Bad&#39;</span><span class="p">:</span> <span class="n">bad</span><span class="p">,</span> <span class="s1">&#39;Ca&#39;</span><span class="p">:</span> <span class="n">bad_dist</span><span class="p">,</span> <span class="s1">&#39;Cnt&#39;</span><span class="p">:</span> <span class="n">tot</span><span class="p">})</span> <span class="c1"># update the progress bar</span>
</span><span id="Extract_Disulfides-1907"><a href="#Extract_Disulfides-1907"><span class="linenos">1907</span></a>
</span><span id="Extract_Disulfides-1908"><a href="#Extract_Disulfides-1908"><span class="linenos">1908</span></a>        <span class="c1"># returns an empty list if none are found.</span>
</span><span id="Extract_Disulfides-1909"><a href="#Extract_Disulfides-1909"><span class="linenos">1909</span></a>        <span class="n">_sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="n">entry</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1910"><a href="#Extract_Disulfides-1910"><span class="linenos">1910</span></a>        <span class="n">_sslist</span> <span class="o">=</span> <span class="n">proteusPy</span><span class="o">.</span><span class="n">DisulfideList</span><span class="o">.</span><span class="n">load_disulfides_from_id</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> 
</span><span id="Extract_Disulfides-1911"><a href="#Extract_Disulfides-1911"><span class="linenos">1911</span></a>                                                                <span class="n">model_numb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
</span><span id="Extract_Disulfides-1912"><a href="#Extract_Disulfides-1912"><span class="linenos">1912</span></a>                                                                <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> 
</span><span id="Extract_Disulfides-1913"><a href="#Extract_Disulfides-1913"><span class="linenos">1913</span></a>                                                                <span class="n">quiet</span><span class="o">=</span><span class="n">quiet</span><span class="p">,</span> 
</span><span id="Extract_Disulfides-1914"><a href="#Extract_Disulfides-1914"><span class="linenos">1914</span></a>                                                                <span class="n">pdb_dir</span><span class="o">=</span><span class="n">pdbdir</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1915"><a href="#Extract_Disulfides-1915"><span class="linenos">1915</span></a>        <span class="n">sslist</span><span class="p">,</span> <span class="n">xchain</span> <span class="o">=</span> <span class="n">prune_extra_ss</span><span class="p">(</span><span class="n">_sslist</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1916"><a href="#Extract_Disulfides-1916"><span class="linenos">1916</span></a>
</span><span id="Extract_Disulfides-1917"><a href="#Extract_Disulfides-1917"><span class="linenos">1917</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sslist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Extract_Disulfides-1918"><a href="#Extract_Disulfides-1918"><span class="linenos">1918</span></a>            <span class="n">sslist2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># list to hold indices for ss_dict2</span>
</span><span id="Extract_Disulfides-1919"><a href="#Extract_Disulfides-1919"><span class="linenos">1919</span></a>            <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">:</span>
</span><span id="Extract_Disulfides-1920"><a href="#Extract_Disulfides-1920"><span class="linenos">1920</span></a>                <span class="c1"># Ca distance cutoff</span>
</span><span id="Extract_Disulfides-1921"><a href="#Extract_Disulfides-1921"><span class="linenos">1921</span></a>                <span class="n">dist</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">ca_distance</span>
</span><span id="Extract_Disulfides-1922"><a href="#Extract_Disulfides-1922"><span class="linenos">1922</span></a>                <span class="k">if</span> <span class="n">dist</span> <span class="o">&gt;=</span> <span class="n">dist_cutoff</span> <span class="ow">and</span> <span class="n">dist_cutoff</span> <span class="o">!=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">:</span>
</span><span id="Extract_Disulfides-1923"><a href="#Extract_Disulfides-1923"><span class="linenos">1923</span></a>                    <span class="n">bad_dist</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Extract_Disulfides-1924"><a href="#Extract_Disulfides-1924"><span class="linenos">1924</span></a>                    <span class="k">continue</span>
</span><span id="Extract_Disulfides-1925"><a href="#Extract_Disulfides-1925"><span class="linenos">1925</span></a>
</span><span id="Extract_Disulfides-1926"><a href="#Extract_Disulfides-1926"><span class="linenos">1926</span></a>                <span class="n">All_ss_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1927"><a href="#Extract_Disulfides-1927"><span class="linenos">1927</span></a>                <span class="n">new_row</span> <span class="o">=</span> <span class="p">[</span><span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">proximal</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">distal</span><span class="p">,</span> 
</span><span id="Extract_Disulfides-1928"><a href="#Extract_Disulfides-1928"><span class="linenos">1928</span></a>                		  <span class="n">ss</span><span class="o">.</span><span class="n">chi1</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">chi2</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">chi3</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">chi4</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">chi5</span><span class="p">,</span> 
</span><span id="Extract_Disulfides-1929"><a href="#Extract_Disulfides-1929"><span class="linenos">1929</span></a>                		  <span class="n">ss</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">ca_distance</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">cb_distance</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">phiprox</span><span class="p">,</span> 
</span><span id="Extract_Disulfides-1930"><a href="#Extract_Disulfides-1930"><span class="linenos">1930</span></a>                          <span class="n">ss</span><span class="o">.</span><span class="n">psiprox</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">phidist</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">psidist</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">torsion_length</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">rho</span><span class="p">]</span>
</span><span id="Extract_Disulfides-1931"><a href="#Extract_Disulfides-1931"><span class="linenos">1931</span></a>                          
</span><span id="Extract_Disulfides-1932"><a href="#Extract_Disulfides-1932"><span class="linenos">1932</span></a>                <span class="c1"># add the row to the end of the dataframe</span>
</span><span id="Extract_Disulfides-1933"><a href="#Extract_Disulfides-1933"><span class="linenos">1933</span></a>                <span class="n">SS_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">SS_df</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span> <span class="o">=</span> <span class="n">new_row</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># deep copy</span>
</span><span id="Extract_Disulfides-1934"><a href="#Extract_Disulfides-1934"><span class="linenos">1934</span></a>                <span class="n">sslist2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1935"><a href="#Extract_Disulfides-1935"><span class="linenos">1935</span></a>                <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Extract_Disulfides-1936"><a href="#Extract_Disulfides-1936"><span class="linenos">1936</span></a>                <span class="n">tot</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Extract_Disulfides-1937"><a href="#Extract_Disulfides-1937"><span class="linenos">1937</span></a>
</span><span id="Extract_Disulfides-1938"><a href="#Extract_Disulfides-1938"><span class="linenos">1938</span></a>            <span class="c1"># All_ss_dict[entry] = sslist</span>
</span><span id="Extract_Disulfides-1939"><a href="#Extract_Disulfides-1939"><span class="linenos">1939</span></a>            <span class="c1"># print(f&#39;Entry: {entry}. Dict indices: {sslist2}&#39;)</span>
</span><span id="Extract_Disulfides-1940"><a href="#Extract_Disulfides-1940"><span class="linenos">1940</span></a>            <span class="n">All_ss_dict2</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span> <span class="o">=</span> <span class="n">sslist2</span>
</span><span id="Extract_Disulfides-1941"><a href="#Extract_Disulfides-1941"><span class="linenos">1941</span></a>            <span class="c1"># print(f&#39;{entry} ss dict adding: {sslist2}&#39;)</span>
</span><span id="Extract_Disulfides-1942"><a href="#Extract_Disulfides-1942"><span class="linenos">1942</span></a>
</span><span id="Extract_Disulfides-1943"><a href="#Extract_Disulfides-1943"><span class="linenos">1943</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Extract_Disulfides-1944"><a href="#Extract_Disulfides-1944"><span class="linenos">1944</span></a>            <span class="c1"># at this point I really shouldn&#39;t have any bad non-parsible file</span>
</span><span id="Extract_Disulfides-1945"><a href="#Extract_Disulfides-1945"><span class="linenos">1945</span></a>            <span class="n">bad</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Extract_Disulfides-1946"><a href="#Extract_Disulfides-1946"><span class="linenos">1946</span></a>            <span class="n">problem_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1947"><a href="#Extract_Disulfides-1947"><span class="linenos">1947</span></a>            <span class="c1">#os.remove(f&#39;pdb{entry}.ent&#39;)</span>
</span><span id="Extract_Disulfides-1948"><a href="#Extract_Disulfides-1948"><span class="linenos">1948</span></a>    
</span><span id="Extract_Disulfides-1949"><a href="#Extract_Disulfides-1949"><span class="linenos">1949</span></a>    <span class="k">if</span> <span class="n">bad</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Extract_Disulfides-1950"><a href="#Extract_Disulfides-1950"><span class="linenos">1950</span></a>        <span class="n">prob_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
</span><span id="Extract_Disulfides-1951"><a href="#Extract_Disulfides-1951"><span class="linenos">1951</span></a>        <span class="n">problem_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">prob_cols</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1952"><a href="#Extract_Disulfides-1952"><span class="linenos">1952</span></a>        <span class="n">problem_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">problem_ids</span>
</span><span id="Extract_Disulfides-1953"><a href="#Extract_Disulfides-1953"><span class="linenos">1953</span></a>
</span><span id="Extract_Disulfides-1954"><a href="#Extract_Disulfides-1954"><span class="linenos">1954</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; Extract_Disulfides(): Found and removed: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">problem_ids</span><span class="p">)</span><span class="si">}</span><span class="s1"> non-parsable structures.&#39;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1955"><a href="#Extract_Disulfides-1955"><span class="linenos">1955</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; Extract_Disulfides(): Saving problem IDs to file: </span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">problemfile</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1956"><a href="#Extract_Disulfides-1956"><span class="linenos">1956</span></a>
</span><span id="Extract_Disulfides-1957"><a href="#Extract_Disulfides-1957"><span class="linenos">1957</span></a>        <span class="n">problem_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">problemfile</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1958"><a href="#Extract_Disulfides-1958"><span class="linenos">1958</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Extract_Disulfides-1959"><a href="#Extract_Disulfides-1959"><span class="linenos">1959</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Extract_Disulfides-1960"><a href="#Extract_Disulfides-1960"><span class="linenos">1960</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&gt; Extract_Disulfides(): No non-parsable structures found.&#39;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1961"><a href="#Extract_Disulfides-1961"><span class="linenos">1961</span></a>
</span><span id="Extract_Disulfides-1962"><a href="#Extract_Disulfides-1962"><span class="linenos">1962</span></a>    <span class="k">if</span> <span class="n">bad_dist</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Extract_Disulfides-1963"><a href="#Extract_Disulfides-1963"><span class="linenos">1963</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; Extract_Disulfides(): Found and ignored: </span><span class="si">{</span><span class="n">bad_dist</span><span class="si">}</span><span class="s1"> long SS bonds.&#39;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1964"><a href="#Extract_Disulfides-1964"><span class="linenos">1964</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Extract_Disulfides-1965"><a href="#Extract_Disulfides-1965"><span class="linenos">1965</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Extract_Disulfides-1966"><a href="#Extract_Disulfides-1966"><span class="linenos">1966</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No problems found.&#39;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1967"><a href="#Extract_Disulfides-1967"><span class="linenos">1967</span></a>
</span><span id="Extract_Disulfides-1968"><a href="#Extract_Disulfides-1968"><span class="linenos">1968</span></a>    <span class="c1"># dump the all_ss list of disulfides to a .pkl file. ~520 MB.</span>
</span><span id="Extract_Disulfides-1969"><a href="#Extract_Disulfides-1969"><span class="linenos">1969</span></a>    <span class="n">fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">picklefile</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Extract_Disulfides-1970"><a href="#Extract_Disulfides-1970"><span class="linenos">1970</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; Extract_Disulfides(): Saving </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">All_ss_list</span><span class="p">)</span><span class="si">}</span><span class="s1"> Disulfides to file: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1971"><a href="#Extract_Disulfides-1971"><span class="linenos">1971</span></a>    
</span><span id="Extract_Disulfides-1972"><a href="#Extract_Disulfides-1972"><span class="linenos">1972</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;wb+&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="Extract_Disulfides-1973"><a href="#Extract_Disulfides-1973"><span class="linenos">1973</span></a>        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">All_ss_list</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1974"><a href="#Extract_Disulfides-1974"><span class="linenos">1974</span></a>
</span><span id="Extract_Disulfides-1975"><a href="#Extract_Disulfides-1975"><span class="linenos">1975</span></a>    <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Extract_Disulfides-1976"><a href="#Extract_Disulfides-1976"><span class="linenos">1976</span></a><span class="sd">    SS_SUBSET_DICT_PICKLE_FILE</span>
</span><span id="Extract_Disulfides-1977"><a href="#Extract_Disulfides-1977"><span class="linenos">1977</span></a><span class="sd">    # dump the dict of disulfides to a .pkl file. ~520 MB.</span>
</span><span id="Extract_Disulfides-1978"><a href="#Extract_Disulfides-1978"><span class="linenos">1978</span></a><span class="sd">    dict_len = len(All_ss_dict)</span>
</span><span id="Extract_Disulfides-1979"><a href="#Extract_Disulfides-1979"><span class="linenos">1979</span></a><span class="sd">    fname = f&#39;{datadir}{dictfile}&#39;</span>
</span><span id="Extract_Disulfides-1980"><a href="#Extract_Disulfides-1980"><span class="linenos">1980</span></a><span class="sd">    print(f&#39;-&gt; Extract_Disulfides(): Saving {dict_len} Disulfide-containing PDB IDs to file: {fname}&#39;)</span>
</span><span id="Extract_Disulfides-1981"><a href="#Extract_Disulfides-1981"><span class="linenos">1981</span></a>
</span><span id="Extract_Disulfides-1982"><a href="#Extract_Disulfides-1982"><span class="linenos">1982</span></a><span class="sd">    with open(fname, &#39;wb+&#39;) as f:</span>
</span><span id="Extract_Disulfides-1983"><a href="#Extract_Disulfides-1983"><span class="linenos">1983</span></a><span class="sd">        pickle.dump(All_ss_dict, f)</span>
</span><span id="Extract_Disulfides-1984"><a href="#Extract_Disulfides-1984"><span class="linenos">1984</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="Extract_Disulfides-1985"><a href="#Extract_Disulfides-1985"><span class="linenos">1985</span></a>
</span><span id="Extract_Disulfides-1986"><a href="#Extract_Disulfides-1986"><span class="linenos">1986</span></a>    <span class="c1"># dump the dict2 disulfides to a .pkl file. ~520 MB.</span>
</span><span id="Extract_Disulfides-1987"><a href="#Extract_Disulfides-1987"><span class="linenos">1987</span></a>    <span class="n">dict_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">All_ss_dict2</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1988"><a href="#Extract_Disulfides-1988"><span class="linenos">1988</span></a>    <span class="n">fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">dictfile</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Extract_Disulfides-1989"><a href="#Extract_Disulfides-1989"><span class="linenos">1989</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; Extract_Disulfides(): Saving indices of </span><span class="si">{</span><span class="n">dict_len</span><span class="si">}</span><span class="s1"> Disulfide-containing PDB IDs to file: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1990"><a href="#Extract_Disulfides-1990"><span class="linenos">1990</span></a>
</span><span id="Extract_Disulfides-1991"><a href="#Extract_Disulfides-1991"><span class="linenos">1991</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;wb+&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="Extract_Disulfides-1992"><a href="#Extract_Disulfides-1992"><span class="linenos">1992</span></a>        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">All_ss_dict2</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1993"><a href="#Extract_Disulfides-1993"><span class="linenos">1993</span></a>
</span><span id="Extract_Disulfides-1994"><a href="#Extract_Disulfides-1994"><span class="linenos">1994</span></a>    <span class="c1"># save the torsions</span>
</span><span id="Extract_Disulfides-1995"><a href="#Extract_Disulfides-1995"><span class="linenos">1995</span></a>    <span class="n">fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">torsionfile</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Extract_Disulfides-1996"><a href="#Extract_Disulfides-1996"><span class="linenos">1996</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; Extract_Disulfides(): Saving torsions to file: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1997"><a href="#Extract_Disulfides-1997"><span class="linenos">1997</span></a>    <span class="n">SS_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
</span><span id="Extract_Disulfides-1998"><a href="#Extract_Disulfides-1998"><span class="linenos">1998</span></a>
</span><span id="Extract_Disulfides-1999"><a href="#Extract_Disulfides-1999"><span class="linenos">1999</span></a>    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Extract_Disulfides-2000"><a href="#Extract_Disulfides-2000"><span class="linenos">2000</span></a>    <span class="n">elapsed</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>
</span><span id="Extract_Disulfides-2001"><a href="#Extract_Disulfides-2001"><span class="linenos">2001</span></a>
</span><span id="Extract_Disulfides-2002"><a href="#Extract_Disulfides-2002"><span class="linenos">2002</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; Extract_Disulfides(): Disulfide Extraction complete! Elapsed time:</span><span class="se">\</span>
</span><span id="Extract_Disulfides-2003"><a href="#Extract_Disulfides-2003"><span class="linenos">2003</span></a><span class="s1">    	 </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed</span><span class="p">)</span><span class="si">}</span><span class="s1"> (h:m:s)&#39;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-2004"><a href="#Extract_Disulfides-2004"><span class="linenos">2004</span></a>
</span><span id="Extract_Disulfides-2005"><a href="#Extract_Disulfides-2005"><span class="linenos">2005</span></a>    <span class="c1"># return to original directory</span>
</span><span id="Extract_Disulfides-2006"><a href="#Extract_Disulfides-2006"><span class="linenos">2006</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
</span><span id="Extract_Disulfides-2007"><a href="#Extract_Disulfides-2007"><span class="linenos">2007</span></a>    <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>This function creates .pkl files needed for the 
<a href="DisulfideLoader.html#DisulfideLoader">proteusPy.DisulfideLoader.DisulfideLoader</a> class. 
The <code><a href="#Disulfide">Disulfide</a></code> objects are contained in a <code>DisulfideList</code> object and 
<code>Dict</code> within these files. In addition, .csv files containing all of 
the torsions for the disulfides and problem IDs are written. The optional
<code>dist_cutoff</code> allows for removal of Disufides whose Cα-Cα distance is &gt;
than the cutoff value. If it's -1.0 then the function keeps all Disulfides.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>numb</strong>:            number of entries to process, defaults to all</li>
<li><strong>verbose</strong>:         more messages</li>
<li><strong>quiet</strong>:           turns off DisulfideConstruction warnings</li>
<li><strong>pdbdir</strong>:          path to PDB files</li>
<li><strong>datadir</strong>:         path to resulting .pkl files</li>
<li><strong>picklefile</strong>:      name of the disulfide .pkl file</li>
<li><strong>torsionfile</strong>:     name of the disulfide torsion file .csv created</li>
<li><strong>problemfile</strong>:     name of the .csv file containing problem ids</li>
<li><strong>dictfile</strong>:        name of the .pkl file</li>
<li><strong>dist_cutoff</strong>:     Ca distance cutoff to reject a Disulfide.</li>
</ul>

<p>The following examples illustrate some basic functions of the disulfide classes:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="">proteusPy.Disulfide</a></span> <span class="kn">import</span> <span class="n">Disulfide</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="DisulfideLoader.html">proteusPy.DisulfideLoader</a></span> <span class="kn">import</span> <span class="n">DisulfideLoader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="DisulfideList.html">proteusPy.DisulfideList</a></span> <span class="kn">import</span> <span class="n">DisulfideList</span>
</code></pre>
</div>

<p>Instantiate some variables. Note: the list is initialized with an iterable and a name (optional)</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">SS</span> <span class="o">=</span> <span class="n">Disulfide</span><span class="p">(</span><span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SSlist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span><span class="s1">&#39;ss&#39;</span><span class="p">)</span>
</code></pre>
</div>

<p>Load the Disulfide subset database. This contains around 8300 disulfides and loads
fairly quickly.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">PDB_SS</span> <span class="o">=</span> <span class="n">DisulfideLoader</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre>
</div>

<p>The dataset can be indexed numerically, up to index: PDB_SS.Length(). Get the first SS:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">SS</span> <span class="o">=</span> <span class="n">PDB_SS</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SS</span>
<span class="go">&lt;Disulfide 4yys_22A_65A, Source: 4yys, Resolution: 1.35 Å&gt;</span>
</code></pre>
</div>

<p>The dataset can also be indexed by PDB ID. Get the DisulfideList for ID 4yys:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">SS4yys</span> <span class="o">=</span> <span class="n">PDB_SS</span><span class="p">[</span><span class="s1">&#39;4yys&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SS4yys</span>
<span class="go">[&lt;Disulfide 4yys_22A_65A, Source: 4yys, Resolution: 1.35 Å&gt;, &lt;Disulfide 4yys_56A_98A, Source: 4yys, Resolution: 1.35 Å&gt;, &lt;Disulfide 4yys_156A_207A, Source: 4yys, Resolution: 1.35 Å&gt;]</span>
</code></pre>
</div>

<p>Make some empty disulfides:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ss1</span> <span class="o">=</span> <span class="n">Disulfide</span><span class="p">(</span><span class="s1">&#39;ss1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ss2</span> <span class="o">=</span> <span class="n">Disulfide</span><span class="p">(</span><span class="s1">&#39;ss2&#39;</span><span class="p">)</span>
</code></pre>
</div>

<p>Make a DisulfideList containing ss1, named 'tmp':</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([</span><span class="n">ss1</span><span class="p">],</span> <span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
</code></pre>
</div>

<p>Append ss2:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">sslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss2</span><span class="p">)</span>
</code></pre>
</div>

<p>Extract the first disulfide and print it:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ss1</span> <span class="o">=</span> <span class="n">PDB_SS</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ss1</span><span class="o">.</span><span class="n">pprint_all</span><span class="p">()</span>
<span class="go">&lt;Disulfide 4yys_22A_65A, Source: 4yys, Resolution: 1.35 Å</span>
<span class="go"> Proximal Chain fullID: &lt;(&#39;4yys&#39;, 0, &#39;A&#39;, (&#39; &#39;, 22, &#39; &#39;))&gt; Distal Chain fullID: &lt;(&#39;4yys&#39;, 0, &#39;A&#39;, (&#39; &#39;, 65, &#39; &#39;))&gt; </span>
<span class="go">Proximal Coordinates:</span>
<span class="go">   N: &lt;Vector -2.36, -20.48, 5.21&gt;</span>
<span class="go">   Cα: &lt;Vector -2.10, -19.89, 3.90&gt;</span>
<span class="go">   C: &lt;Vector -1.12, -18.78, 4.12&gt;</span>
<span class="go">   O: &lt;Vector -1.30, -17.96, 5.03&gt;</span>
<span class="go">   Cβ: &lt;Vector -3.38, -19.31, 3.32&gt;</span>
<span class="go">   Sγ: &lt;Vector -3.24, -18.40, 1.76&gt;</span>
<span class="go">   Cprev &lt;Vector -2.67, -21.75, 5.36&gt;</span>
<span class="go">   Nnext: &lt;Vector -0.02, -18.76, 3.36&gt;</span>
<span class="go"> Distal Coordinates:</span>
<span class="go">   N: &lt;Vector -0.60, -18.71, -1.62&gt;</span>
<span class="go">   Cα: &lt;Vector -0.48, -19.10, -0.22&gt;</span>
<span class="go">   C: &lt;Vector 0.92, -19.52, 0.18&gt;</span>
<span class="go">   O: &lt;Vector 1.10, -20.09, 1.25&gt;</span>
<span class="go">   Cβ: &lt;Vector -1.48, -20.23, 0.08&gt;</span>
<span class="go">   Sγ: &lt;Vector -3.22, -19.69, 0.18&gt;</span>
<span class="go">   Cprev &lt;Vector -0.73, -17.44, -2.01&gt;</span>
<span class="go">   Nnext: &lt;Vector 1.92, -19.18, -0.63&gt;</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go"> Proximal Internal Coords:</span>
<span class="go">   N: &lt;Vector -0.41, 1.40, -0.00&gt;</span>
<span class="go">   Cα: &lt;Vector 0.00, 0.00, 0.00&gt;</span>
<span class="go">   C: &lt;Vector 1.50, 0.00, 0.00&gt;</span>
<span class="go">   O: &lt;Vector 2.12, 0.71, -0.80&gt;</span>
<span class="go">   Cβ: &lt;Vector -0.50, -0.70, -1.25&gt;</span>
<span class="go">   Sγ: &lt;Vector 0.04, -2.41, -1.50&gt;</span>
<span class="go">   Cprev &lt;Vector -2.67, -21.75, 5.36&gt;</span>
<span class="go">   Nnext: &lt;Vector -0.02, -18.76, 3.36&gt;</span>
<span class="go">Distal Internal Coords:</span>
<span class="go">   N: &lt;Vector 1.04, -5.63, 1.17&gt;</span>
<span class="go">   Cα: &lt;Vector 1.04, -4.18, 1.31&gt;</span>
<span class="go">   C: &lt;Vector 1.72, -3.68, 2.57&gt;</span>
<span class="go">   O: &lt;Vector 1.57, -2.51, 2.92&gt;</span>
<span class="go">   Cβ: &lt;Vector -0.41, -3.66, 1.24&gt;</span>
<span class="go">   Sγ: &lt;Vector -1.14, -3.69, -0.43&gt;</span>
<span class="go">   Cprev &lt;Vector -0.73, -17.44, -2.01&gt;</span>
<span class="go">   Nnext: &lt;Vector 1.92, -19.18, -0.63&gt;</span>
<span class="go"> Χ1-Χ5: 174.63°, 82.52°, -83.32°, -62.52° -73.83°, 1.70 kcal/mol</span>
<span class="go"> Cα Distance: 4.50 Å</span>
<span class="go"> Torsion length: 231.53 deg&gt;</span>
</code></pre>
</div>

<p>Get a list of disulfides via slicing and display them oriented against a common
reference frame (the proximal N, Cα, C').</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">subset</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="n">PDB_SS</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span><span class="s1">&#39;subset&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset</span><span class="o">.</span><span class="n">display_overlay</span><span class="p">()</span>
</code></pre>
</div>

<p>Take a screenshot. You can position the orientation, then close the window:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">subset</span><span class="o">.</span><span class="n">screenshot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;subset.png&#39;</span><span class="p">)</span>
<span class="go">---&gt; screenshot(): Saving file: subset.png</span>
<span class="go">---&gt; screenshot(): Saved file: subset.png</span>
</code></pre>
</div>

<p>Browse the documentation for more functionality. The display functions are particularly useful.</p>
</div>


                </section>
                <section id="check_header_from_file">
                            <input id="check_header_from_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_header_from_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">model_numb</span><span class="o">=</span><span class="mi">0</span>, </span><span class="param"><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="n">dbg</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="check_header_from_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#check_header_from_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="check_header_from_file-2009"><a href="#check_header_from_file-2009"><span class="linenos">2009</span></a><span class="k">def</span> <span class="nf">check_header_from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">model_numb</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
</span><span id="check_header_from_file-2010"><a href="#check_header_from_file-2010"><span class="linenos">2010</span></a>                            <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">dbg</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="check_header_from_file-2011"><a href="#check_header_from_file-2011"><span class="linenos">2011</span></a>    <span class="sd">&#39;&#39;&#39;</span>
</span><span id="check_header_from_file-2012"><a href="#check_header_from_file-2012"><span class="linenos">2012</span></a><span class="sd">    Checks the Disulfides by PDB ID and initializes the Disulfide objects.</span>
</span><span id="check_header_from_file-2013"><a href="#check_header_from_file-2013"><span class="linenos">2013</span></a><span class="sd">    Assumes the file is downloaded in the pdb_dir path.</span>
</span><span id="check_header_from_file-2014"><a href="#check_header_from_file-2014"><span class="linenos">2014</span></a><span class="sd">    </span>
</span><span id="check_header_from_file-2015"><a href="#check_header_from_file-2015"><span class="linenos">2015</span></a><span class="sd">    NB: Requires EGS-Modified BIO.parse_pdb_header.py from https://github.com/suchanek/biopython/</span>
</span><span id="check_header_from_file-2016"><a href="#check_header_from_file-2016"><span class="linenos">2016</span></a>
</span><span id="check_header_from_file-2017"><a href="#check_header_from_file-2017"><span class="linenos">2017</span></a><span class="sd">    :param struct_name: the name of the PDB entry.</span>
</span><span id="check_header_from_file-2018"><a href="#check_header_from_file-2018"><span class="linenos">2018</span></a><span class="sd">    :param pdb_dir: path to the PDB files, defaults to ```MODEL_DIR```</span>
</span><span id="check_header_from_file-2019"><a href="#check_header_from_file-2019"><span class="linenos">2019</span></a><span class="sd">    :param model_numb: model number to use, defaults to 0 for single structure files.</span>
</span><span id="check_header_from_file-2020"><a href="#check_header_from_file-2020"><span class="linenos">2020</span></a><span class="sd">    :param verbose: print info while parsing</span>
</span><span id="check_header_from_file-2021"><a href="#check_header_from_file-2021"><span class="linenos">2021</span></a><span class="sd">    :return: True if parsable</span>
</span><span id="check_header_from_file-2022"><a href="#check_header_from_file-2022"><span class="linenos">2022</span></a><span class="sd">    </span>
</span><span id="check_header_from_file-2023"><a href="#check_header_from_file-2023"><span class="linenos">2023</span></a><span class="sd">    Example:</span>
</span><span id="check_header_from_file-2024"><a href="#check_header_from_file-2024"><span class="linenos">2024</span></a><span class="sd">      Assuming ```MODEL_DIR``` has the pdb5rsa.ent file we can load the disulfides</span>
</span><span id="check_header_from_file-2025"><a href="#check_header_from_file-2025"><span class="linenos">2025</span></a><span class="sd">      with the following:</span>
</span><span id="check_header_from_file-2026"><a href="#check_header_from_file-2026"><span class="linenos">2026</span></a>
</span><span id="check_header_from_file-2027"><a href="#check_header_from_file-2027"><span class="linenos">2027</span></a><span class="sd">    &gt;&gt;&gt; from proteusPy.Disulfide import Disulfide, check_header_from_file</span>
</span><span id="check_header_from_file-2028"><a href="#check_header_from_file-2028"><span class="linenos">2028</span></a><span class="sd">    &gt;&gt;&gt; MODEL_DIR = &#39;/Users/egs/PDB/good/&#39;</span>
</span><span id="check_header_from_file-2029"><a href="#check_header_from_file-2029"><span class="linenos">2029</span></a><span class="sd">    &gt;&gt;&gt; OK = False</span>
</span><span id="check_header_from_file-2030"><a href="#check_header_from_file-2030"><span class="linenos">2030</span></a><span class="sd">    &gt;&gt;&gt; OK = check_header_from_file(f&#39;{MODEL_DIR}pdb5rsa.ent&#39;, verbose=True)</span>
</span><span id="check_header_from_file-2031"><a href="#check_header_from_file-2031"><span class="linenos">2031</span></a><span class="sd">    -&gt; check_header_from_file() - Parsing file: /Users/egs/PDB/good/pdb5rsa.ent:</span>
</span><span id="check_header_from_file-2032"><a href="#check_header_from_file-2032"><span class="linenos">2032</span></a><span class="sd">     -&gt; SSBond: 1: tmp: 26A - 84A</span>
</span><span id="check_header_from_file-2033"><a href="#check_header_from_file-2033"><span class="linenos">2033</span></a><span class="sd">     -&gt; SSBond: 2: tmp: 40A - 95A</span>
</span><span id="check_header_from_file-2034"><a href="#check_header_from_file-2034"><span class="linenos">2034</span></a><span class="sd">     -&gt; SSBond: 3: tmp: 58A - 110A</span>
</span><span id="check_header_from_file-2035"><a href="#check_header_from_file-2035"><span class="linenos">2035</span></a><span class="sd">     -&gt; SSBond: 4: tmp: 65A - 72A</span>
</span><span id="check_header_from_file-2036"><a href="#check_header_from_file-2036"><span class="linenos">2036</span></a><span class="sd">    &gt;&gt;&gt; OK</span>
</span><span id="check_header_from_file-2037"><a href="#check_header_from_file-2037"><span class="linenos">2037</span></a><span class="sd">    True</span>
</span><span id="check_header_from_file-2038"><a href="#check_header_from_file-2038"><span class="linenos">2038</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="check_header_from_file-2039"><a href="#check_header_from_file-2039"><span class="linenos">2039</span></a>
</span><span id="check_header_from_file-2040"><a href="#check_header_from_file-2040"><span class="linenos">2040</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="check_header_from_file-2041"><a href="#check_header_from_file-2041"><span class="linenos">2041</span></a>    <span class="n">proximal</span> <span class="o">=</span> <span class="n">distal</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="check_header_from_file-2042"><a href="#check_header_from_file-2042"><span class="linenos">2042</span></a>    <span class="n">SSList</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="check_header_from_file-2043"><a href="#check_header_from_file-2043"><span class="linenos">2043</span></a>    <span class="n">_chaina</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="check_header_from_file-2044"><a href="#check_header_from_file-2044"><span class="linenos">2044</span></a>    <span class="n">_chainb</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="check_header_from_file-2045"><a href="#check_header_from_file-2045"><span class="linenos">2045</span></a>
</span><span id="check_header_from_file-2046"><a href="#check_header_from_file-2046"><span class="linenos">2046</span></a>    <span class="n">parser</span> <span class="o">=</span> <span class="n">PDBParser</span><span class="p">(</span><span class="n">PERMISSIVE</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="check_header_from_file-2047"><a href="#check_header_from_file-2047"><span class="linenos">2047</span></a>    
</span><span id="check_header_from_file-2048"><a href="#check_header_from_file-2048"><span class="linenos">2048</span></a>    <span class="c1"># Biopython uses the Structure -&gt; Model -&gt; Chain hierarchy to organize</span>
</span><span id="check_header_from_file-2049"><a href="#check_header_from_file-2049"><span class="linenos">2049</span></a>    <span class="c1"># structures. All are iterable.</span>
</span><span id="check_header_from_file-2050"><a href="#check_header_from_file-2050"><span class="linenos">2050</span></a>
</span><span id="check_header_from_file-2051"><a href="#check_header_from_file-2051"><span class="linenos">2051</span></a>    <span class="n">structure</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="s1">&#39;tmp&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>
</span><span id="check_header_from_file-2052"><a href="#check_header_from_file-2052"><span class="linenos">2052</span></a>    <span class="n">struct_name</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">get_id</span><span class="p">()</span>
</span><span id="check_header_from_file-2053"><a href="#check_header_from_file-2053"><span class="linenos">2053</span></a>    
</span><span id="check_header_from_file-2054"><a href="#check_header_from_file-2054"><span class="linenos">2054</span></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">structure</span><span class="p">[</span><span class="n">model_numb</span><span class="p">]</span>
</span><span id="check_header_from_file-2055"><a href="#check_header_from_file-2055"><span class="linenos">2055</span></a>
</span><span id="check_header_from_file-2056"><a href="#check_header_from_file-2056"><span class="linenos">2056</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="check_header_from_file-2057"><a href="#check_header_from_file-2057"><span class="linenos">2057</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; check_header_from_file() - Parsing file: </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">:&#39;</span><span class="p">)</span>
</span><span id="check_header_from_file-2058"><a href="#check_header_from_file-2058"><span class="linenos">2058</span></a>
</span><span id="check_header_from_file-2059"><a href="#check_header_from_file-2059"><span class="linenos">2059</span></a>    <span class="n">ssbond_dict</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;ssbond&#39;</span><span class="p">]</span> <span class="c1"># NB: this requires the modified code</span>
</span><span id="check_header_from_file-2060"><a href="#check_header_from_file-2060"><span class="linenos">2060</span></a>
</span><span id="check_header_from_file-2061"><a href="#check_header_from_file-2061"><span class="linenos">2061</span></a>    <span class="c1"># list of tuples with (proximal distal chaina chainb)</span>
</span><span id="check_header_from_file-2062"><a href="#check_header_from_file-2062"><span class="linenos">2062</span></a>    <span class="n">ssbonds</span> <span class="o">=</span> <span class="n">parse_ssbond_header_rec</span><span class="p">(</span><span class="n">ssbond_dict</span><span class="p">)</span> 
</span><span id="check_header_from_file-2063"><a href="#check_header_from_file-2063"><span class="linenos">2063</span></a>
</span><span id="check_header_from_file-2064"><a href="#check_header_from_file-2064"><span class="linenos">2064</span></a>    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">ssbonds</span><span class="p">:</span>
</span><span id="check_header_from_file-2065"><a href="#check_header_from_file-2065"><span class="linenos">2065</span></a>        <span class="c1"># in the form (proximal, distal, chain)</span>
</span><span id="check_header_from_file-2066"><a href="#check_header_from_file-2066"><span class="linenos">2066</span></a>        <span class="n">proximal</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
</span><span id="check_header_from_file-2067"><a href="#check_header_from_file-2067"><span class="linenos">2067</span></a>        <span class="n">distal</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="check_header_from_file-2068"><a href="#check_header_from_file-2068"><span class="linenos">2068</span></a>
</span><span id="check_header_from_file-2069"><a href="#check_header_from_file-2069"><span class="linenos">2069</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">proximal</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">distal</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
</span><span id="check_header_from_file-2070"><a href="#check_header_from_file-2070"><span class="linenos">2070</span></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="check_header_from_file-2071"><a href="#check_header_from_file-2071"><span class="linenos">2071</span></a>                <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39; ! Cannot parse SSBond record (non-numeric IDs):</span><span class="se">\</span>
</span><span id="check_header_from_file-2072"><a href="#check_header_from_file-2072"><span class="linenos">2072</span></a><span class="s1">                 </span><span class="si">{</span><span class="n">struct_name</span><span class="si">}</span><span class="s1"> Prox:  </span><span class="si">{</span><span class="n">proximal</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">chain1_id</span><span class="si">}</span><span class="s1"> Dist: </span><span class="si">{</span><span class="n">distal</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">chain2_id</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="check_header_from_file-2073"><a href="#check_header_from_file-2073"><span class="linenos">2073</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">,</span> <span class="n">DisulfideParseWarning</span><span class="p">)</span>
</span><span id="check_header_from_file-2074"><a href="#check_header_from_file-2074"><span class="linenos">2074</span></a>            <span class="k">continue</span> <span class="c1"># was pass</span>
</span><span id="check_header_from_file-2075"><a href="#check_header_from_file-2075"><span class="linenos">2075</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="check_header_from_file-2076"><a href="#check_header_from_file-2076"><span class="linenos">2076</span></a>            <span class="n">proximal</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">proximal</span><span class="p">)</span>
</span><span id="check_header_from_file-2077"><a href="#check_header_from_file-2077"><span class="linenos">2077</span></a>            <span class="n">distal</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">distal</span><span class="p">)</span>
</span><span id="check_header_from_file-2078"><a href="#check_header_from_file-2078"><span class="linenos">2078</span></a>        
</span><span id="check_header_from_file-2079"><a href="#check_header_from_file-2079"><span class="linenos">2079</span></a>        <span class="n">chain1_id</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="check_header_from_file-2080"><a href="#check_header_from_file-2080"><span class="linenos">2080</span></a>        <span class="n">chain2_id</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="check_header_from_file-2081"><a href="#check_header_from_file-2081"><span class="linenos">2081</span></a>
</span><span id="check_header_from_file-2082"><a href="#check_header_from_file-2082"><span class="linenos">2082</span></a>        <span class="n">_chaina</span> <span class="o">=</span> <span class="n">model</span><span class="p">[</span><span class="n">chain1_id</span><span class="p">]</span>
</span><span id="check_header_from_file-2083"><a href="#check_header_from_file-2083"><span class="linenos">2083</span></a>        <span class="n">_chainb</span> <span class="o">=</span> <span class="n">model</span><span class="p">[</span><span class="n">chain2_id</span><span class="p">]</span>
</span><span id="check_header_from_file-2084"><a href="#check_header_from_file-2084"><span class="linenos">2084</span></a>
</span><span id="check_header_from_file-2085"><a href="#check_header_from_file-2085"><span class="linenos">2085</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">chain1_id</span> <span class="o">!=</span> <span class="n">chain2_id</span><span class="p">):</span>
</span><span id="check_header_from_file-2086"><a href="#check_header_from_file-2086"><span class="linenos">2086</span></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="check_header_from_file-2087"><a href="#check_header_from_file-2087"><span class="linenos">2087</span></a>                <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39; -&gt; Cross Chain SS for: Prox: </span><span class="si">{</span><span class="n">proximal</span><span class="si">}{</span><span class="n">chain1_id</span><span class="si">}</span><span class="s1"> Dist: </span><span class="si">{</span><span class="n">distal</span><span class="si">}{</span><span class="n">chain2_id</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="check_header_from_file-2088"><a href="#check_header_from_file-2088"><span class="linenos">2088</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">mess</span><span class="p">,</span> <span class="n">DisulfideParseWarning</span><span class="p">)</span>
</span><span id="check_header_from_file-2089"><a href="#check_header_from_file-2089"><span class="linenos">2089</span></a>                <span class="k">pass</span> <span class="c1"># was break</span>
</span><span id="check_header_from_file-2090"><a href="#check_header_from_file-2090"><span class="linenos">2090</span></a>
</span><span id="check_header_from_file-2091"><a href="#check_header_from_file-2091"><span class="linenos">2091</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="check_header_from_file-2092"><a href="#check_header_from_file-2092"><span class="linenos">2092</span></a>            <span class="n">prox_res</span> <span class="o">=</span> <span class="n">_chaina</span><span class="p">[</span><span class="n">proximal</span><span class="p">]</span>
</span><span id="check_header_from_file-2093"><a href="#check_header_from_file-2093"><span class="linenos">2093</span></a>            <span class="n">dist_res</span> <span class="o">=</span> <span class="n">_chainb</span><span class="p">[</span><span class="n">distal</span><span class="p">]</span>
</span><span id="check_header_from_file-2094"><a href="#check_header_from_file-2094"><span class="linenos">2094</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="check_header_from_file-2095"><a href="#check_header_from_file-2095"><span class="linenos">2095</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; ! Cannot parse SSBond record (KeyError): </span><span class="si">{</span><span class="n">struct_name</span><span class="si">}</span><span class="s1"> Prox: &lt;</span><span class="si">{</span><span class="n">proximal</span><span class="si">}</span><span class="s1">&gt; </span><span class="si">{</span><span class="n">chain1_id</span><span class="si">}</span><span class="s1"> Dist: &lt;</span><span class="si">{</span><span class="n">distal</span><span class="si">}</span><span class="s1">&gt; </span><span class="si">{</span><span class="n">chain2_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="check_header_from_file-2096"><a href="#check_header_from_file-2096"><span class="linenos">2096</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="check_header_from_file-2097"><a href="#check_header_from_file-2097"><span class="linenos">2097</span></a>        
</span><span id="check_header_from_file-2098"><a href="#check_header_from_file-2098"><span class="linenos">2098</span></a>        <span class="c1"># make a new Disulfide object, name them based on proximal and distal</span>
</span><span id="check_header_from_file-2099"><a href="#check_header_from_file-2099"><span class="linenos">2099</span></a>        <span class="c1"># initialize SS bond from the proximal, distal coordinates</span>
</span><span id="check_header_from_file-2100"><a href="#check_header_from_file-2100"><span class="linenos">2100</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">_chaina</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">_chainb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="check_header_from_file-2101"><a href="#check_header_from_file-2101"><span class="linenos">2101</span></a>            <span class="k">if</span> <span class="n">_chaina</span><span class="p">[</span><span class="n">proximal</span><span class="p">]</span><span class="o">.</span><span class="n">is_disordered</span><span class="p">()</span> <span class="ow">or</span> <span class="n">_chainb</span><span class="p">[</span><span class="n">distal</span><span class="p">]</span><span class="o">.</span><span class="n">is_disordered</span><span class="p">():</span>
</span><span id="check_header_from_file-2102"><a href="#check_header_from_file-2102"><span class="linenos">2102</span></a>                <span class="k">continue</span>
</span><span id="check_header_from_file-2103"><a href="#check_header_from_file-2103"><span class="linenos">2103</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="check_header_from_file-2104"><a href="#check_header_from_file-2104"><span class="linenos">2104</span></a>                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="check_header_from_file-2105"><a href="#check_header_from_file-2105"><span class="linenos">2105</span></a>                   <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; -&gt; SSBond: </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">struct_name</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">proximal</span><span class="si">}{</span><span class="n">chain1_id</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">distal</span><span class="si">}{</span><span class="n">chain2_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="check_header_from_file-2106"><a href="#check_header_from_file-2106"><span class="linenos">2106</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="check_header_from_file-2107"><a href="#check_header_from_file-2107"><span class="linenos">2107</span></a>            <span class="k">if</span> <span class="n">dbg</span><span class="p">:</span>
</span><span id="check_header_from_file-2108"><a href="#check_header_from_file-2108"><span class="linenos">2108</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; -&gt; NULL chain(s): </span><span class="si">{</span><span class="n">struct_name</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">proximal</span><span class="si">}{</span><span class="n">chain1_id</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">distal</span><span class="si">}{</span><span class="n">chain2_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="check_header_from_file-2109"><a href="#check_header_from_file-2109"><span class="linenos">2109</span></a>        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="check_header_from_file-2110"><a href="#check_header_from_file-2110"><span class="linenos">2110</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Checks the Disulfides by PDB ID and initializes the Disulfide objects.
Assumes the file is downloaded in the pdb_dir path.</p>

<p>NB: Requires EGS-Modified BIO.parse_pdb_header.py from <a href="https://github.com/suchanek/biopython/">https://github.com/suchanek/biopython/</a></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>struct_name</strong>:  the name of the PDB entry.</li>
<li><strong>pdb_dir</strong>:  path to the PDB files, defaults to <code>MODEL_DIR</code></li>
<li><strong>model_numb</strong>:  model number to use, defaults to 0 for single structure files.</li>
<li><strong>verbose</strong>:  print info while parsing</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>True if parsable</p>
</blockquote>

<p>Example:
  Assuming <code>MODEL_DIR</code> has the pdb5rsa.ent file we can load the disulfides
  with the following:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="">proteusPy.Disulfide</a></span> <span class="kn">import</span> <span class="n">Disulfide</span><span class="p">,</span> <span class="n">check_header_from_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MODEL_DIR</span> <span class="o">=</span> <span class="s1">&#39;/Users/egs/PDB/good/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">OK</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">OK</span> <span class="o">=</span> <span class="n">check_header_from_file</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">MODEL_DIR</span><span class="si">}</span><span class="s1">pdb5rsa.ent&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">-&gt; check_header_from_file() - Parsing file: /Users/egs/PDB/good/pdb5rsa.ent:</span>
<span class="go"> -&gt; SSBond: 1: tmp: 26A - 84A</span>
<span class="go"> -&gt; SSBond: 2: tmp: 40A - 95A</span>
<span class="go"> -&gt; SSBond: 3: tmp: 58A - 110A</span>
<span class="go"> -&gt; SSBond: 4: tmp: 65A - 72A</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">OK</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="check_header_from_id">
                            <input id="check_header_from_id-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_header_from_id</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">struct_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">pdb_dir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span>,</span><span class="param">	<span class="n">model_numb</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">dbg</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="check_header_from_id-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#check_header_from_id"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="check_header_from_id-2112"><a href="#check_header_from_id-2112"><span class="linenos">2112</span></a><span class="k">def</span> <span class="nf">check_header_from_id</span><span class="p">(</span><span class="n">struct_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pdb_dir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">model_numb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="check_header_from_id-2113"><a href="#check_header_from_id-2113"><span class="linenos">2113</span></a>                        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dbg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="check_header_from_id-2114"><a href="#check_header_from_id-2114"><span class="linenos">2114</span></a>    <span class="sd">&#39;&#39;&#39;</span>
</span><span id="check_header_from_id-2115"><a href="#check_header_from_id-2115"><span class="linenos">2115</span></a><span class="sd">    Checks parsability PDB ID and initializes the Disulfide objects.</span>
</span><span id="check_header_from_id-2116"><a href="#check_header_from_id-2116"><span class="linenos">2116</span></a><span class="sd">    Assumes the file is downloaded in ```MODEL_DIR``` path.</span>
</span><span id="check_header_from_id-2117"><a href="#check_header_from_id-2117"><span class="linenos">2117</span></a><span class="sd">    </span>
</span><span id="check_header_from_id-2118"><a href="#check_header_from_id-2118"><span class="linenos">2118</span></a><span class="sd">    NB: Requires EGS-Modified BIO.parse_pdb_header.py from https://github.com/suchanek/biopython/</span>
</span><span id="check_header_from_id-2119"><a href="#check_header_from_id-2119"><span class="linenos">2119</span></a>
</span><span id="check_header_from_id-2120"><a href="#check_header_from_id-2120"><span class="linenos">2120</span></a><span class="sd">    :param struct_name: the name of the PDB entry.</span>
</span><span id="check_header_from_id-2121"><a href="#check_header_from_id-2121"><span class="linenos">2121</span></a><span class="sd">    :param pdb_dir: path to the PDB files, defaults to PDB_DIR</span>
</span><span id="check_header_from_id-2122"><a href="#check_header_from_id-2122"><span class="linenos">2122</span></a><span class="sd">    :param model_numb: model number to use, defaults to 0 for single structure files.</span>
</span><span id="check_header_from_id-2123"><a href="#check_header_from_id-2123"><span class="linenos">2123</span></a><span class="sd">    :param verbose: print info while parsing</span>
</span><span id="check_header_from_id-2124"><a href="#check_header_from_id-2124"><span class="linenos">2124</span></a><span class="sd">    :param dbg: Debugging Flag</span>
</span><span id="check_header_from_id-2125"><a href="#check_header_from_id-2125"><span class="linenos">2125</span></a><span class="sd">    :return: True if OK, False otherwise</span>
</span><span id="check_header_from_id-2126"><a href="#check_header_from_id-2126"><span class="linenos">2126</span></a><span class="sd">    </span>
</span><span id="check_header_from_id-2127"><a href="#check_header_from_id-2127"><span class="linenos">2127</span></a><span class="sd">    Example:</span>
</span><span id="check_header_from_id-2128"><a href="#check_header_from_id-2128"><span class="linenos">2128</span></a><span class="sd">      Assuming the PDB_DIR has the pdb5rsa.ent file we can check the file thusly:</span>
</span><span id="check_header_from_id-2129"><a href="#check_header_from_id-2129"><span class="linenos">2129</span></a>
</span><span id="check_header_from_id-2130"><a href="#check_header_from_id-2130"><span class="linenos">2130</span></a><span class="sd">    &gt;&gt;&gt; from proteusPy.Disulfide import Disulfide, check_header_from_id</span>
</span><span id="check_header_from_id-2131"><a href="#check_header_from_id-2131"><span class="linenos">2131</span></a><span class="sd">    &gt;&gt;&gt; MODEL_DIR = &#39;/Users/egs/PDB/good/&#39;</span>
</span><span id="check_header_from_id-2132"><a href="#check_header_from_id-2132"><span class="linenos">2132</span></a><span class="sd">    &gt;&gt;&gt; OK = False</span>
</span><span id="check_header_from_id-2133"><a href="#check_header_from_id-2133"><span class="linenos">2133</span></a><span class="sd">    &gt;&gt;&gt; OK = check_header_from_id(&#39;5rsa&#39;, pdb_dir=MODEL_DIR, verbose=True)</span>
</span><span id="check_header_from_id-2134"><a href="#check_header_from_id-2134"><span class="linenos">2134</span></a><span class="sd">     -&gt; SSBond: 1: 5rsa: 26A - 84A</span>
</span><span id="check_header_from_id-2135"><a href="#check_header_from_id-2135"><span class="linenos">2135</span></a><span class="sd">     -&gt; SSBond: 2: 5rsa: 40A - 95A</span>
</span><span id="check_header_from_id-2136"><a href="#check_header_from_id-2136"><span class="linenos">2136</span></a><span class="sd">     -&gt; SSBond: 3: 5rsa: 58A - 110A</span>
</span><span id="check_header_from_id-2137"><a href="#check_header_from_id-2137"><span class="linenos">2137</span></a><span class="sd">     -&gt; SSBond: 4: 5rsa: 65A - 72A</span>
</span><span id="check_header_from_id-2138"><a href="#check_header_from_id-2138"><span class="linenos">2138</span></a><span class="sd">    &gt;&gt;&gt; OK</span>
</span><span id="check_header_from_id-2139"><a href="#check_header_from_id-2139"><span class="linenos">2139</span></a><span class="sd">    True</span>
</span><span id="check_header_from_id-2140"><a href="#check_header_from_id-2140"><span class="linenos">2140</span></a><span class="sd">   &#39;&#39;&#39;</span>
</span><span id="check_header_from_id-2141"><a href="#check_header_from_id-2141"><span class="linenos">2141</span></a>
</span><span id="check_header_from_id-2142"><a href="#check_header_from_id-2142"><span class="linenos">2142</span></a>    <span class="n">parser</span> <span class="o">=</span> <span class="n">PDBParser</span><span class="p">(</span><span class="n">PERMISSIVE</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">QUIET</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="check_header_from_id-2143"><a href="#check_header_from_id-2143"><span class="linenos">2143</span></a>    <span class="n">structure</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="n">struct_name</span><span class="p">,</span> 
</span><span id="check_header_from_id-2144"><a href="#check_header_from_id-2144"><span class="linenos">2144</span></a>    								 <span class="n">file</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pdb_dir</span><span class="si">}</span><span class="s1">pdb</span><span class="si">{</span><span class="n">struct_name</span><span class="si">}</span><span class="s1">.ent&#39;</span><span class="p">)</span>
</span><span id="check_header_from_id-2145"><a href="#check_header_from_id-2145"><span class="linenos">2145</span></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">structure</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="check_header_from_id-2146"><a href="#check_header_from_id-2146"><span class="linenos">2146</span></a>
</span><span id="check_header_from_id-2147"><a href="#check_header_from_id-2147"><span class="linenos">2147</span></a>    <span class="n">ssbond_dict</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;ssbond&#39;</span><span class="p">]</span> <span class="c1"># NB: this requires the modified code</span>
</span><span id="check_header_from_id-2148"><a href="#check_header_from_id-2148"><span class="linenos">2148</span></a>
</span><span id="check_header_from_id-2149"><a href="#check_header_from_id-2149"><span class="linenos">2149</span></a>    <span class="n">bondlist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="check_header_from_id-2150"><a href="#check_header_from_id-2150"><span class="linenos">2150</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="check_header_from_id-2151"><a href="#check_header_from_id-2151"><span class="linenos">2151</span></a>
</span><span id="check_header_from_id-2152"><a href="#check_header_from_id-2152"><span class="linenos">2152</span></a>    <span class="c1"># get a list of tuples containing the proximal, distal residue IDs for </span>
</span><span id="check_header_from_id-2153"><a href="#check_header_from_id-2153"><span class="linenos">2153</span></a>    <span class="c1"># all SSBonds in the chain.</span>
</span><span id="check_header_from_id-2154"><a href="#check_header_from_id-2154"><span class="linenos">2154</span></a>    <span class="n">bondlist</span> <span class="o">=</span> <span class="n">parse_ssbond_header_rec</span><span class="p">(</span><span class="n">ssbond_dict</span><span class="p">)</span>
</span><span id="check_header_from_id-2155"><a href="#check_header_from_id-2155"><span class="linenos">2155</span></a>    
</span><span id="check_header_from_id-2156"><a href="#check_header_from_id-2156"><span class="linenos">2156</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bondlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="check_header_from_id-2157"><a href="#check_header_from_id-2157"><span class="linenos">2157</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">verbose</span><span class="p">):</span>
</span><span id="check_header_from_id-2158"><a href="#check_header_from_id-2158"><span class="linenos">2158</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; check_header_from_id(): no bonds found in bondlist.&#39;</span><span class="p">)</span>
</span><span id="check_header_from_id-2159"><a href="#check_header_from_id-2159"><span class="linenos">2159</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="check_header_from_id-2160"><a href="#check_header_from_id-2160"><span class="linenos">2160</span></a>    
</span><span id="check_header_from_id-2161"><a href="#check_header_from_id-2161"><span class="linenos">2161</span></a>    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">bondlist</span><span class="p">:</span>
</span><span id="check_header_from_id-2162"><a href="#check_header_from_id-2162"><span class="linenos">2162</span></a>        <span class="c1"># in the form (proximal, distal, chain)</span>
</span><span id="check_header_from_id-2163"><a href="#check_header_from_id-2163"><span class="linenos">2163</span></a>        <span class="n">proximal</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="check_header_from_id-2164"><a href="#check_header_from_id-2164"><span class="linenos">2164</span></a>        <span class="n">distal</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="check_header_from_id-2165"><a href="#check_header_from_id-2165"><span class="linenos">2165</span></a>        <span class="n">chain1</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="check_header_from_id-2166"><a href="#check_header_from_id-2166"><span class="linenos">2166</span></a>        <span class="n">chain2</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="check_header_from_id-2167"><a href="#check_header_from_id-2167"><span class="linenos">2167</span></a>
</span><span id="check_header_from_id-2168"><a href="#check_header_from_id-2168"><span class="linenos">2168</span></a>        <span class="n">chaina</span> <span class="o">=</span> <span class="n">model</span><span class="p">[</span><span class="n">chain1</span><span class="p">]</span>
</span><span id="check_header_from_id-2169"><a href="#check_header_from_id-2169"><span class="linenos">2169</span></a>        <span class="n">chainb</span> <span class="o">=</span> <span class="n">model</span><span class="p">[</span><span class="n">chain2</span><span class="p">]</span>
</span><span id="check_header_from_id-2170"><a href="#check_header_from_id-2170"><span class="linenos">2170</span></a>
</span><span id="check_header_from_id-2171"><a href="#check_header_from_id-2171"><span class="linenos">2171</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="check_header_from_id-2172"><a href="#check_header_from_id-2172"><span class="linenos">2172</span></a>            <span class="n">prox_residue</span> <span class="o">=</span> <span class="n">chaina</span><span class="p">[</span><span class="n">proximal</span><span class="p">]</span>
</span><span id="check_header_from_id-2173"><a href="#check_header_from_id-2173"><span class="linenos">2173</span></a>            <span class="n">dist_residue</span> <span class="o">=</span> <span class="n">chainb</span><span class="p">[</span><span class="n">distal</span><span class="p">]</span>
</span><span id="check_header_from_id-2174"><a href="#check_header_from_id-2174"><span class="linenos">2174</span></a>            
</span><span id="check_header_from_id-2175"><a href="#check_header_from_id-2175"><span class="linenos">2175</span></a>            <span class="n">prox_residue</span><span class="o">.</span><span class="n">disordered_select</span><span class="p">(</span><span class="s2">&quot;CYS&quot;</span><span class="p">)</span>
</span><span id="check_header_from_id-2176"><a href="#check_header_from_id-2176"><span class="linenos">2176</span></a>            <span class="n">dist_residue</span><span class="o">.</span><span class="n">disordered_select</span><span class="p">(</span><span class="s2">&quot;CYS&quot;</span><span class="p">)</span>
</span><span id="check_header_from_id-2177"><a href="#check_header_from_id-2177"><span class="linenos">2177</span></a>
</span><span id="check_header_from_id-2178"><a href="#check_header_from_id-2178"><span class="linenos">2178</span></a>            <span class="k">if</span> <span class="n">prox_residue</span><span class="o">.</span><span class="n">get_resname</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;CYS&#39;</span> <span class="ow">or</span> <span class="n">dist_residue</span><span class="o">.</span><span class="n">get_resname</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;CYS&#39;</span><span class="p">:</span>
</span><span id="check_header_from_id-2179"><a href="#check_header_from_id-2179"><span class="linenos">2179</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">verbose</span><span class="p">):</span>
</span><span id="check_header_from_id-2180"><a href="#check_header_from_id-2180"><span class="linenos">2180</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;build_disulfide() requires CYS at both residues:</span><span class="se">\</span>
</span><span id="check_header_from_id-2181"><a href="#check_header_from_id-2181"><span class="linenos">2181</span></a><span class="s1">                     </span><span class="si">{</span><span class="n">prox_residue</span><span class="o">.</span><span class="n">get_resname</span><span class="p">()</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">dist_residue</span><span class="o">.</span><span class="n">get_resname</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="check_header_from_id-2182"><a href="#check_header_from_id-2182"><span class="linenos">2182</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="check_header_from_id-2183"><a href="#check_header_from_id-2183"><span class="linenos">2183</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="check_header_from_id-2184"><a href="#check_header_from_id-2184"><span class="linenos">2184</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">dbg</span><span class="p">):</span>
</span><span id="check_header_from_id-2185"><a href="#check_header_from_id-2185"><span class="linenos">2185</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Keyerror: </span><span class="si">{</span><span class="n">struct_name</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">proximal</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">chain1</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">distal</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">chain2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="check_header_from_id-2186"><a href="#check_header_from_id-2186"><span class="linenos">2186</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="check_header_from_id-2187"><a href="#check_header_from_id-2187"><span class="linenos">2187</span></a> 
</span><span id="check_header_from_id-2188"><a href="#check_header_from_id-2188"><span class="linenos">2188</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="check_header_from_id-2189"><a href="#check_header_from_id-2189"><span class="linenos">2189</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; -&gt; SSBond: </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">struct_name</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">proximal</span><span class="si">}{</span><span class="n">chain1</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">distal</span><span class="si">}{</span><span class="n">chain2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="check_header_from_id-2190"><a href="#check_header_from_id-2190"><span class="linenos">2190</span></a>
</span><span id="check_header_from_id-2191"><a href="#check_header_from_id-2191"><span class="linenos">2191</span></a>        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="check_header_from_id-2192"><a href="#check_header_from_id-2192"><span class="linenos">2192</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Checks parsability PDB ID and initializes the Disulfide objects.
Assumes the file is downloaded in <code>MODEL_DIR</code> path.</p>

<p>NB: Requires EGS-Modified BIO.parse_pdb_header.py from <a href="https://github.com/suchanek/biopython/">https://github.com/suchanek/biopython/</a></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>struct_name</strong>:  the name of the PDB entry.</li>
<li><strong>pdb_dir</strong>:  path to the PDB files, defaults to PDB_DIR</li>
<li><strong>model_numb</strong>:  model number to use, defaults to 0 for single structure files.</li>
<li><strong>verbose</strong>:  print info while parsing</li>
<li><strong>dbg</strong>:  Debugging Flag</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>True if OK, False otherwise</p>
</blockquote>

<p>Example:
  Assuming the PDB_DIR has the pdb5rsa.ent file we can check the file thusly:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="">proteusPy.Disulfide</a></span> <span class="kn">import</span> <span class="n">Disulfide</span><span class="p">,</span> <span class="n">check_header_from_id</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MODEL_DIR</span> <span class="o">=</span> <span class="s1">&#39;/Users/egs/PDB/good/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">OK</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">OK</span> <span class="o">=</span> <span class="n">check_header_from_id</span><span class="p">(</span><span class="s1">&#39;5rsa&#39;</span><span class="p">,</span> <span class="n">pdb_dir</span><span class="o">=</span><span class="n">MODEL_DIR</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go"> -&gt; SSBond: 1: 5rsa: 26A - 84A</span>
<span class="go"> -&gt; SSBond: 2: 5rsa: 40A - 95A</span>
<span class="go"> -&gt; SSBond: 3: 5rsa: 58A - 110A</span>
<span class="go"> -&gt; SSBond: 4: 5rsa: 65A - 72A</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">OK</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>