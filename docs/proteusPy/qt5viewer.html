<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>proteusPy.qt5viewer API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../proteusPy.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;proteusPy</a>

            <img src="./logo.png" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#can_import">can_import</a>
            </li>
            <li>
                    <a class="class" href="#DisulfideViewer">DisulfideViewer</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DisulfideViewer.__init__">DisulfideViewer</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.colors">colors</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.timer">timer</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.current_frame">current_frame</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.ss_list">ss_list</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.current_ss">current_ss</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.current_pdb_id">current_pdb_id</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.current_style">current_style</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.single">single</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.current_sslist">current_sslist</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.ss_dict">ss_dict</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.button_cpk">button_cpk</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.button_sb">button_sb</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.button_bs">button_bs</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.button_pd">button_pd</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.pdb_textbox">pdb_textbox</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.pdb_dropdown">pdb_dropdown</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.dropdown">dropdown</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.button_theme">button_theme</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.checkbox_single">checkbox_single</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.button_reset">button_reset</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.button_spin">button_spin</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.plotter_widget">plotter_widget</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideViewer.current_theme">current_theme</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideViewer.set_camera_view">set_camera_view</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideViewer.spin_camera">spin_camera</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideViewer.reset">reset</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideViewer.add_floor">add_floor</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideViewer.update_style">update_style</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideViewer.on_pdb_textbox_enter">on_pdb_textbox_enter</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideViewer.on_pdb_dropdown_change">on_pdb_dropdown_change</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideViewer.update_pdb_selection">update_pdb_selection</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideViewer.on_dropdown_change">on_dropdown_change</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideViewer.on_checkbox_single_change">on_checkbox_single_change</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideViewer.update_camera_position">update_camera_position</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideViewer.toggle_theme">toggle_theme</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideViewer.apply_theme">apply_theme</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideViewer.create_menubar">create_menubar</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideViewer.save_screenshot">save_screenshot</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideViewer.export_scene">export_scene</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideViewer.add_custom_lights">add_custom_lights</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideViewer.new_plotter">new_plotter</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideViewer.display">display</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideViewer.display_overlay">display_overlay</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#main">main</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../proteusPy.html">proteusPy</a><wbr>.qt5viewer    </h1>

                        <div class="docstring"><p>Disulfide Structure Viewer</p>

<p>This program is a PyQt5-based application for viewing molecular structures with support for
multiple disulfide bonds and various rendering styles. It uses PyVista for 3D visualization
and PyQt5 for the graphical user interface. The application allows users to toggle between
different rendering styles, switch between light and dark themes, and save or export the
visualized scenes.</p>

<p>Modules:
    os: Provides a way of using operating system dependent functionality.
    sys: Provides access to some variables used or maintained by the interpreter.
    pyvista: A 3D plotting and mesh analysis through a streamlined interface for the Visualization 
    Toolkit (VTK).
    PyQt5.QtWidgets: Provides a set of UI elements to create classic desktop-style user interfaces.
    pyvistaqt: Provides a PyQt5 widget for embedding PyVista plots.
    proteusPy: Custom module for loading PDB files and getting macOS theme.</p>

<p>Classes:
    DisulfideViewer: Main window class for the molecular structure viewer application.</p>

<p>Functions:
    main: The main entry point of the application.</p>
</div>

                        <input id="mod-qt5viewer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-qt5viewer-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">Disulfide Structure Viewer</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">This program is a PyQt5-based application for viewing molecular structures with support for</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">multiple disulfide bonds and various rendering styles. It uses PyVista for 3D visualization</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">and PyQt5 for the graphical user interface. The application allows users to toggle between</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">different rendering styles, switch between light and dark themes, and save or export the</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">visualized scenes.</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="sd">Modules:</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="sd">    os: Provides a way of using operating system dependent functionality.</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="sd">    sys: Provides access to some variables used or maintained by the interpreter.</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="sd">    pyvista: A 3D plotting and mesh analysis through a streamlined interface for the Visualization </span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="sd">    Toolkit (VTK).</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="sd">    PyQt5.QtWidgets: Provides a set of UI elements to create classic desktop-style user interfaces.</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="sd">    pyvistaqt: Provides a PyQt5 widget for embedding PyVista plots.</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="sd">    proteusPy: Custom module for loading PDB files and getting macOS theme.</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="sd">Classes:</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="sd">    DisulfideViewer: Main window class for the molecular structure viewer application.</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="sd">Functions:</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd">    main: The main entry point of the application.</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="c1"># pylint: disable=W0212</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="c1"># pylint: disable=E0401</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="c1"># pylint: disable=C0413</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="kn">import</span> <span class="nn">logging</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="kn">import</span> <span class="nn">os</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="kn">import</span> <span class="nn">sys</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="kn">import</span> <span class="nn">pyvista</span> <span class="k">as</span> <span class="nn">pv</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="k">def</span> <span class="nf">can_import</span><span class="p">(</span><span class="n">module_name</span><span class="p">):</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check we can import the requested module.&quot;&quot;&quot;</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>        <span class="k">return</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="c1"># Check if PyQt5 is installed</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="k">if</span> <span class="n">can_import</span><span class="p">(</span><span class="s2">&quot;PyQt5&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>        <span class="s2">&quot;This program requires PyQt5 to be installed. &quot;</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>        <span class="s2">&quot;Please install it using: pip install proteusPy[pyqt5]&quot;</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>    <span class="p">)</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="n">Qt</span><span class="p">,</span> <span class="n">QTimer</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="kn">from</span> <span class="nn">PyQt5.QtGui</span> <span class="kn">import</span> <span class="n">QFont</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="c1"># pylint: disable=E0611</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>    <span class="n">QAction</span><span class="p">,</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>    <span class="n">QApplication</span><span class="p">,</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>    <span class="n">QCheckBox</span><span class="p">,</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>    <span class="n">QComboBox</span><span class="p">,</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>    <span class="n">QFileDialog</span><span class="p">,</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>    <span class="n">QGroupBox</span><span class="p">,</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>    <span class="n">QHBoxLayout</span><span class="p">,</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>    <span class="n">QLineEdit</span><span class="p">,</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>    <span class="n">QMainWindow</span><span class="p">,</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>    <span class="n">QMessageBox</span><span class="p">,</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>    <span class="n">QPushButton</span><span class="p">,</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>    <span class="n">QSizePolicy</span><span class="p">,</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>    <span class="n">QSpacerItem</span><span class="p">,</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>    <span class="n">QVBoxLayout</span><span class="p">,</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>    <span class="n">QWidget</span><span class="p">,</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="p">)</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="kn">from</span> <span class="nn">pyvistaqt</span> <span class="kn">import</span> <span class="n">QtInteractor</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="kn">from</span> <span class="nn">proteusPy</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>    <span class="n">BOND_RADIUS</span><span class="p">,</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>    <span class="n">DisulfideList</span><span class="p">,</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>    <span class="n">Load_PDB_SS</span><span class="p">,</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>    <span class="n">configure_master_logger</span><span class="p">,</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>    <span class="n">create_logger</span><span class="p">,</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>    <span class="n">get_jet_colormap</span><span class="p">,</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>    <span class="n">get_theme</span><span class="p">,</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="p">)</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;QT_IM_MODULE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;qtvirtualkeyboard&quot;</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="n">_version</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="n">_logger</span> <span class="o">=</span> <span class="n">create_logger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="n">configure_master_logger</span><span class="p">(</span><span class="s2">&quot;viewer.py&quot;</span><span class="p">)</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting Disulfide Viewer...&quot;</span><span class="p">)</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="k">class</span> <span class="nc">DisulfideViewer</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">    A PyQt5-based application for viewing molecular structures with support for</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">    multiple disulfide bonds and various rendering styles.</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">    Attributes:</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">        ss_list (list): List of disulfide bond objects.</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">        current_ss (object): Currently selected disulfide bond.</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">        current_style (str): Currently selected rendering style.</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">        plotter_widget (QtInteractor): PyVista QtInteractor widget for 3D visualization.</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">        ss_dict (dict): Dictionary where keys are pdb_id and values are lists of disulfides</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">        with that pdb_id.</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ss_list</span><span class="p">,</span> <span class="n">winsize</span><span class="o">=</span><span class="p">(</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">800</span><span class="p">)):</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">        Initializes the MolecularViewer application.</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">        Parameters:</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">            ss_list (list): List of disulfide bond objects.</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">            winsize (tuple): Minimum size for the PyVista plotter widget.</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>        <span class="c1"># Define color dictionary</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">colors</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>            <span class="s2">&quot;dark&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>                <span class="s2">&quot;background&quot;</span><span class="p">:</span> <span class="s2">&quot;#2E2E2E&quot;</span><span class="p">,</span>  <span class="c1"># Dark Gray</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>                <span class="s2">&quot;midnight_blue&quot;</span><span class="p">:</span> <span class="s2">&quot;#191970&quot;</span><span class="p">,</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>                <span class="s2">&quot;dark_slate_gray&quot;</span><span class="p">:</span> <span class="s2">&quot;#2F4F4F&quot;</span><span class="p">,</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>                <span class="s2">&quot;charcoal&quot;</span><span class="p">:</span> <span class="s2">&quot;#36454F&quot;</span><span class="p">,</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>                <span class="s2">&quot;deep_space_sparkle&quot;</span><span class="p">:</span> <span class="s2">&quot;#4A646C&quot;</span><span class="p">,</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>                <span class="s2">&quot;black&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>            <span class="p">},</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>            <span class="s2">&quot;light&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>                <span class="s2">&quot;background&quot;</span><span class="p">:</span> <span class="s2">&quot;#FFFFFF&quot;</span><span class="p">,</span>  <span class="c1"># White</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>                <span class="s2">&quot;light_gray&quot;</span><span class="p">:</span> <span class="s2">&quot;#D3D3D3&quot;</span><span class="p">,</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>                <span class="s2">&quot;ivory&quot;</span><span class="p">:</span> <span class="s2">&quot;#FFFFF0&quot;</span><span class="p">,</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>                <span class="s2">&quot;honeydew&quot;</span><span class="p">:</span> <span class="s2">&quot;#F0FFF0&quot;</span><span class="p">,</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>                <span class="s2">&quot;azure&quot;</span><span class="p">:</span> <span class="s2">&quot;#F0FFFF&quot;</span><span class="p">,</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>            <span class="p">},</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>        <span class="p">}</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>        <span class="c1"># Set up the main window</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_version</span> <span class="o">=</span> <span class="n">_version</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;proteusPy Disulfide Viewer&quot;</span><span class="p">)</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">winsize</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">winsize</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_frame</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>        <span class="c1"># Validate and store the list of disulfides</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span> <span class="o">=</span> <span class="n">ss_list</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdb_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_style</span> <span class="o">=</span> <span class="s2">&quot;sb&quot;</span>  <span class="c1"># Initialize with default style</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">single</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>        <span class="c1"># Create a dictionary where keys are pdb_id and values are lists of disulfides</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>        <span class="c1"># with that pdb_id</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s2">&quot;sublist&quot;</span><span class="p">)</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>        <span class="c1"># Populate the dictionary with key pdb_id and values list of disulfides</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>        <span class="c1"># for that pdb_id</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>        <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span><span class="p">:</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>            <span class="k">if</span> <span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="p">:</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="p">[</span><span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="p">[</span><span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>        <span class="c1"># Create buttons for different rendering styles</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_cpk</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;CPK&quot;</span><span class="p">)</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_sb</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;SB&quot;</span><span class="p">)</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_bs</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;BS&quot;</span><span class="p">)</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_pd</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;PD&quot;</span><span class="p">)</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>        <span class="c1"># Connect buttons to methods with style tracking</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_cpk</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_style</span><span class="p">(</span><span class="s2">&quot;cpk&quot;</span><span class="p">))</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_sb</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_style</span><span class="p">(</span><span class="s2">&quot;sb&quot;</span><span class="p">))</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_bs</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_style</span><span class="p">(</span><span class="s2">&quot;bs&quot;</span><span class="p">))</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_pd</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_style</span><span class="p">(</span><span class="s2">&quot;pd&quot;</span><span class="p">))</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>        <span class="c1"># Create a text box for entering PDB IDs</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s2">&quot;Enter PDB ID&quot;</span><span class="p">)</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span><span class="o">.</span><span class="n">returnPressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_pdb_textbox_enter</span><span class="p">)</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>        <span class="c1"># Create a dropdown selector for PDB IDs</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_pdb_dropdown_change</span><span class="p">)</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>        <span class="c1"># Create a dropdown selector for Disulfides</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">ss</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span><span class="p">])</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_dropdown_change</span><span class="p">)</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>        <span class="c1"># Create a button to toggle themes</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_theme</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Toggle Theme&quot;</span><span class="p">)</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_theme</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_theme</span><span class="p">)</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>        <span class="c1"># Create a checkbox for single/multiple display</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">checkbox_single</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Single&quot;</span><span class="p">)</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">checkbox_single</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">checkbox_single</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_checkbox_single_change</span><span class="p">)</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_reset</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Reset Camera&quot;</span><span class="p">)</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_reset</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_camera_view</span><span class="p">)</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>        <span class="c1"># Create a font object with increased size</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>        <span class="n">font</span> <span class="o">=</span> <span class="n">QFont</span><span class="p">()</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>        <span class="n">font</span><span class="o">.</span><span class="n">setPointSize</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>  <span class="c1"># Set the desired font size</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>        <span class="c1"># Group the PDB controls</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>        <span class="n">pdb_groupbox</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;PDB Controls&quot;</span><span class="p">)</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>        <span class="n">pdb_groupbox</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>  <span class="c1"># Set the font for the groupbox label</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>        <span class="n">pdb_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>        <span class="n">pdb_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span><span class="p">)</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>        <span class="n">pdb_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span><span class="p">)</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>        <span class="n">pdb_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="p">)</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>        <span class="n">pdb_groupbox</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">pdb_layout</span><span class="p">)</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>        <span class="c1"># Group the buttons with a label</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>        <span class="n">button_group</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Rendering Styles&quot;</span><span class="p">)</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>        <span class="n">button_group</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>  <span class="c1"># Set the font for the groupbox label</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>        <span class="n">button_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_cpk</span><span class="p">)</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_sb</span><span class="p">)</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_bs</span><span class="p">)</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_pd</span><span class="p">)</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkbox_single</span><span class="p">)</span>  <span class="c1"># Add single/multiple checkbox</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_spin</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Spin Molecule&quot;</span><span class="p">)</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_spin</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spin_camera</span><span class="p">)</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_spin</span><span class="p">)</span>  <span class="c1"># Add spin camera button</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>        <span class="c1"># button_layout.addWidget(self.button_cov)</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>        <span class="n">button_group</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">button_layout</span><span class="p">)</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>        <span class="c1"># Layout for the main controls</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>        <span class="n">control_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">button_group</span><span class="p">)</span>  <span class="c1"># Add button group</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addSpacerItem</span><span class="p">(</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>            <span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">)</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>        <span class="p">)</span>  <span class="c1"># Add spacer</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">pdb_groupbox</span><span class="p">)</span>  <span class="c1"># Add PDB groupbox</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addSpacerItem</span><span class="p">(</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>            <span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">)</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>        <span class="p">)</span>  <span class="c1"># Add spacer</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_theme</span><span class="p">)</span>  <span class="c1"># Add theme toggle button</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_reset</span><span class="p">)</span>  <span class="c1"># Add Reset button</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>        <span class="c1"># Create a QWidget for the controls</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>        <span class="n">control_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>        <span class="n">control_widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">control_layout</span><span class="p">)</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>        <span class="c1"># Create the PyVista QtInteractor widget for 3D visualization</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span> <span class="o">=</span> <span class="n">QtInteractor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>        <span class="c1"># self.plotter_widget.setMinimumSize(*winsize)</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>        <span class="c1"># Create sliders for camera control</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a><span class="sd">        self.slider_x = QSlider(Qt.Horizontal)</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a><span class="sd">        self.slider_x.setRange(-100, 100)</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a><span class="sd">        self.slider_x.setValue(0)</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a><span class="sd">        self.slider_x.valueChanged.connect(self.update_camera_position)</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a><span class="sd">        self.slider_y = QSlider(Qt.Vertical)</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a><span class="sd">        self.slider_y.setRange(-100, 100)</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a><span class="sd">        self.slider_y.setValue(0)</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a><span class="sd">        self.slider_y.valueChanged.connect(self.update_camera_position)</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_spin</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Spin Camera&quot;</span><span class="p">)</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_spin</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spin_camera</span><span class="p">)</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>        <span class="c1"># Main layout combining controls and visualization</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>        <span class="n">main_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>        <span class="n">main_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">control_widget</span><span class="p">)</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>        <span class="n">main_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>        <span class="c1"># main_layout.addWidget(self.slider_y)  # Add vertical slider</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>        <span class="c1"># Set the central widget</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>        <span class="n">container</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>        <span class="n">container</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">main_layout</span><span class="p">)</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>        <span class="n">bottom_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>        <span class="n">bottom_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>        <span class="c1"># bottom_layout.addWidget(self.slider_x)  # Add horizontal slider</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>        <span class="n">main_container</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>        <span class="n">main_container</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">bottom_layout</span><span class="p">)</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="n">main_container</span><span class="p">)</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>        <span class="c1"># Status Bar for user feedback</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Displaying: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>        <span class="c1"># Initialize the theme</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_theme</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span>  <span class="c1"># Default theme</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">apply_theme</span><span class="p">()</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>        <span class="c1"># Create the menubar</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">create_menubar</span><span class="p">()</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>        <span class="c1"># Force a refresh on the disulfide list dropdown</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_camera_view</span><span class="p">()</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_pdb_dropdown_change</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>        <span class="c1"># Initial display</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>        <span class="c1"># self.display()  # Set a default view with current style</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>    <span class="k">def</span> <span class="nf">set_camera_view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a><span class="sd">        Sets the camera to a specific view where the x-axis is pointed down and the</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a><span class="sd">        y-axis into the screen.</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>        <span class="n">camera_position</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>  <span class="c1"># Example values</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">camera_position</span> <span class="o">=</span> <span class="n">camera_position</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>    <span class="k">def</span> <span class="nf">spin_camera</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_frames</span><span class="o">=</span><span class="mi">150</span><span class="p">):</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a><span class="sd">        Spins the camera around the z-axis in an orbital path.</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a><span class="sd">        :param duration: Duration of the spin in seconds.</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a><span class="sd">        :param n_frames: Number of frames for the animation.</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>        <span class="c1"># Define the circular path around the z-axis</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_frames</span><span class="p">)</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">theta</span><span class="p">)]</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>        <span class="n">duration</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>        <span class="c1"># Function to update the camera position</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>        <span class="k">def</span> <span class="nf">update_camera</span><span class="p">():</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">camera_position</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_frame</span><span class="p">]</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_frame</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_frame</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n_frames</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>        <span class="c1"># Create a QTimer to update the camera position</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span> <span class="o">=</span> <span class="n">QTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">update_camera</span><span class="p">)</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_frame</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>        <span class="c1"># Function to stop the timer after the duration</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>        <span class="k">def</span> <span class="nf">stop_timer</span><span class="p">():</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>        <span class="c1"># Start the timer</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>        <span class="n">interval</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">/</span> <span class="n">n_frames</span><span class="p">)</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>        <span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">stop_timer</span><span class="p">)</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a><span class="sd">        Resets all widgets and data structures to their default state.</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Resetting...&quot;</span><span class="p">)</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">checkbox_single</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_style</span> <span class="o">=</span> <span class="s2">&quot;sb&quot;</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdb_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_camera_view</span><span class="p">()</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_pdb_dropdown_change</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>    <span class="k">def</span> <span class="nf">add_floor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotter</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)):</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a><span class="sd">        Adds a simple plane beneath the disulfide bond to act as a &#39;floor&#39;.</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a><span class="sd">        :param plotter: The PyVista plotter to add the floor to.</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a><span class="sd">        :type plotter: pv.Plotter</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="sd">        :param size: The size of the floor plane.</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a><span class="sd">        :type size: float</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a><span class="sd">        :param position: The position of the floor plane.</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a><span class="sd">        :type position: tuple</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>        <span class="n">floor</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plane</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">i_size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">j_size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">floor</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>    <span class="k">def</span> <span class="nf">update_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">):</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a><span class="sd">        Updates the current rendering style and refreshes the visualization.</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a><span class="sd">        :param style: The rendering style to apply (e.g., &#39;cpk&#39;, &#39;sb&#39;).</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="sd">        :type style: str</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_style</span> <span class="o">=</span> <span class="n">style</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">checkbox_single</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Ensure the &quot;Single&quot; checkbox is checked</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>    <span class="k">def</span> <span class="nf">on_pdb_textbox_enter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a><span class="sd">        Handles the event when the user presses Enter in the PDB ID text box.</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>        <span class="n">pdb_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>        <span class="k">if</span> <span class="n">pdb_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="p">:</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_pdb_selection</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">)</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>                <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Invalid PDB ID&quot;</span><span class="p">,</span> <span class="s2">&quot;The entered PDB ID is not valid.&quot;</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>            <span class="p">)</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>        <span class="n">disulfides</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">ss</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">disulfides</span><span class="p">])</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">disulfides</span><span class="p">),</span> <span class="s2">&quot;sub&quot;</span><span class="p">)</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">)</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>    <span class="k">def</span> <span class="nf">on_pdb_dropdown_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a><span class="sd">        Handles the event when the PDB ID dropdown selection changes.</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a><span class="sd">        Parameters:</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a><span class="sd">            index (int): The index of the selected item in the PDB ID dropdown.</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>        <span class="n">pdb_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">)</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>        <span class="n">disulfides</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>        <span class="k">if</span> <span class="n">disulfides</span><span class="p">:</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">ss</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">disulfides</span><span class="p">])</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span> <span class="o">=</span> <span class="n">disulfides</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">disulfides</span><span class="p">),</span> <span class="s2">&quot;sublist&quot;</span><span class="p">)</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Displaying: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No Disulfides: </span><span class="si">{</span><span class="n">pdb_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>    <span class="k">def</span> <span class="nf">update_pdb_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdb_id</span><span class="p">):</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a><span class="sd">        Updates the current PDB selection and refreshes the disulfide dropdown.</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a><span class="sd">        :param pdb_id: The PDB ID to select.</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a><span class="sd">        :type pdb_id: str</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdb_id</span> <span class="o">=</span> <span class="n">pdb_id</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>        <span class="n">disulfides</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">disulfides</span><span class="p">),</span> <span class="s2">&quot;sublist2&quot;</span><span class="p">)</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">ss</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span><span class="p">])</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>    <span class="k">def</span> <span class="nf">on_dropdown_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a><span class="sd">        Handles the event when the dropdown selection changes.</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a><span class="sd">        Parameters:</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a><span class="sd">            index (int): The index of the selected item in the dropdown.</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>        <span class="n">selected_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>            <span class="p">(</span><span class="n">ss</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span> <span class="k">if</span> <span class="n">ss</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">selected_name</span><span class="p">),</span> <span class="kc">None</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>        <span class="p">)</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Displaying: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>    <span class="k">def</span> <span class="nf">on_checkbox_single_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a><span class="sd">        Handles the event when the single/multiple checkbox state changes.</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a><span class="sd">        Parameters:</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a><span class="sd">            state (int): The state of the checkbox (Qt.Checked or Qt.Unchecked).</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">single</span> <span class="o">=</span> <span class="n">state</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># Use the current style</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>    <span class="k">def</span> <span class="nf">update_camera_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a><span class="sd">        Update the camera position based on the slider values.</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slider_x</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slider_y</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">camera_position</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>    <span class="k">def</span> <span class="nf">toggle_theme</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a><span class="sd">        Toggle between light and dark themes.</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_theme</span> <span class="o">==</span> <span class="s2">&quot;dark&quot;</span><span class="p">:</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_theme</span> <span class="o">=</span> <span class="s2">&quot;light&quot;</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_theme</span> <span class="o">=</span> <span class="s2">&quot;dark&quot;</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">apply_theme</span><span class="p">()</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>    <span class="k">def</span> <span class="nf">apply_theme</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a><span class="sd">        Apply the current theme to the plotter widget.</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_theme</span> <span class="o">==</span> <span class="s2">&quot;dark&quot;</span><span class="p">:</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">set_background</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="s2">&quot;dark&quot;</span><span class="p">][</span><span class="s2">&quot;background&quot;</span><span class="p">])</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">set_background</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="s2">&quot;light&quot;</span><span class="p">][</span><span class="s2">&quot;background&quot;</span><span class="p">])</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>        <span class="c1"># Render the plotter to apply the changes</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>    <span class="k">def</span> <span class="nf">create_menubar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a><span class="sd">        Creates the menubar</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>        <span class="n">menubar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>        <span class="c1"># File menu</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>        <span class="n">file_menu</span> <span class="o">=</span> <span class="n">menubar</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s2">&quot;File&quot;</span><span class="p">)</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>        <span class="n">reset_menu</span> <span class="o">=</span> <span class="n">menubar</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s2">&quot;Reset&quot;</span><span class="p">)</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>        <span class="c1"># Save screenshot action</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>        <span class="n">save_screenshot_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Save Screenshot&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>        <span class="n">save_screenshot_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_screenshot</span><span class="p">)</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>        <span class="n">file_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">save_screenshot_action</span><span class="p">)</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>        <span class="c1"># Export scene action</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>        <span class="n">export_scene_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Export Scene&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>        <span class="n">export_scene_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_scene</span><span class="p">)</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>        <span class="n">file_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">export_scene_action</span><span class="p">)</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>        <span class="c1"># Reset action</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>        <span class="n">reset_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Reset&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>        <span class="n">reset_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">)</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>        <span class="n">reset_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">reset_action</span><span class="p">)</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>    <span class="k">def</span> <span class="nf">save_screenshot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a><span class="sd">        Save the current scene as a screenshot</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>        <span class="n">options</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>        <span class="n">file_path</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>            <span class="s2">&quot;Save Screenshot&quot;</span><span class="p">,</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>            <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>            <span class="s2">&quot;PNG Files (*.png);;All Files (*)&quot;</span><span class="p">,</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>            <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">,</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>        <span class="p">)</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>        <span class="k">if</span> <span class="n">file_path</span><span class="p">:</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">screenshot</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>    <span class="k">def</span> <span class="nf">export_scene</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a><span class="sd">        Export the current scene as an HTML file</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>        <span class="n">options</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>        <span class="n">file_path</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>            <span class="s2">&quot;Export Scene&quot;</span><span class="p">,</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>            <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>            <span class="s2">&quot;HTML Files (*.html);;All Files (*)&quot;</span><span class="p">,</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>            <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">,</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a>        <span class="p">)</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>        <span class="k">if</span> <span class="n">file_path</span><span class="p">:</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">export_html</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>    <span class="k">def</span> <span class="nf">add_custom_lights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotter</span><span class="p">):</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a><span class="sd">        Adds custom lighting to the plotter for enhanced visualization.</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a><span class="sd">        Parameters:</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a><span class="sd">            plotter (QtInteractor): The PyVista plotter widget.</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>        <span class="c1"># Remove existing lights to prevent duplication</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">remove_all_lights</span><span class="p">()</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>        <span class="c1"># Define multiple light sources for better illumination</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>        <span class="n">light1</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Light</span><span class="p">(</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>            <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">focal_point</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">intensity</span><span class="o">=</span><span class="mf">1.0</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>        <span class="p">)</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>        <span class="n">light2</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Light</span><span class="p">(</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a>            <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">focal_point</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">intensity</span><span class="o">=</span><span class="mf">0.5</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a>        <span class="p">)</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a>        <span class="n">light3</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Light</span><span class="p">(</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a>            <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">),</span> <span class="n">focal_point</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">intensity</span><span class="o">=</span><span class="mf">0.5</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a>        <span class="p">)</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">add_light</span><span class="p">(</span><span class="n">light1</span><span class="p">)</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">add_light</span><span class="p">(</span><span class="n">light2</span><span class="p">)</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">add_light</span><span class="p">(</span><span class="n">light3</span><span class="p">)</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>    <span class="k">def</span> <span class="nf">new_plotter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a><span class="sd">        Create a new QtInteractor with the specified number of rows and columns.</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>        <span class="c1"># Create a new QtInteractor with the desired shape</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>        <span class="n">new_plotter_widget</span> <span class="o">=</span> <span class="n">QtInteractor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">))</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a>        <span class="c1"># Update the layout to replace the old plotter widget with the new one</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a>        <span class="n">layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">centralWidget</span><span class="p">()</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a>        <span class="n">layout</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="p">)</span>  <span class="c1"># Remove the old plotter widget</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a>            <span class="kc">None</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a>        <span class="p">)</span>  <span class="c1"># Detach the old plotter widget from its parent</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a>        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">new_plotter_widget</span><span class="p">)</span>  <span class="c1"># Add the new plotter widget to the layout</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a>            <span class="n">new_plotter_widget</span>  <span class="c1"># Update the reference to the new plotter widget</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a>        <span class="p">)</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a>    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">light</span><span class="o">=</span><span class="s2">&quot;Auto&quot;</span><span class="p">,</span> <span class="n">shadows</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a><span class="sd">        Renders the current disulfide bond using the specified style.</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a><span class="sd">        Parameters:</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a><span class="sd">            style (str): The rendering style (e.g., &#39;cpk&#39;, &#39;sb&#39;).</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a><span class="sd">            light (str): The lighting theme (&#39;Light&#39;, &#39;Dark&#39;, or &#39;Auto&#39;).</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a><span class="sd">            single (bool): Whether to display a single bond or multiple.</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a><span class="sd">            winsize (tuple): The window size for rendering.</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a>        <span class="n">style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_style</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a>        <span class="n">camera_position</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>  <span class="c1"># Example values</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a>        <span class="n">plotter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span>  <span class="c1"># Use QtInteractor as the plotter</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">camera_position</span> <span class="o">=</span> <span class="n">camera_position</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a>        <span class="c1"># Set the camera up vector</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">camera_set</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">view_up</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">add_axes</span><span class="p">()</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a>        <span class="k">if</span> <span class="n">shadows</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a>            <span class="n">plotter</span><span class="o">.</span><span class="n">enable_shadows</span><span class="p">()</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a>
</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a>        <span class="n">title</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">energy</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> kcal/mol. &quot;</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a>            <span class="sa">f</span><span class="s2">&quot;C: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">ca_distance</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">  &quot;</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a>            <span class="sa">f</span><span class="s2">&quot;C: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">cb_distance</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">  &quot;</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a>            <span class="sa">f</span><span class="s2">&quot;Tors: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">torsion_length</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a>        <span class="p">)</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a>        <span class="c1"># Determine the theme and set the background color</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a>        <span class="n">_theme</span> <span class="o">=</span> <span class="n">light</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">light</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Light&quot;</span><span class="p">,</span> <span class="s2">&quot;Dark&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="n">get_theme</span><span class="p">()</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a>        <span class="k">if</span> <span class="n">_theme</span> <span class="o">==</span> <span class="s2">&quot;dark&quot;</span><span class="p">:</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a>            <span class="n">pv</span><span class="o">.</span><span class="n">set_plot_theme</span><span class="p">(</span><span class="s2">&quot;dark&quot;</span><span class="p">)</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a>            <span class="n">plotter</span><span class="o">.</span><span class="n">set_background</span><span class="p">(</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a>            <span class="n">pv</span><span class="o">.</span><span class="n">set_plot_theme</span><span class="p">(</span><span class="s2">&quot;document&quot;</span><span class="p">)</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a>            <span class="n">plotter</span><span class="o">.</span><span class="n">set_background</span><span class="p">(</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a>
</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a>        <span class="c1"># Apply the current theme</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_theme</span> <span class="o">=</span> <span class="n">_theme</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">apply_theme</span><span class="p">()</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a>
</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">enable_anti_aliasing</span><span class="p">(</span><span class="s2">&quot;msaa&quot;</span><span class="p">)</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a>
</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a>        <span class="c1"># Add custom lights</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_custom_lights</span><span class="p">(</span><span class="n">plotter</span><span class="p">)</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a>
</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a>        <span class="c1"># Perform the plotting with the specified style</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">single</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a>            <span class="c1"># self.new_plotter(rows=1, cols=1)</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">plotter</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_overlay</span><span class="p">(</span><span class="n">plotter</span><span class="p">)</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a>
</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a>        <span class="c1"># Set perspective projection</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos">661</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">SetParallelProjection</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># False for perspective</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos">662</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos">663</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos">664</span></a>
</span><span id="L-665"><a href="#L-665"><span class="linenos">665</span></a>    <span class="k">def</span> <span class="nf">display_overlay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pl</span><span class="p">):</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos">666</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos">667</span></a><span class="sd">        Display all disulfides in the list overlaid in stick mode against</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos">668</span></a><span class="sd">        a common coordinate frames. This allows us to see all of the disulfides</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos">669</span></a><span class="sd">        at one time in a single view. Colors vary smoothy between bonds.</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos">670</span></a>
</span><span id="L-671"><a href="#L-671"><span class="linenos">671</span></a><span class="sd">        :param screenshot: Save a screenshot, defaults to False</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos">672</span></a><span class="sd">        :param movie: Save a movie, defaults to False</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos">673</span></a><span class="sd">        :param verbose: Verbosity, defaults to True</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos">674</span></a><span class="sd">        :param fname: Filename to save for the movie or screenshot, defaults to &#39;ss_overlay.png&#39;</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos">675</span></a><span class="sd">        :param light: Background color, defaults to True for White. False for Dark.</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos">676</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos">677</span></a>        <span class="n">sslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_sslist</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos">678</span></a>        <span class="n">ssbonds</span> <span class="o">=</span> <span class="n">sslist</span><span class="o">.</span><span class="n">data</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos">679</span></a>        <span class="n">tot_ss</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ssbonds</span><span class="p">)</span>  <span class="c1"># number off ssbonds</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos">680</span></a>        <span class="n">avg_enrg</span> <span class="o">=</span> <span class="n">sslist</span><span class="o">.</span><span class="n">average_energy</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos">681</span></a>        <span class="n">avg_dist</span> <span class="o">=</span> <span class="n">sslist</span><span class="o">.</span><span class="n">average_distance</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos">682</span></a>        <span class="n">resolution</span> <span class="o">=</span> <span class="n">sslist</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos">683</span></a>
</span><span id="L-684"><a href="#L-684"><span class="linenos">684</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="mi">100</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos">685</span></a>
</span><span id="L-686"><a href="#L-686"><span class="linenos">686</span></a>        <span class="k">if</span> <span class="n">tot_ss</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos">687</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="mi">60</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos">688</span></a>        <span class="k">if</span> <span class="n">tot_ss</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos">689</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="mi">30</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos">690</span></a>        <span class="k">if</span> <span class="n">tot_ss</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos">691</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="mi">8</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos">692</span></a>
</span><span id="L-693"><a href="#L-693"><span class="linenos">693</span></a>        <span class="n">title</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos">694</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">resolution</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> : (</span><span class="si">{</span><span class="n">tot_ss</span><span class="si">}</span><span class="s2"> SS), &quot;</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos">695</span></a>            <span class="sa">f</span><span class="s2">&quot;Avg E: </span><span class="si">{</span><span class="n">avg_enrg</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> kcal/mol, Avg Dist: </span><span class="si">{</span><span class="n">avg_dist</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos">696</span></a>        <span class="p">)</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos">697</span></a>
</span><span id="L-698"><a href="#L-698"><span class="linenos">698</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos">699</span></a>
</span><span id="L-700"><a href="#L-700"><span class="linenos">700</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">add_axes</span><span class="p">()</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos">701</span></a>
</span><span id="L-702"><a href="#L-702"><span class="linenos">702</span></a>        <span class="n">mycol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">tot_ss</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos">703</span></a>        <span class="n">mycol</span> <span class="o">=</span> <span class="n">get_jet_colormap</span><span class="p">(</span><span class="n">tot_ss</span><span class="p">)</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos">704</span></a>
</span><span id="L-705"><a href="#L-705"><span class="linenos">705</span></a>        <span class="c1"># scale the overlay bond radii down so that we can see the individual elements better</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos">706</span></a>        <span class="c1"># maximum 90% reduction</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos">707</span></a>
</span><span id="L-708"><a href="#L-708"><span class="linenos">708</span></a>        <span class="k">if</span> <span class="n">tot_ss</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos">709</span></a>            <span class="n">brad</span> <span class="o">=</span> <span class="n">BOND_RADIUS</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos">710</span></a>        <span class="k">elif</span> <span class="n">tot_ss</span> <span class="o">&lt;</span> <span class="mi">25</span><span class="p">:</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos">711</span></a>            <span class="n">brad</span> <span class="o">=</span> <span class="n">BOND_RADIUS</span> <span class="o">*</span> <span class="mf">0.75</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos">712</span></a>        <span class="k">elif</span> <span class="n">tot_ss</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">:</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos">713</span></a>            <span class="n">brad</span> <span class="o">=</span> <span class="n">BOND_RADIUS</span> <span class="o">*</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="mf">0.8</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos">714</span></a>        <span class="k">elif</span> <span class="n">tot_ss</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos">715</span></a>            <span class="n">brad</span> <span class="o">=</span> <span class="n">BOND_RADIUS</span> <span class="o">*</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="mf">0.7</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos">716</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos">717</span></a>            <span class="n">brad</span> <span class="o">=</span> <span class="n">BOND_RADIUS</span> <span class="o">*</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="mf">0.6</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos">718</span></a>
</span><span id="L-719"><a href="#L-719"><span class="linenos">719</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ss</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">tot_ss</span><span class="p">),</span> <span class="n">ssbonds</span><span class="p">):</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos">720</span></a>            <span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mycol</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">mycol</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">mycol</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])]</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos">721</span></a>            <span class="n">ss</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos">722</span></a>                <span class="n">pl</span><span class="p">,</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos">723</span></a>                <span class="n">style</span><span class="o">=</span><span class="s2">&quot;plain&quot;</span><span class="p">,</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos">724</span></a>                <span class="n">bondcolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos">725</span></a>                <span class="n">translate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos">726</span></a>                <span class="n">bond_radius</span><span class="o">=</span><span class="n">brad</span><span class="p">,</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos">727</span></a>                <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="p">,</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos">728</span></a>            <span class="p">)</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos">729</span></a>
</span><span id="L-730"><a href="#L-730"><span class="linenos">730</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_camera_view</span><span class="p">()</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos">731</span></a>
</span><span id="L-732"><a href="#L-732"><span class="linenos">732</span></a>        <span class="k">return</span> <span class="n">pl</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos">733</span></a>
</span><span id="L-734"><a href="#L-734"><span class="linenos">734</span></a>
</span><span id="L-735"><a href="#L-735"><span class="linenos">735</span></a><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos">736</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos">737</span></a><span class="sd">    The main entry point of the application.</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos">738</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos">739</span></a>
</span><span id="L-740"><a href="#L-740"><span class="linenos">740</span></a>    <span class="n">pdb</span> <span class="o">=</span> <span class="n">Load_PDB_SS</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos">741</span></a>    <span class="k">if</span> <span class="n">pdb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos">742</span></a>        <span class="n">ss_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">pdb</span><span class="o">.</span><span class="n">SSList</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">ss</span><span class="p">:</span> <span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span><span class="p">)</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos">743</span></a>        <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos">744</span></a>        <span class="n">viewer</span> <span class="o">=</span> <span class="n">DisulfideViewer</span><span class="p">(</span><span class="n">ss_list</span><span class="p">)</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos">745</span></a>        <span class="n">viewer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos">746</span></a>        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">())</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos">747</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos">748</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unable to load database!&quot;</span><span class="p">)</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos">749</span></a>        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos">750</span></a>
</span><span id="L-751"><a href="#L-751"><span class="linenos">751</span></a>
</span><span id="L-752"><a href="#L-752"><span class="linenos">752</span></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos">753</span></a>    <span class="n">main</span><span class="p">()</span>
</span></pre></div>


            </section>
                <section id="can_import">
                            <input id="can_import-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">can_import</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">module_name</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="can_import-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#can_import"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="can_import-39"><a href="#can_import-39"><span class="linenos">39</span></a><span class="k">def</span> <span class="nf">can_import</span><span class="p">(</span><span class="n">module_name</span><span class="p">):</span>
</span><span id="can_import-40"><a href="#can_import-40"><span class="linenos">40</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check we can import the requested module.&quot;&quot;&quot;</span>
</span><span id="can_import-41"><a href="#can_import-41"><span class="linenos">41</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="can_import-42"><a href="#can_import-42"><span class="linenos">42</span></a>        <span class="k">return</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
</span><span id="can_import-43"><a href="#can_import-43"><span class="linenos">43</span></a>    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span><span id="can_import-44"><a href="#can_import-44"><span class="linenos">44</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Check we can import the requested module.</p>
</div>


                </section>
                <section id="DisulfideViewer">
                            <input id="DisulfideViewer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DisulfideViewer</span><wbr>(<span class="base">PyQt5.QtWidgets.QMainWindow</span>):

                <label class="view-source-button" for="DisulfideViewer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer-97"><a href="#DisulfideViewer-97"><span class="linenos"> 97</span></a><span class="k">class</span> <span class="nc">DisulfideViewer</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>
</span><span id="DisulfideViewer-98"><a href="#DisulfideViewer-98"><span class="linenos"> 98</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-99"><a href="#DisulfideViewer-99"><span class="linenos"> 99</span></a><span class="sd">    A PyQt5-based application for viewing molecular structures with support for</span>
</span><span id="DisulfideViewer-100"><a href="#DisulfideViewer-100"><span class="linenos">100</span></a><span class="sd">    multiple disulfide bonds and various rendering styles.</span>
</span><span id="DisulfideViewer-101"><a href="#DisulfideViewer-101"><span class="linenos">101</span></a>
</span><span id="DisulfideViewer-102"><a href="#DisulfideViewer-102"><span class="linenos">102</span></a><span class="sd">    Attributes:</span>
</span><span id="DisulfideViewer-103"><a href="#DisulfideViewer-103"><span class="linenos">103</span></a><span class="sd">        ss_list (list): List of disulfide bond objects.</span>
</span><span id="DisulfideViewer-104"><a href="#DisulfideViewer-104"><span class="linenos">104</span></a><span class="sd">        current_ss (object): Currently selected disulfide bond.</span>
</span><span id="DisulfideViewer-105"><a href="#DisulfideViewer-105"><span class="linenos">105</span></a><span class="sd">        current_style (str): Currently selected rendering style.</span>
</span><span id="DisulfideViewer-106"><a href="#DisulfideViewer-106"><span class="linenos">106</span></a><span class="sd">        plotter_widget (QtInteractor): PyVista QtInteractor widget for 3D visualization.</span>
</span><span id="DisulfideViewer-107"><a href="#DisulfideViewer-107"><span class="linenos">107</span></a><span class="sd">        ss_dict (dict): Dictionary where keys are pdb_id and values are lists of disulfides</span>
</span><span id="DisulfideViewer-108"><a href="#DisulfideViewer-108"><span class="linenos">108</span></a><span class="sd">        with that pdb_id.</span>
</span><span id="DisulfideViewer-109"><a href="#DisulfideViewer-109"><span class="linenos">109</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-110"><a href="#DisulfideViewer-110"><span class="linenos">110</span></a>
</span><span id="DisulfideViewer-111"><a href="#DisulfideViewer-111"><span class="linenos">111</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ss_list</span><span class="p">,</span> <span class="n">winsize</span><span class="o">=</span><span class="p">(</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">800</span><span class="p">)):</span>
</span><span id="DisulfideViewer-112"><a href="#DisulfideViewer-112"><span class="linenos">112</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-113"><a href="#DisulfideViewer-113"><span class="linenos">113</span></a><span class="sd">        Initializes the MolecularViewer application.</span>
</span><span id="DisulfideViewer-114"><a href="#DisulfideViewer-114"><span class="linenos">114</span></a>
</span><span id="DisulfideViewer-115"><a href="#DisulfideViewer-115"><span class="linenos">115</span></a><span class="sd">        Parameters:</span>
</span><span id="DisulfideViewer-116"><a href="#DisulfideViewer-116"><span class="linenos">116</span></a><span class="sd">            ss_list (list): List of disulfide bond objects.</span>
</span><span id="DisulfideViewer-117"><a href="#DisulfideViewer-117"><span class="linenos">117</span></a><span class="sd">            winsize (tuple): Minimum size for the PyVista plotter widget.</span>
</span><span id="DisulfideViewer-118"><a href="#DisulfideViewer-118"><span class="linenos">118</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-119"><a href="#DisulfideViewer-119"><span class="linenos">119</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="DisulfideViewer-120"><a href="#DisulfideViewer-120"><span class="linenos">120</span></a>
</span><span id="DisulfideViewer-121"><a href="#DisulfideViewer-121"><span class="linenos">121</span></a>        <span class="c1"># Define color dictionary</span>
</span><span id="DisulfideViewer-122"><a href="#DisulfideViewer-122"><span class="linenos">122</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">colors</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DisulfideViewer-123"><a href="#DisulfideViewer-123"><span class="linenos">123</span></a>            <span class="s2">&quot;dark&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="DisulfideViewer-124"><a href="#DisulfideViewer-124"><span class="linenos">124</span></a>                <span class="s2">&quot;background&quot;</span><span class="p">:</span> <span class="s2">&quot;#2E2E2E&quot;</span><span class="p">,</span>  <span class="c1"># Dark Gray</span>
</span><span id="DisulfideViewer-125"><a href="#DisulfideViewer-125"><span class="linenos">125</span></a>                <span class="s2">&quot;midnight_blue&quot;</span><span class="p">:</span> <span class="s2">&quot;#191970&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer-126"><a href="#DisulfideViewer-126"><span class="linenos">126</span></a>                <span class="s2">&quot;dark_slate_gray&quot;</span><span class="p">:</span> <span class="s2">&quot;#2F4F4F&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer-127"><a href="#DisulfideViewer-127"><span class="linenos">127</span></a>                <span class="s2">&quot;charcoal&quot;</span><span class="p">:</span> <span class="s2">&quot;#36454F&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer-128"><a href="#DisulfideViewer-128"><span class="linenos">128</span></a>                <span class="s2">&quot;deep_space_sparkle&quot;</span><span class="p">:</span> <span class="s2">&quot;#4A646C&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer-129"><a href="#DisulfideViewer-129"><span class="linenos">129</span></a>                <span class="s2">&quot;black&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer-130"><a href="#DisulfideViewer-130"><span class="linenos">130</span></a>            <span class="p">},</span>
</span><span id="DisulfideViewer-131"><a href="#DisulfideViewer-131"><span class="linenos">131</span></a>            <span class="s2">&quot;light&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="DisulfideViewer-132"><a href="#DisulfideViewer-132"><span class="linenos">132</span></a>                <span class="s2">&quot;background&quot;</span><span class="p">:</span> <span class="s2">&quot;#FFFFFF&quot;</span><span class="p">,</span>  <span class="c1"># White</span>
</span><span id="DisulfideViewer-133"><a href="#DisulfideViewer-133"><span class="linenos">133</span></a>                <span class="s2">&quot;light_gray&quot;</span><span class="p">:</span> <span class="s2">&quot;#D3D3D3&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer-134"><a href="#DisulfideViewer-134"><span class="linenos">134</span></a>                <span class="s2">&quot;ivory&quot;</span><span class="p">:</span> <span class="s2">&quot;#FFFFF0&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer-135"><a href="#DisulfideViewer-135"><span class="linenos">135</span></a>                <span class="s2">&quot;honeydew&quot;</span><span class="p">:</span> <span class="s2">&quot;#F0FFF0&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer-136"><a href="#DisulfideViewer-136"><span class="linenos">136</span></a>                <span class="s2">&quot;azure&quot;</span><span class="p">:</span> <span class="s2">&quot;#F0FFFF&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer-137"><a href="#DisulfideViewer-137"><span class="linenos">137</span></a>            <span class="p">},</span>
</span><span id="DisulfideViewer-138"><a href="#DisulfideViewer-138"><span class="linenos">138</span></a>        <span class="p">}</span>
</span><span id="DisulfideViewer-139"><a href="#DisulfideViewer-139"><span class="linenos">139</span></a>
</span><span id="DisulfideViewer-140"><a href="#DisulfideViewer-140"><span class="linenos">140</span></a>        <span class="c1"># Set up the main window</span>
</span><span id="DisulfideViewer-141"><a href="#DisulfideViewer-141"><span class="linenos">141</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_version</span> <span class="o">=</span> <span class="n">_version</span>
</span><span id="DisulfideViewer-142"><a href="#DisulfideViewer-142"><span class="linenos">142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;proteusPy Disulfide Viewer&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-143"><a href="#DisulfideViewer-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">winsize</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">winsize</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="DisulfideViewer-144"><a href="#DisulfideViewer-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideViewer-145"><a href="#DisulfideViewer-145"><span class="linenos">145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_frame</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DisulfideViewer-146"><a href="#DisulfideViewer-146"><span class="linenos">146</span></a>
</span><span id="DisulfideViewer-147"><a href="#DisulfideViewer-147"><span class="linenos">147</span></a>        <span class="c1"># Validate and store the list of disulfides</span>
</span><span id="DisulfideViewer-148"><a href="#DisulfideViewer-148"><span class="linenos">148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span> <span class="o">=</span> <span class="n">ss_list</span>
</span><span id="DisulfideViewer-149"><a href="#DisulfideViewer-149"><span class="linenos">149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="DisulfideViewer-150"><a href="#DisulfideViewer-150"><span class="linenos">150</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdb_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="DisulfideViewer-151"><a href="#DisulfideViewer-151"><span class="linenos">151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_style</span> <span class="o">=</span> <span class="s2">&quot;sb&quot;</span>  <span class="c1"># Initialize with default style</span>
</span><span id="DisulfideViewer-152"><a href="#DisulfideViewer-152"><span class="linenos">152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">single</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DisulfideViewer-153"><a href="#DisulfideViewer-153"><span class="linenos">153</span></a>
</span><span id="DisulfideViewer-154"><a href="#DisulfideViewer-154"><span class="linenos">154</span></a>        <span class="c1"># Create a dictionary where keys are pdb_id and values are lists of disulfides</span>
</span><span id="DisulfideViewer-155"><a href="#DisulfideViewer-155"><span class="linenos">155</span></a>        <span class="c1"># with that pdb_id</span>
</span><span id="DisulfideViewer-156"><a href="#DisulfideViewer-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s2">&quot;sublist&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-157"><a href="#DisulfideViewer-157"><span class="linenos">157</span></a>
</span><span id="DisulfideViewer-158"><a href="#DisulfideViewer-158"><span class="linenos">158</span></a>        <span class="c1"># Populate the dictionary with key pdb_id and values list of disulfides</span>
</span><span id="DisulfideViewer-159"><a href="#DisulfideViewer-159"><span class="linenos">159</span></a>        <span class="c1"># for that pdb_id</span>
</span><span id="DisulfideViewer-160"><a href="#DisulfideViewer-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideViewer-161"><a href="#DisulfideViewer-161"><span class="linenos">161</span></a>        <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span><span class="p">:</span>
</span><span id="DisulfideViewer-162"><a href="#DisulfideViewer-162"><span class="linenos">162</span></a>            <span class="k">if</span> <span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="p">:</span>
</span><span id="DisulfideViewer-163"><a href="#DisulfideViewer-163"><span class="linenos">163</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="p">[</span><span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DisulfideViewer-164"><a href="#DisulfideViewer-164"><span class="linenos">164</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="p">[</span><span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
</span><span id="DisulfideViewer-165"><a href="#DisulfideViewer-165"><span class="linenos">165</span></a>
</span><span id="DisulfideViewer-166"><a href="#DisulfideViewer-166"><span class="linenos">166</span></a>        <span class="c1"># Create buttons for different rendering styles</span>
</span><span id="DisulfideViewer-167"><a href="#DisulfideViewer-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_cpk</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;CPK&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-168"><a href="#DisulfideViewer-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_sb</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;SB&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-169"><a href="#DisulfideViewer-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_bs</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;BS&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-170"><a href="#DisulfideViewer-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_pd</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;PD&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-171"><a href="#DisulfideViewer-171"><span class="linenos">171</span></a>
</span><span id="DisulfideViewer-172"><a href="#DisulfideViewer-172"><span class="linenos">172</span></a>        <span class="c1"># Connect buttons to methods with style tracking</span>
</span><span id="DisulfideViewer-173"><a href="#DisulfideViewer-173"><span class="linenos">173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_cpk</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_style</span><span class="p">(</span><span class="s2">&quot;cpk&quot;</span><span class="p">))</span>
</span><span id="DisulfideViewer-174"><a href="#DisulfideViewer-174"><span class="linenos">174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_sb</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_style</span><span class="p">(</span><span class="s2">&quot;sb&quot;</span><span class="p">))</span>
</span><span id="DisulfideViewer-175"><a href="#DisulfideViewer-175"><span class="linenos">175</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_bs</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_style</span><span class="p">(</span><span class="s2">&quot;bs&quot;</span><span class="p">))</span>
</span><span id="DisulfideViewer-176"><a href="#DisulfideViewer-176"><span class="linenos">176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_pd</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_style</span><span class="p">(</span><span class="s2">&quot;pd&quot;</span><span class="p">))</span>
</span><span id="DisulfideViewer-177"><a href="#DisulfideViewer-177"><span class="linenos">177</span></a>
</span><span id="DisulfideViewer-178"><a href="#DisulfideViewer-178"><span class="linenos">178</span></a>        <span class="c1"># Create a text box for entering PDB IDs</span>
</span><span id="DisulfideViewer-179"><a href="#DisulfideViewer-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
</span><span id="DisulfideViewer-180"><a href="#DisulfideViewer-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s2">&quot;Enter PDB ID&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-181"><a href="#DisulfideViewer-181"><span class="linenos">181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span><span class="o">.</span><span class="n">returnPressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_pdb_textbox_enter</span><span class="p">)</span>
</span><span id="DisulfideViewer-182"><a href="#DisulfideViewer-182"><span class="linenos">182</span></a>
</span><span id="DisulfideViewer-183"><a href="#DisulfideViewer-183"><span class="linenos">183</span></a>        <span class="c1"># Create a dropdown selector for PDB IDs</span>
</span><span id="DisulfideViewer-184"><a href="#DisulfideViewer-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
</span><span id="DisulfideViewer-185"><a href="#DisulfideViewer-185"><span class="linenos">185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="DisulfideViewer-186"><a href="#DisulfideViewer-186"><span class="linenos">186</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_pdb_dropdown_change</span><span class="p">)</span>
</span><span id="DisulfideViewer-187"><a href="#DisulfideViewer-187"><span class="linenos">187</span></a>
</span><span id="DisulfideViewer-188"><a href="#DisulfideViewer-188"><span class="linenos">188</span></a>        <span class="c1"># Create a dropdown selector for Disulfides</span>
</span><span id="DisulfideViewer-189"><a href="#DisulfideViewer-189"><span class="linenos">189</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
</span><span id="DisulfideViewer-190"><a href="#DisulfideViewer-190"><span class="linenos">190</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">ss</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span><span class="p">])</span>
</span><span id="DisulfideViewer-191"><a href="#DisulfideViewer-191"><span class="linenos">191</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_dropdown_change</span><span class="p">)</span>
</span><span id="DisulfideViewer-192"><a href="#DisulfideViewer-192"><span class="linenos">192</span></a>
</span><span id="DisulfideViewer-193"><a href="#DisulfideViewer-193"><span class="linenos">193</span></a>        <span class="c1"># Create a button to toggle themes</span>
</span><span id="DisulfideViewer-194"><a href="#DisulfideViewer-194"><span class="linenos">194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_theme</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Toggle Theme&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-195"><a href="#DisulfideViewer-195"><span class="linenos">195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_theme</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_theme</span><span class="p">)</span>
</span><span id="DisulfideViewer-196"><a href="#DisulfideViewer-196"><span class="linenos">196</span></a>
</span><span id="DisulfideViewer-197"><a href="#DisulfideViewer-197"><span class="linenos">197</span></a>        <span class="c1"># Create a checkbox for single/multiple display</span>
</span><span id="DisulfideViewer-198"><a href="#DisulfideViewer-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">checkbox_single</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Single&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-199"><a href="#DisulfideViewer-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">checkbox_single</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DisulfideViewer-200"><a href="#DisulfideViewer-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">checkbox_single</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_checkbox_single_change</span><span class="p">)</span>
</span><span id="DisulfideViewer-201"><a href="#DisulfideViewer-201"><span class="linenos">201</span></a>
</span><span id="DisulfideViewer-202"><a href="#DisulfideViewer-202"><span class="linenos">202</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_reset</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Reset Camera&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-203"><a href="#DisulfideViewer-203"><span class="linenos">203</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_reset</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_camera_view</span><span class="p">)</span>
</span><span id="DisulfideViewer-204"><a href="#DisulfideViewer-204"><span class="linenos">204</span></a>
</span><span id="DisulfideViewer-205"><a href="#DisulfideViewer-205"><span class="linenos">205</span></a>        <span class="c1"># Create a font object with increased size</span>
</span><span id="DisulfideViewer-206"><a href="#DisulfideViewer-206"><span class="linenos">206</span></a>        <span class="n">font</span> <span class="o">=</span> <span class="n">QFont</span><span class="p">()</span>
</span><span id="DisulfideViewer-207"><a href="#DisulfideViewer-207"><span class="linenos">207</span></a>        <span class="n">font</span><span class="o">.</span><span class="n">setPointSize</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>  <span class="c1"># Set the desired font size</span>
</span><span id="DisulfideViewer-208"><a href="#DisulfideViewer-208"><span class="linenos">208</span></a>
</span><span id="DisulfideViewer-209"><a href="#DisulfideViewer-209"><span class="linenos">209</span></a>        <span class="c1"># Group the PDB controls</span>
</span><span id="DisulfideViewer-210"><a href="#DisulfideViewer-210"><span class="linenos">210</span></a>        <span class="n">pdb_groupbox</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;PDB Controls&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-211"><a href="#DisulfideViewer-211"><span class="linenos">211</span></a>        <span class="n">pdb_groupbox</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>  <span class="c1"># Set the font for the groupbox label</span>
</span><span id="DisulfideViewer-212"><a href="#DisulfideViewer-212"><span class="linenos">212</span></a>        <span class="n">pdb_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
</span><span id="DisulfideViewer-213"><a href="#DisulfideViewer-213"><span class="linenos">213</span></a>        <span class="n">pdb_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span><span class="p">)</span>
</span><span id="DisulfideViewer-214"><a href="#DisulfideViewer-214"><span class="linenos">214</span></a>        <span class="n">pdb_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span><span class="p">)</span>
</span><span id="DisulfideViewer-215"><a href="#DisulfideViewer-215"><span class="linenos">215</span></a>        <span class="n">pdb_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="p">)</span>
</span><span id="DisulfideViewer-216"><a href="#DisulfideViewer-216"><span class="linenos">216</span></a>        <span class="n">pdb_groupbox</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">pdb_layout</span><span class="p">)</span>
</span><span id="DisulfideViewer-217"><a href="#DisulfideViewer-217"><span class="linenos">217</span></a>
</span><span id="DisulfideViewer-218"><a href="#DisulfideViewer-218"><span class="linenos">218</span></a>        <span class="c1"># Group the buttons with a label</span>
</span><span id="DisulfideViewer-219"><a href="#DisulfideViewer-219"><span class="linenos">219</span></a>        <span class="n">button_group</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Rendering Styles&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-220"><a href="#DisulfideViewer-220"><span class="linenos">220</span></a>        <span class="n">button_group</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>  <span class="c1"># Set the font for the groupbox label</span>
</span><span id="DisulfideViewer-221"><a href="#DisulfideViewer-221"><span class="linenos">221</span></a>        <span class="n">button_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
</span><span id="DisulfideViewer-222"><a href="#DisulfideViewer-222"><span class="linenos">222</span></a>        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_cpk</span><span class="p">)</span>
</span><span id="DisulfideViewer-223"><a href="#DisulfideViewer-223"><span class="linenos">223</span></a>        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_sb</span><span class="p">)</span>
</span><span id="DisulfideViewer-224"><a href="#DisulfideViewer-224"><span class="linenos">224</span></a>        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_bs</span><span class="p">)</span>
</span><span id="DisulfideViewer-225"><a href="#DisulfideViewer-225"><span class="linenos">225</span></a>        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_pd</span><span class="p">)</span>
</span><span id="DisulfideViewer-226"><a href="#DisulfideViewer-226"><span class="linenos">226</span></a>        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkbox_single</span><span class="p">)</span>  <span class="c1"># Add single/multiple checkbox</span>
</span><span id="DisulfideViewer-227"><a href="#DisulfideViewer-227"><span class="linenos">227</span></a>
</span><span id="DisulfideViewer-228"><a href="#DisulfideViewer-228"><span class="linenos">228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_spin</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Spin Molecule&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-229"><a href="#DisulfideViewer-229"><span class="linenos">229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_spin</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spin_camera</span><span class="p">)</span>
</span><span id="DisulfideViewer-230"><a href="#DisulfideViewer-230"><span class="linenos">230</span></a>
</span><span id="DisulfideViewer-231"><a href="#DisulfideViewer-231"><span class="linenos">231</span></a>        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_spin</span><span class="p">)</span>  <span class="c1"># Add spin camera button</span>
</span><span id="DisulfideViewer-232"><a href="#DisulfideViewer-232"><span class="linenos">232</span></a>
</span><span id="DisulfideViewer-233"><a href="#DisulfideViewer-233"><span class="linenos">233</span></a>        <span class="c1"># button_layout.addWidget(self.button_cov)</span>
</span><span id="DisulfideViewer-234"><a href="#DisulfideViewer-234"><span class="linenos">234</span></a>        <span class="n">button_group</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">button_layout</span><span class="p">)</span>
</span><span id="DisulfideViewer-235"><a href="#DisulfideViewer-235"><span class="linenos">235</span></a>
</span><span id="DisulfideViewer-236"><a href="#DisulfideViewer-236"><span class="linenos">236</span></a>        <span class="c1"># Layout for the main controls</span>
</span><span id="DisulfideViewer-237"><a href="#DisulfideViewer-237"><span class="linenos">237</span></a>        <span class="n">control_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
</span><span id="DisulfideViewer-238"><a href="#DisulfideViewer-238"><span class="linenos">238</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">button_group</span><span class="p">)</span>  <span class="c1"># Add button group</span>
</span><span id="DisulfideViewer-239"><a href="#DisulfideViewer-239"><span class="linenos">239</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addSpacerItem</span><span class="p">(</span>
</span><span id="DisulfideViewer-240"><a href="#DisulfideViewer-240"><span class="linenos">240</span></a>            <span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">)</span>
</span><span id="DisulfideViewer-241"><a href="#DisulfideViewer-241"><span class="linenos">241</span></a>        <span class="p">)</span>  <span class="c1"># Add spacer</span>
</span><span id="DisulfideViewer-242"><a href="#DisulfideViewer-242"><span class="linenos">242</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">pdb_groupbox</span><span class="p">)</span>  <span class="c1"># Add PDB groupbox</span>
</span><span id="DisulfideViewer-243"><a href="#DisulfideViewer-243"><span class="linenos">243</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addSpacerItem</span><span class="p">(</span>
</span><span id="DisulfideViewer-244"><a href="#DisulfideViewer-244"><span class="linenos">244</span></a>            <span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">)</span>
</span><span id="DisulfideViewer-245"><a href="#DisulfideViewer-245"><span class="linenos">245</span></a>        <span class="p">)</span>  <span class="c1"># Add spacer</span>
</span><span id="DisulfideViewer-246"><a href="#DisulfideViewer-246"><span class="linenos">246</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_theme</span><span class="p">)</span>  <span class="c1"># Add theme toggle button</span>
</span><span id="DisulfideViewer-247"><a href="#DisulfideViewer-247"><span class="linenos">247</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_reset</span><span class="p">)</span>  <span class="c1"># Add Reset button</span>
</span><span id="DisulfideViewer-248"><a href="#DisulfideViewer-248"><span class="linenos">248</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DisulfideViewer-249"><a href="#DisulfideViewer-249"><span class="linenos">249</span></a>
</span><span id="DisulfideViewer-250"><a href="#DisulfideViewer-250"><span class="linenos">250</span></a>        <span class="c1"># Create a QWidget for the controls</span>
</span><span id="DisulfideViewer-251"><a href="#DisulfideViewer-251"><span class="linenos">251</span></a>        <span class="n">control_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
</span><span id="DisulfideViewer-252"><a href="#DisulfideViewer-252"><span class="linenos">252</span></a>        <span class="n">control_widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">control_layout</span><span class="p">)</span>
</span><span id="DisulfideViewer-253"><a href="#DisulfideViewer-253"><span class="linenos">253</span></a>
</span><span id="DisulfideViewer-254"><a href="#DisulfideViewer-254"><span class="linenos">254</span></a>        <span class="c1"># Create the PyVista QtInteractor widget for 3D visualization</span>
</span><span id="DisulfideViewer-255"><a href="#DisulfideViewer-255"><span class="linenos">255</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span> <span class="o">=</span> <span class="n">QtInteractor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="DisulfideViewer-256"><a href="#DisulfideViewer-256"><span class="linenos">256</span></a>        <span class="c1"># self.plotter_widget.setMinimumSize(*winsize)</span>
</span><span id="DisulfideViewer-257"><a href="#DisulfideViewer-257"><span class="linenos">257</span></a>
</span><span id="DisulfideViewer-258"><a href="#DisulfideViewer-258"><span class="linenos">258</span></a>        <span class="c1"># Create sliders for camera control</span>
</span><span id="DisulfideViewer-259"><a href="#DisulfideViewer-259"><span class="linenos">259</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-260"><a href="#DisulfideViewer-260"><span class="linenos">260</span></a><span class="sd">        self.slider_x = QSlider(Qt.Horizontal)</span>
</span><span id="DisulfideViewer-261"><a href="#DisulfideViewer-261"><span class="linenos">261</span></a><span class="sd">        self.slider_x.setRange(-100, 100)</span>
</span><span id="DisulfideViewer-262"><a href="#DisulfideViewer-262"><span class="linenos">262</span></a><span class="sd">        self.slider_x.setValue(0)</span>
</span><span id="DisulfideViewer-263"><a href="#DisulfideViewer-263"><span class="linenos">263</span></a><span class="sd">        self.slider_x.valueChanged.connect(self.update_camera_position)</span>
</span><span id="DisulfideViewer-264"><a href="#DisulfideViewer-264"><span class="linenos">264</span></a>
</span><span id="DisulfideViewer-265"><a href="#DisulfideViewer-265"><span class="linenos">265</span></a><span class="sd">        self.slider_y = QSlider(Qt.Vertical)</span>
</span><span id="DisulfideViewer-266"><a href="#DisulfideViewer-266"><span class="linenos">266</span></a><span class="sd">        self.slider_y.setRange(-100, 100)</span>
</span><span id="DisulfideViewer-267"><a href="#DisulfideViewer-267"><span class="linenos">267</span></a><span class="sd">        self.slider_y.setValue(0)</span>
</span><span id="DisulfideViewer-268"><a href="#DisulfideViewer-268"><span class="linenos">268</span></a><span class="sd">        self.slider_y.valueChanged.connect(self.update_camera_position)</span>
</span><span id="DisulfideViewer-269"><a href="#DisulfideViewer-269"><span class="linenos">269</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-270"><a href="#DisulfideViewer-270"><span class="linenos">270</span></a>
</span><span id="DisulfideViewer-271"><a href="#DisulfideViewer-271"><span class="linenos">271</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_spin</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Spin Camera&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-272"><a href="#DisulfideViewer-272"><span class="linenos">272</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_spin</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spin_camera</span><span class="p">)</span>
</span><span id="DisulfideViewer-273"><a href="#DisulfideViewer-273"><span class="linenos">273</span></a>
</span><span id="DisulfideViewer-274"><a href="#DisulfideViewer-274"><span class="linenos">274</span></a>        <span class="c1"># Main layout combining controls and visualization</span>
</span><span id="DisulfideViewer-275"><a href="#DisulfideViewer-275"><span class="linenos">275</span></a>        <span class="n">main_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
</span><span id="DisulfideViewer-276"><a href="#DisulfideViewer-276"><span class="linenos">276</span></a>        <span class="n">main_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">control_widget</span><span class="p">)</span>
</span><span id="DisulfideViewer-277"><a href="#DisulfideViewer-277"><span class="linenos">277</span></a>        <span class="n">main_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="DisulfideViewer-278"><a href="#DisulfideViewer-278"><span class="linenos">278</span></a>        <span class="c1"># main_layout.addWidget(self.slider_y)  # Add vertical slider</span>
</span><span id="DisulfideViewer-279"><a href="#DisulfideViewer-279"><span class="linenos">279</span></a>
</span><span id="DisulfideViewer-280"><a href="#DisulfideViewer-280"><span class="linenos">280</span></a>        <span class="c1"># Set the central widget</span>
</span><span id="DisulfideViewer-281"><a href="#DisulfideViewer-281"><span class="linenos">281</span></a>        <span class="n">container</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
</span><span id="DisulfideViewer-282"><a href="#DisulfideViewer-282"><span class="linenos">282</span></a>        <span class="n">container</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">main_layout</span><span class="p">)</span>
</span><span id="DisulfideViewer-283"><a href="#DisulfideViewer-283"><span class="linenos">283</span></a>
</span><span id="DisulfideViewer-284"><a href="#DisulfideViewer-284"><span class="linenos">284</span></a>        <span class="n">bottom_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
</span><span id="DisulfideViewer-285"><a href="#DisulfideViewer-285"><span class="linenos">285</span></a>        <span class="n">bottom_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
</span><span id="DisulfideViewer-286"><a href="#DisulfideViewer-286"><span class="linenos">286</span></a>        <span class="c1"># bottom_layout.addWidget(self.slider_x)  # Add horizontal slider</span>
</span><span id="DisulfideViewer-287"><a href="#DisulfideViewer-287"><span class="linenos">287</span></a>
</span><span id="DisulfideViewer-288"><a href="#DisulfideViewer-288"><span class="linenos">288</span></a>        <span class="n">main_container</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
</span><span id="DisulfideViewer-289"><a href="#DisulfideViewer-289"><span class="linenos">289</span></a>        <span class="n">main_container</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">bottom_layout</span><span class="p">)</span>
</span><span id="DisulfideViewer-290"><a href="#DisulfideViewer-290"><span class="linenos">290</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="n">main_container</span><span class="p">)</span>
</span><span id="DisulfideViewer-291"><a href="#DisulfideViewer-291"><span class="linenos">291</span></a>
</span><span id="DisulfideViewer-292"><a href="#DisulfideViewer-292"><span class="linenos">292</span></a>        <span class="c1"># Status Bar for user feedback</span>
</span><span id="DisulfideViewer-293"><a href="#DisulfideViewer-293"><span class="linenos">293</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Displaying: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-294"><a href="#DisulfideViewer-294"><span class="linenos">294</span></a>
</span><span id="DisulfideViewer-295"><a href="#DisulfideViewer-295"><span class="linenos">295</span></a>        <span class="c1"># Initialize the theme</span>
</span><span id="DisulfideViewer-296"><a href="#DisulfideViewer-296"><span class="linenos">296</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_theme</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span>  <span class="c1"># Default theme</span>
</span><span id="DisulfideViewer-297"><a href="#DisulfideViewer-297"><span class="linenos">297</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">apply_theme</span><span class="p">()</span>
</span><span id="DisulfideViewer-298"><a href="#DisulfideViewer-298"><span class="linenos">298</span></a>
</span><span id="DisulfideViewer-299"><a href="#DisulfideViewer-299"><span class="linenos">299</span></a>        <span class="c1"># Create the menubar</span>
</span><span id="DisulfideViewer-300"><a href="#DisulfideViewer-300"><span class="linenos">300</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">create_menubar</span><span class="p">()</span>
</span><span id="DisulfideViewer-301"><a href="#DisulfideViewer-301"><span class="linenos">301</span></a>
</span><span id="DisulfideViewer-302"><a href="#DisulfideViewer-302"><span class="linenos">302</span></a>        <span class="c1"># Force a refresh on the disulfide list dropdown</span>
</span><span id="DisulfideViewer-303"><a href="#DisulfideViewer-303"><span class="linenos">303</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_camera_view</span><span class="p">()</span>
</span><span id="DisulfideViewer-304"><a href="#DisulfideViewer-304"><span class="linenos">304</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_pdb_dropdown_change</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DisulfideViewer-305"><a href="#DisulfideViewer-305"><span class="linenos">305</span></a>
</span><span id="DisulfideViewer-306"><a href="#DisulfideViewer-306"><span class="linenos">306</span></a>        <span class="c1"># Initial display</span>
</span><span id="DisulfideViewer-307"><a href="#DisulfideViewer-307"><span class="linenos">307</span></a>        <span class="c1"># self.display()  # Set a default view with current style</span>
</span><span id="DisulfideViewer-308"><a href="#DisulfideViewer-308"><span class="linenos">308</span></a>
</span><span id="DisulfideViewer-309"><a href="#DisulfideViewer-309"><span class="linenos">309</span></a>    <span class="k">def</span> <span class="nf">set_camera_view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideViewer-310"><a href="#DisulfideViewer-310"><span class="linenos">310</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-311"><a href="#DisulfideViewer-311"><span class="linenos">311</span></a><span class="sd">        Sets the camera to a specific view where the x-axis is pointed down and the</span>
</span><span id="DisulfideViewer-312"><a href="#DisulfideViewer-312"><span class="linenos">312</span></a><span class="sd">        y-axis into the screen.</span>
</span><span id="DisulfideViewer-313"><a href="#DisulfideViewer-313"><span class="linenos">313</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-314"><a href="#DisulfideViewer-314"><span class="linenos">314</span></a>        <span class="n">camera_position</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>  <span class="c1"># Example values</span>
</span><span id="DisulfideViewer-315"><a href="#DisulfideViewer-315"><span class="linenos">315</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">camera_position</span> <span class="o">=</span> <span class="n">camera_position</span>
</span><span id="DisulfideViewer-316"><a href="#DisulfideViewer-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="DisulfideViewer-317"><a href="#DisulfideViewer-317"><span class="linenos">317</span></a>
</span><span id="DisulfideViewer-318"><a href="#DisulfideViewer-318"><span class="linenos">318</span></a>    <span class="k">def</span> <span class="nf">spin_camera</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_frames</span><span class="o">=</span><span class="mi">150</span><span class="p">):</span>
</span><span id="DisulfideViewer-319"><a href="#DisulfideViewer-319"><span class="linenos">319</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-320"><a href="#DisulfideViewer-320"><span class="linenos">320</span></a><span class="sd">        Spins the camera around the z-axis in an orbital path.</span>
</span><span id="DisulfideViewer-321"><a href="#DisulfideViewer-321"><span class="linenos">321</span></a>
</span><span id="DisulfideViewer-322"><a href="#DisulfideViewer-322"><span class="linenos">322</span></a><span class="sd">        :param duration: Duration of the spin in seconds.</span>
</span><span id="DisulfideViewer-323"><a href="#DisulfideViewer-323"><span class="linenos">323</span></a><span class="sd">        :param n_frames: Number of frames for the animation.</span>
</span><span id="DisulfideViewer-324"><a href="#DisulfideViewer-324"><span class="linenos">324</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-325"><a href="#DisulfideViewer-325"><span class="linenos">325</span></a>        <span class="c1"># Define the circular path around the z-axis</span>
</span><span id="DisulfideViewer-326"><a href="#DisulfideViewer-326"><span class="linenos">326</span></a>        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_frames</span><span class="p">)</span>
</span><span id="DisulfideViewer-327"><a href="#DisulfideViewer-327"><span class="linenos">327</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">theta</span><span class="p">)]</span>
</span><span id="DisulfideViewer-328"><a href="#DisulfideViewer-328"><span class="linenos">328</span></a>        <span class="n">duration</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="DisulfideViewer-329"><a href="#DisulfideViewer-329"><span class="linenos">329</span></a>
</span><span id="DisulfideViewer-330"><a href="#DisulfideViewer-330"><span class="linenos">330</span></a>        <span class="c1"># Function to update the camera position</span>
</span><span id="DisulfideViewer-331"><a href="#DisulfideViewer-331"><span class="linenos">331</span></a>        <span class="k">def</span> <span class="nf">update_camera</span><span class="p">():</span>
</span><span id="DisulfideViewer-332"><a href="#DisulfideViewer-332"><span class="linenos">332</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">camera_position</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_frame</span><span class="p">]</span>
</span><span id="DisulfideViewer-333"><a href="#DisulfideViewer-333"><span class="linenos">333</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_frame</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_frame</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n_frames</span>
</span><span id="DisulfideViewer-334"><a href="#DisulfideViewer-334"><span class="linenos">334</span></a>
</span><span id="DisulfideViewer-335"><a href="#DisulfideViewer-335"><span class="linenos">335</span></a>        <span class="c1"># Create a QTimer to update the camera position</span>
</span><span id="DisulfideViewer-336"><a href="#DisulfideViewer-336"><span class="linenos">336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span> <span class="o">=</span> <span class="n">QTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="DisulfideViewer-337"><a href="#DisulfideViewer-337"><span class="linenos">337</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">update_camera</span><span class="p">)</span>
</span><span id="DisulfideViewer-338"><a href="#DisulfideViewer-338"><span class="linenos">338</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_frame</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DisulfideViewer-339"><a href="#DisulfideViewer-339"><span class="linenos">339</span></a>
</span><span id="DisulfideViewer-340"><a href="#DisulfideViewer-340"><span class="linenos">340</span></a>        <span class="c1"># Function to stop the timer after the duration</span>
</span><span id="DisulfideViewer-341"><a href="#DisulfideViewer-341"><span class="linenos">341</span></a>        <span class="k">def</span> <span class="nf">stop_timer</span><span class="p">():</span>
</span><span id="DisulfideViewer-342"><a href="#DisulfideViewer-342"><span class="linenos">342</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</span><span id="DisulfideViewer-343"><a href="#DisulfideViewer-343"><span class="linenos">343</span></a>
</span><span id="DisulfideViewer-344"><a href="#DisulfideViewer-344"><span class="linenos">344</span></a>        <span class="c1"># Start the timer</span>
</span><span id="DisulfideViewer-345"><a href="#DisulfideViewer-345"><span class="linenos">345</span></a>        <span class="n">interval</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">/</span> <span class="n">n_frames</span><span class="p">)</span>
</span><span id="DisulfideViewer-346"><a href="#DisulfideViewer-346"><span class="linenos">346</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
</span><span id="DisulfideViewer-347"><a href="#DisulfideViewer-347"><span class="linenos">347</span></a>        <span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">stop_timer</span><span class="p">)</span>
</span><span id="DisulfideViewer-348"><a href="#DisulfideViewer-348"><span class="linenos">348</span></a>
</span><span id="DisulfideViewer-349"><a href="#DisulfideViewer-349"><span class="linenos">349</span></a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideViewer-350"><a href="#DisulfideViewer-350"><span class="linenos">350</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-351"><a href="#DisulfideViewer-351"><span class="linenos">351</span></a><span class="sd">        Resets all widgets and data structures to their default state.</span>
</span><span id="DisulfideViewer-352"><a href="#DisulfideViewer-352"><span class="linenos">352</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-353"><a href="#DisulfideViewer-353"><span class="linenos">353</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Resetting...&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-354"><a href="#DisulfideViewer-354"><span class="linenos">354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="DisulfideViewer-355"><a href="#DisulfideViewer-355"><span class="linenos">355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DisulfideViewer-356"><a href="#DisulfideViewer-356"><span class="linenos">356</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="DisulfideViewer-357"><a href="#DisulfideViewer-357"><span class="linenos">357</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">checkbox_single</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DisulfideViewer-358"><a href="#DisulfideViewer-358"><span class="linenos">358</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_style</span> <span class="o">=</span> <span class="s2">&quot;sb&quot;</span>
</span><span id="DisulfideViewer-359"><a href="#DisulfideViewer-359"><span class="linenos">359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="DisulfideViewer-360"><a href="#DisulfideViewer-360"><span class="linenos">360</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdb_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="DisulfideViewer-361"><a href="#DisulfideViewer-361"><span class="linenos">361</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_camera_view</span><span class="p">()</span>
</span><span id="DisulfideViewer-362"><a href="#DisulfideViewer-362"><span class="linenos">362</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_pdb_dropdown_change</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DisulfideViewer-363"><a href="#DisulfideViewer-363"><span class="linenos">363</span></a>
</span><span id="DisulfideViewer-364"><a href="#DisulfideViewer-364"><span class="linenos">364</span></a>    <span class="k">def</span> <span class="nf">add_floor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotter</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)):</span>
</span><span id="DisulfideViewer-365"><a href="#DisulfideViewer-365"><span class="linenos">365</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-366"><a href="#DisulfideViewer-366"><span class="linenos">366</span></a><span class="sd">        Adds a simple plane beneath the disulfide bond to act as a &#39;floor&#39;.</span>
</span><span id="DisulfideViewer-367"><a href="#DisulfideViewer-367"><span class="linenos">367</span></a>
</span><span id="DisulfideViewer-368"><a href="#DisulfideViewer-368"><span class="linenos">368</span></a><span class="sd">        :param plotter: The PyVista plotter to add the floor to.</span>
</span><span id="DisulfideViewer-369"><a href="#DisulfideViewer-369"><span class="linenos">369</span></a><span class="sd">        :type plotter: pv.Plotter</span>
</span><span id="DisulfideViewer-370"><a href="#DisulfideViewer-370"><span class="linenos">370</span></a><span class="sd">        :param size: The size of the floor plane.</span>
</span><span id="DisulfideViewer-371"><a href="#DisulfideViewer-371"><span class="linenos">371</span></a><span class="sd">        :type size: float</span>
</span><span id="DisulfideViewer-372"><a href="#DisulfideViewer-372"><span class="linenos">372</span></a><span class="sd">        :param position: The position of the floor plane.</span>
</span><span id="DisulfideViewer-373"><a href="#DisulfideViewer-373"><span class="linenos">373</span></a><span class="sd">        :type position: tuple</span>
</span><span id="DisulfideViewer-374"><a href="#DisulfideViewer-374"><span class="linenos">374</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-375"><a href="#DisulfideViewer-375"><span class="linenos">375</span></a>        <span class="n">floor</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plane</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">i_size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">j_size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
</span><span id="DisulfideViewer-376"><a href="#DisulfideViewer-376"><span class="linenos">376</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">floor</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="DisulfideViewer-377"><a href="#DisulfideViewer-377"><span class="linenos">377</span></a>
</span><span id="DisulfideViewer-378"><a href="#DisulfideViewer-378"><span class="linenos">378</span></a>    <span class="k">def</span> <span class="nf">update_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">):</span>
</span><span id="DisulfideViewer-379"><a href="#DisulfideViewer-379"><span class="linenos">379</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-380"><a href="#DisulfideViewer-380"><span class="linenos">380</span></a><span class="sd">        Updates the current rendering style and refreshes the visualization.</span>
</span><span id="DisulfideViewer-381"><a href="#DisulfideViewer-381"><span class="linenos">381</span></a>
</span><span id="DisulfideViewer-382"><a href="#DisulfideViewer-382"><span class="linenos">382</span></a><span class="sd">        :param style: The rendering style to apply (e.g., &#39;cpk&#39;, &#39;sb&#39;).</span>
</span><span id="DisulfideViewer-383"><a href="#DisulfideViewer-383"><span class="linenos">383</span></a><span class="sd">        :type style: str</span>
</span><span id="DisulfideViewer-384"><a href="#DisulfideViewer-384"><span class="linenos">384</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-385"><a href="#DisulfideViewer-385"><span class="linenos">385</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_style</span> <span class="o">=</span> <span class="n">style</span>
</span><span id="DisulfideViewer-386"><a href="#DisulfideViewer-386"><span class="linenos">386</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">checkbox_single</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Ensure the &quot;Single&quot; checkbox is checked</span>
</span><span id="DisulfideViewer-387"><a href="#DisulfideViewer-387"><span class="linenos">387</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</span><span id="DisulfideViewer-388"><a href="#DisulfideViewer-388"><span class="linenos">388</span></a>
</span><span id="DisulfideViewer-389"><a href="#DisulfideViewer-389"><span class="linenos">389</span></a>    <span class="k">def</span> <span class="nf">on_pdb_textbox_enter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideViewer-390"><a href="#DisulfideViewer-390"><span class="linenos">390</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-391"><a href="#DisulfideViewer-391"><span class="linenos">391</span></a><span class="sd">        Handles the event when the user presses Enter in the PDB ID text box.</span>
</span><span id="DisulfideViewer-392"><a href="#DisulfideViewer-392"><span class="linenos">392</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-393"><a href="#DisulfideViewer-393"><span class="linenos">393</span></a>        <span class="n">pdb_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
</span><span id="DisulfideViewer-394"><a href="#DisulfideViewer-394"><span class="linenos">394</span></a>        <span class="k">if</span> <span class="n">pdb_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="p">:</span>
</span><span id="DisulfideViewer-395"><a href="#DisulfideViewer-395"><span class="linenos">395</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_pdb_selection</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">)</span>
</span><span id="DisulfideViewer-396"><a href="#DisulfideViewer-396"><span class="linenos">396</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideViewer-397"><a href="#DisulfideViewer-397"><span class="linenos">397</span></a>            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="DisulfideViewer-398"><a href="#DisulfideViewer-398"><span class="linenos">398</span></a>                <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Invalid PDB ID&quot;</span><span class="p">,</span> <span class="s2">&quot;The entered PDB ID is not valid.&quot;</span>
</span><span id="DisulfideViewer-399"><a href="#DisulfideViewer-399"><span class="linenos">399</span></a>            <span class="p">)</span>
</span><span id="DisulfideViewer-400"><a href="#DisulfideViewer-400"><span class="linenos">400</span></a>        <span class="n">disulfides</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="DisulfideViewer-401"><a href="#DisulfideViewer-401"><span class="linenos">401</span></a>
</span><span id="DisulfideViewer-402"><a href="#DisulfideViewer-402"><span class="linenos">402</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="DisulfideViewer-403"><a href="#DisulfideViewer-403"><span class="linenos">403</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">ss</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">disulfides</span><span class="p">])</span>
</span><span id="DisulfideViewer-404"><a href="#DisulfideViewer-404"><span class="linenos">404</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">disulfides</span><span class="p">),</span> <span class="s2">&quot;sub&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-405"><a href="#DisulfideViewer-405"><span class="linenos">405</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">)</span>
</span><span id="DisulfideViewer-406"><a href="#DisulfideViewer-406"><span class="linenos">406</span></a>
</span><span id="DisulfideViewer-407"><a href="#DisulfideViewer-407"><span class="linenos">407</span></a>    <span class="k">def</span> <span class="nf">on_pdb_dropdown_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span><span id="DisulfideViewer-408"><a href="#DisulfideViewer-408"><span class="linenos">408</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-409"><a href="#DisulfideViewer-409"><span class="linenos">409</span></a><span class="sd">        Handles the event when the PDB ID dropdown selection changes.</span>
</span><span id="DisulfideViewer-410"><a href="#DisulfideViewer-410"><span class="linenos">410</span></a>
</span><span id="DisulfideViewer-411"><a href="#DisulfideViewer-411"><span class="linenos">411</span></a><span class="sd">        Parameters:</span>
</span><span id="DisulfideViewer-412"><a href="#DisulfideViewer-412"><span class="linenos">412</span></a><span class="sd">            index (int): The index of the selected item in the PDB ID dropdown.</span>
</span><span id="DisulfideViewer-413"><a href="#DisulfideViewer-413"><span class="linenos">413</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-414"><a href="#DisulfideViewer-414"><span class="linenos">414</span></a>        <span class="n">pdb_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
</span><span id="DisulfideViewer-415"><a href="#DisulfideViewer-415"><span class="linenos">415</span></a>
</span><span id="DisulfideViewer-416"><a href="#DisulfideViewer-416"><span class="linenos">416</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="DisulfideViewer-417"><a href="#DisulfideViewer-417"><span class="linenos">417</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">)</span>
</span><span id="DisulfideViewer-418"><a href="#DisulfideViewer-418"><span class="linenos">418</span></a>
</span><span id="DisulfideViewer-419"><a href="#DisulfideViewer-419"><span class="linenos">419</span></a>        <span class="n">disulfides</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="DisulfideViewer-420"><a href="#DisulfideViewer-420"><span class="linenos">420</span></a>
</span><span id="DisulfideViewer-421"><a href="#DisulfideViewer-421"><span class="linenos">421</span></a>        <span class="k">if</span> <span class="n">disulfides</span><span class="p">:</span>
</span><span id="DisulfideViewer-422"><a href="#DisulfideViewer-422"><span class="linenos">422</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">ss</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">disulfides</span><span class="p">])</span>
</span><span id="DisulfideViewer-423"><a href="#DisulfideViewer-423"><span class="linenos">423</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span> <span class="o">=</span> <span class="n">disulfides</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="DisulfideViewer-424"><a href="#DisulfideViewer-424"><span class="linenos">424</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">disulfides</span><span class="p">),</span> <span class="s2">&quot;sublist&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-425"><a href="#DisulfideViewer-425"><span class="linenos">425</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Displaying: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-426"><a href="#DisulfideViewer-426"><span class="linenos">426</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</span><span id="DisulfideViewer-427"><a href="#DisulfideViewer-427"><span class="linenos">427</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideViewer-428"><a href="#DisulfideViewer-428"><span class="linenos">428</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No Disulfides: </span><span class="si">{</span><span class="n">pdb_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-429"><a href="#DisulfideViewer-429"><span class="linenos">429</span></a>
</span><span id="DisulfideViewer-430"><a href="#DisulfideViewer-430"><span class="linenos">430</span></a>    <span class="k">def</span> <span class="nf">update_pdb_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdb_id</span><span class="p">):</span>
</span><span id="DisulfideViewer-431"><a href="#DisulfideViewer-431"><span class="linenos">431</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-432"><a href="#DisulfideViewer-432"><span class="linenos">432</span></a><span class="sd">        Updates the current PDB selection and refreshes the disulfide dropdown.</span>
</span><span id="DisulfideViewer-433"><a href="#DisulfideViewer-433"><span class="linenos">433</span></a>
</span><span id="DisulfideViewer-434"><a href="#DisulfideViewer-434"><span class="linenos">434</span></a><span class="sd">        :param pdb_id: The PDB ID to select.</span>
</span><span id="DisulfideViewer-435"><a href="#DisulfideViewer-435"><span class="linenos">435</span></a><span class="sd">        :type pdb_id: str</span>
</span><span id="DisulfideViewer-436"><a href="#DisulfideViewer-436"><span class="linenos">436</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-437"><a href="#DisulfideViewer-437"><span class="linenos">437</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdb_id</span> <span class="o">=</span> <span class="n">pdb_id</span>
</span><span id="DisulfideViewer-438"><a href="#DisulfideViewer-438"><span class="linenos">438</span></a>        <span class="n">disulfides</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="DisulfideViewer-439"><a href="#DisulfideViewer-439"><span class="linenos">439</span></a>
</span><span id="DisulfideViewer-440"><a href="#DisulfideViewer-440"><span class="linenos">440</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">disulfides</span><span class="p">),</span> <span class="s2">&quot;sublist2&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-441"><a href="#DisulfideViewer-441"><span class="linenos">441</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="DisulfideViewer-442"><a href="#DisulfideViewer-442"><span class="linenos">442</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">ss</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span><span class="p">])</span>
</span><span id="DisulfideViewer-443"><a href="#DisulfideViewer-443"><span class="linenos">443</span></a>
</span><span id="DisulfideViewer-444"><a href="#DisulfideViewer-444"><span class="linenos">444</span></a>    <span class="k">def</span> <span class="nf">on_dropdown_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span><span id="DisulfideViewer-445"><a href="#DisulfideViewer-445"><span class="linenos">445</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-446"><a href="#DisulfideViewer-446"><span class="linenos">446</span></a><span class="sd">        Handles the event when the dropdown selection changes.</span>
</span><span id="DisulfideViewer-447"><a href="#DisulfideViewer-447"><span class="linenos">447</span></a>
</span><span id="DisulfideViewer-448"><a href="#DisulfideViewer-448"><span class="linenos">448</span></a><span class="sd">        Parameters:</span>
</span><span id="DisulfideViewer-449"><a href="#DisulfideViewer-449"><span class="linenos">449</span></a><span class="sd">            index (int): The index of the selected item in the dropdown.</span>
</span><span id="DisulfideViewer-450"><a href="#DisulfideViewer-450"><span class="linenos">450</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-451"><a href="#DisulfideViewer-451"><span class="linenos">451</span></a>        <span class="n">selected_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
</span><span id="DisulfideViewer-452"><a href="#DisulfideViewer-452"><span class="linenos">452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
</span><span id="DisulfideViewer-453"><a href="#DisulfideViewer-453"><span class="linenos">453</span></a>            <span class="p">(</span><span class="n">ss</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span> <span class="k">if</span> <span class="n">ss</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">selected_name</span><span class="p">),</span> <span class="kc">None</span>
</span><span id="DisulfideViewer-454"><a href="#DisulfideViewer-454"><span class="linenos">454</span></a>        <span class="p">)</span>
</span><span id="DisulfideViewer-455"><a href="#DisulfideViewer-455"><span class="linenos">455</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideViewer-456"><a href="#DisulfideViewer-456"><span class="linenos">456</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</span><span id="DisulfideViewer-457"><a href="#DisulfideViewer-457"><span class="linenos">457</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Displaying: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-458"><a href="#DisulfideViewer-458"><span class="linenos">458</span></a>
</span><span id="DisulfideViewer-459"><a href="#DisulfideViewer-459"><span class="linenos">459</span></a>    <span class="k">def</span> <span class="nf">on_checkbox_single_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
</span><span id="DisulfideViewer-460"><a href="#DisulfideViewer-460"><span class="linenos">460</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-461"><a href="#DisulfideViewer-461"><span class="linenos">461</span></a><span class="sd">        Handles the event when the single/multiple checkbox state changes.</span>
</span><span id="DisulfideViewer-462"><a href="#DisulfideViewer-462"><span class="linenos">462</span></a>
</span><span id="DisulfideViewer-463"><a href="#DisulfideViewer-463"><span class="linenos">463</span></a><span class="sd">        Parameters:</span>
</span><span id="DisulfideViewer-464"><a href="#DisulfideViewer-464"><span class="linenos">464</span></a><span class="sd">            state (int): The state of the checkbox (Qt.Checked or Qt.Unchecked).</span>
</span><span id="DisulfideViewer-465"><a href="#DisulfideViewer-465"><span class="linenos">465</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-466"><a href="#DisulfideViewer-466"><span class="linenos">466</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">single</span> <span class="o">=</span> <span class="n">state</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span>
</span><span id="DisulfideViewer-467"><a href="#DisulfideViewer-467"><span class="linenos">467</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># Use the current style</span>
</span><span id="DisulfideViewer-468"><a href="#DisulfideViewer-468"><span class="linenos">468</span></a>
</span><span id="DisulfideViewer-469"><a href="#DisulfideViewer-469"><span class="linenos">469</span></a>    <span class="k">def</span> <span class="nf">update_camera_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideViewer-470"><a href="#DisulfideViewer-470"><span class="linenos">470</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-471"><a href="#DisulfideViewer-471"><span class="linenos">471</span></a><span class="sd">        Update the camera position based on the slider values.</span>
</span><span id="DisulfideViewer-472"><a href="#DisulfideViewer-472"><span class="linenos">472</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-473"><a href="#DisulfideViewer-473"><span class="linenos">473</span></a>
</span><span id="DisulfideViewer-474"><a href="#DisulfideViewer-474"><span class="linenos">474</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slider_x</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
</span><span id="DisulfideViewer-475"><a href="#DisulfideViewer-475"><span class="linenos">475</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slider_y</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
</span><span id="DisulfideViewer-476"><a href="#DisulfideViewer-476"><span class="linenos">476</span></a>
</span><span id="DisulfideViewer-477"><a href="#DisulfideViewer-477"><span class="linenos">477</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">camera_position</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
</span><span id="DisulfideViewer-478"><a href="#DisulfideViewer-478"><span class="linenos">478</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</span><span id="DisulfideViewer-479"><a href="#DisulfideViewer-479"><span class="linenos">479</span></a>
</span><span id="DisulfideViewer-480"><a href="#DisulfideViewer-480"><span class="linenos">480</span></a>    <span class="k">def</span> <span class="nf">toggle_theme</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideViewer-481"><a href="#DisulfideViewer-481"><span class="linenos">481</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-482"><a href="#DisulfideViewer-482"><span class="linenos">482</span></a><span class="sd">        Toggle between light and dark themes.</span>
</span><span id="DisulfideViewer-483"><a href="#DisulfideViewer-483"><span class="linenos">483</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-484"><a href="#DisulfideViewer-484"><span class="linenos">484</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_theme</span> <span class="o">==</span> <span class="s2">&quot;dark&quot;</span><span class="p">:</span>
</span><span id="DisulfideViewer-485"><a href="#DisulfideViewer-485"><span class="linenos">485</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_theme</span> <span class="o">=</span> <span class="s2">&quot;light&quot;</span>
</span><span id="DisulfideViewer-486"><a href="#DisulfideViewer-486"><span class="linenos">486</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideViewer-487"><a href="#DisulfideViewer-487"><span class="linenos">487</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_theme</span> <span class="o">=</span> <span class="s2">&quot;dark&quot;</span>
</span><span id="DisulfideViewer-488"><a href="#DisulfideViewer-488"><span class="linenos">488</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">apply_theme</span><span class="p">()</span>
</span><span id="DisulfideViewer-489"><a href="#DisulfideViewer-489"><span class="linenos">489</span></a>
</span><span id="DisulfideViewer-490"><a href="#DisulfideViewer-490"><span class="linenos">490</span></a>    <span class="k">def</span> <span class="nf">apply_theme</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideViewer-491"><a href="#DisulfideViewer-491"><span class="linenos">491</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-492"><a href="#DisulfideViewer-492"><span class="linenos">492</span></a><span class="sd">        Apply the current theme to the plotter widget.</span>
</span><span id="DisulfideViewer-493"><a href="#DisulfideViewer-493"><span class="linenos">493</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-494"><a href="#DisulfideViewer-494"><span class="linenos">494</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_theme</span> <span class="o">==</span> <span class="s2">&quot;dark&quot;</span><span class="p">:</span>
</span><span id="DisulfideViewer-495"><a href="#DisulfideViewer-495"><span class="linenos">495</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">set_background</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="s2">&quot;dark&quot;</span><span class="p">][</span><span class="s2">&quot;background&quot;</span><span class="p">])</span>
</span><span id="DisulfideViewer-496"><a href="#DisulfideViewer-496"><span class="linenos">496</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideViewer-497"><a href="#DisulfideViewer-497"><span class="linenos">497</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">set_background</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="s2">&quot;light&quot;</span><span class="p">][</span><span class="s2">&quot;background&quot;</span><span class="p">])</span>
</span><span id="DisulfideViewer-498"><a href="#DisulfideViewer-498"><span class="linenos">498</span></a>
</span><span id="DisulfideViewer-499"><a href="#DisulfideViewer-499"><span class="linenos">499</span></a>        <span class="c1"># Render the plotter to apply the changes</span>
</span><span id="DisulfideViewer-500"><a href="#DisulfideViewer-500"><span class="linenos">500</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</span><span id="DisulfideViewer-501"><a href="#DisulfideViewer-501"><span class="linenos">501</span></a>
</span><span id="DisulfideViewer-502"><a href="#DisulfideViewer-502"><span class="linenos">502</span></a>    <span class="k">def</span> <span class="nf">create_menubar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideViewer-503"><a href="#DisulfideViewer-503"><span class="linenos">503</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-504"><a href="#DisulfideViewer-504"><span class="linenos">504</span></a><span class="sd">        Creates the menubar</span>
</span><span id="DisulfideViewer-505"><a href="#DisulfideViewer-505"><span class="linenos">505</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-506"><a href="#DisulfideViewer-506"><span class="linenos">506</span></a>        <span class="n">menubar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span>
</span><span id="DisulfideViewer-507"><a href="#DisulfideViewer-507"><span class="linenos">507</span></a>
</span><span id="DisulfideViewer-508"><a href="#DisulfideViewer-508"><span class="linenos">508</span></a>        <span class="c1"># File menu</span>
</span><span id="DisulfideViewer-509"><a href="#DisulfideViewer-509"><span class="linenos">509</span></a>        <span class="n">file_menu</span> <span class="o">=</span> <span class="n">menubar</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s2">&quot;File&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-510"><a href="#DisulfideViewer-510"><span class="linenos">510</span></a>        <span class="n">reset_menu</span> <span class="o">=</span> <span class="n">menubar</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s2">&quot;Reset&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-511"><a href="#DisulfideViewer-511"><span class="linenos">511</span></a>
</span><span id="DisulfideViewer-512"><a href="#DisulfideViewer-512"><span class="linenos">512</span></a>        <span class="c1"># Save screenshot action</span>
</span><span id="DisulfideViewer-513"><a href="#DisulfideViewer-513"><span class="linenos">513</span></a>        <span class="n">save_screenshot_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Save Screenshot&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="DisulfideViewer-514"><a href="#DisulfideViewer-514"><span class="linenos">514</span></a>        <span class="n">save_screenshot_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_screenshot</span><span class="p">)</span>
</span><span id="DisulfideViewer-515"><a href="#DisulfideViewer-515"><span class="linenos">515</span></a>        <span class="n">file_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">save_screenshot_action</span><span class="p">)</span>
</span><span id="DisulfideViewer-516"><a href="#DisulfideViewer-516"><span class="linenos">516</span></a>
</span><span id="DisulfideViewer-517"><a href="#DisulfideViewer-517"><span class="linenos">517</span></a>        <span class="c1"># Export scene action</span>
</span><span id="DisulfideViewer-518"><a href="#DisulfideViewer-518"><span class="linenos">518</span></a>        <span class="n">export_scene_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Export Scene&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="DisulfideViewer-519"><a href="#DisulfideViewer-519"><span class="linenos">519</span></a>        <span class="n">export_scene_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_scene</span><span class="p">)</span>
</span><span id="DisulfideViewer-520"><a href="#DisulfideViewer-520"><span class="linenos">520</span></a>        <span class="n">file_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">export_scene_action</span><span class="p">)</span>
</span><span id="DisulfideViewer-521"><a href="#DisulfideViewer-521"><span class="linenos">521</span></a>
</span><span id="DisulfideViewer-522"><a href="#DisulfideViewer-522"><span class="linenos">522</span></a>        <span class="c1"># Reset action</span>
</span><span id="DisulfideViewer-523"><a href="#DisulfideViewer-523"><span class="linenos">523</span></a>        <span class="n">reset_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Reset&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="DisulfideViewer-524"><a href="#DisulfideViewer-524"><span class="linenos">524</span></a>        <span class="n">reset_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">)</span>
</span><span id="DisulfideViewer-525"><a href="#DisulfideViewer-525"><span class="linenos">525</span></a>        <span class="n">reset_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">reset_action</span><span class="p">)</span>
</span><span id="DisulfideViewer-526"><a href="#DisulfideViewer-526"><span class="linenos">526</span></a>
</span><span id="DisulfideViewer-527"><a href="#DisulfideViewer-527"><span class="linenos">527</span></a>    <span class="k">def</span> <span class="nf">save_screenshot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideViewer-528"><a href="#DisulfideViewer-528"><span class="linenos">528</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-529"><a href="#DisulfideViewer-529"><span class="linenos">529</span></a><span class="sd">        Save the current scene as a screenshot</span>
</span><span id="DisulfideViewer-530"><a href="#DisulfideViewer-530"><span class="linenos">530</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-531"><a href="#DisulfideViewer-531"><span class="linenos">531</span></a>        <span class="n">options</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>
</span><span id="DisulfideViewer-532"><a href="#DisulfideViewer-532"><span class="linenos">532</span></a>        <span class="n">file_path</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span>
</span><span id="DisulfideViewer-533"><a href="#DisulfideViewer-533"><span class="linenos">533</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="DisulfideViewer-534"><a href="#DisulfideViewer-534"><span class="linenos">534</span></a>            <span class="s2">&quot;Save Screenshot&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer-535"><a href="#DisulfideViewer-535"><span class="linenos">535</span></a>            <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer-536"><a href="#DisulfideViewer-536"><span class="linenos">536</span></a>            <span class="s2">&quot;PNG Files (*.png);;All Files (*)&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer-537"><a href="#DisulfideViewer-537"><span class="linenos">537</span></a>            <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">,</span>
</span><span id="DisulfideViewer-538"><a href="#DisulfideViewer-538"><span class="linenos">538</span></a>        <span class="p">)</span>
</span><span id="DisulfideViewer-539"><a href="#DisulfideViewer-539"><span class="linenos">539</span></a>        <span class="k">if</span> <span class="n">file_path</span><span class="p">:</span>
</span><span id="DisulfideViewer-540"><a href="#DisulfideViewer-540"><span class="linenos">540</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">screenshot</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="DisulfideViewer-541"><a href="#DisulfideViewer-541"><span class="linenos">541</span></a>
</span><span id="DisulfideViewer-542"><a href="#DisulfideViewer-542"><span class="linenos">542</span></a>    <span class="k">def</span> <span class="nf">export_scene</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideViewer-543"><a href="#DisulfideViewer-543"><span class="linenos">543</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-544"><a href="#DisulfideViewer-544"><span class="linenos">544</span></a><span class="sd">        Export the current scene as an HTML file</span>
</span><span id="DisulfideViewer-545"><a href="#DisulfideViewer-545"><span class="linenos">545</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-546"><a href="#DisulfideViewer-546"><span class="linenos">546</span></a>        <span class="n">options</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>
</span><span id="DisulfideViewer-547"><a href="#DisulfideViewer-547"><span class="linenos">547</span></a>        <span class="n">file_path</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span>
</span><span id="DisulfideViewer-548"><a href="#DisulfideViewer-548"><span class="linenos">548</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="DisulfideViewer-549"><a href="#DisulfideViewer-549"><span class="linenos">549</span></a>            <span class="s2">&quot;Export Scene&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer-550"><a href="#DisulfideViewer-550"><span class="linenos">550</span></a>            <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer-551"><a href="#DisulfideViewer-551"><span class="linenos">551</span></a>            <span class="s2">&quot;HTML Files (*.html);;All Files (*)&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer-552"><a href="#DisulfideViewer-552"><span class="linenos">552</span></a>            <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">,</span>
</span><span id="DisulfideViewer-553"><a href="#DisulfideViewer-553"><span class="linenos">553</span></a>        <span class="p">)</span>
</span><span id="DisulfideViewer-554"><a href="#DisulfideViewer-554"><span class="linenos">554</span></a>        <span class="k">if</span> <span class="n">file_path</span><span class="p">:</span>
</span><span id="DisulfideViewer-555"><a href="#DisulfideViewer-555"><span class="linenos">555</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">export_html</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="DisulfideViewer-556"><a href="#DisulfideViewer-556"><span class="linenos">556</span></a>
</span><span id="DisulfideViewer-557"><a href="#DisulfideViewer-557"><span class="linenos">557</span></a>    <span class="k">def</span> <span class="nf">add_custom_lights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotter</span><span class="p">):</span>
</span><span id="DisulfideViewer-558"><a href="#DisulfideViewer-558"><span class="linenos">558</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-559"><a href="#DisulfideViewer-559"><span class="linenos">559</span></a><span class="sd">        Adds custom lighting to the plotter for enhanced visualization.</span>
</span><span id="DisulfideViewer-560"><a href="#DisulfideViewer-560"><span class="linenos">560</span></a>
</span><span id="DisulfideViewer-561"><a href="#DisulfideViewer-561"><span class="linenos">561</span></a><span class="sd">        Parameters:</span>
</span><span id="DisulfideViewer-562"><a href="#DisulfideViewer-562"><span class="linenos">562</span></a><span class="sd">            plotter (QtInteractor): The PyVista plotter widget.</span>
</span><span id="DisulfideViewer-563"><a href="#DisulfideViewer-563"><span class="linenos">563</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-564"><a href="#DisulfideViewer-564"><span class="linenos">564</span></a>        <span class="c1"># Remove existing lights to prevent duplication</span>
</span><span id="DisulfideViewer-565"><a href="#DisulfideViewer-565"><span class="linenos">565</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">remove_all_lights</span><span class="p">()</span>
</span><span id="DisulfideViewer-566"><a href="#DisulfideViewer-566"><span class="linenos">566</span></a>
</span><span id="DisulfideViewer-567"><a href="#DisulfideViewer-567"><span class="linenos">567</span></a>        <span class="c1"># Define multiple light sources for better illumination</span>
</span><span id="DisulfideViewer-568"><a href="#DisulfideViewer-568"><span class="linenos">568</span></a>        <span class="n">light1</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Light</span><span class="p">(</span>
</span><span id="DisulfideViewer-569"><a href="#DisulfideViewer-569"><span class="linenos">569</span></a>            <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">focal_point</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">intensity</span><span class="o">=</span><span class="mf">1.0</span>
</span><span id="DisulfideViewer-570"><a href="#DisulfideViewer-570"><span class="linenos">570</span></a>        <span class="p">)</span>
</span><span id="DisulfideViewer-571"><a href="#DisulfideViewer-571"><span class="linenos">571</span></a>        <span class="n">light2</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Light</span><span class="p">(</span>
</span><span id="DisulfideViewer-572"><a href="#DisulfideViewer-572"><span class="linenos">572</span></a>            <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">focal_point</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">intensity</span><span class="o">=</span><span class="mf">0.5</span>
</span><span id="DisulfideViewer-573"><a href="#DisulfideViewer-573"><span class="linenos">573</span></a>        <span class="p">)</span>
</span><span id="DisulfideViewer-574"><a href="#DisulfideViewer-574"><span class="linenos">574</span></a>        <span class="n">light3</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Light</span><span class="p">(</span>
</span><span id="DisulfideViewer-575"><a href="#DisulfideViewer-575"><span class="linenos">575</span></a>            <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">),</span> <span class="n">focal_point</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">intensity</span><span class="o">=</span><span class="mf">0.5</span>
</span><span id="DisulfideViewer-576"><a href="#DisulfideViewer-576"><span class="linenos">576</span></a>        <span class="p">)</span>
</span><span id="DisulfideViewer-577"><a href="#DisulfideViewer-577"><span class="linenos">577</span></a>
</span><span id="DisulfideViewer-578"><a href="#DisulfideViewer-578"><span class="linenos">578</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">add_light</span><span class="p">(</span><span class="n">light1</span><span class="p">)</span>
</span><span id="DisulfideViewer-579"><a href="#DisulfideViewer-579"><span class="linenos">579</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">add_light</span><span class="p">(</span><span class="n">light2</span><span class="p">)</span>
</span><span id="DisulfideViewer-580"><a href="#DisulfideViewer-580"><span class="linenos">580</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">add_light</span><span class="p">(</span><span class="n">light3</span><span class="p">)</span>
</span><span id="DisulfideViewer-581"><a href="#DisulfideViewer-581"><span class="linenos">581</span></a>
</span><span id="DisulfideViewer-582"><a href="#DisulfideViewer-582"><span class="linenos">582</span></a>    <span class="k">def</span> <span class="nf">new_plotter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="DisulfideViewer-583"><a href="#DisulfideViewer-583"><span class="linenos">583</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-584"><a href="#DisulfideViewer-584"><span class="linenos">584</span></a><span class="sd">        Create a new QtInteractor with the specified number of rows and columns.</span>
</span><span id="DisulfideViewer-585"><a href="#DisulfideViewer-585"><span class="linenos">585</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-586"><a href="#DisulfideViewer-586"><span class="linenos">586</span></a>
</span><span id="DisulfideViewer-587"><a href="#DisulfideViewer-587"><span class="linenos">587</span></a>        <span class="c1"># Create a new QtInteractor with the desired shape</span>
</span><span id="DisulfideViewer-588"><a href="#DisulfideViewer-588"><span class="linenos">588</span></a>        <span class="n">new_plotter_widget</span> <span class="o">=</span> <span class="n">QtInteractor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">))</span>
</span><span id="DisulfideViewer-589"><a href="#DisulfideViewer-589"><span class="linenos">589</span></a>
</span><span id="DisulfideViewer-590"><a href="#DisulfideViewer-590"><span class="linenos">590</span></a>        <span class="c1"># Update the layout to replace the old plotter widget with the new one</span>
</span><span id="DisulfideViewer-591"><a href="#DisulfideViewer-591"><span class="linenos">591</span></a>        <span class="n">layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">centralWidget</span><span class="p">()</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span>
</span><span id="DisulfideViewer-592"><a href="#DisulfideViewer-592"><span class="linenos">592</span></a>        <span class="n">layout</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="p">)</span>  <span class="c1"># Remove the old plotter widget</span>
</span><span id="DisulfideViewer-593"><a href="#DisulfideViewer-593"><span class="linenos">593</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span>
</span><span id="DisulfideViewer-594"><a href="#DisulfideViewer-594"><span class="linenos">594</span></a>            <span class="kc">None</span>
</span><span id="DisulfideViewer-595"><a href="#DisulfideViewer-595"><span class="linenos">595</span></a>        <span class="p">)</span>  <span class="c1"># Detach the old plotter widget from its parent</span>
</span><span id="DisulfideViewer-596"><a href="#DisulfideViewer-596"><span class="linenos">596</span></a>
</span><span id="DisulfideViewer-597"><a href="#DisulfideViewer-597"><span class="linenos">597</span></a>        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">new_plotter_widget</span><span class="p">)</span>  <span class="c1"># Add the new plotter widget to the layout</span>
</span><span id="DisulfideViewer-598"><a href="#DisulfideViewer-598"><span class="linenos">598</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DisulfideViewer-599"><a href="#DisulfideViewer-599"><span class="linenos">599</span></a>            <span class="n">new_plotter_widget</span>  <span class="c1"># Update the reference to the new plotter widget</span>
</span><span id="DisulfideViewer-600"><a href="#DisulfideViewer-600"><span class="linenos">600</span></a>        <span class="p">)</span>
</span><span id="DisulfideViewer-601"><a href="#DisulfideViewer-601"><span class="linenos">601</span></a>
</span><span id="DisulfideViewer-602"><a href="#DisulfideViewer-602"><span class="linenos">602</span></a>    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">light</span><span class="o">=</span><span class="s2">&quot;Auto&quot;</span><span class="p">,</span> <span class="n">shadows</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="DisulfideViewer-603"><a href="#DisulfideViewer-603"><span class="linenos">603</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-604"><a href="#DisulfideViewer-604"><span class="linenos">604</span></a><span class="sd">        Renders the current disulfide bond using the specified style.</span>
</span><span id="DisulfideViewer-605"><a href="#DisulfideViewer-605"><span class="linenos">605</span></a>
</span><span id="DisulfideViewer-606"><a href="#DisulfideViewer-606"><span class="linenos">606</span></a><span class="sd">        Parameters:</span>
</span><span id="DisulfideViewer-607"><a href="#DisulfideViewer-607"><span class="linenos">607</span></a><span class="sd">            style (str): The rendering style (e.g., &#39;cpk&#39;, &#39;sb&#39;).</span>
</span><span id="DisulfideViewer-608"><a href="#DisulfideViewer-608"><span class="linenos">608</span></a><span class="sd">            light (str): The lighting theme (&#39;Light&#39;, &#39;Dark&#39;, or &#39;Auto&#39;).</span>
</span><span id="DisulfideViewer-609"><a href="#DisulfideViewer-609"><span class="linenos">609</span></a><span class="sd">            single (bool): Whether to display a single bond or multiple.</span>
</span><span id="DisulfideViewer-610"><a href="#DisulfideViewer-610"><span class="linenos">610</span></a><span class="sd">            winsize (tuple): The window size for rendering.</span>
</span><span id="DisulfideViewer-611"><a href="#DisulfideViewer-611"><span class="linenos">611</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-612"><a href="#DisulfideViewer-612"><span class="linenos">612</span></a>        <span class="n">style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_style</span>
</span><span id="DisulfideViewer-613"><a href="#DisulfideViewer-613"><span class="linenos">613</span></a>        <span class="n">camera_position</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>  <span class="c1"># Example values</span>
</span><span id="DisulfideViewer-614"><a href="#DisulfideViewer-614"><span class="linenos">614</span></a>
</span><span id="DisulfideViewer-615"><a href="#DisulfideViewer-615"><span class="linenos">615</span></a>        <span class="n">plotter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span>  <span class="c1"># Use QtInteractor as the plotter</span>
</span><span id="DisulfideViewer-616"><a href="#DisulfideViewer-616"><span class="linenos">616</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">camera_position</span> <span class="o">=</span> <span class="n">camera_position</span>
</span><span id="DisulfideViewer-617"><a href="#DisulfideViewer-617"><span class="linenos">617</span></a>
</span><span id="DisulfideViewer-618"><a href="#DisulfideViewer-618"><span class="linenos">618</span></a>        <span class="c1"># Set the camera up vector</span>
</span><span id="DisulfideViewer-619"><a href="#DisulfideViewer-619"><span class="linenos">619</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">camera_set</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DisulfideViewer-620"><a href="#DisulfideViewer-620"><span class="linenos">620</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">view_up</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="DisulfideViewer-621"><a href="#DisulfideViewer-621"><span class="linenos">621</span></a>
</span><span id="DisulfideViewer-622"><a href="#DisulfideViewer-622"><span class="linenos">622</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="DisulfideViewer-623"><a href="#DisulfideViewer-623"><span class="linenos">623</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">add_axes</span><span class="p">()</span>
</span><span id="DisulfideViewer-624"><a href="#DisulfideViewer-624"><span class="linenos">624</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="DisulfideViewer-625"><a href="#DisulfideViewer-625"><span class="linenos">625</span></a>
</span><span id="DisulfideViewer-626"><a href="#DisulfideViewer-626"><span class="linenos">626</span></a>        <span class="k">if</span> <span class="n">shadows</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="DisulfideViewer-627"><a href="#DisulfideViewer-627"><span class="linenos">627</span></a>            <span class="n">plotter</span><span class="o">.</span><span class="n">enable_shadows</span><span class="p">()</span>
</span><span id="DisulfideViewer-628"><a href="#DisulfideViewer-628"><span class="linenos">628</span></a>
</span><span id="DisulfideViewer-629"><a href="#DisulfideViewer-629"><span class="linenos">629</span></a>        <span class="n">title</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DisulfideViewer-630"><a href="#DisulfideViewer-630"><span class="linenos">630</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">energy</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> kcal/mol. &quot;</span>
</span><span id="DisulfideViewer-631"><a href="#DisulfideViewer-631"><span class="linenos">631</span></a>            <span class="sa">f</span><span class="s2">&quot;C: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">ca_distance</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">  &quot;</span>
</span><span id="DisulfideViewer-632"><a href="#DisulfideViewer-632"><span class="linenos">632</span></a>            <span class="sa">f</span><span class="s2">&quot;C: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">cb_distance</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">  &quot;</span>
</span><span id="DisulfideViewer-633"><a href="#DisulfideViewer-633"><span class="linenos">633</span></a>            <span class="sa">f</span><span class="s2">&quot;Tors: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">torsion_length</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DisulfideViewer-634"><a href="#DisulfideViewer-634"><span class="linenos">634</span></a>        <span class="p">)</span>
</span><span id="DisulfideViewer-635"><a href="#DisulfideViewer-635"><span class="linenos">635</span></a>        <span class="c1"># Determine the theme and set the background color</span>
</span><span id="DisulfideViewer-636"><a href="#DisulfideViewer-636"><span class="linenos">636</span></a>        <span class="n">_theme</span> <span class="o">=</span> <span class="n">light</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">light</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Light&quot;</span><span class="p">,</span> <span class="s2">&quot;Dark&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="n">get_theme</span><span class="p">()</span>
</span><span id="DisulfideViewer-637"><a href="#DisulfideViewer-637"><span class="linenos">637</span></a>        <span class="k">if</span> <span class="n">_theme</span> <span class="o">==</span> <span class="s2">&quot;dark&quot;</span><span class="p">:</span>
</span><span id="DisulfideViewer-638"><a href="#DisulfideViewer-638"><span class="linenos">638</span></a>            <span class="n">pv</span><span class="o">.</span><span class="n">set_plot_theme</span><span class="p">(</span><span class="s2">&quot;dark&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-639"><a href="#DisulfideViewer-639"><span class="linenos">639</span></a>            <span class="n">plotter</span><span class="o">.</span><span class="n">set_background</span><span class="p">(</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-640"><a href="#DisulfideViewer-640"><span class="linenos">640</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideViewer-641"><a href="#DisulfideViewer-641"><span class="linenos">641</span></a>            <span class="n">pv</span><span class="o">.</span><span class="n">set_plot_theme</span><span class="p">(</span><span class="s2">&quot;document&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-642"><a href="#DisulfideViewer-642"><span class="linenos">642</span></a>            <span class="n">plotter</span><span class="o">.</span><span class="n">set_background</span><span class="p">(</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-643"><a href="#DisulfideViewer-643"><span class="linenos">643</span></a>
</span><span id="DisulfideViewer-644"><a href="#DisulfideViewer-644"><span class="linenos">644</span></a>        <span class="c1"># Apply the current theme</span>
</span><span id="DisulfideViewer-645"><a href="#DisulfideViewer-645"><span class="linenos">645</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_theme</span> <span class="o">=</span> <span class="n">_theme</span>
</span><span id="DisulfideViewer-646"><a href="#DisulfideViewer-646"><span class="linenos">646</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">apply_theme</span><span class="p">()</span>
</span><span id="DisulfideViewer-647"><a href="#DisulfideViewer-647"><span class="linenos">647</span></a>
</span><span id="DisulfideViewer-648"><a href="#DisulfideViewer-648"><span class="linenos">648</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-649"><a href="#DisulfideViewer-649"><span class="linenos">649</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">enable_anti_aliasing</span><span class="p">(</span><span class="s2">&quot;msaa&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-650"><a href="#DisulfideViewer-650"><span class="linenos">650</span></a>
</span><span id="DisulfideViewer-651"><a href="#DisulfideViewer-651"><span class="linenos">651</span></a>        <span class="c1"># Add custom lights</span>
</span><span id="DisulfideViewer-652"><a href="#DisulfideViewer-652"><span class="linenos">652</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_custom_lights</span><span class="p">(</span><span class="n">plotter</span><span class="p">)</span>
</span><span id="DisulfideViewer-653"><a href="#DisulfideViewer-653"><span class="linenos">653</span></a>
</span><span id="DisulfideViewer-654"><a href="#DisulfideViewer-654"><span class="linenos">654</span></a>        <span class="c1"># Perform the plotting with the specified style</span>
</span><span id="DisulfideViewer-655"><a href="#DisulfideViewer-655"><span class="linenos">655</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">single</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="DisulfideViewer-656"><a href="#DisulfideViewer-656"><span class="linenos">656</span></a>            <span class="c1"># self.new_plotter(rows=1, cols=1)</span>
</span><span id="DisulfideViewer-657"><a href="#DisulfideViewer-657"><span class="linenos">657</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">plotter</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>
</span><span id="DisulfideViewer-658"><a href="#DisulfideViewer-658"><span class="linenos">658</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideViewer-659"><a href="#DisulfideViewer-659"><span class="linenos">659</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_overlay</span><span class="p">(</span><span class="n">plotter</span><span class="p">)</span>
</span><span id="DisulfideViewer-660"><a href="#DisulfideViewer-660"><span class="linenos">660</span></a>
</span><span id="DisulfideViewer-661"><a href="#DisulfideViewer-661"><span class="linenos">661</span></a>        <span class="c1"># Set perspective projection</span>
</span><span id="DisulfideViewer-662"><a href="#DisulfideViewer-662"><span class="linenos">662</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">SetParallelProjection</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># False for perspective</span>
</span><span id="DisulfideViewer-663"><a href="#DisulfideViewer-663"><span class="linenos">663</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="DisulfideViewer-664"><a href="#DisulfideViewer-664"><span class="linenos">664</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</span><span id="DisulfideViewer-665"><a href="#DisulfideViewer-665"><span class="linenos">665</span></a>
</span><span id="DisulfideViewer-666"><a href="#DisulfideViewer-666"><span class="linenos">666</span></a>    <span class="k">def</span> <span class="nf">display_overlay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pl</span><span class="p">):</span>
</span><span id="DisulfideViewer-667"><a href="#DisulfideViewer-667"><span class="linenos">667</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-668"><a href="#DisulfideViewer-668"><span class="linenos">668</span></a><span class="sd">        Display all disulfides in the list overlaid in stick mode against</span>
</span><span id="DisulfideViewer-669"><a href="#DisulfideViewer-669"><span class="linenos">669</span></a><span class="sd">        a common coordinate frames. This allows us to see all of the disulfides</span>
</span><span id="DisulfideViewer-670"><a href="#DisulfideViewer-670"><span class="linenos">670</span></a><span class="sd">        at one time in a single view. Colors vary smoothy between bonds.</span>
</span><span id="DisulfideViewer-671"><a href="#DisulfideViewer-671"><span class="linenos">671</span></a>
</span><span id="DisulfideViewer-672"><a href="#DisulfideViewer-672"><span class="linenos">672</span></a><span class="sd">        :param screenshot: Save a screenshot, defaults to False</span>
</span><span id="DisulfideViewer-673"><a href="#DisulfideViewer-673"><span class="linenos">673</span></a><span class="sd">        :param movie: Save a movie, defaults to False</span>
</span><span id="DisulfideViewer-674"><a href="#DisulfideViewer-674"><span class="linenos">674</span></a><span class="sd">        :param verbose: Verbosity, defaults to True</span>
</span><span id="DisulfideViewer-675"><a href="#DisulfideViewer-675"><span class="linenos">675</span></a><span class="sd">        :param fname: Filename to save for the movie or screenshot, defaults to &#39;ss_overlay.png&#39;</span>
</span><span id="DisulfideViewer-676"><a href="#DisulfideViewer-676"><span class="linenos">676</span></a><span class="sd">        :param light: Background color, defaults to True for White. False for Dark.</span>
</span><span id="DisulfideViewer-677"><a href="#DisulfideViewer-677"><span class="linenos">677</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer-678"><a href="#DisulfideViewer-678"><span class="linenos">678</span></a>        <span class="n">sslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_sslist</span>
</span><span id="DisulfideViewer-679"><a href="#DisulfideViewer-679"><span class="linenos">679</span></a>        <span class="n">ssbonds</span> <span class="o">=</span> <span class="n">sslist</span><span class="o">.</span><span class="n">data</span>
</span><span id="DisulfideViewer-680"><a href="#DisulfideViewer-680"><span class="linenos">680</span></a>        <span class="n">tot_ss</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ssbonds</span><span class="p">)</span>  <span class="c1"># number off ssbonds</span>
</span><span id="DisulfideViewer-681"><a href="#DisulfideViewer-681"><span class="linenos">681</span></a>        <span class="n">avg_enrg</span> <span class="o">=</span> <span class="n">sslist</span><span class="o">.</span><span class="n">average_energy</span>
</span><span id="DisulfideViewer-682"><a href="#DisulfideViewer-682"><span class="linenos">682</span></a>        <span class="n">avg_dist</span> <span class="o">=</span> <span class="n">sslist</span><span class="o">.</span><span class="n">average_distance</span>
</span><span id="DisulfideViewer-683"><a href="#DisulfideViewer-683"><span class="linenos">683</span></a>        <span class="n">resolution</span> <span class="o">=</span> <span class="n">sslist</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="DisulfideViewer-684"><a href="#DisulfideViewer-684"><span class="linenos">684</span></a>
</span><span id="DisulfideViewer-685"><a href="#DisulfideViewer-685"><span class="linenos">685</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="mi">100</span>
</span><span id="DisulfideViewer-686"><a href="#DisulfideViewer-686"><span class="linenos">686</span></a>
</span><span id="DisulfideViewer-687"><a href="#DisulfideViewer-687"><span class="linenos">687</span></a>        <span class="k">if</span> <span class="n">tot_ss</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
</span><span id="DisulfideViewer-688"><a href="#DisulfideViewer-688"><span class="linenos">688</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="mi">60</span>
</span><span id="DisulfideViewer-689"><a href="#DisulfideViewer-689"><span class="linenos">689</span></a>        <span class="k">if</span> <span class="n">tot_ss</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>
</span><span id="DisulfideViewer-690"><a href="#DisulfideViewer-690"><span class="linenos">690</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="mi">30</span>
</span><span id="DisulfideViewer-691"><a href="#DisulfideViewer-691"><span class="linenos">691</span></a>        <span class="k">if</span> <span class="n">tot_ss</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
</span><span id="DisulfideViewer-692"><a href="#DisulfideViewer-692"><span class="linenos">692</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="mi">8</span>
</span><span id="DisulfideViewer-693"><a href="#DisulfideViewer-693"><span class="linenos">693</span></a>
</span><span id="DisulfideViewer-694"><a href="#DisulfideViewer-694"><span class="linenos">694</span></a>        <span class="n">title</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DisulfideViewer-695"><a href="#DisulfideViewer-695"><span class="linenos">695</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">resolution</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> : (</span><span class="si">{</span><span class="n">tot_ss</span><span class="si">}</span><span class="s2"> SS), &quot;</span>
</span><span id="DisulfideViewer-696"><a href="#DisulfideViewer-696"><span class="linenos">696</span></a>            <span class="sa">f</span><span class="s2">&quot;Avg E: </span><span class="si">{</span><span class="n">avg_enrg</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> kcal/mol, Avg Dist: </span><span class="si">{</span><span class="n">avg_dist</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="DisulfideViewer-697"><a href="#DisulfideViewer-697"><span class="linenos">697</span></a>        <span class="p">)</span>
</span><span id="DisulfideViewer-698"><a href="#DisulfideViewer-698"><span class="linenos">698</span></a>
</span><span id="DisulfideViewer-699"><a href="#DisulfideViewer-699"><span class="linenos">699</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer-700"><a href="#DisulfideViewer-700"><span class="linenos">700</span></a>
</span><span id="DisulfideViewer-701"><a href="#DisulfideViewer-701"><span class="linenos">701</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">add_axes</span><span class="p">()</span>
</span><span id="DisulfideViewer-702"><a href="#DisulfideViewer-702"><span class="linenos">702</span></a>
</span><span id="DisulfideViewer-703"><a href="#DisulfideViewer-703"><span class="linenos">703</span></a>        <span class="n">mycol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">tot_ss</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</span><span id="DisulfideViewer-704"><a href="#DisulfideViewer-704"><span class="linenos">704</span></a>        <span class="n">mycol</span> <span class="o">=</span> <span class="n">get_jet_colormap</span><span class="p">(</span><span class="n">tot_ss</span><span class="p">)</span>
</span><span id="DisulfideViewer-705"><a href="#DisulfideViewer-705"><span class="linenos">705</span></a>
</span><span id="DisulfideViewer-706"><a href="#DisulfideViewer-706"><span class="linenos">706</span></a>        <span class="c1"># scale the overlay bond radii down so that we can see the individual elements better</span>
</span><span id="DisulfideViewer-707"><a href="#DisulfideViewer-707"><span class="linenos">707</span></a>        <span class="c1"># maximum 90% reduction</span>
</span><span id="DisulfideViewer-708"><a href="#DisulfideViewer-708"><span class="linenos">708</span></a>
</span><span id="DisulfideViewer-709"><a href="#DisulfideViewer-709"><span class="linenos">709</span></a>        <span class="k">if</span> <span class="n">tot_ss</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="DisulfideViewer-710"><a href="#DisulfideViewer-710"><span class="linenos">710</span></a>            <span class="n">brad</span> <span class="o">=</span> <span class="n">BOND_RADIUS</span>
</span><span id="DisulfideViewer-711"><a href="#DisulfideViewer-711"><span class="linenos">711</span></a>        <span class="k">elif</span> <span class="n">tot_ss</span> <span class="o">&lt;</span> <span class="mi">25</span><span class="p">:</span>
</span><span id="DisulfideViewer-712"><a href="#DisulfideViewer-712"><span class="linenos">712</span></a>            <span class="n">brad</span> <span class="o">=</span> <span class="n">BOND_RADIUS</span> <span class="o">*</span> <span class="mf">0.75</span>
</span><span id="DisulfideViewer-713"><a href="#DisulfideViewer-713"><span class="linenos">713</span></a>        <span class="k">elif</span> <span class="n">tot_ss</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">:</span>
</span><span id="DisulfideViewer-714"><a href="#DisulfideViewer-714"><span class="linenos">714</span></a>            <span class="n">brad</span> <span class="o">=</span> <span class="n">BOND_RADIUS</span> <span class="o">*</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="mf">0.8</span>
</span><span id="DisulfideViewer-715"><a href="#DisulfideViewer-715"><span class="linenos">715</span></a>        <span class="k">elif</span> <span class="n">tot_ss</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
</span><span id="DisulfideViewer-716"><a href="#DisulfideViewer-716"><span class="linenos">716</span></a>            <span class="n">brad</span> <span class="o">=</span> <span class="n">BOND_RADIUS</span> <span class="o">*</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="mf">0.7</span>
</span><span id="DisulfideViewer-717"><a href="#DisulfideViewer-717"><span class="linenos">717</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideViewer-718"><a href="#DisulfideViewer-718"><span class="linenos">718</span></a>            <span class="n">brad</span> <span class="o">=</span> <span class="n">BOND_RADIUS</span> <span class="o">*</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="mf">0.6</span>
</span><span id="DisulfideViewer-719"><a href="#DisulfideViewer-719"><span class="linenos">719</span></a>
</span><span id="DisulfideViewer-720"><a href="#DisulfideViewer-720"><span class="linenos">720</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ss</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">tot_ss</span><span class="p">),</span> <span class="n">ssbonds</span><span class="p">):</span>
</span><span id="DisulfideViewer-721"><a href="#DisulfideViewer-721"><span class="linenos">721</span></a>            <span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mycol</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">mycol</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">mycol</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])]</span>
</span><span id="DisulfideViewer-722"><a href="#DisulfideViewer-722"><span class="linenos">722</span></a>            <span class="n">ss</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span>
</span><span id="DisulfideViewer-723"><a href="#DisulfideViewer-723"><span class="linenos">723</span></a>                <span class="n">pl</span><span class="p">,</span>
</span><span id="DisulfideViewer-724"><a href="#DisulfideViewer-724"><span class="linenos">724</span></a>                <span class="n">style</span><span class="o">=</span><span class="s2">&quot;plain&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer-725"><a href="#DisulfideViewer-725"><span class="linenos">725</span></a>                <span class="n">bondcolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
</span><span id="DisulfideViewer-726"><a href="#DisulfideViewer-726"><span class="linenos">726</span></a>                <span class="n">translate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideViewer-727"><a href="#DisulfideViewer-727"><span class="linenos">727</span></a>                <span class="n">bond_radius</span><span class="o">=</span><span class="n">brad</span><span class="p">,</span>
</span><span id="DisulfideViewer-728"><a href="#DisulfideViewer-728"><span class="linenos">728</span></a>                <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="p">,</span>
</span><span id="DisulfideViewer-729"><a href="#DisulfideViewer-729"><span class="linenos">729</span></a>            <span class="p">)</span>
</span><span id="DisulfideViewer-730"><a href="#DisulfideViewer-730"><span class="linenos">730</span></a>
</span><span id="DisulfideViewer-731"><a href="#DisulfideViewer-731"><span class="linenos">731</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_camera_view</span><span class="p">()</span>
</span><span id="DisulfideViewer-732"><a href="#DisulfideViewer-732"><span class="linenos">732</span></a>
</span><span id="DisulfideViewer-733"><a href="#DisulfideViewer-733"><span class="linenos">733</span></a>        <span class="k">return</span> <span class="n">pl</span>
</span></pre></div>


            <div class="docstring"><p>A PyQt5-based application for viewing molecular structures with support for
multiple disulfide bonds and various rendering styles.</p>

<p>Attributes:
    ss_list (list): List of disulfide bond objects.
    current_ss (object): Currently selected disulfide bond.
    current_style (str): Currently selected rendering style.
    plotter_widget (QtInteractor): PyVista QtInteractor widget for 3D visualization.
    ss_dict (dict): Dictionary where keys are pdb_id and values are lists of disulfides
    with that pdb_id.</p>
</div>


                            <div id="DisulfideViewer.__init__" class="classattr">
                                        <input id="DisulfideViewer.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">DisulfideViewer</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">ss_list</span>, </span><span class="param"><span class="n">winsize</span><span class="o">=</span><span class="p">(</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">800</span><span class="p">)</span></span>)</span>

                <label class="view-source-button" for="DisulfideViewer.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.__init__-111"><a href="#DisulfideViewer.__init__-111"><span class="linenos">111</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ss_list</span><span class="p">,</span> <span class="n">winsize</span><span class="o">=</span><span class="p">(</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">800</span><span class="p">)):</span>
</span><span id="DisulfideViewer.__init__-112"><a href="#DisulfideViewer.__init__-112"><span class="linenos">112</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.__init__-113"><a href="#DisulfideViewer.__init__-113"><span class="linenos">113</span></a><span class="sd">        Initializes the MolecularViewer application.</span>
</span><span id="DisulfideViewer.__init__-114"><a href="#DisulfideViewer.__init__-114"><span class="linenos">114</span></a>
</span><span id="DisulfideViewer.__init__-115"><a href="#DisulfideViewer.__init__-115"><span class="linenos">115</span></a><span class="sd">        Parameters:</span>
</span><span id="DisulfideViewer.__init__-116"><a href="#DisulfideViewer.__init__-116"><span class="linenos">116</span></a><span class="sd">            ss_list (list): List of disulfide bond objects.</span>
</span><span id="DisulfideViewer.__init__-117"><a href="#DisulfideViewer.__init__-117"><span class="linenos">117</span></a><span class="sd">            winsize (tuple): Minimum size for the PyVista plotter widget.</span>
</span><span id="DisulfideViewer.__init__-118"><a href="#DisulfideViewer.__init__-118"><span class="linenos">118</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.__init__-119"><a href="#DisulfideViewer.__init__-119"><span class="linenos">119</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="DisulfideViewer.__init__-120"><a href="#DisulfideViewer.__init__-120"><span class="linenos">120</span></a>
</span><span id="DisulfideViewer.__init__-121"><a href="#DisulfideViewer.__init__-121"><span class="linenos">121</span></a>        <span class="c1"># Define color dictionary</span>
</span><span id="DisulfideViewer.__init__-122"><a href="#DisulfideViewer.__init__-122"><span class="linenos">122</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">colors</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DisulfideViewer.__init__-123"><a href="#DisulfideViewer.__init__-123"><span class="linenos">123</span></a>            <span class="s2">&quot;dark&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="DisulfideViewer.__init__-124"><a href="#DisulfideViewer.__init__-124"><span class="linenos">124</span></a>                <span class="s2">&quot;background&quot;</span><span class="p">:</span> <span class="s2">&quot;#2E2E2E&quot;</span><span class="p">,</span>  <span class="c1"># Dark Gray</span>
</span><span id="DisulfideViewer.__init__-125"><a href="#DisulfideViewer.__init__-125"><span class="linenos">125</span></a>                <span class="s2">&quot;midnight_blue&quot;</span><span class="p">:</span> <span class="s2">&quot;#191970&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer.__init__-126"><a href="#DisulfideViewer.__init__-126"><span class="linenos">126</span></a>                <span class="s2">&quot;dark_slate_gray&quot;</span><span class="p">:</span> <span class="s2">&quot;#2F4F4F&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer.__init__-127"><a href="#DisulfideViewer.__init__-127"><span class="linenos">127</span></a>                <span class="s2">&quot;charcoal&quot;</span><span class="p">:</span> <span class="s2">&quot;#36454F&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer.__init__-128"><a href="#DisulfideViewer.__init__-128"><span class="linenos">128</span></a>                <span class="s2">&quot;deep_space_sparkle&quot;</span><span class="p">:</span> <span class="s2">&quot;#4A646C&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer.__init__-129"><a href="#DisulfideViewer.__init__-129"><span class="linenos">129</span></a>                <span class="s2">&quot;black&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer.__init__-130"><a href="#DisulfideViewer.__init__-130"><span class="linenos">130</span></a>            <span class="p">},</span>
</span><span id="DisulfideViewer.__init__-131"><a href="#DisulfideViewer.__init__-131"><span class="linenos">131</span></a>            <span class="s2">&quot;light&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="DisulfideViewer.__init__-132"><a href="#DisulfideViewer.__init__-132"><span class="linenos">132</span></a>                <span class="s2">&quot;background&quot;</span><span class="p">:</span> <span class="s2">&quot;#FFFFFF&quot;</span><span class="p">,</span>  <span class="c1"># White</span>
</span><span id="DisulfideViewer.__init__-133"><a href="#DisulfideViewer.__init__-133"><span class="linenos">133</span></a>                <span class="s2">&quot;light_gray&quot;</span><span class="p">:</span> <span class="s2">&quot;#D3D3D3&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer.__init__-134"><a href="#DisulfideViewer.__init__-134"><span class="linenos">134</span></a>                <span class="s2">&quot;ivory&quot;</span><span class="p">:</span> <span class="s2">&quot;#FFFFF0&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer.__init__-135"><a href="#DisulfideViewer.__init__-135"><span class="linenos">135</span></a>                <span class="s2">&quot;honeydew&quot;</span><span class="p">:</span> <span class="s2">&quot;#F0FFF0&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer.__init__-136"><a href="#DisulfideViewer.__init__-136"><span class="linenos">136</span></a>                <span class="s2">&quot;azure&quot;</span><span class="p">:</span> <span class="s2">&quot;#F0FFFF&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer.__init__-137"><a href="#DisulfideViewer.__init__-137"><span class="linenos">137</span></a>            <span class="p">},</span>
</span><span id="DisulfideViewer.__init__-138"><a href="#DisulfideViewer.__init__-138"><span class="linenos">138</span></a>        <span class="p">}</span>
</span><span id="DisulfideViewer.__init__-139"><a href="#DisulfideViewer.__init__-139"><span class="linenos">139</span></a>
</span><span id="DisulfideViewer.__init__-140"><a href="#DisulfideViewer.__init__-140"><span class="linenos">140</span></a>        <span class="c1"># Set up the main window</span>
</span><span id="DisulfideViewer.__init__-141"><a href="#DisulfideViewer.__init__-141"><span class="linenos">141</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_version</span> <span class="o">=</span> <span class="n">_version</span>
</span><span id="DisulfideViewer.__init__-142"><a href="#DisulfideViewer.__init__-142"><span class="linenos">142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;proteusPy Disulfide Viewer&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-143"><a href="#DisulfideViewer.__init__-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">winsize</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">winsize</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="DisulfideViewer.__init__-144"><a href="#DisulfideViewer.__init__-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideViewer.__init__-145"><a href="#DisulfideViewer.__init__-145"><span class="linenos">145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_frame</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DisulfideViewer.__init__-146"><a href="#DisulfideViewer.__init__-146"><span class="linenos">146</span></a>
</span><span id="DisulfideViewer.__init__-147"><a href="#DisulfideViewer.__init__-147"><span class="linenos">147</span></a>        <span class="c1"># Validate and store the list of disulfides</span>
</span><span id="DisulfideViewer.__init__-148"><a href="#DisulfideViewer.__init__-148"><span class="linenos">148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span> <span class="o">=</span> <span class="n">ss_list</span>
</span><span id="DisulfideViewer.__init__-149"><a href="#DisulfideViewer.__init__-149"><span class="linenos">149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="DisulfideViewer.__init__-150"><a href="#DisulfideViewer.__init__-150"><span class="linenos">150</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdb_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="DisulfideViewer.__init__-151"><a href="#DisulfideViewer.__init__-151"><span class="linenos">151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_style</span> <span class="o">=</span> <span class="s2">&quot;sb&quot;</span>  <span class="c1"># Initialize with default style</span>
</span><span id="DisulfideViewer.__init__-152"><a href="#DisulfideViewer.__init__-152"><span class="linenos">152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">single</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DisulfideViewer.__init__-153"><a href="#DisulfideViewer.__init__-153"><span class="linenos">153</span></a>
</span><span id="DisulfideViewer.__init__-154"><a href="#DisulfideViewer.__init__-154"><span class="linenos">154</span></a>        <span class="c1"># Create a dictionary where keys are pdb_id and values are lists of disulfides</span>
</span><span id="DisulfideViewer.__init__-155"><a href="#DisulfideViewer.__init__-155"><span class="linenos">155</span></a>        <span class="c1"># with that pdb_id</span>
</span><span id="DisulfideViewer.__init__-156"><a href="#DisulfideViewer.__init__-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s2">&quot;sublist&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-157"><a href="#DisulfideViewer.__init__-157"><span class="linenos">157</span></a>
</span><span id="DisulfideViewer.__init__-158"><a href="#DisulfideViewer.__init__-158"><span class="linenos">158</span></a>        <span class="c1"># Populate the dictionary with key pdb_id and values list of disulfides</span>
</span><span id="DisulfideViewer.__init__-159"><a href="#DisulfideViewer.__init__-159"><span class="linenos">159</span></a>        <span class="c1"># for that pdb_id</span>
</span><span id="DisulfideViewer.__init__-160"><a href="#DisulfideViewer.__init__-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideViewer.__init__-161"><a href="#DisulfideViewer.__init__-161"><span class="linenos">161</span></a>        <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span><span class="p">:</span>
</span><span id="DisulfideViewer.__init__-162"><a href="#DisulfideViewer.__init__-162"><span class="linenos">162</span></a>            <span class="k">if</span> <span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="p">:</span>
</span><span id="DisulfideViewer.__init__-163"><a href="#DisulfideViewer.__init__-163"><span class="linenos">163</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="p">[</span><span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DisulfideViewer.__init__-164"><a href="#DisulfideViewer.__init__-164"><span class="linenos">164</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="p">[</span><span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-165"><a href="#DisulfideViewer.__init__-165"><span class="linenos">165</span></a>
</span><span id="DisulfideViewer.__init__-166"><a href="#DisulfideViewer.__init__-166"><span class="linenos">166</span></a>        <span class="c1"># Create buttons for different rendering styles</span>
</span><span id="DisulfideViewer.__init__-167"><a href="#DisulfideViewer.__init__-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_cpk</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;CPK&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-168"><a href="#DisulfideViewer.__init__-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_sb</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;SB&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-169"><a href="#DisulfideViewer.__init__-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_bs</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;BS&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-170"><a href="#DisulfideViewer.__init__-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_pd</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;PD&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-171"><a href="#DisulfideViewer.__init__-171"><span class="linenos">171</span></a>
</span><span id="DisulfideViewer.__init__-172"><a href="#DisulfideViewer.__init__-172"><span class="linenos">172</span></a>        <span class="c1"># Connect buttons to methods with style tracking</span>
</span><span id="DisulfideViewer.__init__-173"><a href="#DisulfideViewer.__init__-173"><span class="linenos">173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_cpk</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_style</span><span class="p">(</span><span class="s2">&quot;cpk&quot;</span><span class="p">))</span>
</span><span id="DisulfideViewer.__init__-174"><a href="#DisulfideViewer.__init__-174"><span class="linenos">174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_sb</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_style</span><span class="p">(</span><span class="s2">&quot;sb&quot;</span><span class="p">))</span>
</span><span id="DisulfideViewer.__init__-175"><a href="#DisulfideViewer.__init__-175"><span class="linenos">175</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_bs</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_style</span><span class="p">(</span><span class="s2">&quot;bs&quot;</span><span class="p">))</span>
</span><span id="DisulfideViewer.__init__-176"><a href="#DisulfideViewer.__init__-176"><span class="linenos">176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_pd</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_style</span><span class="p">(</span><span class="s2">&quot;pd&quot;</span><span class="p">))</span>
</span><span id="DisulfideViewer.__init__-177"><a href="#DisulfideViewer.__init__-177"><span class="linenos">177</span></a>
</span><span id="DisulfideViewer.__init__-178"><a href="#DisulfideViewer.__init__-178"><span class="linenos">178</span></a>        <span class="c1"># Create a text box for entering PDB IDs</span>
</span><span id="DisulfideViewer.__init__-179"><a href="#DisulfideViewer.__init__-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
</span><span id="DisulfideViewer.__init__-180"><a href="#DisulfideViewer.__init__-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s2">&quot;Enter PDB ID&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-181"><a href="#DisulfideViewer.__init__-181"><span class="linenos">181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span><span class="o">.</span><span class="n">returnPressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_pdb_textbox_enter</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-182"><a href="#DisulfideViewer.__init__-182"><span class="linenos">182</span></a>
</span><span id="DisulfideViewer.__init__-183"><a href="#DisulfideViewer.__init__-183"><span class="linenos">183</span></a>        <span class="c1"># Create a dropdown selector for PDB IDs</span>
</span><span id="DisulfideViewer.__init__-184"><a href="#DisulfideViewer.__init__-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
</span><span id="DisulfideViewer.__init__-185"><a href="#DisulfideViewer.__init__-185"><span class="linenos">185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="DisulfideViewer.__init__-186"><a href="#DisulfideViewer.__init__-186"><span class="linenos">186</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_pdb_dropdown_change</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-187"><a href="#DisulfideViewer.__init__-187"><span class="linenos">187</span></a>
</span><span id="DisulfideViewer.__init__-188"><a href="#DisulfideViewer.__init__-188"><span class="linenos">188</span></a>        <span class="c1"># Create a dropdown selector for Disulfides</span>
</span><span id="DisulfideViewer.__init__-189"><a href="#DisulfideViewer.__init__-189"><span class="linenos">189</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
</span><span id="DisulfideViewer.__init__-190"><a href="#DisulfideViewer.__init__-190"><span class="linenos">190</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">ss</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span><span class="p">])</span>
</span><span id="DisulfideViewer.__init__-191"><a href="#DisulfideViewer.__init__-191"><span class="linenos">191</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_dropdown_change</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-192"><a href="#DisulfideViewer.__init__-192"><span class="linenos">192</span></a>
</span><span id="DisulfideViewer.__init__-193"><a href="#DisulfideViewer.__init__-193"><span class="linenos">193</span></a>        <span class="c1"># Create a button to toggle themes</span>
</span><span id="DisulfideViewer.__init__-194"><a href="#DisulfideViewer.__init__-194"><span class="linenos">194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_theme</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Toggle Theme&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-195"><a href="#DisulfideViewer.__init__-195"><span class="linenos">195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_theme</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_theme</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-196"><a href="#DisulfideViewer.__init__-196"><span class="linenos">196</span></a>
</span><span id="DisulfideViewer.__init__-197"><a href="#DisulfideViewer.__init__-197"><span class="linenos">197</span></a>        <span class="c1"># Create a checkbox for single/multiple display</span>
</span><span id="DisulfideViewer.__init__-198"><a href="#DisulfideViewer.__init__-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">checkbox_single</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Single&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-199"><a href="#DisulfideViewer.__init__-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">checkbox_single</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-200"><a href="#DisulfideViewer.__init__-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">checkbox_single</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_checkbox_single_change</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-201"><a href="#DisulfideViewer.__init__-201"><span class="linenos">201</span></a>
</span><span id="DisulfideViewer.__init__-202"><a href="#DisulfideViewer.__init__-202"><span class="linenos">202</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_reset</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Reset Camera&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-203"><a href="#DisulfideViewer.__init__-203"><span class="linenos">203</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_reset</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_camera_view</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-204"><a href="#DisulfideViewer.__init__-204"><span class="linenos">204</span></a>
</span><span id="DisulfideViewer.__init__-205"><a href="#DisulfideViewer.__init__-205"><span class="linenos">205</span></a>        <span class="c1"># Create a font object with increased size</span>
</span><span id="DisulfideViewer.__init__-206"><a href="#DisulfideViewer.__init__-206"><span class="linenos">206</span></a>        <span class="n">font</span> <span class="o">=</span> <span class="n">QFont</span><span class="p">()</span>
</span><span id="DisulfideViewer.__init__-207"><a href="#DisulfideViewer.__init__-207"><span class="linenos">207</span></a>        <span class="n">font</span><span class="o">.</span><span class="n">setPointSize</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>  <span class="c1"># Set the desired font size</span>
</span><span id="DisulfideViewer.__init__-208"><a href="#DisulfideViewer.__init__-208"><span class="linenos">208</span></a>
</span><span id="DisulfideViewer.__init__-209"><a href="#DisulfideViewer.__init__-209"><span class="linenos">209</span></a>        <span class="c1"># Group the PDB controls</span>
</span><span id="DisulfideViewer.__init__-210"><a href="#DisulfideViewer.__init__-210"><span class="linenos">210</span></a>        <span class="n">pdb_groupbox</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;PDB Controls&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-211"><a href="#DisulfideViewer.__init__-211"><span class="linenos">211</span></a>        <span class="n">pdb_groupbox</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>  <span class="c1"># Set the font for the groupbox label</span>
</span><span id="DisulfideViewer.__init__-212"><a href="#DisulfideViewer.__init__-212"><span class="linenos">212</span></a>        <span class="n">pdb_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
</span><span id="DisulfideViewer.__init__-213"><a href="#DisulfideViewer.__init__-213"><span class="linenos">213</span></a>        <span class="n">pdb_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-214"><a href="#DisulfideViewer.__init__-214"><span class="linenos">214</span></a>        <span class="n">pdb_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-215"><a href="#DisulfideViewer.__init__-215"><span class="linenos">215</span></a>        <span class="n">pdb_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-216"><a href="#DisulfideViewer.__init__-216"><span class="linenos">216</span></a>        <span class="n">pdb_groupbox</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">pdb_layout</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-217"><a href="#DisulfideViewer.__init__-217"><span class="linenos">217</span></a>
</span><span id="DisulfideViewer.__init__-218"><a href="#DisulfideViewer.__init__-218"><span class="linenos">218</span></a>        <span class="c1"># Group the buttons with a label</span>
</span><span id="DisulfideViewer.__init__-219"><a href="#DisulfideViewer.__init__-219"><span class="linenos">219</span></a>        <span class="n">button_group</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Rendering Styles&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-220"><a href="#DisulfideViewer.__init__-220"><span class="linenos">220</span></a>        <span class="n">button_group</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>  <span class="c1"># Set the font for the groupbox label</span>
</span><span id="DisulfideViewer.__init__-221"><a href="#DisulfideViewer.__init__-221"><span class="linenos">221</span></a>        <span class="n">button_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
</span><span id="DisulfideViewer.__init__-222"><a href="#DisulfideViewer.__init__-222"><span class="linenos">222</span></a>        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_cpk</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-223"><a href="#DisulfideViewer.__init__-223"><span class="linenos">223</span></a>        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_sb</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-224"><a href="#DisulfideViewer.__init__-224"><span class="linenos">224</span></a>        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_bs</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-225"><a href="#DisulfideViewer.__init__-225"><span class="linenos">225</span></a>        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_pd</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-226"><a href="#DisulfideViewer.__init__-226"><span class="linenos">226</span></a>        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkbox_single</span><span class="p">)</span>  <span class="c1"># Add single/multiple checkbox</span>
</span><span id="DisulfideViewer.__init__-227"><a href="#DisulfideViewer.__init__-227"><span class="linenos">227</span></a>
</span><span id="DisulfideViewer.__init__-228"><a href="#DisulfideViewer.__init__-228"><span class="linenos">228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_spin</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Spin Molecule&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-229"><a href="#DisulfideViewer.__init__-229"><span class="linenos">229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_spin</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spin_camera</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-230"><a href="#DisulfideViewer.__init__-230"><span class="linenos">230</span></a>
</span><span id="DisulfideViewer.__init__-231"><a href="#DisulfideViewer.__init__-231"><span class="linenos">231</span></a>        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_spin</span><span class="p">)</span>  <span class="c1"># Add spin camera button</span>
</span><span id="DisulfideViewer.__init__-232"><a href="#DisulfideViewer.__init__-232"><span class="linenos">232</span></a>
</span><span id="DisulfideViewer.__init__-233"><a href="#DisulfideViewer.__init__-233"><span class="linenos">233</span></a>        <span class="c1"># button_layout.addWidget(self.button_cov)</span>
</span><span id="DisulfideViewer.__init__-234"><a href="#DisulfideViewer.__init__-234"><span class="linenos">234</span></a>        <span class="n">button_group</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">button_layout</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-235"><a href="#DisulfideViewer.__init__-235"><span class="linenos">235</span></a>
</span><span id="DisulfideViewer.__init__-236"><a href="#DisulfideViewer.__init__-236"><span class="linenos">236</span></a>        <span class="c1"># Layout for the main controls</span>
</span><span id="DisulfideViewer.__init__-237"><a href="#DisulfideViewer.__init__-237"><span class="linenos">237</span></a>        <span class="n">control_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
</span><span id="DisulfideViewer.__init__-238"><a href="#DisulfideViewer.__init__-238"><span class="linenos">238</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">button_group</span><span class="p">)</span>  <span class="c1"># Add button group</span>
</span><span id="DisulfideViewer.__init__-239"><a href="#DisulfideViewer.__init__-239"><span class="linenos">239</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addSpacerItem</span><span class="p">(</span>
</span><span id="DisulfideViewer.__init__-240"><a href="#DisulfideViewer.__init__-240"><span class="linenos">240</span></a>            <span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-241"><a href="#DisulfideViewer.__init__-241"><span class="linenos">241</span></a>        <span class="p">)</span>  <span class="c1"># Add spacer</span>
</span><span id="DisulfideViewer.__init__-242"><a href="#DisulfideViewer.__init__-242"><span class="linenos">242</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">pdb_groupbox</span><span class="p">)</span>  <span class="c1"># Add PDB groupbox</span>
</span><span id="DisulfideViewer.__init__-243"><a href="#DisulfideViewer.__init__-243"><span class="linenos">243</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addSpacerItem</span><span class="p">(</span>
</span><span id="DisulfideViewer.__init__-244"><a href="#DisulfideViewer.__init__-244"><span class="linenos">244</span></a>            <span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-245"><a href="#DisulfideViewer.__init__-245"><span class="linenos">245</span></a>        <span class="p">)</span>  <span class="c1"># Add spacer</span>
</span><span id="DisulfideViewer.__init__-246"><a href="#DisulfideViewer.__init__-246"><span class="linenos">246</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_theme</span><span class="p">)</span>  <span class="c1"># Add theme toggle button</span>
</span><span id="DisulfideViewer.__init__-247"><a href="#DisulfideViewer.__init__-247"><span class="linenos">247</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_reset</span><span class="p">)</span>  <span class="c1"># Add Reset button</span>
</span><span id="DisulfideViewer.__init__-248"><a href="#DisulfideViewer.__init__-248"><span class="linenos">248</span></a>        <span class="n">control_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-249"><a href="#DisulfideViewer.__init__-249"><span class="linenos">249</span></a>
</span><span id="DisulfideViewer.__init__-250"><a href="#DisulfideViewer.__init__-250"><span class="linenos">250</span></a>        <span class="c1"># Create a QWidget for the controls</span>
</span><span id="DisulfideViewer.__init__-251"><a href="#DisulfideViewer.__init__-251"><span class="linenos">251</span></a>        <span class="n">control_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
</span><span id="DisulfideViewer.__init__-252"><a href="#DisulfideViewer.__init__-252"><span class="linenos">252</span></a>        <span class="n">control_widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">control_layout</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-253"><a href="#DisulfideViewer.__init__-253"><span class="linenos">253</span></a>
</span><span id="DisulfideViewer.__init__-254"><a href="#DisulfideViewer.__init__-254"><span class="linenos">254</span></a>        <span class="c1"># Create the PyVista QtInteractor widget for 3D visualization</span>
</span><span id="DisulfideViewer.__init__-255"><a href="#DisulfideViewer.__init__-255"><span class="linenos">255</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span> <span class="o">=</span> <span class="n">QtInteractor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-256"><a href="#DisulfideViewer.__init__-256"><span class="linenos">256</span></a>        <span class="c1"># self.plotter_widget.setMinimumSize(*winsize)</span>
</span><span id="DisulfideViewer.__init__-257"><a href="#DisulfideViewer.__init__-257"><span class="linenos">257</span></a>
</span><span id="DisulfideViewer.__init__-258"><a href="#DisulfideViewer.__init__-258"><span class="linenos">258</span></a>        <span class="c1"># Create sliders for camera control</span>
</span><span id="DisulfideViewer.__init__-259"><a href="#DisulfideViewer.__init__-259"><span class="linenos">259</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.__init__-260"><a href="#DisulfideViewer.__init__-260"><span class="linenos">260</span></a><span class="sd">        self.slider_x = QSlider(Qt.Horizontal)</span>
</span><span id="DisulfideViewer.__init__-261"><a href="#DisulfideViewer.__init__-261"><span class="linenos">261</span></a><span class="sd">        self.slider_x.setRange(-100, 100)</span>
</span><span id="DisulfideViewer.__init__-262"><a href="#DisulfideViewer.__init__-262"><span class="linenos">262</span></a><span class="sd">        self.slider_x.setValue(0)</span>
</span><span id="DisulfideViewer.__init__-263"><a href="#DisulfideViewer.__init__-263"><span class="linenos">263</span></a><span class="sd">        self.slider_x.valueChanged.connect(self.update_camera_position)</span>
</span><span id="DisulfideViewer.__init__-264"><a href="#DisulfideViewer.__init__-264"><span class="linenos">264</span></a>
</span><span id="DisulfideViewer.__init__-265"><a href="#DisulfideViewer.__init__-265"><span class="linenos">265</span></a><span class="sd">        self.slider_y = QSlider(Qt.Vertical)</span>
</span><span id="DisulfideViewer.__init__-266"><a href="#DisulfideViewer.__init__-266"><span class="linenos">266</span></a><span class="sd">        self.slider_y.setRange(-100, 100)</span>
</span><span id="DisulfideViewer.__init__-267"><a href="#DisulfideViewer.__init__-267"><span class="linenos">267</span></a><span class="sd">        self.slider_y.setValue(0)</span>
</span><span id="DisulfideViewer.__init__-268"><a href="#DisulfideViewer.__init__-268"><span class="linenos">268</span></a><span class="sd">        self.slider_y.valueChanged.connect(self.update_camera_position)</span>
</span><span id="DisulfideViewer.__init__-269"><a href="#DisulfideViewer.__init__-269"><span class="linenos">269</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.__init__-270"><a href="#DisulfideViewer.__init__-270"><span class="linenos">270</span></a>
</span><span id="DisulfideViewer.__init__-271"><a href="#DisulfideViewer.__init__-271"><span class="linenos">271</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_spin</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Spin Camera&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-272"><a href="#DisulfideViewer.__init__-272"><span class="linenos">272</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">button_spin</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spin_camera</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-273"><a href="#DisulfideViewer.__init__-273"><span class="linenos">273</span></a>
</span><span id="DisulfideViewer.__init__-274"><a href="#DisulfideViewer.__init__-274"><span class="linenos">274</span></a>        <span class="c1"># Main layout combining controls and visualization</span>
</span><span id="DisulfideViewer.__init__-275"><a href="#DisulfideViewer.__init__-275"><span class="linenos">275</span></a>        <span class="n">main_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
</span><span id="DisulfideViewer.__init__-276"><a href="#DisulfideViewer.__init__-276"><span class="linenos">276</span></a>        <span class="n">main_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">control_widget</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-277"><a href="#DisulfideViewer.__init__-277"><span class="linenos">277</span></a>        <span class="n">main_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-278"><a href="#DisulfideViewer.__init__-278"><span class="linenos">278</span></a>        <span class="c1"># main_layout.addWidget(self.slider_y)  # Add vertical slider</span>
</span><span id="DisulfideViewer.__init__-279"><a href="#DisulfideViewer.__init__-279"><span class="linenos">279</span></a>
</span><span id="DisulfideViewer.__init__-280"><a href="#DisulfideViewer.__init__-280"><span class="linenos">280</span></a>        <span class="c1"># Set the central widget</span>
</span><span id="DisulfideViewer.__init__-281"><a href="#DisulfideViewer.__init__-281"><span class="linenos">281</span></a>        <span class="n">container</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
</span><span id="DisulfideViewer.__init__-282"><a href="#DisulfideViewer.__init__-282"><span class="linenos">282</span></a>        <span class="n">container</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">main_layout</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-283"><a href="#DisulfideViewer.__init__-283"><span class="linenos">283</span></a>
</span><span id="DisulfideViewer.__init__-284"><a href="#DisulfideViewer.__init__-284"><span class="linenos">284</span></a>        <span class="n">bottom_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
</span><span id="DisulfideViewer.__init__-285"><a href="#DisulfideViewer.__init__-285"><span class="linenos">285</span></a>        <span class="n">bottom_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-286"><a href="#DisulfideViewer.__init__-286"><span class="linenos">286</span></a>        <span class="c1"># bottom_layout.addWidget(self.slider_x)  # Add horizontal slider</span>
</span><span id="DisulfideViewer.__init__-287"><a href="#DisulfideViewer.__init__-287"><span class="linenos">287</span></a>
</span><span id="DisulfideViewer.__init__-288"><a href="#DisulfideViewer.__init__-288"><span class="linenos">288</span></a>        <span class="n">main_container</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
</span><span id="DisulfideViewer.__init__-289"><a href="#DisulfideViewer.__init__-289"><span class="linenos">289</span></a>        <span class="n">main_container</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">bottom_layout</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-290"><a href="#DisulfideViewer.__init__-290"><span class="linenos">290</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="n">main_container</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-291"><a href="#DisulfideViewer.__init__-291"><span class="linenos">291</span></a>
</span><span id="DisulfideViewer.__init__-292"><a href="#DisulfideViewer.__init__-292"><span class="linenos">292</span></a>        <span class="c1"># Status Bar for user feedback</span>
</span><span id="DisulfideViewer.__init__-293"><a href="#DisulfideViewer.__init__-293"><span class="linenos">293</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Displaying: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-294"><a href="#DisulfideViewer.__init__-294"><span class="linenos">294</span></a>
</span><span id="DisulfideViewer.__init__-295"><a href="#DisulfideViewer.__init__-295"><span class="linenos">295</span></a>        <span class="c1"># Initialize the theme</span>
</span><span id="DisulfideViewer.__init__-296"><a href="#DisulfideViewer.__init__-296"><span class="linenos">296</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_theme</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span>  <span class="c1"># Default theme</span>
</span><span id="DisulfideViewer.__init__-297"><a href="#DisulfideViewer.__init__-297"><span class="linenos">297</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">apply_theme</span><span class="p">()</span>
</span><span id="DisulfideViewer.__init__-298"><a href="#DisulfideViewer.__init__-298"><span class="linenos">298</span></a>
</span><span id="DisulfideViewer.__init__-299"><a href="#DisulfideViewer.__init__-299"><span class="linenos">299</span></a>        <span class="c1"># Create the menubar</span>
</span><span id="DisulfideViewer.__init__-300"><a href="#DisulfideViewer.__init__-300"><span class="linenos">300</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">create_menubar</span><span class="p">()</span>
</span><span id="DisulfideViewer.__init__-301"><a href="#DisulfideViewer.__init__-301"><span class="linenos">301</span></a>
</span><span id="DisulfideViewer.__init__-302"><a href="#DisulfideViewer.__init__-302"><span class="linenos">302</span></a>        <span class="c1"># Force a refresh on the disulfide list dropdown</span>
</span><span id="DisulfideViewer.__init__-303"><a href="#DisulfideViewer.__init__-303"><span class="linenos">303</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_camera_view</span><span class="p">()</span>
</span><span id="DisulfideViewer.__init__-304"><a href="#DisulfideViewer.__init__-304"><span class="linenos">304</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_pdb_dropdown_change</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DisulfideViewer.__init__-305"><a href="#DisulfideViewer.__init__-305"><span class="linenos">305</span></a>
</span><span id="DisulfideViewer.__init__-306"><a href="#DisulfideViewer.__init__-306"><span class="linenos">306</span></a>        <span class="c1"># Initial display</span>
</span><span id="DisulfideViewer.__init__-307"><a href="#DisulfideViewer.__init__-307"><span class="linenos">307</span></a>        <span class="c1"># self.display()  # Set a default view with current style</span>
</span></pre></div>


            <div class="docstring"><p>Initializes the MolecularViewer application.</p>

<p>Parameters:
    ss_list (list): List of disulfide bond objects.
    winsize (tuple): Minimum size for the PyVista plotter widget.</p>
</div>


                            </div>
                            <div id="DisulfideViewer.colors" class="classattr">
                                <div class="attr variable">
            <span class="name">colors</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.colors"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.timer" class="classattr">
                                <div class="attr variable">
            <span class="name">timer</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.timer"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.current_frame" class="classattr">
                                <div class="attr variable">
            <span class="name">current_frame</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.current_frame"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.ss_list" class="classattr">
                                <div class="attr variable">
            <span class="name">ss_list</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.ss_list"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.current_ss" class="classattr">
                                <div class="attr variable">
            <span class="name">current_ss</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.current_ss"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.current_pdb_id" class="classattr">
                                <div class="attr variable">
            <span class="name">current_pdb_id</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.current_pdb_id"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.current_style" class="classattr">
                                <div class="attr variable">
            <span class="name">current_style</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.current_style"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.single" class="classattr">
                                <div class="attr variable">
            <span class="name">single</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.single"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.current_sslist" class="classattr">
                                <div class="attr variable">
            <span class="name">current_sslist</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.current_sslist"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.ss_dict" class="classattr">
                                <div class="attr variable">
            <span class="name">ss_dict</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.ss_dict"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.button_cpk" class="classattr">
                                <div class="attr variable">
            <span class="name">button_cpk</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.button_cpk"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.button_sb" class="classattr">
                                <div class="attr variable">
            <span class="name">button_sb</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.button_sb"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.button_bs" class="classattr">
                                <div class="attr variable">
            <span class="name">button_bs</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.button_bs"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.button_pd" class="classattr">
                                <div class="attr variable">
            <span class="name">button_pd</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.button_pd"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.pdb_textbox" class="classattr">
                                <div class="attr variable">
            <span class="name">pdb_textbox</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.pdb_textbox"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.pdb_dropdown" class="classattr">
                                <div class="attr variable">
            <span class="name">pdb_dropdown</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.pdb_dropdown"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.dropdown" class="classattr">
                                <div class="attr variable">
            <span class="name">dropdown</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.dropdown"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.button_theme" class="classattr">
                                <div class="attr variable">
            <span class="name">button_theme</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.button_theme"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.checkbox_single" class="classattr">
                                <div class="attr variable">
            <span class="name">checkbox_single</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.checkbox_single"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.button_reset" class="classattr">
                                <div class="attr variable">
            <span class="name">button_reset</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.button_reset"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.button_spin" class="classattr">
                                <div class="attr variable">
            <span class="name">button_spin</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.button_spin"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.plotter_widget" class="classattr">
                                <div class="attr variable">
            <span class="name">plotter_widget</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.plotter_widget"></a>
    
            <div class="docstring"><p>self.slider_x = QSlider(Qt.Horizontal)
self.slider_x.setRange(-100, 100)
self.slider_x.setValue(0)
self.slider_x.valueChanged.connect(self.update_camera_position)</p>

<p>self.slider_y = QSlider(Qt.Vertical)
self.slider_y.setRange(-100, 100)
self.slider_y.setValue(0)
self.slider_y.valueChanged.connect(self.update_camera_position)</p>
</div>


                            </div>
                            <div id="DisulfideViewer.current_theme" class="classattr">
                                <div class="attr variable">
            <span class="name">current_theme</span>

        
    </div>
    <a class="headerlink" href="#DisulfideViewer.current_theme"></a>
    
    

                            </div>
                            <div id="DisulfideViewer.set_camera_view" class="classattr">
                                        <input id="DisulfideViewer.set_camera_view-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_camera_view</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideViewer.set_camera_view-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.set_camera_view"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.set_camera_view-309"><a href="#DisulfideViewer.set_camera_view-309"><span class="linenos">309</span></a>    <span class="k">def</span> <span class="nf">set_camera_view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideViewer.set_camera_view-310"><a href="#DisulfideViewer.set_camera_view-310"><span class="linenos">310</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.set_camera_view-311"><a href="#DisulfideViewer.set_camera_view-311"><span class="linenos">311</span></a><span class="sd">        Sets the camera to a specific view where the x-axis is pointed down and the</span>
</span><span id="DisulfideViewer.set_camera_view-312"><a href="#DisulfideViewer.set_camera_view-312"><span class="linenos">312</span></a><span class="sd">        y-axis into the screen.</span>
</span><span id="DisulfideViewer.set_camera_view-313"><a href="#DisulfideViewer.set_camera_view-313"><span class="linenos">313</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.set_camera_view-314"><a href="#DisulfideViewer.set_camera_view-314"><span class="linenos">314</span></a>        <span class="n">camera_position</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>  <span class="c1"># Example values</span>
</span><span id="DisulfideViewer.set_camera_view-315"><a href="#DisulfideViewer.set_camera_view-315"><span class="linenos">315</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">camera_position</span> <span class="o">=</span> <span class="n">camera_position</span>
</span><span id="DisulfideViewer.set_camera_view-316"><a href="#DisulfideViewer.set_camera_view-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Sets the camera to a specific view where the x-axis is pointed down and the
y-axis into the screen.</p>
</div>


                            </div>
                            <div id="DisulfideViewer.spin_camera" class="classattr">
                                        <input id="DisulfideViewer.spin_camera-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">spin_camera</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">duration</span><span class="o">=</span><span class="mi">5</span>, </span><span class="param"><span class="n">n_frames</span><span class="o">=</span><span class="mi">150</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideViewer.spin_camera-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.spin_camera"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.spin_camera-318"><a href="#DisulfideViewer.spin_camera-318"><span class="linenos">318</span></a>    <span class="k">def</span> <span class="nf">spin_camera</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_frames</span><span class="o">=</span><span class="mi">150</span><span class="p">):</span>
</span><span id="DisulfideViewer.spin_camera-319"><a href="#DisulfideViewer.spin_camera-319"><span class="linenos">319</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.spin_camera-320"><a href="#DisulfideViewer.spin_camera-320"><span class="linenos">320</span></a><span class="sd">        Spins the camera around the z-axis in an orbital path.</span>
</span><span id="DisulfideViewer.spin_camera-321"><a href="#DisulfideViewer.spin_camera-321"><span class="linenos">321</span></a>
</span><span id="DisulfideViewer.spin_camera-322"><a href="#DisulfideViewer.spin_camera-322"><span class="linenos">322</span></a><span class="sd">        :param duration: Duration of the spin in seconds.</span>
</span><span id="DisulfideViewer.spin_camera-323"><a href="#DisulfideViewer.spin_camera-323"><span class="linenos">323</span></a><span class="sd">        :param n_frames: Number of frames for the animation.</span>
</span><span id="DisulfideViewer.spin_camera-324"><a href="#DisulfideViewer.spin_camera-324"><span class="linenos">324</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.spin_camera-325"><a href="#DisulfideViewer.spin_camera-325"><span class="linenos">325</span></a>        <span class="c1"># Define the circular path around the z-axis</span>
</span><span id="DisulfideViewer.spin_camera-326"><a href="#DisulfideViewer.spin_camera-326"><span class="linenos">326</span></a>        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_frames</span><span class="p">)</span>
</span><span id="DisulfideViewer.spin_camera-327"><a href="#DisulfideViewer.spin_camera-327"><span class="linenos">327</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">theta</span><span class="p">)]</span>
</span><span id="DisulfideViewer.spin_camera-328"><a href="#DisulfideViewer.spin_camera-328"><span class="linenos">328</span></a>        <span class="n">duration</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="DisulfideViewer.spin_camera-329"><a href="#DisulfideViewer.spin_camera-329"><span class="linenos">329</span></a>
</span><span id="DisulfideViewer.spin_camera-330"><a href="#DisulfideViewer.spin_camera-330"><span class="linenos">330</span></a>        <span class="c1"># Function to update the camera position</span>
</span><span id="DisulfideViewer.spin_camera-331"><a href="#DisulfideViewer.spin_camera-331"><span class="linenos">331</span></a>        <span class="k">def</span> <span class="nf">update_camera</span><span class="p">():</span>
</span><span id="DisulfideViewer.spin_camera-332"><a href="#DisulfideViewer.spin_camera-332"><span class="linenos">332</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">camera_position</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_frame</span><span class="p">]</span>
</span><span id="DisulfideViewer.spin_camera-333"><a href="#DisulfideViewer.spin_camera-333"><span class="linenos">333</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_frame</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_frame</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n_frames</span>
</span><span id="DisulfideViewer.spin_camera-334"><a href="#DisulfideViewer.spin_camera-334"><span class="linenos">334</span></a>
</span><span id="DisulfideViewer.spin_camera-335"><a href="#DisulfideViewer.spin_camera-335"><span class="linenos">335</span></a>        <span class="c1"># Create a QTimer to update the camera position</span>
</span><span id="DisulfideViewer.spin_camera-336"><a href="#DisulfideViewer.spin_camera-336"><span class="linenos">336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span> <span class="o">=</span> <span class="n">QTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="DisulfideViewer.spin_camera-337"><a href="#DisulfideViewer.spin_camera-337"><span class="linenos">337</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">update_camera</span><span class="p">)</span>
</span><span id="DisulfideViewer.spin_camera-338"><a href="#DisulfideViewer.spin_camera-338"><span class="linenos">338</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_frame</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DisulfideViewer.spin_camera-339"><a href="#DisulfideViewer.spin_camera-339"><span class="linenos">339</span></a>
</span><span id="DisulfideViewer.spin_camera-340"><a href="#DisulfideViewer.spin_camera-340"><span class="linenos">340</span></a>        <span class="c1"># Function to stop the timer after the duration</span>
</span><span id="DisulfideViewer.spin_camera-341"><a href="#DisulfideViewer.spin_camera-341"><span class="linenos">341</span></a>        <span class="k">def</span> <span class="nf">stop_timer</span><span class="p">():</span>
</span><span id="DisulfideViewer.spin_camera-342"><a href="#DisulfideViewer.spin_camera-342"><span class="linenos">342</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</span><span id="DisulfideViewer.spin_camera-343"><a href="#DisulfideViewer.spin_camera-343"><span class="linenos">343</span></a>
</span><span id="DisulfideViewer.spin_camera-344"><a href="#DisulfideViewer.spin_camera-344"><span class="linenos">344</span></a>        <span class="c1"># Start the timer</span>
</span><span id="DisulfideViewer.spin_camera-345"><a href="#DisulfideViewer.spin_camera-345"><span class="linenos">345</span></a>        <span class="n">interval</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">/</span> <span class="n">n_frames</span><span class="p">)</span>
</span><span id="DisulfideViewer.spin_camera-346"><a href="#DisulfideViewer.spin_camera-346"><span class="linenos">346</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
</span><span id="DisulfideViewer.spin_camera-347"><a href="#DisulfideViewer.spin_camera-347"><span class="linenos">347</span></a>        <span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">stop_timer</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Spins the camera around the z-axis in an orbital path.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>duration</strong>:  Duration of the spin in seconds.</li>
<li><strong>n_frames</strong>:  Number of frames for the animation.</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideViewer.reset" class="classattr">
                                        <input id="DisulfideViewer.reset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">reset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideViewer.reset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.reset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.reset-349"><a href="#DisulfideViewer.reset-349"><span class="linenos">349</span></a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideViewer.reset-350"><a href="#DisulfideViewer.reset-350"><span class="linenos">350</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.reset-351"><a href="#DisulfideViewer.reset-351"><span class="linenos">351</span></a><span class="sd">        Resets all widgets and data structures to their default state.</span>
</span><span id="DisulfideViewer.reset-352"><a href="#DisulfideViewer.reset-352"><span class="linenos">352</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.reset-353"><a href="#DisulfideViewer.reset-353"><span class="linenos">353</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Resetting...&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.reset-354"><a href="#DisulfideViewer.reset-354"><span class="linenos">354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="DisulfideViewer.reset-355"><a href="#DisulfideViewer.reset-355"><span class="linenos">355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DisulfideViewer.reset-356"><a href="#DisulfideViewer.reset-356"><span class="linenos">356</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="DisulfideViewer.reset-357"><a href="#DisulfideViewer.reset-357"><span class="linenos">357</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">checkbox_single</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DisulfideViewer.reset-358"><a href="#DisulfideViewer.reset-358"><span class="linenos">358</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_style</span> <span class="o">=</span> <span class="s2">&quot;sb&quot;</span>
</span><span id="DisulfideViewer.reset-359"><a href="#DisulfideViewer.reset-359"><span class="linenos">359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="DisulfideViewer.reset-360"><a href="#DisulfideViewer.reset-360"><span class="linenos">360</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdb_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="DisulfideViewer.reset-361"><a href="#DisulfideViewer.reset-361"><span class="linenos">361</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_camera_view</span><span class="p">()</span>
</span><span id="DisulfideViewer.reset-362"><a href="#DisulfideViewer.reset-362"><span class="linenos">362</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_pdb_dropdown_change</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Resets all widgets and data structures to their default state.</p>
</div>


                            </div>
                            <div id="DisulfideViewer.add_floor" class="classattr">
                                        <input id="DisulfideViewer.add_floor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_floor</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">plotter</span>, </span><span class="param"><span class="n">size</span><span class="o">=</span><span class="mi">15</span>, </span><span class="param"><span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideViewer.add_floor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.add_floor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.add_floor-364"><a href="#DisulfideViewer.add_floor-364"><span class="linenos">364</span></a>    <span class="k">def</span> <span class="nf">add_floor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotter</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)):</span>
</span><span id="DisulfideViewer.add_floor-365"><a href="#DisulfideViewer.add_floor-365"><span class="linenos">365</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.add_floor-366"><a href="#DisulfideViewer.add_floor-366"><span class="linenos">366</span></a><span class="sd">        Adds a simple plane beneath the disulfide bond to act as a &#39;floor&#39;.</span>
</span><span id="DisulfideViewer.add_floor-367"><a href="#DisulfideViewer.add_floor-367"><span class="linenos">367</span></a>
</span><span id="DisulfideViewer.add_floor-368"><a href="#DisulfideViewer.add_floor-368"><span class="linenos">368</span></a><span class="sd">        :param plotter: The PyVista plotter to add the floor to.</span>
</span><span id="DisulfideViewer.add_floor-369"><a href="#DisulfideViewer.add_floor-369"><span class="linenos">369</span></a><span class="sd">        :type plotter: pv.Plotter</span>
</span><span id="DisulfideViewer.add_floor-370"><a href="#DisulfideViewer.add_floor-370"><span class="linenos">370</span></a><span class="sd">        :param size: The size of the floor plane.</span>
</span><span id="DisulfideViewer.add_floor-371"><a href="#DisulfideViewer.add_floor-371"><span class="linenos">371</span></a><span class="sd">        :type size: float</span>
</span><span id="DisulfideViewer.add_floor-372"><a href="#DisulfideViewer.add_floor-372"><span class="linenos">372</span></a><span class="sd">        :param position: The position of the floor plane.</span>
</span><span id="DisulfideViewer.add_floor-373"><a href="#DisulfideViewer.add_floor-373"><span class="linenos">373</span></a><span class="sd">        :type position: tuple</span>
</span><span id="DisulfideViewer.add_floor-374"><a href="#DisulfideViewer.add_floor-374"><span class="linenos">374</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.add_floor-375"><a href="#DisulfideViewer.add_floor-375"><span class="linenos">375</span></a>        <span class="n">floor</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plane</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">i_size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">j_size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
</span><span id="DisulfideViewer.add_floor-376"><a href="#DisulfideViewer.add_floor-376"><span class="linenos">376</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">floor</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Adds a simple plane beneath the disulfide bond to act as a 'floor'.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>plotter</strong>:  The PyVista plotter to add the floor to.</li>
<li><strong>size</strong>:  The size of the floor plane.</li>
<li><strong>position</strong>:  The position of the floor plane.</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideViewer.update_style" class="classattr">
                                        <input id="DisulfideViewer.update_style-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_style</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">style</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideViewer.update_style-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.update_style"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.update_style-378"><a href="#DisulfideViewer.update_style-378"><span class="linenos">378</span></a>    <span class="k">def</span> <span class="nf">update_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">style</span><span class="p">):</span>
</span><span id="DisulfideViewer.update_style-379"><a href="#DisulfideViewer.update_style-379"><span class="linenos">379</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.update_style-380"><a href="#DisulfideViewer.update_style-380"><span class="linenos">380</span></a><span class="sd">        Updates the current rendering style and refreshes the visualization.</span>
</span><span id="DisulfideViewer.update_style-381"><a href="#DisulfideViewer.update_style-381"><span class="linenos">381</span></a>
</span><span id="DisulfideViewer.update_style-382"><a href="#DisulfideViewer.update_style-382"><span class="linenos">382</span></a><span class="sd">        :param style: The rendering style to apply (e.g., &#39;cpk&#39;, &#39;sb&#39;).</span>
</span><span id="DisulfideViewer.update_style-383"><a href="#DisulfideViewer.update_style-383"><span class="linenos">383</span></a><span class="sd">        :type style: str</span>
</span><span id="DisulfideViewer.update_style-384"><a href="#DisulfideViewer.update_style-384"><span class="linenos">384</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.update_style-385"><a href="#DisulfideViewer.update_style-385"><span class="linenos">385</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_style</span> <span class="o">=</span> <span class="n">style</span>
</span><span id="DisulfideViewer.update_style-386"><a href="#DisulfideViewer.update_style-386"><span class="linenos">386</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">checkbox_single</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Ensure the &quot;Single&quot; checkbox is checked</span>
</span><span id="DisulfideViewer.update_style-387"><a href="#DisulfideViewer.update_style-387"><span class="linenos">387</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Updates the current rendering style and refreshes the visualization.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>style</strong>:  The rendering style to apply (e.g., 'cpk', 'sb').</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideViewer.on_pdb_textbox_enter" class="classattr">
                                        <input id="DisulfideViewer.on_pdb_textbox_enter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">on_pdb_textbox_enter</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideViewer.on_pdb_textbox_enter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.on_pdb_textbox_enter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.on_pdb_textbox_enter-389"><a href="#DisulfideViewer.on_pdb_textbox_enter-389"><span class="linenos">389</span></a>    <span class="k">def</span> <span class="nf">on_pdb_textbox_enter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideViewer.on_pdb_textbox_enter-390"><a href="#DisulfideViewer.on_pdb_textbox_enter-390"><span class="linenos">390</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.on_pdb_textbox_enter-391"><a href="#DisulfideViewer.on_pdb_textbox_enter-391"><span class="linenos">391</span></a><span class="sd">        Handles the event when the user presses Enter in the PDB ID text box.</span>
</span><span id="DisulfideViewer.on_pdb_textbox_enter-392"><a href="#DisulfideViewer.on_pdb_textbox_enter-392"><span class="linenos">392</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.on_pdb_textbox_enter-393"><a href="#DisulfideViewer.on_pdb_textbox_enter-393"><span class="linenos">393</span></a>        <span class="n">pdb_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
</span><span id="DisulfideViewer.on_pdb_textbox_enter-394"><a href="#DisulfideViewer.on_pdb_textbox_enter-394"><span class="linenos">394</span></a>        <span class="k">if</span> <span class="n">pdb_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="p">:</span>
</span><span id="DisulfideViewer.on_pdb_textbox_enter-395"><a href="#DisulfideViewer.on_pdb_textbox_enter-395"><span class="linenos">395</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_pdb_selection</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">)</span>
</span><span id="DisulfideViewer.on_pdb_textbox_enter-396"><a href="#DisulfideViewer.on_pdb_textbox_enter-396"><span class="linenos">396</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideViewer.on_pdb_textbox_enter-397"><a href="#DisulfideViewer.on_pdb_textbox_enter-397"><span class="linenos">397</span></a>            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="DisulfideViewer.on_pdb_textbox_enter-398"><a href="#DisulfideViewer.on_pdb_textbox_enter-398"><span class="linenos">398</span></a>                <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Invalid PDB ID&quot;</span><span class="p">,</span> <span class="s2">&quot;The entered PDB ID is not valid.&quot;</span>
</span><span id="DisulfideViewer.on_pdb_textbox_enter-399"><a href="#DisulfideViewer.on_pdb_textbox_enter-399"><span class="linenos">399</span></a>            <span class="p">)</span>
</span><span id="DisulfideViewer.on_pdb_textbox_enter-400"><a href="#DisulfideViewer.on_pdb_textbox_enter-400"><span class="linenos">400</span></a>        <span class="n">disulfides</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="DisulfideViewer.on_pdb_textbox_enter-401"><a href="#DisulfideViewer.on_pdb_textbox_enter-401"><span class="linenos">401</span></a>
</span><span id="DisulfideViewer.on_pdb_textbox_enter-402"><a href="#DisulfideViewer.on_pdb_textbox_enter-402"><span class="linenos">402</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="DisulfideViewer.on_pdb_textbox_enter-403"><a href="#DisulfideViewer.on_pdb_textbox_enter-403"><span class="linenos">403</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">ss</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">disulfides</span><span class="p">])</span>
</span><span id="DisulfideViewer.on_pdb_textbox_enter-404"><a href="#DisulfideViewer.on_pdb_textbox_enter-404"><span class="linenos">404</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">disulfides</span><span class="p">),</span> <span class="s2">&quot;sub&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.on_pdb_textbox_enter-405"><a href="#DisulfideViewer.on_pdb_textbox_enter-405"><span class="linenos">405</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Handles the event when the user presses Enter in the PDB ID text box.</p>
</div>


                            </div>
                            <div id="DisulfideViewer.on_pdb_dropdown_change" class="classattr">
                                        <input id="DisulfideViewer.on_pdb_dropdown_change-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">on_pdb_dropdown_change</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">index</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideViewer.on_pdb_dropdown_change-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.on_pdb_dropdown_change"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.on_pdb_dropdown_change-407"><a href="#DisulfideViewer.on_pdb_dropdown_change-407"><span class="linenos">407</span></a>    <span class="k">def</span> <span class="nf">on_pdb_dropdown_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-408"><a href="#DisulfideViewer.on_pdb_dropdown_change-408"><span class="linenos">408</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-409"><a href="#DisulfideViewer.on_pdb_dropdown_change-409"><span class="linenos">409</span></a><span class="sd">        Handles the event when the PDB ID dropdown selection changes.</span>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-410"><a href="#DisulfideViewer.on_pdb_dropdown_change-410"><span class="linenos">410</span></a>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-411"><a href="#DisulfideViewer.on_pdb_dropdown_change-411"><span class="linenos">411</span></a><span class="sd">        Parameters:</span>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-412"><a href="#DisulfideViewer.on_pdb_dropdown_change-412"><span class="linenos">412</span></a><span class="sd">            index (int): The index of the selected item in the PDB ID dropdown.</span>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-413"><a href="#DisulfideViewer.on_pdb_dropdown_change-413"><span class="linenos">413</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-414"><a href="#DisulfideViewer.on_pdb_dropdown_change-414"><span class="linenos">414</span></a>        <span class="n">pdb_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdb_dropdown</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-415"><a href="#DisulfideViewer.on_pdb_dropdown_change-415"><span class="linenos">415</span></a>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-416"><a href="#DisulfideViewer.on_pdb_dropdown_change-416"><span class="linenos">416</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-417"><a href="#DisulfideViewer.on_pdb_dropdown_change-417"><span class="linenos">417</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pdb_textbox</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">)</span>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-418"><a href="#DisulfideViewer.on_pdb_dropdown_change-418"><span class="linenos">418</span></a>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-419"><a href="#DisulfideViewer.on_pdb_dropdown_change-419"><span class="linenos">419</span></a>        <span class="n">disulfides</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-420"><a href="#DisulfideViewer.on_pdb_dropdown_change-420"><span class="linenos">420</span></a>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-421"><a href="#DisulfideViewer.on_pdb_dropdown_change-421"><span class="linenos">421</span></a>        <span class="k">if</span> <span class="n">disulfides</span><span class="p">:</span>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-422"><a href="#DisulfideViewer.on_pdb_dropdown_change-422"><span class="linenos">422</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">ss</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">disulfides</span><span class="p">])</span>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-423"><a href="#DisulfideViewer.on_pdb_dropdown_change-423"><span class="linenos">423</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span> <span class="o">=</span> <span class="n">disulfides</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-424"><a href="#DisulfideViewer.on_pdb_dropdown_change-424"><span class="linenos">424</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">disulfides</span><span class="p">),</span> <span class="s2">&quot;sublist&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-425"><a href="#DisulfideViewer.on_pdb_dropdown_change-425"><span class="linenos">425</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Displaying: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-426"><a href="#DisulfideViewer.on_pdb_dropdown_change-426"><span class="linenos">426</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-427"><a href="#DisulfideViewer.on_pdb_dropdown_change-427"><span class="linenos">427</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideViewer.on_pdb_dropdown_change-428"><a href="#DisulfideViewer.on_pdb_dropdown_change-428"><span class="linenos">428</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No Disulfides: </span><span class="si">{</span><span class="n">pdb_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Handles the event when the PDB ID dropdown selection changes.</p>

<p>Parameters:
    index (int): The index of the selected item in the PDB ID dropdown.</p>
</div>


                            </div>
                            <div id="DisulfideViewer.update_pdb_selection" class="classattr">
                                        <input id="DisulfideViewer.update_pdb_selection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_pdb_selection</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">pdb_id</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideViewer.update_pdb_selection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.update_pdb_selection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.update_pdb_selection-430"><a href="#DisulfideViewer.update_pdb_selection-430"><span class="linenos">430</span></a>    <span class="k">def</span> <span class="nf">update_pdb_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdb_id</span><span class="p">):</span>
</span><span id="DisulfideViewer.update_pdb_selection-431"><a href="#DisulfideViewer.update_pdb_selection-431"><span class="linenos">431</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.update_pdb_selection-432"><a href="#DisulfideViewer.update_pdb_selection-432"><span class="linenos">432</span></a><span class="sd">        Updates the current PDB selection and refreshes the disulfide dropdown.</span>
</span><span id="DisulfideViewer.update_pdb_selection-433"><a href="#DisulfideViewer.update_pdb_selection-433"><span class="linenos">433</span></a>
</span><span id="DisulfideViewer.update_pdb_selection-434"><a href="#DisulfideViewer.update_pdb_selection-434"><span class="linenos">434</span></a><span class="sd">        :param pdb_id: The PDB ID to select.</span>
</span><span id="DisulfideViewer.update_pdb_selection-435"><a href="#DisulfideViewer.update_pdb_selection-435"><span class="linenos">435</span></a><span class="sd">        :type pdb_id: str</span>
</span><span id="DisulfideViewer.update_pdb_selection-436"><a href="#DisulfideViewer.update_pdb_selection-436"><span class="linenos">436</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.update_pdb_selection-437"><a href="#DisulfideViewer.update_pdb_selection-437"><span class="linenos">437</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_pdb_id</span> <span class="o">=</span> <span class="n">pdb_id</span>
</span><span id="DisulfideViewer.update_pdb_selection-438"><a href="#DisulfideViewer.update_pdb_selection-438"><span class="linenos">438</span></a>        <span class="n">disulfides</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="DisulfideViewer.update_pdb_selection-439"><a href="#DisulfideViewer.update_pdb_selection-439"><span class="linenos">439</span></a>
</span><span id="DisulfideViewer.update_pdb_selection-440"><a href="#DisulfideViewer.update_pdb_selection-440"><span class="linenos">440</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">disulfides</span><span class="p">),</span> <span class="s2">&quot;sublist2&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.update_pdb_selection-441"><a href="#DisulfideViewer.update_pdb_selection-441"><span class="linenos">441</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="DisulfideViewer.update_pdb_selection-442"><a href="#DisulfideViewer.update_pdb_selection-442"><span class="linenos">442</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">ss</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Updates the current PDB selection and refreshes the disulfide dropdown.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>pdb_id</strong>:  The PDB ID to select.</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideViewer.on_dropdown_change" class="classattr">
                                        <input id="DisulfideViewer.on_dropdown_change-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">on_dropdown_change</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">index</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideViewer.on_dropdown_change-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.on_dropdown_change"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.on_dropdown_change-444"><a href="#DisulfideViewer.on_dropdown_change-444"><span class="linenos">444</span></a>    <span class="k">def</span> <span class="nf">on_dropdown_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span><span id="DisulfideViewer.on_dropdown_change-445"><a href="#DisulfideViewer.on_dropdown_change-445"><span class="linenos">445</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.on_dropdown_change-446"><a href="#DisulfideViewer.on_dropdown_change-446"><span class="linenos">446</span></a><span class="sd">        Handles the event when the dropdown selection changes.</span>
</span><span id="DisulfideViewer.on_dropdown_change-447"><a href="#DisulfideViewer.on_dropdown_change-447"><span class="linenos">447</span></a>
</span><span id="DisulfideViewer.on_dropdown_change-448"><a href="#DisulfideViewer.on_dropdown_change-448"><span class="linenos">448</span></a><span class="sd">        Parameters:</span>
</span><span id="DisulfideViewer.on_dropdown_change-449"><a href="#DisulfideViewer.on_dropdown_change-449"><span class="linenos">449</span></a><span class="sd">            index (int): The index of the selected item in the dropdown.</span>
</span><span id="DisulfideViewer.on_dropdown_change-450"><a href="#DisulfideViewer.on_dropdown_change-450"><span class="linenos">450</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.on_dropdown_change-451"><a href="#DisulfideViewer.on_dropdown_change-451"><span class="linenos">451</span></a>        <span class="n">selected_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropdown</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
</span><span id="DisulfideViewer.on_dropdown_change-452"><a href="#DisulfideViewer.on_dropdown_change-452"><span class="linenos">452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
</span><span id="DisulfideViewer.on_dropdown_change-453"><a href="#DisulfideViewer.on_dropdown_change-453"><span class="linenos">453</span></a>            <span class="p">(</span><span class="n">ss</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ss_list</span> <span class="k">if</span> <span class="n">ss</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">selected_name</span><span class="p">),</span> <span class="kc">None</span>
</span><span id="DisulfideViewer.on_dropdown_change-454"><a href="#DisulfideViewer.on_dropdown_change-454"><span class="linenos">454</span></a>        <span class="p">)</span>
</span><span id="DisulfideViewer.on_dropdown_change-455"><a href="#DisulfideViewer.on_dropdown_change-455"><span class="linenos">455</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideViewer.on_dropdown_change-456"><a href="#DisulfideViewer.on_dropdown_change-456"><span class="linenos">456</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</span><span id="DisulfideViewer.on_dropdown_change-457"><a href="#DisulfideViewer.on_dropdown_change-457"><span class="linenos">457</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Displaying: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Handles the event when the dropdown selection changes.</p>

<p>Parameters:
    index (int): The index of the selected item in the dropdown.</p>
</div>


                            </div>
                            <div id="DisulfideViewer.on_checkbox_single_change" class="classattr">
                                        <input id="DisulfideViewer.on_checkbox_single_change-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">on_checkbox_single_change</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">state</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideViewer.on_checkbox_single_change-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.on_checkbox_single_change"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.on_checkbox_single_change-459"><a href="#DisulfideViewer.on_checkbox_single_change-459"><span class="linenos">459</span></a>    <span class="k">def</span> <span class="nf">on_checkbox_single_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
</span><span id="DisulfideViewer.on_checkbox_single_change-460"><a href="#DisulfideViewer.on_checkbox_single_change-460"><span class="linenos">460</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.on_checkbox_single_change-461"><a href="#DisulfideViewer.on_checkbox_single_change-461"><span class="linenos">461</span></a><span class="sd">        Handles the event when the single/multiple checkbox state changes.</span>
</span><span id="DisulfideViewer.on_checkbox_single_change-462"><a href="#DisulfideViewer.on_checkbox_single_change-462"><span class="linenos">462</span></a>
</span><span id="DisulfideViewer.on_checkbox_single_change-463"><a href="#DisulfideViewer.on_checkbox_single_change-463"><span class="linenos">463</span></a><span class="sd">        Parameters:</span>
</span><span id="DisulfideViewer.on_checkbox_single_change-464"><a href="#DisulfideViewer.on_checkbox_single_change-464"><span class="linenos">464</span></a><span class="sd">            state (int): The state of the checkbox (Qt.Checked or Qt.Unchecked).</span>
</span><span id="DisulfideViewer.on_checkbox_single_change-465"><a href="#DisulfideViewer.on_checkbox_single_change-465"><span class="linenos">465</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.on_checkbox_single_change-466"><a href="#DisulfideViewer.on_checkbox_single_change-466"><span class="linenos">466</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">single</span> <span class="o">=</span> <span class="n">state</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span>
</span><span id="DisulfideViewer.on_checkbox_single_change-467"><a href="#DisulfideViewer.on_checkbox_single_change-467"><span class="linenos">467</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># Use the current style</span>
</span></pre></div>


            <div class="docstring"><p>Handles the event when the single/multiple checkbox state changes.</p>

<p>Parameters:
    state (int): The state of the checkbox (Qt.Checked or Qt.Unchecked).</p>
</div>


                            </div>
                            <div id="DisulfideViewer.update_camera_position" class="classattr">
                                        <input id="DisulfideViewer.update_camera_position-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_camera_position</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideViewer.update_camera_position-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.update_camera_position"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.update_camera_position-469"><a href="#DisulfideViewer.update_camera_position-469"><span class="linenos">469</span></a>    <span class="k">def</span> <span class="nf">update_camera_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideViewer.update_camera_position-470"><a href="#DisulfideViewer.update_camera_position-470"><span class="linenos">470</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.update_camera_position-471"><a href="#DisulfideViewer.update_camera_position-471"><span class="linenos">471</span></a><span class="sd">        Update the camera position based on the slider values.</span>
</span><span id="DisulfideViewer.update_camera_position-472"><a href="#DisulfideViewer.update_camera_position-472"><span class="linenos">472</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.update_camera_position-473"><a href="#DisulfideViewer.update_camera_position-473"><span class="linenos">473</span></a>
</span><span id="DisulfideViewer.update_camera_position-474"><a href="#DisulfideViewer.update_camera_position-474"><span class="linenos">474</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slider_x</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
</span><span id="DisulfideViewer.update_camera_position-475"><a href="#DisulfideViewer.update_camera_position-475"><span class="linenos">475</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slider_y</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
</span><span id="DisulfideViewer.update_camera_position-476"><a href="#DisulfideViewer.update_camera_position-476"><span class="linenos">476</span></a>
</span><span id="DisulfideViewer.update_camera_position-477"><a href="#DisulfideViewer.update_camera_position-477"><span class="linenos">477</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">camera_position</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
</span><span id="DisulfideViewer.update_camera_position-478"><a href="#DisulfideViewer.update_camera_position-478"><span class="linenos">478</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Update the camera position based on the slider values.</p>
</div>


                            </div>
                            <div id="DisulfideViewer.toggle_theme" class="classattr">
                                        <input id="DisulfideViewer.toggle_theme-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">toggle_theme</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideViewer.toggle_theme-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.toggle_theme"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.toggle_theme-480"><a href="#DisulfideViewer.toggle_theme-480"><span class="linenos">480</span></a>    <span class="k">def</span> <span class="nf">toggle_theme</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideViewer.toggle_theme-481"><a href="#DisulfideViewer.toggle_theme-481"><span class="linenos">481</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.toggle_theme-482"><a href="#DisulfideViewer.toggle_theme-482"><span class="linenos">482</span></a><span class="sd">        Toggle between light and dark themes.</span>
</span><span id="DisulfideViewer.toggle_theme-483"><a href="#DisulfideViewer.toggle_theme-483"><span class="linenos">483</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.toggle_theme-484"><a href="#DisulfideViewer.toggle_theme-484"><span class="linenos">484</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_theme</span> <span class="o">==</span> <span class="s2">&quot;dark&quot;</span><span class="p">:</span>
</span><span id="DisulfideViewer.toggle_theme-485"><a href="#DisulfideViewer.toggle_theme-485"><span class="linenos">485</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_theme</span> <span class="o">=</span> <span class="s2">&quot;light&quot;</span>
</span><span id="DisulfideViewer.toggle_theme-486"><a href="#DisulfideViewer.toggle_theme-486"><span class="linenos">486</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideViewer.toggle_theme-487"><a href="#DisulfideViewer.toggle_theme-487"><span class="linenos">487</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_theme</span> <span class="o">=</span> <span class="s2">&quot;dark&quot;</span>
</span><span id="DisulfideViewer.toggle_theme-488"><a href="#DisulfideViewer.toggle_theme-488"><span class="linenos">488</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">apply_theme</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Toggle between light and dark themes.</p>
</div>


                            </div>
                            <div id="DisulfideViewer.apply_theme" class="classattr">
                                        <input id="DisulfideViewer.apply_theme-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">apply_theme</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideViewer.apply_theme-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.apply_theme"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.apply_theme-490"><a href="#DisulfideViewer.apply_theme-490"><span class="linenos">490</span></a>    <span class="k">def</span> <span class="nf">apply_theme</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideViewer.apply_theme-491"><a href="#DisulfideViewer.apply_theme-491"><span class="linenos">491</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.apply_theme-492"><a href="#DisulfideViewer.apply_theme-492"><span class="linenos">492</span></a><span class="sd">        Apply the current theme to the plotter widget.</span>
</span><span id="DisulfideViewer.apply_theme-493"><a href="#DisulfideViewer.apply_theme-493"><span class="linenos">493</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.apply_theme-494"><a href="#DisulfideViewer.apply_theme-494"><span class="linenos">494</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_theme</span> <span class="o">==</span> <span class="s2">&quot;dark&quot;</span><span class="p">:</span>
</span><span id="DisulfideViewer.apply_theme-495"><a href="#DisulfideViewer.apply_theme-495"><span class="linenos">495</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">set_background</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="s2">&quot;dark&quot;</span><span class="p">][</span><span class="s2">&quot;background&quot;</span><span class="p">])</span>
</span><span id="DisulfideViewer.apply_theme-496"><a href="#DisulfideViewer.apply_theme-496"><span class="linenos">496</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideViewer.apply_theme-497"><a href="#DisulfideViewer.apply_theme-497"><span class="linenos">497</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">set_background</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="s2">&quot;light&quot;</span><span class="p">][</span><span class="s2">&quot;background&quot;</span><span class="p">])</span>
</span><span id="DisulfideViewer.apply_theme-498"><a href="#DisulfideViewer.apply_theme-498"><span class="linenos">498</span></a>
</span><span id="DisulfideViewer.apply_theme-499"><a href="#DisulfideViewer.apply_theme-499"><span class="linenos">499</span></a>        <span class="c1"># Render the plotter to apply the changes</span>
</span><span id="DisulfideViewer.apply_theme-500"><a href="#DisulfideViewer.apply_theme-500"><span class="linenos">500</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Apply the current theme to the plotter widget.</p>
</div>


                            </div>
                            <div id="DisulfideViewer.create_menubar" class="classattr">
                                        <input id="DisulfideViewer.create_menubar-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_menubar</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideViewer.create_menubar-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.create_menubar"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.create_menubar-502"><a href="#DisulfideViewer.create_menubar-502"><span class="linenos">502</span></a>    <span class="k">def</span> <span class="nf">create_menubar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideViewer.create_menubar-503"><a href="#DisulfideViewer.create_menubar-503"><span class="linenos">503</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.create_menubar-504"><a href="#DisulfideViewer.create_menubar-504"><span class="linenos">504</span></a><span class="sd">        Creates the menubar</span>
</span><span id="DisulfideViewer.create_menubar-505"><a href="#DisulfideViewer.create_menubar-505"><span class="linenos">505</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.create_menubar-506"><a href="#DisulfideViewer.create_menubar-506"><span class="linenos">506</span></a>        <span class="n">menubar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span>
</span><span id="DisulfideViewer.create_menubar-507"><a href="#DisulfideViewer.create_menubar-507"><span class="linenos">507</span></a>
</span><span id="DisulfideViewer.create_menubar-508"><a href="#DisulfideViewer.create_menubar-508"><span class="linenos">508</span></a>        <span class="c1"># File menu</span>
</span><span id="DisulfideViewer.create_menubar-509"><a href="#DisulfideViewer.create_menubar-509"><span class="linenos">509</span></a>        <span class="n">file_menu</span> <span class="o">=</span> <span class="n">menubar</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s2">&quot;File&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.create_menubar-510"><a href="#DisulfideViewer.create_menubar-510"><span class="linenos">510</span></a>        <span class="n">reset_menu</span> <span class="o">=</span> <span class="n">menubar</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s2">&quot;Reset&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.create_menubar-511"><a href="#DisulfideViewer.create_menubar-511"><span class="linenos">511</span></a>
</span><span id="DisulfideViewer.create_menubar-512"><a href="#DisulfideViewer.create_menubar-512"><span class="linenos">512</span></a>        <span class="c1"># Save screenshot action</span>
</span><span id="DisulfideViewer.create_menubar-513"><a href="#DisulfideViewer.create_menubar-513"><span class="linenos">513</span></a>        <span class="n">save_screenshot_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Save Screenshot&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="DisulfideViewer.create_menubar-514"><a href="#DisulfideViewer.create_menubar-514"><span class="linenos">514</span></a>        <span class="n">save_screenshot_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_screenshot</span><span class="p">)</span>
</span><span id="DisulfideViewer.create_menubar-515"><a href="#DisulfideViewer.create_menubar-515"><span class="linenos">515</span></a>        <span class="n">file_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">save_screenshot_action</span><span class="p">)</span>
</span><span id="DisulfideViewer.create_menubar-516"><a href="#DisulfideViewer.create_menubar-516"><span class="linenos">516</span></a>
</span><span id="DisulfideViewer.create_menubar-517"><a href="#DisulfideViewer.create_menubar-517"><span class="linenos">517</span></a>        <span class="c1"># Export scene action</span>
</span><span id="DisulfideViewer.create_menubar-518"><a href="#DisulfideViewer.create_menubar-518"><span class="linenos">518</span></a>        <span class="n">export_scene_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Export Scene&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="DisulfideViewer.create_menubar-519"><a href="#DisulfideViewer.create_menubar-519"><span class="linenos">519</span></a>        <span class="n">export_scene_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_scene</span><span class="p">)</span>
</span><span id="DisulfideViewer.create_menubar-520"><a href="#DisulfideViewer.create_menubar-520"><span class="linenos">520</span></a>        <span class="n">file_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">export_scene_action</span><span class="p">)</span>
</span><span id="DisulfideViewer.create_menubar-521"><a href="#DisulfideViewer.create_menubar-521"><span class="linenos">521</span></a>
</span><span id="DisulfideViewer.create_menubar-522"><a href="#DisulfideViewer.create_menubar-522"><span class="linenos">522</span></a>        <span class="c1"># Reset action</span>
</span><span id="DisulfideViewer.create_menubar-523"><a href="#DisulfideViewer.create_menubar-523"><span class="linenos">523</span></a>        <span class="n">reset_action</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Reset&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="DisulfideViewer.create_menubar-524"><a href="#DisulfideViewer.create_menubar-524"><span class="linenos">524</span></a>        <span class="n">reset_action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">)</span>
</span><span id="DisulfideViewer.create_menubar-525"><a href="#DisulfideViewer.create_menubar-525"><span class="linenos">525</span></a>        <span class="n">reset_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">reset_action</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Creates the menubar</p>
</div>


                            </div>
                            <div id="DisulfideViewer.save_screenshot" class="classattr">
                                        <input id="DisulfideViewer.save_screenshot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save_screenshot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideViewer.save_screenshot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.save_screenshot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.save_screenshot-527"><a href="#DisulfideViewer.save_screenshot-527"><span class="linenos">527</span></a>    <span class="k">def</span> <span class="nf">save_screenshot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideViewer.save_screenshot-528"><a href="#DisulfideViewer.save_screenshot-528"><span class="linenos">528</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.save_screenshot-529"><a href="#DisulfideViewer.save_screenshot-529"><span class="linenos">529</span></a><span class="sd">        Save the current scene as a screenshot</span>
</span><span id="DisulfideViewer.save_screenshot-530"><a href="#DisulfideViewer.save_screenshot-530"><span class="linenos">530</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.save_screenshot-531"><a href="#DisulfideViewer.save_screenshot-531"><span class="linenos">531</span></a>        <span class="n">options</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>
</span><span id="DisulfideViewer.save_screenshot-532"><a href="#DisulfideViewer.save_screenshot-532"><span class="linenos">532</span></a>        <span class="n">file_path</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span>
</span><span id="DisulfideViewer.save_screenshot-533"><a href="#DisulfideViewer.save_screenshot-533"><span class="linenos">533</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="DisulfideViewer.save_screenshot-534"><a href="#DisulfideViewer.save_screenshot-534"><span class="linenos">534</span></a>            <span class="s2">&quot;Save Screenshot&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer.save_screenshot-535"><a href="#DisulfideViewer.save_screenshot-535"><span class="linenos">535</span></a>            <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer.save_screenshot-536"><a href="#DisulfideViewer.save_screenshot-536"><span class="linenos">536</span></a>            <span class="s2">&quot;PNG Files (*.png);;All Files (*)&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer.save_screenshot-537"><a href="#DisulfideViewer.save_screenshot-537"><span class="linenos">537</span></a>            <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">,</span>
</span><span id="DisulfideViewer.save_screenshot-538"><a href="#DisulfideViewer.save_screenshot-538"><span class="linenos">538</span></a>        <span class="p">)</span>
</span><span id="DisulfideViewer.save_screenshot-539"><a href="#DisulfideViewer.save_screenshot-539"><span class="linenos">539</span></a>        <span class="k">if</span> <span class="n">file_path</span><span class="p">:</span>
</span><span id="DisulfideViewer.save_screenshot-540"><a href="#DisulfideViewer.save_screenshot-540"><span class="linenos">540</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">screenshot</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Save the current scene as a screenshot</p>
</div>


                            </div>
                            <div id="DisulfideViewer.export_scene" class="classattr">
                                        <input id="DisulfideViewer.export_scene-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">export_scene</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideViewer.export_scene-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.export_scene"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.export_scene-542"><a href="#DisulfideViewer.export_scene-542"><span class="linenos">542</span></a>    <span class="k">def</span> <span class="nf">export_scene</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideViewer.export_scene-543"><a href="#DisulfideViewer.export_scene-543"><span class="linenos">543</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.export_scene-544"><a href="#DisulfideViewer.export_scene-544"><span class="linenos">544</span></a><span class="sd">        Export the current scene as an HTML file</span>
</span><span id="DisulfideViewer.export_scene-545"><a href="#DisulfideViewer.export_scene-545"><span class="linenos">545</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.export_scene-546"><a href="#DisulfideViewer.export_scene-546"><span class="linenos">546</span></a>        <span class="n">options</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>
</span><span id="DisulfideViewer.export_scene-547"><a href="#DisulfideViewer.export_scene-547"><span class="linenos">547</span></a>        <span class="n">file_path</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span>
</span><span id="DisulfideViewer.export_scene-548"><a href="#DisulfideViewer.export_scene-548"><span class="linenos">548</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="DisulfideViewer.export_scene-549"><a href="#DisulfideViewer.export_scene-549"><span class="linenos">549</span></a>            <span class="s2">&quot;Export Scene&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer.export_scene-550"><a href="#DisulfideViewer.export_scene-550"><span class="linenos">550</span></a>            <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer.export_scene-551"><a href="#DisulfideViewer.export_scene-551"><span class="linenos">551</span></a>            <span class="s2">&quot;HTML Files (*.html);;All Files (*)&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer.export_scene-552"><a href="#DisulfideViewer.export_scene-552"><span class="linenos">552</span></a>            <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">,</span>
</span><span id="DisulfideViewer.export_scene-553"><a href="#DisulfideViewer.export_scene-553"><span class="linenos">553</span></a>        <span class="p">)</span>
</span><span id="DisulfideViewer.export_scene-554"><a href="#DisulfideViewer.export_scene-554"><span class="linenos">554</span></a>        <span class="k">if</span> <span class="n">file_path</span><span class="p">:</span>
</span><span id="DisulfideViewer.export_scene-555"><a href="#DisulfideViewer.export_scene-555"><span class="linenos">555</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">export_html</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Export the current scene as an HTML file</p>
</div>


                            </div>
                            <div id="DisulfideViewer.add_custom_lights" class="classattr">
                                        <input id="DisulfideViewer.add_custom_lights-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_custom_lights</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">plotter</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideViewer.add_custom_lights-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.add_custom_lights"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.add_custom_lights-557"><a href="#DisulfideViewer.add_custom_lights-557"><span class="linenos">557</span></a>    <span class="k">def</span> <span class="nf">add_custom_lights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotter</span><span class="p">):</span>
</span><span id="DisulfideViewer.add_custom_lights-558"><a href="#DisulfideViewer.add_custom_lights-558"><span class="linenos">558</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.add_custom_lights-559"><a href="#DisulfideViewer.add_custom_lights-559"><span class="linenos">559</span></a><span class="sd">        Adds custom lighting to the plotter for enhanced visualization.</span>
</span><span id="DisulfideViewer.add_custom_lights-560"><a href="#DisulfideViewer.add_custom_lights-560"><span class="linenos">560</span></a>
</span><span id="DisulfideViewer.add_custom_lights-561"><a href="#DisulfideViewer.add_custom_lights-561"><span class="linenos">561</span></a><span class="sd">        Parameters:</span>
</span><span id="DisulfideViewer.add_custom_lights-562"><a href="#DisulfideViewer.add_custom_lights-562"><span class="linenos">562</span></a><span class="sd">            plotter (QtInteractor): The PyVista plotter widget.</span>
</span><span id="DisulfideViewer.add_custom_lights-563"><a href="#DisulfideViewer.add_custom_lights-563"><span class="linenos">563</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.add_custom_lights-564"><a href="#DisulfideViewer.add_custom_lights-564"><span class="linenos">564</span></a>        <span class="c1"># Remove existing lights to prevent duplication</span>
</span><span id="DisulfideViewer.add_custom_lights-565"><a href="#DisulfideViewer.add_custom_lights-565"><span class="linenos">565</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">remove_all_lights</span><span class="p">()</span>
</span><span id="DisulfideViewer.add_custom_lights-566"><a href="#DisulfideViewer.add_custom_lights-566"><span class="linenos">566</span></a>
</span><span id="DisulfideViewer.add_custom_lights-567"><a href="#DisulfideViewer.add_custom_lights-567"><span class="linenos">567</span></a>        <span class="c1"># Define multiple light sources for better illumination</span>
</span><span id="DisulfideViewer.add_custom_lights-568"><a href="#DisulfideViewer.add_custom_lights-568"><span class="linenos">568</span></a>        <span class="n">light1</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Light</span><span class="p">(</span>
</span><span id="DisulfideViewer.add_custom_lights-569"><a href="#DisulfideViewer.add_custom_lights-569"><span class="linenos">569</span></a>            <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">focal_point</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">intensity</span><span class="o">=</span><span class="mf">1.0</span>
</span><span id="DisulfideViewer.add_custom_lights-570"><a href="#DisulfideViewer.add_custom_lights-570"><span class="linenos">570</span></a>        <span class="p">)</span>
</span><span id="DisulfideViewer.add_custom_lights-571"><a href="#DisulfideViewer.add_custom_lights-571"><span class="linenos">571</span></a>        <span class="n">light2</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Light</span><span class="p">(</span>
</span><span id="DisulfideViewer.add_custom_lights-572"><a href="#DisulfideViewer.add_custom_lights-572"><span class="linenos">572</span></a>            <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">focal_point</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">intensity</span><span class="o">=</span><span class="mf">0.5</span>
</span><span id="DisulfideViewer.add_custom_lights-573"><a href="#DisulfideViewer.add_custom_lights-573"><span class="linenos">573</span></a>        <span class="p">)</span>
</span><span id="DisulfideViewer.add_custom_lights-574"><a href="#DisulfideViewer.add_custom_lights-574"><span class="linenos">574</span></a>        <span class="n">light3</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Light</span><span class="p">(</span>
</span><span id="DisulfideViewer.add_custom_lights-575"><a href="#DisulfideViewer.add_custom_lights-575"><span class="linenos">575</span></a>            <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">),</span> <span class="n">focal_point</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">intensity</span><span class="o">=</span><span class="mf">0.5</span>
</span><span id="DisulfideViewer.add_custom_lights-576"><a href="#DisulfideViewer.add_custom_lights-576"><span class="linenos">576</span></a>        <span class="p">)</span>
</span><span id="DisulfideViewer.add_custom_lights-577"><a href="#DisulfideViewer.add_custom_lights-577"><span class="linenos">577</span></a>
</span><span id="DisulfideViewer.add_custom_lights-578"><a href="#DisulfideViewer.add_custom_lights-578"><span class="linenos">578</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">add_light</span><span class="p">(</span><span class="n">light1</span><span class="p">)</span>
</span><span id="DisulfideViewer.add_custom_lights-579"><a href="#DisulfideViewer.add_custom_lights-579"><span class="linenos">579</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">add_light</span><span class="p">(</span><span class="n">light2</span><span class="p">)</span>
</span><span id="DisulfideViewer.add_custom_lights-580"><a href="#DisulfideViewer.add_custom_lights-580"><span class="linenos">580</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">add_light</span><span class="p">(</span><span class="n">light3</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Adds custom lighting to the plotter for enhanced visualization.</p>

<p>Parameters:
    plotter (QtInteractor): The PyVista plotter widget.</p>
</div>


                            </div>
                            <div id="DisulfideViewer.new_plotter" class="classattr">
                                        <input id="DisulfideViewer.new_plotter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">new_plotter</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">rows</span><span class="o">=</span><span class="mi">1</span>, </span><span class="param"><span class="n">cols</span><span class="o">=</span><span class="mi">1</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideViewer.new_plotter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.new_plotter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.new_plotter-582"><a href="#DisulfideViewer.new_plotter-582"><span class="linenos">582</span></a>    <span class="k">def</span> <span class="nf">new_plotter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="DisulfideViewer.new_plotter-583"><a href="#DisulfideViewer.new_plotter-583"><span class="linenos">583</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.new_plotter-584"><a href="#DisulfideViewer.new_plotter-584"><span class="linenos">584</span></a><span class="sd">        Create a new QtInteractor with the specified number of rows and columns.</span>
</span><span id="DisulfideViewer.new_plotter-585"><a href="#DisulfideViewer.new_plotter-585"><span class="linenos">585</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.new_plotter-586"><a href="#DisulfideViewer.new_plotter-586"><span class="linenos">586</span></a>
</span><span id="DisulfideViewer.new_plotter-587"><a href="#DisulfideViewer.new_plotter-587"><span class="linenos">587</span></a>        <span class="c1"># Create a new QtInteractor with the desired shape</span>
</span><span id="DisulfideViewer.new_plotter-588"><a href="#DisulfideViewer.new_plotter-588"><span class="linenos">588</span></a>        <span class="n">new_plotter_widget</span> <span class="o">=</span> <span class="n">QtInteractor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">))</span>
</span><span id="DisulfideViewer.new_plotter-589"><a href="#DisulfideViewer.new_plotter-589"><span class="linenos">589</span></a>
</span><span id="DisulfideViewer.new_plotter-590"><a href="#DisulfideViewer.new_plotter-590"><span class="linenos">590</span></a>        <span class="c1"># Update the layout to replace the old plotter widget with the new one</span>
</span><span id="DisulfideViewer.new_plotter-591"><a href="#DisulfideViewer.new_plotter-591"><span class="linenos">591</span></a>        <span class="n">layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">centralWidget</span><span class="p">()</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span>
</span><span id="DisulfideViewer.new_plotter-592"><a href="#DisulfideViewer.new_plotter-592"><span class="linenos">592</span></a>        <span class="n">layout</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="p">)</span>  <span class="c1"># Remove the old plotter widget</span>
</span><span id="DisulfideViewer.new_plotter-593"><a href="#DisulfideViewer.new_plotter-593"><span class="linenos">593</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span>
</span><span id="DisulfideViewer.new_plotter-594"><a href="#DisulfideViewer.new_plotter-594"><span class="linenos">594</span></a>            <span class="kc">None</span>
</span><span id="DisulfideViewer.new_plotter-595"><a href="#DisulfideViewer.new_plotter-595"><span class="linenos">595</span></a>        <span class="p">)</span>  <span class="c1"># Detach the old plotter widget from its parent</span>
</span><span id="DisulfideViewer.new_plotter-596"><a href="#DisulfideViewer.new_plotter-596"><span class="linenos">596</span></a>
</span><span id="DisulfideViewer.new_plotter-597"><a href="#DisulfideViewer.new_plotter-597"><span class="linenos">597</span></a>        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">new_plotter_widget</span><span class="p">)</span>  <span class="c1"># Add the new plotter widget to the layout</span>
</span><span id="DisulfideViewer.new_plotter-598"><a href="#DisulfideViewer.new_plotter-598"><span class="linenos">598</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DisulfideViewer.new_plotter-599"><a href="#DisulfideViewer.new_plotter-599"><span class="linenos">599</span></a>            <span class="n">new_plotter_widget</span>  <span class="c1"># Update the reference to the new plotter widget</span>
</span><span id="DisulfideViewer.new_plotter-600"><a href="#DisulfideViewer.new_plotter-600"><span class="linenos">600</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a new QtInteractor with the specified number of rows and columns.</p>
</div>


                            </div>
                            <div id="DisulfideViewer.display" class="classattr">
                                        <input id="DisulfideViewer.display-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">display</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">light</span><span class="o">=</span><span class="s1">&#39;Auto&#39;</span>, </span><span class="param"><span class="n">shadows</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideViewer.display-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.display"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.display-602"><a href="#DisulfideViewer.display-602"><span class="linenos">602</span></a>    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">light</span><span class="o">=</span><span class="s2">&quot;Auto&quot;</span><span class="p">,</span> <span class="n">shadows</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="DisulfideViewer.display-603"><a href="#DisulfideViewer.display-603"><span class="linenos">603</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.display-604"><a href="#DisulfideViewer.display-604"><span class="linenos">604</span></a><span class="sd">        Renders the current disulfide bond using the specified style.</span>
</span><span id="DisulfideViewer.display-605"><a href="#DisulfideViewer.display-605"><span class="linenos">605</span></a>
</span><span id="DisulfideViewer.display-606"><a href="#DisulfideViewer.display-606"><span class="linenos">606</span></a><span class="sd">        Parameters:</span>
</span><span id="DisulfideViewer.display-607"><a href="#DisulfideViewer.display-607"><span class="linenos">607</span></a><span class="sd">            style (str): The rendering style (e.g., &#39;cpk&#39;, &#39;sb&#39;).</span>
</span><span id="DisulfideViewer.display-608"><a href="#DisulfideViewer.display-608"><span class="linenos">608</span></a><span class="sd">            light (str): The lighting theme (&#39;Light&#39;, &#39;Dark&#39;, or &#39;Auto&#39;).</span>
</span><span id="DisulfideViewer.display-609"><a href="#DisulfideViewer.display-609"><span class="linenos">609</span></a><span class="sd">            single (bool): Whether to display a single bond or multiple.</span>
</span><span id="DisulfideViewer.display-610"><a href="#DisulfideViewer.display-610"><span class="linenos">610</span></a><span class="sd">            winsize (tuple): The window size for rendering.</span>
</span><span id="DisulfideViewer.display-611"><a href="#DisulfideViewer.display-611"><span class="linenos">611</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.display-612"><a href="#DisulfideViewer.display-612"><span class="linenos">612</span></a>        <span class="n">style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_style</span>
</span><span id="DisulfideViewer.display-613"><a href="#DisulfideViewer.display-613"><span class="linenos">613</span></a>        <span class="n">camera_position</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>  <span class="c1"># Example values</span>
</span><span id="DisulfideViewer.display-614"><a href="#DisulfideViewer.display-614"><span class="linenos">614</span></a>
</span><span id="DisulfideViewer.display-615"><a href="#DisulfideViewer.display-615"><span class="linenos">615</span></a>        <span class="n">plotter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span>  <span class="c1"># Use QtInteractor as the plotter</span>
</span><span id="DisulfideViewer.display-616"><a href="#DisulfideViewer.display-616"><span class="linenos">616</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotter_widget</span><span class="o">.</span><span class="n">camera_position</span> <span class="o">=</span> <span class="n">camera_position</span>
</span><span id="DisulfideViewer.display-617"><a href="#DisulfideViewer.display-617"><span class="linenos">617</span></a>
</span><span id="DisulfideViewer.display-618"><a href="#DisulfideViewer.display-618"><span class="linenos">618</span></a>        <span class="c1"># Set the camera up vector</span>
</span><span id="DisulfideViewer.display-619"><a href="#DisulfideViewer.display-619"><span class="linenos">619</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">camera_set</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DisulfideViewer.display-620"><a href="#DisulfideViewer.display-620"><span class="linenos">620</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">view_up</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="DisulfideViewer.display-621"><a href="#DisulfideViewer.display-621"><span class="linenos">621</span></a>
</span><span id="DisulfideViewer.display-622"><a href="#DisulfideViewer.display-622"><span class="linenos">622</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="DisulfideViewer.display-623"><a href="#DisulfideViewer.display-623"><span class="linenos">623</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">add_axes</span><span class="p">()</span>
</span><span id="DisulfideViewer.display-624"><a href="#DisulfideViewer.display-624"><span class="linenos">624</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="DisulfideViewer.display-625"><a href="#DisulfideViewer.display-625"><span class="linenos">625</span></a>
</span><span id="DisulfideViewer.display-626"><a href="#DisulfideViewer.display-626"><span class="linenos">626</span></a>        <span class="k">if</span> <span class="n">shadows</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="DisulfideViewer.display-627"><a href="#DisulfideViewer.display-627"><span class="linenos">627</span></a>            <span class="n">plotter</span><span class="o">.</span><span class="n">enable_shadows</span><span class="p">()</span>
</span><span id="DisulfideViewer.display-628"><a href="#DisulfideViewer.display-628"><span class="linenos">628</span></a>
</span><span id="DisulfideViewer.display-629"><a href="#DisulfideViewer.display-629"><span class="linenos">629</span></a>        <span class="n">title</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DisulfideViewer.display-630"><a href="#DisulfideViewer.display-630"><span class="linenos">630</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">energy</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> kcal/mol. &quot;</span>
</span><span id="DisulfideViewer.display-631"><a href="#DisulfideViewer.display-631"><span class="linenos">631</span></a>            <span class="sa">f</span><span class="s2">&quot;C: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">ca_distance</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">  &quot;</span>
</span><span id="DisulfideViewer.display-632"><a href="#DisulfideViewer.display-632"><span class="linenos">632</span></a>            <span class="sa">f</span><span class="s2">&quot;C: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">cb_distance</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">  &quot;</span>
</span><span id="DisulfideViewer.display-633"><a href="#DisulfideViewer.display-633"><span class="linenos">633</span></a>            <span class="sa">f</span><span class="s2">&quot;Tors: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">torsion_length</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DisulfideViewer.display-634"><a href="#DisulfideViewer.display-634"><span class="linenos">634</span></a>        <span class="p">)</span>
</span><span id="DisulfideViewer.display-635"><a href="#DisulfideViewer.display-635"><span class="linenos">635</span></a>        <span class="c1"># Determine the theme and set the background color</span>
</span><span id="DisulfideViewer.display-636"><a href="#DisulfideViewer.display-636"><span class="linenos">636</span></a>        <span class="n">_theme</span> <span class="o">=</span> <span class="n">light</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">light</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Light&quot;</span><span class="p">,</span> <span class="s2">&quot;Dark&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="n">get_theme</span><span class="p">()</span>
</span><span id="DisulfideViewer.display-637"><a href="#DisulfideViewer.display-637"><span class="linenos">637</span></a>        <span class="k">if</span> <span class="n">_theme</span> <span class="o">==</span> <span class="s2">&quot;dark&quot;</span><span class="p">:</span>
</span><span id="DisulfideViewer.display-638"><a href="#DisulfideViewer.display-638"><span class="linenos">638</span></a>            <span class="n">pv</span><span class="o">.</span><span class="n">set_plot_theme</span><span class="p">(</span><span class="s2">&quot;dark&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.display-639"><a href="#DisulfideViewer.display-639"><span class="linenos">639</span></a>            <span class="n">plotter</span><span class="o">.</span><span class="n">set_background</span><span class="p">(</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.display-640"><a href="#DisulfideViewer.display-640"><span class="linenos">640</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideViewer.display-641"><a href="#DisulfideViewer.display-641"><span class="linenos">641</span></a>            <span class="n">pv</span><span class="o">.</span><span class="n">set_plot_theme</span><span class="p">(</span><span class="s2">&quot;document&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.display-642"><a href="#DisulfideViewer.display-642"><span class="linenos">642</span></a>            <span class="n">plotter</span><span class="o">.</span><span class="n">set_background</span><span class="p">(</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.display-643"><a href="#DisulfideViewer.display-643"><span class="linenos">643</span></a>
</span><span id="DisulfideViewer.display-644"><a href="#DisulfideViewer.display-644"><span class="linenos">644</span></a>        <span class="c1"># Apply the current theme</span>
</span><span id="DisulfideViewer.display-645"><a href="#DisulfideViewer.display-645"><span class="linenos">645</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_theme</span> <span class="o">=</span> <span class="n">_theme</span>
</span><span id="DisulfideViewer.display-646"><a href="#DisulfideViewer.display-646"><span class="linenos">646</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">apply_theme</span><span class="p">()</span>
</span><span id="DisulfideViewer.display-647"><a href="#DisulfideViewer.display-647"><span class="linenos">647</span></a>
</span><span id="DisulfideViewer.display-648"><a href="#DisulfideViewer.display-648"><span class="linenos">648</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.display-649"><a href="#DisulfideViewer.display-649"><span class="linenos">649</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">enable_anti_aliasing</span><span class="p">(</span><span class="s2">&quot;msaa&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.display-650"><a href="#DisulfideViewer.display-650"><span class="linenos">650</span></a>
</span><span id="DisulfideViewer.display-651"><a href="#DisulfideViewer.display-651"><span class="linenos">651</span></a>        <span class="c1"># Add custom lights</span>
</span><span id="DisulfideViewer.display-652"><a href="#DisulfideViewer.display-652"><span class="linenos">652</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_custom_lights</span><span class="p">(</span><span class="n">plotter</span><span class="p">)</span>
</span><span id="DisulfideViewer.display-653"><a href="#DisulfideViewer.display-653"><span class="linenos">653</span></a>
</span><span id="DisulfideViewer.display-654"><a href="#DisulfideViewer.display-654"><span class="linenos">654</span></a>        <span class="c1"># Perform the plotting with the specified style</span>
</span><span id="DisulfideViewer.display-655"><a href="#DisulfideViewer.display-655"><span class="linenos">655</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">single</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="DisulfideViewer.display-656"><a href="#DisulfideViewer.display-656"><span class="linenos">656</span></a>            <span class="c1"># self.new_plotter(rows=1, cols=1)</span>
</span><span id="DisulfideViewer.display-657"><a href="#DisulfideViewer.display-657"><span class="linenos">657</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">plotter</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>
</span><span id="DisulfideViewer.display-658"><a href="#DisulfideViewer.display-658"><span class="linenos">658</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideViewer.display-659"><a href="#DisulfideViewer.display-659"><span class="linenos">659</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">display_overlay</span><span class="p">(</span><span class="n">plotter</span><span class="p">)</span>
</span><span id="DisulfideViewer.display-660"><a href="#DisulfideViewer.display-660"><span class="linenos">660</span></a>
</span><span id="DisulfideViewer.display-661"><a href="#DisulfideViewer.display-661"><span class="linenos">661</span></a>        <span class="c1"># Set perspective projection</span>
</span><span id="DisulfideViewer.display-662"><a href="#DisulfideViewer.display-662"><span class="linenos">662</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">SetParallelProjection</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># False for perspective</span>
</span><span id="DisulfideViewer.display-663"><a href="#DisulfideViewer.display-663"><span class="linenos">663</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">()</span>
</span><span id="DisulfideViewer.display-664"><a href="#DisulfideViewer.display-664"><span class="linenos">664</span></a>        <span class="n">plotter</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Renders the current disulfide bond using the specified style.</p>

<p>Parameters:
    style (str): The rendering style (e.g., 'cpk', 'sb').
    light (str): The lighting theme ('Light', 'Dark', or 'Auto').
    single (bool): Whether to display a single bond or multiple.
    winsize (tuple): The window size for rendering.</p>
</div>


                            </div>
                            <div id="DisulfideViewer.display_overlay" class="classattr">
                                        <input id="DisulfideViewer.display_overlay-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">display_overlay</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">pl</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideViewer.display_overlay-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideViewer.display_overlay"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideViewer.display_overlay-666"><a href="#DisulfideViewer.display_overlay-666"><span class="linenos">666</span></a>    <span class="k">def</span> <span class="nf">display_overlay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pl</span><span class="p">):</span>
</span><span id="DisulfideViewer.display_overlay-667"><a href="#DisulfideViewer.display_overlay-667"><span class="linenos">667</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.display_overlay-668"><a href="#DisulfideViewer.display_overlay-668"><span class="linenos">668</span></a><span class="sd">        Display all disulfides in the list overlaid in stick mode against</span>
</span><span id="DisulfideViewer.display_overlay-669"><a href="#DisulfideViewer.display_overlay-669"><span class="linenos">669</span></a><span class="sd">        a common coordinate frames. This allows us to see all of the disulfides</span>
</span><span id="DisulfideViewer.display_overlay-670"><a href="#DisulfideViewer.display_overlay-670"><span class="linenos">670</span></a><span class="sd">        at one time in a single view. Colors vary smoothy between bonds.</span>
</span><span id="DisulfideViewer.display_overlay-671"><a href="#DisulfideViewer.display_overlay-671"><span class="linenos">671</span></a>
</span><span id="DisulfideViewer.display_overlay-672"><a href="#DisulfideViewer.display_overlay-672"><span class="linenos">672</span></a><span class="sd">        :param screenshot: Save a screenshot, defaults to False</span>
</span><span id="DisulfideViewer.display_overlay-673"><a href="#DisulfideViewer.display_overlay-673"><span class="linenos">673</span></a><span class="sd">        :param movie: Save a movie, defaults to False</span>
</span><span id="DisulfideViewer.display_overlay-674"><a href="#DisulfideViewer.display_overlay-674"><span class="linenos">674</span></a><span class="sd">        :param verbose: Verbosity, defaults to True</span>
</span><span id="DisulfideViewer.display_overlay-675"><a href="#DisulfideViewer.display_overlay-675"><span class="linenos">675</span></a><span class="sd">        :param fname: Filename to save for the movie or screenshot, defaults to &#39;ss_overlay.png&#39;</span>
</span><span id="DisulfideViewer.display_overlay-676"><a href="#DisulfideViewer.display_overlay-676"><span class="linenos">676</span></a><span class="sd">        :param light: Background color, defaults to True for White. False for Dark.</span>
</span><span id="DisulfideViewer.display_overlay-677"><a href="#DisulfideViewer.display_overlay-677"><span class="linenos">677</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideViewer.display_overlay-678"><a href="#DisulfideViewer.display_overlay-678"><span class="linenos">678</span></a>        <span class="n">sslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_sslist</span>
</span><span id="DisulfideViewer.display_overlay-679"><a href="#DisulfideViewer.display_overlay-679"><span class="linenos">679</span></a>        <span class="n">ssbonds</span> <span class="o">=</span> <span class="n">sslist</span><span class="o">.</span><span class="n">data</span>
</span><span id="DisulfideViewer.display_overlay-680"><a href="#DisulfideViewer.display_overlay-680"><span class="linenos">680</span></a>        <span class="n">tot_ss</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ssbonds</span><span class="p">)</span>  <span class="c1"># number off ssbonds</span>
</span><span id="DisulfideViewer.display_overlay-681"><a href="#DisulfideViewer.display_overlay-681"><span class="linenos">681</span></a>        <span class="n">avg_enrg</span> <span class="o">=</span> <span class="n">sslist</span><span class="o">.</span><span class="n">average_energy</span>
</span><span id="DisulfideViewer.display_overlay-682"><a href="#DisulfideViewer.display_overlay-682"><span class="linenos">682</span></a>        <span class="n">avg_dist</span> <span class="o">=</span> <span class="n">sslist</span><span class="o">.</span><span class="n">average_distance</span>
</span><span id="DisulfideViewer.display_overlay-683"><a href="#DisulfideViewer.display_overlay-683"><span class="linenos">683</span></a>        <span class="n">resolution</span> <span class="o">=</span> <span class="n">sslist</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="DisulfideViewer.display_overlay-684"><a href="#DisulfideViewer.display_overlay-684"><span class="linenos">684</span></a>
</span><span id="DisulfideViewer.display_overlay-685"><a href="#DisulfideViewer.display_overlay-685"><span class="linenos">685</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="mi">100</span>
</span><span id="DisulfideViewer.display_overlay-686"><a href="#DisulfideViewer.display_overlay-686"><span class="linenos">686</span></a>
</span><span id="DisulfideViewer.display_overlay-687"><a href="#DisulfideViewer.display_overlay-687"><span class="linenos">687</span></a>        <span class="k">if</span> <span class="n">tot_ss</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
</span><span id="DisulfideViewer.display_overlay-688"><a href="#DisulfideViewer.display_overlay-688"><span class="linenos">688</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="mi">60</span>
</span><span id="DisulfideViewer.display_overlay-689"><a href="#DisulfideViewer.display_overlay-689"><span class="linenos">689</span></a>        <span class="k">if</span> <span class="n">tot_ss</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>
</span><span id="DisulfideViewer.display_overlay-690"><a href="#DisulfideViewer.display_overlay-690"><span class="linenos">690</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="mi">30</span>
</span><span id="DisulfideViewer.display_overlay-691"><a href="#DisulfideViewer.display_overlay-691"><span class="linenos">691</span></a>        <span class="k">if</span> <span class="n">tot_ss</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
</span><span id="DisulfideViewer.display_overlay-692"><a href="#DisulfideViewer.display_overlay-692"><span class="linenos">692</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="mi">8</span>
</span><span id="DisulfideViewer.display_overlay-693"><a href="#DisulfideViewer.display_overlay-693"><span class="linenos">693</span></a>
</span><span id="DisulfideViewer.display_overlay-694"><a href="#DisulfideViewer.display_overlay-694"><span class="linenos">694</span></a>        <span class="n">title</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DisulfideViewer.display_overlay-695"><a href="#DisulfideViewer.display_overlay-695"><span class="linenos">695</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ss</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">resolution</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> : (</span><span class="si">{</span><span class="n">tot_ss</span><span class="si">}</span><span class="s2"> SS), &quot;</span>
</span><span id="DisulfideViewer.display_overlay-696"><a href="#DisulfideViewer.display_overlay-696"><span class="linenos">696</span></a>            <span class="sa">f</span><span class="s2">&quot;Avg E: </span><span class="si">{</span><span class="n">avg_enrg</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> kcal/mol, Avg Dist: </span><span class="si">{</span><span class="n">avg_dist</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> &quot;</span>
</span><span id="DisulfideViewer.display_overlay-697"><a href="#DisulfideViewer.display_overlay-697"><span class="linenos">697</span></a>        <span class="p">)</span>
</span><span id="DisulfideViewer.display_overlay-698"><a href="#DisulfideViewer.display_overlay-698"><span class="linenos">698</span></a>
</span><span id="DisulfideViewer.display_overlay-699"><a href="#DisulfideViewer.display_overlay-699"><span class="linenos">699</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideViewer.display_overlay-700"><a href="#DisulfideViewer.display_overlay-700"><span class="linenos">700</span></a>
</span><span id="DisulfideViewer.display_overlay-701"><a href="#DisulfideViewer.display_overlay-701"><span class="linenos">701</span></a>        <span class="n">pl</span><span class="o">.</span><span class="n">add_axes</span><span class="p">()</span>
</span><span id="DisulfideViewer.display_overlay-702"><a href="#DisulfideViewer.display_overlay-702"><span class="linenos">702</span></a>
</span><span id="DisulfideViewer.display_overlay-703"><a href="#DisulfideViewer.display_overlay-703"><span class="linenos">703</span></a>        <span class="n">mycol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">tot_ss</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</span><span id="DisulfideViewer.display_overlay-704"><a href="#DisulfideViewer.display_overlay-704"><span class="linenos">704</span></a>        <span class="n">mycol</span> <span class="o">=</span> <span class="n">get_jet_colormap</span><span class="p">(</span><span class="n">tot_ss</span><span class="p">)</span>
</span><span id="DisulfideViewer.display_overlay-705"><a href="#DisulfideViewer.display_overlay-705"><span class="linenos">705</span></a>
</span><span id="DisulfideViewer.display_overlay-706"><a href="#DisulfideViewer.display_overlay-706"><span class="linenos">706</span></a>        <span class="c1"># scale the overlay bond radii down so that we can see the individual elements better</span>
</span><span id="DisulfideViewer.display_overlay-707"><a href="#DisulfideViewer.display_overlay-707"><span class="linenos">707</span></a>        <span class="c1"># maximum 90% reduction</span>
</span><span id="DisulfideViewer.display_overlay-708"><a href="#DisulfideViewer.display_overlay-708"><span class="linenos">708</span></a>
</span><span id="DisulfideViewer.display_overlay-709"><a href="#DisulfideViewer.display_overlay-709"><span class="linenos">709</span></a>        <span class="k">if</span> <span class="n">tot_ss</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="DisulfideViewer.display_overlay-710"><a href="#DisulfideViewer.display_overlay-710"><span class="linenos">710</span></a>            <span class="n">brad</span> <span class="o">=</span> <span class="n">BOND_RADIUS</span>
</span><span id="DisulfideViewer.display_overlay-711"><a href="#DisulfideViewer.display_overlay-711"><span class="linenos">711</span></a>        <span class="k">elif</span> <span class="n">tot_ss</span> <span class="o">&lt;</span> <span class="mi">25</span><span class="p">:</span>
</span><span id="DisulfideViewer.display_overlay-712"><a href="#DisulfideViewer.display_overlay-712"><span class="linenos">712</span></a>            <span class="n">brad</span> <span class="o">=</span> <span class="n">BOND_RADIUS</span> <span class="o">*</span> <span class="mf">0.75</span>
</span><span id="DisulfideViewer.display_overlay-713"><a href="#DisulfideViewer.display_overlay-713"><span class="linenos">713</span></a>        <span class="k">elif</span> <span class="n">tot_ss</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">:</span>
</span><span id="DisulfideViewer.display_overlay-714"><a href="#DisulfideViewer.display_overlay-714"><span class="linenos">714</span></a>            <span class="n">brad</span> <span class="o">=</span> <span class="n">BOND_RADIUS</span> <span class="o">*</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="mf">0.8</span>
</span><span id="DisulfideViewer.display_overlay-715"><a href="#DisulfideViewer.display_overlay-715"><span class="linenos">715</span></a>        <span class="k">elif</span> <span class="n">tot_ss</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
</span><span id="DisulfideViewer.display_overlay-716"><a href="#DisulfideViewer.display_overlay-716"><span class="linenos">716</span></a>            <span class="n">brad</span> <span class="o">=</span> <span class="n">BOND_RADIUS</span> <span class="o">*</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="mf">0.7</span>
</span><span id="DisulfideViewer.display_overlay-717"><a href="#DisulfideViewer.display_overlay-717"><span class="linenos">717</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideViewer.display_overlay-718"><a href="#DisulfideViewer.display_overlay-718"><span class="linenos">718</span></a>            <span class="n">brad</span> <span class="o">=</span> <span class="n">BOND_RADIUS</span> <span class="o">*</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="mf">0.6</span>
</span><span id="DisulfideViewer.display_overlay-719"><a href="#DisulfideViewer.display_overlay-719"><span class="linenos">719</span></a>
</span><span id="DisulfideViewer.display_overlay-720"><a href="#DisulfideViewer.display_overlay-720"><span class="linenos">720</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ss</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">tot_ss</span><span class="p">),</span> <span class="n">ssbonds</span><span class="p">):</span>
</span><span id="DisulfideViewer.display_overlay-721"><a href="#DisulfideViewer.display_overlay-721"><span class="linenos">721</span></a>            <span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mycol</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">mycol</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">mycol</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])]</span>
</span><span id="DisulfideViewer.display_overlay-722"><a href="#DisulfideViewer.display_overlay-722"><span class="linenos">722</span></a>            <span class="n">ss</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span>
</span><span id="DisulfideViewer.display_overlay-723"><a href="#DisulfideViewer.display_overlay-723"><span class="linenos">723</span></a>                <span class="n">pl</span><span class="p">,</span>
</span><span id="DisulfideViewer.display_overlay-724"><a href="#DisulfideViewer.display_overlay-724"><span class="linenos">724</span></a>                <span class="n">style</span><span class="o">=</span><span class="s2">&quot;plain&quot;</span><span class="p">,</span>
</span><span id="DisulfideViewer.display_overlay-725"><a href="#DisulfideViewer.display_overlay-725"><span class="linenos">725</span></a>                <span class="n">bondcolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
</span><span id="DisulfideViewer.display_overlay-726"><a href="#DisulfideViewer.display_overlay-726"><span class="linenos">726</span></a>                <span class="n">translate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideViewer.display_overlay-727"><a href="#DisulfideViewer.display_overlay-727"><span class="linenos">727</span></a>                <span class="n">bond_radius</span><span class="o">=</span><span class="n">brad</span><span class="p">,</span>
</span><span id="DisulfideViewer.display_overlay-728"><a href="#DisulfideViewer.display_overlay-728"><span class="linenos">728</span></a>                <span class="n">res</span><span class="o">=</span><span class="n">res</span><span class="p">,</span>
</span><span id="DisulfideViewer.display_overlay-729"><a href="#DisulfideViewer.display_overlay-729"><span class="linenos">729</span></a>            <span class="p">)</span>
</span><span id="DisulfideViewer.display_overlay-730"><a href="#DisulfideViewer.display_overlay-730"><span class="linenos">730</span></a>
</span><span id="DisulfideViewer.display_overlay-731"><a href="#DisulfideViewer.display_overlay-731"><span class="linenos">731</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_camera_view</span><span class="p">()</span>
</span><span id="DisulfideViewer.display_overlay-732"><a href="#DisulfideViewer.display_overlay-732"><span class="linenos">732</span></a>
</span><span id="DisulfideViewer.display_overlay-733"><a href="#DisulfideViewer.display_overlay-733"><span class="linenos">733</span></a>        <span class="k">return</span> <span class="n">pl</span>
</span></pre></div>


            <div class="docstring"><p>Display all disulfides in the list overlaid in stick mode against
a common coordinate frames. This allows us to see all of the disulfides
at one time in a single view. Colors vary smoothy between bonds.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>screenshot</strong>:  Save a screenshot, defaults to False</li>
<li><strong>movie</strong>:  Save a movie, defaults to False</li>
<li><strong>verbose</strong>:  Verbosity, defaults to True</li>
<li><strong>fname</strong>:  Filename to save for the movie or screenshot, defaults to 'ss_overlay.png'</li>
<li><strong>light</strong>:  Background color, defaults to True for White. False for Dark.</li>
</ul>
</div>


                            </div>
                </section>
                <section id="main">
                            <input id="main-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">main</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="main-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#main"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="main-736"><a href="#main-736"><span class="linenos">736</span></a><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="main-737"><a href="#main-737"><span class="linenos">737</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="main-738"><a href="#main-738"><span class="linenos">738</span></a><span class="sd">    The main entry point of the application.</span>
</span><span id="main-739"><a href="#main-739"><span class="linenos">739</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="main-740"><a href="#main-740"><span class="linenos">740</span></a>
</span><span id="main-741"><a href="#main-741"><span class="linenos">741</span></a>    <span class="n">pdb</span> <span class="o">=</span> <span class="n">Load_PDB_SS</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="main-742"><a href="#main-742"><span class="linenos">742</span></a>    <span class="k">if</span> <span class="n">pdb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="main-743"><a href="#main-743"><span class="linenos">743</span></a>        <span class="n">ss_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">pdb</span><span class="o">.</span><span class="n">SSList</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">ss</span><span class="p">:</span> <span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span><span class="p">)</span>
</span><span id="main-744"><a href="#main-744"><span class="linenos">744</span></a>        <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
</span><span id="main-745"><a href="#main-745"><span class="linenos">745</span></a>        <span class="n">viewer</span> <span class="o">=</span> <span class="n">DisulfideViewer</span><span class="p">(</span><span class="n">ss_list</span><span class="p">)</span>
</span><span id="main-746"><a href="#main-746"><span class="linenos">746</span></a>        <span class="n">viewer</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="main-747"><a href="#main-747"><span class="linenos">747</span></a>        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">())</span>
</span><span id="main-748"><a href="#main-748"><span class="linenos">748</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="main-749"><a href="#main-749"><span class="linenos">749</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unable to load database!&quot;</span><span class="p">)</span>
</span><span id="main-750"><a href="#main-750"><span class="linenos">750</span></a>        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>The main entry point of the application.</p>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>