<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>proteusPy.DisulfideClassGenerator API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../proteusPy.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;proteusPy</a>

            <img src="./logo.png" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#NUM_DIHEDRAL_ANGLES">NUM_DIHEDRAL_ANGLES</a>
            </li>
            <li>
                    <a class="variable" href="#VALUES_PER_ANGLE">VALUES_PER_ANGLE</a>
            </li>
            <li>
                    <a class="variable" href="#TOTAL_COMBINATIONS">TOTAL_COMBINATIONS</a>
            </li>
            <li>
                    <a class="variable" href="#BINARY_BASE">BINARY_BASE</a>
            </li>
            <li>
                    <a class="variable" href="#OCTANT_BASE">OCTANT_BASE</a>
            </li>
            <li>
                    <a class="variable" href="#DIHEDRAL_COLUMNS">DIHEDRAL_COLUMNS</a>
            </li>
            <li>
                    <a class="class" href="#DisulfideClassGenerator">DisulfideClassGenerator</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DisulfideClassGenerator.__init__">DisulfideClassGenerator</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassGenerator.parse_class_string">parse_class_string</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideClassGenerator.verbose">verbose</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideClassGenerator.binary_class_disulfides">binary_class_disulfides</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideClassGenerator.octant_class_disulfides">octant_class_disulfides</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideClassGenerator.df">df</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideClassGenerator.binary_df">binary_df</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideClassGenerator.octant_df">octant_df</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideClassGenerator.base">base</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassGenerator.load_csv">load_csv</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassGenerator.class_to_sslist">class_to_sslist</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassGenerator.generate_for_class">generate_for_class</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassGenerator.generate_for_selected_classes">generate_for_selected_classes</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassGenerator.generate_for_all_classes">generate_for_all_classes</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassGenerator.describe">describe</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassGenerator.prepare_energy_data">prepare_energy_data</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassGenerator.plot_energy_by_class">plot_energy_by_class</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassGenerator.plot_torsion_distance_by_class">plot_torsion_distance_by_class</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassGenerator.display">display</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../proteusPy.html">proteusPy</a><wbr>.DisulfideClassGenerator    </h1>

                        <div class="docstring"><p>Generate disulfide conformations for structural classes based on CSV data.</p>

<p>This module provides functionality to create disulfide conformations for different
structural classes using mean and standard deviation values for each dihedral angle.
For each class, it generates all combinations of dihedral angles (mean-std, mean, mean+std)
for each of the 5 dihedral angles, resulting in 3^5 = 243 combinations per class.</p>

<p>Author: Eric G. Suchanek, PhD
Last Modification: 2025-03-23</p>
</div>

                        <input id="mod-DisulfideClassGenerator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-DisulfideClassGenerator-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">Generate disulfide conformations for structural classes based on CSV data.</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">This module provides functionality to create disulfide conformations for different</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">structural classes using mean and standard deviation values for each dihedral angle.</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">For each class, it generates all combinations of dihedral angles (mean-std, mean, mean+std)</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">for each of the 5 dihedral angles, resulting in 3^5 = 243 combinations per class.</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">Author: Eric G. Suchanek, PhD</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="sd">Last Modification: 2025-03-23</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="c1"># pylint: disable=C0103</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">concurrent.futures</span><span class="w"> </span><span class="kn">import</span> <span class="n">ThreadPoolExecutor</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">tqdm</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">proteusPy.DisulfideBase</span><span class="w"> </span><span class="kn">import</span> <span class="n">Disulfide</span><span class="p">,</span> <span class="n">DisulfideList</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">proteusPy.DisulfideVisualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">DisulfideVisualization</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">proteusPy.logger_config</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_logger</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">proteusPy.ProteusGlobals</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>    <span class="n">BINARY_CLASS_METRICS_FILE</span><span class="p">,</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>    <span class="n">DATA_DIR</span><span class="p">,</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>    <span class="n">OCTANT_CLASS_METRICS_FILE</span><span class="p">,</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="p">)</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="c1"># Constants</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="n">NUM_DIHEDRAL_ANGLES</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="n">VALUES_PER_ANGLE</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="n">TOTAL_COMBINATIONS</span> <span class="o">=</span> <span class="n">VALUES_PER_ANGLE</span><span class="o">**</span><span class="n">NUM_DIHEDRAL_ANGLES</span>  <span class="c1"># 243</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="n">BINARY_BASE</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="n">OCTANT_BASE</span> <span class="o">=</span> <span class="mi">8</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="n">DIHEDRAL_COLUMNS</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>    <span class="sa">f</span><span class="s2">&quot;chi</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">stat</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">NUM_DIHEDRAL_ANGLES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>    <span class="k">for</span> <span class="n">stat</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">]</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="p">]</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="c1"># Logger setup</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="n">_logger</span> <span class="o">=</span> <span class="n">create_logger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="n">_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="s2">&quot;WARNING&quot;</span><span class="p">)</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DisulfideClassGenerator</span><span class="p">:</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">    A class for generating disulfide conformations for structural classes based on</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">    mean and standard deviation values for dihedral angles.</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parse_class_string</span><span class="p">(</span><span class="n">class_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">        Parse a class string to determine its base and return the string without suffixes.</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">        :param class_str: The class string (e.g., &quot;11111&quot;, &quot;11111b&quot;, &quot;+-+-+&quot;).</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">        :type class_str: str</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">        :return: Tuple of (base, clean_string) where base is 2 (binary) or 8 (octant).</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">        :rtype: Tuple[int, str]</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">        :raises ValueError: If the class string format is invalid.</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">class_str</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class string must be a string, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">class_str</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>        <span class="n">base</span> <span class="o">=</span> <span class="n">OCTANT_BASE</span>  <span class="c1"># Default to octant</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>        <span class="n">clean_string</span> <span class="o">=</span> <span class="n">class_str</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_str</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>            <span class="k">if</span> <span class="n">class_str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>                <span class="n">base</span> <span class="o">=</span> <span class="n">BINARY_BASE</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>                <span class="n">clean_string</span> <span class="o">=</span> <span class="n">class_str</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>            <span class="k">elif</span> <span class="n">class_str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;o&quot;</span><span class="p">:</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>                <span class="n">base</span> <span class="o">=</span> <span class="n">OCTANT_BASE</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>                <span class="n">clean_string</span> <span class="o">=</span> <span class="n">class_str</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid suffix in class string: </span><span class="si">{</span><span class="n">class_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>        <span class="k">elif</span> <span class="s2">&quot;+&quot;</span> <span class="ow">in</span> <span class="n">class_str</span> <span class="ow">or</span> <span class="s2">&quot;-&quot;</span> <span class="ow">in</span> <span class="n">class_str</span><span class="p">:</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>            <span class="n">base</span> <span class="o">=</span> <span class="n">BINARY_BASE</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>            <span class="n">clean_string</span> <span class="o">=</span> <span class="n">class_str</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>        <span class="k">return</span> <span class="n">base</span><span class="p">,</span> <span class="n">clean_string</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>        <span class="n">csv_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>        <span class="n">precalc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>        <span class="n">csv_base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>    <span class="p">):</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">        Initialize the DisulfideClassGenerator.</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">        :param csv_file: Path to CSV file with class metrics (optional).</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">        :type csv_file: str</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">        :param verbose: Enable debug logging and progress bars.</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">        :type verbose: bool</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">        :param precalc: Pre-calculate disulfides for all classes.</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">        :type precalc: bool</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">        :param csv_base: Base for CSV data (2 or 8, optional).</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">        :type csv_base: int</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">        :raises ValueError: If no valid data source is provided.</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DisulfideList</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DisulfideList</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_data</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">csv_base</span><span class="p">)</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>        <span class="k">if</span> <span class="n">precalc</span><span class="p">:</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">generate_for_all_classes</span><span class="p">()</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csv_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="sd">        Load data from CSV or pickle files.</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">        :param csv_file: Path to CSV file (optional).</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a><span class="sd">        :type csv_file: str</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a><span class="sd">        :param base: Base class for CSV data (2 or 8, optional).</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a><span class="sd">        :type base: int</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a><span class="sd">        :raises ValueError: If no valid data source is provided.</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>        <span class="n">binary_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">)</span> <span class="o">/</span> <span class="n">BINARY_CLASS_METRICS_FILE</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>        <span class="n">octant_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">)</span> <span class="o">/</span> <span class="n">OCTANT_CLASS_METRICS_FILE</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>        <span class="k">if</span> <span class="n">csv_file</span><span class="p">:</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">load_csv</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>            <span class="k">if</span> <span class="n">binary_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">binary_path</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>                    <span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;class_str&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">}</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>                <span class="p">)</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loaded binary metrics from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">binary_path</span><span class="p">)</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>            <span class="k">if</span> <span class="n">octant_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">octant_path</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>                    <span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;class_str&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">}</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>                <span class="p">)</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>                <span class="c1"># Prefer octant metrics if available</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loaded octant metrics from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">octant_path</span><span class="p">)</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No valid data source provided.&quot;</span><span class="p">)</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_df</span><span class="p">()</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="sd">        Validate DataFrame has required columns.</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="sd">        :raises ValueError: If required columns are missing.</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>            <span class="n">missing</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>                <span class="n">col</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">DIHEDRAL_COLUMNS</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;class_str&quot;</span><span class="p">]</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>                <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>            <span class="p">]</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>            <span class="k">if</span> <span class="n">missing</span><span class="p">:</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DataFrame missing columns: </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;DataFrame validated with columns: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csv_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DisulfideClassGenerator&quot;</span><span class="p">:</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a><span class="sd">        Load class metrics from a CSV file.</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a><span class="sd">        :param csv_file: Path to CSV file.</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a><span class="sd">        :type csv_file: str</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a><span class="sd">        :param base: Base class (2 or 8, optional).</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a><span class="sd">        :type base: int</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a><span class="sd">        :return: Self for method chaining.</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a><span class="sd">        :rtype: DisulfideClassGenerator</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a><span class="sd">        :raises ValueError: If base is invalid.</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;class_str&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">})</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base</span> <span class="o">=</span> <span class="n">base</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span><span class="p">:</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>        <span class="k">elif</span> <span class="n">base</span> <span class="o">==</span> <span class="n">OCTANT_BASE</span><span class="p">:</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>        <span class="k">elif</span> <span class="n">base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid base: </span><span class="si">{</span><span class="n">base</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">class_to_sslist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clsid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">OCTANT_BASE</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a><span class="sd">        Retrieve disulfide list for a given class ID.</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a><span class="sd">        :param clsid: Class ID (e.g., &quot;11111&quot;, &quot;11111b&quot;).</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a><span class="sd">        :type clsid: str</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a><span class="sd">        :param base: Base class (2 or 8).</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a><span class="sd">        :type base: int</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a><span class="sd">        :return: DisulfideList for the class.</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a><span class="sd">        :rtype: DisulfideList</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a><span class="sd">        :raises ValueError: If clsid is invalid.</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a><span class="sd">        :raises KeyError: If class not found.</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">clsid</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Class ID must be a string, got </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">clsid</span><span class="p">))</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid class ID type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">clsid</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>        <span class="n">parsed_base</span><span class="p">,</span> <span class="n">clean_cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_class_string</span><span class="p">(</span><span class="n">clsid</span><span class="p">)</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>        <span class="n">base</span> <span class="o">=</span> <span class="n">parsed_base</span> <span class="k">if</span> <span class="n">parsed_base</span> <span class="k">else</span> <span class="n">base</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>        <span class="n">target_dict</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>            <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>        <span class="p">)</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>        <span class="k">if</span> <span class="n">clean_cls</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">target_dict</span><span class="p">:</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>                <span class="s2">&quot;Class </span><span class="si">%s</span><span class="s2"> not found in </span><span class="si">%s</span><span class="s2"> disulfides&quot;</span><span class="p">,</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>                <span class="n">clsid</span><span class="p">,</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>                <span class="s2">&quot;binary&quot;</span> <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span> <span class="k">else</span> <span class="s2">&quot;octant&quot;</span><span class="p">,</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>            <span class="p">)</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class </span><span class="si">{</span><span class="n">clsid</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>        <span class="k">return</span> <span class="n">target_dict</span><span class="p">[</span><span class="n">clean_cls</span><span class="p">]</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_disulfides_for_class</span><span class="p">(</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">class_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">chi_means</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">chi_stds</span><span class="p">:</span> <span class="nb">tuple</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a><span class="sd">        Generate disulfide conformations for a class (cached).</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a><span class="sd">        :param class_id: Class identifier.</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a><span class="sd">        :type class_id: str</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a><span class="sd">        :param chi_means: Tuple of mean dihedral angles.</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a><span class="sd">        :type chi_means: tuple</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="sd">        :param chi_stds: Tuple of standard deviations.</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a><span class="sd">        :type chi_stds: tuple</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="sd">        :return: DisulfideList with all combinations.</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="sd">        :rtype: DisulfideList</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>        <span class="n">chi_values</span> <span class="o">=</span> <span class="p">[[</span><span class="n">m</span> <span class="o">-</span> <span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">chi_means</span><span class="p">,</span> <span class="n">chi_stds</span><span class="p">)]</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>        <span class="n">combinations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">chi_values</span><span class="p">))</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>        <span class="n">disulfides</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>            <span class="n">Disulfide</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">class_id</span><span class="si">}</span><span class="s2">_comb</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">torsions</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">combo</span><span class="p">))</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">combo</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">combinations</span><span class="p">)</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>        <span class="p">]</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>        <span class="k">return</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="n">disulfides</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Class_</span><span class="si">{</span><span class="n">class_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_for_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">DisulfideList</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a><span class="sd">        Generate disulfides for a specific class.</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a><span class="sd">        :param class_id: Class ID (e.g., &quot;11111b&quot;).</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a><span class="sd">        :type class_id: str</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a><span class="sd">        :return: DisulfideList or None if class not found.</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a><span class="sd">        :rtype: Union[DisulfideList, None]</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a><span class="sd">        :raises ValueError: If no DataFrame is loaded.</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No DataFrame loaded.&quot;</span><span class="p">)</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>        <span class="n">base</span><span class="p">,</span> <span class="n">clean_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_class_string</span><span class="p">(</span><span class="n">class_id</span><span class="p">)</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>        <span class="n">df_to_use</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span> <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>        <span class="k">if</span> <span class="n">df_to_use</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> DataFrame not available.&quot;</span><span class="p">,</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>                <span class="s2">&quot;Binary&quot;</span> <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span> <span class="k">else</span> <span class="s2">&quot;Octant&quot;</span><span class="p">,</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>            <span class="p">)</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>        <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;class_str&quot;</span> <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span> <span class="k">else</span> <span class="s2">&quot;class&quot;</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>        <span class="n">row</span> <span class="o">=</span> <span class="n">df_to_use</span><span class="p">[</span><span class="n">df_to_use</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="n">clean_string</span><span class="p">]</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>        <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Class </span><span class="si">%s</span><span class="s2"> not found.&quot;</span><span class="p">,</span> <span class="n">class_id</span><span class="p">)</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>        <span class="n">row_data</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>        <span class="n">chi_means</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>            <span class="n">row_data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;chi</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_mean&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">NUM_DIHEDRAL_ANGLES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>        <span class="p">)</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>        <span class="n">chi_stds</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>            <span class="n">row_data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;chi</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_std&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">NUM_DIHEDRAL_ANGLES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>        <span class="p">)</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>        <span class="n">disulfide_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_disulfides_for_class</span><span class="p">(</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>            <span class="n">clean_string</span><span class="p">,</span> <span class="n">chi_means</span><span class="p">,</span> <span class="n">chi_stds</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>        <span class="p">)</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>        <span class="n">target_dict</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>            <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>        <span class="p">)</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>        <span class="n">target_dict</span><span class="p">[</span><span class="n">clean_string</span><span class="p">]</span> <span class="o">=</span> <span class="n">disulfide_list</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>            <span class="s2">&quot;Generated </span><span class="si">%d</span><span class="s2"> disulfides for class </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">disulfide_list</span><span class="p">),</span> <span class="n">class_id</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>        <span class="p">)</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>        <span class="k">return</span> <span class="n">disulfide_list</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_for_selected_classes</span><span class="p">(</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">class_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DisulfideList</span><span class="p">]:</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a><span class="sd">        Generate disulfides for multiple classes in parallel.</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a><span class="sd">        :param class_ids: List of class IDs.</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a><span class="sd">        :type class_ids: List[str]</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a><span class="sd">        :return: Dictionary mapping class IDs to DisulfideLists.</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a><span class="sd">        :rtype: Dict[str, DisulfideList]</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a><span class="sd">        :raises ValueError: If no DataFrame is loaded.</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No DataFrame loaded.&quot;</span><span class="p">)</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>        <span class="n">class_disulfides</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>        <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">()</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>            <span class="n">futures</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>                <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generate_for_class</span><span class="p">,</span> <span class="n">cid</span><span class="p">):</span> <span class="n">cid</span> <span class="k">for</span> <span class="n">cid</span> <span class="ow">in</span> <span class="n">class_ids</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>            <span class="p">}</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>            <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>                <span class="n">futures</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Generating classes&quot;</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>            <span class="p">):</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>                <span class="n">class_id</span> <span class="o">=</span> <span class="n">futures</span><span class="p">[</span><span class="n">future</span><span class="p">]</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">_result</span> <span class="o">:=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>                    <span class="n">class_disulfides</span><span class="p">[</span><span class="n">class_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">_result</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generated disulfides for </span><span class="si">%d</span><span class="s2"> classes&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_disulfides</span><span class="p">))</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>        <span class="k">return</span> <span class="n">class_disulfides</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_for_all_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DisulfideList</span><span class="p">]:</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a><span class="sd">        Generate disulfides for all classes in loaded DataFrames.</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a><span class="sd">        :return: Dictionary mapping class IDs to DisulfideLists.</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a><span class="sd">        :rtype: Dict[str, DisulfideList]</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a><span class="sd">        :raises ValueError: If no DataFrames are loaded.</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No DataFrames loaded.&quot;</span><span class="p">)</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>        <span class="n">class_disulfides</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">base</span> <span class="o">=</span> <span class="n">BINARY_BASE</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span><span class="p">,</span> <span class="s2">&quot;binary&quot;</span><span class="p">):</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>                <span class="n">class_id</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;class_str&quot;</span><span class="p">]</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>                <span class="n">disulfide_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_from_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">class_id</span><span class="p">)</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>                <span class="n">class_disulfides</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">class_id</span><span class="si">}</span><span class="s2">b&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">disulfide_list</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span><span class="p">[</span><span class="n">class_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">disulfide_list</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">base</span> <span class="o">=</span> <span class="n">OCTANT_BASE</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span><span class="p">,</span> <span class="s2">&quot;octant&quot;</span><span class="p">):</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>                <span class="n">class_id</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">]</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>                <span class="n">disulfide_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_from_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">class_id</span><span class="p">)</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>                <span class="n">class_disulfides</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">class_id</span><span class="si">}</span><span class="s2">o&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">disulfide_list</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span><span class="p">[</span><span class="n">class_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">disulfide_list</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generated disulfides for </span><span class="si">%d</span><span class="s2"> classes&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_disulfides</span><span class="p">))</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>        <span class="k">return</span> <span class="n">class_disulfides</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_iterate_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a><span class="sd">        Helper to iterate DataFrame with optional progress bar.</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a><span class="sd">        :param df: DataFrame to iterate.</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a><span class="sd">        :type df: pd.DataFrame</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="sd">        :param desc: Description for progress bar.</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a><span class="sd">        :type desc: str</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a><span class="sd">        :return: Iterator over DataFrame rows.</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>            <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>                <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">(),</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Generating </span><span class="si">{</span><span class="n">desc</span><span class="si">}</span><span class="s2"> disulfides&quot;</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>            <span class="p">)</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>            <span class="k">else</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>        <span class="p">)</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_from_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">class_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a><span class="sd">        Generate disulfides from a DataFrame row.</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a><span class="sd">        :param row: DataFrame row with class metrics.</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a><span class="sd">        :type row: pd.Series</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a><span class="sd">        :param class_id: Class identifier.</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a><span class="sd">        :type class_id: str</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a><span class="sd">        :return: DisulfideList for the row.</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a><span class="sd">        :rtype: DisulfideList</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>        <span class="n">chi_means</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>            <span class="n">row</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;chi</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_mean&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">NUM_DIHEDRAL_ANGLES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>        <span class="p">)</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>        <span class="n">chi_stds</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;chi</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_std&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">NUM_DIHEDRAL_ANGLES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_disulfides_for_class</span><span class="p">(</span><span class="n">class_id</span><span class="p">,</span> <span class="n">chi_means</span><span class="p">,</span> <span class="n">chi_stds</span><span class="p">)</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">detailed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a><span class="sd">        Print the internal state of the generator.</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a><span class="sd">        :param detailed: Show detailed DataFrame and disulfide info.</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a><span class="sd">        :type detailed: bool</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;DisulfideClassGenerator State&#39;</span><span class="si">:</span><span class="s2">^80</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Base: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;Not set&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Verbose: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">DataFrames:&quot;</span><span class="p">)</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>            <span class="p">(</span><span class="s2">&quot;Binary&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span><span class="p">,</span> <span class="s2">&quot;binary_df&quot;</span><span class="p">),</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>            <span class="p">(</span><span class="s2">&quot;Octant&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span><span class="p">,</span> <span class="s2">&quot;octant_df&quot;</span><span class="p">),</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>        <span class="p">]:</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>            <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: Loaded (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2"> classes)&quot;</span><span class="p">)</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>                <span class="k">if</span> <span class="n">detailed</span><span class="p">:</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Sample:</span><span class="se">\n</span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: Not loaded&quot;</span><span class="p">)</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Disulfides:&quot;</span><span class="p">)</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>            <span class="p">(</span><span class="s2">&quot;Binary&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span><span class="p">),</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>            <span class="p">(</span><span class="s2">&quot;Octant&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span><span class="p">),</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>        <span class="p">]:</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>            <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> classes&quot;</span><span class="p">)</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>            <span class="k">if</span> <span class="n">detailed</span> <span class="ow">and</span> <span class="n">count</span><span class="p">:</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Sample: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">())[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_energy_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a><span class="sd">        Prepare energy data for visualization.</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a><span class="sd">        :return: DataFrame with class and energy data.</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a><span class="sd">        :rtype: pd.DataFrame</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>        <span class="n">energy_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>        <span class="k">for</span> <span class="n">base</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>            <span class="p">(</span><span class="n">BINARY_BASE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span><span class="p">),</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>            <span class="p">(</span><span class="n">OCTANT_BASE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span><span class="p">),</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>        <span class="p">]:</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>            <span class="k">for</span> <span class="n">class_id</span><span class="p">,</span> <span class="n">disulfide_list</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>                <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">disulfide_list</span><span class="p">:</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>                    <span class="n">energy_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>                        <span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="n">class_id</span><span class="p">,</span> <span class="s2">&quot;energy&quot;</span><span class="p">:</span> <span class="n">ss</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span> <span class="s2">&quot;base&quot;</span><span class="p">:</span> <span class="n">base</span><span class="p">}</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>                    <span class="p">)</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">energy_data</span><span class="p">)</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>        <span class="p">(</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepared energy data with </span><span class="si">%d</span><span class="s2"> entries&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>            <span class="k">else</span> <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No energy data.&quot;</span><span class="p">)</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>        <span class="p">)</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_energy_by_class</span><span class="p">(</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Energy Distribution by Class&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a><span class="sd">        Plot energy distribution by class.</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a><span class="sd">        :param base: Filter by base (2 or 8, optional).</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a><span class="sd">        :type base: int</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a><span class="sd">        :param title: Plot title.</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a><span class="sd">        :type title: str</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a><span class="sd">        :param kwargs: Additional plotting options.</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>        <span class="n">energy_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_energy_data</span><span class="p">()</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>        <span class="k">if</span> <span class="n">energy_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No energy data available.&quot;</span><span class="p">)</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>            <span class="k">return</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="ow">in</span> <span class="p">(</span><span class="n">BINARY_BASE</span><span class="p">,</span> <span class="n">OCTANT_BASE</span><span class="p">):</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>            <span class="n">energy_df</span> <span class="o">=</span> <span class="n">energy_df</span><span class="p">[</span><span class="n">energy_df</span><span class="p">[</span><span class="s2">&quot;base&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">base</span><span class="p">]</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>            <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Binary&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">BINARY_BASE</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Octant&#39;</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>        <span class="k">elif</span> <span class="n">base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Base must be 2 or 8.&quot;</span><span class="p">)</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>        <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_energy_by_class</span><span class="p">(</span><span class="n">energy_df</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_torsion_distance_by_class</span><span class="p">(</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>        <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Torsion Distance by Class&quot;</span><span class="p">,</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>        <span class="n">theme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>        <span class="n">save</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>        <span class="n">savedir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>        <span class="n">split</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>        <span class="n">max_classes_per_plot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">330</span><span class="p">,</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>        <span class="n">dpi</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>        <span class="n">suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;png&quot;</span><span class="p">,</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a><span class="sd">        Create a bar chart showing torsion distance by class_id.</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a><span class="sd">        :param base: The base class to use (2 for binary, 8 for octant). If None,</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a><span class="sd">        use all available data.</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a><span class="sd">        :type base: int, optional</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a><span class="sd">        :param title: Title for the plot</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a><span class="sd">        :type title: str</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a><span class="sd">        :param theme: Theme to use for the plot (&#39;auto&#39;, &#39;light&#39;, or &#39;dark&#39;)</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a><span class="sd">        :type theme: str</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a><span class="sd">        :param save: Whether to save the plot</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a><span class="sd">        :type save: bool</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a><span class="sd">        :param savedir: Directory to save the plot to</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a><span class="sd">        :type savedir: str</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a><span class="sd">        :param verbose: Whether to display verbose output</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a><span class="sd">        :type verbose: bool</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a><span class="sd">        :param split: Whether to split the plot into multiple plots if there are many classes</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a><span class="sd">        :type split: bool</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a><span class="sd">        :param max_classes_per_plot: Maximum number of classes to include in each plot</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a><span class="sd">        when splitting</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a><span class="sd">        :type max_classes_per_plot: int</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a><span class="sd">        :param dpi: DPI (dots per inch) for the saved image, controls the resolution (default: 600)</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a><span class="sd">        :type dpi: int</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a><span class="sd">        :param suffix: File format for saved images (default: &quot;png&quot;)</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a><span class="sd">        :type suffix: str</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>        <span class="c1"># Determine which DataFrame to use based on base parameter</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>            <span class="k">if</span> <span class="n">base</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">]:</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Base must be 2 (binary) or 8 (octant)&quot;</span><span class="p">)</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>            <span class="n">df_to_use</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span> <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>            <span class="n">base_str</span> <span class="o">=</span> <span class="s2">&quot;Binary&quot;</span> <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="s2">&quot;Octant&quot;</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>            <span class="n">plot_title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_str</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>            <span class="c1"># Default to octant if available, otherwise binary</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>            <span class="n">df_to_use</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>            <span class="n">plot_title</span> <span class="o">=</span> <span class="n">title</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>        <span class="k">if</span> <span class="n">df_to_use</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">df_to_use</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No data available for the specified base.&quot;</span><span class="p">)</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>            <span class="k">return</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>        <span class="c1"># Check if avg_torsion_distance column exists</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>        <span class="k">if</span> <span class="s2">&quot;avg_torsion_distance&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_to_use</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;avg_torsion_distance column not found in the DataFrame.&quot;</span><span class="p">)</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>            <span class="k">return</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>        <span class="c1"># Create a copy of the DataFrame to avoid modifying the original</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>        <span class="n">plot_df</span> <span class="o">=</span> <span class="n">df_to_use</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>        <span class="c1"># If not splitting or few classes, create a single plot</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">split</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">max_classes_per_plot</span><span class="p">:</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a>            <span class="c1"># Create line plot using plotly_express</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>            <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_torsion_distance_by_class</span><span class="p">(</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>                <span class="n">plot_df</span><span class="p">,</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>                <span class="n">title</span><span class="o">=</span><span class="n">plot_title</span><span class="p">,</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>                <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>                <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a>                <span class="n">savedir</span><span class="o">=</span><span class="n">savedir</span><span class="p">,</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>                <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>                <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>                <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>            <span class="p">)</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a>            <span class="c1"># Split into multiple plots</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>            <span class="n">num_plots</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>                <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="p">)</span> <span class="o">+</span> <span class="n">max_classes_per_plot</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>            <span class="p">)</span> <span class="o">//</span> <span class="n">max_classes_per_plot</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a>                    <span class="s2">&quot;Splitting into </span><span class="si">%d</span><span class="s2"> plots with up to </span><span class="si">%d</span><span class="s2"> classes each&quot;</span><span class="p">,</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a>                    <span class="n">num_plots</span><span class="p">,</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a>                    <span class="n">max_classes_per_plot</span><span class="p">,</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a>                <span class="p">)</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_plots</span><span class="p">):</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>                <span class="n">start_idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">max_classes_per_plot</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>                <span class="n">end_idx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">max_classes_per_plot</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="p">))</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a>                <span class="n">subset_df</span> <span class="o">=</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>                <span class="c1"># Create plot title for this subset</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>                <span class="n">subset_title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">plot_title</span><span class="si">}</span><span class="s2"> (Part </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="n">num_plots</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a>                <span class="n">fname_prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">plot_title</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_part_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>                <span class="c1"># Create line plot for this subset</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>                <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_torsion_distance_by_class</span><span class="p">(</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>                    <span class="n">subset_df</span><span class="p">,</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>                    <span class="n">title</span><span class="o">=</span><span class="n">subset_title</span><span class="p">,</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a>                    <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a>                    <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a>                    <span class="n">savedir</span><span class="o">=</span><span class="n">savedir</span><span class="p">,</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a>                    <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a>                    <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a>                    <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a>                    <span class="n">fname_prefix</span><span class="o">=</span><span class="n">fname_prefix</span><span class="p">,</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a>                <span class="p">)</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display</span><span class="p">(</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a>        <span class="n">class_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a>        <span class="n">screenshot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a>        <span class="n">movie</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a>        <span class="n">fname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ss_overlay.png&quot;</span><span class="p">,</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a><span class="sd">        Display disulfide overlay for a class.</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a><span class="sd">        :param class_id: Class ID to display.</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a><span class="sd">        :type class_id: str</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a><span class="sd">        :param screenshot: Save a screenshot.</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a><span class="sd">        :type screenshot: bool</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a><span class="sd">        :param movie: Save a movie.</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a><span class="sd">        :type movie: bool</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a><span class="sd">        :param fname: Output filename.</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a><span class="sd">        :type fname: str</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a><span class="sd">        :param kwargs: Additional display options.</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a><span class="sd">        :raises ValueError: If class not found or generation fails.</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a>        <span class="n">base</span><span class="p">,</span> <span class="n">clean_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_class_string</span><span class="p">(</span><span class="n">class_id</span><span class="p">)</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a>        <span class="n">target_dict</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a>            <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a>            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a>        <span class="p">)</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a>
</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a>        <span class="k">if</span> <span class="n">clean_string</span> <span class="ow">in</span> <span class="n">target_dict</span><span class="p">:</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a>            <span class="n">disulfide_list</span> <span class="o">=</span> <span class="n">target_dict</span><span class="p">[</span><span class="n">clean_string</span><span class="p">]</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a>            <span class="n">disulfide_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_for_class</span><span class="p">(</span><span class="n">class_id</span><span class="p">)</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a>            <span class="k">if</span> <span class="n">disulfide_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class </span><span class="si">{</span><span class="n">class_id</span><span class="si">}</span><span class="s2"> not found or failed to generate.&quot;</span><span class="p">)</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a>
</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a>        <span class="n">disulfide_list</span><span class="o">.</span><span class="n">display_overlay</span><span class="p">(</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a>            <span class="n">screenshot</span><span class="o">=</span><span class="n">screenshot</span><span class="p">,</span> <span class="n">movie</span><span class="o">=</span><span class="n">movie</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">fname</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a>        <span class="p">)</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a>
</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a>
</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a>
</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a>    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Generate disulfide conformations.&quot;</span><span class="p">)</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;csv_file&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path to CSV file.&quot;</span><span class="p">)</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--class_ids&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Class IDs to process.&quot;</span><span class="p">)</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--all&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Process all classes.&quot;</span><span class="p">)</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--output&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Output pickle file.&quot;</span><span class="p">)</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--verbose&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Show progress.&quot;</span><span class="p">)</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a>    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a>
</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a>    <span class="n">generator</span> <span class="o">=</span> <span class="n">DisulfideClassGenerator</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a>    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a>        <span class="n">generator</span><span class="o">.</span><span class="n">generate_for_all_classes</span><span class="p">()</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a>        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">all</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a>        <span class="k">else</span> <span class="n">generator</span><span class="o">.</span><span class="n">generate_for_selected_classes</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">class_ids</span> <span class="ow">or</span> <span class="p">[])</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a>    <span class="p">)</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a>
</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Specify --class_ids or --all.&quot;</span><span class="p">)</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a>        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a>
</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated disulfides for </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="si">}</span><span class="s2"> classes.&quot;</span><span class="p">)</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos">661</span></a>    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">:</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos">662</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos">663</span></a>            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos">664</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saved to </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">output</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos">665</span></a>
</span><span id="L-666"><a href="#L-666"><span class="linenos">666</span></a>    <span class="c1"># EOF</span>
</span></pre></div>


            </section>
                <section id="NUM_DIHEDRAL_ANGLES">
                    <div class="attr variable">
            <span class="name">NUM_DIHEDRAL_ANGLES</span>        =
<span class="default_value">5</span>

        
    </div>
    <a class="headerlink" href="#NUM_DIHEDRAL_ANGLES"></a>
    
    

                </section>
                <section id="VALUES_PER_ANGLE">
                    <div class="attr variable">
            <span class="name">VALUES_PER_ANGLE</span>        =
<span class="default_value">3</span>

        
    </div>
    <a class="headerlink" href="#VALUES_PER_ANGLE"></a>
    
    

                </section>
                <section id="TOTAL_COMBINATIONS">
                    <div class="attr variable">
            <span class="name">TOTAL_COMBINATIONS</span>        =
<span class="default_value">243</span>

        
    </div>
    <a class="headerlink" href="#TOTAL_COMBINATIONS"></a>
    
    

                </section>
                <section id="BINARY_BASE">
                    <div class="attr variable">
            <span class="name">BINARY_BASE</span>        =
<span class="default_value">2</span>

        
    </div>
    <a class="headerlink" href="#BINARY_BASE"></a>
    
    

                </section>
                <section id="OCTANT_BASE">
                    <div class="attr variable">
            <span class="name">OCTANT_BASE</span>        =
<span class="default_value">8</span>

        
    </div>
    <a class="headerlink" href="#OCTANT_BASE"></a>
    
    

                </section>
                <section id="DIHEDRAL_COLUMNS">
                    <div class="attr variable">
            <span class="name">DIHEDRAL_COLUMNS</span>        =
<input id="DIHEDRAL_COLUMNS-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="DIHEDRAL_COLUMNS-view-value"></label><span class="default_value">[&#39;chi1_mean&#39;, &#39;chi1_std&#39;, &#39;chi2_mean&#39;, &#39;chi2_std&#39;, &#39;chi3_mean&#39;, &#39;chi3_std&#39;, &#39;chi4_mean&#39;, &#39;chi4_std&#39;, &#39;chi5_mean&#39;, &#39;chi5_std&#39;]</span>

        
    </div>
    <a class="headerlink" href="#DIHEDRAL_COLUMNS"></a>
    
    

                </section>
                <section id="DisulfideClassGenerator">
                            <input id="DisulfideClassGenerator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DisulfideClassGenerator</span>:

                <label class="view-source-button" for="DisulfideClassGenerator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassGenerator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassGenerator-51"><a href="#DisulfideClassGenerator-51"><span class="linenos"> 51</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DisulfideClassGenerator</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-52"><a href="#DisulfideClassGenerator-52"><span class="linenos"> 52</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-53"><a href="#DisulfideClassGenerator-53"><span class="linenos"> 53</span></a><span class="sd">    A class for generating disulfide conformations for structural classes based on</span>
</span><span id="DisulfideClassGenerator-54"><a href="#DisulfideClassGenerator-54"><span class="linenos"> 54</span></a><span class="sd">    mean and standard deviation values for dihedral angles.</span>
</span><span id="DisulfideClassGenerator-55"><a href="#DisulfideClassGenerator-55"><span class="linenos"> 55</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-56"><a href="#DisulfideClassGenerator-56"><span class="linenos"> 56</span></a>
</span><span id="DisulfideClassGenerator-57"><a href="#DisulfideClassGenerator-57"><span class="linenos"> 57</span></a>    <span class="nd">@staticmethod</span>
</span><span id="DisulfideClassGenerator-58"><a href="#DisulfideClassGenerator-58"><span class="linenos"> 58</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parse_class_string</span><span class="p">(</span><span class="n">class_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="DisulfideClassGenerator-59"><a href="#DisulfideClassGenerator-59"><span class="linenos"> 59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-60"><a href="#DisulfideClassGenerator-60"><span class="linenos"> 60</span></a><span class="sd">        Parse a class string to determine its base and return the string without suffixes.</span>
</span><span id="DisulfideClassGenerator-61"><a href="#DisulfideClassGenerator-61"><span class="linenos"> 61</span></a>
</span><span id="DisulfideClassGenerator-62"><a href="#DisulfideClassGenerator-62"><span class="linenos"> 62</span></a><span class="sd">        :param class_str: The class string (e.g., &quot;11111&quot;, &quot;11111b&quot;, &quot;+-+-+&quot;).</span>
</span><span id="DisulfideClassGenerator-63"><a href="#DisulfideClassGenerator-63"><span class="linenos"> 63</span></a><span class="sd">        :type class_str: str</span>
</span><span id="DisulfideClassGenerator-64"><a href="#DisulfideClassGenerator-64"><span class="linenos"> 64</span></a><span class="sd">        :return: Tuple of (base, clean_string) where base is 2 (binary) or 8 (octant).</span>
</span><span id="DisulfideClassGenerator-65"><a href="#DisulfideClassGenerator-65"><span class="linenos"> 65</span></a><span class="sd">        :rtype: Tuple[int, str]</span>
</span><span id="DisulfideClassGenerator-66"><a href="#DisulfideClassGenerator-66"><span class="linenos"> 66</span></a><span class="sd">        :raises ValueError: If the class string format is invalid.</span>
</span><span id="DisulfideClassGenerator-67"><a href="#DisulfideClassGenerator-67"><span class="linenos"> 67</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-68"><a href="#DisulfideClassGenerator-68"><span class="linenos"> 68</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">class_str</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="DisulfideClassGenerator-69"><a href="#DisulfideClassGenerator-69"><span class="linenos"> 69</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class string must be a string, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">class_str</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-70"><a href="#DisulfideClassGenerator-70"><span class="linenos"> 70</span></a>
</span><span id="DisulfideClassGenerator-71"><a href="#DisulfideClassGenerator-71"><span class="linenos"> 71</span></a>        <span class="n">base</span> <span class="o">=</span> <span class="n">OCTANT_BASE</span>  <span class="c1"># Default to octant</span>
</span><span id="DisulfideClassGenerator-72"><a href="#DisulfideClassGenerator-72"><span class="linenos"> 72</span></a>        <span class="n">clean_string</span> <span class="o">=</span> <span class="n">class_str</span>
</span><span id="DisulfideClassGenerator-73"><a href="#DisulfideClassGenerator-73"><span class="linenos"> 73</span></a>
</span><span id="DisulfideClassGenerator-74"><a href="#DisulfideClassGenerator-74"><span class="linenos"> 74</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_str</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-75"><a href="#DisulfideClassGenerator-75"><span class="linenos"> 75</span></a>            <span class="k">if</span> <span class="n">class_str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-76"><a href="#DisulfideClassGenerator-76"><span class="linenos"> 76</span></a>                <span class="n">base</span> <span class="o">=</span> <span class="n">BINARY_BASE</span>
</span><span id="DisulfideClassGenerator-77"><a href="#DisulfideClassGenerator-77"><span class="linenos"> 77</span></a>                <span class="n">clean_string</span> <span class="o">=</span> <span class="n">class_str</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator-78"><a href="#DisulfideClassGenerator-78"><span class="linenos"> 78</span></a>            <span class="k">elif</span> <span class="n">class_str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;o&quot;</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-79"><a href="#DisulfideClassGenerator-79"><span class="linenos"> 79</span></a>                <span class="n">base</span> <span class="o">=</span> <span class="n">OCTANT_BASE</span>
</span><span id="DisulfideClassGenerator-80"><a href="#DisulfideClassGenerator-80"><span class="linenos"> 80</span></a>                <span class="n">clean_string</span> <span class="o">=</span> <span class="n">class_str</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator-81"><a href="#DisulfideClassGenerator-81"><span class="linenos"> 81</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-82"><a href="#DisulfideClassGenerator-82"><span class="linenos"> 82</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid suffix in class string: </span><span class="si">{</span><span class="n">class_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-83"><a href="#DisulfideClassGenerator-83"><span class="linenos"> 83</span></a>        <span class="k">elif</span> <span class="s2">&quot;+&quot;</span> <span class="ow">in</span> <span class="n">class_str</span> <span class="ow">or</span> <span class="s2">&quot;-&quot;</span> <span class="ow">in</span> <span class="n">class_str</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-84"><a href="#DisulfideClassGenerator-84"><span class="linenos"> 84</span></a>            <span class="n">base</span> <span class="o">=</span> <span class="n">BINARY_BASE</span>
</span><span id="DisulfideClassGenerator-85"><a href="#DisulfideClassGenerator-85"><span class="linenos"> 85</span></a>            <span class="n">clean_string</span> <span class="o">=</span> <span class="n">class_str</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator-86"><a href="#DisulfideClassGenerator-86"><span class="linenos"> 86</span></a>
</span><span id="DisulfideClassGenerator-87"><a href="#DisulfideClassGenerator-87"><span class="linenos"> 87</span></a>        <span class="k">return</span> <span class="n">base</span><span class="p">,</span> <span class="n">clean_string</span>
</span><span id="DisulfideClassGenerator-88"><a href="#DisulfideClassGenerator-88"><span class="linenos"> 88</span></a>
</span><span id="DisulfideClassGenerator-89"><a href="#DisulfideClassGenerator-89"><span class="linenos"> 89</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-90"><a href="#DisulfideClassGenerator-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-91"><a href="#DisulfideClassGenerator-91"><span class="linenos"> 91</span></a>        <span class="n">csv_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-92"><a href="#DisulfideClassGenerator-92"><span class="linenos"> 92</span></a>        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-93"><a href="#DisulfideClassGenerator-93"><span class="linenos"> 93</span></a>        <span class="n">precalc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-94"><a href="#DisulfideClassGenerator-94"><span class="linenos"> 94</span></a>        <span class="n">csv_base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-95"><a href="#DisulfideClassGenerator-95"><span class="linenos"> 95</span></a>    <span class="p">):</span>
</span><span id="DisulfideClassGenerator-96"><a href="#DisulfideClassGenerator-96"><span class="linenos"> 96</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-97"><a href="#DisulfideClassGenerator-97"><span class="linenos"> 97</span></a><span class="sd">        Initialize the DisulfideClassGenerator.</span>
</span><span id="DisulfideClassGenerator-98"><a href="#DisulfideClassGenerator-98"><span class="linenos"> 98</span></a>
</span><span id="DisulfideClassGenerator-99"><a href="#DisulfideClassGenerator-99"><span class="linenos"> 99</span></a><span class="sd">        :param csv_file: Path to CSV file with class metrics (optional).</span>
</span><span id="DisulfideClassGenerator-100"><a href="#DisulfideClassGenerator-100"><span class="linenos">100</span></a><span class="sd">        :type csv_file: str</span>
</span><span id="DisulfideClassGenerator-101"><a href="#DisulfideClassGenerator-101"><span class="linenos">101</span></a><span class="sd">        :param verbose: Enable debug logging and progress bars.</span>
</span><span id="DisulfideClassGenerator-102"><a href="#DisulfideClassGenerator-102"><span class="linenos">102</span></a><span class="sd">        :type verbose: bool</span>
</span><span id="DisulfideClassGenerator-103"><a href="#DisulfideClassGenerator-103"><span class="linenos">103</span></a><span class="sd">        :param precalc: Pre-calculate disulfides for all classes.</span>
</span><span id="DisulfideClassGenerator-104"><a href="#DisulfideClassGenerator-104"><span class="linenos">104</span></a><span class="sd">        :type precalc: bool</span>
</span><span id="DisulfideClassGenerator-105"><a href="#DisulfideClassGenerator-105"><span class="linenos">105</span></a><span class="sd">        :param csv_base: Base for CSV data (2 or 8, optional).</span>
</span><span id="DisulfideClassGenerator-106"><a href="#DisulfideClassGenerator-106"><span class="linenos">106</span></a><span class="sd">        :type csv_base: int</span>
</span><span id="DisulfideClassGenerator-107"><a href="#DisulfideClassGenerator-107"><span class="linenos">107</span></a><span class="sd">        :raises ValueError: If no valid data source is provided.</span>
</span><span id="DisulfideClassGenerator-108"><a href="#DisulfideClassGenerator-108"><span class="linenos">108</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-109"><a href="#DisulfideClassGenerator-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="DisulfideClassGenerator-110"><a href="#DisulfideClassGenerator-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DisulfideList</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideClassGenerator-111"><a href="#DisulfideClassGenerator-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DisulfideList</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideClassGenerator-112"><a href="#DisulfideClassGenerator-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClassGenerator-113"><a href="#DisulfideClassGenerator-113"><span class="linenos">113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClassGenerator-114"><a href="#DisulfideClassGenerator-114"><span class="linenos">114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClassGenerator-115"><a href="#DisulfideClassGenerator-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClassGenerator-116"><a href="#DisulfideClassGenerator-116"><span class="linenos">116</span></a>
</span><span id="DisulfideClassGenerator-117"><a href="#DisulfideClassGenerator-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_data</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">csv_base</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-118"><a href="#DisulfideClassGenerator-118"><span class="linenos">118</span></a>        <span class="k">if</span> <span class="n">precalc</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-119"><a href="#DisulfideClassGenerator-119"><span class="linenos">119</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">generate_for_all_classes</span><span class="p">()</span>
</span><span id="DisulfideClassGenerator-120"><a href="#DisulfideClassGenerator-120"><span class="linenos">120</span></a>
</span><span id="DisulfideClassGenerator-121"><a href="#DisulfideClassGenerator-121"><span class="linenos">121</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csv_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-122"><a href="#DisulfideClassGenerator-122"><span class="linenos">122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-123"><a href="#DisulfideClassGenerator-123"><span class="linenos">123</span></a><span class="sd">        Load data from CSV or pickle files.</span>
</span><span id="DisulfideClassGenerator-124"><a href="#DisulfideClassGenerator-124"><span class="linenos">124</span></a>
</span><span id="DisulfideClassGenerator-125"><a href="#DisulfideClassGenerator-125"><span class="linenos">125</span></a><span class="sd">        :param csv_file: Path to CSV file (optional).</span>
</span><span id="DisulfideClassGenerator-126"><a href="#DisulfideClassGenerator-126"><span class="linenos">126</span></a><span class="sd">        :type csv_file: str</span>
</span><span id="DisulfideClassGenerator-127"><a href="#DisulfideClassGenerator-127"><span class="linenos">127</span></a><span class="sd">        :param base: Base class for CSV data (2 or 8, optional).</span>
</span><span id="DisulfideClassGenerator-128"><a href="#DisulfideClassGenerator-128"><span class="linenos">128</span></a><span class="sd">        :type base: int</span>
</span><span id="DisulfideClassGenerator-129"><a href="#DisulfideClassGenerator-129"><span class="linenos">129</span></a><span class="sd">        :raises ValueError: If no valid data source is provided.</span>
</span><span id="DisulfideClassGenerator-130"><a href="#DisulfideClassGenerator-130"><span class="linenos">130</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-131"><a href="#DisulfideClassGenerator-131"><span class="linenos">131</span></a>        <span class="n">binary_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">)</span> <span class="o">/</span> <span class="n">BINARY_CLASS_METRICS_FILE</span>
</span><span id="DisulfideClassGenerator-132"><a href="#DisulfideClassGenerator-132"><span class="linenos">132</span></a>        <span class="n">octant_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">)</span> <span class="o">/</span> <span class="n">OCTANT_CLASS_METRICS_FILE</span>
</span><span id="DisulfideClassGenerator-133"><a href="#DisulfideClassGenerator-133"><span class="linenos">133</span></a>
</span><span id="DisulfideClassGenerator-134"><a href="#DisulfideClassGenerator-134"><span class="linenos">134</span></a>        <span class="k">if</span> <span class="n">csv_file</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-135"><a href="#DisulfideClassGenerator-135"><span class="linenos">135</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">load_csv</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-136"><a href="#DisulfideClassGenerator-136"><span class="linenos">136</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-137"><a href="#DisulfideClassGenerator-137"><span class="linenos">137</span></a>            <span class="k">if</span> <span class="n">binary_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="DisulfideClassGenerator-138"><a href="#DisulfideClassGenerator-138"><span class="linenos">138</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">binary_path</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-139"><a href="#DisulfideClassGenerator-139"><span class="linenos">139</span></a>                    <span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;class_str&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">}</span>
</span><span id="DisulfideClassGenerator-140"><a href="#DisulfideClassGenerator-140"><span class="linenos">140</span></a>                <span class="p">)</span>
</span><span id="DisulfideClassGenerator-141"><a href="#DisulfideClassGenerator-141"><span class="linenos">141</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span>
</span><span id="DisulfideClassGenerator-142"><a href="#DisulfideClassGenerator-142"><span class="linenos">142</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loaded binary metrics from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">binary_path</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-143"><a href="#DisulfideClassGenerator-143"><span class="linenos">143</span></a>            <span class="k">if</span> <span class="n">octant_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="DisulfideClassGenerator-144"><a href="#DisulfideClassGenerator-144"><span class="linenos">144</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">octant_path</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-145"><a href="#DisulfideClassGenerator-145"><span class="linenos">145</span></a>                    <span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;class_str&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">}</span>
</span><span id="DisulfideClassGenerator-146"><a href="#DisulfideClassGenerator-146"><span class="linenos">146</span></a>                <span class="p">)</span>
</span><span id="DisulfideClassGenerator-147"><a href="#DisulfideClassGenerator-147"><span class="linenos">147</span></a>                <span class="c1"># Prefer octant metrics if available</span>
</span><span id="DisulfideClassGenerator-148"><a href="#DisulfideClassGenerator-148"><span class="linenos">148</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-149"><a href="#DisulfideClassGenerator-149"><span class="linenos">149</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span>
</span><span id="DisulfideClassGenerator-150"><a href="#DisulfideClassGenerator-150"><span class="linenos">150</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loaded octant metrics from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">octant_path</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-151"><a href="#DisulfideClassGenerator-151"><span class="linenos">151</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-152"><a href="#DisulfideClassGenerator-152"><span class="linenos">152</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No valid data source provided.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-153"><a href="#DisulfideClassGenerator-153"><span class="linenos">153</span></a>
</span><span id="DisulfideClassGenerator-154"><a href="#DisulfideClassGenerator-154"><span class="linenos">154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_df</span><span class="p">()</span>
</span><span id="DisulfideClassGenerator-155"><a href="#DisulfideClassGenerator-155"><span class="linenos">155</span></a>
</span><span id="DisulfideClassGenerator-156"><a href="#DisulfideClassGenerator-156"><span class="linenos">156</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-157"><a href="#DisulfideClassGenerator-157"><span class="linenos">157</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-158"><a href="#DisulfideClassGenerator-158"><span class="linenos">158</span></a><span class="sd">        Validate DataFrame has required columns.</span>
</span><span id="DisulfideClassGenerator-159"><a href="#DisulfideClassGenerator-159"><span class="linenos">159</span></a>
</span><span id="DisulfideClassGenerator-160"><a href="#DisulfideClassGenerator-160"><span class="linenos">160</span></a><span class="sd">        :raises ValueError: If required columns are missing.</span>
</span><span id="DisulfideClassGenerator-161"><a href="#DisulfideClassGenerator-161"><span class="linenos">161</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-162"><a href="#DisulfideClassGenerator-162"><span class="linenos">162</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-163"><a href="#DisulfideClassGenerator-163"><span class="linenos">163</span></a>            <span class="n">missing</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DisulfideClassGenerator-164"><a href="#DisulfideClassGenerator-164"><span class="linenos">164</span></a>                <span class="n">col</span>
</span><span id="DisulfideClassGenerator-165"><a href="#DisulfideClassGenerator-165"><span class="linenos">165</span></a>                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">DIHEDRAL_COLUMNS</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;class_str&quot;</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator-166"><a href="#DisulfideClassGenerator-166"><span class="linenos">166</span></a>                <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</span><span id="DisulfideClassGenerator-167"><a href="#DisulfideClassGenerator-167"><span class="linenos">167</span></a>            <span class="p">]</span>
</span><span id="DisulfideClassGenerator-168"><a href="#DisulfideClassGenerator-168"><span class="linenos">168</span></a>            <span class="k">if</span> <span class="n">missing</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-169"><a href="#DisulfideClassGenerator-169"><span class="linenos">169</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DataFrame missing columns: </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-170"><a href="#DisulfideClassGenerator-170"><span class="linenos">170</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;DataFrame validated with columns: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
</span><span id="DisulfideClassGenerator-171"><a href="#DisulfideClassGenerator-171"><span class="linenos">171</span></a>
</span><span id="DisulfideClassGenerator-172"><a href="#DisulfideClassGenerator-172"><span class="linenos">172</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csv_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DisulfideClassGenerator&quot;</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-173"><a href="#DisulfideClassGenerator-173"><span class="linenos">173</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-174"><a href="#DisulfideClassGenerator-174"><span class="linenos">174</span></a><span class="sd">        Load class metrics from a CSV file.</span>
</span><span id="DisulfideClassGenerator-175"><a href="#DisulfideClassGenerator-175"><span class="linenos">175</span></a>
</span><span id="DisulfideClassGenerator-176"><a href="#DisulfideClassGenerator-176"><span class="linenos">176</span></a><span class="sd">        :param csv_file: Path to CSV file.</span>
</span><span id="DisulfideClassGenerator-177"><a href="#DisulfideClassGenerator-177"><span class="linenos">177</span></a><span class="sd">        :type csv_file: str</span>
</span><span id="DisulfideClassGenerator-178"><a href="#DisulfideClassGenerator-178"><span class="linenos">178</span></a><span class="sd">        :param base: Base class (2 or 8, optional).</span>
</span><span id="DisulfideClassGenerator-179"><a href="#DisulfideClassGenerator-179"><span class="linenos">179</span></a><span class="sd">        :type base: int</span>
</span><span id="DisulfideClassGenerator-180"><a href="#DisulfideClassGenerator-180"><span class="linenos">180</span></a><span class="sd">        :return: Self for method chaining.</span>
</span><span id="DisulfideClassGenerator-181"><a href="#DisulfideClassGenerator-181"><span class="linenos">181</span></a><span class="sd">        :rtype: DisulfideClassGenerator</span>
</span><span id="DisulfideClassGenerator-182"><a href="#DisulfideClassGenerator-182"><span class="linenos">182</span></a><span class="sd">        :raises ValueError: If base is invalid.</span>
</span><span id="DisulfideClassGenerator-183"><a href="#DisulfideClassGenerator-183"><span class="linenos">183</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-184"><a href="#DisulfideClassGenerator-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;class_str&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">})</span>
</span><span id="DisulfideClassGenerator-185"><a href="#DisulfideClassGenerator-185"><span class="linenos">185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base</span> <span class="o">=</span> <span class="n">base</span>
</span><span id="DisulfideClassGenerator-186"><a href="#DisulfideClassGenerator-186"><span class="linenos">186</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-187"><a href="#DisulfideClassGenerator-187"><span class="linenos">187</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span>
</span><span id="DisulfideClassGenerator-188"><a href="#DisulfideClassGenerator-188"><span class="linenos">188</span></a>        <span class="k">elif</span> <span class="n">base</span> <span class="o">==</span> <span class="n">OCTANT_BASE</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-189"><a href="#DisulfideClassGenerator-189"><span class="linenos">189</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span>
</span><span id="DisulfideClassGenerator-190"><a href="#DisulfideClassGenerator-190"><span class="linenos">190</span></a>        <span class="k">elif</span> <span class="n">base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-191"><a href="#DisulfideClassGenerator-191"><span class="linenos">191</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid base: </span><span class="si">{</span><span class="n">base</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-192"><a href="#DisulfideClassGenerator-192"><span class="linenos">192</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="DisulfideClassGenerator-193"><a href="#DisulfideClassGenerator-193"><span class="linenos">193</span></a>
</span><span id="DisulfideClassGenerator-194"><a href="#DisulfideClassGenerator-194"><span class="linenos">194</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">class_to_sslist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clsid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">OCTANT_BASE</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-195"><a href="#DisulfideClassGenerator-195"><span class="linenos">195</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-196"><a href="#DisulfideClassGenerator-196"><span class="linenos">196</span></a><span class="sd">        Retrieve disulfide list for a given class ID.</span>
</span><span id="DisulfideClassGenerator-197"><a href="#DisulfideClassGenerator-197"><span class="linenos">197</span></a>
</span><span id="DisulfideClassGenerator-198"><a href="#DisulfideClassGenerator-198"><span class="linenos">198</span></a><span class="sd">        :param clsid: Class ID (e.g., &quot;11111&quot;, &quot;11111b&quot;).</span>
</span><span id="DisulfideClassGenerator-199"><a href="#DisulfideClassGenerator-199"><span class="linenos">199</span></a><span class="sd">        :type clsid: str</span>
</span><span id="DisulfideClassGenerator-200"><a href="#DisulfideClassGenerator-200"><span class="linenos">200</span></a><span class="sd">        :param base: Base class (2 or 8).</span>
</span><span id="DisulfideClassGenerator-201"><a href="#DisulfideClassGenerator-201"><span class="linenos">201</span></a><span class="sd">        :type base: int</span>
</span><span id="DisulfideClassGenerator-202"><a href="#DisulfideClassGenerator-202"><span class="linenos">202</span></a><span class="sd">        :return: DisulfideList for the class.</span>
</span><span id="DisulfideClassGenerator-203"><a href="#DisulfideClassGenerator-203"><span class="linenos">203</span></a><span class="sd">        :rtype: DisulfideList</span>
</span><span id="DisulfideClassGenerator-204"><a href="#DisulfideClassGenerator-204"><span class="linenos">204</span></a><span class="sd">        :raises ValueError: If clsid is invalid.</span>
</span><span id="DisulfideClassGenerator-205"><a href="#DisulfideClassGenerator-205"><span class="linenos">205</span></a><span class="sd">        :raises KeyError: If class not found.</span>
</span><span id="DisulfideClassGenerator-206"><a href="#DisulfideClassGenerator-206"><span class="linenos">206</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-207"><a href="#DisulfideClassGenerator-207"><span class="linenos">207</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">clsid</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="DisulfideClassGenerator-208"><a href="#DisulfideClassGenerator-208"><span class="linenos">208</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Class ID must be a string, got </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">clsid</span><span class="p">))</span>
</span><span id="DisulfideClassGenerator-209"><a href="#DisulfideClassGenerator-209"><span class="linenos">209</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid class ID type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">clsid</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-210"><a href="#DisulfideClassGenerator-210"><span class="linenos">210</span></a>
</span><span id="DisulfideClassGenerator-211"><a href="#DisulfideClassGenerator-211"><span class="linenos">211</span></a>        <span class="n">parsed_base</span><span class="p">,</span> <span class="n">clean_cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_class_string</span><span class="p">(</span><span class="n">clsid</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-212"><a href="#DisulfideClassGenerator-212"><span class="linenos">212</span></a>        <span class="n">base</span> <span class="o">=</span> <span class="n">parsed_base</span> <span class="k">if</span> <span class="n">parsed_base</span> <span class="k">else</span> <span class="n">base</span>
</span><span id="DisulfideClassGenerator-213"><a href="#DisulfideClassGenerator-213"><span class="linenos">213</span></a>        <span class="n">target_dict</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DisulfideClassGenerator-214"><a href="#DisulfideClassGenerator-214"><span class="linenos">214</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span>
</span><span id="DisulfideClassGenerator-215"><a href="#DisulfideClassGenerator-215"><span class="linenos">215</span></a>            <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span>
</span><span id="DisulfideClassGenerator-216"><a href="#DisulfideClassGenerator-216"><span class="linenos">216</span></a>            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span>
</span><span id="DisulfideClassGenerator-217"><a href="#DisulfideClassGenerator-217"><span class="linenos">217</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassGenerator-218"><a href="#DisulfideClassGenerator-218"><span class="linenos">218</span></a>
</span><span id="DisulfideClassGenerator-219"><a href="#DisulfideClassGenerator-219"><span class="linenos">219</span></a>        <span class="k">if</span> <span class="n">clean_cls</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">target_dict</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-220"><a href="#DisulfideClassGenerator-220"><span class="linenos">220</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-221"><a href="#DisulfideClassGenerator-221"><span class="linenos">221</span></a>                <span class="s2">&quot;Class </span><span class="si">%s</span><span class="s2"> not found in </span><span class="si">%s</span><span class="s2"> disulfides&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-222"><a href="#DisulfideClassGenerator-222"><span class="linenos">222</span></a>                <span class="n">clsid</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-223"><a href="#DisulfideClassGenerator-223"><span class="linenos">223</span></a>                <span class="s2">&quot;binary&quot;</span> <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span> <span class="k">else</span> <span class="s2">&quot;octant&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-224"><a href="#DisulfideClassGenerator-224"><span class="linenos">224</span></a>            <span class="p">)</span>
</span><span id="DisulfideClassGenerator-225"><a href="#DisulfideClassGenerator-225"><span class="linenos">225</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class </span><span class="si">{</span><span class="n">clsid</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-226"><a href="#DisulfideClassGenerator-226"><span class="linenos">226</span></a>
</span><span id="DisulfideClassGenerator-227"><a href="#DisulfideClassGenerator-227"><span class="linenos">227</span></a>        <span class="k">return</span> <span class="n">target_dict</span><span class="p">[</span><span class="n">clean_cls</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator-228"><a href="#DisulfideClassGenerator-228"><span class="linenos">228</span></a>
</span><span id="DisulfideClassGenerator-229"><a href="#DisulfideClassGenerator-229"><span class="linenos">229</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_disulfides_for_class</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-230"><a href="#DisulfideClassGenerator-230"><span class="linenos">230</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">class_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">chi_means</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">chi_stds</span><span class="p">:</span> <span class="nb">tuple</span>
</span><span id="DisulfideClassGenerator-231"><a href="#DisulfideClassGenerator-231"><span class="linenos">231</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-232"><a href="#DisulfideClassGenerator-232"><span class="linenos">232</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-233"><a href="#DisulfideClassGenerator-233"><span class="linenos">233</span></a><span class="sd">        Generate disulfide conformations for a class (cached).</span>
</span><span id="DisulfideClassGenerator-234"><a href="#DisulfideClassGenerator-234"><span class="linenos">234</span></a>
</span><span id="DisulfideClassGenerator-235"><a href="#DisulfideClassGenerator-235"><span class="linenos">235</span></a><span class="sd">        :param class_id: Class identifier.</span>
</span><span id="DisulfideClassGenerator-236"><a href="#DisulfideClassGenerator-236"><span class="linenos">236</span></a><span class="sd">        :type class_id: str</span>
</span><span id="DisulfideClassGenerator-237"><a href="#DisulfideClassGenerator-237"><span class="linenos">237</span></a><span class="sd">        :param chi_means: Tuple of mean dihedral angles.</span>
</span><span id="DisulfideClassGenerator-238"><a href="#DisulfideClassGenerator-238"><span class="linenos">238</span></a><span class="sd">        :type chi_means: tuple</span>
</span><span id="DisulfideClassGenerator-239"><a href="#DisulfideClassGenerator-239"><span class="linenos">239</span></a><span class="sd">        :param chi_stds: Tuple of standard deviations.</span>
</span><span id="DisulfideClassGenerator-240"><a href="#DisulfideClassGenerator-240"><span class="linenos">240</span></a><span class="sd">        :type chi_stds: tuple</span>
</span><span id="DisulfideClassGenerator-241"><a href="#DisulfideClassGenerator-241"><span class="linenos">241</span></a><span class="sd">        :return: DisulfideList with all combinations.</span>
</span><span id="DisulfideClassGenerator-242"><a href="#DisulfideClassGenerator-242"><span class="linenos">242</span></a><span class="sd">        :rtype: DisulfideList</span>
</span><span id="DisulfideClassGenerator-243"><a href="#DisulfideClassGenerator-243"><span class="linenos">243</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-244"><a href="#DisulfideClassGenerator-244"><span class="linenos">244</span></a>        <span class="n">chi_values</span> <span class="o">=</span> <span class="p">[[</span><span class="n">m</span> <span class="o">-</span> <span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">chi_means</span><span class="p">,</span> <span class="n">chi_stds</span><span class="p">)]</span>
</span><span id="DisulfideClassGenerator-245"><a href="#DisulfideClassGenerator-245"><span class="linenos">245</span></a>        <span class="n">combinations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">chi_values</span><span class="p">))</span>
</span><span id="DisulfideClassGenerator-246"><a href="#DisulfideClassGenerator-246"><span class="linenos">246</span></a>        <span class="n">disulfides</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DisulfideClassGenerator-247"><a href="#DisulfideClassGenerator-247"><span class="linenos">247</span></a>            <span class="n">Disulfide</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">class_id</span><span class="si">}</span><span class="s2">_comb</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">torsions</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">combo</span><span class="p">))</span>
</span><span id="DisulfideClassGenerator-248"><a href="#DisulfideClassGenerator-248"><span class="linenos">248</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">combo</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">combinations</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-249"><a href="#DisulfideClassGenerator-249"><span class="linenos">249</span></a>        <span class="p">]</span>
</span><span id="DisulfideClassGenerator-250"><a href="#DisulfideClassGenerator-250"><span class="linenos">250</span></a>        <span class="k">return</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="n">disulfides</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Class_</span><span class="si">{</span><span class="n">class_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-251"><a href="#DisulfideClassGenerator-251"><span class="linenos">251</span></a>
</span><span id="DisulfideClassGenerator-252"><a href="#DisulfideClassGenerator-252"><span class="linenos">252</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_for_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">DisulfideList</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
</span><span id="DisulfideClassGenerator-253"><a href="#DisulfideClassGenerator-253"><span class="linenos">253</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-254"><a href="#DisulfideClassGenerator-254"><span class="linenos">254</span></a><span class="sd">        Generate disulfides for a specific class.</span>
</span><span id="DisulfideClassGenerator-255"><a href="#DisulfideClassGenerator-255"><span class="linenos">255</span></a>
</span><span id="DisulfideClassGenerator-256"><a href="#DisulfideClassGenerator-256"><span class="linenos">256</span></a><span class="sd">        :param class_id: Class ID (e.g., &quot;11111b&quot;).</span>
</span><span id="DisulfideClassGenerator-257"><a href="#DisulfideClassGenerator-257"><span class="linenos">257</span></a><span class="sd">        :type class_id: str</span>
</span><span id="DisulfideClassGenerator-258"><a href="#DisulfideClassGenerator-258"><span class="linenos">258</span></a><span class="sd">        :return: DisulfideList or None if class not found.</span>
</span><span id="DisulfideClassGenerator-259"><a href="#DisulfideClassGenerator-259"><span class="linenos">259</span></a><span class="sd">        :rtype: Union[DisulfideList, None]</span>
</span><span id="DisulfideClassGenerator-260"><a href="#DisulfideClassGenerator-260"><span class="linenos">260</span></a><span class="sd">        :raises ValueError: If no DataFrame is loaded.</span>
</span><span id="DisulfideClassGenerator-261"><a href="#DisulfideClassGenerator-261"><span class="linenos">261</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-262"><a href="#DisulfideClassGenerator-262"><span class="linenos">262</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-263"><a href="#DisulfideClassGenerator-263"><span class="linenos">263</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No DataFrame loaded.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-264"><a href="#DisulfideClassGenerator-264"><span class="linenos">264</span></a>
</span><span id="DisulfideClassGenerator-265"><a href="#DisulfideClassGenerator-265"><span class="linenos">265</span></a>        <span class="n">base</span><span class="p">,</span> <span class="n">clean_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_class_string</span><span class="p">(</span><span class="n">class_id</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-266"><a href="#DisulfideClassGenerator-266"><span class="linenos">266</span></a>        <span class="n">df_to_use</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span> <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span>
</span><span id="DisulfideClassGenerator-267"><a href="#DisulfideClassGenerator-267"><span class="linenos">267</span></a>
</span><span id="DisulfideClassGenerator-268"><a href="#DisulfideClassGenerator-268"><span class="linenos">268</span></a>        <span class="k">if</span> <span class="n">df_to_use</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-269"><a href="#DisulfideClassGenerator-269"><span class="linenos">269</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-270"><a href="#DisulfideClassGenerator-270"><span class="linenos">270</span></a>                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> DataFrame not available.&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-271"><a href="#DisulfideClassGenerator-271"><span class="linenos">271</span></a>                <span class="s2">&quot;Binary&quot;</span> <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span> <span class="k">else</span> <span class="s2">&quot;Octant&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-272"><a href="#DisulfideClassGenerator-272"><span class="linenos">272</span></a>            <span class="p">)</span>
</span><span id="DisulfideClassGenerator-273"><a href="#DisulfideClassGenerator-273"><span class="linenos">273</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="DisulfideClassGenerator-274"><a href="#DisulfideClassGenerator-274"><span class="linenos">274</span></a>
</span><span id="DisulfideClassGenerator-275"><a href="#DisulfideClassGenerator-275"><span class="linenos">275</span></a>        <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;class_str&quot;</span> <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span> <span class="k">else</span> <span class="s2">&quot;class&quot;</span>
</span><span id="DisulfideClassGenerator-276"><a href="#DisulfideClassGenerator-276"><span class="linenos">276</span></a>        <span class="n">row</span> <span class="o">=</span> <span class="n">df_to_use</span><span class="p">[</span><span class="n">df_to_use</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="n">clean_string</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator-277"><a href="#DisulfideClassGenerator-277"><span class="linenos">277</span></a>        <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-278"><a href="#DisulfideClassGenerator-278"><span class="linenos">278</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Class </span><span class="si">%s</span><span class="s2"> not found.&quot;</span><span class="p">,</span> <span class="n">class_id</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-279"><a href="#DisulfideClassGenerator-279"><span class="linenos">279</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="DisulfideClassGenerator-280"><a href="#DisulfideClassGenerator-280"><span class="linenos">280</span></a>
</span><span id="DisulfideClassGenerator-281"><a href="#DisulfideClassGenerator-281"><span class="linenos">281</span></a>        <span class="n">row_data</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator-282"><a href="#DisulfideClassGenerator-282"><span class="linenos">282</span></a>        <span class="n">chi_means</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-283"><a href="#DisulfideClassGenerator-283"><span class="linenos">283</span></a>            <span class="n">row_data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;chi</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_mean&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">NUM_DIHEDRAL_ANGLES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-284"><a href="#DisulfideClassGenerator-284"><span class="linenos">284</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassGenerator-285"><a href="#DisulfideClassGenerator-285"><span class="linenos">285</span></a>        <span class="n">chi_stds</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-286"><a href="#DisulfideClassGenerator-286"><span class="linenos">286</span></a>            <span class="n">row_data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;chi</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_std&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">NUM_DIHEDRAL_ANGLES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-287"><a href="#DisulfideClassGenerator-287"><span class="linenos">287</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassGenerator-288"><a href="#DisulfideClassGenerator-288"><span class="linenos">288</span></a>        <span class="n">disulfide_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_disulfides_for_class</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-289"><a href="#DisulfideClassGenerator-289"><span class="linenos">289</span></a>            <span class="n">clean_string</span><span class="p">,</span> <span class="n">chi_means</span><span class="p">,</span> <span class="n">chi_stds</span>
</span><span id="DisulfideClassGenerator-290"><a href="#DisulfideClassGenerator-290"><span class="linenos">290</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassGenerator-291"><a href="#DisulfideClassGenerator-291"><span class="linenos">291</span></a>
</span><span id="DisulfideClassGenerator-292"><a href="#DisulfideClassGenerator-292"><span class="linenos">292</span></a>        <span class="n">target_dict</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DisulfideClassGenerator-293"><a href="#DisulfideClassGenerator-293"><span class="linenos">293</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span>
</span><span id="DisulfideClassGenerator-294"><a href="#DisulfideClassGenerator-294"><span class="linenos">294</span></a>            <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span>
</span><span id="DisulfideClassGenerator-295"><a href="#DisulfideClassGenerator-295"><span class="linenos">295</span></a>            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span>
</span><span id="DisulfideClassGenerator-296"><a href="#DisulfideClassGenerator-296"><span class="linenos">296</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassGenerator-297"><a href="#DisulfideClassGenerator-297"><span class="linenos">297</span></a>        <span class="n">target_dict</span><span class="p">[</span><span class="n">clean_string</span><span class="p">]</span> <span class="o">=</span> <span class="n">disulfide_list</span>
</span><span id="DisulfideClassGenerator-298"><a href="#DisulfideClassGenerator-298"><span class="linenos">298</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-299"><a href="#DisulfideClassGenerator-299"><span class="linenos">299</span></a>            <span class="s2">&quot;Generated </span><span class="si">%d</span><span class="s2"> disulfides for class </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">disulfide_list</span><span class="p">),</span> <span class="n">class_id</span>
</span><span id="DisulfideClassGenerator-300"><a href="#DisulfideClassGenerator-300"><span class="linenos">300</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassGenerator-301"><a href="#DisulfideClassGenerator-301"><span class="linenos">301</span></a>        <span class="k">return</span> <span class="n">disulfide_list</span>
</span><span id="DisulfideClassGenerator-302"><a href="#DisulfideClassGenerator-302"><span class="linenos">302</span></a>
</span><span id="DisulfideClassGenerator-303"><a href="#DisulfideClassGenerator-303"><span class="linenos">303</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_for_selected_classes</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-304"><a href="#DisulfideClassGenerator-304"><span class="linenos">304</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">class_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator-305"><a href="#DisulfideClassGenerator-305"><span class="linenos">305</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DisulfideList</span><span class="p">]:</span>
</span><span id="DisulfideClassGenerator-306"><a href="#DisulfideClassGenerator-306"><span class="linenos">306</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-307"><a href="#DisulfideClassGenerator-307"><span class="linenos">307</span></a><span class="sd">        Generate disulfides for multiple classes in parallel.</span>
</span><span id="DisulfideClassGenerator-308"><a href="#DisulfideClassGenerator-308"><span class="linenos">308</span></a>
</span><span id="DisulfideClassGenerator-309"><a href="#DisulfideClassGenerator-309"><span class="linenos">309</span></a><span class="sd">        :param class_ids: List of class IDs.</span>
</span><span id="DisulfideClassGenerator-310"><a href="#DisulfideClassGenerator-310"><span class="linenos">310</span></a><span class="sd">        :type class_ids: List[str]</span>
</span><span id="DisulfideClassGenerator-311"><a href="#DisulfideClassGenerator-311"><span class="linenos">311</span></a><span class="sd">        :return: Dictionary mapping class IDs to DisulfideLists.</span>
</span><span id="DisulfideClassGenerator-312"><a href="#DisulfideClassGenerator-312"><span class="linenos">312</span></a><span class="sd">        :rtype: Dict[str, DisulfideList]</span>
</span><span id="DisulfideClassGenerator-313"><a href="#DisulfideClassGenerator-313"><span class="linenos">313</span></a><span class="sd">        :raises ValueError: If no DataFrame is loaded.</span>
</span><span id="DisulfideClassGenerator-314"><a href="#DisulfideClassGenerator-314"><span class="linenos">314</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-315"><a href="#DisulfideClassGenerator-315"><span class="linenos">315</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-316"><a href="#DisulfideClassGenerator-316"><span class="linenos">316</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No DataFrame loaded.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-317"><a href="#DisulfideClassGenerator-317"><span class="linenos">317</span></a>
</span><span id="DisulfideClassGenerator-318"><a href="#DisulfideClassGenerator-318"><span class="linenos">318</span></a>        <span class="n">class_disulfides</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideClassGenerator-319"><a href="#DisulfideClassGenerator-319"><span class="linenos">319</span></a>        <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">()</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-320"><a href="#DisulfideClassGenerator-320"><span class="linenos">320</span></a>            <span class="n">futures</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DisulfideClassGenerator-321"><a href="#DisulfideClassGenerator-321"><span class="linenos">321</span></a>                <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generate_for_class</span><span class="p">,</span> <span class="n">cid</span><span class="p">):</span> <span class="n">cid</span> <span class="k">for</span> <span class="n">cid</span> <span class="ow">in</span> <span class="n">class_ids</span>
</span><span id="DisulfideClassGenerator-322"><a href="#DisulfideClassGenerator-322"><span class="linenos">322</span></a>            <span class="p">}</span>
</span><span id="DisulfideClassGenerator-323"><a href="#DisulfideClassGenerator-323"><span class="linenos">323</span></a>            <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-324"><a href="#DisulfideClassGenerator-324"><span class="linenos">324</span></a>                <span class="n">futures</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Generating classes&quot;</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span>
</span><span id="DisulfideClassGenerator-325"><a href="#DisulfideClassGenerator-325"><span class="linenos">325</span></a>            <span class="p">):</span>
</span><span id="DisulfideClassGenerator-326"><a href="#DisulfideClassGenerator-326"><span class="linenos">326</span></a>                <span class="n">class_id</span> <span class="o">=</span> <span class="n">futures</span><span class="p">[</span><span class="n">future</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator-327"><a href="#DisulfideClassGenerator-327"><span class="linenos">327</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">_result</span> <span class="o">:=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-328"><a href="#DisulfideClassGenerator-328"><span class="linenos">328</span></a>                    <span class="n">class_disulfides</span><span class="p">[</span><span class="n">class_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">_result</span>
</span><span id="DisulfideClassGenerator-329"><a href="#DisulfideClassGenerator-329"><span class="linenos">329</span></a>
</span><span id="DisulfideClassGenerator-330"><a href="#DisulfideClassGenerator-330"><span class="linenos">330</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generated disulfides for </span><span class="si">%d</span><span class="s2"> classes&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_disulfides</span><span class="p">))</span>
</span><span id="DisulfideClassGenerator-331"><a href="#DisulfideClassGenerator-331"><span class="linenos">331</span></a>        <span class="k">return</span> <span class="n">class_disulfides</span>
</span><span id="DisulfideClassGenerator-332"><a href="#DisulfideClassGenerator-332"><span class="linenos">332</span></a>
</span><span id="DisulfideClassGenerator-333"><a href="#DisulfideClassGenerator-333"><span class="linenos">333</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_for_all_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DisulfideList</span><span class="p">]:</span>
</span><span id="DisulfideClassGenerator-334"><a href="#DisulfideClassGenerator-334"><span class="linenos">334</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-335"><a href="#DisulfideClassGenerator-335"><span class="linenos">335</span></a><span class="sd">        Generate disulfides for all classes in loaded DataFrames.</span>
</span><span id="DisulfideClassGenerator-336"><a href="#DisulfideClassGenerator-336"><span class="linenos">336</span></a>
</span><span id="DisulfideClassGenerator-337"><a href="#DisulfideClassGenerator-337"><span class="linenos">337</span></a><span class="sd">        :return: Dictionary mapping class IDs to DisulfideLists.</span>
</span><span id="DisulfideClassGenerator-338"><a href="#DisulfideClassGenerator-338"><span class="linenos">338</span></a><span class="sd">        :rtype: Dict[str, DisulfideList]</span>
</span><span id="DisulfideClassGenerator-339"><a href="#DisulfideClassGenerator-339"><span class="linenos">339</span></a><span class="sd">        :raises ValueError: If no DataFrames are loaded.</span>
</span><span id="DisulfideClassGenerator-340"><a href="#DisulfideClassGenerator-340"><span class="linenos">340</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-341"><a href="#DisulfideClassGenerator-341"><span class="linenos">341</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-342"><a href="#DisulfideClassGenerator-342"><span class="linenos">342</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No DataFrames loaded.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-343"><a href="#DisulfideClassGenerator-343"><span class="linenos">343</span></a>
</span><span id="DisulfideClassGenerator-344"><a href="#DisulfideClassGenerator-344"><span class="linenos">344</span></a>        <span class="n">class_disulfides</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideClassGenerator-345"><a href="#DisulfideClassGenerator-345"><span class="linenos">345</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-346"><a href="#DisulfideClassGenerator-346"><span class="linenos">346</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">base</span> <span class="o">=</span> <span class="n">BINARY_BASE</span>
</span><span id="DisulfideClassGenerator-347"><a href="#DisulfideClassGenerator-347"><span class="linenos">347</span></a>            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span><span class="p">,</span> <span class="s2">&quot;binary&quot;</span><span class="p">):</span>
</span><span id="DisulfideClassGenerator-348"><a href="#DisulfideClassGenerator-348"><span class="linenos">348</span></a>                <span class="n">class_id</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;class_str&quot;</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator-349"><a href="#DisulfideClassGenerator-349"><span class="linenos">349</span></a>                <span class="n">disulfide_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_from_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">class_id</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-350"><a href="#DisulfideClassGenerator-350"><span class="linenos">350</span></a>                <span class="n">class_disulfides</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">class_id</span><span class="si">}</span><span class="s2">b&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">disulfide_list</span>
</span><span id="DisulfideClassGenerator-351"><a href="#DisulfideClassGenerator-351"><span class="linenos">351</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span><span class="p">[</span><span class="n">class_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">disulfide_list</span>
</span><span id="DisulfideClassGenerator-352"><a href="#DisulfideClassGenerator-352"><span class="linenos">352</span></a>
</span><span id="DisulfideClassGenerator-353"><a href="#DisulfideClassGenerator-353"><span class="linenos">353</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-354"><a href="#DisulfideClassGenerator-354"><span class="linenos">354</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">base</span> <span class="o">=</span> <span class="n">OCTANT_BASE</span>
</span><span id="DisulfideClassGenerator-355"><a href="#DisulfideClassGenerator-355"><span class="linenos">355</span></a>            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span><span class="p">,</span> <span class="s2">&quot;octant&quot;</span><span class="p">):</span>
</span><span id="DisulfideClassGenerator-356"><a href="#DisulfideClassGenerator-356"><span class="linenos">356</span></a>                <span class="n">class_id</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator-357"><a href="#DisulfideClassGenerator-357"><span class="linenos">357</span></a>                <span class="n">disulfide_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_from_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">class_id</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-358"><a href="#DisulfideClassGenerator-358"><span class="linenos">358</span></a>                <span class="n">class_disulfides</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">class_id</span><span class="si">}</span><span class="s2">o&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">disulfide_list</span>
</span><span id="DisulfideClassGenerator-359"><a href="#DisulfideClassGenerator-359"><span class="linenos">359</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span><span class="p">[</span><span class="n">class_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">disulfide_list</span>
</span><span id="DisulfideClassGenerator-360"><a href="#DisulfideClassGenerator-360"><span class="linenos">360</span></a>
</span><span id="DisulfideClassGenerator-361"><a href="#DisulfideClassGenerator-361"><span class="linenos">361</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generated disulfides for </span><span class="si">%d</span><span class="s2"> classes&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_disulfides</span><span class="p">))</span>
</span><span id="DisulfideClassGenerator-362"><a href="#DisulfideClassGenerator-362"><span class="linenos">362</span></a>        <span class="k">return</span> <span class="n">class_disulfides</span>
</span><span id="DisulfideClassGenerator-363"><a href="#DisulfideClassGenerator-363"><span class="linenos">363</span></a>
</span><span id="DisulfideClassGenerator-364"><a href="#DisulfideClassGenerator-364"><span class="linenos">364</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_iterate_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="DisulfideClassGenerator-365"><a href="#DisulfideClassGenerator-365"><span class="linenos">365</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-366"><a href="#DisulfideClassGenerator-366"><span class="linenos">366</span></a><span class="sd">        Helper to iterate DataFrame with optional progress bar.</span>
</span><span id="DisulfideClassGenerator-367"><a href="#DisulfideClassGenerator-367"><span class="linenos">367</span></a>
</span><span id="DisulfideClassGenerator-368"><a href="#DisulfideClassGenerator-368"><span class="linenos">368</span></a><span class="sd">        :param df: DataFrame to iterate.</span>
</span><span id="DisulfideClassGenerator-369"><a href="#DisulfideClassGenerator-369"><span class="linenos">369</span></a><span class="sd">        :type df: pd.DataFrame</span>
</span><span id="DisulfideClassGenerator-370"><a href="#DisulfideClassGenerator-370"><span class="linenos">370</span></a><span class="sd">        :param desc: Description for progress bar.</span>
</span><span id="DisulfideClassGenerator-371"><a href="#DisulfideClassGenerator-371"><span class="linenos">371</span></a><span class="sd">        :type desc: str</span>
</span><span id="DisulfideClassGenerator-372"><a href="#DisulfideClassGenerator-372"><span class="linenos">372</span></a><span class="sd">        :return: Iterator over DataFrame rows.</span>
</span><span id="DisulfideClassGenerator-373"><a href="#DisulfideClassGenerator-373"><span class="linenos">373</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-374"><a href="#DisulfideClassGenerator-374"><span class="linenos">374</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="DisulfideClassGenerator-375"><a href="#DisulfideClassGenerator-375"><span class="linenos">375</span></a>            <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-376"><a href="#DisulfideClassGenerator-376"><span class="linenos">376</span></a>                <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">(),</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Generating </span><span class="si">{</span><span class="n">desc</span><span class="si">}</span><span class="s2"> disulfides&quot;</span>
</span><span id="DisulfideClassGenerator-377"><a href="#DisulfideClassGenerator-377"><span class="linenos">377</span></a>            <span class="p">)</span>
</span><span id="DisulfideClassGenerator-378"><a href="#DisulfideClassGenerator-378"><span class="linenos">378</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span>
</span><span id="DisulfideClassGenerator-379"><a href="#DisulfideClassGenerator-379"><span class="linenos">379</span></a>            <span class="k">else</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()</span>
</span><span id="DisulfideClassGenerator-380"><a href="#DisulfideClassGenerator-380"><span class="linenos">380</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassGenerator-381"><a href="#DisulfideClassGenerator-381"><span class="linenos">381</span></a>
</span><span id="DisulfideClassGenerator-382"><a href="#DisulfideClassGenerator-382"><span class="linenos">382</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_from_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">class_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-383"><a href="#DisulfideClassGenerator-383"><span class="linenos">383</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-384"><a href="#DisulfideClassGenerator-384"><span class="linenos">384</span></a><span class="sd">        Generate disulfides from a DataFrame row.</span>
</span><span id="DisulfideClassGenerator-385"><a href="#DisulfideClassGenerator-385"><span class="linenos">385</span></a>
</span><span id="DisulfideClassGenerator-386"><a href="#DisulfideClassGenerator-386"><span class="linenos">386</span></a><span class="sd">        :param row: DataFrame row with class metrics.</span>
</span><span id="DisulfideClassGenerator-387"><a href="#DisulfideClassGenerator-387"><span class="linenos">387</span></a><span class="sd">        :type row: pd.Series</span>
</span><span id="DisulfideClassGenerator-388"><a href="#DisulfideClassGenerator-388"><span class="linenos">388</span></a><span class="sd">        :param class_id: Class identifier.</span>
</span><span id="DisulfideClassGenerator-389"><a href="#DisulfideClassGenerator-389"><span class="linenos">389</span></a><span class="sd">        :type class_id: str</span>
</span><span id="DisulfideClassGenerator-390"><a href="#DisulfideClassGenerator-390"><span class="linenos">390</span></a><span class="sd">        :return: DisulfideList for the row.</span>
</span><span id="DisulfideClassGenerator-391"><a href="#DisulfideClassGenerator-391"><span class="linenos">391</span></a><span class="sd">        :rtype: DisulfideList</span>
</span><span id="DisulfideClassGenerator-392"><a href="#DisulfideClassGenerator-392"><span class="linenos">392</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-393"><a href="#DisulfideClassGenerator-393"><span class="linenos">393</span></a>        <span class="n">chi_means</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-394"><a href="#DisulfideClassGenerator-394"><span class="linenos">394</span></a>            <span class="n">row</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;chi</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_mean&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">NUM_DIHEDRAL_ANGLES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-395"><a href="#DisulfideClassGenerator-395"><span class="linenos">395</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassGenerator-396"><a href="#DisulfideClassGenerator-396"><span class="linenos">396</span></a>        <span class="n">chi_stds</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;chi</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_std&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">NUM_DIHEDRAL_ANGLES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="DisulfideClassGenerator-397"><a href="#DisulfideClassGenerator-397"><span class="linenos">397</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_disulfides_for_class</span><span class="p">(</span><span class="n">class_id</span><span class="p">,</span> <span class="n">chi_means</span><span class="p">,</span> <span class="n">chi_stds</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-398"><a href="#DisulfideClassGenerator-398"><span class="linenos">398</span></a>
</span><span id="DisulfideClassGenerator-399"><a href="#DisulfideClassGenerator-399"><span class="linenos">399</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">detailed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-400"><a href="#DisulfideClassGenerator-400"><span class="linenos">400</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-401"><a href="#DisulfideClassGenerator-401"><span class="linenos">401</span></a><span class="sd">        Print the internal state of the generator.</span>
</span><span id="DisulfideClassGenerator-402"><a href="#DisulfideClassGenerator-402"><span class="linenos">402</span></a>
</span><span id="DisulfideClassGenerator-403"><a href="#DisulfideClassGenerator-403"><span class="linenos">403</span></a><span class="sd">        :param detailed: Show detailed DataFrame and disulfide info.</span>
</span><span id="DisulfideClassGenerator-404"><a href="#DisulfideClassGenerator-404"><span class="linenos">404</span></a><span class="sd">        :type detailed: bool</span>
</span><span id="DisulfideClassGenerator-405"><a href="#DisulfideClassGenerator-405"><span class="linenos">405</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-406"><a href="#DisulfideClassGenerator-406"><span class="linenos">406</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-407"><a href="#DisulfideClassGenerator-407"><span class="linenos">407</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;DisulfideClassGenerator State&#39;</span><span class="si">:</span><span class="s2">^80</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-408"><a href="#DisulfideClassGenerator-408"><span class="linenos">408</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-409"><a href="#DisulfideClassGenerator-409"><span class="linenos">409</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Base: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;Not set&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-410"><a href="#DisulfideClassGenerator-410"><span class="linenos">410</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Verbose: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-411"><a href="#DisulfideClassGenerator-411"><span class="linenos">411</span></a>
</span><span id="DisulfideClassGenerator-412"><a href="#DisulfideClassGenerator-412"><span class="linenos">412</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">DataFrames:&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-413"><a href="#DisulfideClassGenerator-413"><span class="linenos">413</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="DisulfideClassGenerator-414"><a href="#DisulfideClassGenerator-414"><span class="linenos">414</span></a>            <span class="p">(</span><span class="s2">&quot;Binary&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span><span class="p">,</span> <span class="s2">&quot;binary_df&quot;</span><span class="p">),</span>
</span><span id="DisulfideClassGenerator-415"><a href="#DisulfideClassGenerator-415"><span class="linenos">415</span></a>            <span class="p">(</span><span class="s2">&quot;Octant&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span><span class="p">,</span> <span class="s2">&quot;octant_df&quot;</span><span class="p">),</span>
</span><span id="DisulfideClassGenerator-416"><a href="#DisulfideClassGenerator-416"><span class="linenos">416</span></a>        <span class="p">]:</span>
</span><span id="DisulfideClassGenerator-417"><a href="#DisulfideClassGenerator-417"><span class="linenos">417</span></a>            <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-418"><a href="#DisulfideClassGenerator-418"><span class="linenos">418</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: Loaded (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2"> classes)&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-419"><a href="#DisulfideClassGenerator-419"><span class="linenos">419</span></a>                <span class="k">if</span> <span class="n">detailed</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-420"><a href="#DisulfideClassGenerator-420"><span class="linenos">420</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Sample:</span><span class="se">\n</span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-421"><a href="#DisulfideClassGenerator-421"><span class="linenos">421</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-422"><a href="#DisulfideClassGenerator-422"><span class="linenos">422</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: Not loaded&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-423"><a href="#DisulfideClassGenerator-423"><span class="linenos">423</span></a>
</span><span id="DisulfideClassGenerator-424"><a href="#DisulfideClassGenerator-424"><span class="linenos">424</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Disulfides:&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-425"><a href="#DisulfideClassGenerator-425"><span class="linenos">425</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="DisulfideClassGenerator-426"><a href="#DisulfideClassGenerator-426"><span class="linenos">426</span></a>            <span class="p">(</span><span class="s2">&quot;Binary&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span><span class="p">),</span>
</span><span id="DisulfideClassGenerator-427"><a href="#DisulfideClassGenerator-427"><span class="linenos">427</span></a>            <span class="p">(</span><span class="s2">&quot;Octant&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span><span class="p">),</span>
</span><span id="DisulfideClassGenerator-428"><a href="#DisulfideClassGenerator-428"><span class="linenos">428</span></a>        <span class="p">]:</span>
</span><span id="DisulfideClassGenerator-429"><a href="#DisulfideClassGenerator-429"><span class="linenos">429</span></a>            <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-430"><a href="#DisulfideClassGenerator-430"><span class="linenos">430</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> classes&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-431"><a href="#DisulfideClassGenerator-431"><span class="linenos">431</span></a>            <span class="k">if</span> <span class="n">detailed</span> <span class="ow">and</span> <span class="n">count</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-432"><a href="#DisulfideClassGenerator-432"><span class="linenos">432</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Sample: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">())[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-433"><a href="#DisulfideClassGenerator-433"><span class="linenos">433</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-434"><a href="#DisulfideClassGenerator-434"><span class="linenos">434</span></a>
</span><span id="DisulfideClassGenerator-435"><a href="#DisulfideClassGenerator-435"><span class="linenos">435</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_energy_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-436"><a href="#DisulfideClassGenerator-436"><span class="linenos">436</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-437"><a href="#DisulfideClassGenerator-437"><span class="linenos">437</span></a><span class="sd">        Prepare energy data for visualization.</span>
</span><span id="DisulfideClassGenerator-438"><a href="#DisulfideClassGenerator-438"><span class="linenos">438</span></a>
</span><span id="DisulfideClassGenerator-439"><a href="#DisulfideClassGenerator-439"><span class="linenos">439</span></a><span class="sd">        :return: DataFrame with class and energy data.</span>
</span><span id="DisulfideClassGenerator-440"><a href="#DisulfideClassGenerator-440"><span class="linenos">440</span></a><span class="sd">        :rtype: pd.DataFrame</span>
</span><span id="DisulfideClassGenerator-441"><a href="#DisulfideClassGenerator-441"><span class="linenos">441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-442"><a href="#DisulfideClassGenerator-442"><span class="linenos">442</span></a>        <span class="n">energy_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DisulfideClassGenerator-443"><a href="#DisulfideClassGenerator-443"><span class="linenos">443</span></a>        <span class="k">for</span> <span class="n">base</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="DisulfideClassGenerator-444"><a href="#DisulfideClassGenerator-444"><span class="linenos">444</span></a>            <span class="p">(</span><span class="n">BINARY_BASE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span><span class="p">),</span>
</span><span id="DisulfideClassGenerator-445"><a href="#DisulfideClassGenerator-445"><span class="linenos">445</span></a>            <span class="p">(</span><span class="n">OCTANT_BASE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span><span class="p">),</span>
</span><span id="DisulfideClassGenerator-446"><a href="#DisulfideClassGenerator-446"><span class="linenos">446</span></a>        <span class="p">]:</span>
</span><span id="DisulfideClassGenerator-447"><a href="#DisulfideClassGenerator-447"><span class="linenos">447</span></a>            <span class="k">for</span> <span class="n">class_id</span><span class="p">,</span> <span class="n">disulfide_list</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="DisulfideClassGenerator-448"><a href="#DisulfideClassGenerator-448"><span class="linenos">448</span></a>                <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">disulfide_list</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-449"><a href="#DisulfideClassGenerator-449"><span class="linenos">449</span></a>                    <span class="n">energy_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-450"><a href="#DisulfideClassGenerator-450"><span class="linenos">450</span></a>                        <span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="n">class_id</span><span class="p">,</span> <span class="s2">&quot;energy&quot;</span><span class="p">:</span> <span class="n">ss</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span> <span class="s2">&quot;base&quot;</span><span class="p">:</span> <span class="n">base</span><span class="p">}</span>
</span><span id="DisulfideClassGenerator-451"><a href="#DisulfideClassGenerator-451"><span class="linenos">451</span></a>                    <span class="p">)</span>
</span><span id="DisulfideClassGenerator-452"><a href="#DisulfideClassGenerator-452"><span class="linenos">452</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">energy_data</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-453"><a href="#DisulfideClassGenerator-453"><span class="linenos">453</span></a>        <span class="p">(</span>
</span><span id="DisulfideClassGenerator-454"><a href="#DisulfideClassGenerator-454"><span class="linenos">454</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepared energy data with </span><span class="si">%d</span><span class="s2"> entries&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
</span><span id="DisulfideClassGenerator-455"><a href="#DisulfideClassGenerator-455"><span class="linenos">455</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span>
</span><span id="DisulfideClassGenerator-456"><a href="#DisulfideClassGenerator-456"><span class="linenos">456</span></a>            <span class="k">else</span> <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No energy data.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-457"><a href="#DisulfideClassGenerator-457"><span class="linenos">457</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassGenerator-458"><a href="#DisulfideClassGenerator-458"><span class="linenos">458</span></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="DisulfideClassGenerator-459"><a href="#DisulfideClassGenerator-459"><span class="linenos">459</span></a>
</span><span id="DisulfideClassGenerator-460"><a href="#DisulfideClassGenerator-460"><span class="linenos">460</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_energy_by_class</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-461"><a href="#DisulfideClassGenerator-461"><span class="linenos">461</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Energy Distribution by Class&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="DisulfideClassGenerator-462"><a href="#DisulfideClassGenerator-462"><span class="linenos">462</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-463"><a href="#DisulfideClassGenerator-463"><span class="linenos">463</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-464"><a href="#DisulfideClassGenerator-464"><span class="linenos">464</span></a><span class="sd">        Plot energy distribution by class.</span>
</span><span id="DisulfideClassGenerator-465"><a href="#DisulfideClassGenerator-465"><span class="linenos">465</span></a>
</span><span id="DisulfideClassGenerator-466"><a href="#DisulfideClassGenerator-466"><span class="linenos">466</span></a><span class="sd">        :param base: Filter by base (2 or 8, optional).</span>
</span><span id="DisulfideClassGenerator-467"><a href="#DisulfideClassGenerator-467"><span class="linenos">467</span></a><span class="sd">        :type base: int</span>
</span><span id="DisulfideClassGenerator-468"><a href="#DisulfideClassGenerator-468"><span class="linenos">468</span></a><span class="sd">        :param title: Plot title.</span>
</span><span id="DisulfideClassGenerator-469"><a href="#DisulfideClassGenerator-469"><span class="linenos">469</span></a><span class="sd">        :type title: str</span>
</span><span id="DisulfideClassGenerator-470"><a href="#DisulfideClassGenerator-470"><span class="linenos">470</span></a><span class="sd">        :param kwargs: Additional plotting options.</span>
</span><span id="DisulfideClassGenerator-471"><a href="#DisulfideClassGenerator-471"><span class="linenos">471</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-472"><a href="#DisulfideClassGenerator-472"><span class="linenos">472</span></a>
</span><span id="DisulfideClassGenerator-473"><a href="#DisulfideClassGenerator-473"><span class="linenos">473</span></a>        <span class="n">energy_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_energy_data</span><span class="p">()</span>
</span><span id="DisulfideClassGenerator-474"><a href="#DisulfideClassGenerator-474"><span class="linenos">474</span></a>        <span class="k">if</span> <span class="n">energy_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-475"><a href="#DisulfideClassGenerator-475"><span class="linenos">475</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No energy data available.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-476"><a href="#DisulfideClassGenerator-476"><span class="linenos">476</span></a>            <span class="k">return</span>
</span><span id="DisulfideClassGenerator-477"><a href="#DisulfideClassGenerator-477"><span class="linenos">477</span></a>
</span><span id="DisulfideClassGenerator-478"><a href="#DisulfideClassGenerator-478"><span class="linenos">478</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="ow">in</span> <span class="p">(</span><span class="n">BINARY_BASE</span><span class="p">,</span> <span class="n">OCTANT_BASE</span><span class="p">):</span>
</span><span id="DisulfideClassGenerator-479"><a href="#DisulfideClassGenerator-479"><span class="linenos">479</span></a>            <span class="n">energy_df</span> <span class="o">=</span> <span class="n">energy_df</span><span class="p">[</span><span class="n">energy_df</span><span class="p">[</span><span class="s2">&quot;base&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">base</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator-480"><a href="#DisulfideClassGenerator-480"><span class="linenos">480</span></a>            <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Binary&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">BINARY_BASE</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Octant&#39;</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DisulfideClassGenerator-481"><a href="#DisulfideClassGenerator-481"><span class="linenos">481</span></a>        <span class="k">elif</span> <span class="n">base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-482"><a href="#DisulfideClassGenerator-482"><span class="linenos">482</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Base must be 2 or 8.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-483"><a href="#DisulfideClassGenerator-483"><span class="linenos">483</span></a>
</span><span id="DisulfideClassGenerator-484"><a href="#DisulfideClassGenerator-484"><span class="linenos">484</span></a>        <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_energy_by_class</span><span class="p">(</span><span class="n">energy_df</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-485"><a href="#DisulfideClassGenerator-485"><span class="linenos">485</span></a>
</span><span id="DisulfideClassGenerator-486"><a href="#DisulfideClassGenerator-486"><span class="linenos">486</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_torsion_distance_by_class</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-487"><a href="#DisulfideClassGenerator-487"><span class="linenos">487</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-488"><a href="#DisulfideClassGenerator-488"><span class="linenos">488</span></a>        <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-489"><a href="#DisulfideClassGenerator-489"><span class="linenos">489</span></a>        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Torsion Distance by Class&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-490"><a href="#DisulfideClassGenerator-490"><span class="linenos">490</span></a>        <span class="n">theme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-491"><a href="#DisulfideClassGenerator-491"><span class="linenos">491</span></a>        <span class="n">save</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-492"><a href="#DisulfideClassGenerator-492"><span class="linenos">492</span></a>        <span class="n">savedir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-493"><a href="#DisulfideClassGenerator-493"><span class="linenos">493</span></a>        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-494"><a href="#DisulfideClassGenerator-494"><span class="linenos">494</span></a>        <span class="n">split</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-495"><a href="#DisulfideClassGenerator-495"><span class="linenos">495</span></a>        <span class="n">max_classes_per_plot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">330</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-496"><a href="#DisulfideClassGenerator-496"><span class="linenos">496</span></a>        <span class="n">dpi</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-497"><a href="#DisulfideClassGenerator-497"><span class="linenos">497</span></a>        <span class="n">suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;png&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-498"><a href="#DisulfideClassGenerator-498"><span class="linenos">498</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-499"><a href="#DisulfideClassGenerator-499"><span class="linenos">499</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-500"><a href="#DisulfideClassGenerator-500"><span class="linenos">500</span></a><span class="sd">        Create a bar chart showing torsion distance by class_id.</span>
</span><span id="DisulfideClassGenerator-501"><a href="#DisulfideClassGenerator-501"><span class="linenos">501</span></a>
</span><span id="DisulfideClassGenerator-502"><a href="#DisulfideClassGenerator-502"><span class="linenos">502</span></a><span class="sd">        :param base: The base class to use (2 for binary, 8 for octant). If None,</span>
</span><span id="DisulfideClassGenerator-503"><a href="#DisulfideClassGenerator-503"><span class="linenos">503</span></a><span class="sd">        use all available data.</span>
</span><span id="DisulfideClassGenerator-504"><a href="#DisulfideClassGenerator-504"><span class="linenos">504</span></a><span class="sd">        :type base: int, optional</span>
</span><span id="DisulfideClassGenerator-505"><a href="#DisulfideClassGenerator-505"><span class="linenos">505</span></a><span class="sd">        :param title: Title for the plot</span>
</span><span id="DisulfideClassGenerator-506"><a href="#DisulfideClassGenerator-506"><span class="linenos">506</span></a><span class="sd">        :type title: str</span>
</span><span id="DisulfideClassGenerator-507"><a href="#DisulfideClassGenerator-507"><span class="linenos">507</span></a><span class="sd">        :param theme: Theme to use for the plot (&#39;auto&#39;, &#39;light&#39;, or &#39;dark&#39;)</span>
</span><span id="DisulfideClassGenerator-508"><a href="#DisulfideClassGenerator-508"><span class="linenos">508</span></a><span class="sd">        :type theme: str</span>
</span><span id="DisulfideClassGenerator-509"><a href="#DisulfideClassGenerator-509"><span class="linenos">509</span></a><span class="sd">        :param save: Whether to save the plot</span>
</span><span id="DisulfideClassGenerator-510"><a href="#DisulfideClassGenerator-510"><span class="linenos">510</span></a><span class="sd">        :type save: bool</span>
</span><span id="DisulfideClassGenerator-511"><a href="#DisulfideClassGenerator-511"><span class="linenos">511</span></a><span class="sd">        :param savedir: Directory to save the plot to</span>
</span><span id="DisulfideClassGenerator-512"><a href="#DisulfideClassGenerator-512"><span class="linenos">512</span></a><span class="sd">        :type savedir: str</span>
</span><span id="DisulfideClassGenerator-513"><a href="#DisulfideClassGenerator-513"><span class="linenos">513</span></a><span class="sd">        :param verbose: Whether to display verbose output</span>
</span><span id="DisulfideClassGenerator-514"><a href="#DisulfideClassGenerator-514"><span class="linenos">514</span></a><span class="sd">        :type verbose: bool</span>
</span><span id="DisulfideClassGenerator-515"><a href="#DisulfideClassGenerator-515"><span class="linenos">515</span></a><span class="sd">        :param split: Whether to split the plot into multiple plots if there are many classes</span>
</span><span id="DisulfideClassGenerator-516"><a href="#DisulfideClassGenerator-516"><span class="linenos">516</span></a><span class="sd">        :type split: bool</span>
</span><span id="DisulfideClassGenerator-517"><a href="#DisulfideClassGenerator-517"><span class="linenos">517</span></a><span class="sd">        :param max_classes_per_plot: Maximum number of classes to include in each plot</span>
</span><span id="DisulfideClassGenerator-518"><a href="#DisulfideClassGenerator-518"><span class="linenos">518</span></a><span class="sd">        when splitting</span>
</span><span id="DisulfideClassGenerator-519"><a href="#DisulfideClassGenerator-519"><span class="linenos">519</span></a><span class="sd">        :type max_classes_per_plot: int</span>
</span><span id="DisulfideClassGenerator-520"><a href="#DisulfideClassGenerator-520"><span class="linenos">520</span></a><span class="sd">        :param dpi: DPI (dots per inch) for the saved image, controls the resolution (default: 600)</span>
</span><span id="DisulfideClassGenerator-521"><a href="#DisulfideClassGenerator-521"><span class="linenos">521</span></a><span class="sd">        :type dpi: int</span>
</span><span id="DisulfideClassGenerator-522"><a href="#DisulfideClassGenerator-522"><span class="linenos">522</span></a><span class="sd">        :param suffix: File format for saved images (default: &quot;png&quot;)</span>
</span><span id="DisulfideClassGenerator-523"><a href="#DisulfideClassGenerator-523"><span class="linenos">523</span></a><span class="sd">        :type suffix: str</span>
</span><span id="DisulfideClassGenerator-524"><a href="#DisulfideClassGenerator-524"><span class="linenos">524</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-525"><a href="#DisulfideClassGenerator-525"><span class="linenos">525</span></a>
</span><span id="DisulfideClassGenerator-526"><a href="#DisulfideClassGenerator-526"><span class="linenos">526</span></a>        <span class="c1"># Determine which DataFrame to use based on base parameter</span>
</span><span id="DisulfideClassGenerator-527"><a href="#DisulfideClassGenerator-527"><span class="linenos">527</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-528"><a href="#DisulfideClassGenerator-528"><span class="linenos">528</span></a>            <span class="k">if</span> <span class="n">base</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">]:</span>
</span><span id="DisulfideClassGenerator-529"><a href="#DisulfideClassGenerator-529"><span class="linenos">529</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Base must be 2 (binary) or 8 (octant)&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-530"><a href="#DisulfideClassGenerator-530"><span class="linenos">530</span></a>
</span><span id="DisulfideClassGenerator-531"><a href="#DisulfideClassGenerator-531"><span class="linenos">531</span></a>            <span class="n">df_to_use</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span> <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span>
</span><span id="DisulfideClassGenerator-532"><a href="#DisulfideClassGenerator-532"><span class="linenos">532</span></a>            <span class="n">base_str</span> <span class="o">=</span> <span class="s2">&quot;Binary&quot;</span> <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="s2">&quot;Octant&quot;</span>
</span><span id="DisulfideClassGenerator-533"><a href="#DisulfideClassGenerator-533"><span class="linenos">533</span></a>            <span class="n">plot_title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_str</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DisulfideClassGenerator-534"><a href="#DisulfideClassGenerator-534"><span class="linenos">534</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-535"><a href="#DisulfideClassGenerator-535"><span class="linenos">535</span></a>            <span class="c1"># Default to octant if available, otherwise binary</span>
</span><span id="DisulfideClassGenerator-536"><a href="#DisulfideClassGenerator-536"><span class="linenos">536</span></a>            <span class="n">df_to_use</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span>
</span><span id="DisulfideClassGenerator-537"><a href="#DisulfideClassGenerator-537"><span class="linenos">537</span></a>            <span class="n">plot_title</span> <span class="o">=</span> <span class="n">title</span>
</span><span id="DisulfideClassGenerator-538"><a href="#DisulfideClassGenerator-538"><span class="linenos">538</span></a>
</span><span id="DisulfideClassGenerator-539"><a href="#DisulfideClassGenerator-539"><span class="linenos">539</span></a>        <span class="k">if</span> <span class="n">df_to_use</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">df_to_use</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-540"><a href="#DisulfideClassGenerator-540"><span class="linenos">540</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No data available for the specified base.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-541"><a href="#DisulfideClassGenerator-541"><span class="linenos">541</span></a>            <span class="k">return</span>
</span><span id="DisulfideClassGenerator-542"><a href="#DisulfideClassGenerator-542"><span class="linenos">542</span></a>
</span><span id="DisulfideClassGenerator-543"><a href="#DisulfideClassGenerator-543"><span class="linenos">543</span></a>        <span class="c1"># Check if avg_torsion_distance column exists</span>
</span><span id="DisulfideClassGenerator-544"><a href="#DisulfideClassGenerator-544"><span class="linenos">544</span></a>        <span class="k">if</span> <span class="s2">&quot;avg_torsion_distance&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_to_use</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-545"><a href="#DisulfideClassGenerator-545"><span class="linenos">545</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;avg_torsion_distance column not found in the DataFrame.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-546"><a href="#DisulfideClassGenerator-546"><span class="linenos">546</span></a>            <span class="k">return</span>
</span><span id="DisulfideClassGenerator-547"><a href="#DisulfideClassGenerator-547"><span class="linenos">547</span></a>
</span><span id="DisulfideClassGenerator-548"><a href="#DisulfideClassGenerator-548"><span class="linenos">548</span></a>        <span class="c1"># Create a copy of the DataFrame to avoid modifying the original</span>
</span><span id="DisulfideClassGenerator-549"><a href="#DisulfideClassGenerator-549"><span class="linenos">549</span></a>        <span class="n">plot_df</span> <span class="o">=</span> <span class="n">df_to_use</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DisulfideClassGenerator-550"><a href="#DisulfideClassGenerator-550"><span class="linenos">550</span></a>
</span><span id="DisulfideClassGenerator-551"><a href="#DisulfideClassGenerator-551"><span class="linenos">551</span></a>        <span class="c1"># If not splitting or few classes, create a single plot</span>
</span><span id="DisulfideClassGenerator-552"><a href="#DisulfideClassGenerator-552"><span class="linenos">552</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">split</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">max_classes_per_plot</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-553"><a href="#DisulfideClassGenerator-553"><span class="linenos">553</span></a>            <span class="c1"># Create line plot using plotly_express</span>
</span><span id="DisulfideClassGenerator-554"><a href="#DisulfideClassGenerator-554"><span class="linenos">554</span></a>            <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_torsion_distance_by_class</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-555"><a href="#DisulfideClassGenerator-555"><span class="linenos">555</span></a>                <span class="n">plot_df</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-556"><a href="#DisulfideClassGenerator-556"><span class="linenos">556</span></a>                <span class="n">title</span><span class="o">=</span><span class="n">plot_title</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-557"><a href="#DisulfideClassGenerator-557"><span class="linenos">557</span></a>                <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-558"><a href="#DisulfideClassGenerator-558"><span class="linenos">558</span></a>                <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-559"><a href="#DisulfideClassGenerator-559"><span class="linenos">559</span></a>                <span class="n">savedir</span><span class="o">=</span><span class="n">savedir</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-560"><a href="#DisulfideClassGenerator-560"><span class="linenos">560</span></a>                <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-561"><a href="#DisulfideClassGenerator-561"><span class="linenos">561</span></a>                <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-562"><a href="#DisulfideClassGenerator-562"><span class="linenos">562</span></a>                <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-563"><a href="#DisulfideClassGenerator-563"><span class="linenos">563</span></a>            <span class="p">)</span>
</span><span id="DisulfideClassGenerator-564"><a href="#DisulfideClassGenerator-564"><span class="linenos">564</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-565"><a href="#DisulfideClassGenerator-565"><span class="linenos">565</span></a>            <span class="c1"># Split into multiple plots</span>
</span><span id="DisulfideClassGenerator-566"><a href="#DisulfideClassGenerator-566"><span class="linenos">566</span></a>            <span class="n">num_plots</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DisulfideClassGenerator-567"><a href="#DisulfideClassGenerator-567"><span class="linenos">567</span></a>                <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="p">)</span> <span class="o">+</span> <span class="n">max_classes_per_plot</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="DisulfideClassGenerator-568"><a href="#DisulfideClassGenerator-568"><span class="linenos">568</span></a>            <span class="p">)</span> <span class="o">//</span> <span class="n">max_classes_per_plot</span>
</span><span id="DisulfideClassGenerator-569"><a href="#DisulfideClassGenerator-569"><span class="linenos">569</span></a>
</span><span id="DisulfideClassGenerator-570"><a href="#DisulfideClassGenerator-570"><span class="linenos">570</span></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-571"><a href="#DisulfideClassGenerator-571"><span class="linenos">571</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-572"><a href="#DisulfideClassGenerator-572"><span class="linenos">572</span></a>                    <span class="s2">&quot;Splitting into </span><span class="si">%d</span><span class="s2"> plots with up to </span><span class="si">%d</span><span class="s2"> classes each&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-573"><a href="#DisulfideClassGenerator-573"><span class="linenos">573</span></a>                    <span class="n">num_plots</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-574"><a href="#DisulfideClassGenerator-574"><span class="linenos">574</span></a>                    <span class="n">max_classes_per_plot</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-575"><a href="#DisulfideClassGenerator-575"><span class="linenos">575</span></a>                <span class="p">)</span>
</span><span id="DisulfideClassGenerator-576"><a href="#DisulfideClassGenerator-576"><span class="linenos">576</span></a>
</span><span id="DisulfideClassGenerator-577"><a href="#DisulfideClassGenerator-577"><span class="linenos">577</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_plots</span><span class="p">):</span>
</span><span id="DisulfideClassGenerator-578"><a href="#DisulfideClassGenerator-578"><span class="linenos">578</span></a>                <span class="n">start_idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">max_classes_per_plot</span>
</span><span id="DisulfideClassGenerator-579"><a href="#DisulfideClassGenerator-579"><span class="linenos">579</span></a>                <span class="n">end_idx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">max_classes_per_plot</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="p">))</span>
</span><span id="DisulfideClassGenerator-580"><a href="#DisulfideClassGenerator-580"><span class="linenos">580</span></a>                <span class="n">subset_df</span> <span class="o">=</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator-581"><a href="#DisulfideClassGenerator-581"><span class="linenos">581</span></a>
</span><span id="DisulfideClassGenerator-582"><a href="#DisulfideClassGenerator-582"><span class="linenos">582</span></a>                <span class="c1"># Create plot title for this subset</span>
</span><span id="DisulfideClassGenerator-583"><a href="#DisulfideClassGenerator-583"><span class="linenos">583</span></a>                <span class="n">subset_title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">plot_title</span><span class="si">}</span><span class="s2"> (Part </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="n">num_plots</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="DisulfideClassGenerator-584"><a href="#DisulfideClassGenerator-584"><span class="linenos">584</span></a>                <span class="n">fname_prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">plot_title</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_part_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DisulfideClassGenerator-585"><a href="#DisulfideClassGenerator-585"><span class="linenos">585</span></a>                <span class="c1"># Create line plot for this subset</span>
</span><span id="DisulfideClassGenerator-586"><a href="#DisulfideClassGenerator-586"><span class="linenos">586</span></a>                <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_torsion_distance_by_class</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-587"><a href="#DisulfideClassGenerator-587"><span class="linenos">587</span></a>                    <span class="n">subset_df</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-588"><a href="#DisulfideClassGenerator-588"><span class="linenos">588</span></a>                    <span class="n">title</span><span class="o">=</span><span class="n">subset_title</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-589"><a href="#DisulfideClassGenerator-589"><span class="linenos">589</span></a>                    <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-590"><a href="#DisulfideClassGenerator-590"><span class="linenos">590</span></a>                    <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-591"><a href="#DisulfideClassGenerator-591"><span class="linenos">591</span></a>                    <span class="n">savedir</span><span class="o">=</span><span class="n">savedir</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-592"><a href="#DisulfideClassGenerator-592"><span class="linenos">592</span></a>                    <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-593"><a href="#DisulfideClassGenerator-593"><span class="linenos">593</span></a>                    <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-594"><a href="#DisulfideClassGenerator-594"><span class="linenos">594</span></a>                    <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-595"><a href="#DisulfideClassGenerator-595"><span class="linenos">595</span></a>                    <span class="n">fname_prefix</span><span class="o">=</span><span class="n">fname_prefix</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-596"><a href="#DisulfideClassGenerator-596"><span class="linenos">596</span></a>                <span class="p">)</span>
</span><span id="DisulfideClassGenerator-597"><a href="#DisulfideClassGenerator-597"><span class="linenos">597</span></a>
</span><span id="DisulfideClassGenerator-598"><a href="#DisulfideClassGenerator-598"><span class="linenos">598</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-599"><a href="#DisulfideClassGenerator-599"><span class="linenos">599</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-600"><a href="#DisulfideClassGenerator-600"><span class="linenos">600</span></a>        <span class="n">class_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-601"><a href="#DisulfideClassGenerator-601"><span class="linenos">601</span></a>        <span class="n">screenshot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-602"><a href="#DisulfideClassGenerator-602"><span class="linenos">602</span></a>        <span class="n">movie</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-603"><a href="#DisulfideClassGenerator-603"><span class="linenos">603</span></a>        <span class="n">fname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ss_overlay.png&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-604"><a href="#DisulfideClassGenerator-604"><span class="linenos">604</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator-605"><a href="#DisulfideClassGenerator-605"><span class="linenos">605</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-606"><a href="#DisulfideClassGenerator-606"><span class="linenos">606</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-607"><a href="#DisulfideClassGenerator-607"><span class="linenos">607</span></a><span class="sd">        Display disulfide overlay for a class.</span>
</span><span id="DisulfideClassGenerator-608"><a href="#DisulfideClassGenerator-608"><span class="linenos">608</span></a>
</span><span id="DisulfideClassGenerator-609"><a href="#DisulfideClassGenerator-609"><span class="linenos">609</span></a><span class="sd">        :param class_id: Class ID to display.</span>
</span><span id="DisulfideClassGenerator-610"><a href="#DisulfideClassGenerator-610"><span class="linenos">610</span></a><span class="sd">        :type class_id: str</span>
</span><span id="DisulfideClassGenerator-611"><a href="#DisulfideClassGenerator-611"><span class="linenos">611</span></a><span class="sd">        :param screenshot: Save a screenshot.</span>
</span><span id="DisulfideClassGenerator-612"><a href="#DisulfideClassGenerator-612"><span class="linenos">612</span></a><span class="sd">        :type screenshot: bool</span>
</span><span id="DisulfideClassGenerator-613"><a href="#DisulfideClassGenerator-613"><span class="linenos">613</span></a><span class="sd">        :param movie: Save a movie.</span>
</span><span id="DisulfideClassGenerator-614"><a href="#DisulfideClassGenerator-614"><span class="linenos">614</span></a><span class="sd">        :type movie: bool</span>
</span><span id="DisulfideClassGenerator-615"><a href="#DisulfideClassGenerator-615"><span class="linenos">615</span></a><span class="sd">        :param fname: Output filename.</span>
</span><span id="DisulfideClassGenerator-616"><a href="#DisulfideClassGenerator-616"><span class="linenos">616</span></a><span class="sd">        :type fname: str</span>
</span><span id="DisulfideClassGenerator-617"><a href="#DisulfideClassGenerator-617"><span class="linenos">617</span></a><span class="sd">        :param kwargs: Additional display options.</span>
</span><span id="DisulfideClassGenerator-618"><a href="#DisulfideClassGenerator-618"><span class="linenos">618</span></a><span class="sd">        :raises ValueError: If class not found or generation fails.</span>
</span><span id="DisulfideClassGenerator-619"><a href="#DisulfideClassGenerator-619"><span class="linenos">619</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator-620"><a href="#DisulfideClassGenerator-620"><span class="linenos">620</span></a>        <span class="n">base</span><span class="p">,</span> <span class="n">clean_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_class_string</span><span class="p">(</span><span class="n">class_id</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-621"><a href="#DisulfideClassGenerator-621"><span class="linenos">621</span></a>        <span class="n">target_dict</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DisulfideClassGenerator-622"><a href="#DisulfideClassGenerator-622"><span class="linenos">622</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span>
</span><span id="DisulfideClassGenerator-623"><a href="#DisulfideClassGenerator-623"><span class="linenos">623</span></a>            <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span>
</span><span id="DisulfideClassGenerator-624"><a href="#DisulfideClassGenerator-624"><span class="linenos">624</span></a>            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span>
</span><span id="DisulfideClassGenerator-625"><a href="#DisulfideClassGenerator-625"><span class="linenos">625</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassGenerator-626"><a href="#DisulfideClassGenerator-626"><span class="linenos">626</span></a>
</span><span id="DisulfideClassGenerator-627"><a href="#DisulfideClassGenerator-627"><span class="linenos">627</span></a>        <span class="k">if</span> <span class="n">clean_string</span> <span class="ow">in</span> <span class="n">target_dict</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-628"><a href="#DisulfideClassGenerator-628"><span class="linenos">628</span></a>            <span class="n">disulfide_list</span> <span class="o">=</span> <span class="n">target_dict</span><span class="p">[</span><span class="n">clean_string</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator-629"><a href="#DisulfideClassGenerator-629"><span class="linenos">629</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-630"><a href="#DisulfideClassGenerator-630"><span class="linenos">630</span></a>            <span class="n">disulfide_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_for_class</span><span class="p">(</span><span class="n">class_id</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-631"><a href="#DisulfideClassGenerator-631"><span class="linenos">631</span></a>            <span class="k">if</span> <span class="n">disulfide_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator-632"><a href="#DisulfideClassGenerator-632"><span class="linenos">632</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class </span><span class="si">{</span><span class="n">class_id</span><span class="si">}</span><span class="s2"> not found or failed to generate.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator-633"><a href="#DisulfideClassGenerator-633"><span class="linenos">633</span></a>
</span><span id="DisulfideClassGenerator-634"><a href="#DisulfideClassGenerator-634"><span class="linenos">634</span></a>        <span class="n">disulfide_list</span><span class="o">.</span><span class="n">display_overlay</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator-635"><a href="#DisulfideClassGenerator-635"><span class="linenos">635</span></a>            <span class="n">screenshot</span><span class="o">=</span><span class="n">screenshot</span><span class="p">,</span> <span class="n">movie</span><span class="o">=</span><span class="n">movie</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">fname</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="DisulfideClassGenerator-636"><a href="#DisulfideClassGenerator-636"><span class="linenos">636</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A class for generating disulfide conformations for structural classes based on
mean and standard deviation values for dihedral angles.</p>
</div>


                            <div id="DisulfideClassGenerator.__init__" class="classattr">
                                        <input id="DisulfideClassGenerator.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">DisulfideClassGenerator</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">csv_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">precalc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">csv_base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="DisulfideClassGenerator.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassGenerator.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassGenerator.__init__-89"><a href="#DisulfideClassGenerator.__init__-89"><span class="linenos"> 89</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator.__init__-90"><a href="#DisulfideClassGenerator.__init__-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.__init__-91"><a href="#DisulfideClassGenerator.__init__-91"><span class="linenos"> 91</span></a>        <span class="n">csv_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.__init__-92"><a href="#DisulfideClassGenerator.__init__-92"><span class="linenos"> 92</span></a>        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.__init__-93"><a href="#DisulfideClassGenerator.__init__-93"><span class="linenos"> 93</span></a>        <span class="n">precalc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.__init__-94"><a href="#DisulfideClassGenerator.__init__-94"><span class="linenos"> 94</span></a>        <span class="n">csv_base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.__init__-95"><a href="#DisulfideClassGenerator.__init__-95"><span class="linenos"> 95</span></a>    <span class="p">):</span>
</span><span id="DisulfideClassGenerator.__init__-96"><a href="#DisulfideClassGenerator.__init__-96"><span class="linenos"> 96</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.__init__-97"><a href="#DisulfideClassGenerator.__init__-97"><span class="linenos"> 97</span></a><span class="sd">        Initialize the DisulfideClassGenerator.</span>
</span><span id="DisulfideClassGenerator.__init__-98"><a href="#DisulfideClassGenerator.__init__-98"><span class="linenos"> 98</span></a>
</span><span id="DisulfideClassGenerator.__init__-99"><a href="#DisulfideClassGenerator.__init__-99"><span class="linenos"> 99</span></a><span class="sd">        :param csv_file: Path to CSV file with class metrics (optional).</span>
</span><span id="DisulfideClassGenerator.__init__-100"><a href="#DisulfideClassGenerator.__init__-100"><span class="linenos">100</span></a><span class="sd">        :type csv_file: str</span>
</span><span id="DisulfideClassGenerator.__init__-101"><a href="#DisulfideClassGenerator.__init__-101"><span class="linenos">101</span></a><span class="sd">        :param verbose: Enable debug logging and progress bars.</span>
</span><span id="DisulfideClassGenerator.__init__-102"><a href="#DisulfideClassGenerator.__init__-102"><span class="linenos">102</span></a><span class="sd">        :type verbose: bool</span>
</span><span id="DisulfideClassGenerator.__init__-103"><a href="#DisulfideClassGenerator.__init__-103"><span class="linenos">103</span></a><span class="sd">        :param precalc: Pre-calculate disulfides for all classes.</span>
</span><span id="DisulfideClassGenerator.__init__-104"><a href="#DisulfideClassGenerator.__init__-104"><span class="linenos">104</span></a><span class="sd">        :type precalc: bool</span>
</span><span id="DisulfideClassGenerator.__init__-105"><a href="#DisulfideClassGenerator.__init__-105"><span class="linenos">105</span></a><span class="sd">        :param csv_base: Base for CSV data (2 or 8, optional).</span>
</span><span id="DisulfideClassGenerator.__init__-106"><a href="#DisulfideClassGenerator.__init__-106"><span class="linenos">106</span></a><span class="sd">        :type csv_base: int</span>
</span><span id="DisulfideClassGenerator.__init__-107"><a href="#DisulfideClassGenerator.__init__-107"><span class="linenos">107</span></a><span class="sd">        :raises ValueError: If no valid data source is provided.</span>
</span><span id="DisulfideClassGenerator.__init__-108"><a href="#DisulfideClassGenerator.__init__-108"><span class="linenos">108</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.__init__-109"><a href="#DisulfideClassGenerator.__init__-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="DisulfideClassGenerator.__init__-110"><a href="#DisulfideClassGenerator.__init__-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DisulfideList</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideClassGenerator.__init__-111"><a href="#DisulfideClassGenerator.__init__-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DisulfideList</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideClassGenerator.__init__-112"><a href="#DisulfideClassGenerator.__init__-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClassGenerator.__init__-113"><a href="#DisulfideClassGenerator.__init__-113"><span class="linenos">113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClassGenerator.__init__-114"><a href="#DisulfideClassGenerator.__init__-114"><span class="linenos">114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClassGenerator.__init__-115"><a href="#DisulfideClassGenerator.__init__-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClassGenerator.__init__-116"><a href="#DisulfideClassGenerator.__init__-116"><span class="linenos">116</span></a>
</span><span id="DisulfideClassGenerator.__init__-117"><a href="#DisulfideClassGenerator.__init__-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_data</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">csv_base</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.__init__-118"><a href="#DisulfideClassGenerator.__init__-118"><span class="linenos">118</span></a>        <span class="k">if</span> <span class="n">precalc</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.__init__-119"><a href="#DisulfideClassGenerator.__init__-119"><span class="linenos">119</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">generate_for_all_classes</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the DisulfideClassGenerator.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>csv_file</strong>:  Path to CSV file with class metrics (optional).</li>
<li><strong>verbose</strong>:  Enable debug logging and progress bars.</li>
<li><strong>precalc</strong>:  Pre-calculate disulfides for all classes.</li>
<li><strong>csv_base</strong>:  Base for CSV data (2 or 8, optional).</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>:  If no valid data source is provided.</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideClassGenerator.parse_class_string" class="classattr">
                                        <input id="DisulfideClassGenerator.parse_class_string-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">parse_class_string</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">class_str</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassGenerator.parse_class_string-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassGenerator.parse_class_string"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassGenerator.parse_class_string-57"><a href="#DisulfideClassGenerator.parse_class_string-57"><span class="linenos">57</span></a>    <span class="nd">@staticmethod</span>
</span><span id="DisulfideClassGenerator.parse_class_string-58"><a href="#DisulfideClassGenerator.parse_class_string-58"><span class="linenos">58</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parse_class_string</span><span class="p">(</span><span class="n">class_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="DisulfideClassGenerator.parse_class_string-59"><a href="#DisulfideClassGenerator.parse_class_string-59"><span class="linenos">59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.parse_class_string-60"><a href="#DisulfideClassGenerator.parse_class_string-60"><span class="linenos">60</span></a><span class="sd">        Parse a class string to determine its base and return the string without suffixes.</span>
</span><span id="DisulfideClassGenerator.parse_class_string-61"><a href="#DisulfideClassGenerator.parse_class_string-61"><span class="linenos">61</span></a>
</span><span id="DisulfideClassGenerator.parse_class_string-62"><a href="#DisulfideClassGenerator.parse_class_string-62"><span class="linenos">62</span></a><span class="sd">        :param class_str: The class string (e.g., &quot;11111&quot;, &quot;11111b&quot;, &quot;+-+-+&quot;).</span>
</span><span id="DisulfideClassGenerator.parse_class_string-63"><a href="#DisulfideClassGenerator.parse_class_string-63"><span class="linenos">63</span></a><span class="sd">        :type class_str: str</span>
</span><span id="DisulfideClassGenerator.parse_class_string-64"><a href="#DisulfideClassGenerator.parse_class_string-64"><span class="linenos">64</span></a><span class="sd">        :return: Tuple of (base, clean_string) where base is 2 (binary) or 8 (octant).</span>
</span><span id="DisulfideClassGenerator.parse_class_string-65"><a href="#DisulfideClassGenerator.parse_class_string-65"><span class="linenos">65</span></a><span class="sd">        :rtype: Tuple[int, str]</span>
</span><span id="DisulfideClassGenerator.parse_class_string-66"><a href="#DisulfideClassGenerator.parse_class_string-66"><span class="linenos">66</span></a><span class="sd">        :raises ValueError: If the class string format is invalid.</span>
</span><span id="DisulfideClassGenerator.parse_class_string-67"><a href="#DisulfideClassGenerator.parse_class_string-67"><span class="linenos">67</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.parse_class_string-68"><a href="#DisulfideClassGenerator.parse_class_string-68"><span class="linenos">68</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">class_str</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="DisulfideClassGenerator.parse_class_string-69"><a href="#DisulfideClassGenerator.parse_class_string-69"><span class="linenos">69</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class string must be a string, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">class_str</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.parse_class_string-70"><a href="#DisulfideClassGenerator.parse_class_string-70"><span class="linenos">70</span></a>
</span><span id="DisulfideClassGenerator.parse_class_string-71"><a href="#DisulfideClassGenerator.parse_class_string-71"><span class="linenos">71</span></a>        <span class="n">base</span> <span class="o">=</span> <span class="n">OCTANT_BASE</span>  <span class="c1"># Default to octant</span>
</span><span id="DisulfideClassGenerator.parse_class_string-72"><a href="#DisulfideClassGenerator.parse_class_string-72"><span class="linenos">72</span></a>        <span class="n">clean_string</span> <span class="o">=</span> <span class="n">class_str</span>
</span><span id="DisulfideClassGenerator.parse_class_string-73"><a href="#DisulfideClassGenerator.parse_class_string-73"><span class="linenos">73</span></a>
</span><span id="DisulfideClassGenerator.parse_class_string-74"><a href="#DisulfideClassGenerator.parse_class_string-74"><span class="linenos">74</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_str</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.parse_class_string-75"><a href="#DisulfideClassGenerator.parse_class_string-75"><span class="linenos">75</span></a>            <span class="k">if</span> <span class="n">class_str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.parse_class_string-76"><a href="#DisulfideClassGenerator.parse_class_string-76"><span class="linenos">76</span></a>                <span class="n">base</span> <span class="o">=</span> <span class="n">BINARY_BASE</span>
</span><span id="DisulfideClassGenerator.parse_class_string-77"><a href="#DisulfideClassGenerator.parse_class_string-77"><span class="linenos">77</span></a>                <span class="n">clean_string</span> <span class="o">=</span> <span class="n">class_str</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator.parse_class_string-78"><a href="#DisulfideClassGenerator.parse_class_string-78"><span class="linenos">78</span></a>            <span class="k">elif</span> <span class="n">class_str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;o&quot;</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.parse_class_string-79"><a href="#DisulfideClassGenerator.parse_class_string-79"><span class="linenos">79</span></a>                <span class="n">base</span> <span class="o">=</span> <span class="n">OCTANT_BASE</span>
</span><span id="DisulfideClassGenerator.parse_class_string-80"><a href="#DisulfideClassGenerator.parse_class_string-80"><span class="linenos">80</span></a>                <span class="n">clean_string</span> <span class="o">=</span> <span class="n">class_str</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator.parse_class_string-81"><a href="#DisulfideClassGenerator.parse_class_string-81"><span class="linenos">81</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.parse_class_string-82"><a href="#DisulfideClassGenerator.parse_class_string-82"><span class="linenos">82</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid suffix in class string: </span><span class="si">{</span><span class="n">class_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.parse_class_string-83"><a href="#DisulfideClassGenerator.parse_class_string-83"><span class="linenos">83</span></a>        <span class="k">elif</span> <span class="s2">&quot;+&quot;</span> <span class="ow">in</span> <span class="n">class_str</span> <span class="ow">or</span> <span class="s2">&quot;-&quot;</span> <span class="ow">in</span> <span class="n">class_str</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.parse_class_string-84"><a href="#DisulfideClassGenerator.parse_class_string-84"><span class="linenos">84</span></a>            <span class="n">base</span> <span class="o">=</span> <span class="n">BINARY_BASE</span>
</span><span id="DisulfideClassGenerator.parse_class_string-85"><a href="#DisulfideClassGenerator.parse_class_string-85"><span class="linenos">85</span></a>            <span class="n">clean_string</span> <span class="o">=</span> <span class="n">class_str</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator.parse_class_string-86"><a href="#DisulfideClassGenerator.parse_class_string-86"><span class="linenos">86</span></a>
</span><span id="DisulfideClassGenerator.parse_class_string-87"><a href="#DisulfideClassGenerator.parse_class_string-87"><span class="linenos">87</span></a>        <span class="k">return</span> <span class="n">base</span><span class="p">,</span> <span class="n">clean_string</span>
</span></pre></div>


            <div class="docstring"><p>Parse a class string to determine its base and return the string without suffixes.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>class_str</strong>:  The class string (e.g., "11111", "11111b", "+-+-+").</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Tuple of (base, clean_string) where base is 2 (binary) or 8 (octant).</p>
</blockquote>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>:  If the class string format is invalid.</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideClassGenerator.verbose" class="classattr">
                                <div class="attr variable">
            <span class="name">verbose</span>

        
    </div>
    <a class="headerlink" href="#DisulfideClassGenerator.verbose"></a>
    
    

                            </div>
                            <div id="DisulfideClassGenerator.binary_class_disulfides" class="classattr">
                                <div class="attr variable">
            <span class="name">binary_class_disulfides</span><span class="annotation">: Dict[str, <a href="DisulfideBase.html#DisulfideList">proteusPy.DisulfideBase.DisulfideList</a>]</span>

        
    </div>
    <a class="headerlink" href="#DisulfideClassGenerator.binary_class_disulfides"></a>
    
    

                            </div>
                            <div id="DisulfideClassGenerator.octant_class_disulfides" class="classattr">
                                <div class="attr variable">
            <span class="name">octant_class_disulfides</span><span class="annotation">: Dict[str, <a href="DisulfideBase.html#DisulfideList">proteusPy.DisulfideBase.DisulfideList</a>]</span>

        
    </div>
    <a class="headerlink" href="#DisulfideClassGenerator.octant_class_disulfides"></a>
    
    

                            </div>
                            <div id="DisulfideClassGenerator.df" class="classattr">
                                <div class="attr variable">
            <span class="name">df</span>

        
    </div>
    <a class="headerlink" href="#DisulfideClassGenerator.df"></a>
    
    

                            </div>
                            <div id="DisulfideClassGenerator.binary_df" class="classattr">
                                <div class="attr variable">
            <span class="name">binary_df</span>

        
    </div>
    <a class="headerlink" href="#DisulfideClassGenerator.binary_df"></a>
    
    

                            </div>
                            <div id="DisulfideClassGenerator.octant_df" class="classattr">
                                <div class="attr variable">
            <span class="name">octant_df</span>

        
    </div>
    <a class="headerlink" href="#DisulfideClassGenerator.octant_df"></a>
    
    

                            </div>
                            <div id="DisulfideClassGenerator.base" class="classattr">
                                <div class="attr variable">
            <span class="name">base</span>

        
    </div>
    <a class="headerlink" href="#DisulfideClassGenerator.base"></a>
    
    

                            </div>
                            <div id="DisulfideClassGenerator.load_csv" class="classattr">
                                        <input id="DisulfideClassGenerator.load_csv-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_csv</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">csv_file</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#DisulfideClassGenerator">DisulfideClassGenerator</a></span>:</span></span>

                <label class="view-source-button" for="DisulfideClassGenerator.load_csv-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassGenerator.load_csv"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassGenerator.load_csv-172"><a href="#DisulfideClassGenerator.load_csv-172"><span class="linenos">172</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csv_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DisulfideClassGenerator&quot;</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.load_csv-173"><a href="#DisulfideClassGenerator.load_csv-173"><span class="linenos">173</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.load_csv-174"><a href="#DisulfideClassGenerator.load_csv-174"><span class="linenos">174</span></a><span class="sd">        Load class metrics from a CSV file.</span>
</span><span id="DisulfideClassGenerator.load_csv-175"><a href="#DisulfideClassGenerator.load_csv-175"><span class="linenos">175</span></a>
</span><span id="DisulfideClassGenerator.load_csv-176"><a href="#DisulfideClassGenerator.load_csv-176"><span class="linenos">176</span></a><span class="sd">        :param csv_file: Path to CSV file.</span>
</span><span id="DisulfideClassGenerator.load_csv-177"><a href="#DisulfideClassGenerator.load_csv-177"><span class="linenos">177</span></a><span class="sd">        :type csv_file: str</span>
</span><span id="DisulfideClassGenerator.load_csv-178"><a href="#DisulfideClassGenerator.load_csv-178"><span class="linenos">178</span></a><span class="sd">        :param base: Base class (2 or 8, optional).</span>
</span><span id="DisulfideClassGenerator.load_csv-179"><a href="#DisulfideClassGenerator.load_csv-179"><span class="linenos">179</span></a><span class="sd">        :type base: int</span>
</span><span id="DisulfideClassGenerator.load_csv-180"><a href="#DisulfideClassGenerator.load_csv-180"><span class="linenos">180</span></a><span class="sd">        :return: Self for method chaining.</span>
</span><span id="DisulfideClassGenerator.load_csv-181"><a href="#DisulfideClassGenerator.load_csv-181"><span class="linenos">181</span></a><span class="sd">        :rtype: DisulfideClassGenerator</span>
</span><span id="DisulfideClassGenerator.load_csv-182"><a href="#DisulfideClassGenerator.load_csv-182"><span class="linenos">182</span></a><span class="sd">        :raises ValueError: If base is invalid.</span>
</span><span id="DisulfideClassGenerator.load_csv-183"><a href="#DisulfideClassGenerator.load_csv-183"><span class="linenos">183</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.load_csv-184"><a href="#DisulfideClassGenerator.load_csv-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;class_str&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">})</span>
</span><span id="DisulfideClassGenerator.load_csv-185"><a href="#DisulfideClassGenerator.load_csv-185"><span class="linenos">185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base</span> <span class="o">=</span> <span class="n">base</span>
</span><span id="DisulfideClassGenerator.load_csv-186"><a href="#DisulfideClassGenerator.load_csv-186"><span class="linenos">186</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.load_csv-187"><a href="#DisulfideClassGenerator.load_csv-187"><span class="linenos">187</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span>
</span><span id="DisulfideClassGenerator.load_csv-188"><a href="#DisulfideClassGenerator.load_csv-188"><span class="linenos">188</span></a>        <span class="k">elif</span> <span class="n">base</span> <span class="o">==</span> <span class="n">OCTANT_BASE</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.load_csv-189"><a href="#DisulfideClassGenerator.load_csv-189"><span class="linenos">189</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span>
</span><span id="DisulfideClassGenerator.load_csv-190"><a href="#DisulfideClassGenerator.load_csv-190"><span class="linenos">190</span></a>        <span class="k">elif</span> <span class="n">base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.load_csv-191"><a href="#DisulfideClassGenerator.load_csv-191"><span class="linenos">191</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid base: </span><span class="si">{</span><span class="n">base</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.load_csv-192"><a href="#DisulfideClassGenerator.load_csv-192"><span class="linenos">192</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Load class metrics from a CSV file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>csv_file</strong>:  Path to CSV file.</li>
<li><strong>base</strong>:  Base class (2 or 8, optional).</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Self for method chaining.</p>
</blockquote>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>:  If base is invalid.</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideClassGenerator.class_to_sslist" class="classattr">
                                        <input id="DisulfideClassGenerator.class_to_sslist-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">class_to_sslist</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">clsid</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span></span><span class="return-annotation">) -> <span class="n"><a href="DisulfideBase.html#DisulfideList">proteusPy.DisulfideBase.DisulfideList</a></span>:</span></span>

                <label class="view-source-button" for="DisulfideClassGenerator.class_to_sslist-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassGenerator.class_to_sslist"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassGenerator.class_to_sslist-194"><a href="#DisulfideClassGenerator.class_to_sslist-194"><span class="linenos">194</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">class_to_sslist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clsid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">OCTANT_BASE</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-195"><a href="#DisulfideClassGenerator.class_to_sslist-195"><span class="linenos">195</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-196"><a href="#DisulfideClassGenerator.class_to_sslist-196"><span class="linenos">196</span></a><span class="sd">        Retrieve disulfide list for a given class ID.</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-197"><a href="#DisulfideClassGenerator.class_to_sslist-197"><span class="linenos">197</span></a>
</span><span id="DisulfideClassGenerator.class_to_sslist-198"><a href="#DisulfideClassGenerator.class_to_sslist-198"><span class="linenos">198</span></a><span class="sd">        :param clsid: Class ID (e.g., &quot;11111&quot;, &quot;11111b&quot;).</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-199"><a href="#DisulfideClassGenerator.class_to_sslist-199"><span class="linenos">199</span></a><span class="sd">        :type clsid: str</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-200"><a href="#DisulfideClassGenerator.class_to_sslist-200"><span class="linenos">200</span></a><span class="sd">        :param base: Base class (2 or 8).</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-201"><a href="#DisulfideClassGenerator.class_to_sslist-201"><span class="linenos">201</span></a><span class="sd">        :type base: int</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-202"><a href="#DisulfideClassGenerator.class_to_sslist-202"><span class="linenos">202</span></a><span class="sd">        :return: DisulfideList for the class.</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-203"><a href="#DisulfideClassGenerator.class_to_sslist-203"><span class="linenos">203</span></a><span class="sd">        :rtype: DisulfideList</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-204"><a href="#DisulfideClassGenerator.class_to_sslist-204"><span class="linenos">204</span></a><span class="sd">        :raises ValueError: If clsid is invalid.</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-205"><a href="#DisulfideClassGenerator.class_to_sslist-205"><span class="linenos">205</span></a><span class="sd">        :raises KeyError: If class not found.</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-206"><a href="#DisulfideClassGenerator.class_to_sslist-206"><span class="linenos">206</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-207"><a href="#DisulfideClassGenerator.class_to_sslist-207"><span class="linenos">207</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">clsid</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-208"><a href="#DisulfideClassGenerator.class_to_sslist-208"><span class="linenos">208</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Class ID must be a string, got </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">clsid</span><span class="p">))</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-209"><a href="#DisulfideClassGenerator.class_to_sslist-209"><span class="linenos">209</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid class ID type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">clsid</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-210"><a href="#DisulfideClassGenerator.class_to_sslist-210"><span class="linenos">210</span></a>
</span><span id="DisulfideClassGenerator.class_to_sslist-211"><a href="#DisulfideClassGenerator.class_to_sslist-211"><span class="linenos">211</span></a>        <span class="n">parsed_base</span><span class="p">,</span> <span class="n">clean_cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_class_string</span><span class="p">(</span><span class="n">clsid</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-212"><a href="#DisulfideClassGenerator.class_to_sslist-212"><span class="linenos">212</span></a>        <span class="n">base</span> <span class="o">=</span> <span class="n">parsed_base</span> <span class="k">if</span> <span class="n">parsed_base</span> <span class="k">else</span> <span class="n">base</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-213"><a href="#DisulfideClassGenerator.class_to_sslist-213"><span class="linenos">213</span></a>        <span class="n">target_dict</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-214"><a href="#DisulfideClassGenerator.class_to_sslist-214"><span class="linenos">214</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-215"><a href="#DisulfideClassGenerator.class_to_sslist-215"><span class="linenos">215</span></a>            <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-216"><a href="#DisulfideClassGenerator.class_to_sslist-216"><span class="linenos">216</span></a>            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-217"><a href="#DisulfideClassGenerator.class_to_sslist-217"><span class="linenos">217</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-218"><a href="#DisulfideClassGenerator.class_to_sslist-218"><span class="linenos">218</span></a>
</span><span id="DisulfideClassGenerator.class_to_sslist-219"><a href="#DisulfideClassGenerator.class_to_sslist-219"><span class="linenos">219</span></a>        <span class="k">if</span> <span class="n">clean_cls</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">target_dict</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-220"><a href="#DisulfideClassGenerator.class_to_sslist-220"><span class="linenos">220</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-221"><a href="#DisulfideClassGenerator.class_to_sslist-221"><span class="linenos">221</span></a>                <span class="s2">&quot;Class </span><span class="si">%s</span><span class="s2"> not found in </span><span class="si">%s</span><span class="s2"> disulfides&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-222"><a href="#DisulfideClassGenerator.class_to_sslist-222"><span class="linenos">222</span></a>                <span class="n">clsid</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-223"><a href="#DisulfideClassGenerator.class_to_sslist-223"><span class="linenos">223</span></a>                <span class="s2">&quot;binary&quot;</span> <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span> <span class="k">else</span> <span class="s2">&quot;octant&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-224"><a href="#DisulfideClassGenerator.class_to_sslist-224"><span class="linenos">224</span></a>            <span class="p">)</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-225"><a href="#DisulfideClassGenerator.class_to_sslist-225"><span class="linenos">225</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class </span><span class="si">{</span><span class="n">clsid</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.class_to_sslist-226"><a href="#DisulfideClassGenerator.class_to_sslist-226"><span class="linenos">226</span></a>
</span><span id="DisulfideClassGenerator.class_to_sslist-227"><a href="#DisulfideClassGenerator.class_to_sslist-227"><span class="linenos">227</span></a>        <span class="k">return</span> <span class="n">target_dict</span><span class="p">[</span><span class="n">clean_cls</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve disulfide list for a given class ID.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>clsid</strong>:  Class ID (e.g., "11111", "11111b").</li>
<li><strong>base</strong>:  Base class (2 or 8).</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>DisulfideList for the class.</p>
</blockquote>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>:  If clsid is invalid.</li>
<li><strong>KeyError</strong>:  If class not found.</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideClassGenerator.generate_for_class" class="classattr">
                                        <input id="DisulfideClassGenerator.generate_for_class-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_for_class</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">class_id</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="DisulfideBase.html#DisulfideList">proteusPy.DisulfideBase.DisulfideList</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassGenerator.generate_for_class-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassGenerator.generate_for_class"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassGenerator.generate_for_class-252"><a href="#DisulfideClassGenerator.generate_for_class-252"><span class="linenos">252</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_for_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">DisulfideList</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
</span><span id="DisulfideClassGenerator.generate_for_class-253"><a href="#DisulfideClassGenerator.generate_for_class-253"><span class="linenos">253</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.generate_for_class-254"><a href="#DisulfideClassGenerator.generate_for_class-254"><span class="linenos">254</span></a><span class="sd">        Generate disulfides for a specific class.</span>
</span><span id="DisulfideClassGenerator.generate_for_class-255"><a href="#DisulfideClassGenerator.generate_for_class-255"><span class="linenos">255</span></a>
</span><span id="DisulfideClassGenerator.generate_for_class-256"><a href="#DisulfideClassGenerator.generate_for_class-256"><span class="linenos">256</span></a><span class="sd">        :param class_id: Class ID (e.g., &quot;11111b&quot;).</span>
</span><span id="DisulfideClassGenerator.generate_for_class-257"><a href="#DisulfideClassGenerator.generate_for_class-257"><span class="linenos">257</span></a><span class="sd">        :type class_id: str</span>
</span><span id="DisulfideClassGenerator.generate_for_class-258"><a href="#DisulfideClassGenerator.generate_for_class-258"><span class="linenos">258</span></a><span class="sd">        :return: DisulfideList or None if class not found.</span>
</span><span id="DisulfideClassGenerator.generate_for_class-259"><a href="#DisulfideClassGenerator.generate_for_class-259"><span class="linenos">259</span></a><span class="sd">        :rtype: Union[DisulfideList, None]</span>
</span><span id="DisulfideClassGenerator.generate_for_class-260"><a href="#DisulfideClassGenerator.generate_for_class-260"><span class="linenos">260</span></a><span class="sd">        :raises ValueError: If no DataFrame is loaded.</span>
</span><span id="DisulfideClassGenerator.generate_for_class-261"><a href="#DisulfideClassGenerator.generate_for_class-261"><span class="linenos">261</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.generate_for_class-262"><a href="#DisulfideClassGenerator.generate_for_class-262"><span class="linenos">262</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.generate_for_class-263"><a href="#DisulfideClassGenerator.generate_for_class-263"><span class="linenos">263</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No DataFrame loaded.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.generate_for_class-264"><a href="#DisulfideClassGenerator.generate_for_class-264"><span class="linenos">264</span></a>
</span><span id="DisulfideClassGenerator.generate_for_class-265"><a href="#DisulfideClassGenerator.generate_for_class-265"><span class="linenos">265</span></a>        <span class="n">base</span><span class="p">,</span> <span class="n">clean_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_class_string</span><span class="p">(</span><span class="n">class_id</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.generate_for_class-266"><a href="#DisulfideClassGenerator.generate_for_class-266"><span class="linenos">266</span></a>        <span class="n">df_to_use</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span> <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span>
</span><span id="DisulfideClassGenerator.generate_for_class-267"><a href="#DisulfideClassGenerator.generate_for_class-267"><span class="linenos">267</span></a>
</span><span id="DisulfideClassGenerator.generate_for_class-268"><a href="#DisulfideClassGenerator.generate_for_class-268"><span class="linenos">268</span></a>        <span class="k">if</span> <span class="n">df_to_use</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.generate_for_class-269"><a href="#DisulfideClassGenerator.generate_for_class-269"><span class="linenos">269</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator.generate_for_class-270"><a href="#DisulfideClassGenerator.generate_for_class-270"><span class="linenos">270</span></a>                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> DataFrame not available.&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.generate_for_class-271"><a href="#DisulfideClassGenerator.generate_for_class-271"><span class="linenos">271</span></a>                <span class="s2">&quot;Binary&quot;</span> <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span> <span class="k">else</span> <span class="s2">&quot;Octant&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.generate_for_class-272"><a href="#DisulfideClassGenerator.generate_for_class-272"><span class="linenos">272</span></a>            <span class="p">)</span>
</span><span id="DisulfideClassGenerator.generate_for_class-273"><a href="#DisulfideClassGenerator.generate_for_class-273"><span class="linenos">273</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="DisulfideClassGenerator.generate_for_class-274"><a href="#DisulfideClassGenerator.generate_for_class-274"><span class="linenos">274</span></a>
</span><span id="DisulfideClassGenerator.generate_for_class-275"><a href="#DisulfideClassGenerator.generate_for_class-275"><span class="linenos">275</span></a>        <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;class_str&quot;</span> <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span> <span class="k">else</span> <span class="s2">&quot;class&quot;</span>
</span><span id="DisulfideClassGenerator.generate_for_class-276"><a href="#DisulfideClassGenerator.generate_for_class-276"><span class="linenos">276</span></a>        <span class="n">row</span> <span class="o">=</span> <span class="n">df_to_use</span><span class="p">[</span><span class="n">df_to_use</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="n">clean_string</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator.generate_for_class-277"><a href="#DisulfideClassGenerator.generate_for_class-277"><span class="linenos">277</span></a>        <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.generate_for_class-278"><a href="#DisulfideClassGenerator.generate_for_class-278"><span class="linenos">278</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Class </span><span class="si">%s</span><span class="s2"> not found.&quot;</span><span class="p">,</span> <span class="n">class_id</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.generate_for_class-279"><a href="#DisulfideClassGenerator.generate_for_class-279"><span class="linenos">279</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="DisulfideClassGenerator.generate_for_class-280"><a href="#DisulfideClassGenerator.generate_for_class-280"><span class="linenos">280</span></a>
</span><span id="DisulfideClassGenerator.generate_for_class-281"><a href="#DisulfideClassGenerator.generate_for_class-281"><span class="linenos">281</span></a>        <span class="n">row_data</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator.generate_for_class-282"><a href="#DisulfideClassGenerator.generate_for_class-282"><span class="linenos">282</span></a>        <span class="n">chi_means</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator.generate_for_class-283"><a href="#DisulfideClassGenerator.generate_for_class-283"><span class="linenos">283</span></a>            <span class="n">row_data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;chi</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_mean&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">NUM_DIHEDRAL_ANGLES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.generate_for_class-284"><a href="#DisulfideClassGenerator.generate_for_class-284"><span class="linenos">284</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassGenerator.generate_for_class-285"><a href="#DisulfideClassGenerator.generate_for_class-285"><span class="linenos">285</span></a>        <span class="n">chi_stds</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator.generate_for_class-286"><a href="#DisulfideClassGenerator.generate_for_class-286"><span class="linenos">286</span></a>            <span class="n">row_data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;chi</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_std&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">NUM_DIHEDRAL_ANGLES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.generate_for_class-287"><a href="#DisulfideClassGenerator.generate_for_class-287"><span class="linenos">287</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassGenerator.generate_for_class-288"><a href="#DisulfideClassGenerator.generate_for_class-288"><span class="linenos">288</span></a>        <span class="n">disulfide_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_disulfides_for_class</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator.generate_for_class-289"><a href="#DisulfideClassGenerator.generate_for_class-289"><span class="linenos">289</span></a>            <span class="n">clean_string</span><span class="p">,</span> <span class="n">chi_means</span><span class="p">,</span> <span class="n">chi_stds</span>
</span><span id="DisulfideClassGenerator.generate_for_class-290"><a href="#DisulfideClassGenerator.generate_for_class-290"><span class="linenos">290</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassGenerator.generate_for_class-291"><a href="#DisulfideClassGenerator.generate_for_class-291"><span class="linenos">291</span></a>
</span><span id="DisulfideClassGenerator.generate_for_class-292"><a href="#DisulfideClassGenerator.generate_for_class-292"><span class="linenos">292</span></a>        <span class="n">target_dict</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DisulfideClassGenerator.generate_for_class-293"><a href="#DisulfideClassGenerator.generate_for_class-293"><span class="linenos">293</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span>
</span><span id="DisulfideClassGenerator.generate_for_class-294"><a href="#DisulfideClassGenerator.generate_for_class-294"><span class="linenos">294</span></a>            <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span>
</span><span id="DisulfideClassGenerator.generate_for_class-295"><a href="#DisulfideClassGenerator.generate_for_class-295"><span class="linenos">295</span></a>            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span>
</span><span id="DisulfideClassGenerator.generate_for_class-296"><a href="#DisulfideClassGenerator.generate_for_class-296"><span class="linenos">296</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassGenerator.generate_for_class-297"><a href="#DisulfideClassGenerator.generate_for_class-297"><span class="linenos">297</span></a>        <span class="n">target_dict</span><span class="p">[</span><span class="n">clean_string</span><span class="p">]</span> <span class="o">=</span> <span class="n">disulfide_list</span>
</span><span id="DisulfideClassGenerator.generate_for_class-298"><a href="#DisulfideClassGenerator.generate_for_class-298"><span class="linenos">298</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator.generate_for_class-299"><a href="#DisulfideClassGenerator.generate_for_class-299"><span class="linenos">299</span></a>            <span class="s2">&quot;Generated </span><span class="si">%d</span><span class="s2"> disulfides for class </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">disulfide_list</span><span class="p">),</span> <span class="n">class_id</span>
</span><span id="DisulfideClassGenerator.generate_for_class-300"><a href="#DisulfideClassGenerator.generate_for_class-300"><span class="linenos">300</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassGenerator.generate_for_class-301"><a href="#DisulfideClassGenerator.generate_for_class-301"><span class="linenos">301</span></a>        <span class="k">return</span> <span class="n">disulfide_list</span>
</span></pre></div>


            <div class="docstring"><p>Generate disulfides for a specific class.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>class_id</strong>:  Class ID (e.g., "11111b").</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>DisulfideList or None if class not found.</p>
</blockquote>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>:  If no DataFrame is loaded.</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideClassGenerator.generate_for_selected_classes" class="classattr">
                                        <input id="DisulfideClassGenerator.generate_for_selected_classes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_for_selected_classes</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">class_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n"><a href="DisulfideBase.html#DisulfideList">proteusPy.DisulfideBase.DisulfideList</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassGenerator.generate_for_selected_classes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassGenerator.generate_for_selected_classes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassGenerator.generate_for_selected_classes-303"><a href="#DisulfideClassGenerator.generate_for_selected_classes-303"><span class="linenos">303</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_for_selected_classes</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-304"><a href="#DisulfideClassGenerator.generate_for_selected_classes-304"><span class="linenos">304</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">class_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-305"><a href="#DisulfideClassGenerator.generate_for_selected_classes-305"><span class="linenos">305</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DisulfideList</span><span class="p">]:</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-306"><a href="#DisulfideClassGenerator.generate_for_selected_classes-306"><span class="linenos">306</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-307"><a href="#DisulfideClassGenerator.generate_for_selected_classes-307"><span class="linenos">307</span></a><span class="sd">        Generate disulfides for multiple classes in parallel.</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-308"><a href="#DisulfideClassGenerator.generate_for_selected_classes-308"><span class="linenos">308</span></a>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-309"><a href="#DisulfideClassGenerator.generate_for_selected_classes-309"><span class="linenos">309</span></a><span class="sd">        :param class_ids: List of class IDs.</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-310"><a href="#DisulfideClassGenerator.generate_for_selected_classes-310"><span class="linenos">310</span></a><span class="sd">        :type class_ids: List[str]</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-311"><a href="#DisulfideClassGenerator.generate_for_selected_classes-311"><span class="linenos">311</span></a><span class="sd">        :return: Dictionary mapping class IDs to DisulfideLists.</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-312"><a href="#DisulfideClassGenerator.generate_for_selected_classes-312"><span class="linenos">312</span></a><span class="sd">        :rtype: Dict[str, DisulfideList]</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-313"><a href="#DisulfideClassGenerator.generate_for_selected_classes-313"><span class="linenos">313</span></a><span class="sd">        :raises ValueError: If no DataFrame is loaded.</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-314"><a href="#DisulfideClassGenerator.generate_for_selected_classes-314"><span class="linenos">314</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-315"><a href="#DisulfideClassGenerator.generate_for_selected_classes-315"><span class="linenos">315</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-316"><a href="#DisulfideClassGenerator.generate_for_selected_classes-316"><span class="linenos">316</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No DataFrame loaded.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-317"><a href="#DisulfideClassGenerator.generate_for_selected_classes-317"><span class="linenos">317</span></a>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-318"><a href="#DisulfideClassGenerator.generate_for_selected_classes-318"><span class="linenos">318</span></a>        <span class="n">class_disulfides</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-319"><a href="#DisulfideClassGenerator.generate_for_selected_classes-319"><span class="linenos">319</span></a>        <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">()</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-320"><a href="#DisulfideClassGenerator.generate_for_selected_classes-320"><span class="linenos">320</span></a>            <span class="n">futures</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-321"><a href="#DisulfideClassGenerator.generate_for_selected_classes-321"><span class="linenos">321</span></a>                <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generate_for_class</span><span class="p">,</span> <span class="n">cid</span><span class="p">):</span> <span class="n">cid</span> <span class="k">for</span> <span class="n">cid</span> <span class="ow">in</span> <span class="n">class_ids</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-322"><a href="#DisulfideClassGenerator.generate_for_selected_classes-322"><span class="linenos">322</span></a>            <span class="p">}</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-323"><a href="#DisulfideClassGenerator.generate_for_selected_classes-323"><span class="linenos">323</span></a>            <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-324"><a href="#DisulfideClassGenerator.generate_for_selected_classes-324"><span class="linenos">324</span></a>                <span class="n">futures</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Generating classes&quot;</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-325"><a href="#DisulfideClassGenerator.generate_for_selected_classes-325"><span class="linenos">325</span></a>            <span class="p">):</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-326"><a href="#DisulfideClassGenerator.generate_for_selected_classes-326"><span class="linenos">326</span></a>                <span class="n">class_id</span> <span class="o">=</span> <span class="n">futures</span><span class="p">[</span><span class="n">future</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-327"><a href="#DisulfideClassGenerator.generate_for_selected_classes-327"><span class="linenos">327</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">_result</span> <span class="o">:=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">())</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-328"><a href="#DisulfideClassGenerator.generate_for_selected_classes-328"><span class="linenos">328</span></a>                    <span class="n">class_disulfides</span><span class="p">[</span><span class="n">class_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">_result</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-329"><a href="#DisulfideClassGenerator.generate_for_selected_classes-329"><span class="linenos">329</span></a>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-330"><a href="#DisulfideClassGenerator.generate_for_selected_classes-330"><span class="linenos">330</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generated disulfides for </span><span class="si">%d</span><span class="s2"> classes&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_disulfides</span><span class="p">))</span>
</span><span id="DisulfideClassGenerator.generate_for_selected_classes-331"><a href="#DisulfideClassGenerator.generate_for_selected_classes-331"><span class="linenos">331</span></a>        <span class="k">return</span> <span class="n">class_disulfides</span>
</span></pre></div>


            <div class="docstring"><p>Generate disulfides for multiple classes in parallel.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>class_ids</strong>:  List of class IDs.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Dictionary mapping class IDs to DisulfideLists.</p>
</blockquote>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>:  If no DataFrame is loaded.</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideClassGenerator.generate_for_all_classes" class="classattr">
                                        <input id="DisulfideClassGenerator.generate_for_all_classes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_for_all_classes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n"><a href="DisulfideBase.html#DisulfideList">proteusPy.DisulfideBase.DisulfideList</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassGenerator.generate_for_all_classes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassGenerator.generate_for_all_classes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassGenerator.generate_for_all_classes-333"><a href="#DisulfideClassGenerator.generate_for_all_classes-333"><span class="linenos">333</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_for_all_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DisulfideList</span><span class="p">]:</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-334"><a href="#DisulfideClassGenerator.generate_for_all_classes-334"><span class="linenos">334</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-335"><a href="#DisulfideClassGenerator.generate_for_all_classes-335"><span class="linenos">335</span></a><span class="sd">        Generate disulfides for all classes in loaded DataFrames.</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-336"><a href="#DisulfideClassGenerator.generate_for_all_classes-336"><span class="linenos">336</span></a>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-337"><a href="#DisulfideClassGenerator.generate_for_all_classes-337"><span class="linenos">337</span></a><span class="sd">        :return: Dictionary mapping class IDs to DisulfideLists.</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-338"><a href="#DisulfideClassGenerator.generate_for_all_classes-338"><span class="linenos">338</span></a><span class="sd">        :rtype: Dict[str, DisulfideList]</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-339"><a href="#DisulfideClassGenerator.generate_for_all_classes-339"><span class="linenos">339</span></a><span class="sd">        :raises ValueError: If no DataFrames are loaded.</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-340"><a href="#DisulfideClassGenerator.generate_for_all_classes-340"><span class="linenos">340</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-341"><a href="#DisulfideClassGenerator.generate_for_all_classes-341"><span class="linenos">341</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-342"><a href="#DisulfideClassGenerator.generate_for_all_classes-342"><span class="linenos">342</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No DataFrames loaded.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-343"><a href="#DisulfideClassGenerator.generate_for_all_classes-343"><span class="linenos">343</span></a>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-344"><a href="#DisulfideClassGenerator.generate_for_all_classes-344"><span class="linenos">344</span></a>        <span class="n">class_disulfides</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-345"><a href="#DisulfideClassGenerator.generate_for_all_classes-345"><span class="linenos">345</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-346"><a href="#DisulfideClassGenerator.generate_for_all_classes-346"><span class="linenos">346</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">base</span> <span class="o">=</span> <span class="n">BINARY_BASE</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-347"><a href="#DisulfideClassGenerator.generate_for_all_classes-347"><span class="linenos">347</span></a>            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span><span class="p">,</span> <span class="s2">&quot;binary&quot;</span><span class="p">):</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-348"><a href="#DisulfideClassGenerator.generate_for_all_classes-348"><span class="linenos">348</span></a>                <span class="n">class_id</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;class_str&quot;</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-349"><a href="#DisulfideClassGenerator.generate_for_all_classes-349"><span class="linenos">349</span></a>                <span class="n">disulfide_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_from_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">class_id</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-350"><a href="#DisulfideClassGenerator.generate_for_all_classes-350"><span class="linenos">350</span></a>                <span class="n">class_disulfides</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">class_id</span><span class="si">}</span><span class="s2">b&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">disulfide_list</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-351"><a href="#DisulfideClassGenerator.generate_for_all_classes-351"><span class="linenos">351</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span><span class="p">[</span><span class="n">class_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">disulfide_list</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-352"><a href="#DisulfideClassGenerator.generate_for_all_classes-352"><span class="linenos">352</span></a>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-353"><a href="#DisulfideClassGenerator.generate_for_all_classes-353"><span class="linenos">353</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-354"><a href="#DisulfideClassGenerator.generate_for_all_classes-354"><span class="linenos">354</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">base</span> <span class="o">=</span> <span class="n">OCTANT_BASE</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-355"><a href="#DisulfideClassGenerator.generate_for_all_classes-355"><span class="linenos">355</span></a>            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate_df</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span><span class="p">,</span> <span class="s2">&quot;octant&quot;</span><span class="p">):</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-356"><a href="#DisulfideClassGenerator.generate_for_all_classes-356"><span class="linenos">356</span></a>                <span class="n">class_id</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-357"><a href="#DisulfideClassGenerator.generate_for_all_classes-357"><span class="linenos">357</span></a>                <span class="n">disulfide_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_from_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">class_id</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-358"><a href="#DisulfideClassGenerator.generate_for_all_classes-358"><span class="linenos">358</span></a>                <span class="n">class_disulfides</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">class_id</span><span class="si">}</span><span class="s2">o&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">disulfide_list</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-359"><a href="#DisulfideClassGenerator.generate_for_all_classes-359"><span class="linenos">359</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span><span class="p">[</span><span class="n">class_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">disulfide_list</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-360"><a href="#DisulfideClassGenerator.generate_for_all_classes-360"><span class="linenos">360</span></a>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-361"><a href="#DisulfideClassGenerator.generate_for_all_classes-361"><span class="linenos">361</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generated disulfides for </span><span class="si">%d</span><span class="s2"> classes&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_disulfides</span><span class="p">))</span>
</span><span id="DisulfideClassGenerator.generate_for_all_classes-362"><a href="#DisulfideClassGenerator.generate_for_all_classes-362"><span class="linenos">362</span></a>        <span class="k">return</span> <span class="n">class_disulfides</span>
</span></pre></div>


            <div class="docstring"><p>Generate disulfides for all classes in loaded DataFrames.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Dictionary mapping class IDs to DisulfideLists.</p>
</blockquote>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>:  If no DataFrames are loaded.</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideClassGenerator.describe" class="classattr">
                                        <input id="DisulfideClassGenerator.describe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">describe</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">detailed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassGenerator.describe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassGenerator.describe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassGenerator.describe-399"><a href="#DisulfideClassGenerator.describe-399"><span class="linenos">399</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">detailed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.describe-400"><a href="#DisulfideClassGenerator.describe-400"><span class="linenos">400</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.describe-401"><a href="#DisulfideClassGenerator.describe-401"><span class="linenos">401</span></a><span class="sd">        Print the internal state of the generator.</span>
</span><span id="DisulfideClassGenerator.describe-402"><a href="#DisulfideClassGenerator.describe-402"><span class="linenos">402</span></a>
</span><span id="DisulfideClassGenerator.describe-403"><a href="#DisulfideClassGenerator.describe-403"><span class="linenos">403</span></a><span class="sd">        :param detailed: Show detailed DataFrame and disulfide info.</span>
</span><span id="DisulfideClassGenerator.describe-404"><a href="#DisulfideClassGenerator.describe-404"><span class="linenos">404</span></a><span class="sd">        :type detailed: bool</span>
</span><span id="DisulfideClassGenerator.describe-405"><a href="#DisulfideClassGenerator.describe-405"><span class="linenos">405</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.describe-406"><a href="#DisulfideClassGenerator.describe-406"><span class="linenos">406</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.describe-407"><a href="#DisulfideClassGenerator.describe-407"><span class="linenos">407</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;DisulfideClassGenerator State&#39;</span><span class="si">:</span><span class="s2">^80</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.describe-408"><a href="#DisulfideClassGenerator.describe-408"><span class="linenos">408</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.describe-409"><a href="#DisulfideClassGenerator.describe-409"><span class="linenos">409</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Base: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;Not set&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.describe-410"><a href="#DisulfideClassGenerator.describe-410"><span class="linenos">410</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Verbose: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.describe-411"><a href="#DisulfideClassGenerator.describe-411"><span class="linenos">411</span></a>
</span><span id="DisulfideClassGenerator.describe-412"><a href="#DisulfideClassGenerator.describe-412"><span class="linenos">412</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">DataFrames:&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.describe-413"><a href="#DisulfideClassGenerator.describe-413"><span class="linenos">413</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="DisulfideClassGenerator.describe-414"><a href="#DisulfideClassGenerator.describe-414"><span class="linenos">414</span></a>            <span class="p">(</span><span class="s2">&quot;Binary&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span><span class="p">,</span> <span class="s2">&quot;binary_df&quot;</span><span class="p">),</span>
</span><span id="DisulfideClassGenerator.describe-415"><a href="#DisulfideClassGenerator.describe-415"><span class="linenos">415</span></a>            <span class="p">(</span><span class="s2">&quot;Octant&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span><span class="p">,</span> <span class="s2">&quot;octant_df&quot;</span><span class="p">),</span>
</span><span id="DisulfideClassGenerator.describe-416"><a href="#DisulfideClassGenerator.describe-416"><span class="linenos">416</span></a>        <span class="p">]:</span>
</span><span id="DisulfideClassGenerator.describe-417"><a href="#DisulfideClassGenerator.describe-417"><span class="linenos">417</span></a>            <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.describe-418"><a href="#DisulfideClassGenerator.describe-418"><span class="linenos">418</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: Loaded (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2"> classes)&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.describe-419"><a href="#DisulfideClassGenerator.describe-419"><span class="linenos">419</span></a>                <span class="k">if</span> <span class="n">detailed</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.describe-420"><a href="#DisulfideClassGenerator.describe-420"><span class="linenos">420</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Sample:</span><span class="se">\n</span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.describe-421"><a href="#DisulfideClassGenerator.describe-421"><span class="linenos">421</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.describe-422"><a href="#DisulfideClassGenerator.describe-422"><span class="linenos">422</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: Not loaded&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.describe-423"><a href="#DisulfideClassGenerator.describe-423"><span class="linenos">423</span></a>
</span><span id="DisulfideClassGenerator.describe-424"><a href="#DisulfideClassGenerator.describe-424"><span class="linenos">424</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Disulfides:&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.describe-425"><a href="#DisulfideClassGenerator.describe-425"><span class="linenos">425</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="DisulfideClassGenerator.describe-426"><a href="#DisulfideClassGenerator.describe-426"><span class="linenos">426</span></a>            <span class="p">(</span><span class="s2">&quot;Binary&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span><span class="p">),</span>
</span><span id="DisulfideClassGenerator.describe-427"><a href="#DisulfideClassGenerator.describe-427"><span class="linenos">427</span></a>            <span class="p">(</span><span class="s2">&quot;Octant&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span><span class="p">),</span>
</span><span id="DisulfideClassGenerator.describe-428"><a href="#DisulfideClassGenerator.describe-428"><span class="linenos">428</span></a>        <span class="p">]:</span>
</span><span id="DisulfideClassGenerator.describe-429"><a href="#DisulfideClassGenerator.describe-429"><span class="linenos">429</span></a>            <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.describe-430"><a href="#DisulfideClassGenerator.describe-430"><span class="linenos">430</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> classes&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.describe-431"><a href="#DisulfideClassGenerator.describe-431"><span class="linenos">431</span></a>            <span class="k">if</span> <span class="n">detailed</span> <span class="ow">and</span> <span class="n">count</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.describe-432"><a href="#DisulfideClassGenerator.describe-432"><span class="linenos">432</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Sample: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">())[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.describe-433"><a href="#DisulfideClassGenerator.describe-433"><span class="linenos">433</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Print the internal state of the generator.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>detailed</strong>:  Show detailed DataFrame and disulfide info.</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideClassGenerator.prepare_energy_data" class="classattr">
                                        <input id="DisulfideClassGenerator.prepare_energy_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">prepare_energy_data</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassGenerator.prepare_energy_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassGenerator.prepare_energy_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassGenerator.prepare_energy_data-435"><a href="#DisulfideClassGenerator.prepare_energy_data-435"><span class="linenos">435</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_energy_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-436"><a href="#DisulfideClassGenerator.prepare_energy_data-436"><span class="linenos">436</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-437"><a href="#DisulfideClassGenerator.prepare_energy_data-437"><span class="linenos">437</span></a><span class="sd">        Prepare energy data for visualization.</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-438"><a href="#DisulfideClassGenerator.prepare_energy_data-438"><span class="linenos">438</span></a>
</span><span id="DisulfideClassGenerator.prepare_energy_data-439"><a href="#DisulfideClassGenerator.prepare_energy_data-439"><span class="linenos">439</span></a><span class="sd">        :return: DataFrame with class and energy data.</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-440"><a href="#DisulfideClassGenerator.prepare_energy_data-440"><span class="linenos">440</span></a><span class="sd">        :rtype: pd.DataFrame</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-441"><a href="#DisulfideClassGenerator.prepare_energy_data-441"><span class="linenos">441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-442"><a href="#DisulfideClassGenerator.prepare_energy_data-442"><span class="linenos">442</span></a>        <span class="n">energy_data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-443"><a href="#DisulfideClassGenerator.prepare_energy_data-443"><span class="linenos">443</span></a>        <span class="k">for</span> <span class="n">base</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-444"><a href="#DisulfideClassGenerator.prepare_energy_data-444"><span class="linenos">444</span></a>            <span class="p">(</span><span class="n">BINARY_BASE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span><span class="p">),</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-445"><a href="#DisulfideClassGenerator.prepare_energy_data-445"><span class="linenos">445</span></a>            <span class="p">(</span><span class="n">OCTANT_BASE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span><span class="p">),</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-446"><a href="#DisulfideClassGenerator.prepare_energy_data-446"><span class="linenos">446</span></a>        <span class="p">]:</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-447"><a href="#DisulfideClassGenerator.prepare_energy_data-447"><span class="linenos">447</span></a>            <span class="k">for</span> <span class="n">class_id</span><span class="p">,</span> <span class="n">disulfide_list</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-448"><a href="#DisulfideClassGenerator.prepare_energy_data-448"><span class="linenos">448</span></a>                <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">disulfide_list</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-449"><a href="#DisulfideClassGenerator.prepare_energy_data-449"><span class="linenos">449</span></a>                    <span class="n">energy_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-450"><a href="#DisulfideClassGenerator.prepare_energy_data-450"><span class="linenos">450</span></a>                        <span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="n">class_id</span><span class="p">,</span> <span class="s2">&quot;energy&quot;</span><span class="p">:</span> <span class="n">ss</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span> <span class="s2">&quot;base&quot;</span><span class="p">:</span> <span class="n">base</span><span class="p">}</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-451"><a href="#DisulfideClassGenerator.prepare_energy_data-451"><span class="linenos">451</span></a>                    <span class="p">)</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-452"><a href="#DisulfideClassGenerator.prepare_energy_data-452"><span class="linenos">452</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">energy_data</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-453"><a href="#DisulfideClassGenerator.prepare_energy_data-453"><span class="linenos">453</span></a>        <span class="p">(</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-454"><a href="#DisulfideClassGenerator.prepare_energy_data-454"><span class="linenos">454</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Prepared energy data with </span><span class="si">%d</span><span class="s2"> entries&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-455"><a href="#DisulfideClassGenerator.prepare_energy_data-455"><span class="linenos">455</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-456"><a href="#DisulfideClassGenerator.prepare_energy_data-456"><span class="linenos">456</span></a>            <span class="k">else</span> <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No energy data.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-457"><a href="#DisulfideClassGenerator.prepare_energy_data-457"><span class="linenos">457</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassGenerator.prepare_energy_data-458"><a href="#DisulfideClassGenerator.prepare_energy_data-458"><span class="linenos">458</span></a>        <span class="k">return</span> <span class="n">df</span>
</span></pre></div>


            <div class="docstring"><p>Prepare energy data for visualization.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>DataFrame with class and energy data.</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideClassGenerator.plot_energy_by_class" class="classattr">
                                        <input id="DisulfideClassGenerator.plot_energy_by_class-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_energy_by_class</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Energy Distribution by Class&#39;</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassGenerator.plot_energy_by_class-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassGenerator.plot_energy_by_class"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassGenerator.plot_energy_by_class-460"><a href="#DisulfideClassGenerator.plot_energy_by_class-460"><span class="linenos">460</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_energy_by_class</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-461"><a href="#DisulfideClassGenerator.plot_energy_by_class-461"><span class="linenos">461</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Energy Distribution by Class&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-462"><a href="#DisulfideClassGenerator.plot_energy_by_class-462"><span class="linenos">462</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-463"><a href="#DisulfideClassGenerator.plot_energy_by_class-463"><span class="linenos">463</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-464"><a href="#DisulfideClassGenerator.plot_energy_by_class-464"><span class="linenos">464</span></a><span class="sd">        Plot energy distribution by class.</span>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-465"><a href="#DisulfideClassGenerator.plot_energy_by_class-465"><span class="linenos">465</span></a>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-466"><a href="#DisulfideClassGenerator.plot_energy_by_class-466"><span class="linenos">466</span></a><span class="sd">        :param base: Filter by base (2 or 8, optional).</span>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-467"><a href="#DisulfideClassGenerator.plot_energy_by_class-467"><span class="linenos">467</span></a><span class="sd">        :type base: int</span>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-468"><a href="#DisulfideClassGenerator.plot_energy_by_class-468"><span class="linenos">468</span></a><span class="sd">        :param title: Plot title.</span>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-469"><a href="#DisulfideClassGenerator.plot_energy_by_class-469"><span class="linenos">469</span></a><span class="sd">        :type title: str</span>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-470"><a href="#DisulfideClassGenerator.plot_energy_by_class-470"><span class="linenos">470</span></a><span class="sd">        :param kwargs: Additional plotting options.</span>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-471"><a href="#DisulfideClassGenerator.plot_energy_by_class-471"><span class="linenos">471</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-472"><a href="#DisulfideClassGenerator.plot_energy_by_class-472"><span class="linenos">472</span></a>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-473"><a href="#DisulfideClassGenerator.plot_energy_by_class-473"><span class="linenos">473</span></a>        <span class="n">energy_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_energy_data</span><span class="p">()</span>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-474"><a href="#DisulfideClassGenerator.plot_energy_by_class-474"><span class="linenos">474</span></a>        <span class="k">if</span> <span class="n">energy_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-475"><a href="#DisulfideClassGenerator.plot_energy_by_class-475"><span class="linenos">475</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No energy data available.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-476"><a href="#DisulfideClassGenerator.plot_energy_by_class-476"><span class="linenos">476</span></a>            <span class="k">return</span>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-477"><a href="#DisulfideClassGenerator.plot_energy_by_class-477"><span class="linenos">477</span></a>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-478"><a href="#DisulfideClassGenerator.plot_energy_by_class-478"><span class="linenos">478</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="ow">in</span> <span class="p">(</span><span class="n">BINARY_BASE</span><span class="p">,</span> <span class="n">OCTANT_BASE</span><span class="p">):</span>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-479"><a href="#DisulfideClassGenerator.plot_energy_by_class-479"><span class="linenos">479</span></a>            <span class="n">energy_df</span> <span class="o">=</span> <span class="n">energy_df</span><span class="p">[</span><span class="n">energy_df</span><span class="p">[</span><span class="s2">&quot;base&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">base</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-480"><a href="#DisulfideClassGenerator.plot_energy_by_class-480"><span class="linenos">480</span></a>            <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Binary&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">BINARY_BASE</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Octant&#39;</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-481"><a href="#DisulfideClassGenerator.plot_energy_by_class-481"><span class="linenos">481</span></a>        <span class="k">elif</span> <span class="n">base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-482"><a href="#DisulfideClassGenerator.plot_energy_by_class-482"><span class="linenos">482</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Base must be 2 or 8.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-483"><a href="#DisulfideClassGenerator.plot_energy_by_class-483"><span class="linenos">483</span></a>
</span><span id="DisulfideClassGenerator.plot_energy_by_class-484"><a href="#DisulfideClassGenerator.plot_energy_by_class-484"><span class="linenos">484</span></a>        <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_energy_by_class</span><span class="p">(</span><span class="n">energy_df</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plot energy distribution by class.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base</strong>:  Filter by base (2 or 8, optional).</li>
<li><strong>title</strong>:  Plot title.</li>
<li><strong>kwargs</strong>:  Additional plotting options.</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideClassGenerator.plot_torsion_distance_by_class" class="classattr">
                                        <input id="DisulfideClassGenerator.plot_torsion_distance_by_class-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_torsion_distance_by_class</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Torsion Distance by Class&#39;</span>,</span><span class="param">	<span class="n">theme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>,</span><span class="param">	<span class="n">save</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">savedir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>,</span><span class="param">	<span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">split</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">max_classes_per_plot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">330</span>,</span><span class="param">	<span class="n">dpi</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span>,</span><span class="param">	<span class="n">suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassGenerator.plot_torsion_distance_by_class-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassGenerator.plot_torsion_distance_by_class"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-486"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-486"><span class="linenos">486</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_torsion_distance_by_class</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-487"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-487"><span class="linenos">487</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-488"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-488"><span class="linenos">488</span></a>        <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-489"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-489"><span class="linenos">489</span></a>        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Torsion Distance by Class&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-490"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-490"><span class="linenos">490</span></a>        <span class="n">theme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-491"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-491"><span class="linenos">491</span></a>        <span class="n">save</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-492"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-492"><span class="linenos">492</span></a>        <span class="n">savedir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-493"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-493"><span class="linenos">493</span></a>        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-494"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-494"><span class="linenos">494</span></a>        <span class="n">split</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-495"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-495"><span class="linenos">495</span></a>        <span class="n">max_classes_per_plot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">330</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-496"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-496"><span class="linenos">496</span></a>        <span class="n">dpi</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-497"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-497"><span class="linenos">497</span></a>        <span class="n">suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;png&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-498"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-498"><span class="linenos">498</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-499"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-499"><span class="linenos">499</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-500"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-500"><span class="linenos">500</span></a><span class="sd">        Create a bar chart showing torsion distance by class_id.</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-501"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-501"><span class="linenos">501</span></a>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-502"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-502"><span class="linenos">502</span></a><span class="sd">        :param base: The base class to use (2 for binary, 8 for octant). If None,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-503"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-503"><span class="linenos">503</span></a><span class="sd">        use all available data.</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-504"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-504"><span class="linenos">504</span></a><span class="sd">        :type base: int, optional</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-505"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-505"><span class="linenos">505</span></a><span class="sd">        :param title: Title for the plot</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-506"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-506"><span class="linenos">506</span></a><span class="sd">        :type title: str</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-507"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-507"><span class="linenos">507</span></a><span class="sd">        :param theme: Theme to use for the plot (&#39;auto&#39;, &#39;light&#39;, or &#39;dark&#39;)</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-508"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-508"><span class="linenos">508</span></a><span class="sd">        :type theme: str</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-509"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-509"><span class="linenos">509</span></a><span class="sd">        :param save: Whether to save the plot</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-510"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-510"><span class="linenos">510</span></a><span class="sd">        :type save: bool</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-511"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-511"><span class="linenos">511</span></a><span class="sd">        :param savedir: Directory to save the plot to</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-512"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-512"><span class="linenos">512</span></a><span class="sd">        :type savedir: str</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-513"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-513"><span class="linenos">513</span></a><span class="sd">        :param verbose: Whether to display verbose output</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-514"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-514"><span class="linenos">514</span></a><span class="sd">        :type verbose: bool</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-515"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-515"><span class="linenos">515</span></a><span class="sd">        :param split: Whether to split the plot into multiple plots if there are many classes</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-516"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-516"><span class="linenos">516</span></a><span class="sd">        :type split: bool</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-517"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-517"><span class="linenos">517</span></a><span class="sd">        :param max_classes_per_plot: Maximum number of classes to include in each plot</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-518"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-518"><span class="linenos">518</span></a><span class="sd">        when splitting</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-519"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-519"><span class="linenos">519</span></a><span class="sd">        :type max_classes_per_plot: int</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-520"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-520"><span class="linenos">520</span></a><span class="sd">        :param dpi: DPI (dots per inch) for the saved image, controls the resolution (default: 600)</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-521"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-521"><span class="linenos">521</span></a><span class="sd">        :type dpi: int</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-522"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-522"><span class="linenos">522</span></a><span class="sd">        :param suffix: File format for saved images (default: &quot;png&quot;)</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-523"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-523"><span class="linenos">523</span></a><span class="sd">        :type suffix: str</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-524"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-524"><span class="linenos">524</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-525"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-525"><span class="linenos">525</span></a>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-526"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-526"><span class="linenos">526</span></a>        <span class="c1"># Determine which DataFrame to use based on base parameter</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-527"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-527"><span class="linenos">527</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-528"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-528"><span class="linenos">528</span></a>            <span class="k">if</span> <span class="n">base</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">]:</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-529"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-529"><span class="linenos">529</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Base must be 2 (binary) or 8 (octant)&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-530"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-530"><span class="linenos">530</span></a>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-531"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-531"><span class="linenos">531</span></a>            <span class="n">df_to_use</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span> <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-532"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-532"><span class="linenos">532</span></a>            <span class="n">base_str</span> <span class="o">=</span> <span class="s2">&quot;Binary&quot;</span> <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="s2">&quot;Octant&quot;</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-533"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-533"><span class="linenos">533</span></a>            <span class="n">plot_title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_str</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-534"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-534"><span class="linenos">534</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-535"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-535"><span class="linenos">535</span></a>            <span class="c1"># Default to octant if available, otherwise binary</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-536"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-536"><span class="linenos">536</span></a>            <span class="n">df_to_use</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_df</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-537"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-537"><span class="linenos">537</span></a>            <span class="n">plot_title</span> <span class="o">=</span> <span class="n">title</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-538"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-538"><span class="linenos">538</span></a>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-539"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-539"><span class="linenos">539</span></a>        <span class="k">if</span> <span class="n">df_to_use</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">df_to_use</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-540"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-540"><span class="linenos">540</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No data available for the specified base.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-541"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-541"><span class="linenos">541</span></a>            <span class="k">return</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-542"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-542"><span class="linenos">542</span></a>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-543"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-543"><span class="linenos">543</span></a>        <span class="c1"># Check if avg_torsion_distance column exists</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-544"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-544"><span class="linenos">544</span></a>        <span class="k">if</span> <span class="s2">&quot;avg_torsion_distance&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_to_use</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-545"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-545"><span class="linenos">545</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;avg_torsion_distance column not found in the DataFrame.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-546"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-546"><span class="linenos">546</span></a>            <span class="k">return</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-547"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-547"><span class="linenos">547</span></a>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-548"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-548"><span class="linenos">548</span></a>        <span class="c1"># Create a copy of the DataFrame to avoid modifying the original</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-549"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-549"><span class="linenos">549</span></a>        <span class="n">plot_df</span> <span class="o">=</span> <span class="n">df_to_use</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-550"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-550"><span class="linenos">550</span></a>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-551"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-551"><span class="linenos">551</span></a>        <span class="c1"># If not splitting or few classes, create a single plot</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-552"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-552"><span class="linenos">552</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">split</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">max_classes_per_plot</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-553"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-553"><span class="linenos">553</span></a>            <span class="c1"># Create line plot using plotly_express</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-554"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-554"><span class="linenos">554</span></a>            <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_torsion_distance_by_class</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-555"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-555"><span class="linenos">555</span></a>                <span class="n">plot_df</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-556"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-556"><span class="linenos">556</span></a>                <span class="n">title</span><span class="o">=</span><span class="n">plot_title</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-557"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-557"><span class="linenos">557</span></a>                <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-558"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-558"><span class="linenos">558</span></a>                <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-559"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-559"><span class="linenos">559</span></a>                <span class="n">savedir</span><span class="o">=</span><span class="n">savedir</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-560"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-560"><span class="linenos">560</span></a>                <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-561"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-561"><span class="linenos">561</span></a>                <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-562"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-562"><span class="linenos">562</span></a>                <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-563"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-563"><span class="linenos">563</span></a>            <span class="p">)</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-564"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-564"><span class="linenos">564</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-565"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-565"><span class="linenos">565</span></a>            <span class="c1"># Split into multiple plots</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-566"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-566"><span class="linenos">566</span></a>            <span class="n">num_plots</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-567"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-567"><span class="linenos">567</span></a>                <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="p">)</span> <span class="o">+</span> <span class="n">max_classes_per_plot</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-568"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-568"><span class="linenos">568</span></a>            <span class="p">)</span> <span class="o">//</span> <span class="n">max_classes_per_plot</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-569"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-569"><span class="linenos">569</span></a>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-570"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-570"><span class="linenos">570</span></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-571"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-571"><span class="linenos">571</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-572"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-572"><span class="linenos">572</span></a>                    <span class="s2">&quot;Splitting into </span><span class="si">%d</span><span class="s2"> plots with up to </span><span class="si">%d</span><span class="s2"> classes each&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-573"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-573"><span class="linenos">573</span></a>                    <span class="n">num_plots</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-574"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-574"><span class="linenos">574</span></a>                    <span class="n">max_classes_per_plot</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-575"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-575"><span class="linenos">575</span></a>                <span class="p">)</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-576"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-576"><span class="linenos">576</span></a>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-577"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-577"><span class="linenos">577</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_plots</span><span class="p">):</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-578"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-578"><span class="linenos">578</span></a>                <span class="n">start_idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">max_classes_per_plot</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-579"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-579"><span class="linenos">579</span></a>                <span class="n">end_idx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">max_classes_per_plot</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_df</span><span class="p">))</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-580"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-580"><span class="linenos">580</span></a>                <span class="n">subset_df</span> <span class="o">=</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-581"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-581"><span class="linenos">581</span></a>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-582"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-582"><span class="linenos">582</span></a>                <span class="c1"># Create plot title for this subset</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-583"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-583"><span class="linenos">583</span></a>                <span class="n">subset_title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">plot_title</span><span class="si">}</span><span class="s2"> (Part </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="n">num_plots</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-584"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-584"><span class="linenos">584</span></a>                <span class="n">fname_prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">plot_title</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_part_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-585"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-585"><span class="linenos">585</span></a>                <span class="c1"># Create line plot for this subset</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-586"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-586"><span class="linenos">586</span></a>                <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_torsion_distance_by_class</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-587"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-587"><span class="linenos">587</span></a>                    <span class="n">subset_df</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-588"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-588"><span class="linenos">588</span></a>                    <span class="n">title</span><span class="o">=</span><span class="n">subset_title</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-589"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-589"><span class="linenos">589</span></a>                    <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-590"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-590"><span class="linenos">590</span></a>                    <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-591"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-591"><span class="linenos">591</span></a>                    <span class="n">savedir</span><span class="o">=</span><span class="n">savedir</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-592"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-592"><span class="linenos">592</span></a>                    <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-593"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-593"><span class="linenos">593</span></a>                    <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-594"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-594"><span class="linenos">594</span></a>                    <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-595"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-595"><span class="linenos">595</span></a>                    <span class="n">fname_prefix</span><span class="o">=</span><span class="n">fname_prefix</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.plot_torsion_distance_by_class-596"><a href="#DisulfideClassGenerator.plot_torsion_distance_by_class-596"><span class="linenos">596</span></a>                <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a bar chart showing torsion distance by class_id.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base</strong>:  The base class to use (2 for binary, 8 for octant). If None,
use all available data.</li>
<li><strong>title</strong>:  Title for the plot</li>
<li><strong>theme</strong>:  Theme to use for the plot ('auto', 'light', or 'dark')</li>
<li><strong>save</strong>:  Whether to save the plot</li>
<li><strong>savedir</strong>:  Directory to save the plot to</li>
<li><strong>verbose</strong>:  Whether to display verbose output</li>
<li><strong>split</strong>:  Whether to split the plot into multiple plots if there are many classes</li>
<li><strong>max_classes_per_plot</strong>:  Maximum number of classes to include in each plot
when splitting</li>
<li><strong>dpi: DPI (dots per inch) for the saved image, controls the resolution (default</strong>:  600)</li>
<li><strong>suffix: File format for saved images (default</strong>:  "png")</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideClassGenerator.display" class="classattr">
                                        <input id="DisulfideClassGenerator.display-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">display</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">class_id</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">screenshot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">movie</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">fname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ss_overlay.png&#39;</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassGenerator.display-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassGenerator.display"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassGenerator.display-598"><a href="#DisulfideClassGenerator.display-598"><span class="linenos">598</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator.display-599"><a href="#DisulfideClassGenerator.display-599"><span class="linenos">599</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.display-600"><a href="#DisulfideClassGenerator.display-600"><span class="linenos">600</span></a>        <span class="n">class_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.display-601"><a href="#DisulfideClassGenerator.display-601"><span class="linenos">601</span></a>        <span class="n">screenshot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.display-602"><a href="#DisulfideClassGenerator.display-602"><span class="linenos">602</span></a>        <span class="n">movie</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.display-603"><a href="#DisulfideClassGenerator.display-603"><span class="linenos">603</span></a>        <span class="n">fname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ss_overlay.png&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.display-604"><a href="#DisulfideClassGenerator.display-604"><span class="linenos">604</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="DisulfideClassGenerator.display-605"><a href="#DisulfideClassGenerator.display-605"><span class="linenos">605</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.display-606"><a href="#DisulfideClassGenerator.display-606"><span class="linenos">606</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.display-607"><a href="#DisulfideClassGenerator.display-607"><span class="linenos">607</span></a><span class="sd">        Display disulfide overlay for a class.</span>
</span><span id="DisulfideClassGenerator.display-608"><a href="#DisulfideClassGenerator.display-608"><span class="linenos">608</span></a>
</span><span id="DisulfideClassGenerator.display-609"><a href="#DisulfideClassGenerator.display-609"><span class="linenos">609</span></a><span class="sd">        :param class_id: Class ID to display.</span>
</span><span id="DisulfideClassGenerator.display-610"><a href="#DisulfideClassGenerator.display-610"><span class="linenos">610</span></a><span class="sd">        :type class_id: str</span>
</span><span id="DisulfideClassGenerator.display-611"><a href="#DisulfideClassGenerator.display-611"><span class="linenos">611</span></a><span class="sd">        :param screenshot: Save a screenshot.</span>
</span><span id="DisulfideClassGenerator.display-612"><a href="#DisulfideClassGenerator.display-612"><span class="linenos">612</span></a><span class="sd">        :type screenshot: bool</span>
</span><span id="DisulfideClassGenerator.display-613"><a href="#DisulfideClassGenerator.display-613"><span class="linenos">613</span></a><span class="sd">        :param movie: Save a movie.</span>
</span><span id="DisulfideClassGenerator.display-614"><a href="#DisulfideClassGenerator.display-614"><span class="linenos">614</span></a><span class="sd">        :type movie: bool</span>
</span><span id="DisulfideClassGenerator.display-615"><a href="#DisulfideClassGenerator.display-615"><span class="linenos">615</span></a><span class="sd">        :param fname: Output filename.</span>
</span><span id="DisulfideClassGenerator.display-616"><a href="#DisulfideClassGenerator.display-616"><span class="linenos">616</span></a><span class="sd">        :type fname: str</span>
</span><span id="DisulfideClassGenerator.display-617"><a href="#DisulfideClassGenerator.display-617"><span class="linenos">617</span></a><span class="sd">        :param kwargs: Additional display options.</span>
</span><span id="DisulfideClassGenerator.display-618"><a href="#DisulfideClassGenerator.display-618"><span class="linenos">618</span></a><span class="sd">        :raises ValueError: If class not found or generation fails.</span>
</span><span id="DisulfideClassGenerator.display-619"><a href="#DisulfideClassGenerator.display-619"><span class="linenos">619</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassGenerator.display-620"><a href="#DisulfideClassGenerator.display-620"><span class="linenos">620</span></a>        <span class="n">base</span><span class="p">,</span> <span class="n">clean_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_class_string</span><span class="p">(</span><span class="n">class_id</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.display-621"><a href="#DisulfideClassGenerator.display-621"><span class="linenos">621</span></a>        <span class="n">target_dict</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DisulfideClassGenerator.display-622"><a href="#DisulfideClassGenerator.display-622"><span class="linenos">622</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binary_class_disulfides</span>
</span><span id="DisulfideClassGenerator.display-623"><a href="#DisulfideClassGenerator.display-623"><span class="linenos">623</span></a>            <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="n">BINARY_BASE</span>
</span><span id="DisulfideClassGenerator.display-624"><a href="#DisulfideClassGenerator.display-624"><span class="linenos">624</span></a>            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">octant_class_disulfides</span>
</span><span id="DisulfideClassGenerator.display-625"><a href="#DisulfideClassGenerator.display-625"><span class="linenos">625</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassGenerator.display-626"><a href="#DisulfideClassGenerator.display-626"><span class="linenos">626</span></a>
</span><span id="DisulfideClassGenerator.display-627"><a href="#DisulfideClassGenerator.display-627"><span class="linenos">627</span></a>        <span class="k">if</span> <span class="n">clean_string</span> <span class="ow">in</span> <span class="n">target_dict</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.display-628"><a href="#DisulfideClassGenerator.display-628"><span class="linenos">628</span></a>            <span class="n">disulfide_list</span> <span class="o">=</span> <span class="n">target_dict</span><span class="p">[</span><span class="n">clean_string</span><span class="p">]</span>
</span><span id="DisulfideClassGenerator.display-629"><a href="#DisulfideClassGenerator.display-629"><span class="linenos">629</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.display-630"><a href="#DisulfideClassGenerator.display-630"><span class="linenos">630</span></a>            <span class="n">disulfide_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_for_class</span><span class="p">(</span><span class="n">class_id</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.display-631"><a href="#DisulfideClassGenerator.display-631"><span class="linenos">631</span></a>            <span class="k">if</span> <span class="n">disulfide_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassGenerator.display-632"><a href="#DisulfideClassGenerator.display-632"><span class="linenos">632</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class </span><span class="si">{</span><span class="n">class_id</span><span class="si">}</span><span class="s2"> not found or failed to generate.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassGenerator.display-633"><a href="#DisulfideClassGenerator.display-633"><span class="linenos">633</span></a>
</span><span id="DisulfideClassGenerator.display-634"><a href="#DisulfideClassGenerator.display-634"><span class="linenos">634</span></a>        <span class="n">disulfide_list</span><span class="o">.</span><span class="n">display_overlay</span><span class="p">(</span>
</span><span id="DisulfideClassGenerator.display-635"><a href="#DisulfideClassGenerator.display-635"><span class="linenos">635</span></a>            <span class="n">screenshot</span><span class="o">=</span><span class="n">screenshot</span><span class="p">,</span> <span class="n">movie</span><span class="o">=</span><span class="n">movie</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">fname</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="DisulfideClassGenerator.display-636"><a href="#DisulfideClassGenerator.display-636"><span class="linenos">636</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Display disulfide overlay for a class.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>class_id</strong>:  Class ID to display.</li>
<li><strong>screenshot</strong>:  Save a screenshot.</li>
<li><strong>movie</strong>:  Save a movie.</li>
<li><strong>fname</strong>:  Output filename.</li>
<li><strong>kwargs</strong>:  Additional display options.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>:  If class not found or generation fails.</li>
</ul>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>