<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>proteusPy.DisulfideLoader API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../proteusPy.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;proteusPy</a>

            <img src="./logo.png" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#DisulfideLoader">DisulfideLoader</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DisulfideLoader.__init__">DisulfideLoader</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.datadir">datadir</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.picklefile">picklefile</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.subset">subset</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.cutoff">cutoff</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.sg_cutoff">sg_cutoff</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.verbose">verbose</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.percentile">percentile</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.quiet">quiet</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.minimum">minimum</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.saveit">saveit</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.SSList">SSList</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.SSDict">SSDict</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.TorsionDF">TorsionDF</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.TotalDisulfides">TotalDisulfides</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.IDList">IDList</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.tclass">tclass</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.timestamp">timestamp</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.version">version</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.average_resolution">average_resolution</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.binary_to_class">binary_to_class</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.build_ss_from_idlist">build_ss_from_idlist</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.copy">copy</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.get_class_df">get_class_df</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.extract_class">extract_class</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.getlist">getlist</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.get_by_name">get_by_name</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.describe">describe</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.display_overlay">display_overlay</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.getTorsions">getTorsions</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.list_binary_classes">list_binary_classes</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.plot_Classes">plot_Classes</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.plot_classes_vs_cutoff">plot_classes_vs_cutoff</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.plot_binary_to_eightclass_incidence">plot_binary_to_eightclass_incidence</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.plot_count_vs_class_df">plot_count_vs_class_df</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.plot_count_vs_classid">plot_count_vs_classid</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.save">save</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.plot_disulfides_vs_pdbid">plot_disulfides_vs_pdbid</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.plot_distances">plot_distances</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.plot_deviation_scatterplots">plot_deviation_scatterplots</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.plot_deviation_histograms">plot_deviation_histograms</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.plot_classes">plot_classes</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.sslist_from_class">sslist_from_class</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.display_torsion_statistics">display_torsion_statistics</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.classes_vs_cutoff">classes_vs_cutoff</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#Load_PDB_SS">Load_PDB_SS</a>
            </li>
            <li>
                    <a class="function" href="#Bootstrap_PDB_SS">Bootstrap_PDB_SS</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../proteusPy.html">proteusPy</a><wbr>.DisulfideLoader    </h1>

                        <div class="docstring"><p>This module is part of the proteusPy package, a Python package for
the analysis and modeling of protein structures, with an emphasis on disulfide bonds.
This work is based on the original C/C++ implementation by Eric G. Suchanek. </p>

<p>Last revision: 2025-03-09 19:36:06 -egs-</p>
</div>

                        <input id="mod-DisulfideLoader-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-DisulfideLoader-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="sd">This module is part of the proteusPy package, a Python package for</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="sd">the analysis and modeling of protein structures, with an emphasis on disulfide bonds.</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="sd">This work is based on the original C/C++ implementation by Eric G. Suchanek. \n</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="sd">Last revision: 2025-03-09 19:36:06 -egs-</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="c1"># Cα N, Cα, Cβ, C&#39;, Sγ Å ° ρ</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="c1"># pylint: disable=C0301</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="c1"># pylint: disable=C0302</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="c1"># pylint: disable=W1203</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="c1"># pylint: disable=C0103</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="c1"># pylint: disable=W0612</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="c1"># pylint: disable=R1702</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a><span class="c1"># Cα N, Cα, Cβ, C&#39;, Sγ Å ° ρ</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">copy</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">gdown</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">plotly_express</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">px</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">pympler</span><span class="w"> </span><span class="kn">import</span> <span class="n">asizeof</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">proteusPy</span><span class="w"> </span><span class="kn">import</span> <span class="n">__version__</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">proteusPy.DisulfideBase</span><span class="w"> </span><span class="kn">import</span> <span class="n">Disulfide</span><span class="p">,</span> <span class="n">DisulfideList</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">proteusPy.DisulfideClassManager</span><span class="w"> </span><span class="kn">import</span> <span class="n">DisulfideClassManager</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">proteusPy.DisulfideExceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">DisulfideParseWarning</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">proteusPy.DisulfideStats</span><span class="w"> </span><span class="kn">import</span> <span class="n">DisulfideStats</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">proteusPy.DisulfideVisualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">DisulfideVisualization</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">proteusPy.logger_config</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_logger</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">proteusPy.ProteusGlobals</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a>    <span class="n">DATA_DIR</span><span class="p">,</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a>    <span class="n">LOADER_FNAME</span><span class="p">,</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a>    <span class="n">LOADER_SUBSET_FNAME</span><span class="p">,</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a>    <span class="n">SS_LIST_URL</span><span class="p">,</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a>    <span class="n">SS_PICKLE_FILE</span><span class="p">,</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="p">)</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a><span class="n">_logger</span> <span class="o">=</span> <span class="n">create_logger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="k">try</span><span class="p">:</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a>    <span class="c1"># Check if running in Jupyter</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a>    <span class="n">shell</span> <span class="o">=</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>  <span class="c1"># type: ignore</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a>    <span class="k">if</span> <span class="n">shell</span> <span class="o">==</span> <span class="s2">&quot;ZMQInteractiveShell&quot;</span><span class="p">:</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">tqdm.notebook</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a><span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a><span class="nd">@dataclass</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DisulfideLoader</span><span class="p">:</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a><span class="sd">    This class represents the disulfide database itself and is its primary means of accession.</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a><span class="sd">    The entirety of the RCSB disulfide database is stored within the class via a</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a><span class="sd">    proteusPy.DisulfideList, a ```Pandas``` .csv file, and a ```dict``` of</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a><span class="sd">    indices mapping the PDB IDs into their respective list of disulfides. The datastructures allow</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a><span class="sd">    simple, direct and flexible access to the disulfide structures contained herein.</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="sd">    This makes it possible to access the disulfides by array index, PDB structure ID, disulfide</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a><span class="sd">    name and class ID.</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a><span class="sd">    The class also provides methods for plotting distance and angle deviations</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="sd">    as well as torsion statistics for the disulfides in the database.</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a><span class="sd">    The class can also render Disulfides overlaid on a common coordinate system to a pyVista</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a><span class="sd">    window using the [display_overlay()](#DisulfideLoader.display_overlay) method. See below for examples.</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a><span class="sd">    Important note: For typical usage one will access the database via the `Load_PDB_SS()` function.</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a><span class="sd">    The difference is that the latter function loads the compressed database from its single</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a><span class="sd">    source. The `DisulfideLoader` class is used to build the Disulifde database with a</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a><span class="sd">    specific cutoff, or for saving the database to a file.</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a><span class="sd">    Cutoff values of -1.0 indicate imposing no cutoffs on the data.</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a><span class="sd">    :param verbose: Flag to control output verbosity</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a><span class="sd">    :type verbose: bool</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a><span class="sd">    :param datadir: Directory containing data files</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a><span class="sd">    :type datadir: str</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a><span class="sd">    :param picklefile: Name of the pickle file containing disulfide data</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a><span class="sd">    :type picklefile: str</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a><span class="sd">    :param quiet: Flag to suppress warnings</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a><span class="sd">    :type quiet: bool</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a><span class="sd">    :param subset: Flag to load only a subset of data</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a><span class="sd">    :type subset: bool</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a><span class="sd">    :param cutoff: Distance cutoff, (A) for filtering disulfides. Defaults to -1.0.</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a><span class="sd">    :type cutoff: float</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a><span class="sd">    :param sg_cutoff: SG distance cutoff, (A) for filtering disulfides. Defaults to -1.0.</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a><span class="sd">    :type sg_cutoff: float</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a><span class="sd">    :param percentile: Percentile cutoff for filtering disulfides. Must be between 0 and 100.</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a><span class="sd">    Filters based on statistical cutoffs derived from the data.</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a><span class="sd">    :type percentile: float</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a><span class="sd">    :param minimum: Minimum atom distance for filtering disulfides. -1 is no filtering.</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a><span class="sd">    :type minimum: float</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a><span class="sd">    :param save: Flag to save the Loader to a file</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a><span class="sd">    :type save: bool</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>    <span class="c1"># Fields that serve as both instance attributes and initialization parameters</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a>    <span class="n">datadir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">)</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a>    <span class="n">picklefile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">SS_PICKLE_FILE</span><span class="p">)</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>    <span class="n">subset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a>    <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a>    <span class="n">sg_cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a>    <span class="n">percentile</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>    <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a>    <span class="n">minimum</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a>    <span class="n">saveit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>    <span class="c1"># Fields that are only used internally and don&#39;t need to be initialization parameters</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a>    <span class="n">SSList</span><span class="p">:</span> <span class="n">DisulfideList</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>        <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s2">&quot;ALL_PDB_SS&quot;</span><span class="p">),</span> <span class="n">init</span><span class="o">=</span><span class="kc">False</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>    <span class="p">)</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a>    <span class="n">SSDict</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a>    <span class="n">TorsionDF</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>    <span class="n">TotalDisulfides</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a>    <span class="n">IDList</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>    <span class="n">tclass</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DisulfideClassManager</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>    <span class="n">timestamp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>    <span class="n">version</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">__version__</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a><span class="sd">        Initialize the DisulfideLoader after dataclass initialization.</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a><span class="sd">        This method handles loading and processing of the disulfide data.</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a>        <span class="n">cutoffs</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a>        <span class="n">old_length</span> <span class="o">=</span> <span class="n">new_length</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a>        <span class="n">full_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datadir</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">picklefile</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span><span class="p">:</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>                <span class="sa">f</span><span class="s2">&quot;Reading disulfides from: </span><span class="si">{</span><span class="n">full_path</span><span class="si">}</span><span class="s2">... &quot;</span><span class="p">,</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a>            <span class="p">)</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>            <span class="c1"># Check if the file exists before attempting to open it</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">full_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>                <span class="n">fname</span> <span class="o">=</span> <span class="n">SS_PICKLE_FILE</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a>                <span class="n">url</span> <span class="o">=</span> <span class="n">SS_LIST_URL</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a>                <span class="n">_fname</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">)</span> <span class="o">/</span> <span class="n">fname</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">_fname</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>                        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a>                            <span class="s2">&quot;Master SS list unavailable. Downloading Disulfide Database from Drive...&quot;</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>                        <span class="p">)</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>                    <span class="n">gdown</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">_fname</span><span class="p">),</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">full_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>                <span class="n">sslist</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">percentile</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">percentile</span> <span class="o">&gt;</span> <span class="mf">100.0</span><span class="p">:</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Percentile must be between 0 and 100.&quot;</span><span class="p">)</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>                    <span class="n">cutoffs</span> <span class="o">=</span> <span class="n">DisulfideStats</span><span class="o">.</span><span class="n">calculate_cutoff_from_percentile</span><span class="p">(</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>                        <span class="n">sslist</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">percentile</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>                    <span class="p">)</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>                    <span class="n">ca_cutoff</span> <span class="o">=</span> <span class="n">cutoffs</span><span class="p">[</span><span class="s2">&quot;ca_cutoff_percentile&quot;</span><span class="p">]</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>                    <span class="n">sg_cutoff</span> <span class="o">=</span> <span class="n">cutoffs</span><span class="p">[</span><span class="s2">&quot;sg_cutoff_percentile&quot;</span><span class="p">]</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">=</span> <span class="n">ca_cutoff</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">sg_cutoff</span> <span class="o">=</span> <span class="n">sg_cutoff</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>                        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>                            <span class="sa">f</span><span class="s2">&quot;Using percentile cutoffs: </span><span class="si">{</span><span class="n">ca_cutoff</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">sg_cutoff</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a>                        <span class="p">)</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a>                <span class="n">old_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sslist</span><span class="p">)</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>                <span class="n">filt</span> <span class="o">=</span> <span class="n">sslist</span><span class="o">.</span><span class="n">filter_by_distance</span><span class="p">(</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>                    <span class="n">distance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">distance_type</span><span class="o">=</span><span class="s2">&quot;ca&quot;</span><span class="p">,</span> <span class="n">minimum</span><span class="o">=-</span><span class="mf">1.0</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>                <span class="p">)</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>                <span class="n">filt</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">(</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>                    <span class="n">filt</span><span class="p">,</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>                    <span class="sa">f</span><span class="s2">&quot;filtered by Ca cutoff:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Sg cutoff: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sg_cutoff</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>                <span class="p">)</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>                <span class="n">new_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filt</span><span class="p">)</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>                    <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>                        <span class="s2">&quot;Filtered with Cα cutoff </span><span class="si">%.2f</span><span class="s2">: old: </span><span class="si">%d</span><span class="s2">, new: </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span><span class="p">,</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>                        <span class="n">old_length</span><span class="p">,</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>                        <span class="n">new_length</span><span class="p">,</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>                    <span class="p">)</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>                <span class="n">old_length</span> <span class="o">=</span> <span class="n">new_length</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>                <span class="n">filt</span> <span class="o">=</span> <span class="n">filt</span><span class="o">.</span><span class="n">filter_by_distance</span><span class="p">(</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>                    <span class="n">distance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sg_cutoff</span><span class="p">,</span> <span class="n">distance_type</span><span class="o">=</span><span class="s2">&quot;sg&quot;</span><span class="p">,</span> <span class="n">minimum</span><span class="o">=-</span><span class="mf">1.0</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>                <span class="p">)</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>                <span class="n">new_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filt</span><span class="p">)</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>                    <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a>                        <span class="s2">&quot;Filtered with Sγ: cutoff </span><span class="si">%.2f</span><span class="s2">: old: </span><span class="si">%d</span><span class="s2">, new: </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">sg_cutoff</span><span class="p">,</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>                        <span class="n">old_length</span><span class="p">,</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>                        <span class="n">new_length</span><span class="p">,</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>                    <span class="p">)</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subset</span><span class="p">:</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="n">filt</span><span class="p">[:</span><span class="mi">5000</span><span class="p">],</span> <span class="s2">&quot;SUBSET_PDB_SS&quot;</span><span class="p">)</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="n">filt</span><span class="p">,</span> <span class="s2">&quot;ALL_PDB_SS&quot;</span><span class="p">)</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_disulfide_dict</span><span class="p">()</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">IDList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">torsion_df</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">)</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span> <span class="o">=</span> <span class="n">DisulfideClassManager</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loader initialization complete.&quot;</span><span class="p">)</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;File not found: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_path</span><span class="p">)</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>            <span class="k">raise</span> <span class="n">e</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;An error occurred while loading the file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_path</span><span class="p">)</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>            <span class="k">raise</span> <span class="n">e</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveit</span><span class="p">:</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>                <span class="n">savepath</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>                <span class="n">subset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">subset</span><span class="p">,</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>                <span class="n">cutoff</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span><span class="p">,</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>                <span class="n">sg_cutoff</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sg_cutoff</span><span class="p">,</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a>                <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a>            <span class="p">)</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>    <span class="c1"># overload __getitem__ to handle slicing and indexing, and access by name or classid</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a><span class="sd">        Implements indexing and slicing to retrieve DisulfideList objects from the</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a><span class="sd">        DisulfideLoader. Supports:</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a><span class="sd">        - Integer indexing to retrieve a single DisulfideList</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a><span class="sd">        - Slicing to retrieve a subset as a DisulfideList</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a><span class="sd">        - Lookup by PDB ID to retrieve all Disulfides for that structure</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a><span class="sd">        - Lookup by full disulfide name</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a><span class="sd">        - Lookup by classid in the format 11111b or 11111o. The last char is the class type.</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a><span class="sd">        - Lookup by classid in the format 11111. The base is 8 by default.</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a><span class="sd">        :param index: The index or key to retrieve the DisulfideList.</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a><span class="sd">        :type index: int, slice, str</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a><span class="sd">        :return: A DisulfideList object or a subset of it.</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a><span class="sd">        :rtype: DisulfideList</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a><span class="sd">        :raises DisulfideException: If the index or name is invalid.</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s2">&quot;none&quot;</span><span class="p">)</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>        <span class="n">ind_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">item</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">)))</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>            <span class="n">ind_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>            <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;pdb_slice[</span><span class="si">{</span><span class="n">ind_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">ind_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">]&quot;</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>            <span class="n">resolution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>            <span class="n">sublist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>            <span class="k">return</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="n">sublist</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">resolution</span><span class="p">)</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>            <span class="k">if</span> <span class="n">item</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">item</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span><span class="p">:</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>                    <span class="s2">&quot;DisulfideLoader(): Index </span><span class="si">%d</span><span class="s2"> out of range 0-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>                    <span class="n">item</span><span class="p">,</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>                <span class="p">)</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>                <span class="k">return</span> <span class="n">res</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>            <span class="k">return</span> <span class="n">res</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>        <span class="c1"># if the item is a string, it could be a PDB ID or a full disulfide name</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>        <span class="c1"># or a classid in the format 11111b or 11111o. the last char is the class type</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>  <span class="c1"># classid</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_class</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>            <span class="k">return</span> <span class="n">res</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>        <span class="c1"># PDB_SS[&#39;4yys&#39;] return a list of SS</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a>            <span class="k">if</span> <span class="n">indices</span><span class="p">:</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="n">item</span><span class="p">)</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a>                <span class="n">sslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>                <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a>                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sslist</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>                <span class="c1"># try to find the full disulfide name</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">get_by_name</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>  <span class="c1"># full disulfide name</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">get_by_name</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>  <span class="c1"># full disulfide name</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">res</span><span class="p">:</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;DisulfideLoader(): Cannot find key </span><span class="si">%s</span><span class="s2"> in SSBond DB&quot;</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_ss</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_ss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Disulfide</span><span class="p">):</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>            <span class="k">return</span> <span class="n">value</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Disulfide object expected, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>    <span class="nd">@property</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">average_resolution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a><span class="sd">        Return the average structure resolution for the given list.</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a><span class="sd">        Result is cached since resolution values don&#39;t change after loading.</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a><span class="sd">        :return: Average resolution (A)</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>        <span class="n">sslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>        <span class="n">valid_resolutions</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>            <span class="n">ss</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a>            <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">sslist</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>            <span class="k">if</span> <span class="n">ss</span><span class="o">.</span><span class="n">resolution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ss</span><span class="o">.</span><span class="n">resolution</span> <span class="o">!=</span> <span class="o">-</span><span class="mf">1.0</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a>        <span class="p">]</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_resolutions</span><span class="p">:</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>            <span class="k">return</span> <span class="o">-</span><span class="mf">1.0</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">valid_resolutions</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_resolutions</span><span class="p">)</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">binary_to_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">binary_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a><span class="sd">        Convert a binary class string to an octant class string.</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a><span class="sd">        :param binary_class: The binary class string to convert.</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a><span class="sd">        :param base: The base class to use, 2 or 8.</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a><span class="sd">        :return: The octant class list.</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="o">.</span><span class="n">binary_to_class</span><span class="p">(</span><span class="n">binary_class</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build_ss_from_idlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idlist</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a><span class="sd">        Return a DisulfideList of Disulfides for a given list of PDBIDs</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a><span class="sd">        :param idlist: List of PDBIDs, e.g. [&#39;4yys&#39;, &#39;2q7q&#39;]</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a><span class="sd">        :return: DisulfideList</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s2">&quot;RCSB_list&quot;</span><span class="p">)</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>        <span class="k">for</span> <span class="n">pdbid</span><span class="p">,</span> <span class="n">sslist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>            <span class="k">if</span> <span class="n">pdbid</span> <span class="ow">in</span> <span class="n">idlist</span><span class="p">:</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>                <span class="k">for</span> <span class="n">ssid</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">:</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="n">ssid</span><span class="p">])</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_class_indices_from_tors_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_string</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">:</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a><span class="sd">        Return the row indices of the torsion dataframe that match the class string.</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a><span class="sd">        This method is used internally to find the indices of rows in the torsion dataframe</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a><span class="sd">        that match the specified class string based on the given base.</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a><span class="sd">        :param class_string: The class string to match in the torsion dataframe.</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a><span class="sd">        :type class_string: str</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a><span class="sd">        :param base: The base class to use for matching, either 2 or 8. Defaults to 8.</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a><span class="sd">        :type base: int</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a><span class="sd">        :return: The row indices of the torsion dataframe that match the class string.</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a><span class="sd">        :rtype: pd.Index</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a><span class="sd">        :raises ValueError: If the base is not 2 or 8.</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>        <span class="n">tors_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>        <span class="k">match</span> <span class="n">base</span><span class="p">:</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>            <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>                <span class="n">column</span> <span class="o">=</span> <span class="s2">&quot;octant_class_string&quot;</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>            <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>                <span class="n">column</span> <span class="o">=</span> <span class="s2">&quot;binary_class_string&quot;</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Base must be 2 or 8, not </span><span class="si">{</span><span class="n">base</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>        <span class="k">return</span> <span class="n">tors_df</span><span class="p">[</span><span class="n">tors_df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">==</span> <span class="n">class_string</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a><span class="sd">        Return a copy of self.</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a><span class="sd">        :return: Copy of self</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_create_disulfide_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a><span class="sd">        Create a dictionary from a list of disulfide objects where the key is the pdb_id</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a><span class="sd">        and the value is a list of indices of the disulfide objects in the list.</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a><span class="sd">        This is an internal method used during initialization.</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a><span class="sd">        :param disulfide_list: List of disulfide objects.</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a><span class="sd">        :type disulfide_list: list</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a><span class="sd">        :return: Dictionary with pdb_id as keys and lists of indices as values.</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a><span class="sd">        :rtype: dict</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>        <span class="n">disulfide_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>        <span class="n">disulfide_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">disulfide</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">disulfide_list</span><span class="p">):</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>            <span class="k">if</span> <span class="n">disulfide</span><span class="o">.</span><span class="n">pdb_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">disulfide_dict</span><span class="p">:</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>                <span class="n">disulfide_dict</span><span class="p">[</span><span class="n">disulfide</span><span class="o">.</span><span class="n">pdb_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>            <span class="n">disulfide_dict</span><span class="p">[</span><span class="n">disulfide</span><span class="o">.</span><span class="n">pdb_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>        <span class="k">return</span> <span class="n">disulfide_dict</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_class_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a><span class="sd">        Return the class incidence dataframe for the input base.</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a><span class="sd">        Result is cached since class distributions don&#39;t change after loading.</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a><span class="sd">        :param base: The base class to use, 2 or 8.</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a><span class="sd">        :return: pd.DataFrame</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="o">.</span><span class="n">get_class_df</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">extract_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clsid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a><span class="sd">        Return the list of disulfides corresponding to the input `clsid`.</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a><span class="sd">        :param clsid: The class name to extract.</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a><span class="sd">        :param verbose: If True, display progress bars, by default False</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a><span class="sd">        :return: The list of disulfide bonds from the class.</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>        <span class="c1"># cls = clsid[:5]</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>        <span class="bp">cls</span> <span class="o">=</span> <span class="n">clsid</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>        <span class="n">ss_ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>        <span class="n">class_disulfides</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>            <span class="n">ss_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="p">[</span><span class="n">clsid</span><span class="p">]</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Cannot find key </span><span class="si">%s</span><span class="s2"> in SSBond DB&quot;</span><span class="p">,</span> <span class="n">clsid</span><span class="p">)</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>            <span class="k">return</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>        <span class="n">tot_ss</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ss_ids</span><span class="p">)</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>        <span class="n">class_disulfides</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>        <span class="n">_pbar</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>            <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">tot_ss</span><span class="p">),</span> <span class="n">total</span><span class="o">=</span><span class="n">tot_ss</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">verbose</span> <span class="k">else</span> <span class="nb">range</span><span class="p">(</span><span class="n">tot_ss</span><span class="p">)</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>        <span class="p">)</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">_pbar</span><span class="p">:</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>            <span class="n">ssid</span> <span class="o">=</span> <span class="n">ss_ids</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>            <span class="n">class_disulfides</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ssid</span><span class="p">])</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>        <span class="k">return</span> <span class="n">class_disulfides</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">getlist</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a><span class="sd">        Return the list of Disulfides contained in the class.</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a><span class="sd">        :return: DisulfideList</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a><span class="sd">        :rtype: DisulfideList</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">)</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Disulfide</span><span class="p">:</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a><span class="sd">        Return the Disulfide with the given name from the list.</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a><span class="sd">        Result is cached since disulfide data doesn&#39;t change after loading.</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>        <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>            <span class="k">if</span> <span class="n">ss</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>                <span class="k">return</span> <span class="n">ss</span>  <span class="c1"># or ss.copy() !!!</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memusg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a><span class="sd">        Display information about the Disulfide database contained in `self`. if `quick` is False</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a><span class="sd">        then display the total RAM used by the object. This takes some time to compute; approximately</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a><span class="sd">        30 seconds on a 2024 MacBook Pro. M3 Max.</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a><span class="sd">        :param memusg: If True, don&#39;t display the RAM used by the `DisulfideLoader` object.</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a><span class="sd">        :return: None</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>        <span class="c1"># pylint: disable=E1101</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>        <span class="n">vers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>        <span class="n">tot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>        <span class="n">pdbs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">)</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>        <span class="n">ram</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>        <span class="k">if</span> <span class="n">memusg</span><span class="p">:</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>            <span class="n">ram</span> <span class="o">=</span> <span class="n">asizeof</span><span class="o">.</span><span class="n">asizeof</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">average_resolution</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>        <span class="n">cutoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>        <span class="n">sg_cutoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sg_cutoff</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>        <span class="n">timestr</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">))</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>        <span class="n">ssMinMax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">minmax_energy</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>        <span class="n">ssMin_name</span><span class="p">:</span> <span class="n">Disulfide</span> <span class="o">=</span> <span class="n">ssMinMax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>        <span class="n">ssMax_name</span><span class="p">:</span> <span class="n">Disulfide</span> <span class="o">=</span> <span class="n">ssMinMax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    =========== RCSB Disulfide Database Summary ============&quot;</span><span class="p">)</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       =========== Built: </span><span class="si">{</span><span class="n">timestr</span><span class="si">}</span><span class="s2"> ===========&quot;</span><span class="p">)</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PDB IDs present:                 </span><span class="si">{</span><span class="n">pdbs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Disulfides loaded:               </span><span class="si">{</span><span class="n">tot</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average structure resolution:    </span><span class="si">{</span><span class="n">res</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lowest Energy Disulfide:         </span><span class="si">{</span><span class="n">ssMin_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Highest Energy Disulfide:        </span><span class="si">{</span><span class="n">ssMax_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cα distance cutoff:              </span><span class="si">{</span><span class="n">cutoff</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sγ distance cutoff:              </span><span class="si">{</span><span class="n">sg_cutoff</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>        <span class="k">if</span> <span class="n">memusg</span><span class="p">:</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total RAM Used:                     </span><span class="si">{</span><span class="n">ram</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> GB.&quot;</span><span class="p">)</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;               ===== proteusPy: </span><span class="si">{</span><span class="n">vers</span><span class="si">}</span><span class="s2"> =====&quot;</span><span class="p">)</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display_overlay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdbid</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a><span class="sd">        Display all disulfides for a given PDB ID overlaid in stick mode against</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a><span class="sd">        a common coordinate frame. This allows us to see all of the disulfides</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a><span class="sd">        at one time in a single view. Colors vary smoothy between bonds.</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a><span class="sd">        :param self: DisulfideLoader object initialized with the database.</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a><span class="sd">        :param pdbid: the PDB id string, e.g. 4yys</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a><span class="sd">        :return: None</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a><span class="sd">        Example:</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a><span class="sd">        &gt;&gt;&gt; import proteusPy as pp</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a><span class="sd">        Instantiate the Loader with the SS database subset.</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = pp.Load_PDB_SS(verbose=False, subset=True)</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a><span class="sd">        Display the Disulfides from the PDB ID ```4yys```, overlaid onto</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a><span class="sd">        a common reference (the proximal disulfides).</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS.display_overlay(&#39;4yys&#39;, verbose=False)</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a><span class="sd">        You can also slice the loader and display as an overly.</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS[:8].display_overlay(verbose=False)</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>            <span class="n">ssbonds</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">pdbid</span><span class="p">]</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Cannot find key </span><span class="si">%s</span><span class="s2"> in SSBond DB&quot;</span><span class="p">,</span> <span class="n">pdbid</span><span class="p">)</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>            <span class="k">return</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>        <span class="n">ssbonds</span><span class="o">.</span><span class="n">display_overlay</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>        <span class="k">return</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">getTorsions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdbID</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a><span class="sd">        Return the torsions, distances and energies defined by Torsion_DF_cols</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a><span class="sd">        :param pdbID: pdbID, defaults to None, meaning return entire dataset.</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a><span class="sd">        :type pdbID: str, optional used to extract for a specific PDB structure. If not specified</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a><span class="sd">            then return the entire dataset.</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a><span class="sd">        :raises DisulfideParseWarning: Raised if not found</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a><span class="sd">        :return: Torsions Dataframe</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a><span class="sd">        :rtype: pd.DataFrame</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a><span class="sd">        Example:</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a><span class="sd">        &gt;&gt;&gt; import proteusPy as pp</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = pp.Load_PDB_SS(verbose=False, subset=True)</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a><span class="sd">        &gt;&gt;&gt; Tor_DF = PDB_SS.getTorsions()</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>        <span class="n">res_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>        <span class="k">if</span> <span class="n">pdbID</span><span class="p">:</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">[</span><span class="n">pdbID</span><span class="p">]</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>                <span class="n">sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">pdbID</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>                <span class="n">res_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">[</span><span class="n">sel</span><span class="p">]</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>                <span class="k">return</span> <span class="n">res_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>                <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Cannot find key </span><span class="si">{</span><span class="n">pdbID</span><span class="si">}</span><span class="s2"> in SSBond DB&quot;</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>                <span class="k">raise</span> <span class="n">DisulfideParseWarning</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>            <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">)</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_binary_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Enumerate the binary classes&quot;&quot;&quot;</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="o">.</span><span class="n">binaryclass_dict</span><span class="p">):</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class: |</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">|, |</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">|&quot;</span><span class="p">)</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_Classes</span><span class="p">(</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>        <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>        <span class="n">class_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>        <span class="n">theme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>        <span class="n">log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>        <span class="n">paginated</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>        <span class="n">page_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>    <span class="p">):</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a><span class="sd">        Plot the classes for the given base.</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a><span class="sd">        :param base: The base class to use, 2 or 8.</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a><span class="sd">        :param class_string: The class string to plot.</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a><span class="sd">        :param theme: The theme to use for the plot (&#39;auto&#39;, &#39;light&#39;, or &#39;dark&#39;).</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a><span class="sd">        :param log: Whether to use a log scale for the y-axis.</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a><span class="sd">        :param paginated: Whether to paginate the plot.</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a><span class="sd">        :param page_size: Number of items per page.</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>        <span class="c1"># from proteusPy.DisulfideVisualization import DisulfideVisualization</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>        <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_classes</span><span class="p">(</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="p">,</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>            <span class="n">class_string</span><span class="o">=</span><span class="n">class_string</span><span class="p">,</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>            <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">,</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>            <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>            <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>            <span class="n">page_size</span><span class="o">=</span><span class="n">page_size</span><span class="p">,</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>            <span class="n">paginated</span><span class="o">=</span><span class="n">paginated</span><span class="p">,</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>        <span class="p">)</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_classes_vs_cutoff</span><span class="p">(</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a><span class="sd">        Plot the total percentage and number of members for each octant class against the cutoff value.</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a><span class="sd">        :param cutoff: Percent cutoff value for filtering the classes.</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a><span class="sd">        :param steps: Number of steps to take in the cutoff.</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a><span class="sd">        :param base: The base class to use, 6 or 8.</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a><span class="sd">        :param theme: The theme to use for the plot (&#39;auto&#39;, &#39;light&#39;, or &#39;dark&#39;), defaults to &#39;auto&#39;.</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a><span class="sd">        :return: None</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>        <span class="c1"># from proteusPy.DisulfideVisualization import DisulfideVisualization</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>        <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_classes_vs_cutoff</span><span class="p">(</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">theme</span><span class="p">,</span> <span class="n">verbose</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>        <span class="p">)</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_binary_to_eightclass_incidence</span><span class="p">(</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>        <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;light&quot;</span><span class="p">,</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>        <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>        <span class="n">savedir</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>        <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>    <span class="p">):</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the incidence of all octant Disulfide classes for a given binary class.</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a><span class="sd">        :param theme: The theme to use for the plot</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a><span class="sd">        :param save: Whether to save the plots</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a><span class="sd">        :param savedir: Directory to save plots to</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a><span class="sd">        :param verbose: Whether to display verbose output</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>        <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_binary_to_eightclass_incidence</span><span class="p">(</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="p">,</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>            <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>            <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>            <span class="n">savedir</span><span class="o">=</span><span class="n">savedir</span><span class="p">,</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>            <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a>        <span class="p">)</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_count_vs_class_df</span><span class="p">(</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>        <span class="n">class_string</span><span class="p">,</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;title&quot;</span><span class="p">,</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>        <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>        <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>        <span class="n">savedir</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>        <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>        <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>        <span class="n">sample_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>        <span class="n">page_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>    <span class="p">):</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a><span class="sd">        Plot a line graph of count vs class ID using Plotly for the given disulfide class. The</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a><span class="sd">        base selects the class type to plot: 2, 6, or 8, for binary, sextant, or octant classes.</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a><span class="sd">        :param class_string: The binary class string to be plotted.</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a><span class="sd">        :param title: A string representing the title of the plot (default is &#39;title&#39;).</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a><span class="sd">        :param theme: Theme to use for the plot</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a><span class="sd">        :param save: Whether to save the plot</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a><span class="sd">        :param savedir: Directory to save the plot to</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a><span class="sd">        :param base: Base for class IDs (2 or 8)</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a><span class="sd">        :param verbose: Whether to display verbose output</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a><span class="sd">        :param log: Whether to use log scale for y-axis</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a><span class="sd">        :param sample_size: Number of items to sample</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a><span class="sd">        :param page_size: Number of items per page</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>        <span class="c1"># from proteusPy.DisulfideVisualization import DisulfideVisualization</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>        <span class="n">class_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="o">.</span><span class="n">binary_to_class</span><span class="p">(</span><span class="n">class_string</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_enumerate_class_fromlist</span><span class="p">(</span><span class="n">class_list</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>        <span class="k">if</span> <span class="n">sample_size</span><span class="p">:</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>            <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_count_vs_class_df_sampled</span><span class="p">(</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>                <span class="n">df</span><span class="p">,</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>                <span class="n">title</span><span class="p">,</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a>                <span class="n">theme</span><span class="p">,</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a>                <span class="n">save</span><span class="p">,</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>                <span class="n">savedir</span><span class="p">,</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>                <span class="n">base</span><span class="p">,</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>                <span class="n">verbose</span><span class="p">,</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>                <span class="n">log</span><span class="p">,</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>                <span class="n">sample_size</span><span class="p">,</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>            <span class="p">)</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>        <span class="k">elif</span> <span class="n">page_size</span><span class="p">:</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>            <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_count_vs_class_df_paginated</span><span class="p">(</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>                <span class="n">df</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">theme</span><span class="p">,</span> <span class="n">save</span><span class="p">,</span> <span class="n">savedir</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">page_size</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>            <span class="p">)</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>            <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_count_vs_class_df</span><span class="p">(</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>                <span class="n">df</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">theme</span><span class="p">,</span> <span class="n">save</span><span class="p">,</span> <span class="n">savedir</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">log</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>            <span class="p">)</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_count_vs_classid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a><span class="sd">        Plot a line graph of count vs class ID using Plotly.</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a><span class="sd">        :param cls: Specific class to plot (optional)</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a><span class="sd">        :param theme: Theme to use for the plot</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a><span class="sd">        :param base: Base for class IDs (2 or 8)</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a><span class="sd">        :param log: Whether to use log scale for y-axis</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>        <span class="c1"># from proteusPy.DisulfideVisualization import DisulfideVisualization</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>        <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_count_vs_classid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">theme</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">log</span><span class="p">)</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_enumerate_class_fromlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sslist</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a><span class="sd">        Enumerate the classes from a list of class IDs and return a DataFrame with class IDs and their corresponding counts.</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a><span class="sd">        Results are cached for improved performance on repeated calls.</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a><span class="sd">        :param sslist: A list of class IDs to enumerate.</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a><span class="sd">        :param base: The base value for the enumeration, by default 8.</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a><span class="sd">        :return: A DataFrame with columns &quot;class_id&quot; and &quot;count&quot; representing the class IDs and their corresponding counts.</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>        <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">:</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>            <span class="k">if</span> <span class="bp">cls</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>                <span class="n">_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="o">.</span><span class="n">sslist_from_classid</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>                <span class="c1"># it&#39;s possible to have 0 SS in a class</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>                <span class="k">if</span> <span class="n">_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>                    <span class="c1"># only append if we have both.</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>                    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>                    <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">_y</span><span class="p">))</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>        <span class="n">sslist_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">])</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>        <span class="n">sslist_df</span><span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>        <span class="n">sslist_df</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>        <span class="k">return</span> <span class="n">sslist_df</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>        <span class="n">savepath</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>        <span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a>        <span class="n">cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a>        <span class="n">sg_cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>    <span class="p">):</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a><span class="sd">        Save a copy of the fully instantiated Loader to the specified file.</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a><span class="sd">        :param savepath: Path to save the file, defaults to DATA_DIR</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a><span class="sd">        :param fname: Filename, defaults to LOADER_FNAME</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a><span class="sd">        :param verbose: Verbosity, defaults to False</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a><span class="sd">        :param cutoff: Ca-Ca Distance cutoff used to build the database, -1 means no cutoff.</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a><span class="sd">        :param sg_cutoff: Sg-Sg Distance cutoff used to build the database, -1 means no cutoff.</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">__version__</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">=</span> <span class="n">cutoff</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_cutoff</span> <span class="o">=</span> <span class="n">sg_cutoff</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>        <span class="n">fname</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>        <span class="k">if</span> <span class="n">subset</span><span class="p">:</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>            <span class="n">fname</span> <span class="o">=</span> <span class="n">LOADER_SUBSET_FNAME</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>            <span class="n">fname</span> <span class="o">=</span> <span class="n">LOADER_FNAME</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>        <span class="n">_fname</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">savepath</span><span class="p">)</span> <span class="o">/</span> <span class="n">fname</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Writing Disulfide Loader to: </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">_fname</span><span class="p">)</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">_fname</span><span class="p">),</span> <span class="s2">&quot;wb+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Done saving loader.&quot;</span><span class="p">)</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_disulfides_vs_pdbid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a><span class="sd">        Plots the number of disulfides versus pdbid.</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a><span class="sd">        :param cutoff: The minimum number of disulfides a PDB ID must have to be included in the plot.</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a><span class="sd">        :type cutoff: int</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a><span class="sd">        :return: A tuple containing the list of PDB IDs and the corresponding number of disulfides.</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a><span class="sd">        :rtype: tuple</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>        <span class="n">pdbids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>        <span class="n">num_disulfides</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>        <span class="k">for</span> <span class="n">pdbid</span><span class="p">,</span> <span class="n">disulfides</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">disulfides</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">cutoff</span><span class="p">:</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>                <span class="n">pdbids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdbid</span><span class="p">)</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>                <span class="n">num_disulfides</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">disulfides</span><span class="p">))</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>        <span class="c1"># Create a DataFrame</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;PDB ID&quot;</span><span class="p">:</span> <span class="n">pdbids</span><span class="p">,</span> <span class="s2">&quot;Number of Disulfides&quot;</span><span class="p">:</span> <span class="n">num_disulfides</span><span class="p">})</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a>            <span class="n">df</span><span class="p">,</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>            <span class="n">x</span><span class="o">=</span><span class="s2">&quot;PDB ID&quot;</span><span class="p">,</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a>            <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Number of Disulfides&quot;</span><span class="p">,</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a>            <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Disulfides vs PDB ID with cutoff: </span><span class="si">{</span><span class="n">cutoff</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pdbids</span><span class="p">)</span><span class="si">}</span><span class="s2"> PDB IDs&quot;</span><span class="p">,</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a>        <span class="p">)</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>            <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;PDB ID&quot;</span><span class="p">,</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>            <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&quot;Number of Disulfides&quot;</span><span class="p">,</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>            <span class="n">xaxis_tickangle</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a>        <span class="p">)</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>        <span class="k">return</span> <span class="n">pdbids</span><span class="p">,</span> <span class="n">num_disulfides</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_distances</span><span class="p">(</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">distance_type</span><span class="o">=</span><span class="s2">&quot;ca&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">comparison</span><span class="o">=</span><span class="s2">&quot;less&quot;</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>    <span class="p">):</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a><span class="sd">        Plot the distances for the disulfides in the loader.</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a><span class="sd">        :param distance_type: The type of distance to plot (&#39;ca&#39; for Cα-Cα distance, &#39;sg&#39; for Sγ-Sγ distance)</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a><span class="sd">        :param cutoff: The cutoff value for the distance, defaults to -1 (no cutoff)</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a><span class="sd">        :param comparison: if &#39;less&#39; then plot distances less than the cutoff, if &#39;greater&#39; then plot distances greater than the cutoff</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a><span class="sd">        :param theme: The theme to use for the plot (&#39;auto&#39;, &#39;light&#39;, or &#39;dark&#39;)</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a><span class="sd">        :param log: Whether to use a log scale for the y-axis</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>        <span class="c1"># from proteusPy.DisulfideVisualization import DisulfideVisualization</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>        <span class="c1"># sslist = self.SSList</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>        <span class="c1"># distances = sslist.extract_distances(distance_type, comparison, cutoff)</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">plot_distances</span><span class="p">(</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>            <span class="n">distance_type</span><span class="o">=</span><span class="n">distance_type</span><span class="p">,</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>            <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>            <span class="n">comparison</span><span class="o">=</span><span class="n">comparison</span><span class="p">,</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>            <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>            <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>        <span class="p">)</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_deviation_scatterplots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">):</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a><span class="sd">        Plot scatter plots for Bondlength_Deviation, Angle_Deviation Ca_Distance</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a><span class="sd">        and SG_Distance.</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a><span class="sd">        :param verbose: Whether to display the plot in the notebook. Default is False.</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a><span class="sd">        :type verbose: bool</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a><span class="sd">        :param theme: One of &#39;Auto&#39;, &#39;Light&#39;, or &#39;Dark&#39;. Default is &#39;Auto&#39;.</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a><span class="sd">        :type light: str</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a><span class="sd">        :return: None</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">plot_deviation_scatterplots</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">)</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_deviation_histograms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a><span class="sd">        Plot histograms for Bondlength_Deviation, Angle_Deviation, and Ca_Distance.</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">plot_deviation_histograms</span><span class="p">(</span><span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_classes</span><span class="p">(</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">class_string</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">page_size</span><span class="o">=</span><span class="mi">200</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>    <span class="p">):</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a><span class="sd">        Plot the distribution of disulfides for the given class string.</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a><span class="sd">        :param class_string: The class string to plot.</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a><span class="sd">        :type class_string: str</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a><span class="sd">        :param base: The base of the class string. Default is 8.</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a><span class="sd">        :type base: int</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a><span class="sd">        :param theme: The theme to use for the plot (&#39;auto&#39;, &#39;light&#39;, or &#39;dark&#39;), defaults to &#39;auto&#39;.</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a><span class="sd">        :type theme: str</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a><span class="sd">        :return: None</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a>        <span class="n">classlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="o">.</span><span class="n">binary_to_class</span><span class="p">(</span><span class="n">class_string</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_enumerate_class_fromlist</span><span class="p">(</span><span class="n">classlist</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot_count_vs_class_df</span><span class="p">(</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>            <span class="n">df</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">class_string</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span> <span class="n">page_size</span><span class="o">=</span><span class="n">page_size</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>        <span class="p">)</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>        <span class="k">return</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sslist_from_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_string</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a><span class="sd">        Return a DisulfideList containing Disulfides with the given class_string.</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a><span class="sd">        :param class_string: The class string to search for.</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a><span class="sd">        :param base: The base of the class string. Default is 8.</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a><span class="sd">        :param cutoff: The % cutoff value for the class. Default is 0.0.</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a><span class="sd">        :return: DisulfideList containing Disulfides with the given class_string.</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>        <span class="n">sslist_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">class_string</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">base</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">cutoff</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>        <span class="n">sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="n">sslist_name</span><span class="p">)</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>        <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_class_indices_from_tors_df</span><span class="p">(</span><span class="n">class_string</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>            <span class="n">sslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>        <span class="k">return</span> <span class="n">sslist</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display_torsion_statistics</span><span class="p">(</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>        <span class="n">class_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>        <span class="n">display</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>        <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>        <span class="n">fname</span><span class="o">=</span><span class="s2">&quot;ss_torsions.png&quot;</span><span class="p">,</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>        <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>    <span class="p">):</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a><span class="sd">        Display torsion and distance statistics for Disulfides in the loader.</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a><span class="sd">        :param class_id: The class ID to display statistics for. Default is None.</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a><span class="sd">        :type class_id: str</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a><span class="sd">        :param display: Whether to display the plot in the notebook. Default is True.</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a><span class="sd">        :type display: bool</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a><span class="sd">        :param save: Whether to save the plot as an image file. Default is False.</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a><span class="sd">        :type save: bool</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a><span class="sd">        :param fname: The name of the image file to save. Default is &#39;ss_torsions.png&#39;.</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a><span class="sd">        :type fname: str</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a><span class="sd">        :param theme: One of &#39;Auto&#39;, &#39;Light&#39;, or &#39;Dark&#39;. Default is &#39;Auto&#39;.</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a><span class="sd">        :type theme: str</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a><span class="sd">        :param verbose: Whether to display verbose output. Default is False.</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a><span class="sd">        :type verbose: bool</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a><span class="sd">        :return: None</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>        <span class="k">if</span> <span class="n">class_id</span><span class="p">:</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>            <span class="n">sslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_class</span><span class="p">(</span><span class="n">class_id</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>            <span class="n">sslist</span><span class="o">.</span><span class="n">display_torsion_statistics</span><span class="p">(</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>                <span class="n">display</span><span class="o">=</span><span class="n">display</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">fname</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="n">theme</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>            <span class="p">)</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">display_torsion_statistics</span><span class="p">(</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>                <span class="n">display</span><span class="o">=</span><span class="n">display</span><span class="p">,</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>                <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>                <span class="n">fname</span><span class="o">=</span><span class="n">fname</span><span class="p">,</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>                <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>            <span class="p">)</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">classes_vs_cutoff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a><span class="sd">        Return number of members for the octant class for a given cutoff value.</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a><span class="sd">        :param cutoff: Percent cutoff value for filtering the classes.</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a><span class="sd">        :return: None</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>        <span class="n">class_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="o">.</span><span class="n">filter_class_by_percentage</span><span class="p">(</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>        <span class="k">return</span> <span class="n">class_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a><span class="c1"># class ends</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a><span class="k">def</span><span class="w"> </span><span class="nf">Load_PDB_SS</span><span class="p">(</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>    <span class="n">loadpath</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>    <span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>    <span class="n">cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>    <span class="n">sg_cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>    <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideLoader</span><span class="p">:</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a><span class="sd">    Load the fully instantiated Disulfide database from the specified file. This function</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a><span class="sd">    will load the pre-built database if available, or bootstrap a new loader by downloading</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a><span class="sd">    the data from Google Drive if needed. Use the provided parameters to control the loading</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a><span class="sd">    behavior, filtering cutoffs, and verbosity.</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a><span class="sd">    :param loadpath: Path from which to load the database; defaults to DATA_DIR.</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a><span class="sd">    :type loadpath: str</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a><span class="sd">    :param verbose: If True, enables verbose logging; defaults to False.</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a><span class="sd">    :type verbose: bool</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a><span class="sd">    :param subset: If True, loads the subset database; otherwise loads the full database.</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a><span class="sd">    :type subset: bool</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a><span class="sd">    :param cutoff: Cα distance cutoff used to filter disulfides; defaults to CA_CUTOFF.</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a><span class="sd">    :type cutoff: float</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a><span class="sd">    :param sg_cutoff: Sγ distance cutoff used to filter disulfides; defaults to SG_CUTOFF.</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a><span class="sd">    :type sg_cutoff: float</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a><span class="sd">    :param force: If True, forces re-loading from Google Drive even if the file exists; defaults to False.</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a><span class="sd">    :type force: bool</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a><span class="sd">    :param percentile: Percentile (0-100) to compute cutoffs dynamically; if set to -1.0, the percentile method is not used.</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a><span class="sd">    :type percentile: float</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a><span class="sd">    :return: An instance of DisulfideLoader containing the loaded disulfide database.</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a><span class="sd">    :rtype: DisulfideLoader</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a><span class="sd">    Example:</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy import Load_PDB_SS, create_logger</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a><span class="sd">        &gt;&gt;&gt; import logging</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a><span class="sd">        &gt;&gt;&gt; _logger = create_logger(&quot;testing&quot;)</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a><span class="sd">        &gt;&gt;&gt; _logger.setLevel(logging.WARNING)</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a><span class="sd">        &gt;&gt;&gt; loader = Load_PDB_SS(verbose=False, subset=True)</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a><span class="sd">        &gt;&gt;&gt; print(loader[0])</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a><span class="sd">        &lt;Disulfide 6dmb_203A_226A, Source: 6dmb, Resolution: 3.0 Å&gt;</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>    <span class="c1"># normally the .pkl files are local, EXCEPT for the first run from a newly-installed proteusPy</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>    <span class="c1"># distribution. In that case we need to download the files for all disulfides and the subset</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>    <span class="c1"># from my Google Drive. This is a one-time operation.</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>    <span class="n">_fname_sub</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">loadpath</span><span class="p">)</span> <span class="o">/</span> <span class="n">LOADER_SUBSET_FNAME</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>    <span class="n">_fname_all</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">loadpath</span><span class="p">)</span> <span class="o">/</span> <span class="n">LOADER_FNAME</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>    <span class="n">_fpath</span> <span class="o">=</span> <span class="n">_fname_sub</span> <span class="k">if</span> <span class="n">subset</span> <span class="k">else</span> <span class="n">_fname_all</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">_fpath</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">or</span> <span class="n">force</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bootstrapping new loader: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">_fpath</span><span class="p">)</span><span class="si">}</span><span class="s2">... &quot;</span><span class="p">)</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a>        <span class="n">loader</span> <span class="o">=</span> <span class="n">Bootstrap_PDB_SS</span><span class="p">(</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>            <span class="n">loadpath</span><span class="o">=</span><span class="n">loadpath</span><span class="p">,</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>            <span class="n">subset</span><span class="o">=</span><span class="n">subset</span><span class="p">,</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>            <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">,</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>            <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a>            <span class="n">sg_cutoff</span><span class="o">=</span><span class="n">sg_cutoff</span><span class="p">,</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>        <span class="p">)</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>        <span class="n">loader</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>            <span class="n">savepath</span><span class="o">=</span><span class="n">loadpath</span><span class="p">,</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>            <span class="n">subset</span><span class="o">=</span><span class="n">subset</span><span class="p">,</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>            <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>            <span class="n">sg_cutoff</span><span class="o">=</span><span class="n">sg_cutoff</span><span class="p">,</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>        <span class="p">)</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>        <span class="k">return</span> <span class="n">loader</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Reading disulfides from: </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">_fpath</span><span class="p">)</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">_fpath</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>        <span class="n">loader</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Done reading disulfides from: </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">_fpath</span><span class="p">)</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>        <span class="n">loader</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>    <span class="k">return</span> <span class="n">loader</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a><span class="k">def</span><span class="w"> </span><span class="nf">Bootstrap_PDB_SS</span><span class="p">(</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>    <span class="n">loadpath</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>    <span class="n">cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a>    <span class="n">sg_cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a>    <span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>    <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a>    <span class="n">fake</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a><span class="p">):</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a><span class="sd">    Download and instantiate the disulfide databases from Google Drive.</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a><span class="sd">    This function downloads the disulfide master SS list from Google Drive if it doesn&#39;t</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a><span class="sd">    already exist in the specified load path or if the force flag is set to True.</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a><span class="sd">    It then loads the disulfide data from the downloaded file and initializes a</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a><span class="sd">    DisulfideLoader instance.</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a><span class="sd">    :param loadpath: Path from which to load the data, defaults to DATA_DIR</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a><span class="sd">    :type loadpath: str</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a><span class="sd">    :param cutoff: Cutoff value for disulfide loading, defaults to -1.0 (no filtering)</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a><span class="sd">    :type cutoff: float</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a><span class="sd">    :param sg_cutoff: Cutoff value for disulfide loading, defaults to -1.0 (no filtering)</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a><span class="sd">    :type sg_cutoff: float</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a><span class="sd">    :param verbose: Flag to enable verbose logging, defaults to False</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a><span class="sd">    :type verbose: bool</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a><span class="sd">    :param subset: Flag to indicate whether to load a subset of the data, defaults to False</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a><span class="sd">    :type subset: bool</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a><span class="sd">    :param force: Flag to force download even if the file exists, defaults to False</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a><span class="sd">    :type force: bool</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a><span class="sd">    :return: An instance of DisulfideLoader initialized with the loaded data</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a><span class="sd">    :rtype: DisulfideLoader</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>    <span class="n">fname</span> <span class="o">=</span> <span class="n">SS_PICKLE_FILE</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a>    <span class="n">url</span> <span class="o">=</span> <span class="n">SS_LIST_URL</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a>    <span class="c1"># _fname = Path(loadpath) / fname</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a>    <span class="n">full_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">loadpath</span><span class="p">)</span> <span class="o">/</span> <span class="n">fname</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">full_path</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">or</span> <span class="n">force</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Can&#39;t find </span><span class="si">%s</span><span class="s2">. Downloading from Drive...&quot;</span><span class="p">,</span> <span class="n">full_path</span><span class="p">)</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">fake</span><span class="p">:</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a>            <span class="n">gdown</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">full_path</span><span class="p">),</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Fake download: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_path</span><span class="p">)</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>            <span class="s2">&quot;Building loader from: </span><span class="si">%s</span><span class="s2"> with cutoffs </span><span class="si">%f</span><span class="s2">, </span><span class="si">%f</span><span class="s2">...&quot;</span><span class="p">,</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>            <span class="n">full_path</span><span class="p">,</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>            <span class="n">cutoff</span><span class="p">,</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>            <span class="n">sg_cutoff</span><span class="p">,</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>        <span class="p">)</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>    <span class="n">loader</span> <span class="o">=</span> <span class="n">DisulfideLoader</span><span class="p">(</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>        <span class="n">datadir</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>        <span class="n">subset</span><span class="o">=</span><span class="n">subset</span><span class="p">,</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>        <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>        <span class="n">sg_cutoff</span><span class="o">=</span><span class="n">sg_cutoff</span><span class="p">,</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>    <span class="p">)</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>    <span class="k">if</span> <span class="n">loader</span><span class="o">.</span><span class="n">TotalDisulfides</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;No disulfides loaded!&quot;</span><span class="p">)</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Done building loader.&quot;</span><span class="p">)</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a>    <span class="k">return</span> <span class="n">loader</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">doctest</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a>    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">()</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a><span class="c1"># End of file</span>
</span></pre></div>


            </section>
                <section id="DisulfideLoader">
                            <input id="DisulfideLoader-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">DisulfideLoader</span>:

                <label class="view-source-button" for="DisulfideLoader-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader-62"><a href="#DisulfideLoader-62"><span class="linenos"> 62</span></a><span class="nd">@dataclass</span>
</span><span id="DisulfideLoader-63"><a href="#DisulfideLoader-63"><span class="linenos"> 63</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DisulfideLoader</span><span class="p">:</span>
</span><span id="DisulfideLoader-64"><a href="#DisulfideLoader-64"><span class="linenos"> 64</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-65"><a href="#DisulfideLoader-65"><span class="linenos"> 65</span></a><span class="sd">    This class represents the disulfide database itself and is its primary means of accession.</span>
</span><span id="DisulfideLoader-66"><a href="#DisulfideLoader-66"><span class="linenos"> 66</span></a><span class="sd">    The entirety of the RCSB disulfide database is stored within the class via a</span>
</span><span id="DisulfideLoader-67"><a href="#DisulfideLoader-67"><span class="linenos"> 67</span></a><span class="sd">    proteusPy.DisulfideList, a ```Pandas``` .csv file, and a ```dict``` of</span>
</span><span id="DisulfideLoader-68"><a href="#DisulfideLoader-68"><span class="linenos"> 68</span></a><span class="sd">    indices mapping the PDB IDs into their respective list of disulfides. The datastructures allow</span>
</span><span id="DisulfideLoader-69"><a href="#DisulfideLoader-69"><span class="linenos"> 69</span></a><span class="sd">    simple, direct and flexible access to the disulfide structures contained herein.</span>
</span><span id="DisulfideLoader-70"><a href="#DisulfideLoader-70"><span class="linenos"> 70</span></a><span class="sd">    This makes it possible to access the disulfides by array index, PDB structure ID, disulfide</span>
</span><span id="DisulfideLoader-71"><a href="#DisulfideLoader-71"><span class="linenos"> 71</span></a><span class="sd">    name and class ID.</span>
</span><span id="DisulfideLoader-72"><a href="#DisulfideLoader-72"><span class="linenos"> 72</span></a>
</span><span id="DisulfideLoader-73"><a href="#DisulfideLoader-73"><span class="linenos"> 73</span></a><span class="sd">    The class also provides methods for plotting distance and angle deviations</span>
</span><span id="DisulfideLoader-74"><a href="#DisulfideLoader-74"><span class="linenos"> 74</span></a><span class="sd">    as well as torsion statistics for the disulfides in the database.</span>
</span><span id="DisulfideLoader-75"><a href="#DisulfideLoader-75"><span class="linenos"> 75</span></a>
</span><span id="DisulfideLoader-76"><a href="#DisulfideLoader-76"><span class="linenos"> 76</span></a><span class="sd">    The class can also render Disulfides overlaid on a common coordinate system to a pyVista</span>
</span><span id="DisulfideLoader-77"><a href="#DisulfideLoader-77"><span class="linenos"> 77</span></a><span class="sd">    window using the [display_overlay()](#DisulfideLoader.display_overlay) method. See below for examples.</span>
</span><span id="DisulfideLoader-78"><a href="#DisulfideLoader-78"><span class="linenos"> 78</span></a>
</span><span id="DisulfideLoader-79"><a href="#DisulfideLoader-79"><span class="linenos"> 79</span></a><span class="sd">    Important note: For typical usage one will access the database via the `Load_PDB_SS()` function.</span>
</span><span id="DisulfideLoader-80"><a href="#DisulfideLoader-80"><span class="linenos"> 80</span></a><span class="sd">    The difference is that the latter function loads the compressed database from its single</span>
</span><span id="DisulfideLoader-81"><a href="#DisulfideLoader-81"><span class="linenos"> 81</span></a><span class="sd">    source. The `DisulfideLoader` class is used to build the Disulifde database with a</span>
</span><span id="DisulfideLoader-82"><a href="#DisulfideLoader-82"><span class="linenos"> 82</span></a><span class="sd">    specific cutoff, or for saving the database to a file.</span>
</span><span id="DisulfideLoader-83"><a href="#DisulfideLoader-83"><span class="linenos"> 83</span></a>
</span><span id="DisulfideLoader-84"><a href="#DisulfideLoader-84"><span class="linenos"> 84</span></a><span class="sd">    Cutoff values of -1.0 indicate imposing no cutoffs on the data.</span>
</span><span id="DisulfideLoader-85"><a href="#DisulfideLoader-85"><span class="linenos"> 85</span></a>
</span><span id="DisulfideLoader-86"><a href="#DisulfideLoader-86"><span class="linenos"> 86</span></a><span class="sd">    :param verbose: Flag to control output verbosity</span>
</span><span id="DisulfideLoader-87"><a href="#DisulfideLoader-87"><span class="linenos"> 87</span></a><span class="sd">    :type verbose: bool</span>
</span><span id="DisulfideLoader-88"><a href="#DisulfideLoader-88"><span class="linenos"> 88</span></a><span class="sd">    :param datadir: Directory containing data files</span>
</span><span id="DisulfideLoader-89"><a href="#DisulfideLoader-89"><span class="linenos"> 89</span></a><span class="sd">    :type datadir: str</span>
</span><span id="DisulfideLoader-90"><a href="#DisulfideLoader-90"><span class="linenos"> 90</span></a><span class="sd">    :param picklefile: Name of the pickle file containing disulfide data</span>
</span><span id="DisulfideLoader-91"><a href="#DisulfideLoader-91"><span class="linenos"> 91</span></a><span class="sd">    :type picklefile: str</span>
</span><span id="DisulfideLoader-92"><a href="#DisulfideLoader-92"><span class="linenos"> 92</span></a><span class="sd">    :param quiet: Flag to suppress warnings</span>
</span><span id="DisulfideLoader-93"><a href="#DisulfideLoader-93"><span class="linenos"> 93</span></a><span class="sd">    :type quiet: bool</span>
</span><span id="DisulfideLoader-94"><a href="#DisulfideLoader-94"><span class="linenos"> 94</span></a><span class="sd">    :param subset: Flag to load only a subset of data</span>
</span><span id="DisulfideLoader-95"><a href="#DisulfideLoader-95"><span class="linenos"> 95</span></a><span class="sd">    :type subset: bool</span>
</span><span id="DisulfideLoader-96"><a href="#DisulfideLoader-96"><span class="linenos"> 96</span></a><span class="sd">    :param cutoff: Distance cutoff, (A) for filtering disulfides. Defaults to -1.0.</span>
</span><span id="DisulfideLoader-97"><a href="#DisulfideLoader-97"><span class="linenos"> 97</span></a><span class="sd">    :type cutoff: float</span>
</span><span id="DisulfideLoader-98"><a href="#DisulfideLoader-98"><span class="linenos"> 98</span></a><span class="sd">    :param sg_cutoff: SG distance cutoff, (A) for filtering disulfides. Defaults to -1.0.</span>
</span><span id="DisulfideLoader-99"><a href="#DisulfideLoader-99"><span class="linenos"> 99</span></a><span class="sd">    :type sg_cutoff: float</span>
</span><span id="DisulfideLoader-100"><a href="#DisulfideLoader-100"><span class="linenos">100</span></a><span class="sd">    :param percentile: Percentile cutoff for filtering disulfides. Must be between 0 and 100.</span>
</span><span id="DisulfideLoader-101"><a href="#DisulfideLoader-101"><span class="linenos">101</span></a><span class="sd">    Filters based on statistical cutoffs derived from the data.</span>
</span><span id="DisulfideLoader-102"><a href="#DisulfideLoader-102"><span class="linenos">102</span></a><span class="sd">    :type percentile: float</span>
</span><span id="DisulfideLoader-103"><a href="#DisulfideLoader-103"><span class="linenos">103</span></a><span class="sd">    :param minimum: Minimum atom distance for filtering disulfides. -1 is no filtering.</span>
</span><span id="DisulfideLoader-104"><a href="#DisulfideLoader-104"><span class="linenos">104</span></a><span class="sd">    :type minimum: float</span>
</span><span id="DisulfideLoader-105"><a href="#DisulfideLoader-105"><span class="linenos">105</span></a><span class="sd">    :param save: Flag to save the Loader to a file</span>
</span><span id="DisulfideLoader-106"><a href="#DisulfideLoader-106"><span class="linenos">106</span></a><span class="sd">    :type save: bool</span>
</span><span id="DisulfideLoader-107"><a href="#DisulfideLoader-107"><span class="linenos">107</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-108"><a href="#DisulfideLoader-108"><span class="linenos">108</span></a>
</span><span id="DisulfideLoader-109"><a href="#DisulfideLoader-109"><span class="linenos">109</span></a>    <span class="c1"># Fields that serve as both instance attributes and initialization parameters</span>
</span><span id="DisulfideLoader-110"><a href="#DisulfideLoader-110"><span class="linenos">110</span></a>    <span class="n">datadir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">)</span>
</span><span id="DisulfideLoader-111"><a href="#DisulfideLoader-111"><span class="linenos">111</span></a>    <span class="n">picklefile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">SS_PICKLE_FILE</span><span class="p">)</span>
</span><span id="DisulfideLoader-112"><a href="#DisulfideLoader-112"><span class="linenos">112</span></a>    <span class="n">subset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="DisulfideLoader-113"><a href="#DisulfideLoader-113"><span class="linenos">113</span></a>    <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="DisulfideLoader-114"><a href="#DisulfideLoader-114"><span class="linenos">114</span></a>    <span class="n">sg_cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="DisulfideLoader-115"><a href="#DisulfideLoader-115"><span class="linenos">115</span></a>    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="DisulfideLoader-116"><a href="#DisulfideLoader-116"><span class="linenos">116</span></a>    <span class="n">percentile</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="DisulfideLoader-117"><a href="#DisulfideLoader-117"><span class="linenos">117</span></a>    <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="DisulfideLoader-118"><a href="#DisulfideLoader-118"><span class="linenos">118</span></a>    <span class="n">minimum</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="DisulfideLoader-119"><a href="#DisulfideLoader-119"><span class="linenos">119</span></a>    <span class="n">saveit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="DisulfideLoader-120"><a href="#DisulfideLoader-120"><span class="linenos">120</span></a>
</span><span id="DisulfideLoader-121"><a href="#DisulfideLoader-121"><span class="linenos">121</span></a>    <span class="c1"># Fields that are only used internally and don&#39;t need to be initialization parameters</span>
</span><span id="DisulfideLoader-122"><a href="#DisulfideLoader-122"><span class="linenos">122</span></a>    <span class="n">SSList</span><span class="p">:</span> <span class="n">DisulfideList</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
</span><span id="DisulfideLoader-123"><a href="#DisulfideLoader-123"><span class="linenos">123</span></a>        <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s2">&quot;ALL_PDB_SS&quot;</span><span class="p">),</span> <span class="n">init</span><span class="o">=</span><span class="kc">False</span>
</span><span id="DisulfideLoader-124"><a href="#DisulfideLoader-124"><span class="linenos">124</span></a>    <span class="p">)</span>
</span><span id="DisulfideLoader-125"><a href="#DisulfideLoader-125"><span class="linenos">125</span></a>    <span class="n">SSDict</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="DisulfideLoader-126"><a href="#DisulfideLoader-126"><span class="linenos">126</span></a>    <span class="n">TorsionDF</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="DisulfideLoader-127"><a href="#DisulfideLoader-127"><span class="linenos">127</span></a>    <span class="n">TotalDisulfides</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="DisulfideLoader-128"><a href="#DisulfideLoader-128"><span class="linenos">128</span></a>    <span class="n">IDList</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="DisulfideLoader-129"><a href="#DisulfideLoader-129"><span class="linenos">129</span></a>    <span class="n">tclass</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DisulfideClassManager</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="DisulfideLoader-130"><a href="#DisulfideLoader-130"><span class="linenos">130</span></a>    <span class="n">timestamp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="DisulfideLoader-131"><a href="#DisulfideLoader-131"><span class="linenos">131</span></a>    <span class="n">version</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">__version__</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="DisulfideLoader-132"><a href="#DisulfideLoader-132"><span class="linenos">132</span></a>
</span><span id="DisulfideLoader-133"><a href="#DisulfideLoader-133"><span class="linenos">133</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideLoader-134"><a href="#DisulfideLoader-134"><span class="linenos">134</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-135"><a href="#DisulfideLoader-135"><span class="linenos">135</span></a><span class="sd">        Initialize the DisulfideLoader after dataclass initialization.</span>
</span><span id="DisulfideLoader-136"><a href="#DisulfideLoader-136"><span class="linenos">136</span></a><span class="sd">        This method handles loading and processing of the disulfide data.</span>
</span><span id="DisulfideLoader-137"><a href="#DisulfideLoader-137"><span class="linenos">137</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-138"><a href="#DisulfideLoader-138"><span class="linenos">138</span></a>
</span><span id="DisulfideLoader-139"><a href="#DisulfideLoader-139"><span class="linenos">139</span></a>        <span class="n">cutoffs</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideLoader-140"><a href="#DisulfideLoader-140"><span class="linenos">140</span></a>        <span class="n">old_length</span> <span class="o">=</span> <span class="n">new_length</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DisulfideLoader-141"><a href="#DisulfideLoader-141"><span class="linenos">141</span></a>        <span class="n">full_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datadir</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">picklefile</span>
</span><span id="DisulfideLoader-142"><a href="#DisulfideLoader-142"><span class="linenos">142</span></a>
</span><span id="DisulfideLoader-143"><a href="#DisulfideLoader-143"><span class="linenos">143</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span><span class="p">:</span>
</span><span id="DisulfideLoader-144"><a href="#DisulfideLoader-144"><span class="linenos">144</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="DisulfideLoader-145"><a href="#DisulfideLoader-145"><span class="linenos">145</span></a>                <span class="sa">f</span><span class="s2">&quot;Reading disulfides from: </span><span class="si">{</span><span class="n">full_path</span><span class="si">}</span><span class="s2">... &quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader-146"><a href="#DisulfideLoader-146"><span class="linenos">146</span></a>            <span class="p">)</span>
</span><span id="DisulfideLoader-147"><a href="#DisulfideLoader-147"><span class="linenos">147</span></a>
</span><span id="DisulfideLoader-148"><a href="#DisulfideLoader-148"><span class="linenos">148</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DisulfideLoader-149"><a href="#DisulfideLoader-149"><span class="linenos">149</span></a>            <span class="c1"># Check if the file exists before attempting to open it</span>
</span><span id="DisulfideLoader-150"><a href="#DisulfideLoader-150"><span class="linenos">150</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">full_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="DisulfideLoader-151"><a href="#DisulfideLoader-151"><span class="linenos">151</span></a>                <span class="n">fname</span> <span class="o">=</span> <span class="n">SS_PICKLE_FILE</span>
</span><span id="DisulfideLoader-152"><a href="#DisulfideLoader-152"><span class="linenos">152</span></a>                <span class="n">url</span> <span class="o">=</span> <span class="n">SS_LIST_URL</span>
</span><span id="DisulfideLoader-153"><a href="#DisulfideLoader-153"><span class="linenos">153</span></a>
</span><span id="DisulfideLoader-154"><a href="#DisulfideLoader-154"><span class="linenos">154</span></a>                <span class="n">_fname</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">)</span> <span class="o">/</span> <span class="n">fname</span>
</span><span id="DisulfideLoader-155"><a href="#DisulfideLoader-155"><span class="linenos">155</span></a>
</span><span id="DisulfideLoader-156"><a href="#DisulfideLoader-156"><span class="linenos">156</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">_fname</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="DisulfideLoader-157"><a href="#DisulfideLoader-157"><span class="linenos">157</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader-158"><a href="#DisulfideLoader-158"><span class="linenos">158</span></a>                        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="DisulfideLoader-159"><a href="#DisulfideLoader-159"><span class="linenos">159</span></a>                            <span class="s2">&quot;Master SS list unavailable. Downloading Disulfide Database from Drive...&quot;</span>
</span><span id="DisulfideLoader-160"><a href="#DisulfideLoader-160"><span class="linenos">160</span></a>                        <span class="p">)</span>
</span><span id="DisulfideLoader-161"><a href="#DisulfideLoader-161"><span class="linenos">161</span></a>                    <span class="n">gdown</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">_fname</span><span class="p">),</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="DisulfideLoader-162"><a href="#DisulfideLoader-162"><span class="linenos">162</span></a>
</span><span id="DisulfideLoader-163"><a href="#DisulfideLoader-163"><span class="linenos">163</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">full_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="DisulfideLoader-164"><a href="#DisulfideLoader-164"><span class="linenos">164</span></a>                <span class="n">sslist</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="DisulfideLoader-165"><a href="#DisulfideLoader-165"><span class="linenos">165</span></a>
</span><span id="DisulfideLoader-166"><a href="#DisulfideLoader-166"><span class="linenos">166</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">percentile</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
</span><span id="DisulfideLoader-167"><a href="#DisulfideLoader-167"><span class="linenos">167</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">percentile</span> <span class="o">&gt;</span> <span class="mf">100.0</span><span class="p">:</span>
</span><span id="DisulfideLoader-168"><a href="#DisulfideLoader-168"><span class="linenos">168</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Percentile must be between 0 and 100.&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-169"><a href="#DisulfideLoader-169"><span class="linenos">169</span></a>
</span><span id="DisulfideLoader-170"><a href="#DisulfideLoader-170"><span class="linenos">170</span></a>                    <span class="n">cutoffs</span> <span class="o">=</span> <span class="n">DisulfideStats</span><span class="o">.</span><span class="n">calculate_cutoff_from_percentile</span><span class="p">(</span>
</span><span id="DisulfideLoader-171"><a href="#DisulfideLoader-171"><span class="linenos">171</span></a>                        <span class="n">sslist</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">percentile</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span>
</span><span id="DisulfideLoader-172"><a href="#DisulfideLoader-172"><span class="linenos">172</span></a>                    <span class="p">)</span>
</span><span id="DisulfideLoader-173"><a href="#DisulfideLoader-173"><span class="linenos">173</span></a>
</span><span id="DisulfideLoader-174"><a href="#DisulfideLoader-174"><span class="linenos">174</span></a>                    <span class="n">ca_cutoff</span> <span class="o">=</span> <span class="n">cutoffs</span><span class="p">[</span><span class="s2">&quot;ca_cutoff_percentile&quot;</span><span class="p">]</span>
</span><span id="DisulfideLoader-175"><a href="#DisulfideLoader-175"><span class="linenos">175</span></a>                    <span class="n">sg_cutoff</span> <span class="o">=</span> <span class="n">cutoffs</span><span class="p">[</span><span class="s2">&quot;sg_cutoff_percentile&quot;</span><span class="p">]</span>
</span><span id="DisulfideLoader-176"><a href="#DisulfideLoader-176"><span class="linenos">176</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">=</span> <span class="n">ca_cutoff</span>
</span><span id="DisulfideLoader-177"><a href="#DisulfideLoader-177"><span class="linenos">177</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">sg_cutoff</span> <span class="o">=</span> <span class="n">sg_cutoff</span>
</span><span id="DisulfideLoader-178"><a href="#DisulfideLoader-178"><span class="linenos">178</span></a>
</span><span id="DisulfideLoader-179"><a href="#DisulfideLoader-179"><span class="linenos">179</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader-180"><a href="#DisulfideLoader-180"><span class="linenos">180</span></a>                        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="DisulfideLoader-181"><a href="#DisulfideLoader-181"><span class="linenos">181</span></a>                            <span class="sa">f</span><span class="s2">&quot;Using percentile cutoffs: </span><span class="si">{</span><span class="n">ca_cutoff</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">sg_cutoff</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DisulfideLoader-182"><a href="#DisulfideLoader-182"><span class="linenos">182</span></a>                        <span class="p">)</span>
</span><span id="DisulfideLoader-183"><a href="#DisulfideLoader-183"><span class="linenos">183</span></a>
</span><span id="DisulfideLoader-184"><a href="#DisulfideLoader-184"><span class="linenos">184</span></a>                <span class="n">old_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sslist</span><span class="p">)</span>
</span><span id="DisulfideLoader-185"><a href="#DisulfideLoader-185"><span class="linenos">185</span></a>                <span class="n">filt</span> <span class="o">=</span> <span class="n">sslist</span><span class="o">.</span><span class="n">filter_by_distance</span><span class="p">(</span>
</span><span id="DisulfideLoader-186"><a href="#DisulfideLoader-186"><span class="linenos">186</span></a>                    <span class="n">distance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">distance_type</span><span class="o">=</span><span class="s2">&quot;ca&quot;</span><span class="p">,</span> <span class="n">minimum</span><span class="o">=-</span><span class="mf">1.0</span>
</span><span id="DisulfideLoader-187"><a href="#DisulfideLoader-187"><span class="linenos">187</span></a>                <span class="p">)</span>
</span><span id="DisulfideLoader-188"><a href="#DisulfideLoader-188"><span class="linenos">188</span></a>                <span class="n">filt</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">(</span>
</span><span id="DisulfideLoader-189"><a href="#DisulfideLoader-189"><span class="linenos">189</span></a>                    <span class="n">filt</span><span class="p">,</span>
</span><span id="DisulfideLoader-190"><a href="#DisulfideLoader-190"><span class="linenos">190</span></a>                    <span class="sa">f</span><span class="s2">&quot;filtered by Ca cutoff:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Sg cutoff: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sg_cutoff</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader-191"><a href="#DisulfideLoader-191"><span class="linenos">191</span></a>                <span class="p">)</span>
</span><span id="DisulfideLoader-192"><a href="#DisulfideLoader-192"><span class="linenos">192</span></a>
</span><span id="DisulfideLoader-193"><a href="#DisulfideLoader-193"><span class="linenos">193</span></a>                <span class="n">new_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filt</span><span class="p">)</span>
</span><span id="DisulfideLoader-194"><a href="#DisulfideLoader-194"><span class="linenos">194</span></a>
</span><span id="DisulfideLoader-195"><a href="#DisulfideLoader-195"><span class="linenos">195</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader-196"><a href="#DisulfideLoader-196"><span class="linenos">196</span></a>                    <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="DisulfideLoader-197"><a href="#DisulfideLoader-197"><span class="linenos">197</span></a>                        <span class="s2">&quot;Filtered with Cα cutoff </span><span class="si">%.2f</span><span class="s2">: old: </span><span class="si">%d</span><span class="s2">, new: </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader-198"><a href="#DisulfideLoader-198"><span class="linenos">198</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span><span class="p">,</span>
</span><span id="DisulfideLoader-199"><a href="#DisulfideLoader-199"><span class="linenos">199</span></a>                        <span class="n">old_length</span><span class="p">,</span>
</span><span id="DisulfideLoader-200"><a href="#DisulfideLoader-200"><span class="linenos">200</span></a>                        <span class="n">new_length</span><span class="p">,</span>
</span><span id="DisulfideLoader-201"><a href="#DisulfideLoader-201"><span class="linenos">201</span></a>                    <span class="p">)</span>
</span><span id="DisulfideLoader-202"><a href="#DisulfideLoader-202"><span class="linenos">202</span></a>
</span><span id="DisulfideLoader-203"><a href="#DisulfideLoader-203"><span class="linenos">203</span></a>                <span class="n">old_length</span> <span class="o">=</span> <span class="n">new_length</span>
</span><span id="DisulfideLoader-204"><a href="#DisulfideLoader-204"><span class="linenos">204</span></a>                <span class="n">filt</span> <span class="o">=</span> <span class="n">filt</span><span class="o">.</span><span class="n">filter_by_distance</span><span class="p">(</span>
</span><span id="DisulfideLoader-205"><a href="#DisulfideLoader-205"><span class="linenos">205</span></a>                    <span class="n">distance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sg_cutoff</span><span class="p">,</span> <span class="n">distance_type</span><span class="o">=</span><span class="s2">&quot;sg&quot;</span><span class="p">,</span> <span class="n">minimum</span><span class="o">=-</span><span class="mf">1.0</span>
</span><span id="DisulfideLoader-206"><a href="#DisulfideLoader-206"><span class="linenos">206</span></a>                <span class="p">)</span>
</span><span id="DisulfideLoader-207"><a href="#DisulfideLoader-207"><span class="linenos">207</span></a>                <span class="n">new_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filt</span><span class="p">)</span>
</span><span id="DisulfideLoader-208"><a href="#DisulfideLoader-208"><span class="linenos">208</span></a>
</span><span id="DisulfideLoader-209"><a href="#DisulfideLoader-209"><span class="linenos">209</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader-210"><a href="#DisulfideLoader-210"><span class="linenos">210</span></a>                    <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="DisulfideLoader-211"><a href="#DisulfideLoader-211"><span class="linenos">211</span></a>                        <span class="s2">&quot;Filtered with Sγ: cutoff </span><span class="si">%.2f</span><span class="s2">: old: </span><span class="si">%d</span><span class="s2">, new: </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader-212"><a href="#DisulfideLoader-212"><span class="linenos">212</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">sg_cutoff</span><span class="p">,</span>
</span><span id="DisulfideLoader-213"><a href="#DisulfideLoader-213"><span class="linenos">213</span></a>                        <span class="n">old_length</span><span class="p">,</span>
</span><span id="DisulfideLoader-214"><a href="#DisulfideLoader-214"><span class="linenos">214</span></a>                        <span class="n">new_length</span><span class="p">,</span>
</span><span id="DisulfideLoader-215"><a href="#DisulfideLoader-215"><span class="linenos">215</span></a>                    <span class="p">)</span>
</span><span id="DisulfideLoader-216"><a href="#DisulfideLoader-216"><span class="linenos">216</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subset</span><span class="p">:</span>
</span><span id="DisulfideLoader-217"><a href="#DisulfideLoader-217"><span class="linenos">217</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="n">filt</span><span class="p">[:</span><span class="mi">5000</span><span class="p">],</span> <span class="s2">&quot;SUBSET_PDB_SS&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-218"><a href="#DisulfideLoader-218"><span class="linenos">218</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideLoader-219"><a href="#DisulfideLoader-219"><span class="linenos">219</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="n">filt</span><span class="p">,</span> <span class="s2">&quot;ALL_PDB_SS&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-220"><a href="#DisulfideLoader-220"><span class="linenos">220</span></a>
</span><span id="DisulfideLoader-221"><a href="#DisulfideLoader-221"><span class="linenos">221</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_disulfide_dict</span><span class="p">()</span>
</span><span id="DisulfideLoader-222"><a href="#DisulfideLoader-222"><span class="linenos">222</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">IDList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="DisulfideLoader-223"><a href="#DisulfideLoader-223"><span class="linenos">223</span></a>
</span><span id="DisulfideLoader-224"><a href="#DisulfideLoader-224"><span class="linenos">224</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">torsion_df</span>
</span><span id="DisulfideLoader-225"><a href="#DisulfideLoader-225"><span class="linenos">225</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">)</span>
</span><span id="DisulfideLoader-226"><a href="#DisulfideLoader-226"><span class="linenos">226</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span> <span class="o">=</span> <span class="n">DisulfideClassManager</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="DisulfideLoader-227"><a href="#DisulfideLoader-227"><span class="linenos">227</span></a>
</span><span id="DisulfideLoader-228"><a href="#DisulfideLoader-228"><span class="linenos">228</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader-229"><a href="#DisulfideLoader-229"><span class="linenos">229</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loader initialization complete.&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-230"><a href="#DisulfideLoader-230"><span class="linenos">230</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</span><span id="DisulfideLoader-231"><a href="#DisulfideLoader-231"><span class="linenos">231</span></a>
</span><span id="DisulfideLoader-232"><a href="#DisulfideLoader-232"><span class="linenos">232</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DisulfideLoader-233"><a href="#DisulfideLoader-233"><span class="linenos">233</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;File not found: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_path</span><span class="p">)</span>
</span><span id="DisulfideLoader-234"><a href="#DisulfideLoader-234"><span class="linenos">234</span></a>            <span class="k">raise</span> <span class="n">e</span>
</span><span id="DisulfideLoader-235"><a href="#DisulfideLoader-235"><span class="linenos">235</span></a>
</span><span id="DisulfideLoader-236"><a href="#DisulfideLoader-236"><span class="linenos">236</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DisulfideLoader-237"><a href="#DisulfideLoader-237"><span class="linenos">237</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;An error occurred while loading the file: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_path</span><span class="p">)</span>
</span><span id="DisulfideLoader-238"><a href="#DisulfideLoader-238"><span class="linenos">238</span></a>            <span class="k">raise</span> <span class="n">e</span>
</span><span id="DisulfideLoader-239"><a href="#DisulfideLoader-239"><span class="linenos">239</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveit</span><span class="p">:</span>
</span><span id="DisulfideLoader-240"><a href="#DisulfideLoader-240"><span class="linenos">240</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
</span><span id="DisulfideLoader-241"><a href="#DisulfideLoader-241"><span class="linenos">241</span></a>                <span class="n">savepath</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span>
</span><span id="DisulfideLoader-242"><a href="#DisulfideLoader-242"><span class="linenos">242</span></a>                <span class="n">subset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">subset</span><span class="p">,</span>
</span><span id="DisulfideLoader-243"><a href="#DisulfideLoader-243"><span class="linenos">243</span></a>                <span class="n">cutoff</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span><span class="p">,</span>
</span><span id="DisulfideLoader-244"><a href="#DisulfideLoader-244"><span class="linenos">244</span></a>                <span class="n">sg_cutoff</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sg_cutoff</span><span class="p">,</span>
</span><span id="DisulfideLoader-245"><a href="#DisulfideLoader-245"><span class="linenos">245</span></a>                <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="DisulfideLoader-246"><a href="#DisulfideLoader-246"><span class="linenos">246</span></a>            <span class="p">)</span>
</span><span id="DisulfideLoader-247"><a href="#DisulfideLoader-247"><span class="linenos">247</span></a>
</span><span id="DisulfideLoader-248"><a href="#DisulfideLoader-248"><span class="linenos">248</span></a>    <span class="c1"># overload __getitem__ to handle slicing and indexing, and access by name or classid</span>
</span><span id="DisulfideLoader-249"><a href="#DisulfideLoader-249"><span class="linenos">249</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
</span><span id="DisulfideLoader-250"><a href="#DisulfideLoader-250"><span class="linenos">250</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-251"><a href="#DisulfideLoader-251"><span class="linenos">251</span></a><span class="sd">        Implements indexing and slicing to retrieve DisulfideList objects from the</span>
</span><span id="DisulfideLoader-252"><a href="#DisulfideLoader-252"><span class="linenos">252</span></a><span class="sd">        DisulfideLoader. Supports:</span>
</span><span id="DisulfideLoader-253"><a href="#DisulfideLoader-253"><span class="linenos">253</span></a>
</span><span id="DisulfideLoader-254"><a href="#DisulfideLoader-254"><span class="linenos">254</span></a><span class="sd">        - Integer indexing to retrieve a single DisulfideList</span>
</span><span id="DisulfideLoader-255"><a href="#DisulfideLoader-255"><span class="linenos">255</span></a><span class="sd">        - Slicing to retrieve a subset as a DisulfideList</span>
</span><span id="DisulfideLoader-256"><a href="#DisulfideLoader-256"><span class="linenos">256</span></a><span class="sd">        - Lookup by PDB ID to retrieve all Disulfides for that structure</span>
</span><span id="DisulfideLoader-257"><a href="#DisulfideLoader-257"><span class="linenos">257</span></a><span class="sd">        - Lookup by full disulfide name</span>
</span><span id="DisulfideLoader-258"><a href="#DisulfideLoader-258"><span class="linenos">258</span></a><span class="sd">        - Lookup by classid in the format 11111b or 11111o. The last char is the class type.</span>
</span><span id="DisulfideLoader-259"><a href="#DisulfideLoader-259"><span class="linenos">259</span></a><span class="sd">        - Lookup by classid in the format 11111. The base is 8 by default.</span>
</span><span id="DisulfideLoader-260"><a href="#DisulfideLoader-260"><span class="linenos">260</span></a>
</span><span id="DisulfideLoader-261"><a href="#DisulfideLoader-261"><span class="linenos">261</span></a><span class="sd">        :param index: The index or key to retrieve the DisulfideList.</span>
</span><span id="DisulfideLoader-262"><a href="#DisulfideLoader-262"><span class="linenos">262</span></a><span class="sd">        :type index: int, slice, str</span>
</span><span id="DisulfideLoader-263"><a href="#DisulfideLoader-263"><span class="linenos">263</span></a><span class="sd">        :return: A DisulfideList object or a subset of it.</span>
</span><span id="DisulfideLoader-264"><a href="#DisulfideLoader-264"><span class="linenos">264</span></a><span class="sd">        :rtype: DisulfideList</span>
</span><span id="DisulfideLoader-265"><a href="#DisulfideLoader-265"><span class="linenos">265</span></a><span class="sd">        :raises DisulfideException: If the index or name is invalid.</span>
</span><span id="DisulfideLoader-266"><a href="#DisulfideLoader-266"><span class="linenos">266</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-267"><a href="#DisulfideLoader-267"><span class="linenos">267</span></a>
</span><span id="DisulfideLoader-268"><a href="#DisulfideLoader-268"><span class="linenos">268</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s2">&quot;none&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-269"><a href="#DisulfideLoader-269"><span class="linenos">269</span></a>        <span class="n">ind_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DisulfideLoader-270"><a href="#DisulfideLoader-270"><span class="linenos">270</span></a>
</span><span id="DisulfideLoader-271"><a href="#DisulfideLoader-271"><span class="linenos">271</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
</span><span id="DisulfideLoader-272"><a href="#DisulfideLoader-272"><span class="linenos">272</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">item</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">)))</span>
</span><span id="DisulfideLoader-273"><a href="#DisulfideLoader-273"><span class="linenos">273</span></a>            <span class="n">ind_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
</span><span id="DisulfideLoader-274"><a href="#DisulfideLoader-274"><span class="linenos">274</span></a>            <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;pdb_slice[</span><span class="si">{</span><span class="n">ind_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">ind_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">]&quot;</span>
</span><span id="DisulfideLoader-275"><a href="#DisulfideLoader-275"><span class="linenos">275</span></a>            <span class="n">resolution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="DisulfideLoader-276"><a href="#DisulfideLoader-276"><span class="linenos">276</span></a>            <span class="n">sublist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
</span><span id="DisulfideLoader-277"><a href="#DisulfideLoader-277"><span class="linenos">277</span></a>            <span class="k">return</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="n">sublist</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">resolution</span><span class="p">)</span>
</span><span id="DisulfideLoader-278"><a href="#DisulfideLoader-278"><span class="linenos">278</span></a>
</span><span id="DisulfideLoader-279"><a href="#DisulfideLoader-279"><span class="linenos">279</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="DisulfideLoader-280"><a href="#DisulfideLoader-280"><span class="linenos">280</span></a>            <span class="k">if</span> <span class="n">item</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">item</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span><span class="p">:</span>
</span><span id="DisulfideLoader-281"><a href="#DisulfideLoader-281"><span class="linenos">281</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="DisulfideLoader-282"><a href="#DisulfideLoader-282"><span class="linenos">282</span></a>                    <span class="s2">&quot;DisulfideLoader(): Index </span><span class="si">%d</span><span class="s2"> out of range 0-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader-283"><a href="#DisulfideLoader-283"><span class="linenos">283</span></a>                    <span class="n">item</span><span class="p">,</span>
</span><span id="DisulfideLoader-284"><a href="#DisulfideLoader-284"><span class="linenos">284</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="DisulfideLoader-285"><a href="#DisulfideLoader-285"><span class="linenos">285</span></a>                <span class="p">)</span>
</span><span id="DisulfideLoader-286"><a href="#DisulfideLoader-286"><span class="linenos">286</span></a>                <span class="k">return</span> <span class="n">res</span>
</span><span id="DisulfideLoader-287"><a href="#DisulfideLoader-287"><span class="linenos">287</span></a>
</span><span id="DisulfideLoader-288"><a href="#DisulfideLoader-288"><span class="linenos">288</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
</span><span id="DisulfideLoader-289"><a href="#DisulfideLoader-289"><span class="linenos">289</span></a>            <span class="k">return</span> <span class="n">res</span>
</span><span id="DisulfideLoader-290"><a href="#DisulfideLoader-290"><span class="linenos">290</span></a>
</span><span id="DisulfideLoader-291"><a href="#DisulfideLoader-291"><span class="linenos">291</span></a>        <span class="c1"># if the item is a string, it could be a PDB ID or a full disulfide name</span>
</span><span id="DisulfideLoader-292"><a href="#DisulfideLoader-292"><span class="linenos">292</span></a>        <span class="c1"># or a classid in the format 11111b or 11111o. the last char is the class type</span>
</span><span id="DisulfideLoader-293"><a href="#DisulfideLoader-293"><span class="linenos">293</span></a>
</span><span id="DisulfideLoader-294"><a href="#DisulfideLoader-294"><span class="linenos">294</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>  <span class="c1"># classid</span>
</span><span id="DisulfideLoader-295"><a href="#DisulfideLoader-295"><span class="linenos">295</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_class</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="DisulfideLoader-296"><a href="#DisulfideLoader-296"><span class="linenos">296</span></a>            <span class="k">return</span> <span class="n">res</span>
</span><span id="DisulfideLoader-297"><a href="#DisulfideLoader-297"><span class="linenos">297</span></a>
</span><span id="DisulfideLoader-298"><a href="#DisulfideLoader-298"><span class="linenos">298</span></a>        <span class="c1"># PDB_SS[&#39;4yys&#39;] return a list of SS</span>
</span><span id="DisulfideLoader-299"><a href="#DisulfideLoader-299"><span class="linenos">299</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DisulfideLoader-300"><a href="#DisulfideLoader-300"><span class="linenos">300</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
</span><span id="DisulfideLoader-301"><a href="#DisulfideLoader-301"><span class="linenos">301</span></a>            <span class="k">if</span> <span class="n">indices</span><span class="p">:</span>
</span><span id="DisulfideLoader-302"><a href="#DisulfideLoader-302"><span class="linenos">302</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="n">item</span><span class="p">)</span>
</span><span id="DisulfideLoader-303"><a href="#DisulfideLoader-303"><span class="linenos">303</span></a>                <span class="n">sslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span>
</span><span id="DisulfideLoader-304"><a href="#DisulfideLoader-304"><span class="linenos">304</span></a>                <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
</span><span id="DisulfideLoader-305"><a href="#DisulfideLoader-305"><span class="linenos">305</span></a>                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sslist</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
</span><span id="DisulfideLoader-306"><a href="#DisulfideLoader-306"><span class="linenos">306</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideLoader-307"><a href="#DisulfideLoader-307"><span class="linenos">307</span></a>                <span class="c1"># try to find the full disulfide name</span>
</span><span id="DisulfideLoader-308"><a href="#DisulfideLoader-308"><span class="linenos">308</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">get_by_name</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>  <span class="c1"># full disulfide name</span>
</span><span id="DisulfideLoader-309"><a href="#DisulfideLoader-309"><span class="linenos">309</span></a>
</span><span id="DisulfideLoader-310"><a href="#DisulfideLoader-310"><span class="linenos">310</span></a>        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DisulfideLoader-311"><a href="#DisulfideLoader-311"><span class="linenos">311</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">get_by_name</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>  <span class="c1"># full disulfide name</span>
</span><span id="DisulfideLoader-312"><a href="#DisulfideLoader-312"><span class="linenos">312</span></a>
</span><span id="DisulfideLoader-313"><a href="#DisulfideLoader-313"><span class="linenos">313</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">res</span><span class="p">:</span>
</span><span id="DisulfideLoader-314"><a href="#DisulfideLoader-314"><span class="linenos">314</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;DisulfideLoader(): Cannot find key </span><span class="si">%s</span><span class="s2"> in SSBond DB&quot;</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
</span><span id="DisulfideLoader-315"><a href="#DisulfideLoader-315"><span class="linenos">315</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="DisulfideLoader-316"><a href="#DisulfideLoader-316"><span class="linenos">316</span></a>
</span><span id="DisulfideLoader-317"><a href="#DisulfideLoader-317"><span class="linenos">317</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
</span><span id="DisulfideLoader-318"><a href="#DisulfideLoader-318"><span class="linenos">318</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_ss</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span id="DisulfideLoader-319"><a href="#DisulfideLoader-319"><span class="linenos">319</span></a>
</span><span id="DisulfideLoader-320"><a href="#DisulfideLoader-320"><span class="linenos">320</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_ss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="DisulfideLoader-321"><a href="#DisulfideLoader-321"><span class="linenos">321</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Disulfide</span><span class="p">):</span>
</span><span id="DisulfideLoader-322"><a href="#DisulfideLoader-322"><span class="linenos">322</span></a>            <span class="k">return</span> <span class="n">value</span>
</span><span id="DisulfideLoader-323"><a href="#DisulfideLoader-323"><span class="linenos">323</span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Disulfide object expected, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-324"><a href="#DisulfideLoader-324"><span class="linenos">324</span></a>
</span><span id="DisulfideLoader-325"><a href="#DisulfideLoader-325"><span class="linenos">325</span></a>    <span class="nd">@property</span>
</span><span id="DisulfideLoader-326"><a href="#DisulfideLoader-326"><span class="linenos">326</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">average_resolution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="DisulfideLoader-327"><a href="#DisulfideLoader-327"><span class="linenos">327</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-328"><a href="#DisulfideLoader-328"><span class="linenos">328</span></a><span class="sd">        Return the average structure resolution for the given list.</span>
</span><span id="DisulfideLoader-329"><a href="#DisulfideLoader-329"><span class="linenos">329</span></a><span class="sd">        Result is cached since resolution values don&#39;t change after loading.</span>
</span><span id="DisulfideLoader-330"><a href="#DisulfideLoader-330"><span class="linenos">330</span></a>
</span><span id="DisulfideLoader-331"><a href="#DisulfideLoader-331"><span class="linenos">331</span></a><span class="sd">        :return: Average resolution (A)</span>
</span><span id="DisulfideLoader-332"><a href="#DisulfideLoader-332"><span class="linenos">332</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-333"><a href="#DisulfideLoader-333"><span class="linenos">333</span></a>        <span class="n">sslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span>
</span><span id="DisulfideLoader-334"><a href="#DisulfideLoader-334"><span class="linenos">334</span></a>        <span class="n">valid_resolutions</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DisulfideLoader-335"><a href="#DisulfideLoader-335"><span class="linenos">335</span></a>            <span class="n">ss</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="DisulfideLoader-336"><a href="#DisulfideLoader-336"><span class="linenos">336</span></a>            <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">sslist</span>
</span><span id="DisulfideLoader-337"><a href="#DisulfideLoader-337"><span class="linenos">337</span></a>            <span class="k">if</span> <span class="n">ss</span><span class="o">.</span><span class="n">resolution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ss</span><span class="o">.</span><span class="n">resolution</span> <span class="o">!=</span> <span class="o">-</span><span class="mf">1.0</span>
</span><span id="DisulfideLoader-338"><a href="#DisulfideLoader-338"><span class="linenos">338</span></a>        <span class="p">]</span>
</span><span id="DisulfideLoader-339"><a href="#DisulfideLoader-339"><span class="linenos">339</span></a>
</span><span id="DisulfideLoader-340"><a href="#DisulfideLoader-340"><span class="linenos">340</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_resolutions</span><span class="p">:</span>
</span><span id="DisulfideLoader-341"><a href="#DisulfideLoader-341"><span class="linenos">341</span></a>            <span class="k">return</span> <span class="o">-</span><span class="mf">1.0</span>
</span><span id="DisulfideLoader-342"><a href="#DisulfideLoader-342"><span class="linenos">342</span></a>
</span><span id="DisulfideLoader-343"><a href="#DisulfideLoader-343"><span class="linenos">343</span></a>        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">valid_resolutions</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_resolutions</span><span class="p">)</span>
</span><span id="DisulfideLoader-344"><a href="#DisulfideLoader-344"><span class="linenos">344</span></a>
</span><span id="DisulfideLoader-345"><a href="#DisulfideLoader-345"><span class="linenos">345</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">binary_to_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">binary_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="DisulfideLoader-346"><a href="#DisulfideLoader-346"><span class="linenos">346</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-347"><a href="#DisulfideLoader-347"><span class="linenos">347</span></a><span class="sd">        Convert a binary class string to an octant class string.</span>
</span><span id="DisulfideLoader-348"><a href="#DisulfideLoader-348"><span class="linenos">348</span></a>
</span><span id="DisulfideLoader-349"><a href="#DisulfideLoader-349"><span class="linenos">349</span></a><span class="sd">        :param binary_class: The binary class string to convert.</span>
</span><span id="DisulfideLoader-350"><a href="#DisulfideLoader-350"><span class="linenos">350</span></a><span class="sd">        :param base: The base class to use, 2 or 8.</span>
</span><span id="DisulfideLoader-351"><a href="#DisulfideLoader-351"><span class="linenos">351</span></a><span class="sd">        :return: The octant class list.</span>
</span><span id="DisulfideLoader-352"><a href="#DisulfideLoader-352"><span class="linenos">352</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-353"><a href="#DisulfideLoader-353"><span class="linenos">353</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="o">.</span><span class="n">binary_to_class</span><span class="p">(</span><span class="n">binary_class</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideLoader-354"><a href="#DisulfideLoader-354"><span class="linenos">354</span></a>
</span><span id="DisulfideLoader-355"><a href="#DisulfideLoader-355"><span class="linenos">355</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build_ss_from_idlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idlist</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="DisulfideLoader-356"><a href="#DisulfideLoader-356"><span class="linenos">356</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-357"><a href="#DisulfideLoader-357"><span class="linenos">357</span></a><span class="sd">        Return a DisulfideList of Disulfides for a given list of PDBIDs</span>
</span><span id="DisulfideLoader-358"><a href="#DisulfideLoader-358"><span class="linenos">358</span></a>
</span><span id="DisulfideLoader-359"><a href="#DisulfideLoader-359"><span class="linenos">359</span></a><span class="sd">        :param idlist: List of PDBIDs, e.g. [&#39;4yys&#39;, &#39;2q7q&#39;]</span>
</span><span id="DisulfideLoader-360"><a href="#DisulfideLoader-360"><span class="linenos">360</span></a><span class="sd">        :return: DisulfideList</span>
</span><span id="DisulfideLoader-361"><a href="#DisulfideLoader-361"><span class="linenos">361</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-362"><a href="#DisulfideLoader-362"><span class="linenos">362</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s2">&quot;RCSB_list&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-363"><a href="#DisulfideLoader-363"><span class="linenos">363</span></a>        <span class="k">for</span> <span class="n">pdbid</span><span class="p">,</span> <span class="n">sslist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="DisulfideLoader-364"><a href="#DisulfideLoader-364"><span class="linenos">364</span></a>            <span class="k">if</span> <span class="n">pdbid</span> <span class="ow">in</span> <span class="n">idlist</span><span class="p">:</span>
</span><span id="DisulfideLoader-365"><a href="#DisulfideLoader-365"><span class="linenos">365</span></a>                <span class="k">for</span> <span class="n">ssid</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">:</span>
</span><span id="DisulfideLoader-366"><a href="#DisulfideLoader-366"><span class="linenos">366</span></a>                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="n">ssid</span><span class="p">])</span>
</span><span id="DisulfideLoader-367"><a href="#DisulfideLoader-367"><span class="linenos">367</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="DisulfideLoader-368"><a href="#DisulfideLoader-368"><span class="linenos">368</span></a>
</span><span id="DisulfideLoader-369"><a href="#DisulfideLoader-369"><span class="linenos">369</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_class_indices_from_tors_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_string</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">:</span>
</span><span id="DisulfideLoader-370"><a href="#DisulfideLoader-370"><span class="linenos">370</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-371"><a href="#DisulfideLoader-371"><span class="linenos">371</span></a><span class="sd">        Return the row indices of the torsion dataframe that match the class string.</span>
</span><span id="DisulfideLoader-372"><a href="#DisulfideLoader-372"><span class="linenos">372</span></a>
</span><span id="DisulfideLoader-373"><a href="#DisulfideLoader-373"><span class="linenos">373</span></a><span class="sd">        This method is used internally to find the indices of rows in the torsion dataframe</span>
</span><span id="DisulfideLoader-374"><a href="#DisulfideLoader-374"><span class="linenos">374</span></a><span class="sd">        that match the specified class string based on the given base.</span>
</span><span id="DisulfideLoader-375"><a href="#DisulfideLoader-375"><span class="linenos">375</span></a>
</span><span id="DisulfideLoader-376"><a href="#DisulfideLoader-376"><span class="linenos">376</span></a><span class="sd">        :param class_string: The class string to match in the torsion dataframe.</span>
</span><span id="DisulfideLoader-377"><a href="#DisulfideLoader-377"><span class="linenos">377</span></a><span class="sd">        :type class_string: str</span>
</span><span id="DisulfideLoader-378"><a href="#DisulfideLoader-378"><span class="linenos">378</span></a><span class="sd">        :param base: The base class to use for matching, either 2 or 8. Defaults to 8.</span>
</span><span id="DisulfideLoader-379"><a href="#DisulfideLoader-379"><span class="linenos">379</span></a><span class="sd">        :type base: int</span>
</span><span id="DisulfideLoader-380"><a href="#DisulfideLoader-380"><span class="linenos">380</span></a><span class="sd">        :return: The row indices of the torsion dataframe that match the class string.</span>
</span><span id="DisulfideLoader-381"><a href="#DisulfideLoader-381"><span class="linenos">381</span></a><span class="sd">        :rtype: pd.Index</span>
</span><span id="DisulfideLoader-382"><a href="#DisulfideLoader-382"><span class="linenos">382</span></a><span class="sd">        :raises ValueError: If the base is not 2 or 8.</span>
</span><span id="DisulfideLoader-383"><a href="#DisulfideLoader-383"><span class="linenos">383</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-384"><a href="#DisulfideLoader-384"><span class="linenos">384</span></a>        <span class="n">tors_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span>
</span><span id="DisulfideLoader-385"><a href="#DisulfideLoader-385"><span class="linenos">385</span></a>        <span class="k">match</span> <span class="n">base</span><span class="p">:</span>
</span><span id="DisulfideLoader-386"><a href="#DisulfideLoader-386"><span class="linenos">386</span></a>            <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="DisulfideLoader-387"><a href="#DisulfideLoader-387"><span class="linenos">387</span></a>                <span class="n">column</span> <span class="o">=</span> <span class="s2">&quot;octant_class_string&quot;</span>
</span><span id="DisulfideLoader-388"><a href="#DisulfideLoader-388"><span class="linenos">388</span></a>            <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="DisulfideLoader-389"><a href="#DisulfideLoader-389"><span class="linenos">389</span></a>                <span class="n">column</span> <span class="o">=</span> <span class="s2">&quot;binary_class_string&quot;</span>
</span><span id="DisulfideLoader-390"><a href="#DisulfideLoader-390"><span class="linenos">390</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="DisulfideLoader-391"><a href="#DisulfideLoader-391"><span class="linenos">391</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Base must be 2 or 8, not </span><span class="si">{</span><span class="n">base</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-392"><a href="#DisulfideLoader-392"><span class="linenos">392</span></a>
</span><span id="DisulfideLoader-393"><a href="#DisulfideLoader-393"><span class="linenos">393</span></a>        <span class="k">return</span> <span class="n">tors_df</span><span class="p">[</span><span class="n">tors_df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">==</span> <span class="n">class_string</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
</span><span id="DisulfideLoader-394"><a href="#DisulfideLoader-394"><span class="linenos">394</span></a>
</span><span id="DisulfideLoader-395"><a href="#DisulfideLoader-395"><span class="linenos">395</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideLoader-396"><a href="#DisulfideLoader-396"><span class="linenos">396</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-397"><a href="#DisulfideLoader-397"><span class="linenos">397</span></a><span class="sd">        Return a copy of self.</span>
</span><span id="DisulfideLoader-398"><a href="#DisulfideLoader-398"><span class="linenos">398</span></a>
</span><span id="DisulfideLoader-399"><a href="#DisulfideLoader-399"><span class="linenos">399</span></a><span class="sd">        :return: Copy of self</span>
</span><span id="DisulfideLoader-400"><a href="#DisulfideLoader-400"><span class="linenos">400</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-401"><a href="#DisulfideLoader-401"><span class="linenos">401</span></a>        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="DisulfideLoader-402"><a href="#DisulfideLoader-402"><span class="linenos">402</span></a>
</span><span id="DisulfideLoader-403"><a href="#DisulfideLoader-403"><span class="linenos">403</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_create_disulfide_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideLoader-404"><a href="#DisulfideLoader-404"><span class="linenos">404</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-405"><a href="#DisulfideLoader-405"><span class="linenos">405</span></a><span class="sd">        Create a dictionary from a list of disulfide objects where the key is the pdb_id</span>
</span><span id="DisulfideLoader-406"><a href="#DisulfideLoader-406"><span class="linenos">406</span></a><span class="sd">        and the value is a list of indices of the disulfide objects in the list.</span>
</span><span id="DisulfideLoader-407"><a href="#DisulfideLoader-407"><span class="linenos">407</span></a>
</span><span id="DisulfideLoader-408"><a href="#DisulfideLoader-408"><span class="linenos">408</span></a><span class="sd">        This is an internal method used during initialization.</span>
</span><span id="DisulfideLoader-409"><a href="#DisulfideLoader-409"><span class="linenos">409</span></a>
</span><span id="DisulfideLoader-410"><a href="#DisulfideLoader-410"><span class="linenos">410</span></a><span class="sd">        :param disulfide_list: List of disulfide objects.</span>
</span><span id="DisulfideLoader-411"><a href="#DisulfideLoader-411"><span class="linenos">411</span></a><span class="sd">        :type disulfide_list: list</span>
</span><span id="DisulfideLoader-412"><a href="#DisulfideLoader-412"><span class="linenos">412</span></a><span class="sd">        :return: Dictionary with pdb_id as keys and lists of indices as values.</span>
</span><span id="DisulfideLoader-413"><a href="#DisulfideLoader-413"><span class="linenos">413</span></a><span class="sd">        :rtype: dict</span>
</span><span id="DisulfideLoader-414"><a href="#DisulfideLoader-414"><span class="linenos">414</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-415"><a href="#DisulfideLoader-415"><span class="linenos">415</span></a>        <span class="n">disulfide_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span>
</span><span id="DisulfideLoader-416"><a href="#DisulfideLoader-416"><span class="linenos">416</span></a>
</span><span id="DisulfideLoader-417"><a href="#DisulfideLoader-417"><span class="linenos">417</span></a>        <span class="n">disulfide_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideLoader-418"><a href="#DisulfideLoader-418"><span class="linenos">418</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">disulfide</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">disulfide_list</span><span class="p">):</span>
</span><span id="DisulfideLoader-419"><a href="#DisulfideLoader-419"><span class="linenos">419</span></a>            <span class="k">if</span> <span class="n">disulfide</span><span class="o">.</span><span class="n">pdb_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">disulfide_dict</span><span class="p">:</span>
</span><span id="DisulfideLoader-420"><a href="#DisulfideLoader-420"><span class="linenos">420</span></a>                <span class="n">disulfide_dict</span><span class="p">[</span><span class="n">disulfide</span><span class="o">.</span><span class="n">pdb_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DisulfideLoader-421"><a href="#DisulfideLoader-421"><span class="linenos">421</span></a>            <span class="n">disulfide_dict</span><span class="p">[</span><span class="n">disulfide</span><span class="o">.</span><span class="n">pdb_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span><span id="DisulfideLoader-422"><a href="#DisulfideLoader-422"><span class="linenos">422</span></a>        <span class="k">return</span> <span class="n">disulfide_dict</span>
</span><span id="DisulfideLoader-423"><a href="#DisulfideLoader-423"><span class="linenos">423</span></a>
</span><span id="DisulfideLoader-424"><a href="#DisulfideLoader-424"><span class="linenos">424</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_class_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="DisulfideLoader-425"><a href="#DisulfideLoader-425"><span class="linenos">425</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-426"><a href="#DisulfideLoader-426"><span class="linenos">426</span></a><span class="sd">        Return the class incidence dataframe for the input base.</span>
</span><span id="DisulfideLoader-427"><a href="#DisulfideLoader-427"><span class="linenos">427</span></a><span class="sd">        Result is cached since class distributions don&#39;t change after loading.</span>
</span><span id="DisulfideLoader-428"><a href="#DisulfideLoader-428"><span class="linenos">428</span></a>
</span><span id="DisulfideLoader-429"><a href="#DisulfideLoader-429"><span class="linenos">429</span></a><span class="sd">        :param base: The base class to use, 2 or 8.</span>
</span><span id="DisulfideLoader-430"><a href="#DisulfideLoader-430"><span class="linenos">430</span></a><span class="sd">        :return: pd.DataFrame</span>
</span><span id="DisulfideLoader-431"><a href="#DisulfideLoader-431"><span class="linenos">431</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-432"><a href="#DisulfideLoader-432"><span class="linenos">432</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="o">.</span><span class="n">get_class_df</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideLoader-433"><a href="#DisulfideLoader-433"><span class="linenos">433</span></a>
</span><span id="DisulfideLoader-434"><a href="#DisulfideLoader-434"><span class="linenos">434</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">extract_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clsid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="DisulfideLoader-435"><a href="#DisulfideLoader-435"><span class="linenos">435</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-436"><a href="#DisulfideLoader-436"><span class="linenos">436</span></a><span class="sd">        Return the list of disulfides corresponding to the input `clsid`.</span>
</span><span id="DisulfideLoader-437"><a href="#DisulfideLoader-437"><span class="linenos">437</span></a>
</span><span id="DisulfideLoader-438"><a href="#DisulfideLoader-438"><span class="linenos">438</span></a><span class="sd">        :param clsid: The class name to extract.</span>
</span><span id="DisulfideLoader-439"><a href="#DisulfideLoader-439"><span class="linenos">439</span></a><span class="sd">        :param verbose: If True, display progress bars, by default False</span>
</span><span id="DisulfideLoader-440"><a href="#DisulfideLoader-440"><span class="linenos">440</span></a><span class="sd">        :return: The list of disulfide bonds from the class.</span>
</span><span id="DisulfideLoader-441"><a href="#DisulfideLoader-441"><span class="linenos">441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-442"><a href="#DisulfideLoader-442"><span class="linenos">442</span></a>
</span><span id="DisulfideLoader-443"><a href="#DisulfideLoader-443"><span class="linenos">443</span></a>        <span class="c1"># cls = clsid[:5]</span>
</span><span id="DisulfideLoader-444"><a href="#DisulfideLoader-444"><span class="linenos">444</span></a>        <span class="bp">cls</span> <span class="o">=</span> <span class="n">clsid</span>
</span><span id="DisulfideLoader-445"><a href="#DisulfideLoader-445"><span class="linenos">445</span></a>        <span class="n">ss_ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DisulfideLoader-446"><a href="#DisulfideLoader-446"><span class="linenos">446</span></a>        <span class="n">class_disulfides</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideLoader-447"><a href="#DisulfideLoader-447"><span class="linenos">447</span></a>
</span><span id="DisulfideLoader-448"><a href="#DisulfideLoader-448"><span class="linenos">448</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DisulfideLoader-449"><a href="#DisulfideLoader-449"><span class="linenos">449</span></a>            <span class="n">ss_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="p">[</span><span class="n">clsid</span><span class="p">]</span>
</span><span id="DisulfideLoader-450"><a href="#DisulfideLoader-450"><span class="linenos">450</span></a>
</span><span id="DisulfideLoader-451"><a href="#DisulfideLoader-451"><span class="linenos">451</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="DisulfideLoader-452"><a href="#DisulfideLoader-452"><span class="linenos">452</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Cannot find key </span><span class="si">%s</span><span class="s2"> in SSBond DB&quot;</span><span class="p">,</span> <span class="n">clsid</span><span class="p">)</span>
</span><span id="DisulfideLoader-453"><a href="#DisulfideLoader-453"><span class="linenos">453</span></a>            <span class="k">return</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DisulfideLoader-454"><a href="#DisulfideLoader-454"><span class="linenos">454</span></a>
</span><span id="DisulfideLoader-455"><a href="#DisulfideLoader-455"><span class="linenos">455</span></a>        <span class="n">tot_ss</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ss_ids</span><span class="p">)</span>
</span><span id="DisulfideLoader-456"><a href="#DisulfideLoader-456"><span class="linenos">456</span></a>        <span class="n">class_disulfides</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DisulfideLoader-457"><a href="#DisulfideLoader-457"><span class="linenos">457</span></a>
</span><span id="DisulfideLoader-458"><a href="#DisulfideLoader-458"><span class="linenos">458</span></a>        <span class="n">_pbar</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DisulfideLoader-459"><a href="#DisulfideLoader-459"><span class="linenos">459</span></a>            <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">tot_ss</span><span class="p">),</span> <span class="n">total</span><span class="o">=</span><span class="n">tot_ss</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">verbose</span> <span class="k">else</span> <span class="nb">range</span><span class="p">(</span><span class="n">tot_ss</span><span class="p">)</span>
</span><span id="DisulfideLoader-460"><a href="#DisulfideLoader-460"><span class="linenos">460</span></a>        <span class="p">)</span>
</span><span id="DisulfideLoader-461"><a href="#DisulfideLoader-461"><span class="linenos">461</span></a>
</span><span id="DisulfideLoader-462"><a href="#DisulfideLoader-462"><span class="linenos">462</span></a>        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">_pbar</span><span class="p">:</span>
</span><span id="DisulfideLoader-463"><a href="#DisulfideLoader-463"><span class="linenos">463</span></a>            <span class="n">ssid</span> <span class="o">=</span> <span class="n">ss_ids</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="DisulfideLoader-464"><a href="#DisulfideLoader-464"><span class="linenos">464</span></a>            <span class="n">class_disulfides</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ssid</span><span class="p">])</span>
</span><span id="DisulfideLoader-465"><a href="#DisulfideLoader-465"><span class="linenos">465</span></a>
</span><span id="DisulfideLoader-466"><a href="#DisulfideLoader-466"><span class="linenos">466</span></a>        <span class="k">return</span> <span class="n">class_disulfides</span>
</span><span id="DisulfideLoader-467"><a href="#DisulfideLoader-467"><span class="linenos">467</span></a>
</span><span id="DisulfideLoader-468"><a href="#DisulfideLoader-468"><span class="linenos">468</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">getlist</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="DisulfideLoader-469"><a href="#DisulfideLoader-469"><span class="linenos">469</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-470"><a href="#DisulfideLoader-470"><span class="linenos">470</span></a><span class="sd">        Return the list of Disulfides contained in the class.</span>
</span><span id="DisulfideLoader-471"><a href="#DisulfideLoader-471"><span class="linenos">471</span></a>
</span><span id="DisulfideLoader-472"><a href="#DisulfideLoader-472"><span class="linenos">472</span></a><span class="sd">        :return: DisulfideList</span>
</span><span id="DisulfideLoader-473"><a href="#DisulfideLoader-473"><span class="linenos">473</span></a><span class="sd">        :rtype: DisulfideList</span>
</span><span id="DisulfideLoader-474"><a href="#DisulfideLoader-474"><span class="linenos">474</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-475"><a href="#DisulfideLoader-475"><span class="linenos">475</span></a>        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">)</span>
</span><span id="DisulfideLoader-476"><a href="#DisulfideLoader-476"><span class="linenos">476</span></a>
</span><span id="DisulfideLoader-477"><a href="#DisulfideLoader-477"><span class="linenos">477</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Disulfide</span><span class="p">:</span>
</span><span id="DisulfideLoader-478"><a href="#DisulfideLoader-478"><span class="linenos">478</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-479"><a href="#DisulfideLoader-479"><span class="linenos">479</span></a><span class="sd">        Return the Disulfide with the given name from the list.</span>
</span><span id="DisulfideLoader-480"><a href="#DisulfideLoader-480"><span class="linenos">480</span></a><span class="sd">        Result is cached since disulfide data doesn&#39;t change after loading.</span>
</span><span id="DisulfideLoader-481"><a href="#DisulfideLoader-481"><span class="linenos">481</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-482"><a href="#DisulfideLoader-482"><span class="linenos">482</span></a>        <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
</span><span id="DisulfideLoader-483"><a href="#DisulfideLoader-483"><span class="linenos">483</span></a>            <span class="k">if</span> <span class="n">ss</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
</span><span id="DisulfideLoader-484"><a href="#DisulfideLoader-484"><span class="linenos">484</span></a>                <span class="k">return</span> <span class="n">ss</span>  <span class="c1"># or ss.copy() !!!</span>
</span><span id="DisulfideLoader-485"><a href="#DisulfideLoader-485"><span class="linenos">485</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="DisulfideLoader-486"><a href="#DisulfideLoader-486"><span class="linenos">486</span></a>
</span><span id="DisulfideLoader-487"><a href="#DisulfideLoader-487"><span class="linenos">487</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memusg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideLoader-488"><a href="#DisulfideLoader-488"><span class="linenos">488</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-489"><a href="#DisulfideLoader-489"><span class="linenos">489</span></a><span class="sd">        Display information about the Disulfide database contained in `self`. if `quick` is False</span>
</span><span id="DisulfideLoader-490"><a href="#DisulfideLoader-490"><span class="linenos">490</span></a><span class="sd">        then display the total RAM used by the object. This takes some time to compute; approximately</span>
</span><span id="DisulfideLoader-491"><a href="#DisulfideLoader-491"><span class="linenos">491</span></a><span class="sd">        30 seconds on a 2024 MacBook Pro. M3 Max.</span>
</span><span id="DisulfideLoader-492"><a href="#DisulfideLoader-492"><span class="linenos">492</span></a>
</span><span id="DisulfideLoader-493"><a href="#DisulfideLoader-493"><span class="linenos">493</span></a><span class="sd">        :param memusg: If True, don&#39;t display the RAM used by the `DisulfideLoader` object.</span>
</span><span id="DisulfideLoader-494"><a href="#DisulfideLoader-494"><span class="linenos">494</span></a><span class="sd">        :return: None</span>
</span><span id="DisulfideLoader-495"><a href="#DisulfideLoader-495"><span class="linenos">495</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-496"><a href="#DisulfideLoader-496"><span class="linenos">496</span></a>        <span class="c1"># pylint: disable=E1101</span>
</span><span id="DisulfideLoader-497"><a href="#DisulfideLoader-497"><span class="linenos">497</span></a>        <span class="n">vers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span>
</span><span id="DisulfideLoader-498"><a href="#DisulfideLoader-498"><span class="linenos">498</span></a>        <span class="n">tot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span>
</span><span id="DisulfideLoader-499"><a href="#DisulfideLoader-499"><span class="linenos">499</span></a>        <span class="n">pdbs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">)</span>
</span><span id="DisulfideLoader-500"><a href="#DisulfideLoader-500"><span class="linenos">500</span></a>        <span class="n">ram</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DisulfideLoader-501"><a href="#DisulfideLoader-501"><span class="linenos">501</span></a>        <span class="k">if</span> <span class="n">memusg</span><span class="p">:</span>
</span><span id="DisulfideLoader-502"><a href="#DisulfideLoader-502"><span class="linenos">502</span></a>            <span class="n">ram</span> <span class="o">=</span> <span class="n">asizeof</span><span class="o">.</span><span class="n">asizeof</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>
</span><span id="DisulfideLoader-503"><a href="#DisulfideLoader-503"><span class="linenos">503</span></a>
</span><span id="DisulfideLoader-504"><a href="#DisulfideLoader-504"><span class="linenos">504</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">average_resolution</span>
</span><span id="DisulfideLoader-505"><a href="#DisulfideLoader-505"><span class="linenos">505</span></a>        <span class="n">cutoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span>
</span><span id="DisulfideLoader-506"><a href="#DisulfideLoader-506"><span class="linenos">506</span></a>        <span class="n">sg_cutoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sg_cutoff</span>
</span><span id="DisulfideLoader-507"><a href="#DisulfideLoader-507"><span class="linenos">507</span></a>        <span class="n">timestr</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">))</span>
</span><span id="DisulfideLoader-508"><a href="#DisulfideLoader-508"><span class="linenos">508</span></a>        <span class="n">ssMinMax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">minmax_energy</span>
</span><span id="DisulfideLoader-509"><a href="#DisulfideLoader-509"><span class="linenos">509</span></a>        <span class="n">ssMin_name</span><span class="p">:</span> <span class="n">Disulfide</span> <span class="o">=</span> <span class="n">ssMinMax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
</span><span id="DisulfideLoader-510"><a href="#DisulfideLoader-510"><span class="linenos">510</span></a>        <span class="n">ssMax_name</span><span class="p">:</span> <span class="n">Disulfide</span> <span class="o">=</span> <span class="n">ssMinMax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
</span><span id="DisulfideLoader-511"><a href="#DisulfideLoader-511"><span class="linenos">511</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    =========== RCSB Disulfide Database Summary ============&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-512"><a href="#DisulfideLoader-512"><span class="linenos">512</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       =========== Built: </span><span class="si">{</span><span class="n">timestr</span><span class="si">}</span><span class="s2"> ===========&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-513"><a href="#DisulfideLoader-513"><span class="linenos">513</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PDB IDs present:                 </span><span class="si">{</span><span class="n">pdbs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-514"><a href="#DisulfideLoader-514"><span class="linenos">514</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Disulfides loaded:               </span><span class="si">{</span><span class="n">tot</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-515"><a href="#DisulfideLoader-515"><span class="linenos">515</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average structure resolution:    </span><span class="si">{</span><span class="n">res</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-516"><a href="#DisulfideLoader-516"><span class="linenos">516</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lowest Energy Disulfide:         </span><span class="si">{</span><span class="n">ssMin_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-517"><a href="#DisulfideLoader-517"><span class="linenos">517</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Highest Energy Disulfide:        </span><span class="si">{</span><span class="n">ssMax_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-518"><a href="#DisulfideLoader-518"><span class="linenos">518</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cα distance cutoff:              </span><span class="si">{</span><span class="n">cutoff</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-519"><a href="#DisulfideLoader-519"><span class="linenos">519</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sγ distance cutoff:              </span><span class="si">{</span><span class="n">sg_cutoff</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-520"><a href="#DisulfideLoader-520"><span class="linenos">520</span></a>        <span class="k">if</span> <span class="n">memusg</span><span class="p">:</span>
</span><span id="DisulfideLoader-521"><a href="#DisulfideLoader-521"><span class="linenos">521</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total RAM Used:                     </span><span class="si">{</span><span class="n">ram</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> GB.&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-522"><a href="#DisulfideLoader-522"><span class="linenos">522</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;               ===== proteusPy: </span><span class="si">{</span><span class="n">vers</span><span class="si">}</span><span class="s2"> =====&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-523"><a href="#DisulfideLoader-523"><span class="linenos">523</span></a>
</span><span id="DisulfideLoader-524"><a href="#DisulfideLoader-524"><span class="linenos">524</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display_overlay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdbid</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideLoader-525"><a href="#DisulfideLoader-525"><span class="linenos">525</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-526"><a href="#DisulfideLoader-526"><span class="linenos">526</span></a><span class="sd">        Display all disulfides for a given PDB ID overlaid in stick mode against</span>
</span><span id="DisulfideLoader-527"><a href="#DisulfideLoader-527"><span class="linenos">527</span></a><span class="sd">        a common coordinate frame. This allows us to see all of the disulfides</span>
</span><span id="DisulfideLoader-528"><a href="#DisulfideLoader-528"><span class="linenos">528</span></a><span class="sd">        at one time in a single view. Colors vary smoothy between bonds.</span>
</span><span id="DisulfideLoader-529"><a href="#DisulfideLoader-529"><span class="linenos">529</span></a>
</span><span id="DisulfideLoader-530"><a href="#DisulfideLoader-530"><span class="linenos">530</span></a><span class="sd">        :param self: DisulfideLoader object initialized with the database.</span>
</span><span id="DisulfideLoader-531"><a href="#DisulfideLoader-531"><span class="linenos">531</span></a><span class="sd">        :param pdbid: the PDB id string, e.g. 4yys</span>
</span><span id="DisulfideLoader-532"><a href="#DisulfideLoader-532"><span class="linenos">532</span></a><span class="sd">        :return: None</span>
</span><span id="DisulfideLoader-533"><a href="#DisulfideLoader-533"><span class="linenos">533</span></a>
</span><span id="DisulfideLoader-534"><a href="#DisulfideLoader-534"><span class="linenos">534</span></a><span class="sd">        Example:</span>
</span><span id="DisulfideLoader-535"><a href="#DisulfideLoader-535"><span class="linenos">535</span></a><span class="sd">        &gt;&gt;&gt; import proteusPy as pp</span>
</span><span id="DisulfideLoader-536"><a href="#DisulfideLoader-536"><span class="linenos">536</span></a>
</span><span id="DisulfideLoader-537"><a href="#DisulfideLoader-537"><span class="linenos">537</span></a><span class="sd">        Instantiate the Loader with the SS database subset.</span>
</span><span id="DisulfideLoader-538"><a href="#DisulfideLoader-538"><span class="linenos">538</span></a>
</span><span id="DisulfideLoader-539"><a href="#DisulfideLoader-539"><span class="linenos">539</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = pp.Load_PDB_SS(verbose=False, subset=True)</span>
</span><span id="DisulfideLoader-540"><a href="#DisulfideLoader-540"><span class="linenos">540</span></a>
</span><span id="DisulfideLoader-541"><a href="#DisulfideLoader-541"><span class="linenos">541</span></a><span class="sd">        Display the Disulfides from the PDB ID ```4yys```, overlaid onto</span>
</span><span id="DisulfideLoader-542"><a href="#DisulfideLoader-542"><span class="linenos">542</span></a><span class="sd">        a common reference (the proximal disulfides).</span>
</span><span id="DisulfideLoader-543"><a href="#DisulfideLoader-543"><span class="linenos">543</span></a>
</span><span id="DisulfideLoader-544"><a href="#DisulfideLoader-544"><span class="linenos">544</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS.display_overlay(&#39;4yys&#39;, verbose=False)</span>
</span><span id="DisulfideLoader-545"><a href="#DisulfideLoader-545"><span class="linenos">545</span></a>
</span><span id="DisulfideLoader-546"><a href="#DisulfideLoader-546"><span class="linenos">546</span></a><span class="sd">        You can also slice the loader and display as an overly.</span>
</span><span id="DisulfideLoader-547"><a href="#DisulfideLoader-547"><span class="linenos">547</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS[:8].display_overlay(verbose=False)</span>
</span><span id="DisulfideLoader-548"><a href="#DisulfideLoader-548"><span class="linenos">548</span></a>
</span><span id="DisulfideLoader-549"><a href="#DisulfideLoader-549"><span class="linenos">549</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-550"><a href="#DisulfideLoader-550"><span class="linenos">550</span></a>
</span><span id="DisulfideLoader-551"><a href="#DisulfideLoader-551"><span class="linenos">551</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DisulfideLoader-552"><a href="#DisulfideLoader-552"><span class="linenos">552</span></a>            <span class="n">ssbonds</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">pdbid</span><span class="p">]</span>
</span><span id="DisulfideLoader-553"><a href="#DisulfideLoader-553"><span class="linenos">553</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="DisulfideLoader-554"><a href="#DisulfideLoader-554"><span class="linenos">554</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Cannot find key </span><span class="si">%s</span><span class="s2"> in SSBond DB&quot;</span><span class="p">,</span> <span class="n">pdbid</span><span class="p">)</span>
</span><span id="DisulfideLoader-555"><a href="#DisulfideLoader-555"><span class="linenos">555</span></a>            <span class="k">return</span>
</span><span id="DisulfideLoader-556"><a href="#DisulfideLoader-556"><span class="linenos">556</span></a>
</span><span id="DisulfideLoader-557"><a href="#DisulfideLoader-557"><span class="linenos">557</span></a>        <span class="n">ssbonds</span><span class="o">.</span><span class="n">display_overlay</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="DisulfideLoader-558"><a href="#DisulfideLoader-558"><span class="linenos">558</span></a>        <span class="k">return</span>
</span><span id="DisulfideLoader-559"><a href="#DisulfideLoader-559"><span class="linenos">559</span></a>
</span><span id="DisulfideLoader-560"><a href="#DisulfideLoader-560"><span class="linenos">560</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">getTorsions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdbID</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="DisulfideLoader-561"><a href="#DisulfideLoader-561"><span class="linenos">561</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-562"><a href="#DisulfideLoader-562"><span class="linenos">562</span></a><span class="sd">        Return the torsions, distances and energies defined by Torsion_DF_cols</span>
</span><span id="DisulfideLoader-563"><a href="#DisulfideLoader-563"><span class="linenos">563</span></a>
</span><span id="DisulfideLoader-564"><a href="#DisulfideLoader-564"><span class="linenos">564</span></a><span class="sd">        :param pdbID: pdbID, defaults to None, meaning return entire dataset.</span>
</span><span id="DisulfideLoader-565"><a href="#DisulfideLoader-565"><span class="linenos">565</span></a><span class="sd">        :type pdbID: str, optional used to extract for a specific PDB structure. If not specified</span>
</span><span id="DisulfideLoader-566"><a href="#DisulfideLoader-566"><span class="linenos">566</span></a><span class="sd">            then return the entire dataset.</span>
</span><span id="DisulfideLoader-567"><a href="#DisulfideLoader-567"><span class="linenos">567</span></a><span class="sd">        :raises DisulfideParseWarning: Raised if not found</span>
</span><span id="DisulfideLoader-568"><a href="#DisulfideLoader-568"><span class="linenos">568</span></a><span class="sd">        :return: Torsions Dataframe</span>
</span><span id="DisulfideLoader-569"><a href="#DisulfideLoader-569"><span class="linenos">569</span></a><span class="sd">        :rtype: pd.DataFrame</span>
</span><span id="DisulfideLoader-570"><a href="#DisulfideLoader-570"><span class="linenos">570</span></a>
</span><span id="DisulfideLoader-571"><a href="#DisulfideLoader-571"><span class="linenos">571</span></a><span class="sd">        Example:</span>
</span><span id="DisulfideLoader-572"><a href="#DisulfideLoader-572"><span class="linenos">572</span></a><span class="sd">        &gt;&gt;&gt; import proteusPy as pp</span>
</span><span id="DisulfideLoader-573"><a href="#DisulfideLoader-573"><span class="linenos">573</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = pp.Load_PDB_SS(verbose=False, subset=True)</span>
</span><span id="DisulfideLoader-574"><a href="#DisulfideLoader-574"><span class="linenos">574</span></a><span class="sd">        &gt;&gt;&gt; Tor_DF = PDB_SS.getTorsions()</span>
</span><span id="DisulfideLoader-575"><a href="#DisulfideLoader-575"><span class="linenos">575</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-576"><a href="#DisulfideLoader-576"><span class="linenos">576</span></a>        <span class="n">res_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="DisulfideLoader-577"><a href="#DisulfideLoader-577"><span class="linenos">577</span></a>
</span><span id="DisulfideLoader-578"><a href="#DisulfideLoader-578"><span class="linenos">578</span></a>        <span class="k">if</span> <span class="n">pdbID</span><span class="p">:</span>
</span><span id="DisulfideLoader-579"><a href="#DisulfideLoader-579"><span class="linenos">579</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="DisulfideLoader-580"><a href="#DisulfideLoader-580"><span class="linenos">580</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">[</span><span class="n">pdbID</span><span class="p">]</span>
</span><span id="DisulfideLoader-581"><a href="#DisulfideLoader-581"><span class="linenos">581</span></a>                <span class="n">sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">pdbID</span>
</span><span id="DisulfideLoader-582"><a href="#DisulfideLoader-582"><span class="linenos">582</span></a>                <span class="n">res_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">[</span><span class="n">sel</span><span class="p">]</span>
</span><span id="DisulfideLoader-583"><a href="#DisulfideLoader-583"><span class="linenos">583</span></a>                <span class="k">return</span> <span class="n">res_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DisulfideLoader-584"><a href="#DisulfideLoader-584"><span class="linenos">584</span></a>            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DisulfideLoader-585"><a href="#DisulfideLoader-585"><span class="linenos">585</span></a>                <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Cannot find key </span><span class="si">{</span><span class="n">pdbID</span><span class="si">}</span><span class="s2"> in SSBond DB&quot;</span>
</span><span id="DisulfideLoader-586"><a href="#DisulfideLoader-586"><span class="linenos">586</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
</span><span id="DisulfideLoader-587"><a href="#DisulfideLoader-587"><span class="linenos">587</span></a>                <span class="k">raise</span> <span class="n">DisulfideParseWarning</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="DisulfideLoader-588"><a href="#DisulfideLoader-588"><span class="linenos">588</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideLoader-589"><a href="#DisulfideLoader-589"><span class="linenos">589</span></a>            <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">)</span>
</span><span id="DisulfideLoader-590"><a href="#DisulfideLoader-590"><span class="linenos">590</span></a>
</span><span id="DisulfideLoader-591"><a href="#DisulfideLoader-591"><span class="linenos">591</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_binary_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideLoader-592"><a href="#DisulfideLoader-592"><span class="linenos">592</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Enumerate the binary classes&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-593"><a href="#DisulfideLoader-593"><span class="linenos">593</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="o">.</span><span class="n">binaryclass_dict</span><span class="p">):</span>
</span><span id="DisulfideLoader-594"><a href="#DisulfideLoader-594"><span class="linenos">594</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class: |</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">|, |</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">|&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-595"><a href="#DisulfideLoader-595"><span class="linenos">595</span></a>
</span><span id="DisulfideLoader-596"><a href="#DisulfideLoader-596"><span class="linenos">596</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_Classes</span><span class="p">(</span>
</span><span id="DisulfideLoader-597"><a href="#DisulfideLoader-597"><span class="linenos">597</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DisulfideLoader-598"><a href="#DisulfideLoader-598"><span class="linenos">598</span></a>        <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
</span><span id="DisulfideLoader-599"><a href="#DisulfideLoader-599"><span class="linenos">599</span></a>        <span class="n">class_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DisulfideLoader-600"><a href="#DisulfideLoader-600"><span class="linenos">600</span></a>        <span class="n">theme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader-601"><a href="#DisulfideLoader-601"><span class="linenos">601</span></a>        <span class="n">log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader-602"><a href="#DisulfideLoader-602"><span class="linenos">602</span></a>        <span class="n">paginated</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader-603"><a href="#DisulfideLoader-603"><span class="linenos">603</span></a>        <span class="n">page_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span>
</span><span id="DisulfideLoader-604"><a href="#DisulfideLoader-604"><span class="linenos">604</span></a>    <span class="p">):</span>
</span><span id="DisulfideLoader-605"><a href="#DisulfideLoader-605"><span class="linenos">605</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-606"><a href="#DisulfideLoader-606"><span class="linenos">606</span></a><span class="sd">        Plot the classes for the given base.</span>
</span><span id="DisulfideLoader-607"><a href="#DisulfideLoader-607"><span class="linenos">607</span></a>
</span><span id="DisulfideLoader-608"><a href="#DisulfideLoader-608"><span class="linenos">608</span></a><span class="sd">        :param base: The base class to use, 2 or 8.</span>
</span><span id="DisulfideLoader-609"><a href="#DisulfideLoader-609"><span class="linenos">609</span></a><span class="sd">        :param class_string: The class string to plot.</span>
</span><span id="DisulfideLoader-610"><a href="#DisulfideLoader-610"><span class="linenos">610</span></a><span class="sd">        :param theme: The theme to use for the plot (&#39;auto&#39;, &#39;light&#39;, or &#39;dark&#39;).</span>
</span><span id="DisulfideLoader-611"><a href="#DisulfideLoader-611"><span class="linenos">611</span></a><span class="sd">        :param log: Whether to use a log scale for the y-axis.</span>
</span><span id="DisulfideLoader-612"><a href="#DisulfideLoader-612"><span class="linenos">612</span></a><span class="sd">        :param paginated: Whether to paginate the plot.</span>
</span><span id="DisulfideLoader-613"><a href="#DisulfideLoader-613"><span class="linenos">613</span></a><span class="sd">        :param page_size: Number of items per page.</span>
</span><span id="DisulfideLoader-614"><a href="#DisulfideLoader-614"><span class="linenos">614</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-615"><a href="#DisulfideLoader-615"><span class="linenos">615</span></a>        <span class="c1"># from proteusPy.DisulfideVisualization import DisulfideVisualization</span>
</span><span id="DisulfideLoader-616"><a href="#DisulfideLoader-616"><span class="linenos">616</span></a>
</span><span id="DisulfideLoader-617"><a href="#DisulfideLoader-617"><span class="linenos">617</span></a>        <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_classes</span><span class="p">(</span>
</span><span id="DisulfideLoader-618"><a href="#DisulfideLoader-618"><span class="linenos">618</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="p">,</span>
</span><span id="DisulfideLoader-619"><a href="#DisulfideLoader-619"><span class="linenos">619</span></a>            <span class="n">class_string</span><span class="o">=</span><span class="n">class_string</span><span class="p">,</span>
</span><span id="DisulfideLoader-620"><a href="#DisulfideLoader-620"><span class="linenos">620</span></a>            <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">,</span>
</span><span id="DisulfideLoader-621"><a href="#DisulfideLoader-621"><span class="linenos">621</span></a>            <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span>
</span><span id="DisulfideLoader-622"><a href="#DisulfideLoader-622"><span class="linenos">622</span></a>            <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span>
</span><span id="DisulfideLoader-623"><a href="#DisulfideLoader-623"><span class="linenos">623</span></a>            <span class="n">page_size</span><span class="o">=</span><span class="n">page_size</span><span class="p">,</span>
</span><span id="DisulfideLoader-624"><a href="#DisulfideLoader-624"><span class="linenos">624</span></a>            <span class="n">paginated</span><span class="o">=</span><span class="n">paginated</span><span class="p">,</span>
</span><span id="DisulfideLoader-625"><a href="#DisulfideLoader-625"><span class="linenos">625</span></a>        <span class="p">)</span>
</span><span id="DisulfideLoader-626"><a href="#DisulfideLoader-626"><span class="linenos">626</span></a>
</span><span id="DisulfideLoader-627"><a href="#DisulfideLoader-627"><span class="linenos">627</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_classes_vs_cutoff</span><span class="p">(</span>
</span><span id="DisulfideLoader-628"><a href="#DisulfideLoader-628"><span class="linenos">628</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
</span><span id="DisulfideLoader-629"><a href="#DisulfideLoader-629"><span class="linenos">629</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideLoader-630"><a href="#DisulfideLoader-630"><span class="linenos">630</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-631"><a href="#DisulfideLoader-631"><span class="linenos">631</span></a><span class="sd">        Plot the total percentage and number of members for each octant class against the cutoff value.</span>
</span><span id="DisulfideLoader-632"><a href="#DisulfideLoader-632"><span class="linenos">632</span></a>
</span><span id="DisulfideLoader-633"><a href="#DisulfideLoader-633"><span class="linenos">633</span></a><span class="sd">        :param cutoff: Percent cutoff value for filtering the classes.</span>
</span><span id="DisulfideLoader-634"><a href="#DisulfideLoader-634"><span class="linenos">634</span></a><span class="sd">        :param steps: Number of steps to take in the cutoff.</span>
</span><span id="DisulfideLoader-635"><a href="#DisulfideLoader-635"><span class="linenos">635</span></a><span class="sd">        :param base: The base class to use, 6 or 8.</span>
</span><span id="DisulfideLoader-636"><a href="#DisulfideLoader-636"><span class="linenos">636</span></a><span class="sd">        :param theme: The theme to use for the plot (&#39;auto&#39;, &#39;light&#39;, or &#39;dark&#39;), defaults to &#39;auto&#39;.</span>
</span><span id="DisulfideLoader-637"><a href="#DisulfideLoader-637"><span class="linenos">637</span></a><span class="sd">        :return: None</span>
</span><span id="DisulfideLoader-638"><a href="#DisulfideLoader-638"><span class="linenos">638</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-639"><a href="#DisulfideLoader-639"><span class="linenos">639</span></a>        <span class="c1"># from proteusPy.DisulfideVisualization import DisulfideVisualization</span>
</span><span id="DisulfideLoader-640"><a href="#DisulfideLoader-640"><span class="linenos">640</span></a>
</span><span id="DisulfideLoader-641"><a href="#DisulfideLoader-641"><span class="linenos">641</span></a>        <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_classes_vs_cutoff</span><span class="p">(</span>
</span><span id="DisulfideLoader-642"><a href="#DisulfideLoader-642"><span class="linenos">642</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">theme</span><span class="p">,</span> <span class="n">verbose</span>
</span><span id="DisulfideLoader-643"><a href="#DisulfideLoader-643"><span class="linenos">643</span></a>        <span class="p">)</span>
</span><span id="DisulfideLoader-644"><a href="#DisulfideLoader-644"><span class="linenos">644</span></a>
</span><span id="DisulfideLoader-645"><a href="#DisulfideLoader-645"><span class="linenos">645</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_binary_to_eightclass_incidence</span><span class="p">(</span>
</span><span id="DisulfideLoader-646"><a href="#DisulfideLoader-646"><span class="linenos">646</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DisulfideLoader-647"><a href="#DisulfideLoader-647"><span class="linenos">647</span></a>        <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;light&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader-648"><a href="#DisulfideLoader-648"><span class="linenos">648</span></a>        <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader-649"><a href="#DisulfideLoader-649"><span class="linenos">649</span></a>        <span class="n">savedir</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader-650"><a href="#DisulfideLoader-650"><span class="linenos">650</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader-651"><a href="#DisulfideLoader-651"><span class="linenos">651</span></a>        <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader-652"><a href="#DisulfideLoader-652"><span class="linenos">652</span></a>    <span class="p">):</span>
</span><span id="DisulfideLoader-653"><a href="#DisulfideLoader-653"><span class="linenos">653</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the incidence of all octant Disulfide classes for a given binary class.</span>
</span><span id="DisulfideLoader-654"><a href="#DisulfideLoader-654"><span class="linenos">654</span></a>
</span><span id="DisulfideLoader-655"><a href="#DisulfideLoader-655"><span class="linenos">655</span></a><span class="sd">        :param theme: The theme to use for the plot</span>
</span><span id="DisulfideLoader-656"><a href="#DisulfideLoader-656"><span class="linenos">656</span></a><span class="sd">        :param save: Whether to save the plots</span>
</span><span id="DisulfideLoader-657"><a href="#DisulfideLoader-657"><span class="linenos">657</span></a><span class="sd">        :param savedir: Directory to save plots to</span>
</span><span id="DisulfideLoader-658"><a href="#DisulfideLoader-658"><span class="linenos">658</span></a><span class="sd">        :param verbose: Whether to display verbose output</span>
</span><span id="DisulfideLoader-659"><a href="#DisulfideLoader-659"><span class="linenos">659</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-660"><a href="#DisulfideLoader-660"><span class="linenos">660</span></a>
</span><span id="DisulfideLoader-661"><a href="#DisulfideLoader-661"><span class="linenos">661</span></a>        <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_binary_to_eightclass_incidence</span><span class="p">(</span>
</span><span id="DisulfideLoader-662"><a href="#DisulfideLoader-662"><span class="linenos">662</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="p">,</span>
</span><span id="DisulfideLoader-663"><a href="#DisulfideLoader-663"><span class="linenos">663</span></a>            <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span>
</span><span id="DisulfideLoader-664"><a href="#DisulfideLoader-664"><span class="linenos">664</span></a>            <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span>
</span><span id="DisulfideLoader-665"><a href="#DisulfideLoader-665"><span class="linenos">665</span></a>            <span class="n">savedir</span><span class="o">=</span><span class="n">savedir</span><span class="p">,</span>
</span><span id="DisulfideLoader-666"><a href="#DisulfideLoader-666"><span class="linenos">666</span></a>            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="DisulfideLoader-667"><a href="#DisulfideLoader-667"><span class="linenos">667</span></a>            <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span>
</span><span id="DisulfideLoader-668"><a href="#DisulfideLoader-668"><span class="linenos">668</span></a>        <span class="p">)</span>
</span><span id="DisulfideLoader-669"><a href="#DisulfideLoader-669"><span class="linenos">669</span></a>
</span><span id="DisulfideLoader-670"><a href="#DisulfideLoader-670"><span class="linenos">670</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_count_vs_class_df</span><span class="p">(</span>
</span><span id="DisulfideLoader-671"><a href="#DisulfideLoader-671"><span class="linenos">671</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DisulfideLoader-672"><a href="#DisulfideLoader-672"><span class="linenos">672</span></a>        <span class="n">class_string</span><span class="p">,</span>
</span><span id="DisulfideLoader-673"><a href="#DisulfideLoader-673"><span class="linenos">673</span></a>        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;title&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader-674"><a href="#DisulfideLoader-674"><span class="linenos">674</span></a>        <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader-675"><a href="#DisulfideLoader-675"><span class="linenos">675</span></a>        <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader-676"><a href="#DisulfideLoader-676"><span class="linenos">676</span></a>        <span class="n">savedir</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader-677"><a href="#DisulfideLoader-677"><span class="linenos">677</span></a>        <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
</span><span id="DisulfideLoader-678"><a href="#DisulfideLoader-678"><span class="linenos">678</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader-679"><a href="#DisulfideLoader-679"><span class="linenos">679</span></a>        <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader-680"><a href="#DisulfideLoader-680"><span class="linenos">680</span></a>        <span class="n">sample_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="DisulfideLoader-681"><a href="#DisulfideLoader-681"><span class="linenos">681</span></a>        <span class="n">page_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="DisulfideLoader-682"><a href="#DisulfideLoader-682"><span class="linenos">682</span></a>    <span class="p">):</span>
</span><span id="DisulfideLoader-683"><a href="#DisulfideLoader-683"><span class="linenos">683</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-684"><a href="#DisulfideLoader-684"><span class="linenos">684</span></a><span class="sd">        Plot a line graph of count vs class ID using Plotly for the given disulfide class. The</span>
</span><span id="DisulfideLoader-685"><a href="#DisulfideLoader-685"><span class="linenos">685</span></a><span class="sd">        base selects the class type to plot: 2, 6, or 8, for binary, sextant, or octant classes.</span>
</span><span id="DisulfideLoader-686"><a href="#DisulfideLoader-686"><span class="linenos">686</span></a>
</span><span id="DisulfideLoader-687"><a href="#DisulfideLoader-687"><span class="linenos">687</span></a><span class="sd">        :param class_string: The binary class string to be plotted.</span>
</span><span id="DisulfideLoader-688"><a href="#DisulfideLoader-688"><span class="linenos">688</span></a><span class="sd">        :param title: A string representing the title of the plot (default is &#39;title&#39;).</span>
</span><span id="DisulfideLoader-689"><a href="#DisulfideLoader-689"><span class="linenos">689</span></a><span class="sd">        :param theme: Theme to use for the plot</span>
</span><span id="DisulfideLoader-690"><a href="#DisulfideLoader-690"><span class="linenos">690</span></a><span class="sd">        :param save: Whether to save the plot</span>
</span><span id="DisulfideLoader-691"><a href="#DisulfideLoader-691"><span class="linenos">691</span></a><span class="sd">        :param savedir: Directory to save the plot to</span>
</span><span id="DisulfideLoader-692"><a href="#DisulfideLoader-692"><span class="linenos">692</span></a><span class="sd">        :param base: Base for class IDs (2 or 8)</span>
</span><span id="DisulfideLoader-693"><a href="#DisulfideLoader-693"><span class="linenos">693</span></a><span class="sd">        :param verbose: Whether to display verbose output</span>
</span><span id="DisulfideLoader-694"><a href="#DisulfideLoader-694"><span class="linenos">694</span></a><span class="sd">        :param log: Whether to use log scale for y-axis</span>
</span><span id="DisulfideLoader-695"><a href="#DisulfideLoader-695"><span class="linenos">695</span></a><span class="sd">        :param sample_size: Number of items to sample</span>
</span><span id="DisulfideLoader-696"><a href="#DisulfideLoader-696"><span class="linenos">696</span></a><span class="sd">        :param page_size: Number of items per page</span>
</span><span id="DisulfideLoader-697"><a href="#DisulfideLoader-697"><span class="linenos">697</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-698"><a href="#DisulfideLoader-698"><span class="linenos">698</span></a>        <span class="c1"># from proteusPy.DisulfideVisualization import DisulfideVisualization</span>
</span><span id="DisulfideLoader-699"><a href="#DisulfideLoader-699"><span class="linenos">699</span></a>        <span class="n">class_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="o">.</span><span class="n">binary_to_class</span><span class="p">(</span><span class="n">class_string</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideLoader-700"><a href="#DisulfideLoader-700"><span class="linenos">700</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_enumerate_class_fromlist</span><span class="p">(</span><span class="n">class_list</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideLoader-701"><a href="#DisulfideLoader-701"><span class="linenos">701</span></a>
</span><span id="DisulfideLoader-702"><a href="#DisulfideLoader-702"><span class="linenos">702</span></a>        <span class="k">if</span> <span class="n">sample_size</span><span class="p">:</span>
</span><span id="DisulfideLoader-703"><a href="#DisulfideLoader-703"><span class="linenos">703</span></a>            <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_count_vs_class_df_sampled</span><span class="p">(</span>
</span><span id="DisulfideLoader-704"><a href="#DisulfideLoader-704"><span class="linenos">704</span></a>                <span class="n">df</span><span class="p">,</span>
</span><span id="DisulfideLoader-705"><a href="#DisulfideLoader-705"><span class="linenos">705</span></a>                <span class="n">title</span><span class="p">,</span>
</span><span id="DisulfideLoader-706"><a href="#DisulfideLoader-706"><span class="linenos">706</span></a>                <span class="n">theme</span><span class="p">,</span>
</span><span id="DisulfideLoader-707"><a href="#DisulfideLoader-707"><span class="linenos">707</span></a>                <span class="n">save</span><span class="p">,</span>
</span><span id="DisulfideLoader-708"><a href="#DisulfideLoader-708"><span class="linenos">708</span></a>                <span class="n">savedir</span><span class="p">,</span>
</span><span id="DisulfideLoader-709"><a href="#DisulfideLoader-709"><span class="linenos">709</span></a>                <span class="n">base</span><span class="p">,</span>
</span><span id="DisulfideLoader-710"><a href="#DisulfideLoader-710"><span class="linenos">710</span></a>                <span class="n">verbose</span><span class="p">,</span>
</span><span id="DisulfideLoader-711"><a href="#DisulfideLoader-711"><span class="linenos">711</span></a>                <span class="n">log</span><span class="p">,</span>
</span><span id="DisulfideLoader-712"><a href="#DisulfideLoader-712"><span class="linenos">712</span></a>                <span class="n">sample_size</span><span class="p">,</span>
</span><span id="DisulfideLoader-713"><a href="#DisulfideLoader-713"><span class="linenos">713</span></a>            <span class="p">)</span>
</span><span id="DisulfideLoader-714"><a href="#DisulfideLoader-714"><span class="linenos">714</span></a>        <span class="k">elif</span> <span class="n">page_size</span><span class="p">:</span>
</span><span id="DisulfideLoader-715"><a href="#DisulfideLoader-715"><span class="linenos">715</span></a>            <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_count_vs_class_df_paginated</span><span class="p">(</span>
</span><span id="DisulfideLoader-716"><a href="#DisulfideLoader-716"><span class="linenos">716</span></a>                <span class="n">df</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">theme</span><span class="p">,</span> <span class="n">save</span><span class="p">,</span> <span class="n">savedir</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">page_size</span>
</span><span id="DisulfideLoader-717"><a href="#DisulfideLoader-717"><span class="linenos">717</span></a>            <span class="p">)</span>
</span><span id="DisulfideLoader-718"><a href="#DisulfideLoader-718"><span class="linenos">718</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideLoader-719"><a href="#DisulfideLoader-719"><span class="linenos">719</span></a>            <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_count_vs_class_df</span><span class="p">(</span>
</span><span id="DisulfideLoader-720"><a href="#DisulfideLoader-720"><span class="linenos">720</span></a>                <span class="n">df</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">theme</span><span class="p">,</span> <span class="n">save</span><span class="p">,</span> <span class="n">savedir</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">log</span>
</span><span id="DisulfideLoader-721"><a href="#DisulfideLoader-721"><span class="linenos">721</span></a>            <span class="p">)</span>
</span><span id="DisulfideLoader-722"><a href="#DisulfideLoader-722"><span class="linenos">722</span></a>
</span><span id="DisulfideLoader-723"><a href="#DisulfideLoader-723"><span class="linenos">723</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_count_vs_classid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="DisulfideLoader-724"><a href="#DisulfideLoader-724"><span class="linenos">724</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-725"><a href="#DisulfideLoader-725"><span class="linenos">725</span></a><span class="sd">        Plot a line graph of count vs class ID using Plotly.</span>
</span><span id="DisulfideLoader-726"><a href="#DisulfideLoader-726"><span class="linenos">726</span></a>
</span><span id="DisulfideLoader-727"><a href="#DisulfideLoader-727"><span class="linenos">727</span></a><span class="sd">        :param cls: Specific class to plot (optional)</span>
</span><span id="DisulfideLoader-728"><a href="#DisulfideLoader-728"><span class="linenos">728</span></a><span class="sd">        :param theme: Theme to use for the plot</span>
</span><span id="DisulfideLoader-729"><a href="#DisulfideLoader-729"><span class="linenos">729</span></a><span class="sd">        :param base: Base for class IDs (2 or 8)</span>
</span><span id="DisulfideLoader-730"><a href="#DisulfideLoader-730"><span class="linenos">730</span></a><span class="sd">        :param log: Whether to use log scale for y-axis</span>
</span><span id="DisulfideLoader-731"><a href="#DisulfideLoader-731"><span class="linenos">731</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-732"><a href="#DisulfideLoader-732"><span class="linenos">732</span></a>        <span class="c1"># from proteusPy.DisulfideVisualization import DisulfideVisualization</span>
</span><span id="DisulfideLoader-733"><a href="#DisulfideLoader-733"><span class="linenos">733</span></a>
</span><span id="DisulfideLoader-734"><a href="#DisulfideLoader-734"><span class="linenos">734</span></a>        <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_count_vs_classid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">theme</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">log</span><span class="p">)</span>
</span><span id="DisulfideLoader-735"><a href="#DisulfideLoader-735"><span class="linenos">735</span></a>
</span><span id="DisulfideLoader-736"><a href="#DisulfideLoader-736"><span class="linenos">736</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_enumerate_class_fromlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sslist</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
</span><span id="DisulfideLoader-737"><a href="#DisulfideLoader-737"><span class="linenos">737</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-738"><a href="#DisulfideLoader-738"><span class="linenos">738</span></a><span class="sd">        Enumerate the classes from a list of class IDs and return a DataFrame with class IDs and their corresponding counts.</span>
</span><span id="DisulfideLoader-739"><a href="#DisulfideLoader-739"><span class="linenos">739</span></a><span class="sd">        Results are cached for improved performance on repeated calls.</span>
</span><span id="DisulfideLoader-740"><a href="#DisulfideLoader-740"><span class="linenos">740</span></a>
</span><span id="DisulfideLoader-741"><a href="#DisulfideLoader-741"><span class="linenos">741</span></a><span class="sd">        :param sslist: A list of class IDs to enumerate.</span>
</span><span id="DisulfideLoader-742"><a href="#DisulfideLoader-742"><span class="linenos">742</span></a><span class="sd">        :param base: The base value for the enumeration, by default 8.</span>
</span><span id="DisulfideLoader-743"><a href="#DisulfideLoader-743"><span class="linenos">743</span></a><span class="sd">        :return: A DataFrame with columns &quot;class_id&quot; and &quot;count&quot; representing the class IDs and their corresponding counts.</span>
</span><span id="DisulfideLoader-744"><a href="#DisulfideLoader-744"><span class="linenos">744</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-745"><a href="#DisulfideLoader-745"><span class="linenos">745</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DisulfideLoader-746"><a href="#DisulfideLoader-746"><span class="linenos">746</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DisulfideLoader-747"><a href="#DisulfideLoader-747"><span class="linenos">747</span></a>
</span><span id="DisulfideLoader-748"><a href="#DisulfideLoader-748"><span class="linenos">748</span></a>        <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">:</span>
</span><span id="DisulfideLoader-749"><a href="#DisulfideLoader-749"><span class="linenos">749</span></a>            <span class="k">if</span> <span class="bp">cls</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideLoader-750"><a href="#DisulfideLoader-750"><span class="linenos">750</span></a>                <span class="n">_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="o">.</span><span class="n">sslist_from_classid</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideLoader-751"><a href="#DisulfideLoader-751"><span class="linenos">751</span></a>                <span class="c1"># it&#39;s possible to have 0 SS in a class</span>
</span><span id="DisulfideLoader-752"><a href="#DisulfideLoader-752"><span class="linenos">752</span></a>                <span class="k">if</span> <span class="n">_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideLoader-753"><a href="#DisulfideLoader-753"><span class="linenos">753</span></a>                    <span class="c1"># only append if we have both.</span>
</span><span id="DisulfideLoader-754"><a href="#DisulfideLoader-754"><span class="linenos">754</span></a>                    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
</span><span id="DisulfideLoader-755"><a href="#DisulfideLoader-755"><span class="linenos">755</span></a>                    <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">_y</span><span class="p">))</span>
</span><span id="DisulfideLoader-756"><a href="#DisulfideLoader-756"><span class="linenos">756</span></a>
</span><span id="DisulfideLoader-757"><a href="#DisulfideLoader-757"><span class="linenos">757</span></a>        <span class="n">sslist_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">])</span>
</span><span id="DisulfideLoader-758"><a href="#DisulfideLoader-758"><span class="linenos">758</span></a>        <span class="n">sslist_df</span><span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="DisulfideLoader-759"><a href="#DisulfideLoader-759"><span class="linenos">759</span></a>        <span class="n">sslist_df</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
</span><span id="DisulfideLoader-760"><a href="#DisulfideLoader-760"><span class="linenos">760</span></a>        <span class="k">return</span> <span class="n">sslist_df</span>
</span><span id="DisulfideLoader-761"><a href="#DisulfideLoader-761"><span class="linenos">761</span></a>
</span><span id="DisulfideLoader-762"><a href="#DisulfideLoader-762"><span class="linenos">762</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span>
</span><span id="DisulfideLoader-763"><a href="#DisulfideLoader-763"><span class="linenos">763</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DisulfideLoader-764"><a href="#DisulfideLoader-764"><span class="linenos">764</span></a>        <span class="n">savepath</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span>
</span><span id="DisulfideLoader-765"><a href="#DisulfideLoader-765"><span class="linenos">765</span></a>        <span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader-766"><a href="#DisulfideLoader-766"><span class="linenos">766</span></a>        <span class="n">cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="DisulfideLoader-767"><a href="#DisulfideLoader-767"><span class="linenos">767</span></a>        <span class="n">sg_cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="DisulfideLoader-768"><a href="#DisulfideLoader-768"><span class="linenos">768</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader-769"><a href="#DisulfideLoader-769"><span class="linenos">769</span></a>    <span class="p">):</span>
</span><span id="DisulfideLoader-770"><a href="#DisulfideLoader-770"><span class="linenos">770</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-771"><a href="#DisulfideLoader-771"><span class="linenos">771</span></a><span class="sd">        Save a copy of the fully instantiated Loader to the specified file.</span>
</span><span id="DisulfideLoader-772"><a href="#DisulfideLoader-772"><span class="linenos">772</span></a>
</span><span id="DisulfideLoader-773"><a href="#DisulfideLoader-773"><span class="linenos">773</span></a><span class="sd">        :param savepath: Path to save the file, defaults to DATA_DIR</span>
</span><span id="DisulfideLoader-774"><a href="#DisulfideLoader-774"><span class="linenos">774</span></a><span class="sd">        :param fname: Filename, defaults to LOADER_FNAME</span>
</span><span id="DisulfideLoader-775"><a href="#DisulfideLoader-775"><span class="linenos">775</span></a><span class="sd">        :param verbose: Verbosity, defaults to False</span>
</span><span id="DisulfideLoader-776"><a href="#DisulfideLoader-776"><span class="linenos">776</span></a><span class="sd">        :param cutoff: Ca-Ca Distance cutoff used to build the database, -1 means no cutoff.</span>
</span><span id="DisulfideLoader-777"><a href="#DisulfideLoader-777"><span class="linenos">777</span></a><span class="sd">        :param sg_cutoff: Sg-Sg Distance cutoff used to build the database, -1 means no cutoff.</span>
</span><span id="DisulfideLoader-778"><a href="#DisulfideLoader-778"><span class="linenos">778</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-779"><a href="#DisulfideLoader-779"><span class="linenos">779</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">__version__</span>
</span><span id="DisulfideLoader-780"><a href="#DisulfideLoader-780"><span class="linenos">780</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">=</span> <span class="n">cutoff</span>
</span><span id="DisulfideLoader-781"><a href="#DisulfideLoader-781"><span class="linenos">781</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_cutoff</span> <span class="o">=</span> <span class="n">sg_cutoff</span>
</span><span id="DisulfideLoader-782"><a href="#DisulfideLoader-782"><span class="linenos">782</span></a>
</span><span id="DisulfideLoader-783"><a href="#DisulfideLoader-783"><span class="linenos">783</span></a>        <span class="n">fname</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideLoader-784"><a href="#DisulfideLoader-784"><span class="linenos">784</span></a>
</span><span id="DisulfideLoader-785"><a href="#DisulfideLoader-785"><span class="linenos">785</span></a>        <span class="k">if</span> <span class="n">subset</span><span class="p">:</span>
</span><span id="DisulfideLoader-786"><a href="#DisulfideLoader-786"><span class="linenos">786</span></a>            <span class="n">fname</span> <span class="o">=</span> <span class="n">LOADER_SUBSET_FNAME</span>
</span><span id="DisulfideLoader-787"><a href="#DisulfideLoader-787"><span class="linenos">787</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideLoader-788"><a href="#DisulfideLoader-788"><span class="linenos">788</span></a>            <span class="n">fname</span> <span class="o">=</span> <span class="n">LOADER_FNAME</span>
</span><span id="DisulfideLoader-789"><a href="#DisulfideLoader-789"><span class="linenos">789</span></a>
</span><span id="DisulfideLoader-790"><a href="#DisulfideLoader-790"><span class="linenos">790</span></a>        <span class="n">_fname</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">savepath</span><span class="p">)</span> <span class="o">/</span> <span class="n">fname</span>
</span><span id="DisulfideLoader-791"><a href="#DisulfideLoader-791"><span class="linenos">791</span></a>
</span><span id="DisulfideLoader-792"><a href="#DisulfideLoader-792"><span class="linenos">792</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader-793"><a href="#DisulfideLoader-793"><span class="linenos">793</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Writing Disulfide Loader to: </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">_fname</span><span class="p">)</span>
</span><span id="DisulfideLoader-794"><a href="#DisulfideLoader-794"><span class="linenos">794</span></a>
</span><span id="DisulfideLoader-795"><a href="#DisulfideLoader-795"><span class="linenos">795</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">_fname</span><span class="p">),</span> <span class="s2">&quot;wb+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="DisulfideLoader-796"><a href="#DisulfideLoader-796"><span class="linenos">796</span></a>            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="DisulfideLoader-797"><a href="#DisulfideLoader-797"><span class="linenos">797</span></a>
</span><span id="DisulfideLoader-798"><a href="#DisulfideLoader-798"><span class="linenos">798</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader-799"><a href="#DisulfideLoader-799"><span class="linenos">799</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Done saving loader.&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-800"><a href="#DisulfideLoader-800"><span class="linenos">800</span></a>
</span><span id="DisulfideLoader-801"><a href="#DisulfideLoader-801"><span class="linenos">801</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_disulfides_vs_pdbid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="DisulfideLoader-802"><a href="#DisulfideLoader-802"><span class="linenos">802</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-803"><a href="#DisulfideLoader-803"><span class="linenos">803</span></a><span class="sd">        Plots the number of disulfides versus pdbid.</span>
</span><span id="DisulfideLoader-804"><a href="#DisulfideLoader-804"><span class="linenos">804</span></a>
</span><span id="DisulfideLoader-805"><a href="#DisulfideLoader-805"><span class="linenos">805</span></a><span class="sd">        :param cutoff: The minimum number of disulfides a PDB ID must have to be included in the plot.</span>
</span><span id="DisulfideLoader-806"><a href="#DisulfideLoader-806"><span class="linenos">806</span></a><span class="sd">        :type cutoff: int</span>
</span><span id="DisulfideLoader-807"><a href="#DisulfideLoader-807"><span class="linenos">807</span></a><span class="sd">        :return: A tuple containing the list of PDB IDs and the corresponding number of disulfides.</span>
</span><span id="DisulfideLoader-808"><a href="#DisulfideLoader-808"><span class="linenos">808</span></a><span class="sd">        :rtype: tuple</span>
</span><span id="DisulfideLoader-809"><a href="#DisulfideLoader-809"><span class="linenos">809</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-810"><a href="#DisulfideLoader-810"><span class="linenos">810</span></a>        <span class="n">pdbids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DisulfideLoader-811"><a href="#DisulfideLoader-811"><span class="linenos">811</span></a>        <span class="n">num_disulfides</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DisulfideLoader-812"><a href="#DisulfideLoader-812"><span class="linenos">812</span></a>
</span><span id="DisulfideLoader-813"><a href="#DisulfideLoader-813"><span class="linenos">813</span></a>        <span class="k">for</span> <span class="n">pdbid</span><span class="p">,</span> <span class="n">disulfides</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="DisulfideLoader-814"><a href="#DisulfideLoader-814"><span class="linenos">814</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">disulfides</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">cutoff</span><span class="p">:</span>
</span><span id="DisulfideLoader-815"><a href="#DisulfideLoader-815"><span class="linenos">815</span></a>                <span class="n">pdbids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdbid</span><span class="p">)</span>
</span><span id="DisulfideLoader-816"><a href="#DisulfideLoader-816"><span class="linenos">816</span></a>                <span class="n">num_disulfides</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">disulfides</span><span class="p">))</span>
</span><span id="DisulfideLoader-817"><a href="#DisulfideLoader-817"><span class="linenos">817</span></a>
</span><span id="DisulfideLoader-818"><a href="#DisulfideLoader-818"><span class="linenos">818</span></a>        <span class="c1"># Create a DataFrame</span>
</span><span id="DisulfideLoader-819"><a href="#DisulfideLoader-819"><span class="linenos">819</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;PDB ID&quot;</span><span class="p">:</span> <span class="n">pdbids</span><span class="p">,</span> <span class="s2">&quot;Number of Disulfides&quot;</span><span class="p">:</span> <span class="n">num_disulfides</span><span class="p">})</span>
</span><span id="DisulfideLoader-820"><a href="#DisulfideLoader-820"><span class="linenos">820</span></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
</span><span id="DisulfideLoader-821"><a href="#DisulfideLoader-821"><span class="linenos">821</span></a>            <span class="n">df</span><span class="p">,</span>
</span><span id="DisulfideLoader-822"><a href="#DisulfideLoader-822"><span class="linenos">822</span></a>            <span class="n">x</span><span class="o">=</span><span class="s2">&quot;PDB ID&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader-823"><a href="#DisulfideLoader-823"><span class="linenos">823</span></a>            <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Number of Disulfides&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader-824"><a href="#DisulfideLoader-824"><span class="linenos">824</span></a>            <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Disulfides vs PDB ID with cutoff: </span><span class="si">{</span><span class="n">cutoff</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pdbids</span><span class="p">)</span><span class="si">}</span><span class="s2"> PDB IDs&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader-825"><a href="#DisulfideLoader-825"><span class="linenos">825</span></a>        <span class="p">)</span>
</span><span id="DisulfideLoader-826"><a href="#DisulfideLoader-826"><span class="linenos">826</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
</span><span id="DisulfideLoader-827"><a href="#DisulfideLoader-827"><span class="linenos">827</span></a>            <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;PDB ID&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader-828"><a href="#DisulfideLoader-828"><span class="linenos">828</span></a>            <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&quot;Number of Disulfides&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader-829"><a href="#DisulfideLoader-829"><span class="linenos">829</span></a>            <span class="n">xaxis_tickangle</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span>
</span><span id="DisulfideLoader-830"><a href="#DisulfideLoader-830"><span class="linenos">830</span></a>        <span class="p">)</span>
</span><span id="DisulfideLoader-831"><a href="#DisulfideLoader-831"><span class="linenos">831</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="DisulfideLoader-832"><a href="#DisulfideLoader-832"><span class="linenos">832</span></a>
</span><span id="DisulfideLoader-833"><a href="#DisulfideLoader-833"><span class="linenos">833</span></a>        <span class="k">return</span> <span class="n">pdbids</span><span class="p">,</span> <span class="n">num_disulfides</span>
</span><span id="DisulfideLoader-834"><a href="#DisulfideLoader-834"><span class="linenos">834</span></a>
</span><span id="DisulfideLoader-835"><a href="#DisulfideLoader-835"><span class="linenos">835</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_distances</span><span class="p">(</span>
</span><span id="DisulfideLoader-836"><a href="#DisulfideLoader-836"><span class="linenos">836</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">distance_type</span><span class="o">=</span><span class="s2">&quot;ca&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">comparison</span><span class="o">=</span><span class="s2">&quot;less&quot;</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span>
</span><span id="DisulfideLoader-837"><a href="#DisulfideLoader-837"><span class="linenos">837</span></a>    <span class="p">):</span>
</span><span id="DisulfideLoader-838"><a href="#DisulfideLoader-838"><span class="linenos">838</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-839"><a href="#DisulfideLoader-839"><span class="linenos">839</span></a><span class="sd">        Plot the distances for the disulfides in the loader.</span>
</span><span id="DisulfideLoader-840"><a href="#DisulfideLoader-840"><span class="linenos">840</span></a>
</span><span id="DisulfideLoader-841"><a href="#DisulfideLoader-841"><span class="linenos">841</span></a><span class="sd">        :param distance_type: The type of distance to plot (&#39;ca&#39; for Cα-Cα distance, &#39;sg&#39; for Sγ-Sγ distance)</span>
</span><span id="DisulfideLoader-842"><a href="#DisulfideLoader-842"><span class="linenos">842</span></a><span class="sd">        :param cutoff: The cutoff value for the distance, defaults to -1 (no cutoff)</span>
</span><span id="DisulfideLoader-843"><a href="#DisulfideLoader-843"><span class="linenos">843</span></a><span class="sd">        :param comparison: if &#39;less&#39; then plot distances less than the cutoff, if &#39;greater&#39; then plot distances greater than the cutoff</span>
</span><span id="DisulfideLoader-844"><a href="#DisulfideLoader-844"><span class="linenos">844</span></a><span class="sd">        :param theme: The theme to use for the plot (&#39;auto&#39;, &#39;light&#39;, or &#39;dark&#39;)</span>
</span><span id="DisulfideLoader-845"><a href="#DisulfideLoader-845"><span class="linenos">845</span></a><span class="sd">        :param log: Whether to use a log scale for the y-axis</span>
</span><span id="DisulfideLoader-846"><a href="#DisulfideLoader-846"><span class="linenos">846</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-847"><a href="#DisulfideLoader-847"><span class="linenos">847</span></a>        <span class="c1"># from proteusPy.DisulfideVisualization import DisulfideVisualization</span>
</span><span id="DisulfideLoader-848"><a href="#DisulfideLoader-848"><span class="linenos">848</span></a>
</span><span id="DisulfideLoader-849"><a href="#DisulfideLoader-849"><span class="linenos">849</span></a>        <span class="c1"># sslist = self.SSList</span>
</span><span id="DisulfideLoader-850"><a href="#DisulfideLoader-850"><span class="linenos">850</span></a>        <span class="c1"># distances = sslist.extract_distances(distance_type, comparison, cutoff)</span>
</span><span id="DisulfideLoader-851"><a href="#DisulfideLoader-851"><span class="linenos">851</span></a>
</span><span id="DisulfideLoader-852"><a href="#DisulfideLoader-852"><span class="linenos">852</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">plot_distances</span><span class="p">(</span>
</span><span id="DisulfideLoader-853"><a href="#DisulfideLoader-853"><span class="linenos">853</span></a>            <span class="n">distance_type</span><span class="o">=</span><span class="n">distance_type</span><span class="p">,</span>
</span><span id="DisulfideLoader-854"><a href="#DisulfideLoader-854"><span class="linenos">854</span></a>            <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span>
</span><span id="DisulfideLoader-855"><a href="#DisulfideLoader-855"><span class="linenos">855</span></a>            <span class="n">comparison</span><span class="o">=</span><span class="n">comparison</span><span class="p">,</span>
</span><span id="DisulfideLoader-856"><a href="#DisulfideLoader-856"><span class="linenos">856</span></a>            <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span>
</span><span id="DisulfideLoader-857"><a href="#DisulfideLoader-857"><span class="linenos">857</span></a>            <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span>
</span><span id="DisulfideLoader-858"><a href="#DisulfideLoader-858"><span class="linenos">858</span></a>        <span class="p">)</span>
</span><span id="DisulfideLoader-859"><a href="#DisulfideLoader-859"><span class="linenos">859</span></a>
</span><span id="DisulfideLoader-860"><a href="#DisulfideLoader-860"><span class="linenos">860</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_deviation_scatterplots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">):</span>
</span><span id="DisulfideLoader-861"><a href="#DisulfideLoader-861"><span class="linenos">861</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-862"><a href="#DisulfideLoader-862"><span class="linenos">862</span></a><span class="sd">        Plot scatter plots for Bondlength_Deviation, Angle_Deviation Ca_Distance</span>
</span><span id="DisulfideLoader-863"><a href="#DisulfideLoader-863"><span class="linenos">863</span></a><span class="sd">        and SG_Distance.</span>
</span><span id="DisulfideLoader-864"><a href="#DisulfideLoader-864"><span class="linenos">864</span></a>
</span><span id="DisulfideLoader-865"><a href="#DisulfideLoader-865"><span class="linenos">865</span></a><span class="sd">        :param verbose: Whether to display the plot in the notebook. Default is False.</span>
</span><span id="DisulfideLoader-866"><a href="#DisulfideLoader-866"><span class="linenos">866</span></a><span class="sd">        :type verbose: bool</span>
</span><span id="DisulfideLoader-867"><a href="#DisulfideLoader-867"><span class="linenos">867</span></a><span class="sd">        :param theme: One of &#39;Auto&#39;, &#39;Light&#39;, or &#39;Dark&#39;. Default is &#39;Auto&#39;.</span>
</span><span id="DisulfideLoader-868"><a href="#DisulfideLoader-868"><span class="linenos">868</span></a><span class="sd">        :type light: str</span>
</span><span id="DisulfideLoader-869"><a href="#DisulfideLoader-869"><span class="linenos">869</span></a><span class="sd">        :return: None</span>
</span><span id="DisulfideLoader-870"><a href="#DisulfideLoader-870"><span class="linenos">870</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-871"><a href="#DisulfideLoader-871"><span class="linenos">871</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">plot_deviation_scatterplots</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">)</span>
</span><span id="DisulfideLoader-872"><a href="#DisulfideLoader-872"><span class="linenos">872</span></a>
</span><span id="DisulfideLoader-873"><a href="#DisulfideLoader-873"><span class="linenos">873</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_deviation_histograms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="DisulfideLoader-874"><a href="#DisulfideLoader-874"><span class="linenos">874</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-875"><a href="#DisulfideLoader-875"><span class="linenos">875</span></a><span class="sd">        Plot histograms for Bondlength_Deviation, Angle_Deviation, and Ca_Distance.</span>
</span><span id="DisulfideLoader-876"><a href="#DisulfideLoader-876"><span class="linenos">876</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-877"><a href="#DisulfideLoader-877"><span class="linenos">877</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">plot_deviation_histograms</span><span class="p">(</span><span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="DisulfideLoader-878"><a href="#DisulfideLoader-878"><span class="linenos">878</span></a>
</span><span id="DisulfideLoader-879"><a href="#DisulfideLoader-879"><span class="linenos">879</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_classes</span><span class="p">(</span>
</span><span id="DisulfideLoader-880"><a href="#DisulfideLoader-880"><span class="linenos">880</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">class_string</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">page_size</span><span class="o">=</span><span class="mi">200</span>
</span><span id="DisulfideLoader-881"><a href="#DisulfideLoader-881"><span class="linenos">881</span></a>    <span class="p">):</span>
</span><span id="DisulfideLoader-882"><a href="#DisulfideLoader-882"><span class="linenos">882</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-883"><a href="#DisulfideLoader-883"><span class="linenos">883</span></a><span class="sd">        Plot the distribution of disulfides for the given class string.</span>
</span><span id="DisulfideLoader-884"><a href="#DisulfideLoader-884"><span class="linenos">884</span></a>
</span><span id="DisulfideLoader-885"><a href="#DisulfideLoader-885"><span class="linenos">885</span></a><span class="sd">        :param class_string: The class string to plot.</span>
</span><span id="DisulfideLoader-886"><a href="#DisulfideLoader-886"><span class="linenos">886</span></a><span class="sd">        :type class_string: str</span>
</span><span id="DisulfideLoader-887"><a href="#DisulfideLoader-887"><span class="linenos">887</span></a><span class="sd">        :param base: The base of the class string. Default is 8.</span>
</span><span id="DisulfideLoader-888"><a href="#DisulfideLoader-888"><span class="linenos">888</span></a><span class="sd">        :type base: int</span>
</span><span id="DisulfideLoader-889"><a href="#DisulfideLoader-889"><span class="linenos">889</span></a><span class="sd">        :param theme: The theme to use for the plot (&#39;auto&#39;, &#39;light&#39;, or &#39;dark&#39;), defaults to &#39;auto&#39;.</span>
</span><span id="DisulfideLoader-890"><a href="#DisulfideLoader-890"><span class="linenos">890</span></a><span class="sd">        :type theme: str</span>
</span><span id="DisulfideLoader-891"><a href="#DisulfideLoader-891"><span class="linenos">891</span></a><span class="sd">        :return: None</span>
</span><span id="DisulfideLoader-892"><a href="#DisulfideLoader-892"><span class="linenos">892</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-893"><a href="#DisulfideLoader-893"><span class="linenos">893</span></a>        <span class="n">classlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="o">.</span><span class="n">binary_to_class</span><span class="p">(</span><span class="n">class_string</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideLoader-894"><a href="#DisulfideLoader-894"><span class="linenos">894</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_enumerate_class_fromlist</span><span class="p">(</span><span class="n">classlist</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideLoader-895"><a href="#DisulfideLoader-895"><span class="linenos">895</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot_count_vs_class_df</span><span class="p">(</span>
</span><span id="DisulfideLoader-896"><a href="#DisulfideLoader-896"><span class="linenos">896</span></a>            <span class="n">df</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">class_string</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span> <span class="n">page_size</span><span class="o">=</span><span class="n">page_size</span>
</span><span id="DisulfideLoader-897"><a href="#DisulfideLoader-897"><span class="linenos">897</span></a>        <span class="p">)</span>
</span><span id="DisulfideLoader-898"><a href="#DisulfideLoader-898"><span class="linenos">898</span></a>
</span><span id="DisulfideLoader-899"><a href="#DisulfideLoader-899"><span class="linenos">899</span></a>        <span class="k">return</span>
</span><span id="DisulfideLoader-900"><a href="#DisulfideLoader-900"><span class="linenos">900</span></a>
</span><span id="DisulfideLoader-901"><a href="#DisulfideLoader-901"><span class="linenos">901</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sslist_from_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_string</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="DisulfideLoader-902"><a href="#DisulfideLoader-902"><span class="linenos">902</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-903"><a href="#DisulfideLoader-903"><span class="linenos">903</span></a><span class="sd">        Return a DisulfideList containing Disulfides with the given class_string.</span>
</span><span id="DisulfideLoader-904"><a href="#DisulfideLoader-904"><span class="linenos">904</span></a>
</span><span id="DisulfideLoader-905"><a href="#DisulfideLoader-905"><span class="linenos">905</span></a><span class="sd">        :param class_string: The class string to search for.</span>
</span><span id="DisulfideLoader-906"><a href="#DisulfideLoader-906"><span class="linenos">906</span></a><span class="sd">        :param base: The base of the class string. Default is 8.</span>
</span><span id="DisulfideLoader-907"><a href="#DisulfideLoader-907"><span class="linenos">907</span></a><span class="sd">        :param cutoff: The % cutoff value for the class. Default is 0.0.</span>
</span><span id="DisulfideLoader-908"><a href="#DisulfideLoader-908"><span class="linenos">908</span></a><span class="sd">        :return: DisulfideList containing Disulfides with the given class_string.</span>
</span><span id="DisulfideLoader-909"><a href="#DisulfideLoader-909"><span class="linenos">909</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-910"><a href="#DisulfideLoader-910"><span class="linenos">910</span></a>        <span class="n">sslist_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">class_string</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">base</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">cutoff</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DisulfideLoader-911"><a href="#DisulfideLoader-911"><span class="linenos">911</span></a>        <span class="n">sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="n">sslist_name</span><span class="p">)</span>
</span><span id="DisulfideLoader-912"><a href="#DisulfideLoader-912"><span class="linenos">912</span></a>
</span><span id="DisulfideLoader-913"><a href="#DisulfideLoader-913"><span class="linenos">913</span></a>        <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_class_indices_from_tors_df</span><span class="p">(</span><span class="n">class_string</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideLoader-914"><a href="#DisulfideLoader-914"><span class="linenos">914</span></a>
</span><span id="DisulfideLoader-915"><a href="#DisulfideLoader-915"><span class="linenos">915</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
</span><span id="DisulfideLoader-916"><a href="#DisulfideLoader-916"><span class="linenos">916</span></a>            <span class="n">sslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="DisulfideLoader-917"><a href="#DisulfideLoader-917"><span class="linenos">917</span></a>
</span><span id="DisulfideLoader-918"><a href="#DisulfideLoader-918"><span class="linenos">918</span></a>        <span class="k">return</span> <span class="n">sslist</span>
</span><span id="DisulfideLoader-919"><a href="#DisulfideLoader-919"><span class="linenos">919</span></a>
</span><span id="DisulfideLoader-920"><a href="#DisulfideLoader-920"><span class="linenos">920</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display_torsion_statistics</span><span class="p">(</span>
</span><span id="DisulfideLoader-921"><a href="#DisulfideLoader-921"><span class="linenos">921</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DisulfideLoader-922"><a href="#DisulfideLoader-922"><span class="linenos">922</span></a>        <span class="n">class_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="DisulfideLoader-923"><a href="#DisulfideLoader-923"><span class="linenos">923</span></a>        <span class="n">display</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DisulfideLoader-924"><a href="#DisulfideLoader-924"><span class="linenos">924</span></a>        <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader-925"><a href="#DisulfideLoader-925"><span class="linenos">925</span></a>        <span class="n">fname</span><span class="o">=</span><span class="s2">&quot;ss_torsions.png&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader-926"><a href="#DisulfideLoader-926"><span class="linenos">926</span></a>        <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader-927"><a href="#DisulfideLoader-927"><span class="linenos">927</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader-928"><a href="#DisulfideLoader-928"><span class="linenos">928</span></a>    <span class="p">):</span>
</span><span id="DisulfideLoader-929"><a href="#DisulfideLoader-929"><span class="linenos">929</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-930"><a href="#DisulfideLoader-930"><span class="linenos">930</span></a><span class="sd">        Display torsion and distance statistics for Disulfides in the loader.</span>
</span><span id="DisulfideLoader-931"><a href="#DisulfideLoader-931"><span class="linenos">931</span></a>
</span><span id="DisulfideLoader-932"><a href="#DisulfideLoader-932"><span class="linenos">932</span></a><span class="sd">        :param class_id: The class ID to display statistics for. Default is None.</span>
</span><span id="DisulfideLoader-933"><a href="#DisulfideLoader-933"><span class="linenos">933</span></a><span class="sd">        :type class_id: str</span>
</span><span id="DisulfideLoader-934"><a href="#DisulfideLoader-934"><span class="linenos">934</span></a><span class="sd">        :param display: Whether to display the plot in the notebook. Default is True.</span>
</span><span id="DisulfideLoader-935"><a href="#DisulfideLoader-935"><span class="linenos">935</span></a><span class="sd">        :type display: bool</span>
</span><span id="DisulfideLoader-936"><a href="#DisulfideLoader-936"><span class="linenos">936</span></a><span class="sd">        :param save: Whether to save the plot as an image file. Default is False.</span>
</span><span id="DisulfideLoader-937"><a href="#DisulfideLoader-937"><span class="linenos">937</span></a><span class="sd">        :type save: bool</span>
</span><span id="DisulfideLoader-938"><a href="#DisulfideLoader-938"><span class="linenos">938</span></a><span class="sd">        :param fname: The name of the image file to save. Default is &#39;ss_torsions.png&#39;.</span>
</span><span id="DisulfideLoader-939"><a href="#DisulfideLoader-939"><span class="linenos">939</span></a><span class="sd">        :type fname: str</span>
</span><span id="DisulfideLoader-940"><a href="#DisulfideLoader-940"><span class="linenos">940</span></a><span class="sd">        :param theme: One of &#39;Auto&#39;, &#39;Light&#39;, or &#39;Dark&#39;. Default is &#39;Auto&#39;.</span>
</span><span id="DisulfideLoader-941"><a href="#DisulfideLoader-941"><span class="linenos">941</span></a><span class="sd">        :type theme: str</span>
</span><span id="DisulfideLoader-942"><a href="#DisulfideLoader-942"><span class="linenos">942</span></a><span class="sd">        :param verbose: Whether to display verbose output. Default is False.</span>
</span><span id="DisulfideLoader-943"><a href="#DisulfideLoader-943"><span class="linenos">943</span></a><span class="sd">        :type verbose: bool</span>
</span><span id="DisulfideLoader-944"><a href="#DisulfideLoader-944"><span class="linenos">944</span></a><span class="sd">        :return: None</span>
</span><span id="DisulfideLoader-945"><a href="#DisulfideLoader-945"><span class="linenos">945</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-946"><a href="#DisulfideLoader-946"><span class="linenos">946</span></a>        <span class="k">if</span> <span class="n">class_id</span><span class="p">:</span>
</span><span id="DisulfideLoader-947"><a href="#DisulfideLoader-947"><span class="linenos">947</span></a>            <span class="n">sslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_class</span><span class="p">(</span><span class="n">class_id</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="DisulfideLoader-948"><a href="#DisulfideLoader-948"><span class="linenos">948</span></a>            <span class="n">sslist</span><span class="o">.</span><span class="n">display_torsion_statistics</span><span class="p">(</span>
</span><span id="DisulfideLoader-949"><a href="#DisulfideLoader-949"><span class="linenos">949</span></a>                <span class="n">display</span><span class="o">=</span><span class="n">display</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">fname</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="n">theme</span>
</span><span id="DisulfideLoader-950"><a href="#DisulfideLoader-950"><span class="linenos">950</span></a>            <span class="p">)</span>
</span><span id="DisulfideLoader-951"><a href="#DisulfideLoader-951"><span class="linenos">951</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideLoader-952"><a href="#DisulfideLoader-952"><span class="linenos">952</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">display_torsion_statistics</span><span class="p">(</span>
</span><span id="DisulfideLoader-953"><a href="#DisulfideLoader-953"><span class="linenos">953</span></a>                <span class="n">display</span><span class="o">=</span><span class="n">display</span><span class="p">,</span>
</span><span id="DisulfideLoader-954"><a href="#DisulfideLoader-954"><span class="linenos">954</span></a>                <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span>
</span><span id="DisulfideLoader-955"><a href="#DisulfideLoader-955"><span class="linenos">955</span></a>                <span class="n">fname</span><span class="o">=</span><span class="n">fname</span><span class="p">,</span>
</span><span id="DisulfideLoader-956"><a href="#DisulfideLoader-956"><span class="linenos">956</span></a>                <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span>
</span><span id="DisulfideLoader-957"><a href="#DisulfideLoader-957"><span class="linenos">957</span></a>            <span class="p">)</span>
</span><span id="DisulfideLoader-958"><a href="#DisulfideLoader-958"><span class="linenos">958</span></a>
</span><span id="DisulfideLoader-959"><a href="#DisulfideLoader-959"><span class="linenos">959</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">classes_vs_cutoff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
</span><span id="DisulfideLoader-960"><a href="#DisulfideLoader-960"><span class="linenos">960</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-961"><a href="#DisulfideLoader-961"><span class="linenos">961</span></a><span class="sd">        Return number of members for the octant class for a given cutoff value.</span>
</span><span id="DisulfideLoader-962"><a href="#DisulfideLoader-962"><span class="linenos">962</span></a>
</span><span id="DisulfideLoader-963"><a href="#DisulfideLoader-963"><span class="linenos">963</span></a><span class="sd">        :param cutoff: Percent cutoff value for filtering the classes.</span>
</span><span id="DisulfideLoader-964"><a href="#DisulfideLoader-964"><span class="linenos">964</span></a><span class="sd">        :return: None</span>
</span><span id="DisulfideLoader-965"><a href="#DisulfideLoader-965"><span class="linenos">965</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-966"><a href="#DisulfideLoader-966"><span class="linenos">966</span></a>
</span><span id="DisulfideLoader-967"><a href="#DisulfideLoader-967"><span class="linenos">967</span></a>        <span class="n">class_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="o">.</span><span class="n">filter_class_by_percentage</span><span class="p">(</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideLoader-968"><a href="#DisulfideLoader-968"><span class="linenos">968</span></a>        <span class="k">return</span> <span class="n">class_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>This class represents the disulfide database itself and is its primary means of accession.
The entirety of the RCSB disulfide database is stored within the class via a
proteusPy.DisulfideList, a <code>Pandas</code> .csv file, and a <code>dict</code> of
indices mapping the PDB IDs into their respective list of disulfides. The datastructures allow
simple, direct and flexible access to the disulfide structures contained herein.
This makes it possible to access the disulfides by array index, PDB structure ID, disulfide
name and class ID.</p>

<p>The class also provides methods for plotting distance and angle deviations
as well as torsion statistics for the disulfides in the database.</p>

<p>The class can also render Disulfides overlaid on a common coordinate system to a pyVista
window using the <a href="#DisulfideLoader.display_overlay">display_overlay()</a> method. See below for examples.</p>

<p>Important note: For typical usage one will access the database via the <code><a href="#Load_PDB_SS">Load_PDB_SS()</a></code> function.
The difference is that the latter function loads the compressed database from its single
source. The <code><a href="#DisulfideLoader">DisulfideLoader</a></code> class is used to build the Disulifde database with a
specific cutoff, or for saving the database to a file.</p>

<p>Cutoff values of -1.0 indicate imposing no cutoffs on the data.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>verbose</strong>:  Flag to control output verbosity</li>
<li><strong>datadir</strong>:  Directory containing data files</li>
<li><strong>picklefile</strong>:  Name of the pickle file containing disulfide data</li>
<li><strong>quiet</strong>:  Flag to suppress warnings</li>
<li><strong>subset</strong>:  Flag to load only a subset of data</li>
<li><strong>cutoff</strong>:  Distance cutoff, (A) for filtering disulfides. Defaults to -1.0.</li>
<li><strong>sg_cutoff</strong>:  SG distance cutoff, (A) for filtering disulfides. Defaults to -1.0.</li>
<li><strong>percentile</strong>:  Percentile cutoff for filtering disulfides. Must be between 0 and 100.
Filters based on statistical cutoffs derived from the data.</li>
<li><strong>minimum</strong>:  Minimum atom distance for filtering disulfides. -1 is no filtering.</li>
<li><strong>save</strong>:  Flag to save the Loader to a file</li>
</ul>
</div>


                            <div id="DisulfideLoader.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">DisulfideLoader</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">datadir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;/Users/egs/repos/proteusPy/proteusPy/data&#39;</span>,</span><span class="param">	<span class="n">picklefile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;PDB_all_ss.pkl&#39;</span>,</span><span class="param">	<span class="n">subset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>,</span><span class="param">	<span class="n">sg_cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>,</span><span class="param">	<span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">percentile</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>,</span><span class="param">	<span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">minimum</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>,</span><span class="param">	<span class="n">saveit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.__init__"></a>
    
    

                            </div>
                            <div id="DisulfideLoader.datadir" class="classattr">
                                <div class="attr variable">
            <span class="name">datadir</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;/Users/egs/repos/proteusPy/proteusPy/data&#39;</span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.datadir"></a>
    
    

                            </div>
                            <div id="DisulfideLoader.picklefile" class="classattr">
                                <div class="attr variable">
            <span class="name">picklefile</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;PDB_all_ss.pkl&#39;</span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.picklefile"></a>
    
    

                            </div>
                            <div id="DisulfideLoader.subset" class="classattr">
                                <div class="attr variable">
            <span class="name">subset</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.subset"></a>
    
    

                            </div>
                            <div id="DisulfideLoader.cutoff" class="classattr">
                                <div class="attr variable">
            <span class="name">cutoff</span><span class="annotation">: float</span>        =
<span class="default_value">-1.0</span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.cutoff"></a>
    
    

                            </div>
                            <div id="DisulfideLoader.sg_cutoff" class="classattr">
                                <div class="attr variable">
            <span class="name">sg_cutoff</span><span class="annotation">: float</span>        =
<span class="default_value">-1.0</span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.sg_cutoff"></a>
    
    

                            </div>
                            <div id="DisulfideLoader.verbose" class="classattr">
                                <div class="attr variable">
            <span class="name">verbose</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.verbose"></a>
    
    

                            </div>
                            <div id="DisulfideLoader.percentile" class="classattr">
                                <div class="attr variable">
            <span class="name">percentile</span><span class="annotation">: float</span>        =
<span class="default_value">-1.0</span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.percentile"></a>
    
    

                            </div>
                            <div id="DisulfideLoader.quiet" class="classattr">
                                <div class="attr variable">
            <span class="name">quiet</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.quiet"></a>
    
    

                            </div>
                            <div id="DisulfideLoader.minimum" class="classattr">
                                <div class="attr variable">
            <span class="name">minimum</span><span class="annotation">: float</span>        =
<span class="default_value">-1.0</span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.minimum"></a>
    
    

                            </div>
                            <div id="DisulfideLoader.saveit" class="classattr">
                                <div class="attr variable">
            <span class="name">saveit</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.saveit"></a>
    
    

                            </div>
                            <div id="DisulfideLoader.SSList" class="classattr">
                                <div class="attr variable">
            <span class="name">SSList</span><span class="annotation">: <a href="DisulfideBase.html#DisulfideList">proteusPy.DisulfideBase.DisulfideList</a></span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.SSList"></a>
    
    

                            </div>
                            <div id="DisulfideLoader.SSDict" class="classattr">
                                <div class="attr variable">
            <span class="name">SSDict</span><span class="annotation">: Dict</span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.SSDict"></a>
    
    

                            </div>
                            <div id="DisulfideLoader.TorsionDF" class="classattr">
                                <div class="attr variable">
            <span class="name">TorsionDF</span><span class="annotation">: pandas.core.frame.DataFrame</span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.TorsionDF"></a>
    
    

                            </div>
                            <div id="DisulfideLoader.TotalDisulfides" class="classattr">
                                <div class="attr variable">
            <span class="name">TotalDisulfides</span><span class="annotation">: int</span>        =
<span class="default_value">0</span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.TotalDisulfides"></a>
    
    

                            </div>
                            <div id="DisulfideLoader.IDList" class="classattr">
                                <div class="attr variable">
            <span class="name">IDList</span><span class="annotation">: List</span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.IDList"></a>
    
    

                            </div>
                            <div id="DisulfideLoader.tclass" class="classattr">
                                <div class="attr variable">
            <span class="name">tclass</span><span class="annotation">: Optional[<a href="DisulfideClassManager.html#DisulfideClassManager">proteusPy.DisulfideClassManager.DisulfideClassManager</a>]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.tclass"></a>
    
    

                            </div>
                            <div id="DisulfideLoader.timestamp" class="classattr">
                                <div class="attr variable">
            <span class="name">timestamp</span><span class="annotation">: float</span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.timestamp"></a>
    
    

                            </div>
                            <div id="DisulfideLoader.version" class="classattr">
                                <div class="attr variable">
            <span class="name">version</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;0.99.34.dev3&#39;</span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.version"></a>
    
    

                            </div>
                            <div id="DisulfideLoader.average_resolution" class="classattr">
                                        <input id="DisulfideLoader.average_resolution-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">average_resolution</span><span class="annotation">: float</span>

                <label class="view-source-button" for="DisulfideLoader.average_resolution-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.average_resolution"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.average_resolution-325"><a href="#DisulfideLoader.average_resolution-325"><span class="linenos">325</span></a>    <span class="nd">@property</span>
</span><span id="DisulfideLoader.average_resolution-326"><a href="#DisulfideLoader.average_resolution-326"><span class="linenos">326</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">average_resolution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="DisulfideLoader.average_resolution-327"><a href="#DisulfideLoader.average_resolution-327"><span class="linenos">327</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.average_resolution-328"><a href="#DisulfideLoader.average_resolution-328"><span class="linenos">328</span></a><span class="sd">        Return the average structure resolution for the given list.</span>
</span><span id="DisulfideLoader.average_resolution-329"><a href="#DisulfideLoader.average_resolution-329"><span class="linenos">329</span></a><span class="sd">        Result is cached since resolution values don&#39;t change after loading.</span>
</span><span id="DisulfideLoader.average_resolution-330"><a href="#DisulfideLoader.average_resolution-330"><span class="linenos">330</span></a>
</span><span id="DisulfideLoader.average_resolution-331"><a href="#DisulfideLoader.average_resolution-331"><span class="linenos">331</span></a><span class="sd">        :return: Average resolution (A)</span>
</span><span id="DisulfideLoader.average_resolution-332"><a href="#DisulfideLoader.average_resolution-332"><span class="linenos">332</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.average_resolution-333"><a href="#DisulfideLoader.average_resolution-333"><span class="linenos">333</span></a>        <span class="n">sslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span>
</span><span id="DisulfideLoader.average_resolution-334"><a href="#DisulfideLoader.average_resolution-334"><span class="linenos">334</span></a>        <span class="n">valid_resolutions</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DisulfideLoader.average_resolution-335"><a href="#DisulfideLoader.average_resolution-335"><span class="linenos">335</span></a>            <span class="n">ss</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="DisulfideLoader.average_resolution-336"><a href="#DisulfideLoader.average_resolution-336"><span class="linenos">336</span></a>            <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">sslist</span>
</span><span id="DisulfideLoader.average_resolution-337"><a href="#DisulfideLoader.average_resolution-337"><span class="linenos">337</span></a>            <span class="k">if</span> <span class="n">ss</span><span class="o">.</span><span class="n">resolution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ss</span><span class="o">.</span><span class="n">resolution</span> <span class="o">!=</span> <span class="o">-</span><span class="mf">1.0</span>
</span><span id="DisulfideLoader.average_resolution-338"><a href="#DisulfideLoader.average_resolution-338"><span class="linenos">338</span></a>        <span class="p">]</span>
</span><span id="DisulfideLoader.average_resolution-339"><a href="#DisulfideLoader.average_resolution-339"><span class="linenos">339</span></a>
</span><span id="DisulfideLoader.average_resolution-340"><a href="#DisulfideLoader.average_resolution-340"><span class="linenos">340</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_resolutions</span><span class="p">:</span>
</span><span id="DisulfideLoader.average_resolution-341"><a href="#DisulfideLoader.average_resolution-341"><span class="linenos">341</span></a>            <span class="k">return</span> <span class="o">-</span><span class="mf">1.0</span>
</span><span id="DisulfideLoader.average_resolution-342"><a href="#DisulfideLoader.average_resolution-342"><span class="linenos">342</span></a>
</span><span id="DisulfideLoader.average_resolution-343"><a href="#DisulfideLoader.average_resolution-343"><span class="linenos">343</span></a>        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">valid_resolutions</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_resolutions</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the average structure resolution for the given list.
Result is cached since resolution values don't change after loading.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Average resolution (A)</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideLoader.binary_to_class" class="classattr">
                                        <input id="DisulfideLoader.binary_to_class-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">binary_to_class</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">binary_class</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">base</span><span class="o">=</span><span class="mi">8</span></span><span class="return-annotation">) -> <span class="nb">list</span>:</span></span>

                <label class="view-source-button" for="DisulfideLoader.binary_to_class-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.binary_to_class"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.binary_to_class-345"><a href="#DisulfideLoader.binary_to_class-345"><span class="linenos">345</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">binary_to_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">binary_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="DisulfideLoader.binary_to_class-346"><a href="#DisulfideLoader.binary_to_class-346"><span class="linenos">346</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.binary_to_class-347"><a href="#DisulfideLoader.binary_to_class-347"><span class="linenos">347</span></a><span class="sd">        Convert a binary class string to an octant class string.</span>
</span><span id="DisulfideLoader.binary_to_class-348"><a href="#DisulfideLoader.binary_to_class-348"><span class="linenos">348</span></a>
</span><span id="DisulfideLoader.binary_to_class-349"><a href="#DisulfideLoader.binary_to_class-349"><span class="linenos">349</span></a><span class="sd">        :param binary_class: The binary class string to convert.</span>
</span><span id="DisulfideLoader.binary_to_class-350"><a href="#DisulfideLoader.binary_to_class-350"><span class="linenos">350</span></a><span class="sd">        :param base: The base class to use, 2 or 8.</span>
</span><span id="DisulfideLoader.binary_to_class-351"><a href="#DisulfideLoader.binary_to_class-351"><span class="linenos">351</span></a><span class="sd">        :return: The octant class list.</span>
</span><span id="DisulfideLoader.binary_to_class-352"><a href="#DisulfideLoader.binary_to_class-352"><span class="linenos">352</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.binary_to_class-353"><a href="#DisulfideLoader.binary_to_class-353"><span class="linenos">353</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="o">.</span><span class="n">binary_to_class</span><span class="p">(</span><span class="n">binary_class</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Convert a binary class string to an octant class string.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>binary_class</strong>:  The binary class string to convert.</li>
<li><strong>base</strong>:  The base class to use, 2 or 8.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The octant class list.</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideLoader.build_ss_from_idlist" class="classattr">
                                        <input id="DisulfideLoader.build_ss_from_idlist-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">build_ss_from_idlist</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">idlist</span></span><span class="return-annotation">) -> <span class="n"><a href="DisulfideBase.html#DisulfideList">proteusPy.DisulfideBase.DisulfideList</a></span>:</span></span>

                <label class="view-source-button" for="DisulfideLoader.build_ss_from_idlist-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.build_ss_from_idlist"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.build_ss_from_idlist-355"><a href="#DisulfideLoader.build_ss_from_idlist-355"><span class="linenos">355</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build_ss_from_idlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idlist</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-356"><a href="#DisulfideLoader.build_ss_from_idlist-356"><span class="linenos">356</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-357"><a href="#DisulfideLoader.build_ss_from_idlist-357"><span class="linenos">357</span></a><span class="sd">        Return a DisulfideList of Disulfides for a given list of PDBIDs</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-358"><a href="#DisulfideLoader.build_ss_from_idlist-358"><span class="linenos">358</span></a>
</span><span id="DisulfideLoader.build_ss_from_idlist-359"><a href="#DisulfideLoader.build_ss_from_idlist-359"><span class="linenos">359</span></a><span class="sd">        :param idlist: List of PDBIDs, e.g. [&#39;4yys&#39;, &#39;2q7q&#39;]</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-360"><a href="#DisulfideLoader.build_ss_from_idlist-360"><span class="linenos">360</span></a><span class="sd">        :return: DisulfideList</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-361"><a href="#DisulfideLoader.build_ss_from_idlist-361"><span class="linenos">361</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-362"><a href="#DisulfideLoader.build_ss_from_idlist-362"><span class="linenos">362</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s2">&quot;RCSB_list&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-363"><a href="#DisulfideLoader.build_ss_from_idlist-363"><span class="linenos">363</span></a>        <span class="k">for</span> <span class="n">pdbid</span><span class="p">,</span> <span class="n">sslist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-364"><a href="#DisulfideLoader.build_ss_from_idlist-364"><span class="linenos">364</span></a>            <span class="k">if</span> <span class="n">pdbid</span> <span class="ow">in</span> <span class="n">idlist</span><span class="p">:</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-365"><a href="#DisulfideLoader.build_ss_from_idlist-365"><span class="linenos">365</span></a>                <span class="k">for</span> <span class="n">ssid</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">:</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-366"><a href="#DisulfideLoader.build_ss_from_idlist-366"><span class="linenos">366</span></a>                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="n">ssid</span><span class="p">])</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-367"><a href="#DisulfideLoader.build_ss_from_idlist-367"><span class="linenos">367</span></a>        <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Return a DisulfideList of Disulfides for a given list of PDBIDs</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>idlist</strong>:  List of PDBIDs, e.g. ['4yys', '2q7q']</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>DisulfideList</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideLoader.copy" class="classattr">
                                        <input id="DisulfideLoader.copy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">copy</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.copy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.copy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.copy-395"><a href="#DisulfideLoader.copy-395"><span class="linenos">395</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideLoader.copy-396"><a href="#DisulfideLoader.copy-396"><span class="linenos">396</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.copy-397"><a href="#DisulfideLoader.copy-397"><span class="linenos">397</span></a><span class="sd">        Return a copy of self.</span>
</span><span id="DisulfideLoader.copy-398"><a href="#DisulfideLoader.copy-398"><span class="linenos">398</span></a>
</span><span id="DisulfideLoader.copy-399"><a href="#DisulfideLoader.copy-399"><span class="linenos">399</span></a><span class="sd">        :return: Copy of self</span>
</span><span id="DisulfideLoader.copy-400"><a href="#DisulfideLoader.copy-400"><span class="linenos">400</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.copy-401"><a href="#DisulfideLoader.copy-401"><span class="linenos">401</span></a>        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a copy of self.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Copy of self</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideLoader.get_class_df" class="classattr">
                                        <input id="DisulfideLoader.get_class_df-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_class_df</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">base</span><span class="o">=</span><span class="mi">8</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>:</span></span>

                <label class="view-source-button" for="DisulfideLoader.get_class_df-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.get_class_df"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.get_class_df-424"><a href="#DisulfideLoader.get_class_df-424"><span class="linenos">424</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_class_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="DisulfideLoader.get_class_df-425"><a href="#DisulfideLoader.get_class_df-425"><span class="linenos">425</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.get_class_df-426"><a href="#DisulfideLoader.get_class_df-426"><span class="linenos">426</span></a><span class="sd">        Return the class incidence dataframe for the input base.</span>
</span><span id="DisulfideLoader.get_class_df-427"><a href="#DisulfideLoader.get_class_df-427"><span class="linenos">427</span></a><span class="sd">        Result is cached since class distributions don&#39;t change after loading.</span>
</span><span id="DisulfideLoader.get_class_df-428"><a href="#DisulfideLoader.get_class_df-428"><span class="linenos">428</span></a>
</span><span id="DisulfideLoader.get_class_df-429"><a href="#DisulfideLoader.get_class_df-429"><span class="linenos">429</span></a><span class="sd">        :param base: The base class to use, 2 or 8.</span>
</span><span id="DisulfideLoader.get_class_df-430"><a href="#DisulfideLoader.get_class_df-430"><span class="linenos">430</span></a><span class="sd">        :return: pd.DataFrame</span>
</span><span id="DisulfideLoader.get_class_df-431"><a href="#DisulfideLoader.get_class_df-431"><span class="linenos">431</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.get_class_df-432"><a href="#DisulfideLoader.get_class_df-432"><span class="linenos">432</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="o">.</span><span class="n">get_class_df</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the class incidence dataframe for the input base.
Result is cached since class distributions don't change after loading.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base</strong>:  The base class to use, 2 or 8.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>pd.DataFrame</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideLoader.extract_class" class="classattr">
                                        <input id="DisulfideLoader.extract_class-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">extract_class</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">clsid</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="DisulfideBase.html#DisulfideList">proteusPy.DisulfideBase.DisulfideList</a></span>:</span></span>

                <label class="view-source-button" for="DisulfideLoader.extract_class-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.extract_class"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.extract_class-434"><a href="#DisulfideLoader.extract_class-434"><span class="linenos">434</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">extract_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clsid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="DisulfideLoader.extract_class-435"><a href="#DisulfideLoader.extract_class-435"><span class="linenos">435</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.extract_class-436"><a href="#DisulfideLoader.extract_class-436"><span class="linenos">436</span></a><span class="sd">        Return the list of disulfides corresponding to the input `clsid`.</span>
</span><span id="DisulfideLoader.extract_class-437"><a href="#DisulfideLoader.extract_class-437"><span class="linenos">437</span></a>
</span><span id="DisulfideLoader.extract_class-438"><a href="#DisulfideLoader.extract_class-438"><span class="linenos">438</span></a><span class="sd">        :param clsid: The class name to extract.</span>
</span><span id="DisulfideLoader.extract_class-439"><a href="#DisulfideLoader.extract_class-439"><span class="linenos">439</span></a><span class="sd">        :param verbose: If True, display progress bars, by default False</span>
</span><span id="DisulfideLoader.extract_class-440"><a href="#DisulfideLoader.extract_class-440"><span class="linenos">440</span></a><span class="sd">        :return: The list of disulfide bonds from the class.</span>
</span><span id="DisulfideLoader.extract_class-441"><a href="#DisulfideLoader.extract_class-441"><span class="linenos">441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.extract_class-442"><a href="#DisulfideLoader.extract_class-442"><span class="linenos">442</span></a>
</span><span id="DisulfideLoader.extract_class-443"><a href="#DisulfideLoader.extract_class-443"><span class="linenos">443</span></a>        <span class="c1"># cls = clsid[:5]</span>
</span><span id="DisulfideLoader.extract_class-444"><a href="#DisulfideLoader.extract_class-444"><span class="linenos">444</span></a>        <span class="bp">cls</span> <span class="o">=</span> <span class="n">clsid</span>
</span><span id="DisulfideLoader.extract_class-445"><a href="#DisulfideLoader.extract_class-445"><span class="linenos">445</span></a>        <span class="n">ss_ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DisulfideLoader.extract_class-446"><a href="#DisulfideLoader.extract_class-446"><span class="linenos">446</span></a>        <span class="n">class_disulfides</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideLoader.extract_class-447"><a href="#DisulfideLoader.extract_class-447"><span class="linenos">447</span></a>
</span><span id="DisulfideLoader.extract_class-448"><a href="#DisulfideLoader.extract_class-448"><span class="linenos">448</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DisulfideLoader.extract_class-449"><a href="#DisulfideLoader.extract_class-449"><span class="linenos">449</span></a>            <span class="n">ss_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="p">[</span><span class="n">clsid</span><span class="p">]</span>
</span><span id="DisulfideLoader.extract_class-450"><a href="#DisulfideLoader.extract_class-450"><span class="linenos">450</span></a>
</span><span id="DisulfideLoader.extract_class-451"><a href="#DisulfideLoader.extract_class-451"><span class="linenos">451</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="DisulfideLoader.extract_class-452"><a href="#DisulfideLoader.extract_class-452"><span class="linenos">452</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Cannot find key </span><span class="si">%s</span><span class="s2"> in SSBond DB&quot;</span><span class="p">,</span> <span class="n">clsid</span><span class="p">)</span>
</span><span id="DisulfideLoader.extract_class-453"><a href="#DisulfideLoader.extract_class-453"><span class="linenos">453</span></a>            <span class="k">return</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DisulfideLoader.extract_class-454"><a href="#DisulfideLoader.extract_class-454"><span class="linenos">454</span></a>
</span><span id="DisulfideLoader.extract_class-455"><a href="#DisulfideLoader.extract_class-455"><span class="linenos">455</span></a>        <span class="n">tot_ss</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ss_ids</span><span class="p">)</span>
</span><span id="DisulfideLoader.extract_class-456"><a href="#DisulfideLoader.extract_class-456"><span class="linenos">456</span></a>        <span class="n">class_disulfides</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DisulfideLoader.extract_class-457"><a href="#DisulfideLoader.extract_class-457"><span class="linenos">457</span></a>
</span><span id="DisulfideLoader.extract_class-458"><a href="#DisulfideLoader.extract_class-458"><span class="linenos">458</span></a>        <span class="n">_pbar</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DisulfideLoader.extract_class-459"><a href="#DisulfideLoader.extract_class-459"><span class="linenos">459</span></a>            <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">tot_ss</span><span class="p">),</span> <span class="n">total</span><span class="o">=</span><span class="n">tot_ss</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">verbose</span> <span class="k">else</span> <span class="nb">range</span><span class="p">(</span><span class="n">tot_ss</span><span class="p">)</span>
</span><span id="DisulfideLoader.extract_class-460"><a href="#DisulfideLoader.extract_class-460"><span class="linenos">460</span></a>        <span class="p">)</span>
</span><span id="DisulfideLoader.extract_class-461"><a href="#DisulfideLoader.extract_class-461"><span class="linenos">461</span></a>
</span><span id="DisulfideLoader.extract_class-462"><a href="#DisulfideLoader.extract_class-462"><span class="linenos">462</span></a>        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">_pbar</span><span class="p">:</span>
</span><span id="DisulfideLoader.extract_class-463"><a href="#DisulfideLoader.extract_class-463"><span class="linenos">463</span></a>            <span class="n">ssid</span> <span class="o">=</span> <span class="n">ss_ids</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="DisulfideLoader.extract_class-464"><a href="#DisulfideLoader.extract_class-464"><span class="linenos">464</span></a>            <span class="n">class_disulfides</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ssid</span><span class="p">])</span>
</span><span id="DisulfideLoader.extract_class-465"><a href="#DisulfideLoader.extract_class-465"><span class="linenos">465</span></a>
</span><span id="DisulfideLoader.extract_class-466"><a href="#DisulfideLoader.extract_class-466"><span class="linenos">466</span></a>        <span class="k">return</span> <span class="n">class_disulfides</span>
</span></pre></div>


            <div class="docstring"><p>Return the list of disulfides corresponding to the input <code>clsid</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>clsid</strong>:  The class name to extract.</li>
<li><strong>verbose</strong>:  If True, display progress bars, by default False</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The list of disulfide bonds from the class.</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideLoader.getlist" class="classattr">
                                        <input id="DisulfideLoader.getlist-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">getlist</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n"><a href="DisulfideBase.html#DisulfideList">proteusPy.DisulfideBase.DisulfideList</a></span>:</span></span>

                <label class="view-source-button" for="DisulfideLoader.getlist-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.getlist"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.getlist-468"><a href="#DisulfideLoader.getlist-468"><span class="linenos">468</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">getlist</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="DisulfideLoader.getlist-469"><a href="#DisulfideLoader.getlist-469"><span class="linenos">469</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.getlist-470"><a href="#DisulfideLoader.getlist-470"><span class="linenos">470</span></a><span class="sd">        Return the list of Disulfides contained in the class.</span>
</span><span id="DisulfideLoader.getlist-471"><a href="#DisulfideLoader.getlist-471"><span class="linenos">471</span></a>
</span><span id="DisulfideLoader.getlist-472"><a href="#DisulfideLoader.getlist-472"><span class="linenos">472</span></a><span class="sd">        :return: DisulfideList</span>
</span><span id="DisulfideLoader.getlist-473"><a href="#DisulfideLoader.getlist-473"><span class="linenos">473</span></a><span class="sd">        :rtype: DisulfideList</span>
</span><span id="DisulfideLoader.getlist-474"><a href="#DisulfideLoader.getlist-474"><span class="linenos">474</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.getlist-475"><a href="#DisulfideLoader.getlist-475"><span class="linenos">475</span></a>        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the list of Disulfides contained in the class.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>DisulfideList</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideLoader.get_by_name" class="classattr">
                                        <input id="DisulfideLoader.get_by_name-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_by_name</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">name</span></span><span class="return-annotation">) -> <span class="n"><a href="DisulfideBase.html#Disulfide">proteusPy.DisulfideBase.Disulfide</a></span>:</span></span>

                <label class="view-source-button" for="DisulfideLoader.get_by_name-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.get_by_name"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.get_by_name-477"><a href="#DisulfideLoader.get_by_name-477"><span class="linenos">477</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Disulfide</span><span class="p">:</span>
</span><span id="DisulfideLoader.get_by_name-478"><a href="#DisulfideLoader.get_by_name-478"><span class="linenos">478</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.get_by_name-479"><a href="#DisulfideLoader.get_by_name-479"><span class="linenos">479</span></a><span class="sd">        Return the Disulfide with the given name from the list.</span>
</span><span id="DisulfideLoader.get_by_name-480"><a href="#DisulfideLoader.get_by_name-480"><span class="linenos">480</span></a><span class="sd">        Result is cached since disulfide data doesn&#39;t change after loading.</span>
</span><span id="DisulfideLoader.get_by_name-481"><a href="#DisulfideLoader.get_by_name-481"><span class="linenos">481</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.get_by_name-482"><a href="#DisulfideLoader.get_by_name-482"><span class="linenos">482</span></a>        <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
</span><span id="DisulfideLoader.get_by_name-483"><a href="#DisulfideLoader.get_by_name-483"><span class="linenos">483</span></a>            <span class="k">if</span> <span class="n">ss</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
</span><span id="DisulfideLoader.get_by_name-484"><a href="#DisulfideLoader.get_by_name-484"><span class="linenos">484</span></a>                <span class="k">return</span> <span class="n">ss</span>  <span class="c1"># or ss.copy() !!!</span>
</span><span id="DisulfideLoader.get_by_name-485"><a href="#DisulfideLoader.get_by_name-485"><span class="linenos">485</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Return the Disulfide with the given name from the list.
Result is cached since disulfide data doesn't change after loading.</p>
</div>


                            </div>
                            <div id="DisulfideLoader.describe" class="classattr">
                                        <input id="DisulfideLoader.describe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">describe</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">memusg</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="DisulfideLoader.describe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.describe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.describe-487"><a href="#DisulfideLoader.describe-487"><span class="linenos">487</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memusg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideLoader.describe-488"><a href="#DisulfideLoader.describe-488"><span class="linenos">488</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.describe-489"><a href="#DisulfideLoader.describe-489"><span class="linenos">489</span></a><span class="sd">        Display information about the Disulfide database contained in `self`. if `quick` is False</span>
</span><span id="DisulfideLoader.describe-490"><a href="#DisulfideLoader.describe-490"><span class="linenos">490</span></a><span class="sd">        then display the total RAM used by the object. This takes some time to compute; approximately</span>
</span><span id="DisulfideLoader.describe-491"><a href="#DisulfideLoader.describe-491"><span class="linenos">491</span></a><span class="sd">        30 seconds on a 2024 MacBook Pro. M3 Max.</span>
</span><span id="DisulfideLoader.describe-492"><a href="#DisulfideLoader.describe-492"><span class="linenos">492</span></a>
</span><span id="DisulfideLoader.describe-493"><a href="#DisulfideLoader.describe-493"><span class="linenos">493</span></a><span class="sd">        :param memusg: If True, don&#39;t display the RAM used by the `DisulfideLoader` object.</span>
</span><span id="DisulfideLoader.describe-494"><a href="#DisulfideLoader.describe-494"><span class="linenos">494</span></a><span class="sd">        :return: None</span>
</span><span id="DisulfideLoader.describe-495"><a href="#DisulfideLoader.describe-495"><span class="linenos">495</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.describe-496"><a href="#DisulfideLoader.describe-496"><span class="linenos">496</span></a>        <span class="c1"># pylint: disable=E1101</span>
</span><span id="DisulfideLoader.describe-497"><a href="#DisulfideLoader.describe-497"><span class="linenos">497</span></a>        <span class="n">vers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span>
</span><span id="DisulfideLoader.describe-498"><a href="#DisulfideLoader.describe-498"><span class="linenos">498</span></a>        <span class="n">tot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span>
</span><span id="DisulfideLoader.describe-499"><a href="#DisulfideLoader.describe-499"><span class="linenos">499</span></a>        <span class="n">pdbs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-500"><a href="#DisulfideLoader.describe-500"><span class="linenos">500</span></a>        <span class="n">ram</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DisulfideLoader.describe-501"><a href="#DisulfideLoader.describe-501"><span class="linenos">501</span></a>        <span class="k">if</span> <span class="n">memusg</span><span class="p">:</span>
</span><span id="DisulfideLoader.describe-502"><a href="#DisulfideLoader.describe-502"><span class="linenos">502</span></a>            <span class="n">ram</span> <span class="o">=</span> <span class="n">asizeof</span><span class="o">.</span><span class="n">asizeof</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-503"><a href="#DisulfideLoader.describe-503"><span class="linenos">503</span></a>
</span><span id="DisulfideLoader.describe-504"><a href="#DisulfideLoader.describe-504"><span class="linenos">504</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">average_resolution</span>
</span><span id="DisulfideLoader.describe-505"><a href="#DisulfideLoader.describe-505"><span class="linenos">505</span></a>        <span class="n">cutoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span>
</span><span id="DisulfideLoader.describe-506"><a href="#DisulfideLoader.describe-506"><span class="linenos">506</span></a>        <span class="n">sg_cutoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sg_cutoff</span>
</span><span id="DisulfideLoader.describe-507"><a href="#DisulfideLoader.describe-507"><span class="linenos">507</span></a>        <span class="n">timestr</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">))</span>
</span><span id="DisulfideLoader.describe-508"><a href="#DisulfideLoader.describe-508"><span class="linenos">508</span></a>        <span class="n">ssMinMax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">minmax_energy</span>
</span><span id="DisulfideLoader.describe-509"><a href="#DisulfideLoader.describe-509"><span class="linenos">509</span></a>        <span class="n">ssMin_name</span><span class="p">:</span> <span class="n">Disulfide</span> <span class="o">=</span> <span class="n">ssMinMax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
</span><span id="DisulfideLoader.describe-510"><a href="#DisulfideLoader.describe-510"><span class="linenos">510</span></a>        <span class="n">ssMax_name</span><span class="p">:</span> <span class="n">Disulfide</span> <span class="o">=</span> <span class="n">ssMinMax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
</span><span id="DisulfideLoader.describe-511"><a href="#DisulfideLoader.describe-511"><span class="linenos">511</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    =========== RCSB Disulfide Database Summary ============&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-512"><a href="#DisulfideLoader.describe-512"><span class="linenos">512</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;       =========== Built: </span><span class="si">{</span><span class="n">timestr</span><span class="si">}</span><span class="s2"> ===========&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-513"><a href="#DisulfideLoader.describe-513"><span class="linenos">513</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PDB IDs present:                 </span><span class="si">{</span><span class="n">pdbs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-514"><a href="#DisulfideLoader.describe-514"><span class="linenos">514</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Disulfides loaded:               </span><span class="si">{</span><span class="n">tot</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-515"><a href="#DisulfideLoader.describe-515"><span class="linenos">515</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average structure resolution:    </span><span class="si">{</span><span class="n">res</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-516"><a href="#DisulfideLoader.describe-516"><span class="linenos">516</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lowest Energy Disulfide:         </span><span class="si">{</span><span class="n">ssMin_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-517"><a href="#DisulfideLoader.describe-517"><span class="linenos">517</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Highest Energy Disulfide:        </span><span class="si">{</span><span class="n">ssMax_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-518"><a href="#DisulfideLoader.describe-518"><span class="linenos">518</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cα distance cutoff:              </span><span class="si">{</span><span class="n">cutoff</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-519"><a href="#DisulfideLoader.describe-519"><span class="linenos">519</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sγ distance cutoff:              </span><span class="si">{</span><span class="n">sg_cutoff</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-520"><a href="#DisulfideLoader.describe-520"><span class="linenos">520</span></a>        <span class="k">if</span> <span class="n">memusg</span><span class="p">:</span>
</span><span id="DisulfideLoader.describe-521"><a href="#DisulfideLoader.describe-521"><span class="linenos">521</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total RAM Used:                     </span><span class="si">{</span><span class="n">ram</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> GB.&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-522"><a href="#DisulfideLoader.describe-522"><span class="linenos">522</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;               ===== proteusPy: </span><span class="si">{</span><span class="n">vers</span><span class="si">}</span><span class="s2"> =====&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Display information about the Disulfide database contained in <code>self</code>. if <code>quick</code> is False
then display the total RAM used by the object. This takes some time to compute; approximately
30 seconds on a 2024 MacBook Pro. M3 Max.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>memusg</strong>:  If True, don't display the RAM used by the <code><a href="#DisulfideLoader">DisulfideLoader</a></code> object.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideLoader.display_overlay" class="classattr">
                                        <input id="DisulfideLoader.display_overlay-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">display_overlay</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">pdbid</span>, </span><span class="param"><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="DisulfideLoader.display_overlay-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.display_overlay"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.display_overlay-524"><a href="#DisulfideLoader.display_overlay-524"><span class="linenos">524</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display_overlay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdbid</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideLoader.display_overlay-525"><a href="#DisulfideLoader.display_overlay-525"><span class="linenos">525</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.display_overlay-526"><a href="#DisulfideLoader.display_overlay-526"><span class="linenos">526</span></a><span class="sd">        Display all disulfides for a given PDB ID overlaid in stick mode against</span>
</span><span id="DisulfideLoader.display_overlay-527"><a href="#DisulfideLoader.display_overlay-527"><span class="linenos">527</span></a><span class="sd">        a common coordinate frame. This allows us to see all of the disulfides</span>
</span><span id="DisulfideLoader.display_overlay-528"><a href="#DisulfideLoader.display_overlay-528"><span class="linenos">528</span></a><span class="sd">        at one time in a single view. Colors vary smoothy between bonds.</span>
</span><span id="DisulfideLoader.display_overlay-529"><a href="#DisulfideLoader.display_overlay-529"><span class="linenos">529</span></a>
</span><span id="DisulfideLoader.display_overlay-530"><a href="#DisulfideLoader.display_overlay-530"><span class="linenos">530</span></a><span class="sd">        :param self: DisulfideLoader object initialized with the database.</span>
</span><span id="DisulfideLoader.display_overlay-531"><a href="#DisulfideLoader.display_overlay-531"><span class="linenos">531</span></a><span class="sd">        :param pdbid: the PDB id string, e.g. 4yys</span>
</span><span id="DisulfideLoader.display_overlay-532"><a href="#DisulfideLoader.display_overlay-532"><span class="linenos">532</span></a><span class="sd">        :return: None</span>
</span><span id="DisulfideLoader.display_overlay-533"><a href="#DisulfideLoader.display_overlay-533"><span class="linenos">533</span></a>
</span><span id="DisulfideLoader.display_overlay-534"><a href="#DisulfideLoader.display_overlay-534"><span class="linenos">534</span></a><span class="sd">        Example:</span>
</span><span id="DisulfideLoader.display_overlay-535"><a href="#DisulfideLoader.display_overlay-535"><span class="linenos">535</span></a><span class="sd">        &gt;&gt;&gt; import proteusPy as pp</span>
</span><span id="DisulfideLoader.display_overlay-536"><a href="#DisulfideLoader.display_overlay-536"><span class="linenos">536</span></a>
</span><span id="DisulfideLoader.display_overlay-537"><a href="#DisulfideLoader.display_overlay-537"><span class="linenos">537</span></a><span class="sd">        Instantiate the Loader with the SS database subset.</span>
</span><span id="DisulfideLoader.display_overlay-538"><a href="#DisulfideLoader.display_overlay-538"><span class="linenos">538</span></a>
</span><span id="DisulfideLoader.display_overlay-539"><a href="#DisulfideLoader.display_overlay-539"><span class="linenos">539</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = pp.Load_PDB_SS(verbose=False, subset=True)</span>
</span><span id="DisulfideLoader.display_overlay-540"><a href="#DisulfideLoader.display_overlay-540"><span class="linenos">540</span></a>
</span><span id="DisulfideLoader.display_overlay-541"><a href="#DisulfideLoader.display_overlay-541"><span class="linenos">541</span></a><span class="sd">        Display the Disulfides from the PDB ID ```4yys```, overlaid onto</span>
</span><span id="DisulfideLoader.display_overlay-542"><a href="#DisulfideLoader.display_overlay-542"><span class="linenos">542</span></a><span class="sd">        a common reference (the proximal disulfides).</span>
</span><span id="DisulfideLoader.display_overlay-543"><a href="#DisulfideLoader.display_overlay-543"><span class="linenos">543</span></a>
</span><span id="DisulfideLoader.display_overlay-544"><a href="#DisulfideLoader.display_overlay-544"><span class="linenos">544</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS.display_overlay(&#39;4yys&#39;, verbose=False)</span>
</span><span id="DisulfideLoader.display_overlay-545"><a href="#DisulfideLoader.display_overlay-545"><span class="linenos">545</span></a>
</span><span id="DisulfideLoader.display_overlay-546"><a href="#DisulfideLoader.display_overlay-546"><span class="linenos">546</span></a><span class="sd">        You can also slice the loader and display as an overly.</span>
</span><span id="DisulfideLoader.display_overlay-547"><a href="#DisulfideLoader.display_overlay-547"><span class="linenos">547</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS[:8].display_overlay(verbose=False)</span>
</span><span id="DisulfideLoader.display_overlay-548"><a href="#DisulfideLoader.display_overlay-548"><span class="linenos">548</span></a>
</span><span id="DisulfideLoader.display_overlay-549"><a href="#DisulfideLoader.display_overlay-549"><span class="linenos">549</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.display_overlay-550"><a href="#DisulfideLoader.display_overlay-550"><span class="linenos">550</span></a>
</span><span id="DisulfideLoader.display_overlay-551"><a href="#DisulfideLoader.display_overlay-551"><span class="linenos">551</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DisulfideLoader.display_overlay-552"><a href="#DisulfideLoader.display_overlay-552"><span class="linenos">552</span></a>            <span class="n">ssbonds</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">pdbid</span><span class="p">]</span>
</span><span id="DisulfideLoader.display_overlay-553"><a href="#DisulfideLoader.display_overlay-553"><span class="linenos">553</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="DisulfideLoader.display_overlay-554"><a href="#DisulfideLoader.display_overlay-554"><span class="linenos">554</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Cannot find key </span><span class="si">%s</span><span class="s2"> in SSBond DB&quot;</span><span class="p">,</span> <span class="n">pdbid</span><span class="p">)</span>
</span><span id="DisulfideLoader.display_overlay-555"><a href="#DisulfideLoader.display_overlay-555"><span class="linenos">555</span></a>            <span class="k">return</span>
</span><span id="DisulfideLoader.display_overlay-556"><a href="#DisulfideLoader.display_overlay-556"><span class="linenos">556</span></a>
</span><span id="DisulfideLoader.display_overlay-557"><a href="#DisulfideLoader.display_overlay-557"><span class="linenos">557</span></a>        <span class="n">ssbonds</span><span class="o">.</span><span class="n">display_overlay</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="DisulfideLoader.display_overlay-558"><a href="#DisulfideLoader.display_overlay-558"><span class="linenos">558</span></a>        <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>Display all disulfides for a given PDB ID overlaid in stick mode against
a common coordinate frame. This allows us to see all of the disulfides
at one time in a single view. Colors vary smoothy between bonds.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>self</strong>:  DisulfideLoader object initialized with the database.</li>
<li><strong>pdbid</strong>:  the PDB id string, e.g. 4yys</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>

<p>Example:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">proteusPy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pp</span>
</code></pre>
</div>

<p>Instantiate the Loader with the SS database subset.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">PDB_SS</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">Load_PDB_SS</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre>
</div>

<p>Display the Disulfides from the PDB ID <code>4yys</code>, overlaid onto
a common reference (the proximal disulfides).</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">PDB_SS</span><span class="o">.</span><span class="n">display_overlay</span><span class="p">(</span><span class="s1">&#39;4yys&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre>
</div>

<p>You can also slice the loader and display as an overly.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">PDB_SS</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">display_overlay</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="DisulfideLoader.getTorsions" class="classattr">
                                        <input id="DisulfideLoader.getTorsions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">getTorsions</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">pdbID</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>:</span></span>

                <label class="view-source-button" for="DisulfideLoader.getTorsions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.getTorsions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.getTorsions-560"><a href="#DisulfideLoader.getTorsions-560"><span class="linenos">560</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">getTorsions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdbID</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="DisulfideLoader.getTorsions-561"><a href="#DisulfideLoader.getTorsions-561"><span class="linenos">561</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.getTorsions-562"><a href="#DisulfideLoader.getTorsions-562"><span class="linenos">562</span></a><span class="sd">        Return the torsions, distances and energies defined by Torsion_DF_cols</span>
</span><span id="DisulfideLoader.getTorsions-563"><a href="#DisulfideLoader.getTorsions-563"><span class="linenos">563</span></a>
</span><span id="DisulfideLoader.getTorsions-564"><a href="#DisulfideLoader.getTorsions-564"><span class="linenos">564</span></a><span class="sd">        :param pdbID: pdbID, defaults to None, meaning return entire dataset.</span>
</span><span id="DisulfideLoader.getTorsions-565"><a href="#DisulfideLoader.getTorsions-565"><span class="linenos">565</span></a><span class="sd">        :type pdbID: str, optional used to extract for a specific PDB structure. If not specified</span>
</span><span id="DisulfideLoader.getTorsions-566"><a href="#DisulfideLoader.getTorsions-566"><span class="linenos">566</span></a><span class="sd">            then return the entire dataset.</span>
</span><span id="DisulfideLoader.getTorsions-567"><a href="#DisulfideLoader.getTorsions-567"><span class="linenos">567</span></a><span class="sd">        :raises DisulfideParseWarning: Raised if not found</span>
</span><span id="DisulfideLoader.getTorsions-568"><a href="#DisulfideLoader.getTorsions-568"><span class="linenos">568</span></a><span class="sd">        :return: Torsions Dataframe</span>
</span><span id="DisulfideLoader.getTorsions-569"><a href="#DisulfideLoader.getTorsions-569"><span class="linenos">569</span></a><span class="sd">        :rtype: pd.DataFrame</span>
</span><span id="DisulfideLoader.getTorsions-570"><a href="#DisulfideLoader.getTorsions-570"><span class="linenos">570</span></a>
</span><span id="DisulfideLoader.getTorsions-571"><a href="#DisulfideLoader.getTorsions-571"><span class="linenos">571</span></a><span class="sd">        Example:</span>
</span><span id="DisulfideLoader.getTorsions-572"><a href="#DisulfideLoader.getTorsions-572"><span class="linenos">572</span></a><span class="sd">        &gt;&gt;&gt; import proteusPy as pp</span>
</span><span id="DisulfideLoader.getTorsions-573"><a href="#DisulfideLoader.getTorsions-573"><span class="linenos">573</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = pp.Load_PDB_SS(verbose=False, subset=True)</span>
</span><span id="DisulfideLoader.getTorsions-574"><a href="#DisulfideLoader.getTorsions-574"><span class="linenos">574</span></a><span class="sd">        &gt;&gt;&gt; Tor_DF = PDB_SS.getTorsions()</span>
</span><span id="DisulfideLoader.getTorsions-575"><a href="#DisulfideLoader.getTorsions-575"><span class="linenos">575</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.getTorsions-576"><a href="#DisulfideLoader.getTorsions-576"><span class="linenos">576</span></a>        <span class="n">res_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="DisulfideLoader.getTorsions-577"><a href="#DisulfideLoader.getTorsions-577"><span class="linenos">577</span></a>
</span><span id="DisulfideLoader.getTorsions-578"><a href="#DisulfideLoader.getTorsions-578"><span class="linenos">578</span></a>        <span class="k">if</span> <span class="n">pdbID</span><span class="p">:</span>
</span><span id="DisulfideLoader.getTorsions-579"><a href="#DisulfideLoader.getTorsions-579"><span class="linenos">579</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="DisulfideLoader.getTorsions-580"><a href="#DisulfideLoader.getTorsions-580"><span class="linenos">580</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">[</span><span class="n">pdbID</span><span class="p">]</span>
</span><span id="DisulfideLoader.getTorsions-581"><a href="#DisulfideLoader.getTorsions-581"><span class="linenos">581</span></a>                <span class="n">sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">pdbID</span>
</span><span id="DisulfideLoader.getTorsions-582"><a href="#DisulfideLoader.getTorsions-582"><span class="linenos">582</span></a>                <span class="n">res_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">[</span><span class="n">sel</span><span class="p">]</span>
</span><span id="DisulfideLoader.getTorsions-583"><a href="#DisulfideLoader.getTorsions-583"><span class="linenos">583</span></a>                <span class="k">return</span> <span class="n">res_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DisulfideLoader.getTorsions-584"><a href="#DisulfideLoader.getTorsions-584"><span class="linenos">584</span></a>            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DisulfideLoader.getTorsions-585"><a href="#DisulfideLoader.getTorsions-585"><span class="linenos">585</span></a>                <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Cannot find key </span><span class="si">{</span><span class="n">pdbID</span><span class="si">}</span><span class="s2"> in SSBond DB&quot;</span>
</span><span id="DisulfideLoader.getTorsions-586"><a href="#DisulfideLoader.getTorsions-586"><span class="linenos">586</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
</span><span id="DisulfideLoader.getTorsions-587"><a href="#DisulfideLoader.getTorsions-587"><span class="linenos">587</span></a>                <span class="k">raise</span> <span class="n">DisulfideParseWarning</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</span><span id="DisulfideLoader.getTorsions-588"><a href="#DisulfideLoader.getTorsions-588"><span class="linenos">588</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideLoader.getTorsions-589"><a href="#DisulfideLoader.getTorsions-589"><span class="linenos">589</span></a>            <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the torsions, distances and energies defined by Torsion_DF_cols</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>pdbID</strong>:  pdbID, defaults to None, meaning return entire dataset.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>DisulfideParseWarning</strong>:  Raised if not found</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Torsions Dataframe</p>
</blockquote>

<p>Example:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">proteusPy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PDB_SS</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">Load_PDB_SS</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tor_DF</span> <span class="o">=</span> <span class="n">PDB_SS</span><span class="o">.</span><span class="n">getTorsions</span><span class="p">()</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="DisulfideLoader.list_binary_classes" class="classattr">
                                        <input id="DisulfideLoader.list_binary_classes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">list_binary_classes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.list_binary_classes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.list_binary_classes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.list_binary_classes-591"><a href="#DisulfideLoader.list_binary_classes-591"><span class="linenos">591</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_binary_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideLoader.list_binary_classes-592"><a href="#DisulfideLoader.list_binary_classes-592"><span class="linenos">592</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Enumerate the binary classes&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.list_binary_classes-593"><a href="#DisulfideLoader.list_binary_classes-593"><span class="linenos">593</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="o">.</span><span class="n">binaryclass_dict</span><span class="p">):</span>
</span><span id="DisulfideLoader.list_binary_classes-594"><a href="#DisulfideLoader.list_binary_classes-594"><span class="linenos">594</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class: |</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">|, |</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">|&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Enumerate the binary classes</p>
</div>


                            </div>
                            <div id="DisulfideLoader.plot_Classes" class="classattr">
                                        <input id="DisulfideLoader.plot_Classes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_Classes</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span>,</span><span class="param">	<span class="n">class_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">theme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>,</span><span class="param">	<span class="n">log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">paginated</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">page_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">200</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.plot_Classes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.plot_Classes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.plot_Classes-596"><a href="#DisulfideLoader.plot_Classes-596"><span class="linenos">596</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_Classes</span><span class="p">(</span>
</span><span id="DisulfideLoader.plot_Classes-597"><a href="#DisulfideLoader.plot_Classes-597"><span class="linenos">597</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_Classes-598"><a href="#DisulfideLoader.plot_Classes-598"><span class="linenos">598</span></a>        <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_Classes-599"><a href="#DisulfideLoader.plot_Classes-599"><span class="linenos">599</span></a>        <span class="n">class_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_Classes-600"><a href="#DisulfideLoader.plot_Classes-600"><span class="linenos">600</span></a>        <span class="n">theme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_Classes-601"><a href="#DisulfideLoader.plot_Classes-601"><span class="linenos">601</span></a>        <span class="n">log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_Classes-602"><a href="#DisulfideLoader.plot_Classes-602"><span class="linenos">602</span></a>        <span class="n">paginated</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_Classes-603"><a href="#DisulfideLoader.plot_Classes-603"><span class="linenos">603</span></a>        <span class="n">page_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_Classes-604"><a href="#DisulfideLoader.plot_Classes-604"><span class="linenos">604</span></a>    <span class="p">):</span>
</span><span id="DisulfideLoader.plot_Classes-605"><a href="#DisulfideLoader.plot_Classes-605"><span class="linenos">605</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.plot_Classes-606"><a href="#DisulfideLoader.plot_Classes-606"><span class="linenos">606</span></a><span class="sd">        Plot the classes for the given base.</span>
</span><span id="DisulfideLoader.plot_Classes-607"><a href="#DisulfideLoader.plot_Classes-607"><span class="linenos">607</span></a>
</span><span id="DisulfideLoader.plot_Classes-608"><a href="#DisulfideLoader.plot_Classes-608"><span class="linenos">608</span></a><span class="sd">        :param base: The base class to use, 2 or 8.</span>
</span><span id="DisulfideLoader.plot_Classes-609"><a href="#DisulfideLoader.plot_Classes-609"><span class="linenos">609</span></a><span class="sd">        :param class_string: The class string to plot.</span>
</span><span id="DisulfideLoader.plot_Classes-610"><a href="#DisulfideLoader.plot_Classes-610"><span class="linenos">610</span></a><span class="sd">        :param theme: The theme to use for the plot (&#39;auto&#39;, &#39;light&#39;, or &#39;dark&#39;).</span>
</span><span id="DisulfideLoader.plot_Classes-611"><a href="#DisulfideLoader.plot_Classes-611"><span class="linenos">611</span></a><span class="sd">        :param log: Whether to use a log scale for the y-axis.</span>
</span><span id="DisulfideLoader.plot_Classes-612"><a href="#DisulfideLoader.plot_Classes-612"><span class="linenos">612</span></a><span class="sd">        :param paginated: Whether to paginate the plot.</span>
</span><span id="DisulfideLoader.plot_Classes-613"><a href="#DisulfideLoader.plot_Classes-613"><span class="linenos">613</span></a><span class="sd">        :param page_size: Number of items per page.</span>
</span><span id="DisulfideLoader.plot_Classes-614"><a href="#DisulfideLoader.plot_Classes-614"><span class="linenos">614</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.plot_Classes-615"><a href="#DisulfideLoader.plot_Classes-615"><span class="linenos">615</span></a>        <span class="c1"># from proteusPy.DisulfideVisualization import DisulfideVisualization</span>
</span><span id="DisulfideLoader.plot_Classes-616"><a href="#DisulfideLoader.plot_Classes-616"><span class="linenos">616</span></a>
</span><span id="DisulfideLoader.plot_Classes-617"><a href="#DisulfideLoader.plot_Classes-617"><span class="linenos">617</span></a>        <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_classes</span><span class="p">(</span>
</span><span id="DisulfideLoader.plot_Classes-618"><a href="#DisulfideLoader.plot_Classes-618"><span class="linenos">618</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_Classes-619"><a href="#DisulfideLoader.plot_Classes-619"><span class="linenos">619</span></a>            <span class="n">class_string</span><span class="o">=</span><span class="n">class_string</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_Classes-620"><a href="#DisulfideLoader.plot_Classes-620"><span class="linenos">620</span></a>            <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_Classes-621"><a href="#DisulfideLoader.plot_Classes-621"><span class="linenos">621</span></a>            <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_Classes-622"><a href="#DisulfideLoader.plot_Classes-622"><span class="linenos">622</span></a>            <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_Classes-623"><a href="#DisulfideLoader.plot_Classes-623"><span class="linenos">623</span></a>            <span class="n">page_size</span><span class="o">=</span><span class="n">page_size</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_Classes-624"><a href="#DisulfideLoader.plot_Classes-624"><span class="linenos">624</span></a>            <span class="n">paginated</span><span class="o">=</span><span class="n">paginated</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_Classes-625"><a href="#DisulfideLoader.plot_Classes-625"><span class="linenos">625</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plot the classes for the given base.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base</strong>:  The base class to use, 2 or 8.</li>
<li><strong>class_string</strong>:  The class string to plot.</li>
<li><strong>theme</strong>:  The theme to use for the plot ('auto', 'light', or 'dark').</li>
<li><strong>log</strong>:  Whether to use a log scale for the y-axis.</li>
<li><strong>paginated</strong>:  Whether to paginate the plot.</li>
<li><strong>page_size</strong>:  Number of items per page.</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideLoader.plot_classes_vs_cutoff" class="classattr">
                                        <input id="DisulfideLoader.plot_classes_vs_cutoff-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_classes_vs_cutoff</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span>,</span><span class="param">	<span class="n">base</span><span class="o">=</span><span class="mi">8</span>,</span><span class="param">	<span class="n">theme</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="DisulfideLoader.plot_classes_vs_cutoff-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.plot_classes_vs_cutoff"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.plot_classes_vs_cutoff-627"><a href="#DisulfideLoader.plot_classes_vs_cutoff-627"><span class="linenos">627</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_classes_vs_cutoff</span><span class="p">(</span>
</span><span id="DisulfideLoader.plot_classes_vs_cutoff-628"><a href="#DisulfideLoader.plot_classes_vs_cutoff-628"><span class="linenos">628</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
</span><span id="DisulfideLoader.plot_classes_vs_cutoff-629"><a href="#DisulfideLoader.plot_classes_vs_cutoff-629"><span class="linenos">629</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideLoader.plot_classes_vs_cutoff-630"><a href="#DisulfideLoader.plot_classes_vs_cutoff-630"><span class="linenos">630</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.plot_classes_vs_cutoff-631"><a href="#DisulfideLoader.plot_classes_vs_cutoff-631"><span class="linenos">631</span></a><span class="sd">        Plot the total percentage and number of members for each octant class against the cutoff value.</span>
</span><span id="DisulfideLoader.plot_classes_vs_cutoff-632"><a href="#DisulfideLoader.plot_classes_vs_cutoff-632"><span class="linenos">632</span></a>
</span><span id="DisulfideLoader.plot_classes_vs_cutoff-633"><a href="#DisulfideLoader.plot_classes_vs_cutoff-633"><span class="linenos">633</span></a><span class="sd">        :param cutoff: Percent cutoff value for filtering the classes.</span>
</span><span id="DisulfideLoader.plot_classes_vs_cutoff-634"><a href="#DisulfideLoader.plot_classes_vs_cutoff-634"><span class="linenos">634</span></a><span class="sd">        :param steps: Number of steps to take in the cutoff.</span>
</span><span id="DisulfideLoader.plot_classes_vs_cutoff-635"><a href="#DisulfideLoader.plot_classes_vs_cutoff-635"><span class="linenos">635</span></a><span class="sd">        :param base: The base class to use, 6 or 8.</span>
</span><span id="DisulfideLoader.plot_classes_vs_cutoff-636"><a href="#DisulfideLoader.plot_classes_vs_cutoff-636"><span class="linenos">636</span></a><span class="sd">        :param theme: The theme to use for the plot (&#39;auto&#39;, &#39;light&#39;, or &#39;dark&#39;), defaults to &#39;auto&#39;.</span>
</span><span id="DisulfideLoader.plot_classes_vs_cutoff-637"><a href="#DisulfideLoader.plot_classes_vs_cutoff-637"><span class="linenos">637</span></a><span class="sd">        :return: None</span>
</span><span id="DisulfideLoader.plot_classes_vs_cutoff-638"><a href="#DisulfideLoader.plot_classes_vs_cutoff-638"><span class="linenos">638</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.plot_classes_vs_cutoff-639"><a href="#DisulfideLoader.plot_classes_vs_cutoff-639"><span class="linenos">639</span></a>        <span class="c1"># from proteusPy.DisulfideVisualization import DisulfideVisualization</span>
</span><span id="DisulfideLoader.plot_classes_vs_cutoff-640"><a href="#DisulfideLoader.plot_classes_vs_cutoff-640"><span class="linenos">640</span></a>
</span><span id="DisulfideLoader.plot_classes_vs_cutoff-641"><a href="#DisulfideLoader.plot_classes_vs_cutoff-641"><span class="linenos">641</span></a>        <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_classes_vs_cutoff</span><span class="p">(</span>
</span><span id="DisulfideLoader.plot_classes_vs_cutoff-642"><a href="#DisulfideLoader.plot_classes_vs_cutoff-642"><span class="linenos">642</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">theme</span><span class="p">,</span> <span class="n">verbose</span>
</span><span id="DisulfideLoader.plot_classes_vs_cutoff-643"><a href="#DisulfideLoader.plot_classes_vs_cutoff-643"><span class="linenos">643</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plot the total percentage and number of members for each octant class against the cutoff value.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>cutoff</strong>:  Percent cutoff value for filtering the classes.</li>
<li><strong>steps</strong>:  Number of steps to take in the cutoff.</li>
<li><strong>base</strong>:  The base class to use, 6 or 8.</li>
<li><strong>theme</strong>:  The theme to use for the plot ('auto', 'light', or 'dark'), defaults to 'auto'.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideLoader.plot_binary_to_eightclass_incidence" class="classattr">
                                        <input id="DisulfideLoader.plot_binary_to_eightclass_incidence-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_binary_to_eightclass_incidence</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">theme</span><span class="o">=</span><span class="s1">&#39;light&#39;</span>,</span><span class="param">	<span class="n">save</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">savedir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">log</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.plot_binary_to_eightclass_incidence-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.plot_binary_to_eightclass_incidence"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-645"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-645"><span class="linenos">645</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_binary_to_eightclass_incidence</span><span class="p">(</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-646"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-646"><span class="linenos">646</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-647"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-647"><span class="linenos">647</span></a>        <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;light&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-648"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-648"><span class="linenos">648</span></a>        <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-649"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-649"><span class="linenos">649</span></a>        <span class="n">savedir</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-650"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-650"><span class="linenos">650</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-651"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-651"><span class="linenos">651</span></a>        <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-652"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-652"><span class="linenos">652</span></a>    <span class="p">):</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-653"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-653"><span class="linenos">653</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the incidence of all octant Disulfide classes for a given binary class.</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-654"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-654"><span class="linenos">654</span></a>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-655"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-655"><span class="linenos">655</span></a><span class="sd">        :param theme: The theme to use for the plot</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-656"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-656"><span class="linenos">656</span></a><span class="sd">        :param save: Whether to save the plots</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-657"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-657"><span class="linenos">657</span></a><span class="sd">        :param savedir: Directory to save plots to</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-658"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-658"><span class="linenos">658</span></a><span class="sd">        :param verbose: Whether to display verbose output</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-659"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-659"><span class="linenos">659</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-660"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-660"><span class="linenos">660</span></a>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-661"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-661"><span class="linenos">661</span></a>        <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_binary_to_eightclass_incidence</span><span class="p">(</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-662"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-662"><span class="linenos">662</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-663"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-663"><span class="linenos">663</span></a>            <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-664"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-664"><span class="linenos">664</span></a>            <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-665"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-665"><span class="linenos">665</span></a>            <span class="n">savedir</span><span class="o">=</span><span class="n">savedir</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-666"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-666"><span class="linenos">666</span></a>            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-667"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-667"><span class="linenos">667</span></a>            <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_binary_to_eightclass_incidence-668"><a href="#DisulfideLoader.plot_binary_to_eightclass_incidence-668"><span class="linenos">668</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plot the incidence of all octant Disulfide classes for a given binary class.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>theme</strong>:  The theme to use for the plot</li>
<li><strong>save</strong>:  Whether to save the plots</li>
<li><strong>savedir</strong>:  Directory to save plots to</li>
<li><strong>verbose</strong>:  Whether to display verbose output</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideLoader.plot_count_vs_class_df" class="classattr">
                                        <input id="DisulfideLoader.plot_count_vs_class_df-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_count_vs_class_df</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">class_string</span>,</span><span class="param">	<span class="n">title</span><span class="o">=</span><span class="s1">&#39;title&#39;</span>,</span><span class="param">	<span class="n">theme</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span>,</span><span class="param">	<span class="n">save</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">savedir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span>,</span><span class="param">	<span class="n">base</span><span class="o">=</span><span class="mi">8</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">log</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">sample_size</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">page_size</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.plot_count_vs_class_df-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.plot_count_vs_class_df"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.plot_count_vs_class_df-670"><a href="#DisulfideLoader.plot_count_vs_class_df-670"><span class="linenos">670</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_count_vs_class_df</span><span class="p">(</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-671"><a href="#DisulfideLoader.plot_count_vs_class_df-671"><span class="linenos">671</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-672"><a href="#DisulfideLoader.plot_count_vs_class_df-672"><span class="linenos">672</span></a>        <span class="n">class_string</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-673"><a href="#DisulfideLoader.plot_count_vs_class_df-673"><span class="linenos">673</span></a>        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;title&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-674"><a href="#DisulfideLoader.plot_count_vs_class_df-674"><span class="linenos">674</span></a>        <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-675"><a href="#DisulfideLoader.plot_count_vs_class_df-675"><span class="linenos">675</span></a>        <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-676"><a href="#DisulfideLoader.plot_count_vs_class_df-676"><span class="linenos">676</span></a>        <span class="n">savedir</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-677"><a href="#DisulfideLoader.plot_count_vs_class_df-677"><span class="linenos">677</span></a>        <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-678"><a href="#DisulfideLoader.plot_count_vs_class_df-678"><span class="linenos">678</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-679"><a href="#DisulfideLoader.plot_count_vs_class_df-679"><span class="linenos">679</span></a>        <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-680"><a href="#DisulfideLoader.plot_count_vs_class_df-680"><span class="linenos">680</span></a>        <span class="n">sample_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-681"><a href="#DisulfideLoader.plot_count_vs_class_df-681"><span class="linenos">681</span></a>        <span class="n">page_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-682"><a href="#DisulfideLoader.plot_count_vs_class_df-682"><span class="linenos">682</span></a>    <span class="p">):</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-683"><a href="#DisulfideLoader.plot_count_vs_class_df-683"><span class="linenos">683</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-684"><a href="#DisulfideLoader.plot_count_vs_class_df-684"><span class="linenos">684</span></a><span class="sd">        Plot a line graph of count vs class ID using Plotly for the given disulfide class. The</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-685"><a href="#DisulfideLoader.plot_count_vs_class_df-685"><span class="linenos">685</span></a><span class="sd">        base selects the class type to plot: 2, 6, or 8, for binary, sextant, or octant classes.</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-686"><a href="#DisulfideLoader.plot_count_vs_class_df-686"><span class="linenos">686</span></a>
</span><span id="DisulfideLoader.plot_count_vs_class_df-687"><a href="#DisulfideLoader.plot_count_vs_class_df-687"><span class="linenos">687</span></a><span class="sd">        :param class_string: The binary class string to be plotted.</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-688"><a href="#DisulfideLoader.plot_count_vs_class_df-688"><span class="linenos">688</span></a><span class="sd">        :param title: A string representing the title of the plot (default is &#39;title&#39;).</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-689"><a href="#DisulfideLoader.plot_count_vs_class_df-689"><span class="linenos">689</span></a><span class="sd">        :param theme: Theme to use for the plot</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-690"><a href="#DisulfideLoader.plot_count_vs_class_df-690"><span class="linenos">690</span></a><span class="sd">        :param save: Whether to save the plot</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-691"><a href="#DisulfideLoader.plot_count_vs_class_df-691"><span class="linenos">691</span></a><span class="sd">        :param savedir: Directory to save the plot to</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-692"><a href="#DisulfideLoader.plot_count_vs_class_df-692"><span class="linenos">692</span></a><span class="sd">        :param base: Base for class IDs (2 or 8)</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-693"><a href="#DisulfideLoader.plot_count_vs_class_df-693"><span class="linenos">693</span></a><span class="sd">        :param verbose: Whether to display verbose output</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-694"><a href="#DisulfideLoader.plot_count_vs_class_df-694"><span class="linenos">694</span></a><span class="sd">        :param log: Whether to use log scale for y-axis</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-695"><a href="#DisulfideLoader.plot_count_vs_class_df-695"><span class="linenos">695</span></a><span class="sd">        :param sample_size: Number of items to sample</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-696"><a href="#DisulfideLoader.plot_count_vs_class_df-696"><span class="linenos">696</span></a><span class="sd">        :param page_size: Number of items per page</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-697"><a href="#DisulfideLoader.plot_count_vs_class_df-697"><span class="linenos">697</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-698"><a href="#DisulfideLoader.plot_count_vs_class_df-698"><span class="linenos">698</span></a>        <span class="c1"># from proteusPy.DisulfideVisualization import DisulfideVisualization</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-699"><a href="#DisulfideLoader.plot_count_vs_class_df-699"><span class="linenos">699</span></a>        <span class="n">class_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="o">.</span><span class="n">binary_to_class</span><span class="p">(</span><span class="n">class_string</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-700"><a href="#DisulfideLoader.plot_count_vs_class_df-700"><span class="linenos">700</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_enumerate_class_fromlist</span><span class="p">(</span><span class="n">class_list</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-701"><a href="#DisulfideLoader.plot_count_vs_class_df-701"><span class="linenos">701</span></a>
</span><span id="DisulfideLoader.plot_count_vs_class_df-702"><a href="#DisulfideLoader.plot_count_vs_class_df-702"><span class="linenos">702</span></a>        <span class="k">if</span> <span class="n">sample_size</span><span class="p">:</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-703"><a href="#DisulfideLoader.plot_count_vs_class_df-703"><span class="linenos">703</span></a>            <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_count_vs_class_df_sampled</span><span class="p">(</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-704"><a href="#DisulfideLoader.plot_count_vs_class_df-704"><span class="linenos">704</span></a>                <span class="n">df</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-705"><a href="#DisulfideLoader.plot_count_vs_class_df-705"><span class="linenos">705</span></a>                <span class="n">title</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-706"><a href="#DisulfideLoader.plot_count_vs_class_df-706"><span class="linenos">706</span></a>                <span class="n">theme</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-707"><a href="#DisulfideLoader.plot_count_vs_class_df-707"><span class="linenos">707</span></a>                <span class="n">save</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-708"><a href="#DisulfideLoader.plot_count_vs_class_df-708"><span class="linenos">708</span></a>                <span class="n">savedir</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-709"><a href="#DisulfideLoader.plot_count_vs_class_df-709"><span class="linenos">709</span></a>                <span class="n">base</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-710"><a href="#DisulfideLoader.plot_count_vs_class_df-710"><span class="linenos">710</span></a>                <span class="n">verbose</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-711"><a href="#DisulfideLoader.plot_count_vs_class_df-711"><span class="linenos">711</span></a>                <span class="n">log</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-712"><a href="#DisulfideLoader.plot_count_vs_class_df-712"><span class="linenos">712</span></a>                <span class="n">sample_size</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-713"><a href="#DisulfideLoader.plot_count_vs_class_df-713"><span class="linenos">713</span></a>            <span class="p">)</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-714"><a href="#DisulfideLoader.plot_count_vs_class_df-714"><span class="linenos">714</span></a>        <span class="k">elif</span> <span class="n">page_size</span><span class="p">:</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-715"><a href="#DisulfideLoader.plot_count_vs_class_df-715"><span class="linenos">715</span></a>            <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_count_vs_class_df_paginated</span><span class="p">(</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-716"><a href="#DisulfideLoader.plot_count_vs_class_df-716"><span class="linenos">716</span></a>                <span class="n">df</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">theme</span><span class="p">,</span> <span class="n">save</span><span class="p">,</span> <span class="n">savedir</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">page_size</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-717"><a href="#DisulfideLoader.plot_count_vs_class_df-717"><span class="linenos">717</span></a>            <span class="p">)</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-718"><a href="#DisulfideLoader.plot_count_vs_class_df-718"><span class="linenos">718</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-719"><a href="#DisulfideLoader.plot_count_vs_class_df-719"><span class="linenos">719</span></a>            <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_count_vs_class_df</span><span class="p">(</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-720"><a href="#DisulfideLoader.plot_count_vs_class_df-720"><span class="linenos">720</span></a>                <span class="n">df</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">theme</span><span class="p">,</span> <span class="n">save</span><span class="p">,</span> <span class="n">savedir</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">log</span>
</span><span id="DisulfideLoader.plot_count_vs_class_df-721"><a href="#DisulfideLoader.plot_count_vs_class_df-721"><span class="linenos">721</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plot a line graph of count vs class ID using Plotly for the given disulfide class. The
base selects the class type to plot: 2, 6, or 8, for binary, sextant, or octant classes.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>class_string</strong>:  The binary class string to be plotted.</li>
<li><strong>title</strong>:  A string representing the title of the plot (default is 'title').</li>
<li><strong>theme</strong>:  Theme to use for the plot</li>
<li><strong>save</strong>:  Whether to save the plot</li>
<li><strong>savedir</strong>:  Directory to save the plot to</li>
<li><strong>base</strong>:  Base for class IDs (2 or 8)</li>
<li><strong>verbose</strong>:  Whether to display verbose output</li>
<li><strong>log</strong>:  Whether to use log scale for y-axis</li>
<li><strong>sample_size</strong>:  Number of items to sample</li>
<li><strong>page_size</strong>:  Number of items per page</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideLoader.plot_count_vs_classid" class="classattr">
                                        <input id="DisulfideLoader.plot_count_vs_classid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_count_vs_classid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="bp">cls</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">theme</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span>, </span><span class="param"><span class="n">base</span><span class="o">=</span><span class="mi">8</span>, </span><span class="param"><span class="n">log</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.plot_count_vs_classid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.plot_count_vs_classid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.plot_count_vs_classid-723"><a href="#DisulfideLoader.plot_count_vs_classid-723"><span class="linenos">723</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_count_vs_classid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="DisulfideLoader.plot_count_vs_classid-724"><a href="#DisulfideLoader.plot_count_vs_classid-724"><span class="linenos">724</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.plot_count_vs_classid-725"><a href="#DisulfideLoader.plot_count_vs_classid-725"><span class="linenos">725</span></a><span class="sd">        Plot a line graph of count vs class ID using Plotly.</span>
</span><span id="DisulfideLoader.plot_count_vs_classid-726"><a href="#DisulfideLoader.plot_count_vs_classid-726"><span class="linenos">726</span></a>
</span><span id="DisulfideLoader.plot_count_vs_classid-727"><a href="#DisulfideLoader.plot_count_vs_classid-727"><span class="linenos">727</span></a><span class="sd">        :param cls: Specific class to plot (optional)</span>
</span><span id="DisulfideLoader.plot_count_vs_classid-728"><a href="#DisulfideLoader.plot_count_vs_classid-728"><span class="linenos">728</span></a><span class="sd">        :param theme: Theme to use for the plot</span>
</span><span id="DisulfideLoader.plot_count_vs_classid-729"><a href="#DisulfideLoader.plot_count_vs_classid-729"><span class="linenos">729</span></a><span class="sd">        :param base: Base for class IDs (2 or 8)</span>
</span><span id="DisulfideLoader.plot_count_vs_classid-730"><a href="#DisulfideLoader.plot_count_vs_classid-730"><span class="linenos">730</span></a><span class="sd">        :param log: Whether to use log scale for y-axis</span>
</span><span id="DisulfideLoader.plot_count_vs_classid-731"><a href="#DisulfideLoader.plot_count_vs_classid-731"><span class="linenos">731</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.plot_count_vs_classid-732"><a href="#DisulfideLoader.plot_count_vs_classid-732"><span class="linenos">732</span></a>        <span class="c1"># from proteusPy.DisulfideVisualization import DisulfideVisualization</span>
</span><span id="DisulfideLoader.plot_count_vs_classid-733"><a href="#DisulfideLoader.plot_count_vs_classid-733"><span class="linenos">733</span></a>
</span><span id="DisulfideLoader.plot_count_vs_classid-734"><a href="#DisulfideLoader.plot_count_vs_classid-734"><span class="linenos">734</span></a>        <span class="n">DisulfideVisualization</span><span class="o">.</span><span class="n">plot_count_vs_classid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">theme</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">log</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plot a line graph of count vs class ID using Plotly.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>cls</strong>:  Specific class to plot (optional)</li>
<li><strong>theme</strong>:  Theme to use for the plot</li>
<li><strong>base</strong>:  Base for class IDs (2 or 8)</li>
<li><strong>log</strong>:  Whether to use log scale for y-axis</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideLoader.save" class="classattr">
                                        <input id="DisulfideLoader.save-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">savepath</span><span class="o">=</span><span class="s1">&#39;/Users/egs/repos/proteusPy/proteusPy/data&#39;</span>,</span><span class="param">	<span class="n">subset</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">cutoff</span><span class="o">=-</span><span class="mf">1.0</span>,</span><span class="param">	<span class="n">sg_cutoff</span><span class="o">=-</span><span class="mf">1.0</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.save-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.save"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.save-762"><a href="#DisulfideLoader.save-762"><span class="linenos">762</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span>
</span><span id="DisulfideLoader.save-763"><a href="#DisulfideLoader.save-763"><span class="linenos">763</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DisulfideLoader.save-764"><a href="#DisulfideLoader.save-764"><span class="linenos">764</span></a>        <span class="n">savepath</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span>
</span><span id="DisulfideLoader.save-765"><a href="#DisulfideLoader.save-765"><span class="linenos">765</span></a>        <span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader.save-766"><a href="#DisulfideLoader.save-766"><span class="linenos">766</span></a>        <span class="n">cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="DisulfideLoader.save-767"><a href="#DisulfideLoader.save-767"><span class="linenos">767</span></a>        <span class="n">sg_cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="DisulfideLoader.save-768"><a href="#DisulfideLoader.save-768"><span class="linenos">768</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader.save-769"><a href="#DisulfideLoader.save-769"><span class="linenos">769</span></a>    <span class="p">):</span>
</span><span id="DisulfideLoader.save-770"><a href="#DisulfideLoader.save-770"><span class="linenos">770</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.save-771"><a href="#DisulfideLoader.save-771"><span class="linenos">771</span></a><span class="sd">        Save a copy of the fully instantiated Loader to the specified file.</span>
</span><span id="DisulfideLoader.save-772"><a href="#DisulfideLoader.save-772"><span class="linenos">772</span></a>
</span><span id="DisulfideLoader.save-773"><a href="#DisulfideLoader.save-773"><span class="linenos">773</span></a><span class="sd">        :param savepath: Path to save the file, defaults to DATA_DIR</span>
</span><span id="DisulfideLoader.save-774"><a href="#DisulfideLoader.save-774"><span class="linenos">774</span></a><span class="sd">        :param fname: Filename, defaults to LOADER_FNAME</span>
</span><span id="DisulfideLoader.save-775"><a href="#DisulfideLoader.save-775"><span class="linenos">775</span></a><span class="sd">        :param verbose: Verbosity, defaults to False</span>
</span><span id="DisulfideLoader.save-776"><a href="#DisulfideLoader.save-776"><span class="linenos">776</span></a><span class="sd">        :param cutoff: Ca-Ca Distance cutoff used to build the database, -1 means no cutoff.</span>
</span><span id="DisulfideLoader.save-777"><a href="#DisulfideLoader.save-777"><span class="linenos">777</span></a><span class="sd">        :param sg_cutoff: Sg-Sg Distance cutoff used to build the database, -1 means no cutoff.</span>
</span><span id="DisulfideLoader.save-778"><a href="#DisulfideLoader.save-778"><span class="linenos">778</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.save-779"><a href="#DisulfideLoader.save-779"><span class="linenos">779</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">__version__</span>
</span><span id="DisulfideLoader.save-780"><a href="#DisulfideLoader.save-780"><span class="linenos">780</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">=</span> <span class="n">cutoff</span>
</span><span id="DisulfideLoader.save-781"><a href="#DisulfideLoader.save-781"><span class="linenos">781</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sg_cutoff</span> <span class="o">=</span> <span class="n">sg_cutoff</span>
</span><span id="DisulfideLoader.save-782"><a href="#DisulfideLoader.save-782"><span class="linenos">782</span></a>
</span><span id="DisulfideLoader.save-783"><a href="#DisulfideLoader.save-783"><span class="linenos">783</span></a>        <span class="n">fname</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideLoader.save-784"><a href="#DisulfideLoader.save-784"><span class="linenos">784</span></a>
</span><span id="DisulfideLoader.save-785"><a href="#DisulfideLoader.save-785"><span class="linenos">785</span></a>        <span class="k">if</span> <span class="n">subset</span><span class="p">:</span>
</span><span id="DisulfideLoader.save-786"><a href="#DisulfideLoader.save-786"><span class="linenos">786</span></a>            <span class="n">fname</span> <span class="o">=</span> <span class="n">LOADER_SUBSET_FNAME</span>
</span><span id="DisulfideLoader.save-787"><a href="#DisulfideLoader.save-787"><span class="linenos">787</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideLoader.save-788"><a href="#DisulfideLoader.save-788"><span class="linenos">788</span></a>            <span class="n">fname</span> <span class="o">=</span> <span class="n">LOADER_FNAME</span>
</span><span id="DisulfideLoader.save-789"><a href="#DisulfideLoader.save-789"><span class="linenos">789</span></a>
</span><span id="DisulfideLoader.save-790"><a href="#DisulfideLoader.save-790"><span class="linenos">790</span></a>        <span class="n">_fname</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">savepath</span><span class="p">)</span> <span class="o">/</span> <span class="n">fname</span>
</span><span id="DisulfideLoader.save-791"><a href="#DisulfideLoader.save-791"><span class="linenos">791</span></a>
</span><span id="DisulfideLoader.save-792"><a href="#DisulfideLoader.save-792"><span class="linenos">792</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader.save-793"><a href="#DisulfideLoader.save-793"><span class="linenos">793</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Writing Disulfide Loader to: </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">_fname</span><span class="p">)</span>
</span><span id="DisulfideLoader.save-794"><a href="#DisulfideLoader.save-794"><span class="linenos">794</span></a>
</span><span id="DisulfideLoader.save-795"><a href="#DisulfideLoader.save-795"><span class="linenos">795</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">_fname</span><span class="p">),</span> <span class="s2">&quot;wb+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="DisulfideLoader.save-796"><a href="#DisulfideLoader.save-796"><span class="linenos">796</span></a>            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="DisulfideLoader.save-797"><a href="#DisulfideLoader.save-797"><span class="linenos">797</span></a>
</span><span id="DisulfideLoader.save-798"><a href="#DisulfideLoader.save-798"><span class="linenos">798</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader.save-799"><a href="#DisulfideLoader.save-799"><span class="linenos">799</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Done saving loader.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Save a copy of the fully instantiated Loader to the specified file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>savepath</strong>:  Path to save the file, defaults to DATA_DIR</li>
<li><strong>fname</strong>:  Filename, defaults to LOADER_FNAME</li>
<li><strong>verbose</strong>:  Verbosity, defaults to False</li>
<li><strong>cutoff</strong>:  Ca-Ca Distance cutoff used to build the database, -1 means no cutoff.</li>
<li><strong>sg_cutoff</strong>:  Sg-Sg Distance cutoff used to build the database, -1 means no cutoff.</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideLoader.plot_disulfides_vs_pdbid" class="classattr">
                                        <input id="DisulfideLoader.plot_disulfides_vs_pdbid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_disulfides_vs_pdbid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">cutoff</span><span class="o">=</span><span class="mi">1</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.plot_disulfides_vs_pdbid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.plot_disulfides_vs_pdbid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-801"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-801"><span class="linenos">801</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_disulfides_vs_pdbid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-802"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-802"><span class="linenos">802</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-803"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-803"><span class="linenos">803</span></a><span class="sd">        Plots the number of disulfides versus pdbid.</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-804"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-804"><span class="linenos">804</span></a>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-805"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-805"><span class="linenos">805</span></a><span class="sd">        :param cutoff: The minimum number of disulfides a PDB ID must have to be included in the plot.</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-806"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-806"><span class="linenos">806</span></a><span class="sd">        :type cutoff: int</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-807"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-807"><span class="linenos">807</span></a><span class="sd">        :return: A tuple containing the list of PDB IDs and the corresponding number of disulfides.</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-808"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-808"><span class="linenos">808</span></a><span class="sd">        :rtype: tuple</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-809"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-809"><span class="linenos">809</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-810"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-810"><span class="linenos">810</span></a>        <span class="n">pdbids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-811"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-811"><span class="linenos">811</span></a>        <span class="n">num_disulfides</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-812"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-812"><span class="linenos">812</span></a>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-813"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-813"><span class="linenos">813</span></a>        <span class="k">for</span> <span class="n">pdbid</span><span class="p">,</span> <span class="n">disulfides</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-814"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-814"><span class="linenos">814</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">disulfides</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">cutoff</span><span class="p">:</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-815"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-815"><span class="linenos">815</span></a>                <span class="n">pdbids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdbid</span><span class="p">)</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-816"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-816"><span class="linenos">816</span></a>                <span class="n">num_disulfides</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">disulfides</span><span class="p">))</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-817"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-817"><span class="linenos">817</span></a>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-818"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-818"><span class="linenos">818</span></a>        <span class="c1"># Create a DataFrame</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-819"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-819"><span class="linenos">819</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;PDB ID&quot;</span><span class="p">:</span> <span class="n">pdbids</span><span class="p">,</span> <span class="s2">&quot;Number of Disulfides&quot;</span><span class="p">:</span> <span class="n">num_disulfides</span><span class="p">})</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-820"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-820"><span class="linenos">820</span></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-821"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-821"><span class="linenos">821</span></a>            <span class="n">df</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-822"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-822"><span class="linenos">822</span></a>            <span class="n">x</span><span class="o">=</span><span class="s2">&quot;PDB ID&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-823"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-823"><span class="linenos">823</span></a>            <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Number of Disulfides&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-824"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-824"><span class="linenos">824</span></a>            <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Disulfides vs PDB ID with cutoff: </span><span class="si">{</span><span class="n">cutoff</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pdbids</span><span class="p">)</span><span class="si">}</span><span class="s2"> PDB IDs&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-825"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-825"><span class="linenos">825</span></a>        <span class="p">)</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-826"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-826"><span class="linenos">826</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-827"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-827"><span class="linenos">827</span></a>            <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;PDB ID&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-828"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-828"><span class="linenos">828</span></a>            <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&quot;Number of Disulfides&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-829"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-829"><span class="linenos">829</span></a>            <span class="n">xaxis_tickangle</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-830"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-830"><span class="linenos">830</span></a>        <span class="p">)</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-831"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-831"><span class="linenos">831</span></a>        <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-832"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-832"><span class="linenos">832</span></a>
</span><span id="DisulfideLoader.plot_disulfides_vs_pdbid-833"><a href="#DisulfideLoader.plot_disulfides_vs_pdbid-833"><span class="linenos">833</span></a>        <span class="k">return</span> <span class="n">pdbids</span><span class="p">,</span> <span class="n">num_disulfides</span>
</span></pre></div>


            <div class="docstring"><p>Plots the number of disulfides versus pdbid.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>cutoff</strong>:  The minimum number of disulfides a PDB ID must have to be included in the plot.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A tuple containing the list of PDB IDs and the corresponding number of disulfides.</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideLoader.plot_distances" class="classattr">
                                        <input id="DisulfideLoader.plot_distances-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_distances</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">distance_type</span><span class="o">=</span><span class="s1">&#39;ca&#39;</span>,</span><span class="param">	<span class="n">cutoff</span><span class="o">=-</span><span class="mi">1</span>,</span><span class="param">	<span class="n">comparison</span><span class="o">=</span><span class="s1">&#39;less&#39;</span>,</span><span class="param">	<span class="n">theme</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span>,</span><span class="param">	<span class="n">log</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.plot_distances-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.plot_distances"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.plot_distances-835"><a href="#DisulfideLoader.plot_distances-835"><span class="linenos">835</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_distances</span><span class="p">(</span>
</span><span id="DisulfideLoader.plot_distances-836"><a href="#DisulfideLoader.plot_distances-836"><span class="linenos">836</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">distance_type</span><span class="o">=</span><span class="s2">&quot;ca&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">comparison</span><span class="o">=</span><span class="s2">&quot;less&quot;</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span>
</span><span id="DisulfideLoader.plot_distances-837"><a href="#DisulfideLoader.plot_distances-837"><span class="linenos">837</span></a>    <span class="p">):</span>
</span><span id="DisulfideLoader.plot_distances-838"><a href="#DisulfideLoader.plot_distances-838"><span class="linenos">838</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.plot_distances-839"><a href="#DisulfideLoader.plot_distances-839"><span class="linenos">839</span></a><span class="sd">        Plot the distances for the disulfides in the loader.</span>
</span><span id="DisulfideLoader.plot_distances-840"><a href="#DisulfideLoader.plot_distances-840"><span class="linenos">840</span></a>
</span><span id="DisulfideLoader.plot_distances-841"><a href="#DisulfideLoader.plot_distances-841"><span class="linenos">841</span></a><span class="sd">        :param distance_type: The type of distance to plot (&#39;ca&#39; for Cα-Cα distance, &#39;sg&#39; for Sγ-Sγ distance)</span>
</span><span id="DisulfideLoader.plot_distances-842"><a href="#DisulfideLoader.plot_distances-842"><span class="linenos">842</span></a><span class="sd">        :param cutoff: The cutoff value for the distance, defaults to -1 (no cutoff)</span>
</span><span id="DisulfideLoader.plot_distances-843"><a href="#DisulfideLoader.plot_distances-843"><span class="linenos">843</span></a><span class="sd">        :param comparison: if &#39;less&#39; then plot distances less than the cutoff, if &#39;greater&#39; then plot distances greater than the cutoff</span>
</span><span id="DisulfideLoader.plot_distances-844"><a href="#DisulfideLoader.plot_distances-844"><span class="linenos">844</span></a><span class="sd">        :param theme: The theme to use for the plot (&#39;auto&#39;, &#39;light&#39;, or &#39;dark&#39;)</span>
</span><span id="DisulfideLoader.plot_distances-845"><a href="#DisulfideLoader.plot_distances-845"><span class="linenos">845</span></a><span class="sd">        :param log: Whether to use a log scale for the y-axis</span>
</span><span id="DisulfideLoader.plot_distances-846"><a href="#DisulfideLoader.plot_distances-846"><span class="linenos">846</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.plot_distances-847"><a href="#DisulfideLoader.plot_distances-847"><span class="linenos">847</span></a>        <span class="c1"># from proteusPy.DisulfideVisualization import DisulfideVisualization</span>
</span><span id="DisulfideLoader.plot_distances-848"><a href="#DisulfideLoader.plot_distances-848"><span class="linenos">848</span></a>
</span><span id="DisulfideLoader.plot_distances-849"><a href="#DisulfideLoader.plot_distances-849"><span class="linenos">849</span></a>        <span class="c1"># sslist = self.SSList</span>
</span><span id="DisulfideLoader.plot_distances-850"><a href="#DisulfideLoader.plot_distances-850"><span class="linenos">850</span></a>        <span class="c1"># distances = sslist.extract_distances(distance_type, comparison, cutoff)</span>
</span><span id="DisulfideLoader.plot_distances-851"><a href="#DisulfideLoader.plot_distances-851"><span class="linenos">851</span></a>
</span><span id="DisulfideLoader.plot_distances-852"><a href="#DisulfideLoader.plot_distances-852"><span class="linenos">852</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">plot_distances</span><span class="p">(</span>
</span><span id="DisulfideLoader.plot_distances-853"><a href="#DisulfideLoader.plot_distances-853"><span class="linenos">853</span></a>            <span class="n">distance_type</span><span class="o">=</span><span class="n">distance_type</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_distances-854"><a href="#DisulfideLoader.plot_distances-854"><span class="linenos">854</span></a>            <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_distances-855"><a href="#DisulfideLoader.plot_distances-855"><span class="linenos">855</span></a>            <span class="n">comparison</span><span class="o">=</span><span class="n">comparison</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_distances-856"><a href="#DisulfideLoader.plot_distances-856"><span class="linenos">856</span></a>            <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_distances-857"><a href="#DisulfideLoader.plot_distances-857"><span class="linenos">857</span></a>            <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span>
</span><span id="DisulfideLoader.plot_distances-858"><a href="#DisulfideLoader.plot_distances-858"><span class="linenos">858</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plot the distances for the disulfides in the loader.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>distance_type</strong>:  The type of distance to plot ('ca' for Cα-Cα distance, 'sg' for Sγ-Sγ distance)</li>
<li><strong>cutoff</strong>:  The cutoff value for the distance, defaults to -1 (no cutoff)</li>
<li><strong>comparison</strong>:  if 'less' then plot distances less than the cutoff, if 'greater' then plot distances greater than the cutoff</li>
<li><strong>theme</strong>:  The theme to use for the plot ('auto', 'light', or 'dark')</li>
<li><strong>log</strong>:  Whether to use a log scale for the y-axis</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideLoader.plot_deviation_scatterplots" class="classattr">
                                        <input id="DisulfideLoader.plot_deviation_scatterplots-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_deviation_scatterplots</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="n">theme</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.plot_deviation_scatterplots-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.plot_deviation_scatterplots"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.plot_deviation_scatterplots-860"><a href="#DisulfideLoader.plot_deviation_scatterplots-860"><span class="linenos">860</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_deviation_scatterplots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">):</span>
</span><span id="DisulfideLoader.plot_deviation_scatterplots-861"><a href="#DisulfideLoader.plot_deviation_scatterplots-861"><span class="linenos">861</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.plot_deviation_scatterplots-862"><a href="#DisulfideLoader.plot_deviation_scatterplots-862"><span class="linenos">862</span></a><span class="sd">        Plot scatter plots for Bondlength_Deviation, Angle_Deviation Ca_Distance</span>
</span><span id="DisulfideLoader.plot_deviation_scatterplots-863"><a href="#DisulfideLoader.plot_deviation_scatterplots-863"><span class="linenos">863</span></a><span class="sd">        and SG_Distance.</span>
</span><span id="DisulfideLoader.plot_deviation_scatterplots-864"><a href="#DisulfideLoader.plot_deviation_scatterplots-864"><span class="linenos">864</span></a>
</span><span id="DisulfideLoader.plot_deviation_scatterplots-865"><a href="#DisulfideLoader.plot_deviation_scatterplots-865"><span class="linenos">865</span></a><span class="sd">        :param verbose: Whether to display the plot in the notebook. Default is False.</span>
</span><span id="DisulfideLoader.plot_deviation_scatterplots-866"><a href="#DisulfideLoader.plot_deviation_scatterplots-866"><span class="linenos">866</span></a><span class="sd">        :type verbose: bool</span>
</span><span id="DisulfideLoader.plot_deviation_scatterplots-867"><a href="#DisulfideLoader.plot_deviation_scatterplots-867"><span class="linenos">867</span></a><span class="sd">        :param theme: One of &#39;Auto&#39;, &#39;Light&#39;, or &#39;Dark&#39;. Default is &#39;Auto&#39;.</span>
</span><span id="DisulfideLoader.plot_deviation_scatterplots-868"><a href="#DisulfideLoader.plot_deviation_scatterplots-868"><span class="linenos">868</span></a><span class="sd">        :type light: str</span>
</span><span id="DisulfideLoader.plot_deviation_scatterplots-869"><a href="#DisulfideLoader.plot_deviation_scatterplots-869"><span class="linenos">869</span></a><span class="sd">        :return: None</span>
</span><span id="DisulfideLoader.plot_deviation_scatterplots-870"><a href="#DisulfideLoader.plot_deviation_scatterplots-870"><span class="linenos">870</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.plot_deviation_scatterplots-871"><a href="#DisulfideLoader.plot_deviation_scatterplots-871"><span class="linenos">871</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">plot_deviation_scatterplots</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plot scatter plots for Bondlength_Deviation, Angle_Deviation Ca_Distance
and SG_Distance.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>verbose</strong>:  Whether to display the plot in the notebook. Default is False.</li>
<li><strong>theme</strong>:  One of 'Auto', 'Light', or 'Dark'. Default is 'Auto'.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideLoader.plot_deviation_histograms" class="classattr">
                                        <input id="DisulfideLoader.plot_deviation_histograms-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_deviation_histograms</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">theme</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span>, </span><span class="param"><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.plot_deviation_histograms-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.plot_deviation_histograms"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.plot_deviation_histograms-873"><a href="#DisulfideLoader.plot_deviation_histograms-873"><span class="linenos">873</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_deviation_histograms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="DisulfideLoader.plot_deviation_histograms-874"><a href="#DisulfideLoader.plot_deviation_histograms-874"><span class="linenos">874</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.plot_deviation_histograms-875"><a href="#DisulfideLoader.plot_deviation_histograms-875"><span class="linenos">875</span></a><span class="sd">        Plot histograms for Bondlength_Deviation, Angle_Deviation, and Ca_Distance.</span>
</span><span id="DisulfideLoader.plot_deviation_histograms-876"><a href="#DisulfideLoader.plot_deviation_histograms-876"><span class="linenos">876</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.plot_deviation_histograms-877"><a href="#DisulfideLoader.plot_deviation_histograms-877"><span class="linenos">877</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">plot_deviation_histograms</span><span class="p">(</span><span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Plot histograms for Bondlength_Deviation, Angle_Deviation, and Ca_Distance.</p>
</div>


                            </div>
                            <div id="DisulfideLoader.plot_classes" class="classattr">
                                        <input id="DisulfideLoader.plot_classes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_classes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">class_string</span>, </span><span class="param"><span class="n">base</span><span class="o">=</span><span class="mi">8</span>, </span><span class="param"><span class="n">theme</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span>, </span><span class="param"><span class="n">log</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="n">page_size</span><span class="o">=</span><span class="mi">200</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.plot_classes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.plot_classes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.plot_classes-879"><a href="#DisulfideLoader.plot_classes-879"><span class="linenos">879</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot_classes</span><span class="p">(</span>
</span><span id="DisulfideLoader.plot_classes-880"><a href="#DisulfideLoader.plot_classes-880"><span class="linenos">880</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">class_string</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">page_size</span><span class="o">=</span><span class="mi">200</span>
</span><span id="DisulfideLoader.plot_classes-881"><a href="#DisulfideLoader.plot_classes-881"><span class="linenos">881</span></a>    <span class="p">):</span>
</span><span id="DisulfideLoader.plot_classes-882"><a href="#DisulfideLoader.plot_classes-882"><span class="linenos">882</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.plot_classes-883"><a href="#DisulfideLoader.plot_classes-883"><span class="linenos">883</span></a><span class="sd">        Plot the distribution of disulfides for the given class string.</span>
</span><span id="DisulfideLoader.plot_classes-884"><a href="#DisulfideLoader.plot_classes-884"><span class="linenos">884</span></a>
</span><span id="DisulfideLoader.plot_classes-885"><a href="#DisulfideLoader.plot_classes-885"><span class="linenos">885</span></a><span class="sd">        :param class_string: The class string to plot.</span>
</span><span id="DisulfideLoader.plot_classes-886"><a href="#DisulfideLoader.plot_classes-886"><span class="linenos">886</span></a><span class="sd">        :type class_string: str</span>
</span><span id="DisulfideLoader.plot_classes-887"><a href="#DisulfideLoader.plot_classes-887"><span class="linenos">887</span></a><span class="sd">        :param base: The base of the class string. Default is 8.</span>
</span><span id="DisulfideLoader.plot_classes-888"><a href="#DisulfideLoader.plot_classes-888"><span class="linenos">888</span></a><span class="sd">        :type base: int</span>
</span><span id="DisulfideLoader.plot_classes-889"><a href="#DisulfideLoader.plot_classes-889"><span class="linenos">889</span></a><span class="sd">        :param theme: The theme to use for the plot (&#39;auto&#39;, &#39;light&#39;, or &#39;dark&#39;), defaults to &#39;auto&#39;.</span>
</span><span id="DisulfideLoader.plot_classes-890"><a href="#DisulfideLoader.plot_classes-890"><span class="linenos">890</span></a><span class="sd">        :type theme: str</span>
</span><span id="DisulfideLoader.plot_classes-891"><a href="#DisulfideLoader.plot_classes-891"><span class="linenos">891</span></a><span class="sd">        :return: None</span>
</span><span id="DisulfideLoader.plot_classes-892"><a href="#DisulfideLoader.plot_classes-892"><span class="linenos">892</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.plot_classes-893"><a href="#DisulfideLoader.plot_classes-893"><span class="linenos">893</span></a>        <span class="n">classlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="o">.</span><span class="n">binary_to_class</span><span class="p">(</span><span class="n">class_string</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideLoader.plot_classes-894"><a href="#DisulfideLoader.plot_classes-894"><span class="linenos">894</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_enumerate_class_fromlist</span><span class="p">(</span><span class="n">classlist</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideLoader.plot_classes-895"><a href="#DisulfideLoader.plot_classes-895"><span class="linenos">895</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot_count_vs_class_df</span><span class="p">(</span>
</span><span id="DisulfideLoader.plot_classes-896"><a href="#DisulfideLoader.plot_classes-896"><span class="linenos">896</span></a>            <span class="n">df</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">class_string</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span> <span class="n">page_size</span><span class="o">=</span><span class="n">page_size</span>
</span><span id="DisulfideLoader.plot_classes-897"><a href="#DisulfideLoader.plot_classes-897"><span class="linenos">897</span></a>        <span class="p">)</span>
</span><span id="DisulfideLoader.plot_classes-898"><a href="#DisulfideLoader.plot_classes-898"><span class="linenos">898</span></a>
</span><span id="DisulfideLoader.plot_classes-899"><a href="#DisulfideLoader.plot_classes-899"><span class="linenos">899</span></a>        <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>Plot the distribution of disulfides for the given class string.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>class_string</strong>:  The class string to plot.</li>
<li><strong>base</strong>:  The base of the class string. Default is 8.</li>
<li><strong>theme</strong>:  The theme to use for the plot ('auto', 'light', or 'dark'), defaults to 'auto'.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideLoader.sslist_from_class" class="classattr">
                                        <input id="DisulfideLoader.sslist_from_class-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sslist_from_class</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">class_string</span>,</span><span class="param">	<span class="n">base</span><span class="o">=</span><span class="mi">8</span>,</span><span class="param">	<span class="n">cutoff</span><span class="o">=</span><span class="mf">0.0</span></span><span class="return-annotation">) -> <span class="n"><a href="DisulfideBase.html#DisulfideList">proteusPy.DisulfideBase.DisulfideList</a></span>:</span></span>

                <label class="view-source-button" for="DisulfideLoader.sslist_from_class-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.sslist_from_class"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.sslist_from_class-901"><a href="#DisulfideLoader.sslist_from_class-901"><span class="linenos">901</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sslist_from_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_string</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="DisulfideLoader.sslist_from_class-902"><a href="#DisulfideLoader.sslist_from_class-902"><span class="linenos">902</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.sslist_from_class-903"><a href="#DisulfideLoader.sslist_from_class-903"><span class="linenos">903</span></a><span class="sd">        Return a DisulfideList containing Disulfides with the given class_string.</span>
</span><span id="DisulfideLoader.sslist_from_class-904"><a href="#DisulfideLoader.sslist_from_class-904"><span class="linenos">904</span></a>
</span><span id="DisulfideLoader.sslist_from_class-905"><a href="#DisulfideLoader.sslist_from_class-905"><span class="linenos">905</span></a><span class="sd">        :param class_string: The class string to search for.</span>
</span><span id="DisulfideLoader.sslist_from_class-906"><a href="#DisulfideLoader.sslist_from_class-906"><span class="linenos">906</span></a><span class="sd">        :param base: The base of the class string. Default is 8.</span>
</span><span id="DisulfideLoader.sslist_from_class-907"><a href="#DisulfideLoader.sslist_from_class-907"><span class="linenos">907</span></a><span class="sd">        :param cutoff: The % cutoff value for the class. Default is 0.0.</span>
</span><span id="DisulfideLoader.sslist_from_class-908"><a href="#DisulfideLoader.sslist_from_class-908"><span class="linenos">908</span></a><span class="sd">        :return: DisulfideList containing Disulfides with the given class_string.</span>
</span><span id="DisulfideLoader.sslist_from_class-909"><a href="#DisulfideLoader.sslist_from_class-909"><span class="linenos">909</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.sslist_from_class-910"><a href="#DisulfideLoader.sslist_from_class-910"><span class="linenos">910</span></a>        <span class="n">sslist_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">class_string</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">base</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">cutoff</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="DisulfideLoader.sslist_from_class-911"><a href="#DisulfideLoader.sslist_from_class-911"><span class="linenos">911</span></a>        <span class="n">sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="n">sslist_name</span><span class="p">)</span>
</span><span id="DisulfideLoader.sslist_from_class-912"><a href="#DisulfideLoader.sslist_from_class-912"><span class="linenos">912</span></a>
</span><span id="DisulfideLoader.sslist_from_class-913"><a href="#DisulfideLoader.sslist_from_class-913"><span class="linenos">913</span></a>        <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_class_indices_from_tors_df</span><span class="p">(</span><span class="n">class_string</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideLoader.sslist_from_class-914"><a href="#DisulfideLoader.sslist_from_class-914"><span class="linenos">914</span></a>
</span><span id="DisulfideLoader.sslist_from_class-915"><a href="#DisulfideLoader.sslist_from_class-915"><span class="linenos">915</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
</span><span id="DisulfideLoader.sslist_from_class-916"><a href="#DisulfideLoader.sslist_from_class-916"><span class="linenos">916</span></a>            <span class="n">sslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="DisulfideLoader.sslist_from_class-917"><a href="#DisulfideLoader.sslist_from_class-917"><span class="linenos">917</span></a>
</span><span id="DisulfideLoader.sslist_from_class-918"><a href="#DisulfideLoader.sslist_from_class-918"><span class="linenos">918</span></a>        <span class="k">return</span> <span class="n">sslist</span>
</span></pre></div>


            <div class="docstring"><p>Return a DisulfideList containing Disulfides with the given class_string.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>class_string</strong>:  The class string to search for.</li>
<li><strong>base</strong>:  The base of the class string. Default is 8.</li>
<li><strong>cutoff</strong>:  The % cutoff value for the class. Default is 0.0.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>DisulfideList containing Disulfides with the given class_string.</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideLoader.display_torsion_statistics" class="classattr">
                                        <input id="DisulfideLoader.display_torsion_statistics-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">display_torsion_statistics</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">class_id</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">display</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">save</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">fname</span><span class="o">=</span><span class="s1">&#39;ss_torsions.png&#39;</span>,</span><span class="param">	<span class="n">theme</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.display_torsion_statistics-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.display_torsion_statistics"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.display_torsion_statistics-920"><a href="#DisulfideLoader.display_torsion_statistics-920"><span class="linenos">920</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display_torsion_statistics</span><span class="p">(</span>
</span><span id="DisulfideLoader.display_torsion_statistics-921"><a href="#DisulfideLoader.display_torsion_statistics-921"><span class="linenos">921</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DisulfideLoader.display_torsion_statistics-922"><a href="#DisulfideLoader.display_torsion_statistics-922"><span class="linenos">922</span></a>        <span class="n">class_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="DisulfideLoader.display_torsion_statistics-923"><a href="#DisulfideLoader.display_torsion_statistics-923"><span class="linenos">923</span></a>        <span class="n">display</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DisulfideLoader.display_torsion_statistics-924"><a href="#DisulfideLoader.display_torsion_statistics-924"><span class="linenos">924</span></a>        <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader.display_torsion_statistics-925"><a href="#DisulfideLoader.display_torsion_statistics-925"><span class="linenos">925</span></a>        <span class="n">fname</span><span class="o">=</span><span class="s2">&quot;ss_torsions.png&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader.display_torsion_statistics-926"><a href="#DisulfideLoader.display_torsion_statistics-926"><span class="linenos">926</span></a>        <span class="n">theme</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
</span><span id="DisulfideLoader.display_torsion_statistics-927"><a href="#DisulfideLoader.display_torsion_statistics-927"><span class="linenos">927</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader.display_torsion_statistics-928"><a href="#DisulfideLoader.display_torsion_statistics-928"><span class="linenos">928</span></a>    <span class="p">):</span>
</span><span id="DisulfideLoader.display_torsion_statistics-929"><a href="#DisulfideLoader.display_torsion_statistics-929"><span class="linenos">929</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.display_torsion_statistics-930"><a href="#DisulfideLoader.display_torsion_statistics-930"><span class="linenos">930</span></a><span class="sd">        Display torsion and distance statistics for Disulfides in the loader.</span>
</span><span id="DisulfideLoader.display_torsion_statistics-931"><a href="#DisulfideLoader.display_torsion_statistics-931"><span class="linenos">931</span></a>
</span><span id="DisulfideLoader.display_torsion_statistics-932"><a href="#DisulfideLoader.display_torsion_statistics-932"><span class="linenos">932</span></a><span class="sd">        :param class_id: The class ID to display statistics for. Default is None.</span>
</span><span id="DisulfideLoader.display_torsion_statistics-933"><a href="#DisulfideLoader.display_torsion_statistics-933"><span class="linenos">933</span></a><span class="sd">        :type class_id: str</span>
</span><span id="DisulfideLoader.display_torsion_statistics-934"><a href="#DisulfideLoader.display_torsion_statistics-934"><span class="linenos">934</span></a><span class="sd">        :param display: Whether to display the plot in the notebook. Default is True.</span>
</span><span id="DisulfideLoader.display_torsion_statistics-935"><a href="#DisulfideLoader.display_torsion_statistics-935"><span class="linenos">935</span></a><span class="sd">        :type display: bool</span>
</span><span id="DisulfideLoader.display_torsion_statistics-936"><a href="#DisulfideLoader.display_torsion_statistics-936"><span class="linenos">936</span></a><span class="sd">        :param save: Whether to save the plot as an image file. Default is False.</span>
</span><span id="DisulfideLoader.display_torsion_statistics-937"><a href="#DisulfideLoader.display_torsion_statistics-937"><span class="linenos">937</span></a><span class="sd">        :type save: bool</span>
</span><span id="DisulfideLoader.display_torsion_statistics-938"><a href="#DisulfideLoader.display_torsion_statistics-938"><span class="linenos">938</span></a><span class="sd">        :param fname: The name of the image file to save. Default is &#39;ss_torsions.png&#39;.</span>
</span><span id="DisulfideLoader.display_torsion_statistics-939"><a href="#DisulfideLoader.display_torsion_statistics-939"><span class="linenos">939</span></a><span class="sd">        :type fname: str</span>
</span><span id="DisulfideLoader.display_torsion_statistics-940"><a href="#DisulfideLoader.display_torsion_statistics-940"><span class="linenos">940</span></a><span class="sd">        :param theme: One of &#39;Auto&#39;, &#39;Light&#39;, or &#39;Dark&#39;. Default is &#39;Auto&#39;.</span>
</span><span id="DisulfideLoader.display_torsion_statistics-941"><a href="#DisulfideLoader.display_torsion_statistics-941"><span class="linenos">941</span></a><span class="sd">        :type theme: str</span>
</span><span id="DisulfideLoader.display_torsion_statistics-942"><a href="#DisulfideLoader.display_torsion_statistics-942"><span class="linenos">942</span></a><span class="sd">        :param verbose: Whether to display verbose output. Default is False.</span>
</span><span id="DisulfideLoader.display_torsion_statistics-943"><a href="#DisulfideLoader.display_torsion_statistics-943"><span class="linenos">943</span></a><span class="sd">        :type verbose: bool</span>
</span><span id="DisulfideLoader.display_torsion_statistics-944"><a href="#DisulfideLoader.display_torsion_statistics-944"><span class="linenos">944</span></a><span class="sd">        :return: None</span>
</span><span id="DisulfideLoader.display_torsion_statistics-945"><a href="#DisulfideLoader.display_torsion_statistics-945"><span class="linenos">945</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.display_torsion_statistics-946"><a href="#DisulfideLoader.display_torsion_statistics-946"><span class="linenos">946</span></a>        <span class="k">if</span> <span class="n">class_id</span><span class="p">:</span>
</span><span id="DisulfideLoader.display_torsion_statistics-947"><a href="#DisulfideLoader.display_torsion_statistics-947"><span class="linenos">947</span></a>            <span class="n">sslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_class</span><span class="p">(</span><span class="n">class_id</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="DisulfideLoader.display_torsion_statistics-948"><a href="#DisulfideLoader.display_torsion_statistics-948"><span class="linenos">948</span></a>            <span class="n">sslist</span><span class="o">.</span><span class="n">display_torsion_statistics</span><span class="p">(</span>
</span><span id="DisulfideLoader.display_torsion_statistics-949"><a href="#DisulfideLoader.display_torsion_statistics-949"><span class="linenos">949</span></a>                <span class="n">display</span><span class="o">=</span><span class="n">display</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">fname</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="n">theme</span>
</span><span id="DisulfideLoader.display_torsion_statistics-950"><a href="#DisulfideLoader.display_torsion_statistics-950"><span class="linenos">950</span></a>            <span class="p">)</span>
</span><span id="DisulfideLoader.display_torsion_statistics-951"><a href="#DisulfideLoader.display_torsion_statistics-951"><span class="linenos">951</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideLoader.display_torsion_statistics-952"><a href="#DisulfideLoader.display_torsion_statistics-952"><span class="linenos">952</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">display_torsion_statistics</span><span class="p">(</span>
</span><span id="DisulfideLoader.display_torsion_statistics-953"><a href="#DisulfideLoader.display_torsion_statistics-953"><span class="linenos">953</span></a>                <span class="n">display</span><span class="o">=</span><span class="n">display</span><span class="p">,</span>
</span><span id="DisulfideLoader.display_torsion_statistics-954"><a href="#DisulfideLoader.display_torsion_statistics-954"><span class="linenos">954</span></a>                <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span>
</span><span id="DisulfideLoader.display_torsion_statistics-955"><a href="#DisulfideLoader.display_torsion_statistics-955"><span class="linenos">955</span></a>                <span class="n">fname</span><span class="o">=</span><span class="n">fname</span><span class="p">,</span>
</span><span id="DisulfideLoader.display_torsion_statistics-956"><a href="#DisulfideLoader.display_torsion_statistics-956"><span class="linenos">956</span></a>                <span class="n">theme</span><span class="o">=</span><span class="n">theme</span><span class="p">,</span>
</span><span id="DisulfideLoader.display_torsion_statistics-957"><a href="#DisulfideLoader.display_torsion_statistics-957"><span class="linenos">957</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Display torsion and distance statistics for Disulfides in the loader.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>class_id</strong>:  The class ID to display statistics for. Default is None.</li>
<li><strong>display</strong>:  Whether to display the plot in the notebook. Default is True.</li>
<li><strong>save</strong>:  Whether to save the plot as an image file. Default is False.</li>
<li><strong>fname</strong>:  The name of the image file to save. Default is 'ss_torsions.png'.</li>
<li><strong>theme</strong>:  One of 'Auto', 'Light', or 'Dark'. Default is 'Auto'.</li>
<li><strong>verbose</strong>:  Whether to display verbose output. Default is False.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideLoader.classes_vs_cutoff" class="classattr">
                                        <input id="DisulfideLoader.classes_vs_cutoff-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">classes_vs_cutoff</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">cutoff</span>, </span><span class="param"><span class="n">base</span><span class="o">=</span><span class="mi">8</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.classes_vs_cutoff-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.classes_vs_cutoff"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.classes_vs_cutoff-959"><a href="#DisulfideLoader.classes_vs_cutoff-959"><span class="linenos">959</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">classes_vs_cutoff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
</span><span id="DisulfideLoader.classes_vs_cutoff-960"><a href="#DisulfideLoader.classes_vs_cutoff-960"><span class="linenos">960</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.classes_vs_cutoff-961"><a href="#DisulfideLoader.classes_vs_cutoff-961"><span class="linenos">961</span></a><span class="sd">        Return number of members for the octant class for a given cutoff value.</span>
</span><span id="DisulfideLoader.classes_vs_cutoff-962"><a href="#DisulfideLoader.classes_vs_cutoff-962"><span class="linenos">962</span></a>
</span><span id="DisulfideLoader.classes_vs_cutoff-963"><a href="#DisulfideLoader.classes_vs_cutoff-963"><span class="linenos">963</span></a><span class="sd">        :param cutoff: Percent cutoff value for filtering the classes.</span>
</span><span id="DisulfideLoader.classes_vs_cutoff-964"><a href="#DisulfideLoader.classes_vs_cutoff-964"><span class="linenos">964</span></a><span class="sd">        :return: None</span>
</span><span id="DisulfideLoader.classes_vs_cutoff-965"><a href="#DisulfideLoader.classes_vs_cutoff-965"><span class="linenos">965</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.classes_vs_cutoff-966"><a href="#DisulfideLoader.classes_vs_cutoff-966"><span class="linenos">966</span></a>
</span><span id="DisulfideLoader.classes_vs_cutoff-967"><a href="#DisulfideLoader.classes_vs_cutoff-967"><span class="linenos">967</span></a>        <span class="n">class_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tclass</span><span class="o">.</span><span class="n">filter_class_by_percentage</span><span class="p">(</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideLoader.classes_vs_cutoff-968"><a href="#DisulfideLoader.classes_vs_cutoff-968"><span class="linenos">968</span></a>        <span class="k">return</span> <span class="n">class_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return number of members for the octant class for a given cutoff value.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>cutoff</strong>:  Percent cutoff value for filtering the classes.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                </section>
                <section id="Load_PDB_SS">
                            <input id="Load_PDB_SS-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">Load_PDB_SS</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">loadpath</span><span class="o">=</span><span class="s1">&#39;/Users/egs/repos/proteusPy/proteusPy/data&#39;</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">subset</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">cutoff</span><span class="o">=-</span><span class="mf">1.0</span>,</span><span class="param">	<span class="n">sg_cutoff</span><span class="o">=-</span><span class="mf">1.0</span>,</span><span class="param">	<span class="n">force</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="#DisulfideLoader">DisulfideLoader</a></span>:</span></span>

                <label class="view-source-button" for="Load_PDB_SS-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Load_PDB_SS"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Load_PDB_SS-974"><a href="#Load_PDB_SS-974"><span class="linenos"> 974</span></a><span class="k">def</span><span class="w"> </span><span class="nf">Load_PDB_SS</span><span class="p">(</span>
</span><span id="Load_PDB_SS-975"><a href="#Load_PDB_SS-975"><span class="linenos"> 975</span></a>    <span class="n">loadpath</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span>
</span><span id="Load_PDB_SS-976"><a href="#Load_PDB_SS-976"><span class="linenos"> 976</span></a>    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Load_PDB_SS-977"><a href="#Load_PDB_SS-977"><span class="linenos"> 977</span></a>    <span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Load_PDB_SS-978"><a href="#Load_PDB_SS-978"><span class="linenos"> 978</span></a>    <span class="n">cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="Load_PDB_SS-979"><a href="#Load_PDB_SS-979"><span class="linenos"> 979</span></a>    <span class="n">sg_cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="Load_PDB_SS-980"><a href="#Load_PDB_SS-980"><span class="linenos"> 980</span></a>    <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Load_PDB_SS-981"><a href="#Load_PDB_SS-981"><span class="linenos"> 981</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideLoader</span><span class="p">:</span>
</span><span id="Load_PDB_SS-982"><a href="#Load_PDB_SS-982"><span class="linenos"> 982</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Load_PDB_SS-983"><a href="#Load_PDB_SS-983"><span class="linenos"> 983</span></a><span class="sd">    Load the fully instantiated Disulfide database from the specified file. This function</span>
</span><span id="Load_PDB_SS-984"><a href="#Load_PDB_SS-984"><span class="linenos"> 984</span></a><span class="sd">    will load the pre-built database if available, or bootstrap a new loader by downloading</span>
</span><span id="Load_PDB_SS-985"><a href="#Load_PDB_SS-985"><span class="linenos"> 985</span></a><span class="sd">    the data from Google Drive if needed. Use the provided parameters to control the loading</span>
</span><span id="Load_PDB_SS-986"><a href="#Load_PDB_SS-986"><span class="linenos"> 986</span></a><span class="sd">    behavior, filtering cutoffs, and verbosity.</span>
</span><span id="Load_PDB_SS-987"><a href="#Load_PDB_SS-987"><span class="linenos"> 987</span></a>
</span><span id="Load_PDB_SS-988"><a href="#Load_PDB_SS-988"><span class="linenos"> 988</span></a><span class="sd">    :param loadpath: Path from which to load the database; defaults to DATA_DIR.</span>
</span><span id="Load_PDB_SS-989"><a href="#Load_PDB_SS-989"><span class="linenos"> 989</span></a><span class="sd">    :type loadpath: str</span>
</span><span id="Load_PDB_SS-990"><a href="#Load_PDB_SS-990"><span class="linenos"> 990</span></a><span class="sd">    :param verbose: If True, enables verbose logging; defaults to False.</span>
</span><span id="Load_PDB_SS-991"><a href="#Load_PDB_SS-991"><span class="linenos"> 991</span></a><span class="sd">    :type verbose: bool</span>
</span><span id="Load_PDB_SS-992"><a href="#Load_PDB_SS-992"><span class="linenos"> 992</span></a><span class="sd">    :param subset: If True, loads the subset database; otherwise loads the full database.</span>
</span><span id="Load_PDB_SS-993"><a href="#Load_PDB_SS-993"><span class="linenos"> 993</span></a><span class="sd">    :type subset: bool</span>
</span><span id="Load_PDB_SS-994"><a href="#Load_PDB_SS-994"><span class="linenos"> 994</span></a><span class="sd">    :param cutoff: Cα distance cutoff used to filter disulfides; defaults to CA_CUTOFF.</span>
</span><span id="Load_PDB_SS-995"><a href="#Load_PDB_SS-995"><span class="linenos"> 995</span></a><span class="sd">    :type cutoff: float</span>
</span><span id="Load_PDB_SS-996"><a href="#Load_PDB_SS-996"><span class="linenos"> 996</span></a><span class="sd">    :param sg_cutoff: Sγ distance cutoff used to filter disulfides; defaults to SG_CUTOFF.</span>
</span><span id="Load_PDB_SS-997"><a href="#Load_PDB_SS-997"><span class="linenos"> 997</span></a><span class="sd">    :type sg_cutoff: float</span>
</span><span id="Load_PDB_SS-998"><a href="#Load_PDB_SS-998"><span class="linenos"> 998</span></a><span class="sd">    :param force: If True, forces re-loading from Google Drive even if the file exists; defaults to False.</span>
</span><span id="Load_PDB_SS-999"><a href="#Load_PDB_SS-999"><span class="linenos"> 999</span></a><span class="sd">    :type force: bool</span>
</span><span id="Load_PDB_SS-1000"><a href="#Load_PDB_SS-1000"><span class="linenos">1000</span></a><span class="sd">    :param percentile: Percentile (0-100) to compute cutoffs dynamically; if set to -1.0, the percentile method is not used.</span>
</span><span id="Load_PDB_SS-1001"><a href="#Load_PDB_SS-1001"><span class="linenos">1001</span></a><span class="sd">    :type percentile: float</span>
</span><span id="Load_PDB_SS-1002"><a href="#Load_PDB_SS-1002"><span class="linenos">1002</span></a><span class="sd">    :return: An instance of DisulfideLoader containing the loaded disulfide database.</span>
</span><span id="Load_PDB_SS-1003"><a href="#Load_PDB_SS-1003"><span class="linenos">1003</span></a><span class="sd">    :rtype: DisulfideLoader</span>
</span><span id="Load_PDB_SS-1004"><a href="#Load_PDB_SS-1004"><span class="linenos">1004</span></a>
</span><span id="Load_PDB_SS-1005"><a href="#Load_PDB_SS-1005"><span class="linenos">1005</span></a><span class="sd">    Example:</span>
</span><span id="Load_PDB_SS-1006"><a href="#Load_PDB_SS-1006"><span class="linenos">1006</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy import Load_PDB_SS, create_logger</span>
</span><span id="Load_PDB_SS-1007"><a href="#Load_PDB_SS-1007"><span class="linenos">1007</span></a><span class="sd">        &gt;&gt;&gt; import logging</span>
</span><span id="Load_PDB_SS-1008"><a href="#Load_PDB_SS-1008"><span class="linenos">1008</span></a><span class="sd">        &gt;&gt;&gt; _logger = create_logger(&quot;testing&quot;)</span>
</span><span id="Load_PDB_SS-1009"><a href="#Load_PDB_SS-1009"><span class="linenos">1009</span></a><span class="sd">        &gt;&gt;&gt; _logger.setLevel(logging.WARNING)</span>
</span><span id="Load_PDB_SS-1010"><a href="#Load_PDB_SS-1010"><span class="linenos">1010</span></a><span class="sd">        &gt;&gt;&gt; loader = Load_PDB_SS(verbose=False, subset=True)</span>
</span><span id="Load_PDB_SS-1011"><a href="#Load_PDB_SS-1011"><span class="linenos">1011</span></a><span class="sd">        &gt;&gt;&gt; print(loader[0])</span>
</span><span id="Load_PDB_SS-1012"><a href="#Load_PDB_SS-1012"><span class="linenos">1012</span></a><span class="sd">        &lt;Disulfide 6dmb_203A_226A, Source: 6dmb, Resolution: 3.0 Å&gt;</span>
</span><span id="Load_PDB_SS-1013"><a href="#Load_PDB_SS-1013"><span class="linenos">1013</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Load_PDB_SS-1014"><a href="#Load_PDB_SS-1014"><span class="linenos">1014</span></a>
</span><span id="Load_PDB_SS-1015"><a href="#Load_PDB_SS-1015"><span class="linenos">1015</span></a>    <span class="c1"># normally the .pkl files are local, EXCEPT for the first run from a newly-installed proteusPy</span>
</span><span id="Load_PDB_SS-1016"><a href="#Load_PDB_SS-1016"><span class="linenos">1016</span></a>    <span class="c1"># distribution. In that case we need to download the files for all disulfides and the subset</span>
</span><span id="Load_PDB_SS-1017"><a href="#Load_PDB_SS-1017"><span class="linenos">1017</span></a>    <span class="c1"># from my Google Drive. This is a one-time operation.</span>
</span><span id="Load_PDB_SS-1018"><a href="#Load_PDB_SS-1018"><span class="linenos">1018</span></a>
</span><span id="Load_PDB_SS-1019"><a href="#Load_PDB_SS-1019"><span class="linenos">1019</span></a>    <span class="n">_fname_sub</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">loadpath</span><span class="p">)</span> <span class="o">/</span> <span class="n">LOADER_SUBSET_FNAME</span>
</span><span id="Load_PDB_SS-1020"><a href="#Load_PDB_SS-1020"><span class="linenos">1020</span></a>    <span class="n">_fname_all</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">loadpath</span><span class="p">)</span> <span class="o">/</span> <span class="n">LOADER_FNAME</span>
</span><span id="Load_PDB_SS-1021"><a href="#Load_PDB_SS-1021"><span class="linenos">1021</span></a>    <span class="n">_fpath</span> <span class="o">=</span> <span class="n">_fname_sub</span> <span class="k">if</span> <span class="n">subset</span> <span class="k">else</span> <span class="n">_fname_all</span>
</span><span id="Load_PDB_SS-1022"><a href="#Load_PDB_SS-1022"><span class="linenos">1022</span></a>
</span><span id="Load_PDB_SS-1023"><a href="#Load_PDB_SS-1023"><span class="linenos">1023</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">_fpath</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">or</span> <span class="n">force</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Load_PDB_SS-1024"><a href="#Load_PDB_SS-1024"><span class="linenos">1024</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Load_PDB_SS-1025"><a href="#Load_PDB_SS-1025"><span class="linenos">1025</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bootstrapping new loader: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">_fpath</span><span class="p">)</span><span class="si">}</span><span class="s2">... &quot;</span><span class="p">)</span>
</span><span id="Load_PDB_SS-1026"><a href="#Load_PDB_SS-1026"><span class="linenos">1026</span></a>
</span><span id="Load_PDB_SS-1027"><a href="#Load_PDB_SS-1027"><span class="linenos">1027</span></a>        <span class="n">loader</span> <span class="o">=</span> <span class="n">Bootstrap_PDB_SS</span><span class="p">(</span>
</span><span id="Load_PDB_SS-1028"><a href="#Load_PDB_SS-1028"><span class="linenos">1028</span></a>            <span class="n">loadpath</span><span class="o">=</span><span class="n">loadpath</span><span class="p">,</span>
</span><span id="Load_PDB_SS-1029"><a href="#Load_PDB_SS-1029"><span class="linenos">1029</span></a>            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="Load_PDB_SS-1030"><a href="#Load_PDB_SS-1030"><span class="linenos">1030</span></a>            <span class="n">subset</span><span class="o">=</span><span class="n">subset</span><span class="p">,</span>
</span><span id="Load_PDB_SS-1031"><a href="#Load_PDB_SS-1031"><span class="linenos">1031</span></a>            <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">,</span>
</span><span id="Load_PDB_SS-1032"><a href="#Load_PDB_SS-1032"><span class="linenos">1032</span></a>            <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span>
</span><span id="Load_PDB_SS-1033"><a href="#Load_PDB_SS-1033"><span class="linenos">1033</span></a>            <span class="n">sg_cutoff</span><span class="o">=</span><span class="n">sg_cutoff</span><span class="p">,</span>
</span><span id="Load_PDB_SS-1034"><a href="#Load_PDB_SS-1034"><span class="linenos">1034</span></a>        <span class="p">)</span>
</span><span id="Load_PDB_SS-1035"><a href="#Load_PDB_SS-1035"><span class="linenos">1035</span></a>        <span class="n">loader</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
</span><span id="Load_PDB_SS-1036"><a href="#Load_PDB_SS-1036"><span class="linenos">1036</span></a>            <span class="n">savepath</span><span class="o">=</span><span class="n">loadpath</span><span class="p">,</span>
</span><span id="Load_PDB_SS-1037"><a href="#Load_PDB_SS-1037"><span class="linenos">1037</span></a>            <span class="n">subset</span><span class="o">=</span><span class="n">subset</span><span class="p">,</span>
</span><span id="Load_PDB_SS-1038"><a href="#Load_PDB_SS-1038"><span class="linenos">1038</span></a>            <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span>
</span><span id="Load_PDB_SS-1039"><a href="#Load_PDB_SS-1039"><span class="linenos">1039</span></a>            <span class="n">sg_cutoff</span><span class="o">=</span><span class="n">sg_cutoff</span><span class="p">,</span>
</span><span id="Load_PDB_SS-1040"><a href="#Load_PDB_SS-1040"><span class="linenos">1040</span></a>        <span class="p">)</span>
</span><span id="Load_PDB_SS-1041"><a href="#Load_PDB_SS-1041"><span class="linenos">1041</span></a>        <span class="k">return</span> <span class="n">loader</span>
</span><span id="Load_PDB_SS-1042"><a href="#Load_PDB_SS-1042"><span class="linenos">1042</span></a>
</span><span id="Load_PDB_SS-1043"><a href="#Load_PDB_SS-1043"><span class="linenos">1043</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Load_PDB_SS-1044"><a href="#Load_PDB_SS-1044"><span class="linenos">1044</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Reading disulfides from: </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">_fpath</span><span class="p">)</span>
</span><span id="Load_PDB_SS-1045"><a href="#Load_PDB_SS-1045"><span class="linenos">1045</span></a>
</span><span id="Load_PDB_SS-1046"><a href="#Load_PDB_SS-1046"><span class="linenos">1046</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">_fpath</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="Load_PDB_SS-1047"><a href="#Load_PDB_SS-1047"><span class="linenos">1047</span></a>        <span class="n">loader</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="Load_PDB_SS-1048"><a href="#Load_PDB_SS-1048"><span class="linenos">1048</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Load_PDB_SS-1049"><a href="#Load_PDB_SS-1049"><span class="linenos">1049</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Done reading disulfides from: </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">_fpath</span><span class="p">)</span>
</span><span id="Load_PDB_SS-1050"><a href="#Load_PDB_SS-1050"><span class="linenos">1050</span></a>        <span class="n">loader</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</span><span id="Load_PDB_SS-1051"><a href="#Load_PDB_SS-1051"><span class="linenos">1051</span></a>
</span><span id="Load_PDB_SS-1052"><a href="#Load_PDB_SS-1052"><span class="linenos">1052</span></a>    <span class="k">return</span> <span class="n">loader</span>
</span></pre></div>


            <div class="docstring"><p>Load the fully instantiated Disulfide database from the specified file. This function
will load the pre-built database if available, or bootstrap a new loader by downloading
the data from Google Drive if needed. Use the provided parameters to control the loading
behavior, filtering cutoffs, and verbosity.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>loadpath</strong>:  Path from which to load the database; defaults to DATA_DIR.</li>
<li><strong>verbose</strong>:  If True, enables verbose logging; defaults to False.</li>
<li><strong>subset</strong>:  If True, loads the subset database; otherwise loads the full database.</li>
<li><strong>cutoff</strong>:  Cα distance cutoff used to filter disulfides; defaults to CA_CUTOFF.</li>
<li><strong>sg_cutoff</strong>:  Sγ distance cutoff used to filter disulfides; defaults to SG_CUTOFF.</li>
<li><strong>force</strong>:  If True, forces re-loading from Google Drive even if the file exists; defaults to False.</li>
<li><strong>percentile</strong>:  Percentile (0-100) to compute cutoffs dynamically; if set to -1.0, the percentile method is not used.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>An instance of DisulfideLoader containing the loaded disulfide database.</p>
</blockquote>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>from proteusPy import Load_PDB_SS, create_logger
      import logging
      _logger = create_logger("testing")
      _logger.setLevel(logging.WARNING)
      loader = Load_PDB_SS(verbose=False, subset=True)
      print(loader[0])
          <Disulfide 6dmb_203A_226A, Source: 6dmb, Resolution: 3.0 Å&gt;</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                </section>
                <section id="Bootstrap_PDB_SS">
                            <input id="Bootstrap_PDB_SS-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">Bootstrap_PDB_SS</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">loadpath</span><span class="o">=</span><span class="s1">&#39;/Users/egs/repos/proteusPy/proteusPy/data&#39;</span>,</span><span class="param">	<span class="n">cutoff</span><span class="o">=-</span><span class="mf">1.0</span>,</span><span class="param">	<span class="n">sg_cutoff</span><span class="o">=-</span><span class="mf">1.0</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">subset</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">force</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">fake</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Bootstrap_PDB_SS-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Bootstrap_PDB_SS"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Bootstrap_PDB_SS-1055"><a href="#Bootstrap_PDB_SS-1055"><span class="linenos">1055</span></a><span class="k">def</span><span class="w"> </span><span class="nf">Bootstrap_PDB_SS</span><span class="p">(</span>
</span><span id="Bootstrap_PDB_SS-1056"><a href="#Bootstrap_PDB_SS-1056"><span class="linenos">1056</span></a>    <span class="n">loadpath</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span>
</span><span id="Bootstrap_PDB_SS-1057"><a href="#Bootstrap_PDB_SS-1057"><span class="linenos">1057</span></a>    <span class="n">cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="Bootstrap_PDB_SS-1058"><a href="#Bootstrap_PDB_SS-1058"><span class="linenos">1058</span></a>    <span class="n">sg_cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="Bootstrap_PDB_SS-1059"><a href="#Bootstrap_PDB_SS-1059"><span class="linenos">1059</span></a>    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Bootstrap_PDB_SS-1060"><a href="#Bootstrap_PDB_SS-1060"><span class="linenos">1060</span></a>    <span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Bootstrap_PDB_SS-1061"><a href="#Bootstrap_PDB_SS-1061"><span class="linenos">1061</span></a>    <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Bootstrap_PDB_SS-1062"><a href="#Bootstrap_PDB_SS-1062"><span class="linenos">1062</span></a>    <span class="n">fake</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Bootstrap_PDB_SS-1063"><a href="#Bootstrap_PDB_SS-1063"><span class="linenos">1063</span></a><span class="p">):</span>
</span><span id="Bootstrap_PDB_SS-1064"><a href="#Bootstrap_PDB_SS-1064"><span class="linenos">1064</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Bootstrap_PDB_SS-1065"><a href="#Bootstrap_PDB_SS-1065"><span class="linenos">1065</span></a><span class="sd">    Download and instantiate the disulfide databases from Google Drive.</span>
</span><span id="Bootstrap_PDB_SS-1066"><a href="#Bootstrap_PDB_SS-1066"><span class="linenos">1066</span></a>
</span><span id="Bootstrap_PDB_SS-1067"><a href="#Bootstrap_PDB_SS-1067"><span class="linenos">1067</span></a><span class="sd">    This function downloads the disulfide master SS list from Google Drive if it doesn&#39;t</span>
</span><span id="Bootstrap_PDB_SS-1068"><a href="#Bootstrap_PDB_SS-1068"><span class="linenos">1068</span></a><span class="sd">    already exist in the specified load path or if the force flag is set to True.</span>
</span><span id="Bootstrap_PDB_SS-1069"><a href="#Bootstrap_PDB_SS-1069"><span class="linenos">1069</span></a><span class="sd">    It then loads the disulfide data from the downloaded file and initializes a</span>
</span><span id="Bootstrap_PDB_SS-1070"><a href="#Bootstrap_PDB_SS-1070"><span class="linenos">1070</span></a><span class="sd">    DisulfideLoader instance.</span>
</span><span id="Bootstrap_PDB_SS-1071"><a href="#Bootstrap_PDB_SS-1071"><span class="linenos">1071</span></a>
</span><span id="Bootstrap_PDB_SS-1072"><a href="#Bootstrap_PDB_SS-1072"><span class="linenos">1072</span></a><span class="sd">    :param loadpath: Path from which to load the data, defaults to DATA_DIR</span>
</span><span id="Bootstrap_PDB_SS-1073"><a href="#Bootstrap_PDB_SS-1073"><span class="linenos">1073</span></a><span class="sd">    :type loadpath: str</span>
</span><span id="Bootstrap_PDB_SS-1074"><a href="#Bootstrap_PDB_SS-1074"><span class="linenos">1074</span></a><span class="sd">    :param cutoff: Cutoff value for disulfide loading, defaults to -1.0 (no filtering)</span>
</span><span id="Bootstrap_PDB_SS-1075"><a href="#Bootstrap_PDB_SS-1075"><span class="linenos">1075</span></a><span class="sd">    :type cutoff: float</span>
</span><span id="Bootstrap_PDB_SS-1076"><a href="#Bootstrap_PDB_SS-1076"><span class="linenos">1076</span></a><span class="sd">    :param sg_cutoff: Cutoff value for disulfide loading, defaults to -1.0 (no filtering)</span>
</span><span id="Bootstrap_PDB_SS-1077"><a href="#Bootstrap_PDB_SS-1077"><span class="linenos">1077</span></a><span class="sd">    :type sg_cutoff: float</span>
</span><span id="Bootstrap_PDB_SS-1078"><a href="#Bootstrap_PDB_SS-1078"><span class="linenos">1078</span></a><span class="sd">    :param verbose: Flag to enable verbose logging, defaults to False</span>
</span><span id="Bootstrap_PDB_SS-1079"><a href="#Bootstrap_PDB_SS-1079"><span class="linenos">1079</span></a><span class="sd">    :type verbose: bool</span>
</span><span id="Bootstrap_PDB_SS-1080"><a href="#Bootstrap_PDB_SS-1080"><span class="linenos">1080</span></a><span class="sd">    :param subset: Flag to indicate whether to load a subset of the data, defaults to False</span>
</span><span id="Bootstrap_PDB_SS-1081"><a href="#Bootstrap_PDB_SS-1081"><span class="linenos">1081</span></a><span class="sd">    :type subset: bool</span>
</span><span id="Bootstrap_PDB_SS-1082"><a href="#Bootstrap_PDB_SS-1082"><span class="linenos">1082</span></a><span class="sd">    :param force: Flag to force download even if the file exists, defaults to False</span>
</span><span id="Bootstrap_PDB_SS-1083"><a href="#Bootstrap_PDB_SS-1083"><span class="linenos">1083</span></a><span class="sd">    :type force: bool</span>
</span><span id="Bootstrap_PDB_SS-1084"><a href="#Bootstrap_PDB_SS-1084"><span class="linenos">1084</span></a><span class="sd">    :return: An instance of DisulfideLoader initialized with the loaded data</span>
</span><span id="Bootstrap_PDB_SS-1085"><a href="#Bootstrap_PDB_SS-1085"><span class="linenos">1085</span></a><span class="sd">    :rtype: DisulfideLoader</span>
</span><span id="Bootstrap_PDB_SS-1086"><a href="#Bootstrap_PDB_SS-1086"><span class="linenos">1086</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Bootstrap_PDB_SS-1087"><a href="#Bootstrap_PDB_SS-1087"><span class="linenos">1087</span></a>
</span><span id="Bootstrap_PDB_SS-1088"><a href="#Bootstrap_PDB_SS-1088"><span class="linenos">1088</span></a>    <span class="n">fname</span> <span class="o">=</span> <span class="n">SS_PICKLE_FILE</span>
</span><span id="Bootstrap_PDB_SS-1089"><a href="#Bootstrap_PDB_SS-1089"><span class="linenos">1089</span></a>    <span class="n">url</span> <span class="o">=</span> <span class="n">SS_LIST_URL</span>
</span><span id="Bootstrap_PDB_SS-1090"><a href="#Bootstrap_PDB_SS-1090"><span class="linenos">1090</span></a>
</span><span id="Bootstrap_PDB_SS-1091"><a href="#Bootstrap_PDB_SS-1091"><span class="linenos">1091</span></a>    <span class="c1"># _fname = Path(loadpath) / fname</span>
</span><span id="Bootstrap_PDB_SS-1092"><a href="#Bootstrap_PDB_SS-1092"><span class="linenos">1092</span></a>    <span class="n">full_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">loadpath</span><span class="p">)</span> <span class="o">/</span> <span class="n">fname</span>
</span><span id="Bootstrap_PDB_SS-1093"><a href="#Bootstrap_PDB_SS-1093"><span class="linenos">1093</span></a>
</span><span id="Bootstrap_PDB_SS-1094"><a href="#Bootstrap_PDB_SS-1094"><span class="linenos">1094</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">full_path</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">or</span> <span class="n">force</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Bootstrap_PDB_SS-1095"><a href="#Bootstrap_PDB_SS-1095"><span class="linenos">1095</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Bootstrap_PDB_SS-1096"><a href="#Bootstrap_PDB_SS-1096"><span class="linenos">1096</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Can&#39;t find </span><span class="si">%s</span><span class="s2">. Downloading from Drive...&quot;</span><span class="p">,</span> <span class="n">full_path</span><span class="p">)</span>
</span><span id="Bootstrap_PDB_SS-1097"><a href="#Bootstrap_PDB_SS-1097"><span class="linenos">1097</span></a>
</span><span id="Bootstrap_PDB_SS-1098"><a href="#Bootstrap_PDB_SS-1098"><span class="linenos">1098</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">fake</span><span class="p">:</span>
</span><span id="Bootstrap_PDB_SS-1099"><a href="#Bootstrap_PDB_SS-1099"><span class="linenos">1099</span></a>            <span class="n">gdown</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">full_path</span><span class="p">),</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Bootstrap_PDB_SS-1100"><a href="#Bootstrap_PDB_SS-1100"><span class="linenos">1100</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Bootstrap_PDB_SS-1101"><a href="#Bootstrap_PDB_SS-1101"><span class="linenos">1101</span></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Bootstrap_PDB_SS-1102"><a href="#Bootstrap_PDB_SS-1102"><span class="linenos">1102</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Fake download: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">full_path</span><span class="p">)</span>
</span><span id="Bootstrap_PDB_SS-1103"><a href="#Bootstrap_PDB_SS-1103"><span class="linenos">1103</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Bootstrap_PDB_SS-1104"><a href="#Bootstrap_PDB_SS-1104"><span class="linenos">1104</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Bootstrap_PDB_SS-1105"><a href="#Bootstrap_PDB_SS-1105"><span class="linenos">1105</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="Bootstrap_PDB_SS-1106"><a href="#Bootstrap_PDB_SS-1106"><span class="linenos">1106</span></a>            <span class="s2">&quot;Building loader from: </span><span class="si">%s</span><span class="s2"> with cutoffs </span><span class="si">%f</span><span class="s2">, </span><span class="si">%f</span><span class="s2">...&quot;</span><span class="p">,</span>
</span><span id="Bootstrap_PDB_SS-1107"><a href="#Bootstrap_PDB_SS-1107"><span class="linenos">1107</span></a>            <span class="n">full_path</span><span class="p">,</span>
</span><span id="Bootstrap_PDB_SS-1108"><a href="#Bootstrap_PDB_SS-1108"><span class="linenos">1108</span></a>            <span class="n">cutoff</span><span class="p">,</span>
</span><span id="Bootstrap_PDB_SS-1109"><a href="#Bootstrap_PDB_SS-1109"><span class="linenos">1109</span></a>            <span class="n">sg_cutoff</span><span class="p">,</span>
</span><span id="Bootstrap_PDB_SS-1110"><a href="#Bootstrap_PDB_SS-1110"><span class="linenos">1110</span></a>        <span class="p">)</span>
</span><span id="Bootstrap_PDB_SS-1111"><a href="#Bootstrap_PDB_SS-1111"><span class="linenos">1111</span></a>
</span><span id="Bootstrap_PDB_SS-1112"><a href="#Bootstrap_PDB_SS-1112"><span class="linenos">1112</span></a>    <span class="n">loader</span> <span class="o">=</span> <span class="n">DisulfideLoader</span><span class="p">(</span>
</span><span id="Bootstrap_PDB_SS-1113"><a href="#Bootstrap_PDB_SS-1113"><span class="linenos">1113</span></a>        <span class="n">datadir</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span>
</span><span id="Bootstrap_PDB_SS-1114"><a href="#Bootstrap_PDB_SS-1114"><span class="linenos">1114</span></a>        <span class="n">subset</span><span class="o">=</span><span class="n">subset</span><span class="p">,</span>
</span><span id="Bootstrap_PDB_SS-1115"><a href="#Bootstrap_PDB_SS-1115"><span class="linenos">1115</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="Bootstrap_PDB_SS-1116"><a href="#Bootstrap_PDB_SS-1116"><span class="linenos">1116</span></a>        <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span>
</span><span id="Bootstrap_PDB_SS-1117"><a href="#Bootstrap_PDB_SS-1117"><span class="linenos">1117</span></a>        <span class="n">sg_cutoff</span><span class="o">=</span><span class="n">sg_cutoff</span><span class="p">,</span>
</span><span id="Bootstrap_PDB_SS-1118"><a href="#Bootstrap_PDB_SS-1118"><span class="linenos">1118</span></a>    <span class="p">)</span>
</span><span id="Bootstrap_PDB_SS-1119"><a href="#Bootstrap_PDB_SS-1119"><span class="linenos">1119</span></a>
</span><span id="Bootstrap_PDB_SS-1120"><a href="#Bootstrap_PDB_SS-1120"><span class="linenos">1120</span></a>    <span class="k">if</span> <span class="n">loader</span><span class="o">.</span><span class="n">TotalDisulfides</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Bootstrap_PDB_SS-1121"><a href="#Bootstrap_PDB_SS-1121"><span class="linenos">1121</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;No disulfides loaded!&quot;</span><span class="p">)</span>
</span><span id="Bootstrap_PDB_SS-1122"><a href="#Bootstrap_PDB_SS-1122"><span class="linenos">1122</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="Bootstrap_PDB_SS-1123"><a href="#Bootstrap_PDB_SS-1123"><span class="linenos">1123</span></a>
</span><span id="Bootstrap_PDB_SS-1124"><a href="#Bootstrap_PDB_SS-1124"><span class="linenos">1124</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Bootstrap_PDB_SS-1125"><a href="#Bootstrap_PDB_SS-1125"><span class="linenos">1125</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Done building loader.&quot;</span><span class="p">)</span>
</span><span id="Bootstrap_PDB_SS-1126"><a href="#Bootstrap_PDB_SS-1126"><span class="linenos">1126</span></a>
</span><span id="Bootstrap_PDB_SS-1127"><a href="#Bootstrap_PDB_SS-1127"><span class="linenos">1127</span></a>    <span class="k">return</span> <span class="n">loader</span>
</span></pre></div>


            <div class="docstring"><p>Download and instantiate the disulfide databases from Google Drive.</p>

<p>This function downloads the disulfide master SS list from Google Drive if it doesn't
already exist in the specified load path or if the force flag is set to True.
It then loads the disulfide data from the downloaded file and initializes a
DisulfideLoader instance.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>loadpath</strong>:  Path from which to load the data, defaults to DATA_DIR</li>
<li><strong>cutoff</strong>:  Cutoff value for disulfide loading, defaults to -1.0 (no filtering)</li>
<li><strong>sg_cutoff</strong>:  Cutoff value for disulfide loading, defaults to -1.0 (no filtering)</li>
<li><strong>verbose</strong>:  Flag to enable verbose logging, defaults to False</li>
<li><strong>subset</strong>:  Flag to indicate whether to load a subset of the data, defaults to False</li>
<li><strong>force</strong>:  Flag to force download even if the file exists, defaults to False</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>An instance of DisulfideLoader initialized with the loaded data</p>
</blockquote>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>