<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 13.0.0"/>
    <title>proteusPy.DisulfideLoader API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../proteusPy.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;proteusPy</a>

            <img src="./logo.png" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



        <h2>API Documentation</h2>
            <ul class="memberlist">
            <li>
                    <a class="class" href="#DisulfideLoader">DisulfideLoader</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DisulfideLoader.__init__">DisulfideLoader</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.Average_Resolution">Average_Resolution</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.build_classes">build_classes</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.build_ss_from_idlist">build_ss_from_idlist</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.concat_dataframes">concat_dataframes</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.copy">copy</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.getlist">getlist</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.describe">describe</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.display_overlay">display_overlay</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.getTorsions">getTorsions</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.list_classes">list_classes</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideLoader.quiet">quiet</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.save">save</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideLoader.from_class">from_class</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#DisulfideClass_Constructor">DisulfideClass_Constructor</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DisulfideClass_Constructor.__init__">DisulfideClass_Constructor</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClass_Constructor.load_class_dict">load_class_dict</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClass_Constructor.build_class_df">build_class_df</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClass_Constructor.list_classes">list_classes</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClass_Constructor.concat_dataframes">concat_dataframes</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClass_Constructor.build_yourself">build_yourself</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#create_classes">create_classes</a>
            </li>
            <li>
                    <a class="function" href="#Load_PDB_SS">Load_PDB_SS</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../proteusPy.html">proteusPy</a><wbr>.DisulfideLoader    </h1>

                        <div class="docstring"><p>This module is part of the proteusPy package, a Python package for 
the analysis and modeling of protein structures, with an emphasis on disulfide bonds.
This work is based on the original C/C++ implementation by Eric G. Suchanek. </p>

<p>Author: Eric G. Suchanek, PhD
Last revision: 2/20/2023</p>
</div>

                        <input id="mod-DisulfideLoader-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-DisulfideLoader-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">This module is part of the proteusPy package, a Python package for </span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">the analysis and modeling of protein structures, with an emphasis on disulfide bonds.</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">This work is based on the original C/C++ implementation by Eric G. Suchanek. \n</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">Author: Eric G. Suchanek, PhD</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">Last revision: 2/20/2023</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="c1"># Author: Eric G. Suchanek, PhD.</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="c1"># Last modification: 2/20/23</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="c1"># Cα N, Cα, Cβ, C&#39;, Sγ Å °</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="n">__pdoc__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;__all__&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="kn">import</span> <span class="nn">sys</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">import</span> <span class="nn">copy</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">import</span> <span class="nn">time</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="kn">import</span> <span class="nn">datetime</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="kn">import</span> <span class="nn">pyvista</span> <span class="k">as</span> <span class="nn">pv</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="kn">import</span> <span class="nn">pickle</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="kn">import</span> <span class="nn">proteusPy</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="kn">from</span> <span class="nn">proteusPy.ProteusGlobals</span> <span class="kn">import</span> <span class="n">PDB_DIR</span><span class="p">,</span> <span class="n">MODEL_DIR</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="kn">from</span> <span class="nn">proteusPy.atoms</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="kn">from</span> <span class="nn">proteusPy.data</span> <span class="kn">import</span> <span class="n">SS_PICKLE_FILE</span><span class="p">,</span> <span class="n">SS_TORSIONS_FILE</span><span class="p">,</span> <span class="n">SS_DICT_PICKLE_FILE</span><span class="p">,</span> <span class="n">DATA_DIR</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="kn">from</span> <span class="nn">proteusPy.data</span> <span class="kn">import</span> <span class="n">LOADER_FNAME</span><span class="p">,</span> <span class="n">LOADER_SUBSET_FNAME</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="kn">from</span> <span class="nn">proteusPy.DisulfideList</span> <span class="kn">import</span> <span class="n">DisulfideList</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="kn">from</span> <span class="nn">proteusPy.Disulfide</span> <span class="kn">import</span> <span class="n">Torsion_DF_Cols</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="kn">from</span> <span class="nn">proteusPy.Disulfide</span> <span class="kn">import</span> <span class="n">Disulfide</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="kn">from</span> <span class="nn">proteusPy.DisulfideExceptions</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="kn">from</span> <span class="nn">proteusPy.data</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="k">class</span> <span class="nc">DisulfideLoader</span><span class="p">:</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>    <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">    This class represents the disulfide database itself and is its primary means of accession. </span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">    The entirety of the RCSB disulfide database is stored within the class via a</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">    proteusPy.DisulfideList.DisulfideList, a ```Pandas``` .csv file, and a ```dict``` of</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">    indices mapping the PDB IDs into their respective list of disulfides. The datastructures allow</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">    simple, direct and flexible access to the disulfide structures contained herein. </span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">    This makes it possible to access the disulfides by array index, PDB structure ID or disulfide name.</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">    </span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">    The class can also render Disulfides overlaid on a common coordinate system to a pyVista window using the </span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">    [display_overlay()](#DisulfideLoader.display_overlay) method. See below for examples.\n</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">    Important note: For typical usage one will access the database via the `Load_PDB_SS()` function.</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">    The difference is that the latter function loads the compressed database from its single</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">    source. the `Load_PDB_SS()` function will load the individual torsions and disulfide .pkl,</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">    builds the classlist structures.</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">    </span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">    *Developer&#39;s Notes:*</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">    The .pkl files needed to instantiate this class and save it into its final .pkl file are</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">    defined in the proteusPy.data class and should not be changed. Upon initialization the class</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">    will load them and initialize itself. </span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">    Example:</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">    &gt;&gt;&gt; import proteusPy</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">    &gt;&gt;&gt; from proteusPy.Disulfide import Disulfide</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">    &gt;&gt;&gt; from proteusPy.DisulfideLoader import DisulfideLoader</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">    &gt;&gt;&gt; from proteusPy.DisulfideList import DisulfideList</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">    &gt;&gt;&gt; SS1 = DisulfideList([],&#39;tmp1&#39;)</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">    &gt;&gt;&gt; SS2 = DisulfideList([],&#39;tmp2&#39;)</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">    </span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">    &gt;&gt;&gt; PDB_SS = DisulfideLoader(verbose=False, subset=True)</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">    Accessing by index value:</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">    &gt;&gt;&gt; SS1 = PDB_SS[0]</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">    &gt;&gt;&gt; SS1</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">    &lt;Disulfide 4yys_22A_65A, Source: 4yys, Resolution: 1.35 Å&gt;</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">    </span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">    Accessing by PDB_ID returns a list of Disulfides:</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">    &gt;&gt;&gt; SS2 = PDB_SS[&#39;4yys&#39;]</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">    &gt;&gt;&gt; SS2</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">    [&lt;Disulfide 4yys_22A_65A, Source: 4yys, Resolution: 1.35 Å&gt;, &lt;Disulfide 4yys_56A_98A, Source: 4yys, Resolution: 1.35 Å&gt;, &lt;Disulfide 4yys_156A_207A, Source: 4yys, Resolution: 1.35 Å&gt;]</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">    </span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">    Accessing individual disulfides by their name:</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">    &gt;&gt;&gt; SS3 = PDB_SS[&#39;4yys_56A_98A&#39;]</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">    &gt;&gt;&gt; SS3</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">    &lt;Disulfide 4yys_56A_98A, Source: 4yys, Resolution: 1.35 Å&gt;</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">    </span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">    Finally, we can access disulfides by regular slicing:</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">    &gt;&gt;&gt; SSlist = PDB_SS[:4]</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">    &gt;&gt;&gt; SSlist.display(style=&#39;sb&#39;) </span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">datadir</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="n">picklefile</span><span class="o">=</span><span class="n">SS_PICKLE_FILE</span><span class="p">,</span> 
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>                <span class="n">pickle_dict_file</span><span class="o">=</span><span class="n">SS_DICT_PICKLE_FILE</span><span class="p">,</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>                <span class="n">torsion_file</span><span class="o">=</span><span class="n">SS_TORSIONS_FILE</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>                <span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>                <span class="n">cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">):</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">        Initializing the class initiates loading either the entire Disulfide dataset,</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">        or the &#39;subset&#39;, which consists of the first 1000 PDB structures. The subset</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">        is useful for testing and debugging since it doesn&#39;t require nearly as much</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">        memory or time. The name for the subset file is hard-coded. One can pass a</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">        different data directory and file names for the pickle files. These different</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">        directories are normally established with the proteusPy.Disulfide.Extract_Disulfides </span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">        function.</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ModelDir</span> <span class="o">=</span> <span class="n">datadir</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">picklefile</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">PickleDictFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">pickle_dict_file</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">PickleClassFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">SS_CLASS_DICT_FILE</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">TorsionFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">torsion_file</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s1">&#39;ALL_PDB_SS&#39;</span><span class="p">)</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">IDList</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">QUIET</span> <span class="o">=</span> <span class="n">quiet</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdf</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">=</span> <span class="n">cutoff</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>        <span class="n">idlist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>        <span class="k">if</span> <span class="n">subset</span><span class="p">:</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">SS_SUBSET_PICKLE_FILE</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">PickleDictFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">SS_SUBSET_DICT_PICKLE_FILE</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">TorsionFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">SS_SUBSET_TORSIONS_FILE</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>        
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; DisulfideLoader(): Reading disulfides from: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="si">}</span><span class="s1">... &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>        
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>            <span class="n">sslist</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span> <span class="o">=</span> <span class="n">sslist</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;done.&#39;</span><span class="p">,)</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">)</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>        
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; DisulfideLoader(): Reading disulfide dict2 from: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleDictFile</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>        
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleDictFile</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">:</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>                <span class="n">idlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">IDList</span> <span class="o">=</span> <span class="n">idlist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>            <span class="n">totalSS_dict</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IDList</span><span class="p">)</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;done.&#39;</span><span class="p">)</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; DisulfideLoader(): Reading Torsion DF from: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">TorsionFile</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>        <span class="n">tmpDF</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TorsionFile</span><span class="p">)</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>        <span class="n">tmpDF</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">tmpDF</span><span class="o">.</span><span class="n">columns</span><span class="p">[[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span> <span class="o">=</span> <span class="n">tmpDF</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; done.&#39;</span><span class="p">)</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_classes</span><span class="p">()</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>    
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; DisulfideLoader(): Loading complete.&#39;</span><span class="p">)</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>        <span class="k">return</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>    <span class="c1"># </span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>    <span class="c1"># overload __getitem__ to handle slicing and indexing, and access by name</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s1">&#39;none&#39;</span><span class="p">)</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">item</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">)))</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>            <span class="n">resolution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>            <span class="n">sublist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>            <span class="k">return</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="n">sublist</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">resolution</span><span class="p">)</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>        
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">item</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">item</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span><span class="p">):</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>                <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;DisulfideLoader(): Index </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s1"> out of range 0-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span> <span class="o">-</span> <span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>                <span class="k">raise</span> <span class="n">DisulfideException</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>        
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>            <span class="c1"># PDB_SS[&#39;4yys&#39;] return a list of SS</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="n">item</span><span class="p">)</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>            <span class="n">sslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sslist</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>            <span class="n">res</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">get_by_name</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="c1"># full disulfide name</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>            <span class="k">except</span><span class="p">:</span> 
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>                <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;DisulfideLoader(): Cannot find key </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s1"> in SSBond dict!&#39;</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>                <span class="k">raise</span> <span class="n">DisulfideException</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>    
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_ss</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>    <span class="k">def</span> <span class="nf">_validate_ss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="n">Disulfide</span><span class="p">)):</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>            <span class="k">return</span> <span class="n">value</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Disulfide object expected, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>    
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>    <span class="nd">@property</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>    <span class="k">def</span> <span class="nf">Average_Resolution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a><span class="sd">        Compute and return the average structure resolution for the given list.</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a><span class="sd">        :return: Average resolution (A)</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>        <span class="n">cnt</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>        <span class="n">sslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>        <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">:</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>            <span class="n">_res</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>            <span class="k">if</span> <span class="n">_res</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">res</span> <span class="o">!=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">:</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>                <span class="n">res</span> <span class="o">+=</span> <span class="n">_res</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>                <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>        <span class="k">return</span> <span class="n">res</span> <span class="o">/</span> <span class="n">cnt</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>    
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>    <span class="k">def</span> <span class="nf">build_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a><span class="sd">        Build the internal dictionary mapping disulfides to class names.</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="sd">        Disulfide classes are defined using the +/- formalism described by </span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">        Hogg et al. (Biochem, 2006, 45, 7429-7433), across all 32 (2^5), possible </span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="sd">        binary sidechain torsional combinations. Classes are named per Hogg&#39;s convention.</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a><span class="sd">        The ``class_id`` represents the sign of each dihedral angle $\chi_{1} - \chi_{1&#39;}$</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="sd">        where *0* repreents *negative* dihedral angle and *2* a *positive* angle.</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="sd">        |   class_id | SS_Classname   | FXN        |   count |   incidence |</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a><span class="sd">        |-----------:|:---------------|:-----------|--------:|------------:|</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a><span class="sd">        |      00000 | -LHSpiral      | UNK        |   31513 |  0.261092   |</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a><span class="sd">        |      00002 | 00002          | UNK        |    5805 |  0.0480956  |</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a><span class="sd">        |      00020 | -LHHook        | UNK        |    3413 |  0.0282774  |</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a><span class="sd">        |      00022 | 00022          | UNK        |    1940 |  0.0160733  |</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a><span class="sd">        |      00200 | -RHStaple      | Allosteric |   12735 |  0.105512   |</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a><span class="sd">        |      00202 | 00202          | UNK        |     993 |  0.00822721 |</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a><span class="sd">        |      00220 | 00220          | UNK        |    5674 |  0.0470103  |</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a><span class="sd">        |      00222 | 00222          | UNK        |    5092 |  0.0421883  |</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a><span class="sd">        |      02000 | 02000          | UNK        |    4749 |  0.0393465  |</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a><span class="sd">        |      02002 | 02002          | UNK        |    3774 |  0.0312684  |</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a><span class="sd">        |      02020 | -LHStaple      | UNK        |    1494 |  0.0123781  |</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a><span class="sd">        |      02022 | 02022          | UNK        |     591 |  0.00489656 |</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a><span class="sd">        |      02200 | -RHHook        | UNK        |    5090 |  0.0421717  |</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a><span class="sd">        |      02202 | 02202          | UNK        |     533 |  0.00441602 |</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a><span class="sd">        |      02220 | -RHSpiral      | UNK        |    6751 |  0.0559335  |</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a><span class="sd">        |      02222 | 02222          | UNK        |    3474 |  0.0287828  |</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a><span class="sd">        |      20000 | +/-LHSpiral    | UNK        |    3847 |  0.0318732  |</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a><span class="sd">        |      20002 | +LHSpiral      | UNK        |     875 |  0.00724956 |</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a><span class="sd">        |      20020 | +/-LHHook      | UNK        |     803 |  0.00665302 |</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a><span class="sd">        |      20022 | +LHHook        | UNK        |     602 |  0.0049877  |</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a><span class="sd">        |      20200 | +/-RHStaple    | UNK        |     419 |  0.0034715  |</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a><span class="sd">        |      20202 | +RHStaple      | UNK        |     293 |  0.00242757 |</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a><span class="sd">        |      20220 | +/-RHHook      | Catalytic  |    1435 |  0.0118893  |</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="sd">        |      20222 | 20222          | UNK        |     488 |  0.00404318 |</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a><span class="sd">        |      22000 | -/+LHHook      | UNK        |    2455 |  0.0203402  |</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a><span class="sd">        |      22002 | 22002          | UNK        |    1027 |  0.00850891 |</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a><span class="sd">        |      22020 | +/-LHStaple    | UNK        |    1046 |  0.00866633 |</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a><span class="sd">        |      22022 | +LHStaple      | UNK        |     300 |  0.00248556 |</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a><span class="sd">        |      22200 | -/+RHHook      | UNK        |    6684 |  0.0553783  |</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a><span class="sd">        |      22202 | +RHHook        | UNK        |     593 |  0.00491313 |</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a><span class="sd">        |      22220 | +/-RHSpiral    | UNK        |    2544 |  0.0210776  |</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a><span class="sd">        |      22222 | +RHSpiral      | UNK        |    3665 |  0.0303653  |</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>        <span class="k">def</span> <span class="nf">ss_id_dict</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>            <span class="n">ss_id_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SS_Classname&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ss_id&#39;</span><span class="p">]))</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>            <span class="k">return</span> <span class="n">ss_id_dict</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>        <span class="n">tors_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTorsions</span><span class="p">()</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; build_classes(): creating SS classes...&#39;</span><span class="p">)</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">create_classes</span><span class="p">(</span><span class="n">tors_df</span><span class="p">)</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>        <span class="c1"># grouped.to_csv(f&#39;{DATA_DIR}PDB_ss_classes.csv&#39;)</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>        <span class="c1">#if self.verbose:</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>        <span class="c1">#    print(f&#39;{grouped.head(32)}&#39;)</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>        
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>        <span class="n">class_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">SS_CLASS_DEFINITIONS</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class_id&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;FXN&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;SS_Classname&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">})</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s1">&#39;FXN&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s1">&#39;SS_Classname&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s1">&#39;class_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; build_classes(): merging...&#39;</span><span class="p">)</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>        <span class="n">merged</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">concat_dataframes</span><span class="p">(</span><span class="n">class_df</span><span class="p">,</span> <span class="n">grouped</span><span class="p">)</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>        <span class="n">merged</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Idx&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdf</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span> <span class="o">=</span> <span class="n">ss_id_dict</span><span class="p">(</span><span class="n">merged</span><span class="p">)</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; build_classes(): initialization complete.&#39;</span><span class="p">)</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>        
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>        <span class="k">return</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>    <span class="k">def</span> <span class="nf">build_ss_from_idlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idlist</span><span class="p">):</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a><span class="sd">        Given a list of PDBid, return a DisulfideList of Disulfides</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a><span class="sd">        :param idlist: List of PDBIDs, e.g. [&#39;4yys&#39;, &#39;2q7q&#39;]</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a><span class="sd">        :return: ProteusPy.DisulfideList.DisulfideList of ProteusPy.Disulfide.Disulfide</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>        
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>        <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">idlist</span><span class="p">:</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>            <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">:</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>                <span class="k">if</span> <span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span> <span class="o">==</span> <span class="nb">id</span><span class="p">:</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>                    <span class="k">break</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>    
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>    <span class="k">def</span> <span class="nf">concat_dataframes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">):</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a><span class="sd">        Concatenates columns from one data frame into the other and returns the new result.</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a><span class="sd">        :param df1 : pandas.DataFrame - The first data frame.</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a><span class="sd">        :param df2 : pandas.DataFrame - The second data frame.</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a><span class="sd">        :return: pandas.DataFrame - The concatenated data frame.</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>        <span class="c1"># Merge the data frames based on the &#39;SS_Classname&#39; column</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;class_id&#39;</span><span class="p">)</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a><span class="sd">        Return a copy of self</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a><span class="sd">        :return: Copy of self</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a><span class="sd">        :rtype: proteusPy.DisulfideLoader</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>    <span class="k">def</span> <span class="nf">getlist</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a><span class="sd">        Return the list of Disulfides contained in the class.</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a><span class="sd">        :return: DisulfideList</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a><span class="sd">        :rtype: DisulfideList</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">)</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>    
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>    <span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a><span class="sd">        Provides information about the Disulfide database contained in ```self```.</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="sd">        Example:</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideLoader import Load_PDB_SS</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = Load_PDB_SS(verbose=False, subset=False)</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS.describe()</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a><span class="sd">            =========== RCSB Disulfide Database Summary ==============</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a><span class="sd">        PDB IDs present:                    35818</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a><span class="sd">        Disulfides loaded:                  120697</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a><span class="sd">        Average structure resolution:       2.34 Å</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a><span class="sd">        Lowest Energy Disulfide:            2q7q_75D_140D</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a><span class="sd">        Highest Energy Disulfide:           1toz_456A_467A</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a><span class="sd">        Total RAM Used:                     29.26 GB.</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>        <span class="n">vers</span> <span class="o">=</span> <span class="n">proteusPy</span><span class="o">.</span><span class="n">__version__</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>        <span class="n">tot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>        <span class="n">pdbs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">)</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>        <span class="n">ram</span> <span class="o">=</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">)</span> <span class="o">+</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">)</span> <span class="o">+</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Average_Resolution</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>        <span class="n">cutoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>        <span class="n">timestr</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">))</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>        <span class="n">ssMin</span><span class="p">,</span> <span class="n">ssMax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">minmax_energy</span><span class="p">()</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>        
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;    =========== RCSB Disulfide Database Summary ==============&#39;</span><span class="p">)</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;       =========== Built: </span><span class="si">{</span><span class="n">timestr</span><span class="si">}</span><span class="s1"> ==============&#39;</span><span class="p">)</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PDB IDs present:                    </span><span class="si">{</span><span class="n">pdbs</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Disulfides loaded:                  </span><span class="si">{</span><span class="n">tot</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Average structure resolution:       </span><span class="si">{</span><span class="n">res</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å&#39;</span><span class="p">)</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lowest Energy Disulfide:            </span><span class="si">{</span><span class="n">ssMin</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Highest Energy Disulfide:           </span><span class="si">{</span><span class="n">ssMax</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Ca distance cutoff:                 </span><span class="si">{</span><span class="n">cutoff</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å&#39;</span><span class="p">)</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total RAM Used:                     </span><span class="si">{</span><span class="n">ram</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> GB.&#39;</span><span class="p">)</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;    ================= proteusPy: </span><span class="si">{</span><span class="n">vers</span><span class="si">}</span><span class="s1"> =======================&#39;</span><span class="p">)</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>       
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>    <span class="k">def</span> <span class="nf">display_overlay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdbid</span><span class="p">):</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>        <span class="sd">&#39;&#39;&#39; </span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a><span class="sd">        Display all disulfides for a given PDB ID overlaid in stick mode against</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a><span class="sd">        a common coordinate frame. This allows us to see all of the disulfides</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a><span class="sd">        at one time in a single view. Colors vary smoothy between bonds.</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a><span class="sd">        </span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a><span class="sd">        :param self: DisulfideLoader object initialized with the database.</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a><span class="sd">        :param pdbid: the PDB id string, e.g. 4yys</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a><span class="sd">        :return: None</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a><span class="sd">        Example:</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.Disulfide import Disulfide</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideLoader import DisulfideLoader</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideList import DisulfideList</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a><span class="sd">            </span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a><span class="sd">        Instantiate the Loader with the SS database subset.</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = DisulfideLoader(verbose=False, subset=True)</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a><span class="sd">        </span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a><span class="sd">        Display the Disulfides from the PDB ID ```4yys```, overlaid onto</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a><span class="sd">        a common reference (the proximal disulfides).</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS.display_overlay(&#39;4yys&#39;)</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a><span class="sd">        You can also slice the loader and display as an overly.</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS[:8].display_overlay()</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a><span class="sd">        &#39;&#39;&#39;</span> 
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>        <span class="n">ssbonds</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">pdbid</span><span class="p">]</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>        <span class="n">ssbonds</span><span class="o">.</span><span class="n">display_overlay</span><span class="p">()</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>        <span class="k">return</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>    
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>    
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>    <span class="k">def</span> <span class="nf">getTorsions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdbID</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a><span class="sd">        Return the torsions, distances and energies defined by Disulfide.Torsion_DF_cols</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a><span class="sd">        :param pdbID: pdbID, defaults to None, meaning return entire dataset.</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a><span class="sd">        :type pdbID: str, optional used to extract for a specific PDB structure. If not specified</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a><span class="sd">            then return the entire dataset.</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a><span class="sd">        :raises DisulfideParseWarning: Raised if not found</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a><span class="sd">        :return: Torsions Dataframe</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a><span class="sd">        :rtype: pd.DataFrame</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a><span class="sd">        Example:</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideLoader import DisulfideLoader</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = DisulfideLoader(verbose=False, subset=True)</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a><span class="sd">        &gt;&gt;&gt; Tor_DF = PDB_SS.getTorsions()</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a><span class="sd">        &gt;&gt;&gt; Tor_DF.describe()</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a><span class="sd">                  proximal       distal         chi1         chi2         chi3         chi4  ...  ca_distance     phi_prox     psi_prox     phi_dist     psi_dist  torsion_length</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a><span class="sd">        count  3393.000000  3393.000000  3393.000000  3393.000000  3393.000000  3393.000000  ...  3393.000000  3393.000000  3393.000000  3393.000000  3393.000000     3393.000000</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a><span class="sd">        mean    231.513999   280.056587   -49.134436   -15.616297    -3.727982   -31.909496  ...     5.554563   -98.491326    63.029854   -95.890117    62.408772      225.242256</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a><span class="sd">        std     292.300344   293.503989    95.456284   104.318483    93.894477   103.553641  ...     1.489138    44.275097    99.266921    44.796764    97.231632       53.309336</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a><span class="sd">        min       1.000000     6.000000  -179.947368  -179.990782  -179.081812  -179.940602  ...     2.941898  -180.000000  -180.000000  -180.000000  -180.000000      116.478788</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a><span class="sd">        25%      48.000000    96.000000   -83.281768   -88.455019   -87.763001   -95.240905  ...     5.075491  -129.605300   -26.792543  -123.131231   -25.503215      181.929048</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a><span class="sd">        50%     136.000000   194.000000   -63.878076   -59.597437   -64.977491   -69.607516  ...     5.612046   -97.569676   112.772998   -97.956322   112.956483      225.617493</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a><span class="sd">        75%     310.000000   361.000000   -47.459809    82.078365    94.169603    69.488862  ...     6.112471   -69.670087   143.781003   -70.485076   142.808862      263.003492</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a><span class="sd">        max    2592.000000  2599.000000   179.918814   179.987671   179.554652   179.977181  ...    75.611323   177.021502   179.856474   178.886602   179.735964      368.022621</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a><span class="sd">        &lt;BLANKLINE&gt;</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a><span class="sd">        [8 rows x 14 columns]</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>        <span class="n">res_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>        <span class="k">if</span> <span class="n">pdbID</span><span class="p">:</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">[</span><span class="n">pdbID</span><span class="p">]</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>                <span class="n">sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">pdbID</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>                <span class="n">res_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">[</span><span class="n">sel</span><span class="p">]</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>                <span class="k">return</span> <span class="n">res_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>                <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;! Cannot find key </span><span class="si">{</span><span class="n">pdbID</span><span class="si">}</span><span class="s1"> in SSBond DB&#39;</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>                <span class="k">raise</span> <span class="n">DisulfideParseWarning</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>            <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">)</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>    
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>    <span class="k">def</span> <span class="nf">list_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classdict</span><span class="p">):</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Class: |</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">|, |</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1">|&#39;</span><span class="p">)</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>    <span class="nd">@property</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>    <span class="k">def</span> <span class="nf">quiet</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a><span class="sd">        The loader quiet state</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a><span class="sd">        :return: quiet parameter</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a><span class="sd">        :rtype: bool</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">QUIET</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>    <span class="nd">@quiet</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>    <span class="k">def</span> <span class="nf">quiet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">perm</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a><span class="sd">        Sets the quiet attribute for the loader. This silences many of the BIO.PDB warnings.</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a><span class="sd">        :param perm: True or False</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a><span class="sd">        :type perm: bool</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">QUIET</span> <span class="o">=</span> <span class="n">perm</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>    
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">savepath</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">):</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a><span class="sd">        Save a copy of the fully instantiated Loader to the specified file.</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a><span class="sd">        :param savepath: Path to save the file, defaults to DATA_DIR</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a><span class="sd">        :param fname: Filename, defaults to LOADER_FNAME</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a><span class="sd">        :param verbose: Verbosity, defaults to False</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a><span class="sd">        :param cutoff: Distance cutoff used to build the database, -1 means no cutoff.</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">=</span> <span class="n">cutoff</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>        <span class="k">if</span> <span class="n">subset</span><span class="p">:</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>            <span class="n">fname</span> <span class="o">=</span> <span class="n">LOADER_SUBSET_FNAME</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>            <span class="n">fname</span> <span class="o">=</span> <span class="n">LOADER_FNAME</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>        <span class="n">_fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">savepath</span><span class="si">}{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; DisulfideLoader.save(): Writing </span><span class="si">{</span><span class="n">_fname</span><span class="si">}</span><span class="s1">... &#39;</span><span class="p">)</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>        
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">_fname</span><span class="p">,</span> <span class="s1">&#39;wb+&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>        
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; DisulfideLoader.save(): Done.&#39;</span><span class="p">)</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>    
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>    <span class="k">def</span> <span class="nf">from_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a><span class="sd">        Return a list of disulfides corresponding to the input class ID</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a><span class="sd">        string.</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a><span class="sd">        :param classid: Class ID, e.g. &#39;+RHStaple&#39;</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a><span class="sd">        :return: DisulfideList of class members</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>        <span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>        <span class="kn">from</span> <span class="nn">proteusPy.ProteusGlobals</span> <span class="kn">import</span> <span class="n">PBAR_COLS</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="n">classid</span><span class="p">)</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>            <span class="n">sslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span><span class="p">[</span><span class="n">classid</span><span class="p">]</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>                <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">sslist</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">PBAR_COLS</span><span class="p">)</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>                <span class="k">for</span> <span class="n">ssid</span> <span class="ow">in</span> <span class="n">pbar</span><span class="p">:</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ssid</span><span class="p">])</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>                <span class="k">return</span> <span class="n">res</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([</span><span class="bp">self</span><span class="p">[</span><span class="n">ssid</span><span class="p">]</span> <span class="k">for</span> <span class="n">ssid</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">],</span> <span class="n">classid</span><span class="p">)</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>            <span class="k">return</span> <span class="n">res</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No class: </span><span class="si">{</span><span class="n">classid</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a>        <span class="k">return</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>  
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a><span class="c1"># class ends</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a><span class="k">class</span> <span class="nc">DisulfideClass_Constructor</span><span class="p">():</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>    <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a><span class="sd">    Class manages structural classes for the disulfide bonds contained</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a><span class="sd">    in the proteusPy disulfide database</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bootstrap</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdf</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>        <span class="k">if</span> <span class="n">bootstrap</span><span class="p">:</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; DisulfideClass_Constructor(): Building SS classes...&#39;</span><span class="p">)</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">build_yourself</span><span class="p">()</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_class_dict</span><span class="p">()</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a>    <span class="k">def</span> <span class="nf">load_class_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}{</span><span class="n">SS_CLASS_DICT_FILE</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a>            <span class="c1">#res = pickle.load(f)</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>    
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>    <span class="k">def</span> <span class="nf">build_class_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_df</span><span class="p">,</span> <span class="n">group_df</span><span class="p">):</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a>        <span class="n">ss_id_col</span> <span class="o">=</span> <span class="n">group_df</span><span class="p">[</span><span class="s1">&#39;ss_id&#39;</span><span class="p">]</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>        <span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">class_df</span><span class="p">,</span> <span class="n">ss_id_col</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>        <span class="k">return</span> <span class="n">result_df</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a>    <span class="k">def</span> <span class="nf">list_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classdict</span><span class="p">):</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Class: |</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">|, |</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1">|&#39;</span><span class="p">)</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>    <span class="c1">#  class_cols = [&#39;Idx&#39;,&#39;chi1_s&#39;,&#39;chi2_s&#39;,&#39;chi3_s&#39;,&#39;chi4_s&#39;,&#39;chi5_s&#39;,&#39;class_id&#39;,&#39;SS_Classname&#39;,&#39;FXN&#39;,</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a>    <span class="c1"># &#39;count&#39;,&#39;incidence&#39;,&#39;percentage&#39;,&#39;ca_distance_mean&#39;,</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a>    <span class="c1"># &#39;ca_distance_std&#39;,&#39;torsion_length_mean&#39;,&#39;torsion_length_std&#39;,&#39;energy_mean&#39;,&#39;energy_std&#39;]</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a>    <span class="k">def</span> <span class="nf">concat_dataframes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">):</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a><span class="sd">        Concatenates columns from one data frame into the other </span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a><span class="sd">        and returns the new result.</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a><span class="sd">        Parameters</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a><span class="sd">        ----------</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a><span class="sd">        df1 : pandas.DataFrame</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a><span class="sd">            The first data frame.</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a><span class="sd">        df2 : pandas.DataFrame</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a><span class="sd">            The second data frame.</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a><span class="sd">        Returns</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a><span class="sd">        -------</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a><span class="sd">        pandas.DataFrame</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a><span class="sd">            The concatenated data frame.</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a>        <span class="c1"># Merge the data frames based on the &#39;SS_Classname&#39; column</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;class_id&#39;</span><span class="p">)</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a>    <span class="k">def</span> <span class="nf">build_yourself</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a><span class="sd">        Builds the internal dictionary mapping the disulfide class names to their respective members.</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a><span class="sd">        The classnames are defined by the sign of the dihedral angles, per XXX&#39;, the list of SS within</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a><span class="sd">        the database classified, and the resulting dict created.</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a>        <span class="k">def</span> <span class="nf">ss_id_dict</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a>            <span class="n">ss_id_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SS_Classname&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ss_id&#39;</span><span class="p">]))</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a>            <span class="k">return</span> <span class="n">ss_id_dict</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a>        <span class="n">PDB_SS</span> <span class="o">=</span> <span class="n">Load_PDB_SS</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a>            <span class="n">PDB_SS</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a>
</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a>        <span class="n">tors_df</span> <span class="o">=</span> <span class="n">PDB_SS</span><span class="o">.</span><span class="n">getTorsions</span><span class="p">()</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a>
</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; DisulfideClass_Constructor(): creating SS classes...&#39;</span><span class="p">)</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a>
</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">create_classes</span><span class="p">(</span><span class="n">tors_df</span><span class="p">)</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">class_df</span> <span class="o">=</span> <span class="n">grouped</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a>
</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a>        <span class="n">grouped</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s1">PDB_ss_classes.csv&#39;</span><span class="p">)</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">grouped</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a>
</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a>        <span class="c1">#grouped_summary = grouped.drop(columns=[&#39;ss_id&#39;], axis=1)</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a>        <span class="c1">#grouped_summary.to_csv(f&#39;{DATA_DIR}PDB_ss_classes_summary.csv&#39;)</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a>        
</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a>        <span class="c1"># this file is hand made. Do not change it. -egs-</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a>        <span class="c1">#class_df = pd.read_csv(f&#39;{DATA_DIR}PDB_ss_classes_master2.csv&#39;, dtype={&#39;class_id&#39;: &#39;string&#39;, &#39;FXN&#39;: &#39;string&#39;, &#39;SS_Classname&#39;: &#39;string&#39;})</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a>
</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a>        <span class="c1"># !!! df = pd.read_csv(pd.compat.StringIO(csv_string))</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a>        <span class="c1"># class_df = pd.read_csv(f&#39;{DATA_DIR}PDB_SS_class_definitions.csv&#39;, dtype={&#39;class_id&#39;: &#39;string&#39;, &#39;FXN&#39;: &#39;string&#39;, &#39;SS_Classname&#39;: &#39;string&#39;})</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a>        
</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a>        <span class="n">class_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">SS_CLASS_DEFINITIONS</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class_id&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;FXN&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;SS_Classname&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">})</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s1">&#39;FXN&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s1">&#39;SS_Classname&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s1">&#39;class_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a>
</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; DisulfideClass_Constructor(): merging...&#39;</span><span class="p">)</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a>
</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a>        <span class="n">merged</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">concat_dataframes</span><span class="p">(</span><span class="n">class_df</span><span class="p">,</span> <span class="n">grouped</span><span class="p">)</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a>        <span class="c1">#merged = self.build_class_df(class_df, grouped)</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a>        <span class="n">merged</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Idx&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos">661</span></a>
</span><span id="L-662"><a href="#L-662"><span class="linenos">662</span></a>        <span class="n">classdict</span> <span class="o">=</span> <span class="n">ss_id_dict</span><span class="p">(</span><span class="n">merged</span><span class="p">)</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos">663</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span> <span class="o">=</span> <span class="n">classdict</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos">664</span></a>
</span><span id="L-665"><a href="#L-665"><span class="linenos">665</span></a>        <span class="n">merged</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s1">PDB_SS_merged.csv&#39;</span><span class="p">)</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos">666</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdf</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos">667</span></a>
</span><span id="L-668"><a href="#L-668"><span class="linenos">668</span></a>        <span class="n">fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}{</span><span class="n">SS_CLASS_DICT_FILE</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos">669</span></a>
</span><span id="L-670"><a href="#L-670"><span class="linenos">670</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos">671</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; DisulfideClass_Constructor(): writing </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">)</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos">672</span></a>
</span><span id="L-673"><a href="#L-673"><span class="linenos">673</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;wb+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos">674</span></a>            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">classdict</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos">675</span></a>
</span><span id="L-676"><a href="#L-676"><span class="linenos">676</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos">677</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; DisulfideClass_Constructor(): initialization complete.&#39;</span><span class="p">)</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos">678</span></a>        
</span><span id="L-679"><a href="#L-679"><span class="linenos">679</span></a>        <span class="k">return</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos">680</span></a>
</span><span id="L-681"><a href="#L-681"><span class="linenos">681</span></a><span class="c1"># class definition ends</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos">682</span></a>
</span><span id="L-683"><a href="#L-683"><span class="linenos">683</span></a><span class="k">def</span> <span class="nf">create_classes</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos">684</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos">685</span></a><span class="sd">    Group the DataFrame by the sign of the chi columns and create a new class ID column for each unique grouping.</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos">686</span></a>
</span><span id="L-687"><a href="#L-687"><span class="linenos">687</span></a><span class="sd">    :param df: A pandas DataFrame containing columns &#39;ss_id&#39;, &#39;chi1&#39;, &#39;chi2&#39;, &#39;chi3&#39;, &#39;chi4&#39;, &#39;chi5&#39;, &#39;ca_distance&#39;, &#39;cb_distance&#39;, &#39;torsion_length&#39;, and &#39;energy&#39;.</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos">688</span></a><span class="sd">    :return: A pandas DataFrame containing columns &#39;class_id&#39;, &#39;ss_id&#39;, and &#39;count&#39;, where &#39;class_id&#39; is a unique identifier for each grouping of chi signs, &#39;ss_id&#39; is a list of all &#39;ss_id&#39; values in that grouping, and &#39;count&#39; is the number of rows in that grouping.</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos">689</span></a><span class="sd">    </span>
</span><span id="L-690"><a href="#L-690"><span class="linenos">690</span></a><span class="sd">    Example:</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos">691</span></a><span class="sd">    &gt;&gt;&gt; import pandas as pd</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos">692</span></a><span class="sd">    &gt;&gt;&gt; df = pd.DataFrame({</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos">693</span></a><span class="sd">    ...    &#39;ss_id&#39;: [1, 2, 3, 4, 5],</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos">694</span></a><span class="sd">    ...    &#39;chi1&#39;: [1.0, -1.0, 1.0, 1.0, -1.0],</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos">695</span></a><span class="sd">    ...    &#39;chi2&#39;: [-1.0, -1.0, -1.0, 1.0, 1.0],</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos">696</span></a><span class="sd">    ...    &#39;chi3&#39;: [-1.0, 1.0, -1.0, 1.0, -1.0],</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos">697</span></a><span class="sd">    ...    &#39;chi4&#39;: [1.0, -1.0, 1.0, -1.0, 1.0],</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos">698</span></a><span class="sd">    ...    &#39;chi5&#39;: [1.0, -1.0, -1.0, -1.0, -1.0],</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos">699</span></a><span class="sd">    ...    &#39;ca_distance&#39;: [3.1, 3.2, 3.3, 3.4, 3.5],</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos">700</span></a><span class="sd">    ...    &#39;cb_distance&#39;: [3.1, 3.2, 3.3, 3.4, 3.5],</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos">701</span></a><span class="sd">    ...    &#39;torsion_length&#39;: [120.1, 120.2, 120.3, 120.4, 121.0],</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos">702</span></a><span class="sd">    ...    &#39;energy&#39;: [-2.3, -2.2, -2.1, -2.0, -1.9]</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos">703</span></a><span class="sd">    ... })</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos">704</span></a><span class="sd">    &gt;&gt;&gt; create_classes(df)</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos">705</span></a><span class="sd">      class_id ss_id  count  incidence  percentage</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos">706</span></a><span class="sd">    0    00200   [2]      1        0.2        20.0</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos">707</span></a><span class="sd">    1    02020   [5]      1        0.2        20.0</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos">708</span></a><span class="sd">    2    20020   [3]      1        0.2        20.0</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos">709</span></a><span class="sd">    3    20022   [1]      1        0.2        20.0</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos">710</span></a><span class="sd">    4    22200   [4]      1        0.2        20.0</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos">711</span></a>
</span><span id="L-712"><a href="#L-712"><span class="linenos">712</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos">713</span></a>    <span class="c1"># Create new columns with the sign of each chi column</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos">714</span></a>    <span class="n">chi_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;chi1&#39;</span><span class="p">,</span> <span class="s1">&#39;chi2&#39;</span><span class="p">,</span> <span class="s1">&#39;chi3&#39;</span><span class="p">,</span> <span class="s1">&#39;chi4&#39;</span><span class="p">,</span> <span class="s1">&#39;chi5&#39;</span><span class="p">]</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos">715</span></a>    <span class="n">sign_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="o">+</span> <span class="s1">&#39;_s&#39;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">chi_columns</span><span class="p">]</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos">716</span></a>    <span class="n">df</span><span class="p">[</span><span class="n">sign_columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">chi_columns</span><span class="p">]</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos">717</span></a>    
</span><span id="L-718"><a href="#L-718"><span class="linenos">718</span></a>    <span class="c1"># Create a new column with the class ID for each row</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos">719</span></a>    <span class="n">class_id_column</span> <span class="o">=</span> <span class="s1">&#39;class_id&#39;</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos">720</span></a>    <span class="n">df</span><span class="p">[</span><span class="n">class_id_column</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">sign_columns</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos">721</span></a>
</span><span id="L-722"><a href="#L-722"><span class="linenos">722</span></a>    <span class="c1"># Group the DataFrame by the class ID and return the grouped data</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos">723</span></a>    <span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">class_id_column</span><span class="p">)[</span><span class="s1">&#39;ss_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos">724</span></a>    <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;ss_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos">725</span></a>    <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;incidence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;ss_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos">726</span></a>    <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;percentage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;incidence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos">727</span></a>
</span><span id="L-728"><a href="#L-728"><span class="linenos">728</span></a>    <span class="k">return</span> <span class="n">grouped</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos">729</span></a>
</span><span id="L-730"><a href="#L-730"><span class="linenos">730</span></a><span class="k">def</span> <span class="nf">Load_PDB_SS</span><span class="p">(</span><span class="n">loadpath</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideLoader</span><span class="p">:</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos">731</span></a>    <span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos">732</span></a><span class="sd">    Load the fully instantiated Disulfide database from the specified file. Use the</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos">733</span></a><span class="sd">    defaults unless you are building the database by hand. *This is the function</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos">734</span></a><span class="sd">    used to load the built database.*</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos">735</span></a>
</span><span id="L-736"><a href="#L-736"><span class="linenos">736</span></a><span class="sd">    :param loadpath: Path from which to load, defaults to DATA_DIR</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos">737</span></a><span class="sd">    :param fname: Filename, defaults to LOADER_FNAME</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos">738</span></a><span class="sd">    :param verbose: Verbosity, defaults to False</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos">739</span></a><span class="sd">    :param subset: If True, load the subset DB, otherwise load the full database</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos">740</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos">741</span></a>    <span class="k">if</span> <span class="n">subset</span><span class="p">:</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos">742</span></a>        <span class="n">_fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">loadpath</span><span class="si">}{</span><span class="n">LOADER_SUBSET_FNAME</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos">743</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos">744</span></a>        <span class="n">_fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">loadpath</span><span class="si">}{</span><span class="n">LOADER_FNAME</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos">745</span></a>
</span><span id="L-746"><a href="#L-746"><span class="linenos">746</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos">747</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; load_PDB_SS(): Reading </span><span class="si">{</span><span class="n">_fname</span><span class="si">}</span><span class="s1">... &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos">748</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos">749</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">_fname</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos">750</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos">751</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos">752</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;done.&#39;</span><span class="p">)</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos">753</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos">754</span></a>    <span class="k">except</span><span class="p">:</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos">755</span></a>        <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;-&gt; load_PDB_SS(): cannot open file </span><span class="si">{</span><span class="n">_fname</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos">756</span></a>        <span class="k">raise</span> <span class="n">DisulfideIOException</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos">757</span></a>
</span><span id="L-758"><a href="#L-758"><span class="linenos">758</span></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos">759</span></a>    <span class="kn">import</span> <span class="nn">doctest</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos">760</span></a>    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">()</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos">761</span></a>
</span><span id="L-762"><a href="#L-762"><span class="linenos">762</span></a><span class="c1"># end of file</span>
</span></pre></div>


            </section>
                <section id="DisulfideLoader">
                            <input id="DisulfideLoader-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DisulfideLoader</span>:

                <label class="view-source-button" for="DisulfideLoader-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader-42"><a href="#DisulfideLoader-42"><span class="linenos"> 42</span></a><span class="k">class</span> <span class="nc">DisulfideLoader</span><span class="p">:</span>
</span><span id="DisulfideLoader-43"><a href="#DisulfideLoader-43"><span class="linenos"> 43</span></a>    <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-44"><a href="#DisulfideLoader-44"><span class="linenos"> 44</span></a><span class="sd">    This class represents the disulfide database itself and is its primary means of accession. </span>
</span><span id="DisulfideLoader-45"><a href="#DisulfideLoader-45"><span class="linenos"> 45</span></a><span class="sd">    The entirety of the RCSB disulfide database is stored within the class via a</span>
</span><span id="DisulfideLoader-46"><a href="#DisulfideLoader-46"><span class="linenos"> 46</span></a><span class="sd">    proteusPy.DisulfideList.DisulfideList, a ```Pandas``` .csv file, and a ```dict``` of</span>
</span><span id="DisulfideLoader-47"><a href="#DisulfideLoader-47"><span class="linenos"> 47</span></a><span class="sd">    indices mapping the PDB IDs into their respective list of disulfides. The datastructures allow</span>
</span><span id="DisulfideLoader-48"><a href="#DisulfideLoader-48"><span class="linenos"> 48</span></a><span class="sd">    simple, direct and flexible access to the disulfide structures contained herein. </span>
</span><span id="DisulfideLoader-49"><a href="#DisulfideLoader-49"><span class="linenos"> 49</span></a><span class="sd">    This makes it possible to access the disulfides by array index, PDB structure ID or disulfide name.</span>
</span><span id="DisulfideLoader-50"><a href="#DisulfideLoader-50"><span class="linenos"> 50</span></a><span class="sd">    </span>
</span><span id="DisulfideLoader-51"><a href="#DisulfideLoader-51"><span class="linenos"> 51</span></a><span class="sd">    The class can also render Disulfides overlaid on a common coordinate system to a pyVista window using the </span>
</span><span id="DisulfideLoader-52"><a href="#DisulfideLoader-52"><span class="linenos"> 52</span></a><span class="sd">    [display_overlay()](#DisulfideLoader.display_overlay) method. See below for examples.\n</span>
</span><span id="DisulfideLoader-53"><a href="#DisulfideLoader-53"><span class="linenos"> 53</span></a>
</span><span id="DisulfideLoader-54"><a href="#DisulfideLoader-54"><span class="linenos"> 54</span></a><span class="sd">    Important note: For typical usage one will access the database via the `Load_PDB_SS()` function.</span>
</span><span id="DisulfideLoader-55"><a href="#DisulfideLoader-55"><span class="linenos"> 55</span></a><span class="sd">    The difference is that the latter function loads the compressed database from its single</span>
</span><span id="DisulfideLoader-56"><a href="#DisulfideLoader-56"><span class="linenos"> 56</span></a><span class="sd">    source. the `Load_PDB_SS()` function will load the individual torsions and disulfide .pkl,</span>
</span><span id="DisulfideLoader-57"><a href="#DisulfideLoader-57"><span class="linenos"> 57</span></a><span class="sd">    builds the classlist structures.</span>
</span><span id="DisulfideLoader-58"><a href="#DisulfideLoader-58"><span class="linenos"> 58</span></a><span class="sd">    </span>
</span><span id="DisulfideLoader-59"><a href="#DisulfideLoader-59"><span class="linenos"> 59</span></a><span class="sd">    *Developer&#39;s Notes:*</span>
</span><span id="DisulfideLoader-60"><a href="#DisulfideLoader-60"><span class="linenos"> 60</span></a><span class="sd">    The .pkl files needed to instantiate this class and save it into its final .pkl file are</span>
</span><span id="DisulfideLoader-61"><a href="#DisulfideLoader-61"><span class="linenos"> 61</span></a><span class="sd">    defined in the proteusPy.data class and should not be changed. Upon initialization the class</span>
</span><span id="DisulfideLoader-62"><a href="#DisulfideLoader-62"><span class="linenos"> 62</span></a><span class="sd">    will load them and initialize itself. </span>
</span><span id="DisulfideLoader-63"><a href="#DisulfideLoader-63"><span class="linenos"> 63</span></a>
</span><span id="DisulfideLoader-64"><a href="#DisulfideLoader-64"><span class="linenos"> 64</span></a><span class="sd">    Example:</span>
</span><span id="DisulfideLoader-65"><a href="#DisulfideLoader-65"><span class="linenos"> 65</span></a><span class="sd">    &gt;&gt;&gt; import proteusPy</span>
</span><span id="DisulfideLoader-66"><a href="#DisulfideLoader-66"><span class="linenos"> 66</span></a><span class="sd">    &gt;&gt;&gt; from proteusPy.Disulfide import Disulfide</span>
</span><span id="DisulfideLoader-67"><a href="#DisulfideLoader-67"><span class="linenos"> 67</span></a><span class="sd">    &gt;&gt;&gt; from proteusPy.DisulfideLoader import DisulfideLoader</span>
</span><span id="DisulfideLoader-68"><a href="#DisulfideLoader-68"><span class="linenos"> 68</span></a><span class="sd">    &gt;&gt;&gt; from proteusPy.DisulfideList import DisulfideList</span>
</span><span id="DisulfideLoader-69"><a href="#DisulfideLoader-69"><span class="linenos"> 69</span></a><span class="sd">    &gt;&gt;&gt; SS1 = DisulfideList([],&#39;tmp1&#39;)</span>
</span><span id="DisulfideLoader-70"><a href="#DisulfideLoader-70"><span class="linenos"> 70</span></a><span class="sd">    &gt;&gt;&gt; SS2 = DisulfideList([],&#39;tmp2&#39;)</span>
</span><span id="DisulfideLoader-71"><a href="#DisulfideLoader-71"><span class="linenos"> 71</span></a><span class="sd">    </span>
</span><span id="DisulfideLoader-72"><a href="#DisulfideLoader-72"><span class="linenos"> 72</span></a><span class="sd">    &gt;&gt;&gt; PDB_SS = DisulfideLoader(verbose=False, subset=True)</span>
</span><span id="DisulfideLoader-73"><a href="#DisulfideLoader-73"><span class="linenos"> 73</span></a>
</span><span id="DisulfideLoader-74"><a href="#DisulfideLoader-74"><span class="linenos"> 74</span></a><span class="sd">    Accessing by index value:</span>
</span><span id="DisulfideLoader-75"><a href="#DisulfideLoader-75"><span class="linenos"> 75</span></a><span class="sd">    &gt;&gt;&gt; SS1 = PDB_SS[0]</span>
</span><span id="DisulfideLoader-76"><a href="#DisulfideLoader-76"><span class="linenos"> 76</span></a><span class="sd">    &gt;&gt;&gt; SS1</span>
</span><span id="DisulfideLoader-77"><a href="#DisulfideLoader-77"><span class="linenos"> 77</span></a><span class="sd">    &lt;Disulfide 4yys_22A_65A, Source: 4yys, Resolution: 1.35 Å&gt;</span>
</span><span id="DisulfideLoader-78"><a href="#DisulfideLoader-78"><span class="linenos"> 78</span></a><span class="sd">    </span>
</span><span id="DisulfideLoader-79"><a href="#DisulfideLoader-79"><span class="linenos"> 79</span></a><span class="sd">    Accessing by PDB_ID returns a list of Disulfides:</span>
</span><span id="DisulfideLoader-80"><a href="#DisulfideLoader-80"><span class="linenos"> 80</span></a><span class="sd">    &gt;&gt;&gt; SS2 = PDB_SS[&#39;4yys&#39;]</span>
</span><span id="DisulfideLoader-81"><a href="#DisulfideLoader-81"><span class="linenos"> 81</span></a><span class="sd">    &gt;&gt;&gt; SS2</span>
</span><span id="DisulfideLoader-82"><a href="#DisulfideLoader-82"><span class="linenos"> 82</span></a><span class="sd">    [&lt;Disulfide 4yys_22A_65A, Source: 4yys, Resolution: 1.35 Å&gt;, &lt;Disulfide 4yys_56A_98A, Source: 4yys, Resolution: 1.35 Å&gt;, &lt;Disulfide 4yys_156A_207A, Source: 4yys, Resolution: 1.35 Å&gt;]</span>
</span><span id="DisulfideLoader-83"><a href="#DisulfideLoader-83"><span class="linenos"> 83</span></a><span class="sd">    </span>
</span><span id="DisulfideLoader-84"><a href="#DisulfideLoader-84"><span class="linenos"> 84</span></a><span class="sd">    Accessing individual disulfides by their name:</span>
</span><span id="DisulfideLoader-85"><a href="#DisulfideLoader-85"><span class="linenos"> 85</span></a><span class="sd">    &gt;&gt;&gt; SS3 = PDB_SS[&#39;4yys_56A_98A&#39;]</span>
</span><span id="DisulfideLoader-86"><a href="#DisulfideLoader-86"><span class="linenos"> 86</span></a><span class="sd">    &gt;&gt;&gt; SS3</span>
</span><span id="DisulfideLoader-87"><a href="#DisulfideLoader-87"><span class="linenos"> 87</span></a><span class="sd">    &lt;Disulfide 4yys_56A_98A, Source: 4yys, Resolution: 1.35 Å&gt;</span>
</span><span id="DisulfideLoader-88"><a href="#DisulfideLoader-88"><span class="linenos"> 88</span></a><span class="sd">    </span>
</span><span id="DisulfideLoader-89"><a href="#DisulfideLoader-89"><span class="linenos"> 89</span></a><span class="sd">    Finally, we can access disulfides by regular slicing:</span>
</span><span id="DisulfideLoader-90"><a href="#DisulfideLoader-90"><span class="linenos"> 90</span></a><span class="sd">    &gt;&gt;&gt; SSlist = PDB_SS[:4]</span>
</span><span id="DisulfideLoader-91"><a href="#DisulfideLoader-91"><span class="linenos"> 91</span></a><span class="sd">    &gt;&gt;&gt; SSlist.display(style=&#39;sb&#39;) </span>
</span><span id="DisulfideLoader-92"><a href="#DisulfideLoader-92"><span class="linenos"> 92</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-93"><a href="#DisulfideLoader-93"><span class="linenos"> 93</span></a>
</span><span id="DisulfideLoader-94"><a href="#DisulfideLoader-94"><span class="linenos"> 94</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">datadir</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="n">picklefile</span><span class="o">=</span><span class="n">SS_PICKLE_FILE</span><span class="p">,</span> 
</span><span id="DisulfideLoader-95"><a href="#DisulfideLoader-95"><span class="linenos"> 95</span></a>                <span class="n">pickle_dict_file</span><span class="o">=</span><span class="n">SS_DICT_PICKLE_FILE</span><span class="p">,</span>
</span><span id="DisulfideLoader-96"><a href="#DisulfideLoader-96"><span class="linenos"> 96</span></a>                <span class="n">torsion_file</span><span class="o">=</span><span class="n">SS_TORSIONS_FILE</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
</span><span id="DisulfideLoader-97"><a href="#DisulfideLoader-97"><span class="linenos"> 97</span></a>                <span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader-98"><a href="#DisulfideLoader-98"><span class="linenos"> 98</span></a>                <span class="n">cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">):</span>
</span><span id="DisulfideLoader-99"><a href="#DisulfideLoader-99"><span class="linenos"> 99</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-100"><a href="#DisulfideLoader-100"><span class="linenos">100</span></a><span class="sd">        Initializing the class initiates loading either the entire Disulfide dataset,</span>
</span><span id="DisulfideLoader-101"><a href="#DisulfideLoader-101"><span class="linenos">101</span></a><span class="sd">        or the &#39;subset&#39;, which consists of the first 1000 PDB structures. The subset</span>
</span><span id="DisulfideLoader-102"><a href="#DisulfideLoader-102"><span class="linenos">102</span></a><span class="sd">        is useful for testing and debugging since it doesn&#39;t require nearly as much</span>
</span><span id="DisulfideLoader-103"><a href="#DisulfideLoader-103"><span class="linenos">103</span></a><span class="sd">        memory or time. The name for the subset file is hard-coded. One can pass a</span>
</span><span id="DisulfideLoader-104"><a href="#DisulfideLoader-104"><span class="linenos">104</span></a><span class="sd">        different data directory and file names for the pickle files. These different</span>
</span><span id="DisulfideLoader-105"><a href="#DisulfideLoader-105"><span class="linenos">105</span></a><span class="sd">        directories are normally established with the proteusPy.Disulfide.Extract_Disulfides </span>
</span><span id="DisulfideLoader-106"><a href="#DisulfideLoader-106"><span class="linenos">106</span></a><span class="sd">        function.</span>
</span><span id="DisulfideLoader-107"><a href="#DisulfideLoader-107"><span class="linenos">107</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-108"><a href="#DisulfideLoader-108"><span class="linenos">108</span></a>
</span><span id="DisulfideLoader-109"><a href="#DisulfideLoader-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ModelDir</span> <span class="o">=</span> <span class="n">datadir</span>
</span><span id="DisulfideLoader-110"><a href="#DisulfideLoader-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">picklefile</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="DisulfideLoader-111"><a href="#DisulfideLoader-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">PickleDictFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">pickle_dict_file</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="DisulfideLoader-112"><a href="#DisulfideLoader-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">PickleClassFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">SS_CLASS_DICT_FILE</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="DisulfideLoader-113"><a href="#DisulfideLoader-113"><span class="linenos">113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">TorsionFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">torsion_file</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="DisulfideLoader-114"><a href="#DisulfideLoader-114"><span class="linenos">114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s1">&#39;ALL_PDB_SS&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-115"><a href="#DisulfideLoader-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideLoader-116"><a href="#DisulfideLoader-116"><span class="linenos">116</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="DisulfideLoader-117"><a href="#DisulfideLoader-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DisulfideLoader-118"><a href="#DisulfideLoader-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">IDList</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DisulfideLoader-119"><a href="#DisulfideLoader-119"><span class="linenos">119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">QUIET</span> <span class="o">=</span> <span class="n">quiet</span>
</span><span id="DisulfideLoader-120"><a href="#DisulfideLoader-120"><span class="linenos">120</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideLoader-121"><a href="#DisulfideLoader-121"><span class="linenos">121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdf</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideLoader-122"><a href="#DisulfideLoader-122"><span class="linenos">122</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">=</span> <span class="n">cutoff</span>
</span><span id="DisulfideLoader-123"><a href="#DisulfideLoader-123"><span class="linenos">123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="DisulfideLoader-124"><a href="#DisulfideLoader-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="DisulfideLoader-125"><a href="#DisulfideLoader-125"><span class="linenos">125</span></a>
</span><span id="DisulfideLoader-126"><a href="#DisulfideLoader-126"><span class="linenos">126</span></a>        <span class="n">idlist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DisulfideLoader-127"><a href="#DisulfideLoader-127"><span class="linenos">127</span></a>
</span><span id="DisulfideLoader-128"><a href="#DisulfideLoader-128"><span class="linenos">128</span></a>        <span class="k">if</span> <span class="n">subset</span><span class="p">:</span>
</span><span id="DisulfideLoader-129"><a href="#DisulfideLoader-129"><span class="linenos">129</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">SS_SUBSET_PICKLE_FILE</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="DisulfideLoader-130"><a href="#DisulfideLoader-130"><span class="linenos">130</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">PickleDictFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">SS_SUBSET_DICT_PICKLE_FILE</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="DisulfideLoader-131"><a href="#DisulfideLoader-131"><span class="linenos">131</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">TorsionFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">SS_SUBSET_TORSIONS_FILE</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="DisulfideLoader-132"><a href="#DisulfideLoader-132"><span class="linenos">132</span></a>        
</span><span id="DisulfideLoader-133"><a href="#DisulfideLoader-133"><span class="linenos">133</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader-134"><a href="#DisulfideLoader-134"><span class="linenos">134</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; DisulfideLoader(): Reading disulfides from: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="si">}</span><span class="s1">... &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-135"><a href="#DisulfideLoader-135"><span class="linenos">135</span></a>        
</span><span id="DisulfideLoader-136"><a href="#DisulfideLoader-136"><span class="linenos">136</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="DisulfideLoader-137"><a href="#DisulfideLoader-137"><span class="linenos">137</span></a>            <span class="n">sslist</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="DisulfideLoader-138"><a href="#DisulfideLoader-138"><span class="linenos">138</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span> <span class="o">=</span> <span class="n">sslist</span>
</span><span id="DisulfideLoader-139"><a href="#DisulfideLoader-139"><span class="linenos">139</span></a>
</span><span id="DisulfideLoader-140"><a href="#DisulfideLoader-140"><span class="linenos">140</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader-141"><a href="#DisulfideLoader-141"><span class="linenos">141</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;done.&#39;</span><span class="p">,)</span>
</span><span id="DisulfideLoader-142"><a href="#DisulfideLoader-142"><span class="linenos">142</span></a>
</span><span id="DisulfideLoader-143"><a href="#DisulfideLoader-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">)</span>
</span><span id="DisulfideLoader-144"><a href="#DisulfideLoader-144"><span class="linenos">144</span></a>        
</span><span id="DisulfideLoader-145"><a href="#DisulfideLoader-145"><span class="linenos">145</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader-146"><a href="#DisulfideLoader-146"><span class="linenos">146</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; DisulfideLoader(): Reading disulfide dict2 from: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleDictFile</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-147"><a href="#DisulfideLoader-147"><span class="linenos">147</span></a>        
</span><span id="DisulfideLoader-148"><a href="#DisulfideLoader-148"><span class="linenos">148</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleDictFile</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="DisulfideLoader-149"><a href="#DisulfideLoader-149"><span class="linenos">149</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="DisulfideLoader-150"><a href="#DisulfideLoader-150"><span class="linenos">150</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">:</span>
</span><span id="DisulfideLoader-151"><a href="#DisulfideLoader-151"><span class="linenos">151</span></a>                <span class="n">idlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="DisulfideLoader-152"><a href="#DisulfideLoader-152"><span class="linenos">152</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">IDList</span> <span class="o">=</span> <span class="n">idlist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DisulfideLoader-153"><a href="#DisulfideLoader-153"><span class="linenos">153</span></a>            <span class="n">totalSS_dict</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IDList</span><span class="p">)</span>
</span><span id="DisulfideLoader-154"><a href="#DisulfideLoader-154"><span class="linenos">154</span></a>
</span><span id="DisulfideLoader-155"><a href="#DisulfideLoader-155"><span class="linenos">155</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader-156"><a href="#DisulfideLoader-156"><span class="linenos">156</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;done.&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-157"><a href="#DisulfideLoader-157"><span class="linenos">157</span></a>
</span><span id="DisulfideLoader-158"><a href="#DisulfideLoader-158"><span class="linenos">158</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader-159"><a href="#DisulfideLoader-159"><span class="linenos">159</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; DisulfideLoader(): Reading Torsion DF from: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">TorsionFile</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-160"><a href="#DisulfideLoader-160"><span class="linenos">160</span></a>
</span><span id="DisulfideLoader-161"><a href="#DisulfideLoader-161"><span class="linenos">161</span></a>        <span class="n">tmpDF</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TorsionFile</span><span class="p">)</span>
</span><span id="DisulfideLoader-162"><a href="#DisulfideLoader-162"><span class="linenos">162</span></a>        <span class="n">tmpDF</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">tmpDF</span><span class="o">.</span><span class="n">columns</span><span class="p">[[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DisulfideLoader-163"><a href="#DisulfideLoader-163"><span class="linenos">163</span></a>
</span><span id="DisulfideLoader-164"><a href="#DisulfideLoader-164"><span class="linenos">164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span> <span class="o">=</span> <span class="n">tmpDF</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DisulfideLoader-165"><a href="#DisulfideLoader-165"><span class="linenos">165</span></a>
</span><span id="DisulfideLoader-166"><a href="#DisulfideLoader-166"><span class="linenos">166</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader-167"><a href="#DisulfideLoader-167"><span class="linenos">167</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; done.&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-168"><a href="#DisulfideLoader-168"><span class="linenos">168</span></a>
</span><span id="DisulfideLoader-169"><a href="#DisulfideLoader-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_classes</span><span class="p">()</span>
</span><span id="DisulfideLoader-170"><a href="#DisulfideLoader-170"><span class="linenos">170</span></a>
</span><span id="DisulfideLoader-171"><a href="#DisulfideLoader-171"><span class="linenos">171</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>    
</span><span id="DisulfideLoader-172"><a href="#DisulfideLoader-172"><span class="linenos">172</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; DisulfideLoader(): Loading complete.&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-173"><a href="#DisulfideLoader-173"><span class="linenos">173</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</span><span id="DisulfideLoader-174"><a href="#DisulfideLoader-174"><span class="linenos">174</span></a>        <span class="k">return</span>
</span><span id="DisulfideLoader-175"><a href="#DisulfideLoader-175"><span class="linenos">175</span></a>
</span><span id="DisulfideLoader-176"><a href="#DisulfideLoader-176"><span class="linenos">176</span></a>    <span class="c1"># </span>
</span><span id="DisulfideLoader-177"><a href="#DisulfideLoader-177"><span class="linenos">177</span></a>    <span class="c1"># overload __getitem__ to handle slicing and indexing, and access by name</span>
</span><span id="DisulfideLoader-178"><a href="#DisulfideLoader-178"><span class="linenos">178</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
</span><span id="DisulfideLoader-179"><a href="#DisulfideLoader-179"><span class="linenos">179</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s1">&#39;none&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-180"><a href="#DisulfideLoader-180"><span class="linenos">180</span></a>
</span><span id="DisulfideLoader-181"><a href="#DisulfideLoader-181"><span class="linenos">181</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
</span><span id="DisulfideLoader-182"><a href="#DisulfideLoader-182"><span class="linenos">182</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">item</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">)))</span>
</span><span id="DisulfideLoader-183"><a href="#DisulfideLoader-183"><span class="linenos">183</span></a>            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="DisulfideLoader-184"><a href="#DisulfideLoader-184"><span class="linenos">184</span></a>            <span class="n">resolution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="DisulfideLoader-185"><a href="#DisulfideLoader-185"><span class="linenos">185</span></a>            <span class="n">sublist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
</span><span id="DisulfideLoader-186"><a href="#DisulfideLoader-186"><span class="linenos">186</span></a>            <span class="k">return</span> <span class="n">DisulfideList</span><span class="p">(</span><span class="n">sublist</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">resolution</span><span class="p">)</span>
</span><span id="DisulfideLoader-187"><a href="#DisulfideLoader-187"><span class="linenos">187</span></a>        
</span><span id="DisulfideLoader-188"><a href="#DisulfideLoader-188"><span class="linenos">188</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="DisulfideLoader-189"><a href="#DisulfideLoader-189"><span class="linenos">189</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">item</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">item</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span><span class="p">):</span>
</span><span id="DisulfideLoader-190"><a href="#DisulfideLoader-190"><span class="linenos">190</span></a>                <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;DisulfideLoader(): Index </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s1"> out of range 0-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span> <span class="o">-</span> <span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="DisulfideLoader-191"><a href="#DisulfideLoader-191"><span class="linenos">191</span></a>                <span class="k">raise</span> <span class="n">DisulfideException</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
</span><span id="DisulfideLoader-192"><a href="#DisulfideLoader-192"><span class="linenos">192</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideLoader-193"><a href="#DisulfideLoader-193"><span class="linenos">193</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
</span><span id="DisulfideLoader-194"><a href="#DisulfideLoader-194"><span class="linenos">194</span></a>        
</span><span id="DisulfideLoader-195"><a href="#DisulfideLoader-195"><span class="linenos">195</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DisulfideLoader-196"><a href="#DisulfideLoader-196"><span class="linenos">196</span></a>            <span class="c1"># PDB_SS[&#39;4yys&#39;] return a list of SS</span>
</span><span id="DisulfideLoader-197"><a href="#DisulfideLoader-197"><span class="linenos">197</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
</span><span id="DisulfideLoader-198"><a href="#DisulfideLoader-198"><span class="linenos">198</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="n">item</span><span class="p">)</span>
</span><span id="DisulfideLoader-199"><a href="#DisulfideLoader-199"><span class="linenos">199</span></a>            <span class="n">sslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span>
</span><span id="DisulfideLoader-200"><a href="#DisulfideLoader-200"><span class="linenos">200</span></a>            <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
</span><span id="DisulfideLoader-201"><a href="#DisulfideLoader-201"><span class="linenos">201</span></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sslist</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
</span><span id="DisulfideLoader-202"><a href="#DisulfideLoader-202"><span class="linenos">202</span></a>            <span class="n">res</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="DisulfideLoader-203"><a href="#DisulfideLoader-203"><span class="linenos">203</span></a>
</span><span id="DisulfideLoader-204"><a href="#DisulfideLoader-204"><span class="linenos">204</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="DisulfideLoader-205"><a href="#DisulfideLoader-205"><span class="linenos">205</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="DisulfideLoader-206"><a href="#DisulfideLoader-206"><span class="linenos">206</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">get_by_name</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="c1"># full disulfide name</span>
</span><span id="DisulfideLoader-207"><a href="#DisulfideLoader-207"><span class="linenos">207</span></a>            <span class="k">except</span><span class="p">:</span> 
</span><span id="DisulfideLoader-208"><a href="#DisulfideLoader-208"><span class="linenos">208</span></a>                <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;DisulfideLoader(): Cannot find key </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s1"> in SSBond dict!&#39;</span>
</span><span id="DisulfideLoader-209"><a href="#DisulfideLoader-209"><span class="linenos">209</span></a>                <span class="k">raise</span> <span class="n">DisulfideException</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
</span><span id="DisulfideLoader-210"><a href="#DisulfideLoader-210"><span class="linenos">210</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="DisulfideLoader-211"><a href="#DisulfideLoader-211"><span class="linenos">211</span></a>    
</span><span id="DisulfideLoader-212"><a href="#DisulfideLoader-212"><span class="linenos">212</span></a>    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
</span><span id="DisulfideLoader-213"><a href="#DisulfideLoader-213"><span class="linenos">213</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_ss</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span id="DisulfideLoader-214"><a href="#DisulfideLoader-214"><span class="linenos">214</span></a>
</span><span id="DisulfideLoader-215"><a href="#DisulfideLoader-215"><span class="linenos">215</span></a>    <span class="k">def</span> <span class="nf">_validate_ss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="DisulfideLoader-216"><a href="#DisulfideLoader-216"><span class="linenos">216</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="n">Disulfide</span><span class="p">)):</span>
</span><span id="DisulfideLoader-217"><a href="#DisulfideLoader-217"><span class="linenos">217</span></a>            <span class="k">return</span> <span class="n">value</span>
</span><span id="DisulfideLoader-218"><a href="#DisulfideLoader-218"><span class="linenos">218</span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Disulfide object expected, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideLoader-219"><a href="#DisulfideLoader-219"><span class="linenos">219</span></a>    
</span><span id="DisulfideLoader-220"><a href="#DisulfideLoader-220"><span class="linenos">220</span></a>    <span class="nd">@property</span>
</span><span id="DisulfideLoader-221"><a href="#DisulfideLoader-221"><span class="linenos">221</span></a>    <span class="k">def</span> <span class="nf">Average_Resolution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="DisulfideLoader-222"><a href="#DisulfideLoader-222"><span class="linenos">222</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-223"><a href="#DisulfideLoader-223"><span class="linenos">223</span></a><span class="sd">        Compute and return the average structure resolution for the given list.</span>
</span><span id="DisulfideLoader-224"><a href="#DisulfideLoader-224"><span class="linenos">224</span></a>
</span><span id="DisulfideLoader-225"><a href="#DisulfideLoader-225"><span class="linenos">225</span></a><span class="sd">        :return: Average resolution (A)</span>
</span><span id="DisulfideLoader-226"><a href="#DisulfideLoader-226"><span class="linenos">226</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-227"><a href="#DisulfideLoader-227"><span class="linenos">227</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="DisulfideLoader-228"><a href="#DisulfideLoader-228"><span class="linenos">228</span></a>        <span class="n">cnt</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="DisulfideLoader-229"><a href="#DisulfideLoader-229"><span class="linenos">229</span></a>        <span class="n">sslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span>
</span><span id="DisulfideLoader-230"><a href="#DisulfideLoader-230"><span class="linenos">230</span></a>
</span><span id="DisulfideLoader-231"><a href="#DisulfideLoader-231"><span class="linenos">231</span></a>        <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">:</span>
</span><span id="DisulfideLoader-232"><a href="#DisulfideLoader-232"><span class="linenos">232</span></a>            <span class="n">_res</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="DisulfideLoader-233"><a href="#DisulfideLoader-233"><span class="linenos">233</span></a>            <span class="k">if</span> <span class="n">_res</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">res</span> <span class="o">!=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">:</span>
</span><span id="DisulfideLoader-234"><a href="#DisulfideLoader-234"><span class="linenos">234</span></a>                <span class="n">res</span> <span class="o">+=</span> <span class="n">_res</span>
</span><span id="DisulfideLoader-235"><a href="#DisulfideLoader-235"><span class="linenos">235</span></a>                <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="DisulfideLoader-236"><a href="#DisulfideLoader-236"><span class="linenos">236</span></a>        <span class="k">return</span> <span class="n">res</span> <span class="o">/</span> <span class="n">cnt</span>
</span><span id="DisulfideLoader-237"><a href="#DisulfideLoader-237"><span class="linenos">237</span></a>    
</span><span id="DisulfideLoader-238"><a href="#DisulfideLoader-238"><span class="linenos">238</span></a>    <span class="k">def</span> <span class="nf">build_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideLoader-239"><a href="#DisulfideLoader-239"><span class="linenos">239</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-240"><a href="#DisulfideLoader-240"><span class="linenos">240</span></a><span class="sd">        Build the internal dictionary mapping disulfides to class names.</span>
</span><span id="DisulfideLoader-241"><a href="#DisulfideLoader-241"><span class="linenos">241</span></a>
</span><span id="DisulfideLoader-242"><a href="#DisulfideLoader-242"><span class="linenos">242</span></a><span class="sd">        Disulfide classes are defined using the +/- formalism described by </span>
</span><span id="DisulfideLoader-243"><a href="#DisulfideLoader-243"><span class="linenos">243</span></a><span class="sd">        Hogg et al. (Biochem, 2006, 45, 7429-7433), across all 32 (2^5), possible </span>
</span><span id="DisulfideLoader-244"><a href="#DisulfideLoader-244"><span class="linenos">244</span></a><span class="sd">        binary sidechain torsional combinations. Classes are named per Hogg&#39;s convention.</span>
</span><span id="DisulfideLoader-245"><a href="#DisulfideLoader-245"><span class="linenos">245</span></a><span class="sd">        The ``class_id`` represents the sign of each dihedral angle $\chi_{1} - \chi_{1&#39;}$</span>
</span><span id="DisulfideLoader-246"><a href="#DisulfideLoader-246"><span class="linenos">246</span></a><span class="sd">        where *0* repreents *negative* dihedral angle and *2* a *positive* angle.</span>
</span><span id="DisulfideLoader-247"><a href="#DisulfideLoader-247"><span class="linenos">247</span></a>
</span><span id="DisulfideLoader-248"><a href="#DisulfideLoader-248"><span class="linenos">248</span></a><span class="sd">        |   class_id | SS_Classname   | FXN        |   count |   incidence |</span>
</span><span id="DisulfideLoader-249"><a href="#DisulfideLoader-249"><span class="linenos">249</span></a><span class="sd">        |-----------:|:---------------|:-----------|--------:|------------:|</span>
</span><span id="DisulfideLoader-250"><a href="#DisulfideLoader-250"><span class="linenos">250</span></a><span class="sd">        |      00000 | -LHSpiral      | UNK        |   31513 |  0.261092   |</span>
</span><span id="DisulfideLoader-251"><a href="#DisulfideLoader-251"><span class="linenos">251</span></a><span class="sd">        |      00002 | 00002          | UNK        |    5805 |  0.0480956  |</span>
</span><span id="DisulfideLoader-252"><a href="#DisulfideLoader-252"><span class="linenos">252</span></a><span class="sd">        |      00020 | -LHHook        | UNK        |    3413 |  0.0282774  |</span>
</span><span id="DisulfideLoader-253"><a href="#DisulfideLoader-253"><span class="linenos">253</span></a><span class="sd">        |      00022 | 00022          | UNK        |    1940 |  0.0160733  |</span>
</span><span id="DisulfideLoader-254"><a href="#DisulfideLoader-254"><span class="linenos">254</span></a><span class="sd">        |      00200 | -RHStaple      | Allosteric |   12735 |  0.105512   |</span>
</span><span id="DisulfideLoader-255"><a href="#DisulfideLoader-255"><span class="linenos">255</span></a><span class="sd">        |      00202 | 00202          | UNK        |     993 |  0.00822721 |</span>
</span><span id="DisulfideLoader-256"><a href="#DisulfideLoader-256"><span class="linenos">256</span></a><span class="sd">        |      00220 | 00220          | UNK        |    5674 |  0.0470103  |</span>
</span><span id="DisulfideLoader-257"><a href="#DisulfideLoader-257"><span class="linenos">257</span></a><span class="sd">        |      00222 | 00222          | UNK        |    5092 |  0.0421883  |</span>
</span><span id="DisulfideLoader-258"><a href="#DisulfideLoader-258"><span class="linenos">258</span></a><span class="sd">        |      02000 | 02000          | UNK        |    4749 |  0.0393465  |</span>
</span><span id="DisulfideLoader-259"><a href="#DisulfideLoader-259"><span class="linenos">259</span></a><span class="sd">        |      02002 | 02002          | UNK        |    3774 |  0.0312684  |</span>
</span><span id="DisulfideLoader-260"><a href="#DisulfideLoader-260"><span class="linenos">260</span></a><span class="sd">        |      02020 | -LHStaple      | UNK        |    1494 |  0.0123781  |</span>
</span><span id="DisulfideLoader-261"><a href="#DisulfideLoader-261"><span class="linenos">261</span></a><span class="sd">        |      02022 | 02022          | UNK        |     591 |  0.00489656 |</span>
</span><span id="DisulfideLoader-262"><a href="#DisulfideLoader-262"><span class="linenos">262</span></a><span class="sd">        |      02200 | -RHHook        | UNK        |    5090 |  0.0421717  |</span>
</span><span id="DisulfideLoader-263"><a href="#DisulfideLoader-263"><span class="linenos">263</span></a><span class="sd">        |      02202 | 02202          | UNK        |     533 |  0.00441602 |</span>
</span><span id="DisulfideLoader-264"><a href="#DisulfideLoader-264"><span class="linenos">264</span></a><span class="sd">        |      02220 | -RHSpiral      | UNK        |    6751 |  0.0559335  |</span>
</span><span id="DisulfideLoader-265"><a href="#DisulfideLoader-265"><span class="linenos">265</span></a><span class="sd">        |      02222 | 02222          | UNK        |    3474 |  0.0287828  |</span>
</span><span id="DisulfideLoader-266"><a href="#DisulfideLoader-266"><span class="linenos">266</span></a><span class="sd">        |      20000 | +/-LHSpiral    | UNK        |    3847 |  0.0318732  |</span>
</span><span id="DisulfideLoader-267"><a href="#DisulfideLoader-267"><span class="linenos">267</span></a><span class="sd">        |      20002 | +LHSpiral      | UNK        |     875 |  0.00724956 |</span>
</span><span id="DisulfideLoader-268"><a href="#DisulfideLoader-268"><span class="linenos">268</span></a><span class="sd">        |      20020 | +/-LHHook      | UNK        |     803 |  0.00665302 |</span>
</span><span id="DisulfideLoader-269"><a href="#DisulfideLoader-269"><span class="linenos">269</span></a><span class="sd">        |      20022 | +LHHook        | UNK        |     602 |  0.0049877  |</span>
</span><span id="DisulfideLoader-270"><a href="#DisulfideLoader-270"><span class="linenos">270</span></a><span class="sd">        |      20200 | +/-RHStaple    | UNK        |     419 |  0.0034715  |</span>
</span><span id="DisulfideLoader-271"><a href="#DisulfideLoader-271"><span class="linenos">271</span></a><span class="sd">        |      20202 | +RHStaple      | UNK        |     293 |  0.00242757 |</span>
</span><span id="DisulfideLoader-272"><a href="#DisulfideLoader-272"><span class="linenos">272</span></a><span class="sd">        |      20220 | +/-RHHook      | Catalytic  |    1435 |  0.0118893  |</span>
</span><span id="DisulfideLoader-273"><a href="#DisulfideLoader-273"><span class="linenos">273</span></a><span class="sd">        |      20222 | 20222          | UNK        |     488 |  0.00404318 |</span>
</span><span id="DisulfideLoader-274"><a href="#DisulfideLoader-274"><span class="linenos">274</span></a><span class="sd">        |      22000 | -/+LHHook      | UNK        |    2455 |  0.0203402  |</span>
</span><span id="DisulfideLoader-275"><a href="#DisulfideLoader-275"><span class="linenos">275</span></a><span class="sd">        |      22002 | 22002          | UNK        |    1027 |  0.00850891 |</span>
</span><span id="DisulfideLoader-276"><a href="#DisulfideLoader-276"><span class="linenos">276</span></a><span class="sd">        |      22020 | +/-LHStaple    | UNK        |    1046 |  0.00866633 |</span>
</span><span id="DisulfideLoader-277"><a href="#DisulfideLoader-277"><span class="linenos">277</span></a><span class="sd">        |      22022 | +LHStaple      | UNK        |     300 |  0.00248556 |</span>
</span><span id="DisulfideLoader-278"><a href="#DisulfideLoader-278"><span class="linenos">278</span></a><span class="sd">        |      22200 | -/+RHHook      | UNK        |    6684 |  0.0553783  |</span>
</span><span id="DisulfideLoader-279"><a href="#DisulfideLoader-279"><span class="linenos">279</span></a><span class="sd">        |      22202 | +RHHook        | UNK        |     593 |  0.00491313 |</span>
</span><span id="DisulfideLoader-280"><a href="#DisulfideLoader-280"><span class="linenos">280</span></a><span class="sd">        |      22220 | +/-RHSpiral    | UNK        |    2544 |  0.0210776  |</span>
</span><span id="DisulfideLoader-281"><a href="#DisulfideLoader-281"><span class="linenos">281</span></a><span class="sd">        |      22222 | +RHSpiral      | UNK        |    3665 |  0.0303653  |</span>
</span><span id="DisulfideLoader-282"><a href="#DisulfideLoader-282"><span class="linenos">282</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-283"><a href="#DisulfideLoader-283"><span class="linenos">283</span></a>
</span><span id="DisulfideLoader-284"><a href="#DisulfideLoader-284"><span class="linenos">284</span></a>        <span class="k">def</span> <span class="nf">ss_id_dict</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
</span><span id="DisulfideLoader-285"><a href="#DisulfideLoader-285"><span class="linenos">285</span></a>            <span class="n">ss_id_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SS_Classname&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ss_id&#39;</span><span class="p">]))</span>
</span><span id="DisulfideLoader-286"><a href="#DisulfideLoader-286"><span class="linenos">286</span></a>            <span class="k">return</span> <span class="n">ss_id_dict</span>
</span><span id="DisulfideLoader-287"><a href="#DisulfideLoader-287"><span class="linenos">287</span></a>
</span><span id="DisulfideLoader-288"><a href="#DisulfideLoader-288"><span class="linenos">288</span></a>        <span class="n">tors_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTorsions</span><span class="p">()</span>
</span><span id="DisulfideLoader-289"><a href="#DisulfideLoader-289"><span class="linenos">289</span></a>
</span><span id="DisulfideLoader-290"><a href="#DisulfideLoader-290"><span class="linenos">290</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader-291"><a href="#DisulfideLoader-291"><span class="linenos">291</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; build_classes(): creating SS classes...&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-292"><a href="#DisulfideLoader-292"><span class="linenos">292</span></a>
</span><span id="DisulfideLoader-293"><a href="#DisulfideLoader-293"><span class="linenos">293</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">create_classes</span><span class="p">(</span><span class="n">tors_df</span><span class="p">)</span>
</span><span id="DisulfideLoader-294"><a href="#DisulfideLoader-294"><span class="linenos">294</span></a>
</span><span id="DisulfideLoader-295"><a href="#DisulfideLoader-295"><span class="linenos">295</span></a>        <span class="c1"># grouped.to_csv(f&#39;{DATA_DIR}PDB_ss_classes.csv&#39;)</span>
</span><span id="DisulfideLoader-296"><a href="#DisulfideLoader-296"><span class="linenos">296</span></a>        <span class="c1">#if self.verbose:</span>
</span><span id="DisulfideLoader-297"><a href="#DisulfideLoader-297"><span class="linenos">297</span></a>        <span class="c1">#    print(f&#39;{grouped.head(32)}&#39;)</span>
</span><span id="DisulfideLoader-298"><a href="#DisulfideLoader-298"><span class="linenos">298</span></a>        
</span><span id="DisulfideLoader-299"><a href="#DisulfideLoader-299"><span class="linenos">299</span></a>        <span class="n">class_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">SS_CLASS_DEFINITIONS</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class_id&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;FXN&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;SS_Classname&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">})</span>
</span><span id="DisulfideLoader-300"><a href="#DisulfideLoader-300"><span class="linenos">300</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s1">&#39;FXN&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="DisulfideLoader-301"><a href="#DisulfideLoader-301"><span class="linenos">301</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s1">&#39;SS_Classname&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="DisulfideLoader-302"><a href="#DisulfideLoader-302"><span class="linenos">302</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s1">&#39;class_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="DisulfideLoader-303"><a href="#DisulfideLoader-303"><span class="linenos">303</span></a>
</span><span id="DisulfideLoader-304"><a href="#DisulfideLoader-304"><span class="linenos">304</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader-305"><a href="#DisulfideLoader-305"><span class="linenos">305</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; build_classes(): merging...&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-306"><a href="#DisulfideLoader-306"><span class="linenos">306</span></a>
</span><span id="DisulfideLoader-307"><a href="#DisulfideLoader-307"><span class="linenos">307</span></a>        <span class="n">merged</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">concat_dataframes</span><span class="p">(</span><span class="n">class_df</span><span class="p">,</span> <span class="n">grouped</span><span class="p">)</span>
</span><span id="DisulfideLoader-308"><a href="#DisulfideLoader-308"><span class="linenos">308</span></a>        <span class="n">merged</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Idx&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DisulfideLoader-309"><a href="#DisulfideLoader-309"><span class="linenos">309</span></a>
</span><span id="DisulfideLoader-310"><a href="#DisulfideLoader-310"><span class="linenos">310</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdf</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DisulfideLoader-311"><a href="#DisulfideLoader-311"><span class="linenos">311</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span> <span class="o">=</span> <span class="n">ss_id_dict</span><span class="p">(</span><span class="n">merged</span><span class="p">)</span>
</span><span id="DisulfideLoader-312"><a href="#DisulfideLoader-312"><span class="linenos">312</span></a>
</span><span id="DisulfideLoader-313"><a href="#DisulfideLoader-313"><span class="linenos">313</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader-314"><a href="#DisulfideLoader-314"><span class="linenos">314</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; build_classes(): initialization complete.&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-315"><a href="#DisulfideLoader-315"><span class="linenos">315</span></a>        
</span><span id="DisulfideLoader-316"><a href="#DisulfideLoader-316"><span class="linenos">316</span></a>        <span class="k">return</span>
</span><span id="DisulfideLoader-317"><a href="#DisulfideLoader-317"><span class="linenos">317</span></a>
</span><span id="DisulfideLoader-318"><a href="#DisulfideLoader-318"><span class="linenos">318</span></a>    <span class="k">def</span> <span class="nf">build_ss_from_idlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idlist</span><span class="p">):</span>
</span><span id="DisulfideLoader-319"><a href="#DisulfideLoader-319"><span class="linenos">319</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-320"><a href="#DisulfideLoader-320"><span class="linenos">320</span></a><span class="sd">        Given a list of PDBid, return a DisulfideList of Disulfides</span>
</span><span id="DisulfideLoader-321"><a href="#DisulfideLoader-321"><span class="linenos">321</span></a>
</span><span id="DisulfideLoader-322"><a href="#DisulfideLoader-322"><span class="linenos">322</span></a><span class="sd">        :param idlist: List of PDBIDs, e.g. [&#39;4yys&#39;, &#39;2q7q&#39;]</span>
</span><span id="DisulfideLoader-323"><a href="#DisulfideLoader-323"><span class="linenos">323</span></a><span class="sd">        :return: ProteusPy.DisulfideList.DisulfideList of ProteusPy.Disulfide.Disulfide</span>
</span><span id="DisulfideLoader-324"><a href="#DisulfideLoader-324"><span class="linenos">324</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-325"><a href="#DisulfideLoader-325"><span class="linenos">325</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-326"><a href="#DisulfideLoader-326"><span class="linenos">326</span></a>        
</span><span id="DisulfideLoader-327"><a href="#DisulfideLoader-327"><span class="linenos">327</span></a>        <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">idlist</span><span class="p">:</span>
</span><span id="DisulfideLoader-328"><a href="#DisulfideLoader-328"><span class="linenos">328</span></a>            <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">:</span>
</span><span id="DisulfideLoader-329"><a href="#DisulfideLoader-329"><span class="linenos">329</span></a>                <span class="k">if</span> <span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span> <span class="o">==</span> <span class="nb">id</span><span class="p">:</span>
</span><span id="DisulfideLoader-330"><a href="#DisulfideLoader-330"><span class="linenos">330</span></a>                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
</span><span id="DisulfideLoader-331"><a href="#DisulfideLoader-331"><span class="linenos">331</span></a>                    <span class="k">break</span>
</span><span id="DisulfideLoader-332"><a href="#DisulfideLoader-332"><span class="linenos">332</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="DisulfideLoader-333"><a href="#DisulfideLoader-333"><span class="linenos">333</span></a>    
</span><span id="DisulfideLoader-334"><a href="#DisulfideLoader-334"><span class="linenos">334</span></a>    <span class="k">def</span> <span class="nf">concat_dataframes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">):</span>
</span><span id="DisulfideLoader-335"><a href="#DisulfideLoader-335"><span class="linenos">335</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-336"><a href="#DisulfideLoader-336"><span class="linenos">336</span></a><span class="sd">        Concatenates columns from one data frame into the other and returns the new result.</span>
</span><span id="DisulfideLoader-337"><a href="#DisulfideLoader-337"><span class="linenos">337</span></a>
</span><span id="DisulfideLoader-338"><a href="#DisulfideLoader-338"><span class="linenos">338</span></a><span class="sd">        :param df1 : pandas.DataFrame - The first data frame.</span>
</span><span id="DisulfideLoader-339"><a href="#DisulfideLoader-339"><span class="linenos">339</span></a><span class="sd">        :param df2 : pandas.DataFrame - The second data frame.</span>
</span><span id="DisulfideLoader-340"><a href="#DisulfideLoader-340"><span class="linenos">340</span></a>
</span><span id="DisulfideLoader-341"><a href="#DisulfideLoader-341"><span class="linenos">341</span></a><span class="sd">        :return: pandas.DataFrame - The concatenated data frame.</span>
</span><span id="DisulfideLoader-342"><a href="#DisulfideLoader-342"><span class="linenos">342</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader-343"><a href="#DisulfideLoader-343"><span class="linenos">343</span></a>        <span class="c1"># Merge the data frames based on the &#39;SS_Classname&#39; column</span>
</span><span id="DisulfideLoader-344"><a href="#DisulfideLoader-344"><span class="linenos">344</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;class_id&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-345"><a href="#DisulfideLoader-345"><span class="linenos">345</span></a>
</span><span id="DisulfideLoader-346"><a href="#DisulfideLoader-346"><span class="linenos">346</span></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="DisulfideLoader-347"><a href="#DisulfideLoader-347"><span class="linenos">347</span></a>
</span><span id="DisulfideLoader-348"><a href="#DisulfideLoader-348"><span class="linenos">348</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideLoader-349"><a href="#DisulfideLoader-349"><span class="linenos">349</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-350"><a href="#DisulfideLoader-350"><span class="linenos">350</span></a><span class="sd">        Return a copy of self</span>
</span><span id="DisulfideLoader-351"><a href="#DisulfideLoader-351"><span class="linenos">351</span></a>
</span><span id="DisulfideLoader-352"><a href="#DisulfideLoader-352"><span class="linenos">352</span></a><span class="sd">        :return: Copy of self</span>
</span><span id="DisulfideLoader-353"><a href="#DisulfideLoader-353"><span class="linenos">353</span></a><span class="sd">        :rtype: proteusPy.DisulfideLoader</span>
</span><span id="DisulfideLoader-354"><a href="#DisulfideLoader-354"><span class="linenos">354</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-355"><a href="#DisulfideLoader-355"><span class="linenos">355</span></a>        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="DisulfideLoader-356"><a href="#DisulfideLoader-356"><span class="linenos">356</span></a>
</span><span id="DisulfideLoader-357"><a href="#DisulfideLoader-357"><span class="linenos">357</span></a>    <span class="k">def</span> <span class="nf">getlist</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="DisulfideLoader-358"><a href="#DisulfideLoader-358"><span class="linenos">358</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-359"><a href="#DisulfideLoader-359"><span class="linenos">359</span></a><span class="sd">        Return the list of Disulfides contained in the class.</span>
</span><span id="DisulfideLoader-360"><a href="#DisulfideLoader-360"><span class="linenos">360</span></a>
</span><span id="DisulfideLoader-361"><a href="#DisulfideLoader-361"><span class="linenos">361</span></a><span class="sd">        :return: DisulfideList</span>
</span><span id="DisulfideLoader-362"><a href="#DisulfideLoader-362"><span class="linenos">362</span></a><span class="sd">        :rtype: DisulfideList</span>
</span><span id="DisulfideLoader-363"><a href="#DisulfideLoader-363"><span class="linenos">363</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-364"><a href="#DisulfideLoader-364"><span class="linenos">364</span></a>        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">)</span>
</span><span id="DisulfideLoader-365"><a href="#DisulfideLoader-365"><span class="linenos">365</span></a>    
</span><span id="DisulfideLoader-366"><a href="#DisulfideLoader-366"><span class="linenos">366</span></a>    <span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideLoader-367"><a href="#DisulfideLoader-367"><span class="linenos">367</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-368"><a href="#DisulfideLoader-368"><span class="linenos">368</span></a><span class="sd">        Provides information about the Disulfide database contained in ```self```.</span>
</span><span id="DisulfideLoader-369"><a href="#DisulfideLoader-369"><span class="linenos">369</span></a>
</span><span id="DisulfideLoader-370"><a href="#DisulfideLoader-370"><span class="linenos">370</span></a><span class="sd">        Example:</span>
</span><span id="DisulfideLoader-371"><a href="#DisulfideLoader-371"><span class="linenos">371</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideLoader import Load_PDB_SS</span>
</span><span id="DisulfideLoader-372"><a href="#DisulfideLoader-372"><span class="linenos">372</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = Load_PDB_SS(verbose=False, subset=False)</span>
</span><span id="DisulfideLoader-373"><a href="#DisulfideLoader-373"><span class="linenos">373</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS.describe()</span>
</span><span id="DisulfideLoader-374"><a href="#DisulfideLoader-374"><span class="linenos">374</span></a><span class="sd">            =========== RCSB Disulfide Database Summary ==============</span>
</span><span id="DisulfideLoader-375"><a href="#DisulfideLoader-375"><span class="linenos">375</span></a><span class="sd">        PDB IDs present:                    35818</span>
</span><span id="DisulfideLoader-376"><a href="#DisulfideLoader-376"><span class="linenos">376</span></a><span class="sd">        Disulfides loaded:                  120697</span>
</span><span id="DisulfideLoader-377"><a href="#DisulfideLoader-377"><span class="linenos">377</span></a><span class="sd">        Average structure resolution:       2.34 Å</span>
</span><span id="DisulfideLoader-378"><a href="#DisulfideLoader-378"><span class="linenos">378</span></a><span class="sd">        Lowest Energy Disulfide:            2q7q_75D_140D</span>
</span><span id="DisulfideLoader-379"><a href="#DisulfideLoader-379"><span class="linenos">379</span></a><span class="sd">        Highest Energy Disulfide:           1toz_456A_467A</span>
</span><span id="DisulfideLoader-380"><a href="#DisulfideLoader-380"><span class="linenos">380</span></a><span class="sd">        Total RAM Used:                     29.26 GB.</span>
</span><span id="DisulfideLoader-381"><a href="#DisulfideLoader-381"><span class="linenos">381</span></a>
</span><span id="DisulfideLoader-382"><a href="#DisulfideLoader-382"><span class="linenos">382</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-383"><a href="#DisulfideLoader-383"><span class="linenos">383</span></a>        <span class="n">vers</span> <span class="o">=</span> <span class="n">proteusPy</span><span class="o">.</span><span class="n">__version__</span>
</span><span id="DisulfideLoader-384"><a href="#DisulfideLoader-384"><span class="linenos">384</span></a>        <span class="n">tot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span>
</span><span id="DisulfideLoader-385"><a href="#DisulfideLoader-385"><span class="linenos">385</span></a>        <span class="n">pdbs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">)</span>
</span><span id="DisulfideLoader-386"><a href="#DisulfideLoader-386"><span class="linenos">386</span></a>        <span class="n">ram</span> <span class="o">=</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">)</span> <span class="o">+</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">)</span> <span class="o">+</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>
</span><span id="DisulfideLoader-387"><a href="#DisulfideLoader-387"><span class="linenos">387</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Average_Resolution</span>
</span><span id="DisulfideLoader-388"><a href="#DisulfideLoader-388"><span class="linenos">388</span></a>        <span class="n">cutoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span>
</span><span id="DisulfideLoader-389"><a href="#DisulfideLoader-389"><span class="linenos">389</span></a>        <span class="n">timestr</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">))</span>
</span><span id="DisulfideLoader-390"><a href="#DisulfideLoader-390"><span class="linenos">390</span></a>        <span class="n">ssMin</span><span class="p">,</span> <span class="n">ssMax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">minmax_energy</span><span class="p">()</span>
</span><span id="DisulfideLoader-391"><a href="#DisulfideLoader-391"><span class="linenos">391</span></a>        
</span><span id="DisulfideLoader-392"><a href="#DisulfideLoader-392"><span class="linenos">392</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;    =========== RCSB Disulfide Database Summary ==============&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-393"><a href="#DisulfideLoader-393"><span class="linenos">393</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;       =========== Built: </span><span class="si">{</span><span class="n">timestr</span><span class="si">}</span><span class="s1"> ==============&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-394"><a href="#DisulfideLoader-394"><span class="linenos">394</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PDB IDs present:                    </span><span class="si">{</span><span class="n">pdbs</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-395"><a href="#DisulfideLoader-395"><span class="linenos">395</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Disulfides loaded:                  </span><span class="si">{</span><span class="n">tot</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-396"><a href="#DisulfideLoader-396"><span class="linenos">396</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Average structure resolution:       </span><span class="si">{</span><span class="n">res</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-397"><a href="#DisulfideLoader-397"><span class="linenos">397</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lowest Energy Disulfide:            </span><span class="si">{</span><span class="n">ssMin</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-398"><a href="#DisulfideLoader-398"><span class="linenos">398</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Highest Energy Disulfide:           </span><span class="si">{</span><span class="n">ssMax</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-399"><a href="#DisulfideLoader-399"><span class="linenos">399</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Ca distance cutoff:                 </span><span class="si">{</span><span class="n">cutoff</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-400"><a href="#DisulfideLoader-400"><span class="linenos">400</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total RAM Used:                     </span><span class="si">{</span><span class="n">ram</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> GB.&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-401"><a href="#DisulfideLoader-401"><span class="linenos">401</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;    ================= proteusPy: </span><span class="si">{</span><span class="n">vers</span><span class="si">}</span><span class="s1"> =======================&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-402"><a href="#DisulfideLoader-402"><span class="linenos">402</span></a>       
</span><span id="DisulfideLoader-403"><a href="#DisulfideLoader-403"><span class="linenos">403</span></a>    <span class="k">def</span> <span class="nf">display_overlay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdbid</span><span class="p">):</span>
</span><span id="DisulfideLoader-404"><a href="#DisulfideLoader-404"><span class="linenos">404</span></a>        <span class="sd">&#39;&#39;&#39; </span>
</span><span id="DisulfideLoader-405"><a href="#DisulfideLoader-405"><span class="linenos">405</span></a><span class="sd">        Display all disulfides for a given PDB ID overlaid in stick mode against</span>
</span><span id="DisulfideLoader-406"><a href="#DisulfideLoader-406"><span class="linenos">406</span></a><span class="sd">        a common coordinate frame. This allows us to see all of the disulfides</span>
</span><span id="DisulfideLoader-407"><a href="#DisulfideLoader-407"><span class="linenos">407</span></a><span class="sd">        at one time in a single view. Colors vary smoothy between bonds.</span>
</span><span id="DisulfideLoader-408"><a href="#DisulfideLoader-408"><span class="linenos">408</span></a><span class="sd">        </span>
</span><span id="DisulfideLoader-409"><a href="#DisulfideLoader-409"><span class="linenos">409</span></a><span class="sd">        :param self: DisulfideLoader object initialized with the database.</span>
</span><span id="DisulfideLoader-410"><a href="#DisulfideLoader-410"><span class="linenos">410</span></a><span class="sd">        :param pdbid: the PDB id string, e.g. 4yys</span>
</span><span id="DisulfideLoader-411"><a href="#DisulfideLoader-411"><span class="linenos">411</span></a><span class="sd">        :return: None</span>
</span><span id="DisulfideLoader-412"><a href="#DisulfideLoader-412"><span class="linenos">412</span></a>
</span><span id="DisulfideLoader-413"><a href="#DisulfideLoader-413"><span class="linenos">413</span></a><span class="sd">        Example:</span>
</span><span id="DisulfideLoader-414"><a href="#DisulfideLoader-414"><span class="linenos">414</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.Disulfide import Disulfide</span>
</span><span id="DisulfideLoader-415"><a href="#DisulfideLoader-415"><span class="linenos">415</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideLoader import DisulfideLoader</span>
</span><span id="DisulfideLoader-416"><a href="#DisulfideLoader-416"><span class="linenos">416</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideList import DisulfideList</span>
</span><span id="DisulfideLoader-417"><a href="#DisulfideLoader-417"><span class="linenos">417</span></a><span class="sd">            </span>
</span><span id="DisulfideLoader-418"><a href="#DisulfideLoader-418"><span class="linenos">418</span></a><span class="sd">        Instantiate the Loader with the SS database subset.</span>
</span><span id="DisulfideLoader-419"><a href="#DisulfideLoader-419"><span class="linenos">419</span></a>
</span><span id="DisulfideLoader-420"><a href="#DisulfideLoader-420"><span class="linenos">420</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = DisulfideLoader(verbose=False, subset=True)</span>
</span><span id="DisulfideLoader-421"><a href="#DisulfideLoader-421"><span class="linenos">421</span></a><span class="sd">        </span>
</span><span id="DisulfideLoader-422"><a href="#DisulfideLoader-422"><span class="linenos">422</span></a><span class="sd">        Display the Disulfides from the PDB ID ```4yys```, overlaid onto</span>
</span><span id="DisulfideLoader-423"><a href="#DisulfideLoader-423"><span class="linenos">423</span></a><span class="sd">        a common reference (the proximal disulfides).</span>
</span><span id="DisulfideLoader-424"><a href="#DisulfideLoader-424"><span class="linenos">424</span></a>
</span><span id="DisulfideLoader-425"><a href="#DisulfideLoader-425"><span class="linenos">425</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS.display_overlay(&#39;4yys&#39;)</span>
</span><span id="DisulfideLoader-426"><a href="#DisulfideLoader-426"><span class="linenos">426</span></a>
</span><span id="DisulfideLoader-427"><a href="#DisulfideLoader-427"><span class="linenos">427</span></a><span class="sd">        You can also slice the loader and display as an overly.</span>
</span><span id="DisulfideLoader-428"><a href="#DisulfideLoader-428"><span class="linenos">428</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS[:8].display_overlay()</span>
</span><span id="DisulfideLoader-429"><a href="#DisulfideLoader-429"><span class="linenos">429</span></a>
</span><span id="DisulfideLoader-430"><a href="#DisulfideLoader-430"><span class="linenos">430</span></a><span class="sd">        &#39;&#39;&#39;</span> 
</span><span id="DisulfideLoader-431"><a href="#DisulfideLoader-431"><span class="linenos">431</span></a>
</span><span id="DisulfideLoader-432"><a href="#DisulfideLoader-432"><span class="linenos">432</span></a>        <span class="n">ssbonds</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">pdbid</span><span class="p">]</span>
</span><span id="DisulfideLoader-433"><a href="#DisulfideLoader-433"><span class="linenos">433</span></a>        <span class="n">ssbonds</span><span class="o">.</span><span class="n">display_overlay</span><span class="p">()</span>
</span><span id="DisulfideLoader-434"><a href="#DisulfideLoader-434"><span class="linenos">434</span></a>        <span class="k">return</span>
</span><span id="DisulfideLoader-435"><a href="#DisulfideLoader-435"><span class="linenos">435</span></a>    
</span><span id="DisulfideLoader-436"><a href="#DisulfideLoader-436"><span class="linenos">436</span></a>    
</span><span id="DisulfideLoader-437"><a href="#DisulfideLoader-437"><span class="linenos">437</span></a>    <span class="k">def</span> <span class="nf">getTorsions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdbID</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="DisulfideLoader-438"><a href="#DisulfideLoader-438"><span class="linenos">438</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-439"><a href="#DisulfideLoader-439"><span class="linenos">439</span></a><span class="sd">        Return the torsions, distances and energies defined by Disulfide.Torsion_DF_cols</span>
</span><span id="DisulfideLoader-440"><a href="#DisulfideLoader-440"><span class="linenos">440</span></a>
</span><span id="DisulfideLoader-441"><a href="#DisulfideLoader-441"><span class="linenos">441</span></a><span class="sd">        :param pdbID: pdbID, defaults to None, meaning return entire dataset.</span>
</span><span id="DisulfideLoader-442"><a href="#DisulfideLoader-442"><span class="linenos">442</span></a><span class="sd">        :type pdbID: str, optional used to extract for a specific PDB structure. If not specified</span>
</span><span id="DisulfideLoader-443"><a href="#DisulfideLoader-443"><span class="linenos">443</span></a><span class="sd">            then return the entire dataset.</span>
</span><span id="DisulfideLoader-444"><a href="#DisulfideLoader-444"><span class="linenos">444</span></a><span class="sd">        :raises DisulfideParseWarning: Raised if not found</span>
</span><span id="DisulfideLoader-445"><a href="#DisulfideLoader-445"><span class="linenos">445</span></a><span class="sd">        :return: Torsions Dataframe</span>
</span><span id="DisulfideLoader-446"><a href="#DisulfideLoader-446"><span class="linenos">446</span></a><span class="sd">        :rtype: pd.DataFrame</span>
</span><span id="DisulfideLoader-447"><a href="#DisulfideLoader-447"><span class="linenos">447</span></a>
</span><span id="DisulfideLoader-448"><a href="#DisulfideLoader-448"><span class="linenos">448</span></a><span class="sd">        Example:</span>
</span><span id="DisulfideLoader-449"><a href="#DisulfideLoader-449"><span class="linenos">449</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideLoader import DisulfideLoader</span>
</span><span id="DisulfideLoader-450"><a href="#DisulfideLoader-450"><span class="linenos">450</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = DisulfideLoader(verbose=False, subset=True)</span>
</span><span id="DisulfideLoader-451"><a href="#DisulfideLoader-451"><span class="linenos">451</span></a><span class="sd">        &gt;&gt;&gt; Tor_DF = PDB_SS.getTorsions()</span>
</span><span id="DisulfideLoader-452"><a href="#DisulfideLoader-452"><span class="linenos">452</span></a><span class="sd">        &gt;&gt;&gt; Tor_DF.describe()</span>
</span><span id="DisulfideLoader-453"><a href="#DisulfideLoader-453"><span class="linenos">453</span></a><span class="sd">                  proximal       distal         chi1         chi2         chi3         chi4  ...  ca_distance     phi_prox     psi_prox     phi_dist     psi_dist  torsion_length</span>
</span><span id="DisulfideLoader-454"><a href="#DisulfideLoader-454"><span class="linenos">454</span></a><span class="sd">        count  3393.000000  3393.000000  3393.000000  3393.000000  3393.000000  3393.000000  ...  3393.000000  3393.000000  3393.000000  3393.000000  3393.000000     3393.000000</span>
</span><span id="DisulfideLoader-455"><a href="#DisulfideLoader-455"><span class="linenos">455</span></a><span class="sd">        mean    231.513999   280.056587   -49.134436   -15.616297    -3.727982   -31.909496  ...     5.554563   -98.491326    63.029854   -95.890117    62.408772      225.242256</span>
</span><span id="DisulfideLoader-456"><a href="#DisulfideLoader-456"><span class="linenos">456</span></a><span class="sd">        std     292.300344   293.503989    95.456284   104.318483    93.894477   103.553641  ...     1.489138    44.275097    99.266921    44.796764    97.231632       53.309336</span>
</span><span id="DisulfideLoader-457"><a href="#DisulfideLoader-457"><span class="linenos">457</span></a><span class="sd">        min       1.000000     6.000000  -179.947368  -179.990782  -179.081812  -179.940602  ...     2.941898  -180.000000  -180.000000  -180.000000  -180.000000      116.478788</span>
</span><span id="DisulfideLoader-458"><a href="#DisulfideLoader-458"><span class="linenos">458</span></a><span class="sd">        25%      48.000000    96.000000   -83.281768   -88.455019   -87.763001   -95.240905  ...     5.075491  -129.605300   -26.792543  -123.131231   -25.503215      181.929048</span>
</span><span id="DisulfideLoader-459"><a href="#DisulfideLoader-459"><span class="linenos">459</span></a><span class="sd">        50%     136.000000   194.000000   -63.878076   -59.597437   -64.977491   -69.607516  ...     5.612046   -97.569676   112.772998   -97.956322   112.956483      225.617493</span>
</span><span id="DisulfideLoader-460"><a href="#DisulfideLoader-460"><span class="linenos">460</span></a><span class="sd">        75%     310.000000   361.000000   -47.459809    82.078365    94.169603    69.488862  ...     6.112471   -69.670087   143.781003   -70.485076   142.808862      263.003492</span>
</span><span id="DisulfideLoader-461"><a href="#DisulfideLoader-461"><span class="linenos">461</span></a><span class="sd">        max    2592.000000  2599.000000   179.918814   179.987671   179.554652   179.977181  ...    75.611323   177.021502   179.856474   178.886602   179.735964      368.022621</span>
</span><span id="DisulfideLoader-462"><a href="#DisulfideLoader-462"><span class="linenos">462</span></a><span class="sd">        &lt;BLANKLINE&gt;</span>
</span><span id="DisulfideLoader-463"><a href="#DisulfideLoader-463"><span class="linenos">463</span></a><span class="sd">        [8 rows x 14 columns]</span>
</span><span id="DisulfideLoader-464"><a href="#DisulfideLoader-464"><span class="linenos">464</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-465"><a href="#DisulfideLoader-465"><span class="linenos">465</span></a>        <span class="n">res_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="DisulfideLoader-466"><a href="#DisulfideLoader-466"><span class="linenos">466</span></a>
</span><span id="DisulfideLoader-467"><a href="#DisulfideLoader-467"><span class="linenos">467</span></a>        <span class="k">if</span> <span class="n">pdbID</span><span class="p">:</span>
</span><span id="DisulfideLoader-468"><a href="#DisulfideLoader-468"><span class="linenos">468</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="DisulfideLoader-469"><a href="#DisulfideLoader-469"><span class="linenos">469</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">[</span><span class="n">pdbID</span><span class="p">]</span>
</span><span id="DisulfideLoader-470"><a href="#DisulfideLoader-470"><span class="linenos">470</span></a>                <span class="n">sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">pdbID</span>
</span><span id="DisulfideLoader-471"><a href="#DisulfideLoader-471"><span class="linenos">471</span></a>                <span class="n">res_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">[</span><span class="n">sel</span><span class="p">]</span>
</span><span id="DisulfideLoader-472"><a href="#DisulfideLoader-472"><span class="linenos">472</span></a>                <span class="k">return</span> <span class="n">res_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DisulfideLoader-473"><a href="#DisulfideLoader-473"><span class="linenos">473</span></a>            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="DisulfideLoader-474"><a href="#DisulfideLoader-474"><span class="linenos">474</span></a>                <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;! Cannot find key </span><span class="si">{</span><span class="n">pdbID</span><span class="si">}</span><span class="s1"> in SSBond DB&#39;</span>
</span><span id="DisulfideLoader-475"><a href="#DisulfideLoader-475"><span class="linenos">475</span></a>                <span class="k">raise</span> <span class="n">DisulfideParseWarning</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
</span><span id="DisulfideLoader-476"><a href="#DisulfideLoader-476"><span class="linenos">476</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideLoader-477"><a href="#DisulfideLoader-477"><span class="linenos">477</span></a>            <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">)</span>
</span><span id="DisulfideLoader-478"><a href="#DisulfideLoader-478"><span class="linenos">478</span></a>    
</span><span id="DisulfideLoader-479"><a href="#DisulfideLoader-479"><span class="linenos">479</span></a>    <span class="k">def</span> <span class="nf">list_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideLoader-480"><a href="#DisulfideLoader-480"><span class="linenos">480</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classdict</span><span class="p">):</span>
</span><span id="DisulfideLoader-481"><a href="#DisulfideLoader-481"><span class="linenos">481</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Class: |</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">|, |</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1">|&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-482"><a href="#DisulfideLoader-482"><span class="linenos">482</span></a>
</span><span id="DisulfideLoader-483"><a href="#DisulfideLoader-483"><span class="linenos">483</span></a>    <span class="nd">@property</span>
</span><span id="DisulfideLoader-484"><a href="#DisulfideLoader-484"><span class="linenos">484</span></a>    <span class="k">def</span> <span class="nf">quiet</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="DisulfideLoader-485"><a href="#DisulfideLoader-485"><span class="linenos">485</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-486"><a href="#DisulfideLoader-486"><span class="linenos">486</span></a><span class="sd">        The loader quiet state</span>
</span><span id="DisulfideLoader-487"><a href="#DisulfideLoader-487"><span class="linenos">487</span></a>
</span><span id="DisulfideLoader-488"><a href="#DisulfideLoader-488"><span class="linenos">488</span></a><span class="sd">        :return: quiet parameter</span>
</span><span id="DisulfideLoader-489"><a href="#DisulfideLoader-489"><span class="linenos">489</span></a><span class="sd">        :rtype: bool</span>
</span><span id="DisulfideLoader-490"><a href="#DisulfideLoader-490"><span class="linenos">490</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-491"><a href="#DisulfideLoader-491"><span class="linenos">491</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">QUIET</span>
</span><span id="DisulfideLoader-492"><a href="#DisulfideLoader-492"><span class="linenos">492</span></a>
</span><span id="DisulfideLoader-493"><a href="#DisulfideLoader-493"><span class="linenos">493</span></a>    <span class="nd">@quiet</span><span class="o">.</span><span class="n">setter</span>
</span><span id="DisulfideLoader-494"><a href="#DisulfideLoader-494"><span class="linenos">494</span></a>    <span class="k">def</span> <span class="nf">quiet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">perm</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideLoader-495"><a href="#DisulfideLoader-495"><span class="linenos">495</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-496"><a href="#DisulfideLoader-496"><span class="linenos">496</span></a><span class="sd">        Sets the quiet attribute for the loader. This silences many of the BIO.PDB warnings.</span>
</span><span id="DisulfideLoader-497"><a href="#DisulfideLoader-497"><span class="linenos">497</span></a>
</span><span id="DisulfideLoader-498"><a href="#DisulfideLoader-498"><span class="linenos">498</span></a><span class="sd">        :param perm: True or False</span>
</span><span id="DisulfideLoader-499"><a href="#DisulfideLoader-499"><span class="linenos">499</span></a><span class="sd">        :type perm: bool</span>
</span><span id="DisulfideLoader-500"><a href="#DisulfideLoader-500"><span class="linenos">500</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-501"><a href="#DisulfideLoader-501"><span class="linenos">501</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">QUIET</span> <span class="o">=</span> <span class="n">perm</span>
</span><span id="DisulfideLoader-502"><a href="#DisulfideLoader-502"><span class="linenos">502</span></a>    
</span><span id="DisulfideLoader-503"><a href="#DisulfideLoader-503"><span class="linenos">503</span></a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">savepath</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">):</span>
</span><span id="DisulfideLoader-504"><a href="#DisulfideLoader-504"><span class="linenos">504</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-505"><a href="#DisulfideLoader-505"><span class="linenos">505</span></a><span class="sd">        Save a copy of the fully instantiated Loader to the specified file.</span>
</span><span id="DisulfideLoader-506"><a href="#DisulfideLoader-506"><span class="linenos">506</span></a>
</span><span id="DisulfideLoader-507"><a href="#DisulfideLoader-507"><span class="linenos">507</span></a><span class="sd">        :param savepath: Path to save the file, defaults to DATA_DIR</span>
</span><span id="DisulfideLoader-508"><a href="#DisulfideLoader-508"><span class="linenos">508</span></a><span class="sd">        :param fname: Filename, defaults to LOADER_FNAME</span>
</span><span id="DisulfideLoader-509"><a href="#DisulfideLoader-509"><span class="linenos">509</span></a><span class="sd">        :param verbose: Verbosity, defaults to False</span>
</span><span id="DisulfideLoader-510"><a href="#DisulfideLoader-510"><span class="linenos">510</span></a><span class="sd">        :param cutoff: Distance cutoff used to build the database, -1 means no cutoff.</span>
</span><span id="DisulfideLoader-511"><a href="#DisulfideLoader-511"><span class="linenos">511</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-512"><a href="#DisulfideLoader-512"><span class="linenos">512</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">=</span> <span class="n">cutoff</span>
</span><span id="DisulfideLoader-513"><a href="#DisulfideLoader-513"><span class="linenos">513</span></a>        <span class="k">if</span> <span class="n">subset</span><span class="p">:</span>
</span><span id="DisulfideLoader-514"><a href="#DisulfideLoader-514"><span class="linenos">514</span></a>            <span class="n">fname</span> <span class="o">=</span> <span class="n">LOADER_SUBSET_FNAME</span>
</span><span id="DisulfideLoader-515"><a href="#DisulfideLoader-515"><span class="linenos">515</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideLoader-516"><a href="#DisulfideLoader-516"><span class="linenos">516</span></a>            <span class="n">fname</span> <span class="o">=</span> <span class="n">LOADER_FNAME</span>
</span><span id="DisulfideLoader-517"><a href="#DisulfideLoader-517"><span class="linenos">517</span></a>
</span><span id="DisulfideLoader-518"><a href="#DisulfideLoader-518"><span class="linenos">518</span></a>        <span class="n">_fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">savepath</span><span class="si">}{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="DisulfideLoader-519"><a href="#DisulfideLoader-519"><span class="linenos">519</span></a>
</span><span id="DisulfideLoader-520"><a href="#DisulfideLoader-520"><span class="linenos">520</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader-521"><a href="#DisulfideLoader-521"><span class="linenos">521</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; DisulfideLoader.save(): Writing </span><span class="si">{</span><span class="n">_fname</span><span class="si">}</span><span class="s1">... &#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-522"><a href="#DisulfideLoader-522"><span class="linenos">522</span></a>        
</span><span id="DisulfideLoader-523"><a href="#DisulfideLoader-523"><span class="linenos">523</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">_fname</span><span class="p">,</span> <span class="s1">&#39;wb+&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="DisulfideLoader-524"><a href="#DisulfideLoader-524"><span class="linenos">524</span></a>            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="DisulfideLoader-525"><a href="#DisulfideLoader-525"><span class="linenos">525</span></a>        
</span><span id="DisulfideLoader-526"><a href="#DisulfideLoader-526"><span class="linenos">526</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader-527"><a href="#DisulfideLoader-527"><span class="linenos">527</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; DisulfideLoader.save(): Done.&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-528"><a href="#DisulfideLoader-528"><span class="linenos">528</span></a>    
</span><span id="DisulfideLoader-529"><a href="#DisulfideLoader-529"><span class="linenos">529</span></a>    <span class="k">def</span> <span class="nf">from_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="DisulfideLoader-530"><a href="#DisulfideLoader-530"><span class="linenos">530</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-531"><a href="#DisulfideLoader-531"><span class="linenos">531</span></a><span class="sd">        Return a list of disulfides corresponding to the input class ID</span>
</span><span id="DisulfideLoader-532"><a href="#DisulfideLoader-532"><span class="linenos">532</span></a><span class="sd">        string.</span>
</span><span id="DisulfideLoader-533"><a href="#DisulfideLoader-533"><span class="linenos">533</span></a>
</span><span id="DisulfideLoader-534"><a href="#DisulfideLoader-534"><span class="linenos">534</span></a><span class="sd">        :param classid: Class ID, e.g. &#39;+RHStaple&#39;</span>
</span><span id="DisulfideLoader-535"><a href="#DisulfideLoader-535"><span class="linenos">535</span></a><span class="sd">        :return: DisulfideList of class members</span>
</span><span id="DisulfideLoader-536"><a href="#DisulfideLoader-536"><span class="linenos">536</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader-537"><a href="#DisulfideLoader-537"><span class="linenos">537</span></a>        <span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</span><span id="DisulfideLoader-538"><a href="#DisulfideLoader-538"><span class="linenos">538</span></a>        <span class="kn">from</span> <span class="nn">proteusPy.ProteusGlobals</span> <span class="kn">import</span> <span class="n">PBAR_COLS</span>
</span><span id="DisulfideLoader-539"><a href="#DisulfideLoader-539"><span class="linenos">539</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="n">classid</span><span class="p">)</span>
</span><span id="DisulfideLoader-540"><a href="#DisulfideLoader-540"><span class="linenos">540</span></a>
</span><span id="DisulfideLoader-541"><a href="#DisulfideLoader-541"><span class="linenos">541</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DisulfideLoader-542"><a href="#DisulfideLoader-542"><span class="linenos">542</span></a>            <span class="n">sslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span><span class="p">[</span><span class="n">classid</span><span class="p">]</span>
</span><span id="DisulfideLoader-543"><a href="#DisulfideLoader-543"><span class="linenos">543</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader-544"><a href="#DisulfideLoader-544"><span class="linenos">544</span></a>                <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">sslist</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">PBAR_COLS</span><span class="p">)</span>
</span><span id="DisulfideLoader-545"><a href="#DisulfideLoader-545"><span class="linenos">545</span></a>                <span class="k">for</span> <span class="n">ssid</span> <span class="ow">in</span> <span class="n">pbar</span><span class="p">:</span>
</span><span id="DisulfideLoader-546"><a href="#DisulfideLoader-546"><span class="linenos">546</span></a>                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ssid</span><span class="p">])</span>
</span><span id="DisulfideLoader-547"><a href="#DisulfideLoader-547"><span class="linenos">547</span></a>                <span class="k">return</span> <span class="n">res</span>
</span><span id="DisulfideLoader-548"><a href="#DisulfideLoader-548"><span class="linenos">548</span></a>
</span><span id="DisulfideLoader-549"><a href="#DisulfideLoader-549"><span class="linenos">549</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([</span><span class="bp">self</span><span class="p">[</span><span class="n">ssid</span><span class="p">]</span> <span class="k">for</span> <span class="n">ssid</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">],</span> <span class="n">classid</span><span class="p">)</span>
</span><span id="DisulfideLoader-550"><a href="#DisulfideLoader-550"><span class="linenos">550</span></a>            <span class="k">return</span> <span class="n">res</span>
</span><span id="DisulfideLoader-551"><a href="#DisulfideLoader-551"><span class="linenos">551</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="DisulfideLoader-552"><a href="#DisulfideLoader-552"><span class="linenos">552</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No class: </span><span class="si">{</span><span class="n">classid</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader-553"><a href="#DisulfideLoader-553"><span class="linenos">553</span></a>        <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>This class represents the disulfide database itself and is its primary means of accession. 
The entirety of the RCSB disulfide database is stored within the class via a
<a href="DisulfideList.html#DisulfideList">proteusPy.DisulfideList.DisulfideList</a>, a <code>Pandas</code> .csv file, and a <code>dict</code> of
indices mapping the PDB IDs into their respective list of disulfides. The datastructures allow
simple, direct and flexible access to the disulfide structures contained herein. 
This makes it possible to access the disulfides by array index, PDB structure ID or disulfide name.</p>

<p>The class can also render Disulfides overlaid on a common coordinate system to a pyVista window using the 
<a href="#DisulfideLoader.display_overlay">display_overlay()</a> method. See below for examples.</p>

<p>Important note: For typical usage one will access the database via the <code><a href="#Load_PDB_SS">Load_PDB_SS()</a></code> function.
The difference is that the latter function loads the compressed database from its single
source. the <code><a href="#Load_PDB_SS">Load_PDB_SS()</a></code> function will load the individual torsions and disulfide .pkl,
builds the classlist structures.</p>

<p><em>Developer's Notes:</em>
The .pkl files needed to instantiate this class and save it into its final .pkl file are
defined in the <a href="data.html">proteusPy.data</a> class and should not be changed. Upon initialization the class
will load them and initialize itself. </p>

<p>Example:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">proteusPy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="Disulfide.html">proteusPy.Disulfide</a></span> <span class="kn">import</span> <span class="n">Disulfide</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="">proteusPy.DisulfideLoader</a></span> <span class="kn">import</span> <span class="n">DisulfideLoader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="DisulfideList.html">proteusPy.DisulfideList</a></span> <span class="kn">import</span> <span class="n">DisulfideList</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SS1</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span><span class="s1">&#39;tmp1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SS2</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span><span class="s1">&#39;tmp2&#39;</span><span class="p">)</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">PDB_SS</span> <span class="o">=</span> <span class="n">DisulfideLoader</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre>
</div>

<p>Accessing by index value:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">SS1</span> <span class="o">=</span> <span class="n">PDB_SS</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SS1</span>
<span class="go">&lt;Disulfide 4yys_22A_65A, Source: 4yys, Resolution: 1.35 Å&gt;</span>
</code></pre>
</div>

<p>Accessing by PDB_ID returns a list of Disulfides:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">SS2</span> <span class="o">=</span> <span class="n">PDB_SS</span><span class="p">[</span><span class="s1">&#39;4yys&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SS2</span>
<span class="go">[&lt;Disulfide 4yys_22A_65A, Source: 4yys, Resolution: 1.35 Å&gt;, &lt;Disulfide 4yys_56A_98A, Source: 4yys, Resolution: 1.35 Å&gt;, &lt;Disulfide 4yys_156A_207A, Source: 4yys, Resolution: 1.35 Å&gt;]</span>
</code></pre>
</div>

<p>Accessing individual disulfides by their name:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">SS3</span> <span class="o">=</span> <span class="n">PDB_SS</span><span class="p">[</span><span class="s1">&#39;4yys_56A_98A&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SS3</span>
<span class="go">&lt;Disulfide 4yys_56A_98A, Source: 4yys, Resolution: 1.35 Å&gt;</span>
</code></pre>
</div>

<p>Finally, we can access disulfides by regular slicing:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">SSlist</span> <span class="o">=</span> <span class="n">PDB_SS</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SSlist</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;sb&#39;</span><span class="p">)</span>
</code></pre>
</div>
</div>


                            <div id="DisulfideLoader.__init__" class="classattr">
                                        <input id="DisulfideLoader.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">DisulfideLoader</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">datadir</span><span class="o">=</span><span class="s1">&#39;/Users/egs/repos/proteusPy/proteusPy/data/&#39;</span>,</span><span class="param">	<span class="n">picklefile</span><span class="o">=</span><span class="s1">&#39;PDB_all_ss.pkl&#39;</span>,</span><span class="param">	<span class="n">pickle_dict_file</span><span class="o">=</span><span class="s1">&#39;PDB_all_ss_dict.pkl&#39;</span>,</span><span class="param">	<span class="n">torsion_file</span><span class="o">=</span><span class="s1">&#39;PDB_all_SS_torsions.csv&#39;</span>,</span><span class="param">	<span class="n">quiet</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">subset</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">cutoff</span><span class="o">=-</span><span class="mf">1.0</span></span>)</span>

                <label class="view-source-button" for="DisulfideLoader.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.__init__-94"><a href="#DisulfideLoader.__init__-94"><span class="linenos"> 94</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">datadir</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="n">picklefile</span><span class="o">=</span><span class="n">SS_PICKLE_FILE</span><span class="p">,</span> 
</span><span id="DisulfideLoader.__init__-95"><a href="#DisulfideLoader.__init__-95"><span class="linenos"> 95</span></a>                <span class="n">pickle_dict_file</span><span class="o">=</span><span class="n">SS_DICT_PICKLE_FILE</span><span class="p">,</span>
</span><span id="DisulfideLoader.__init__-96"><a href="#DisulfideLoader.__init__-96"><span class="linenos"> 96</span></a>                <span class="n">torsion_file</span><span class="o">=</span><span class="n">SS_TORSIONS_FILE</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
</span><span id="DisulfideLoader.__init__-97"><a href="#DisulfideLoader.__init__-97"><span class="linenos"> 97</span></a>                <span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="DisulfideLoader.__init__-98"><a href="#DisulfideLoader.__init__-98"><span class="linenos"> 98</span></a>                <span class="n">cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">):</span>
</span><span id="DisulfideLoader.__init__-99"><a href="#DisulfideLoader.__init__-99"><span class="linenos"> 99</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader.__init__-100"><a href="#DisulfideLoader.__init__-100"><span class="linenos">100</span></a><span class="sd">        Initializing the class initiates loading either the entire Disulfide dataset,</span>
</span><span id="DisulfideLoader.__init__-101"><a href="#DisulfideLoader.__init__-101"><span class="linenos">101</span></a><span class="sd">        or the &#39;subset&#39;, which consists of the first 1000 PDB structures. The subset</span>
</span><span id="DisulfideLoader.__init__-102"><a href="#DisulfideLoader.__init__-102"><span class="linenos">102</span></a><span class="sd">        is useful for testing and debugging since it doesn&#39;t require nearly as much</span>
</span><span id="DisulfideLoader.__init__-103"><a href="#DisulfideLoader.__init__-103"><span class="linenos">103</span></a><span class="sd">        memory or time. The name for the subset file is hard-coded. One can pass a</span>
</span><span id="DisulfideLoader.__init__-104"><a href="#DisulfideLoader.__init__-104"><span class="linenos">104</span></a><span class="sd">        different data directory and file names for the pickle files. These different</span>
</span><span id="DisulfideLoader.__init__-105"><a href="#DisulfideLoader.__init__-105"><span class="linenos">105</span></a><span class="sd">        directories are normally established with the proteusPy.Disulfide.Extract_Disulfides </span>
</span><span id="DisulfideLoader.__init__-106"><a href="#DisulfideLoader.__init__-106"><span class="linenos">106</span></a><span class="sd">        function.</span>
</span><span id="DisulfideLoader.__init__-107"><a href="#DisulfideLoader.__init__-107"><span class="linenos">107</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader.__init__-108"><a href="#DisulfideLoader.__init__-108"><span class="linenos">108</span></a>
</span><span id="DisulfideLoader.__init__-109"><a href="#DisulfideLoader.__init__-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ModelDir</span> <span class="o">=</span> <span class="n">datadir</span>
</span><span id="DisulfideLoader.__init__-110"><a href="#DisulfideLoader.__init__-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">picklefile</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="DisulfideLoader.__init__-111"><a href="#DisulfideLoader.__init__-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">PickleDictFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">pickle_dict_file</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="DisulfideLoader.__init__-112"><a href="#DisulfideLoader.__init__-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">PickleClassFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">SS_CLASS_DICT_FILE</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="DisulfideLoader.__init__-113"><a href="#DisulfideLoader.__init__-113"><span class="linenos">113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">TorsionFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">torsion_file</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="DisulfideLoader.__init__-114"><a href="#DisulfideLoader.__init__-114"><span class="linenos">114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s1">&#39;ALL_PDB_SS&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.__init__-115"><a href="#DisulfideLoader.__init__-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideLoader.__init__-116"><a href="#DisulfideLoader.__init__-116"><span class="linenos">116</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="DisulfideLoader.__init__-117"><a href="#DisulfideLoader.__init__-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DisulfideLoader.__init__-118"><a href="#DisulfideLoader.__init__-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">IDList</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DisulfideLoader.__init__-119"><a href="#DisulfideLoader.__init__-119"><span class="linenos">119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">QUIET</span> <span class="o">=</span> <span class="n">quiet</span>
</span><span id="DisulfideLoader.__init__-120"><a href="#DisulfideLoader.__init__-120"><span class="linenos">120</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideLoader.__init__-121"><a href="#DisulfideLoader.__init__-121"><span class="linenos">121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdf</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideLoader.__init__-122"><a href="#DisulfideLoader.__init__-122"><span class="linenos">122</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">=</span> <span class="n">cutoff</span>
</span><span id="DisulfideLoader.__init__-123"><a href="#DisulfideLoader.__init__-123"><span class="linenos">123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="DisulfideLoader.__init__-124"><a href="#DisulfideLoader.__init__-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="DisulfideLoader.__init__-125"><a href="#DisulfideLoader.__init__-125"><span class="linenos">125</span></a>
</span><span id="DisulfideLoader.__init__-126"><a href="#DisulfideLoader.__init__-126"><span class="linenos">126</span></a>        <span class="n">idlist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DisulfideLoader.__init__-127"><a href="#DisulfideLoader.__init__-127"><span class="linenos">127</span></a>
</span><span id="DisulfideLoader.__init__-128"><a href="#DisulfideLoader.__init__-128"><span class="linenos">128</span></a>        <span class="k">if</span> <span class="n">subset</span><span class="p">:</span>
</span><span id="DisulfideLoader.__init__-129"><a href="#DisulfideLoader.__init__-129"><span class="linenos">129</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">SS_SUBSET_PICKLE_FILE</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="DisulfideLoader.__init__-130"><a href="#DisulfideLoader.__init__-130"><span class="linenos">130</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">PickleDictFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">SS_SUBSET_DICT_PICKLE_FILE</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="DisulfideLoader.__init__-131"><a href="#DisulfideLoader.__init__-131"><span class="linenos">131</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">TorsionFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">SS_SUBSET_TORSIONS_FILE</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="DisulfideLoader.__init__-132"><a href="#DisulfideLoader.__init__-132"><span class="linenos">132</span></a>        
</span><span id="DisulfideLoader.__init__-133"><a href="#DisulfideLoader.__init__-133"><span class="linenos">133</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader.__init__-134"><a href="#DisulfideLoader.__init__-134"><span class="linenos">134</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; DisulfideLoader(): Reading disulfides from: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="si">}</span><span class="s1">... &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.__init__-135"><a href="#DisulfideLoader.__init__-135"><span class="linenos">135</span></a>        
</span><span id="DisulfideLoader.__init__-136"><a href="#DisulfideLoader.__init__-136"><span class="linenos">136</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleFile</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="DisulfideLoader.__init__-137"><a href="#DisulfideLoader.__init__-137"><span class="linenos">137</span></a>            <span class="n">sslist</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="DisulfideLoader.__init__-138"><a href="#DisulfideLoader.__init__-138"><span class="linenos">138</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span> <span class="o">=</span> <span class="n">sslist</span>
</span><span id="DisulfideLoader.__init__-139"><a href="#DisulfideLoader.__init__-139"><span class="linenos">139</span></a>
</span><span id="DisulfideLoader.__init__-140"><a href="#DisulfideLoader.__init__-140"><span class="linenos">140</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader.__init__-141"><a href="#DisulfideLoader.__init__-141"><span class="linenos">141</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;done.&#39;</span><span class="p">,)</span>
</span><span id="DisulfideLoader.__init__-142"><a href="#DisulfideLoader.__init__-142"><span class="linenos">142</span></a>
</span><span id="DisulfideLoader.__init__-143"><a href="#DisulfideLoader.__init__-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">)</span>
</span><span id="DisulfideLoader.__init__-144"><a href="#DisulfideLoader.__init__-144"><span class="linenos">144</span></a>        
</span><span id="DisulfideLoader.__init__-145"><a href="#DisulfideLoader.__init__-145"><span class="linenos">145</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader.__init__-146"><a href="#DisulfideLoader.__init__-146"><span class="linenos">146</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; DisulfideLoader(): Reading disulfide dict2 from: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleDictFile</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.__init__-147"><a href="#DisulfideLoader.__init__-147"><span class="linenos">147</span></a>        
</span><span id="DisulfideLoader.__init__-148"><a href="#DisulfideLoader.__init__-148"><span class="linenos">148</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PickleDictFile</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="DisulfideLoader.__init__-149"><a href="#DisulfideLoader.__init__-149"><span class="linenos">149</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="DisulfideLoader.__init__-150"><a href="#DisulfideLoader.__init__-150"><span class="linenos">150</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">:</span>
</span><span id="DisulfideLoader.__init__-151"><a href="#DisulfideLoader.__init__-151"><span class="linenos">151</span></a>                <span class="n">idlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="DisulfideLoader.__init__-152"><a href="#DisulfideLoader.__init__-152"><span class="linenos">152</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">IDList</span> <span class="o">=</span> <span class="n">idlist</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DisulfideLoader.__init__-153"><a href="#DisulfideLoader.__init__-153"><span class="linenos">153</span></a>            <span class="n">totalSS_dict</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IDList</span><span class="p">)</span>
</span><span id="DisulfideLoader.__init__-154"><a href="#DisulfideLoader.__init__-154"><span class="linenos">154</span></a>
</span><span id="DisulfideLoader.__init__-155"><a href="#DisulfideLoader.__init__-155"><span class="linenos">155</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader.__init__-156"><a href="#DisulfideLoader.__init__-156"><span class="linenos">156</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;done.&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.__init__-157"><a href="#DisulfideLoader.__init__-157"><span class="linenos">157</span></a>
</span><span id="DisulfideLoader.__init__-158"><a href="#DisulfideLoader.__init__-158"><span class="linenos">158</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader.__init__-159"><a href="#DisulfideLoader.__init__-159"><span class="linenos">159</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; DisulfideLoader(): Reading Torsion DF from: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">TorsionFile</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.__init__-160"><a href="#DisulfideLoader.__init__-160"><span class="linenos">160</span></a>
</span><span id="DisulfideLoader.__init__-161"><a href="#DisulfideLoader.__init__-161"><span class="linenos">161</span></a>        <span class="n">tmpDF</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TorsionFile</span><span class="p">)</span>
</span><span id="DisulfideLoader.__init__-162"><a href="#DisulfideLoader.__init__-162"><span class="linenos">162</span></a>        <span class="n">tmpDF</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">tmpDF</span><span class="o">.</span><span class="n">columns</span><span class="p">[[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DisulfideLoader.__init__-163"><a href="#DisulfideLoader.__init__-163"><span class="linenos">163</span></a>
</span><span id="DisulfideLoader.__init__-164"><a href="#DisulfideLoader.__init__-164"><span class="linenos">164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span> <span class="o">=</span> <span class="n">tmpDF</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DisulfideLoader.__init__-165"><a href="#DisulfideLoader.__init__-165"><span class="linenos">165</span></a>
</span><span id="DisulfideLoader.__init__-166"><a href="#DisulfideLoader.__init__-166"><span class="linenos">166</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader.__init__-167"><a href="#DisulfideLoader.__init__-167"><span class="linenos">167</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; done.&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.__init__-168"><a href="#DisulfideLoader.__init__-168"><span class="linenos">168</span></a>
</span><span id="DisulfideLoader.__init__-169"><a href="#DisulfideLoader.__init__-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_classes</span><span class="p">()</span>
</span><span id="DisulfideLoader.__init__-170"><a href="#DisulfideLoader.__init__-170"><span class="linenos">170</span></a>
</span><span id="DisulfideLoader.__init__-171"><a href="#DisulfideLoader.__init__-171"><span class="linenos">171</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>    
</span><span id="DisulfideLoader.__init__-172"><a href="#DisulfideLoader.__init__-172"><span class="linenos">172</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; DisulfideLoader(): Loading complete.&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.__init__-173"><a href="#DisulfideLoader.__init__-173"><span class="linenos">173</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</span><span id="DisulfideLoader.__init__-174"><a href="#DisulfideLoader.__init__-174"><span class="linenos">174</span></a>        <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>Initializing the class initiates loading either the entire Disulfide dataset,
or the 'subset', which consists of the first 1000 PDB structures. The subset
is useful for testing and debugging since it doesn't require nearly as much
memory or time. The name for the subset file is hard-coded. One can pass a
different data directory and file names for the pickle files. These different
directories are normally established with the <a href="Disulfide.html#Extract_Disulfides">proteusPy.Disulfide.Extract_Disulfides</a> 
function.</p>
</div>


                            </div>
                            <div id="DisulfideLoader.Average_Resolution" class="classattr">
                                <div class="attr variable">
            <span class="name">Average_Resolution</span><span class="annotation">: float</span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.Average_Resolution"></a>
    
            <div class="docstring"><p>Compute and return the average structure resolution for the given list.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Average resolution (A)</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideLoader.build_classes" class="classattr">
                                        <input id="DisulfideLoader.build_classes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">build_classes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.build_classes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.build_classes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.build_classes-238"><a href="#DisulfideLoader.build_classes-238"><span class="linenos">238</span></a>    <span class="k">def</span> <span class="nf">build_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideLoader.build_classes-239"><a href="#DisulfideLoader.build_classes-239"><span class="linenos">239</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader.build_classes-240"><a href="#DisulfideLoader.build_classes-240"><span class="linenos">240</span></a><span class="sd">        Build the internal dictionary mapping disulfides to class names.</span>
</span><span id="DisulfideLoader.build_classes-241"><a href="#DisulfideLoader.build_classes-241"><span class="linenos">241</span></a>
</span><span id="DisulfideLoader.build_classes-242"><a href="#DisulfideLoader.build_classes-242"><span class="linenos">242</span></a><span class="sd">        Disulfide classes are defined using the +/- formalism described by </span>
</span><span id="DisulfideLoader.build_classes-243"><a href="#DisulfideLoader.build_classes-243"><span class="linenos">243</span></a><span class="sd">        Hogg et al. (Biochem, 2006, 45, 7429-7433), across all 32 (2^5), possible </span>
</span><span id="DisulfideLoader.build_classes-244"><a href="#DisulfideLoader.build_classes-244"><span class="linenos">244</span></a><span class="sd">        binary sidechain torsional combinations. Classes are named per Hogg&#39;s convention.</span>
</span><span id="DisulfideLoader.build_classes-245"><a href="#DisulfideLoader.build_classes-245"><span class="linenos">245</span></a><span class="sd">        The ``class_id`` represents the sign of each dihedral angle $\chi_{1} - \chi_{1&#39;}$</span>
</span><span id="DisulfideLoader.build_classes-246"><a href="#DisulfideLoader.build_classes-246"><span class="linenos">246</span></a><span class="sd">        where *0* repreents *negative* dihedral angle and *2* a *positive* angle.</span>
</span><span id="DisulfideLoader.build_classes-247"><a href="#DisulfideLoader.build_classes-247"><span class="linenos">247</span></a>
</span><span id="DisulfideLoader.build_classes-248"><a href="#DisulfideLoader.build_classes-248"><span class="linenos">248</span></a><span class="sd">        |   class_id | SS_Classname   | FXN        |   count |   incidence |</span>
</span><span id="DisulfideLoader.build_classes-249"><a href="#DisulfideLoader.build_classes-249"><span class="linenos">249</span></a><span class="sd">        |-----------:|:---------------|:-----------|--------:|------------:|</span>
</span><span id="DisulfideLoader.build_classes-250"><a href="#DisulfideLoader.build_classes-250"><span class="linenos">250</span></a><span class="sd">        |      00000 | -LHSpiral      | UNK        |   31513 |  0.261092   |</span>
</span><span id="DisulfideLoader.build_classes-251"><a href="#DisulfideLoader.build_classes-251"><span class="linenos">251</span></a><span class="sd">        |      00002 | 00002          | UNK        |    5805 |  0.0480956  |</span>
</span><span id="DisulfideLoader.build_classes-252"><a href="#DisulfideLoader.build_classes-252"><span class="linenos">252</span></a><span class="sd">        |      00020 | -LHHook        | UNK        |    3413 |  0.0282774  |</span>
</span><span id="DisulfideLoader.build_classes-253"><a href="#DisulfideLoader.build_classes-253"><span class="linenos">253</span></a><span class="sd">        |      00022 | 00022          | UNK        |    1940 |  0.0160733  |</span>
</span><span id="DisulfideLoader.build_classes-254"><a href="#DisulfideLoader.build_classes-254"><span class="linenos">254</span></a><span class="sd">        |      00200 | -RHStaple      | Allosteric |   12735 |  0.105512   |</span>
</span><span id="DisulfideLoader.build_classes-255"><a href="#DisulfideLoader.build_classes-255"><span class="linenos">255</span></a><span class="sd">        |      00202 | 00202          | UNK        |     993 |  0.00822721 |</span>
</span><span id="DisulfideLoader.build_classes-256"><a href="#DisulfideLoader.build_classes-256"><span class="linenos">256</span></a><span class="sd">        |      00220 | 00220          | UNK        |    5674 |  0.0470103  |</span>
</span><span id="DisulfideLoader.build_classes-257"><a href="#DisulfideLoader.build_classes-257"><span class="linenos">257</span></a><span class="sd">        |      00222 | 00222          | UNK        |    5092 |  0.0421883  |</span>
</span><span id="DisulfideLoader.build_classes-258"><a href="#DisulfideLoader.build_classes-258"><span class="linenos">258</span></a><span class="sd">        |      02000 | 02000          | UNK        |    4749 |  0.0393465  |</span>
</span><span id="DisulfideLoader.build_classes-259"><a href="#DisulfideLoader.build_classes-259"><span class="linenos">259</span></a><span class="sd">        |      02002 | 02002          | UNK        |    3774 |  0.0312684  |</span>
</span><span id="DisulfideLoader.build_classes-260"><a href="#DisulfideLoader.build_classes-260"><span class="linenos">260</span></a><span class="sd">        |      02020 | -LHStaple      | UNK        |    1494 |  0.0123781  |</span>
</span><span id="DisulfideLoader.build_classes-261"><a href="#DisulfideLoader.build_classes-261"><span class="linenos">261</span></a><span class="sd">        |      02022 | 02022          | UNK        |     591 |  0.00489656 |</span>
</span><span id="DisulfideLoader.build_classes-262"><a href="#DisulfideLoader.build_classes-262"><span class="linenos">262</span></a><span class="sd">        |      02200 | -RHHook        | UNK        |    5090 |  0.0421717  |</span>
</span><span id="DisulfideLoader.build_classes-263"><a href="#DisulfideLoader.build_classes-263"><span class="linenos">263</span></a><span class="sd">        |      02202 | 02202          | UNK        |     533 |  0.00441602 |</span>
</span><span id="DisulfideLoader.build_classes-264"><a href="#DisulfideLoader.build_classes-264"><span class="linenos">264</span></a><span class="sd">        |      02220 | -RHSpiral      | UNK        |    6751 |  0.0559335  |</span>
</span><span id="DisulfideLoader.build_classes-265"><a href="#DisulfideLoader.build_classes-265"><span class="linenos">265</span></a><span class="sd">        |      02222 | 02222          | UNK        |    3474 |  0.0287828  |</span>
</span><span id="DisulfideLoader.build_classes-266"><a href="#DisulfideLoader.build_classes-266"><span class="linenos">266</span></a><span class="sd">        |      20000 | +/-LHSpiral    | UNK        |    3847 |  0.0318732  |</span>
</span><span id="DisulfideLoader.build_classes-267"><a href="#DisulfideLoader.build_classes-267"><span class="linenos">267</span></a><span class="sd">        |      20002 | +LHSpiral      | UNK        |     875 |  0.00724956 |</span>
</span><span id="DisulfideLoader.build_classes-268"><a href="#DisulfideLoader.build_classes-268"><span class="linenos">268</span></a><span class="sd">        |      20020 | +/-LHHook      | UNK        |     803 |  0.00665302 |</span>
</span><span id="DisulfideLoader.build_classes-269"><a href="#DisulfideLoader.build_classes-269"><span class="linenos">269</span></a><span class="sd">        |      20022 | +LHHook        | UNK        |     602 |  0.0049877  |</span>
</span><span id="DisulfideLoader.build_classes-270"><a href="#DisulfideLoader.build_classes-270"><span class="linenos">270</span></a><span class="sd">        |      20200 | +/-RHStaple    | UNK        |     419 |  0.0034715  |</span>
</span><span id="DisulfideLoader.build_classes-271"><a href="#DisulfideLoader.build_classes-271"><span class="linenos">271</span></a><span class="sd">        |      20202 | +RHStaple      | UNK        |     293 |  0.00242757 |</span>
</span><span id="DisulfideLoader.build_classes-272"><a href="#DisulfideLoader.build_classes-272"><span class="linenos">272</span></a><span class="sd">        |      20220 | +/-RHHook      | Catalytic  |    1435 |  0.0118893  |</span>
</span><span id="DisulfideLoader.build_classes-273"><a href="#DisulfideLoader.build_classes-273"><span class="linenos">273</span></a><span class="sd">        |      20222 | 20222          | UNK        |     488 |  0.00404318 |</span>
</span><span id="DisulfideLoader.build_classes-274"><a href="#DisulfideLoader.build_classes-274"><span class="linenos">274</span></a><span class="sd">        |      22000 | -/+LHHook      | UNK        |    2455 |  0.0203402  |</span>
</span><span id="DisulfideLoader.build_classes-275"><a href="#DisulfideLoader.build_classes-275"><span class="linenos">275</span></a><span class="sd">        |      22002 | 22002          | UNK        |    1027 |  0.00850891 |</span>
</span><span id="DisulfideLoader.build_classes-276"><a href="#DisulfideLoader.build_classes-276"><span class="linenos">276</span></a><span class="sd">        |      22020 | +/-LHStaple    | UNK        |    1046 |  0.00866633 |</span>
</span><span id="DisulfideLoader.build_classes-277"><a href="#DisulfideLoader.build_classes-277"><span class="linenos">277</span></a><span class="sd">        |      22022 | +LHStaple      | UNK        |     300 |  0.00248556 |</span>
</span><span id="DisulfideLoader.build_classes-278"><a href="#DisulfideLoader.build_classes-278"><span class="linenos">278</span></a><span class="sd">        |      22200 | -/+RHHook      | UNK        |    6684 |  0.0553783  |</span>
</span><span id="DisulfideLoader.build_classes-279"><a href="#DisulfideLoader.build_classes-279"><span class="linenos">279</span></a><span class="sd">        |      22202 | +RHHook        | UNK        |     593 |  0.00491313 |</span>
</span><span id="DisulfideLoader.build_classes-280"><a href="#DisulfideLoader.build_classes-280"><span class="linenos">280</span></a><span class="sd">        |      22220 | +/-RHSpiral    | UNK        |    2544 |  0.0210776  |</span>
</span><span id="DisulfideLoader.build_classes-281"><a href="#DisulfideLoader.build_classes-281"><span class="linenos">281</span></a><span class="sd">        |      22222 | +RHSpiral      | UNK        |    3665 |  0.0303653  |</span>
</span><span id="DisulfideLoader.build_classes-282"><a href="#DisulfideLoader.build_classes-282"><span class="linenos">282</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader.build_classes-283"><a href="#DisulfideLoader.build_classes-283"><span class="linenos">283</span></a>
</span><span id="DisulfideLoader.build_classes-284"><a href="#DisulfideLoader.build_classes-284"><span class="linenos">284</span></a>        <span class="k">def</span> <span class="nf">ss_id_dict</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
</span><span id="DisulfideLoader.build_classes-285"><a href="#DisulfideLoader.build_classes-285"><span class="linenos">285</span></a>            <span class="n">ss_id_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SS_Classname&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ss_id&#39;</span><span class="p">]))</span>
</span><span id="DisulfideLoader.build_classes-286"><a href="#DisulfideLoader.build_classes-286"><span class="linenos">286</span></a>            <span class="k">return</span> <span class="n">ss_id_dict</span>
</span><span id="DisulfideLoader.build_classes-287"><a href="#DisulfideLoader.build_classes-287"><span class="linenos">287</span></a>
</span><span id="DisulfideLoader.build_classes-288"><a href="#DisulfideLoader.build_classes-288"><span class="linenos">288</span></a>        <span class="n">tors_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTorsions</span><span class="p">()</span>
</span><span id="DisulfideLoader.build_classes-289"><a href="#DisulfideLoader.build_classes-289"><span class="linenos">289</span></a>
</span><span id="DisulfideLoader.build_classes-290"><a href="#DisulfideLoader.build_classes-290"><span class="linenos">290</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader.build_classes-291"><a href="#DisulfideLoader.build_classes-291"><span class="linenos">291</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; build_classes(): creating SS classes...&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.build_classes-292"><a href="#DisulfideLoader.build_classes-292"><span class="linenos">292</span></a>
</span><span id="DisulfideLoader.build_classes-293"><a href="#DisulfideLoader.build_classes-293"><span class="linenos">293</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">create_classes</span><span class="p">(</span><span class="n">tors_df</span><span class="p">)</span>
</span><span id="DisulfideLoader.build_classes-294"><a href="#DisulfideLoader.build_classes-294"><span class="linenos">294</span></a>
</span><span id="DisulfideLoader.build_classes-295"><a href="#DisulfideLoader.build_classes-295"><span class="linenos">295</span></a>        <span class="c1"># grouped.to_csv(f&#39;{DATA_DIR}PDB_ss_classes.csv&#39;)</span>
</span><span id="DisulfideLoader.build_classes-296"><a href="#DisulfideLoader.build_classes-296"><span class="linenos">296</span></a>        <span class="c1">#if self.verbose:</span>
</span><span id="DisulfideLoader.build_classes-297"><a href="#DisulfideLoader.build_classes-297"><span class="linenos">297</span></a>        <span class="c1">#    print(f&#39;{grouped.head(32)}&#39;)</span>
</span><span id="DisulfideLoader.build_classes-298"><a href="#DisulfideLoader.build_classes-298"><span class="linenos">298</span></a>        
</span><span id="DisulfideLoader.build_classes-299"><a href="#DisulfideLoader.build_classes-299"><span class="linenos">299</span></a>        <span class="n">class_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">SS_CLASS_DEFINITIONS</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class_id&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;FXN&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;SS_Classname&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">})</span>
</span><span id="DisulfideLoader.build_classes-300"><a href="#DisulfideLoader.build_classes-300"><span class="linenos">300</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s1">&#39;FXN&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="DisulfideLoader.build_classes-301"><a href="#DisulfideLoader.build_classes-301"><span class="linenos">301</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s1">&#39;SS_Classname&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="DisulfideLoader.build_classes-302"><a href="#DisulfideLoader.build_classes-302"><span class="linenos">302</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s1">&#39;class_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="DisulfideLoader.build_classes-303"><a href="#DisulfideLoader.build_classes-303"><span class="linenos">303</span></a>
</span><span id="DisulfideLoader.build_classes-304"><a href="#DisulfideLoader.build_classes-304"><span class="linenos">304</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader.build_classes-305"><a href="#DisulfideLoader.build_classes-305"><span class="linenos">305</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; build_classes(): merging...&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.build_classes-306"><a href="#DisulfideLoader.build_classes-306"><span class="linenos">306</span></a>
</span><span id="DisulfideLoader.build_classes-307"><a href="#DisulfideLoader.build_classes-307"><span class="linenos">307</span></a>        <span class="n">merged</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">concat_dataframes</span><span class="p">(</span><span class="n">class_df</span><span class="p">,</span> <span class="n">grouped</span><span class="p">)</span>
</span><span id="DisulfideLoader.build_classes-308"><a href="#DisulfideLoader.build_classes-308"><span class="linenos">308</span></a>        <span class="n">merged</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Idx&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DisulfideLoader.build_classes-309"><a href="#DisulfideLoader.build_classes-309"><span class="linenos">309</span></a>
</span><span id="DisulfideLoader.build_classes-310"><a href="#DisulfideLoader.build_classes-310"><span class="linenos">310</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdf</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DisulfideLoader.build_classes-311"><a href="#DisulfideLoader.build_classes-311"><span class="linenos">311</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span> <span class="o">=</span> <span class="n">ss_id_dict</span><span class="p">(</span><span class="n">merged</span><span class="p">)</span>
</span><span id="DisulfideLoader.build_classes-312"><a href="#DisulfideLoader.build_classes-312"><span class="linenos">312</span></a>
</span><span id="DisulfideLoader.build_classes-313"><a href="#DisulfideLoader.build_classes-313"><span class="linenos">313</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader.build_classes-314"><a href="#DisulfideLoader.build_classes-314"><span class="linenos">314</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; build_classes(): initialization complete.&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.build_classes-315"><a href="#DisulfideLoader.build_classes-315"><span class="linenos">315</span></a>        
</span><span id="DisulfideLoader.build_classes-316"><a href="#DisulfideLoader.build_classes-316"><span class="linenos">316</span></a>        <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>Build the internal dictionary mapping disulfides to class names.</p>

<p>Disulfide classes are defined using the +/- formalism described by 
Hogg et al. (Biochem, 2006, 45, 7429-7433), across all 32 (2^5), possible 
binary sidechain torsional combinations. Classes are named per Hogg's convention.
The <code>class_id</code> represents the sign of each dihedral angle $\chi_{1} - \chi_{1'}$
where <em>0</em> repreents <em>negative</em> dihedral angle and <em>2</em> a <em>positive</em> angle.</p>

<table>
<thead>
<tr>
  <th style="text-align:right;">class_id</th>
  <th style="text-align:left;">SS_Classname</th>
  <th style="text-align:left;">FXN</th>
  <th style="text-align:right;">count</th>
  <th style="text-align:right;">incidence</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:right;">00000</td>
  <td style="text-align:left;">-LHSpiral</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">31513</td>
  <td style="text-align:right;">0.261092</td>
</tr>
<tr>
  <td style="text-align:right;">00002</td>
  <td style="text-align:left;">00002</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">5805</td>
  <td style="text-align:right;">0.0480956</td>
</tr>
<tr>
  <td style="text-align:right;">00020</td>
  <td style="text-align:left;">-LHHook</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">3413</td>
  <td style="text-align:right;">0.0282774</td>
</tr>
<tr>
  <td style="text-align:right;">00022</td>
  <td style="text-align:left;">00022</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">1940</td>
  <td style="text-align:right;">0.0160733</td>
</tr>
<tr>
  <td style="text-align:right;">00200</td>
  <td style="text-align:left;">-RHStaple</td>
  <td style="text-align:left;">Allosteric</td>
  <td style="text-align:right;">12735</td>
  <td style="text-align:right;">0.105512</td>
</tr>
<tr>
  <td style="text-align:right;">00202</td>
  <td style="text-align:left;">00202</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">993</td>
  <td style="text-align:right;">0.00822721</td>
</tr>
<tr>
  <td style="text-align:right;">00220</td>
  <td style="text-align:left;">00220</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">5674</td>
  <td style="text-align:right;">0.0470103</td>
</tr>
<tr>
  <td style="text-align:right;">00222</td>
  <td style="text-align:left;">00222</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">5092</td>
  <td style="text-align:right;">0.0421883</td>
</tr>
<tr>
  <td style="text-align:right;">02000</td>
  <td style="text-align:left;">02000</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">4749</td>
  <td style="text-align:right;">0.0393465</td>
</tr>
<tr>
  <td style="text-align:right;">02002</td>
  <td style="text-align:left;">02002</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">3774</td>
  <td style="text-align:right;">0.0312684</td>
</tr>
<tr>
  <td style="text-align:right;">02020</td>
  <td style="text-align:left;">-LHStaple</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">1494</td>
  <td style="text-align:right;">0.0123781</td>
</tr>
<tr>
  <td style="text-align:right;">02022</td>
  <td style="text-align:left;">02022</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">591</td>
  <td style="text-align:right;">0.00489656</td>
</tr>
<tr>
  <td style="text-align:right;">02200</td>
  <td style="text-align:left;">-RHHook</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">5090</td>
  <td style="text-align:right;">0.0421717</td>
</tr>
<tr>
  <td style="text-align:right;">02202</td>
  <td style="text-align:left;">02202</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">533</td>
  <td style="text-align:right;">0.00441602</td>
</tr>
<tr>
  <td style="text-align:right;">02220</td>
  <td style="text-align:left;">-RHSpiral</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">6751</td>
  <td style="text-align:right;">0.0559335</td>
</tr>
<tr>
  <td style="text-align:right;">02222</td>
  <td style="text-align:left;">02222</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">3474</td>
  <td style="text-align:right;">0.0287828</td>
</tr>
<tr>
  <td style="text-align:right;">20000</td>
  <td style="text-align:left;">+/-LHSpiral</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">3847</td>
  <td style="text-align:right;">0.0318732</td>
</tr>
<tr>
  <td style="text-align:right;">20002</td>
  <td style="text-align:left;">+LHSpiral</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">875</td>
  <td style="text-align:right;">0.00724956</td>
</tr>
<tr>
  <td style="text-align:right;">20020</td>
  <td style="text-align:left;">+/-LHHook</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">803</td>
  <td style="text-align:right;">0.00665302</td>
</tr>
<tr>
  <td style="text-align:right;">20022</td>
  <td style="text-align:left;">+LHHook</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">602</td>
  <td style="text-align:right;">0.0049877</td>
</tr>
<tr>
  <td style="text-align:right;">20200</td>
  <td style="text-align:left;">+/-RHStaple</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">419</td>
  <td style="text-align:right;">0.0034715</td>
</tr>
<tr>
  <td style="text-align:right;">20202</td>
  <td style="text-align:left;">+RHStaple</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">293</td>
  <td style="text-align:right;">0.00242757</td>
</tr>
<tr>
  <td style="text-align:right;">20220</td>
  <td style="text-align:left;">+/-RHHook</td>
  <td style="text-align:left;">Catalytic</td>
  <td style="text-align:right;">1435</td>
  <td style="text-align:right;">0.0118893</td>
</tr>
<tr>
  <td style="text-align:right;">20222</td>
  <td style="text-align:left;">20222</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">488</td>
  <td style="text-align:right;">0.00404318</td>
</tr>
<tr>
  <td style="text-align:right;">22000</td>
  <td style="text-align:left;">-/+LHHook</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">2455</td>
  <td style="text-align:right;">0.0203402</td>
</tr>
<tr>
  <td style="text-align:right;">22002</td>
  <td style="text-align:left;">22002</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">1027</td>
  <td style="text-align:right;">0.00850891</td>
</tr>
<tr>
  <td style="text-align:right;">22020</td>
  <td style="text-align:left;">+/-LHStaple</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">1046</td>
  <td style="text-align:right;">0.00866633</td>
</tr>
<tr>
  <td style="text-align:right;">22022</td>
  <td style="text-align:left;">+LHStaple</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">300</td>
  <td style="text-align:right;">0.00248556</td>
</tr>
<tr>
  <td style="text-align:right;">22200</td>
  <td style="text-align:left;">-/+RHHook</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">6684</td>
  <td style="text-align:right;">0.0553783</td>
</tr>
<tr>
  <td style="text-align:right;">22202</td>
  <td style="text-align:left;">+RHHook</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">593</td>
  <td style="text-align:right;">0.00491313</td>
</tr>
<tr>
  <td style="text-align:right;">22220</td>
  <td style="text-align:left;">+/-RHSpiral</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">2544</td>
  <td style="text-align:right;">0.0210776</td>
</tr>
<tr>
  <td style="text-align:right;">22222</td>
  <td style="text-align:left;">+RHSpiral</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">3665</td>
  <td style="text-align:right;">0.0303653</td>
</tr>
</tbody>
</table>
</div>


                            </div>
                            <div id="DisulfideLoader.build_ss_from_idlist" class="classattr">
                                        <input id="DisulfideLoader.build_ss_from_idlist-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">build_ss_from_idlist</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">idlist</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.build_ss_from_idlist-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.build_ss_from_idlist"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.build_ss_from_idlist-318"><a href="#DisulfideLoader.build_ss_from_idlist-318"><span class="linenos">318</span></a>    <span class="k">def</span> <span class="nf">build_ss_from_idlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idlist</span><span class="p">):</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-319"><a href="#DisulfideLoader.build_ss_from_idlist-319"><span class="linenos">319</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-320"><a href="#DisulfideLoader.build_ss_from_idlist-320"><span class="linenos">320</span></a><span class="sd">        Given a list of PDBid, return a DisulfideList of Disulfides</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-321"><a href="#DisulfideLoader.build_ss_from_idlist-321"><span class="linenos">321</span></a>
</span><span id="DisulfideLoader.build_ss_from_idlist-322"><a href="#DisulfideLoader.build_ss_from_idlist-322"><span class="linenos">322</span></a><span class="sd">        :param idlist: List of PDBIDs, e.g. [&#39;4yys&#39;, &#39;2q7q&#39;]</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-323"><a href="#DisulfideLoader.build_ss_from_idlist-323"><span class="linenos">323</span></a><span class="sd">        :return: ProteusPy.DisulfideList.DisulfideList of ProteusPy.Disulfide.Disulfide</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-324"><a href="#DisulfideLoader.build_ss_from_idlist-324"><span class="linenos">324</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-325"><a href="#DisulfideLoader.build_ss_from_idlist-325"><span class="linenos">325</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-326"><a href="#DisulfideLoader.build_ss_from_idlist-326"><span class="linenos">326</span></a>        
</span><span id="DisulfideLoader.build_ss_from_idlist-327"><a href="#DisulfideLoader.build_ss_from_idlist-327"><span class="linenos">327</span></a>        <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">idlist</span><span class="p">:</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-328"><a href="#DisulfideLoader.build_ss_from_idlist-328"><span class="linenos">328</span></a>            <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">:</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-329"><a href="#DisulfideLoader.build_ss_from_idlist-329"><span class="linenos">329</span></a>                <span class="k">if</span> <span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span> <span class="o">==</span> <span class="nb">id</span><span class="p">:</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-330"><a href="#DisulfideLoader.build_ss_from_idlist-330"><span class="linenos">330</span></a>                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-331"><a href="#DisulfideLoader.build_ss_from_idlist-331"><span class="linenos">331</span></a>                    <span class="k">break</span>
</span><span id="DisulfideLoader.build_ss_from_idlist-332"><a href="#DisulfideLoader.build_ss_from_idlist-332"><span class="linenos">332</span></a>        <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Given a list of PDBid, return a DisulfideList of Disulfides</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>idlist</strong>:  List of PDBIDs, e.g. ['4yys', '2q7q']</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>ProteusPy.DisulfideList.DisulfideList of ProteusPy.Disulfide.Disulfide</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideLoader.concat_dataframes" class="classattr">
                                        <input id="DisulfideLoader.concat_dataframes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">concat_dataframes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">df1</span>, </span><span class="param"><span class="n">df2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.concat_dataframes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.concat_dataframes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.concat_dataframes-334"><a href="#DisulfideLoader.concat_dataframes-334"><span class="linenos">334</span></a>    <span class="k">def</span> <span class="nf">concat_dataframes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">):</span>
</span><span id="DisulfideLoader.concat_dataframes-335"><a href="#DisulfideLoader.concat_dataframes-335"><span class="linenos">335</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.concat_dataframes-336"><a href="#DisulfideLoader.concat_dataframes-336"><span class="linenos">336</span></a><span class="sd">        Concatenates columns from one data frame into the other and returns the new result.</span>
</span><span id="DisulfideLoader.concat_dataframes-337"><a href="#DisulfideLoader.concat_dataframes-337"><span class="linenos">337</span></a>
</span><span id="DisulfideLoader.concat_dataframes-338"><a href="#DisulfideLoader.concat_dataframes-338"><span class="linenos">338</span></a><span class="sd">        :param df1 : pandas.DataFrame - The first data frame.</span>
</span><span id="DisulfideLoader.concat_dataframes-339"><a href="#DisulfideLoader.concat_dataframes-339"><span class="linenos">339</span></a><span class="sd">        :param df2 : pandas.DataFrame - The second data frame.</span>
</span><span id="DisulfideLoader.concat_dataframes-340"><a href="#DisulfideLoader.concat_dataframes-340"><span class="linenos">340</span></a>
</span><span id="DisulfideLoader.concat_dataframes-341"><a href="#DisulfideLoader.concat_dataframes-341"><span class="linenos">341</span></a><span class="sd">        :return: pandas.DataFrame - The concatenated data frame.</span>
</span><span id="DisulfideLoader.concat_dataframes-342"><a href="#DisulfideLoader.concat_dataframes-342"><span class="linenos">342</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideLoader.concat_dataframes-343"><a href="#DisulfideLoader.concat_dataframes-343"><span class="linenos">343</span></a>        <span class="c1"># Merge the data frames based on the &#39;SS_Classname&#39; column</span>
</span><span id="DisulfideLoader.concat_dataframes-344"><a href="#DisulfideLoader.concat_dataframes-344"><span class="linenos">344</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;class_id&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.concat_dataframes-345"><a href="#DisulfideLoader.concat_dataframes-345"><span class="linenos">345</span></a>
</span><span id="DisulfideLoader.concat_dataframes-346"><a href="#DisulfideLoader.concat_dataframes-346"><span class="linenos">346</span></a>        <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>Concatenates columns from one data frame into the other and returns the new result.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>df1</strong>:  pandas.DataFrame - The first data frame.</li>
<li><strong>df2</strong>:  pandas.DataFrame - The second data frame.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>pandas.DataFrame - The concatenated data frame.</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideLoader.copy" class="classattr">
                                        <input id="DisulfideLoader.copy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">copy</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.copy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.copy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.copy-348"><a href="#DisulfideLoader.copy-348"><span class="linenos">348</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideLoader.copy-349"><a href="#DisulfideLoader.copy-349"><span class="linenos">349</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader.copy-350"><a href="#DisulfideLoader.copy-350"><span class="linenos">350</span></a><span class="sd">        Return a copy of self</span>
</span><span id="DisulfideLoader.copy-351"><a href="#DisulfideLoader.copy-351"><span class="linenos">351</span></a>
</span><span id="DisulfideLoader.copy-352"><a href="#DisulfideLoader.copy-352"><span class="linenos">352</span></a><span class="sd">        :return: Copy of self</span>
</span><span id="DisulfideLoader.copy-353"><a href="#DisulfideLoader.copy-353"><span class="linenos">353</span></a><span class="sd">        :rtype: proteusPy.DisulfideLoader</span>
</span><span id="DisulfideLoader.copy-354"><a href="#DisulfideLoader.copy-354"><span class="linenos">354</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader.copy-355"><a href="#DisulfideLoader.copy-355"><span class="linenos">355</span></a>        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a copy of self</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Copy of self</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideLoader.getlist" class="classattr">
                                        <input id="DisulfideLoader.getlist-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">getlist</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n"><a href="DisulfideList.html#DisulfideList">proteusPy.DisulfideList.DisulfideList</a></span>:</span></span>

                <label class="view-source-button" for="DisulfideLoader.getlist-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.getlist"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.getlist-357"><a href="#DisulfideLoader.getlist-357"><span class="linenos">357</span></a>    <span class="k">def</span> <span class="nf">getlist</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="DisulfideLoader.getlist-358"><a href="#DisulfideLoader.getlist-358"><span class="linenos">358</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader.getlist-359"><a href="#DisulfideLoader.getlist-359"><span class="linenos">359</span></a><span class="sd">        Return the list of Disulfides contained in the class.</span>
</span><span id="DisulfideLoader.getlist-360"><a href="#DisulfideLoader.getlist-360"><span class="linenos">360</span></a>
</span><span id="DisulfideLoader.getlist-361"><a href="#DisulfideLoader.getlist-361"><span class="linenos">361</span></a><span class="sd">        :return: DisulfideList</span>
</span><span id="DisulfideLoader.getlist-362"><a href="#DisulfideLoader.getlist-362"><span class="linenos">362</span></a><span class="sd">        :rtype: DisulfideList</span>
</span><span id="DisulfideLoader.getlist-363"><a href="#DisulfideLoader.getlist-363"><span class="linenos">363</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader.getlist-364"><a href="#DisulfideLoader.getlist-364"><span class="linenos">364</span></a>        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the list of Disulfides contained in the class.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>DisulfideList</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideLoader.describe" class="classattr">
                                        <input id="DisulfideLoader.describe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">describe</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.describe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.describe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.describe-366"><a href="#DisulfideLoader.describe-366"><span class="linenos">366</span></a>    <span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideLoader.describe-367"><a href="#DisulfideLoader.describe-367"><span class="linenos">367</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader.describe-368"><a href="#DisulfideLoader.describe-368"><span class="linenos">368</span></a><span class="sd">        Provides information about the Disulfide database contained in ```self```.</span>
</span><span id="DisulfideLoader.describe-369"><a href="#DisulfideLoader.describe-369"><span class="linenos">369</span></a>
</span><span id="DisulfideLoader.describe-370"><a href="#DisulfideLoader.describe-370"><span class="linenos">370</span></a><span class="sd">        Example:</span>
</span><span id="DisulfideLoader.describe-371"><a href="#DisulfideLoader.describe-371"><span class="linenos">371</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideLoader import Load_PDB_SS</span>
</span><span id="DisulfideLoader.describe-372"><a href="#DisulfideLoader.describe-372"><span class="linenos">372</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = Load_PDB_SS(verbose=False, subset=False)</span>
</span><span id="DisulfideLoader.describe-373"><a href="#DisulfideLoader.describe-373"><span class="linenos">373</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS.describe()</span>
</span><span id="DisulfideLoader.describe-374"><a href="#DisulfideLoader.describe-374"><span class="linenos">374</span></a><span class="sd">            =========== RCSB Disulfide Database Summary ==============</span>
</span><span id="DisulfideLoader.describe-375"><a href="#DisulfideLoader.describe-375"><span class="linenos">375</span></a><span class="sd">        PDB IDs present:                    35818</span>
</span><span id="DisulfideLoader.describe-376"><a href="#DisulfideLoader.describe-376"><span class="linenos">376</span></a><span class="sd">        Disulfides loaded:                  120697</span>
</span><span id="DisulfideLoader.describe-377"><a href="#DisulfideLoader.describe-377"><span class="linenos">377</span></a><span class="sd">        Average structure resolution:       2.34 Å</span>
</span><span id="DisulfideLoader.describe-378"><a href="#DisulfideLoader.describe-378"><span class="linenos">378</span></a><span class="sd">        Lowest Energy Disulfide:            2q7q_75D_140D</span>
</span><span id="DisulfideLoader.describe-379"><a href="#DisulfideLoader.describe-379"><span class="linenos">379</span></a><span class="sd">        Highest Energy Disulfide:           1toz_456A_467A</span>
</span><span id="DisulfideLoader.describe-380"><a href="#DisulfideLoader.describe-380"><span class="linenos">380</span></a><span class="sd">        Total RAM Used:                     29.26 GB.</span>
</span><span id="DisulfideLoader.describe-381"><a href="#DisulfideLoader.describe-381"><span class="linenos">381</span></a>
</span><span id="DisulfideLoader.describe-382"><a href="#DisulfideLoader.describe-382"><span class="linenos">382</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader.describe-383"><a href="#DisulfideLoader.describe-383"><span class="linenos">383</span></a>        <span class="n">vers</span> <span class="o">=</span> <span class="n">proteusPy</span><span class="o">.</span><span class="n">__version__</span>
</span><span id="DisulfideLoader.describe-384"><a href="#DisulfideLoader.describe-384"><span class="linenos">384</span></a>        <span class="n">tot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TotalDisulfides</span>
</span><span id="DisulfideLoader.describe-385"><a href="#DisulfideLoader.describe-385"><span class="linenos">385</span></a>        <span class="n">pdbs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-386"><a href="#DisulfideLoader.describe-386"><span class="linenos">386</span></a>        <span class="n">ram</span> <span class="o">=</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="p">)</span> <span class="o">+</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">)</span> <span class="o">+</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-387"><a href="#DisulfideLoader.describe-387"><span class="linenos">387</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Average_Resolution</span>
</span><span id="DisulfideLoader.describe-388"><a href="#DisulfideLoader.describe-388"><span class="linenos">388</span></a>        <span class="n">cutoff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span>
</span><span id="DisulfideLoader.describe-389"><a href="#DisulfideLoader.describe-389"><span class="linenos">389</span></a>        <span class="n">timestr</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">))</span>
</span><span id="DisulfideLoader.describe-390"><a href="#DisulfideLoader.describe-390"><span class="linenos">390</span></a>        <span class="n">ssMin</span><span class="p">,</span> <span class="n">ssMax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSList</span><span class="o">.</span><span class="n">minmax_energy</span><span class="p">()</span>
</span><span id="DisulfideLoader.describe-391"><a href="#DisulfideLoader.describe-391"><span class="linenos">391</span></a>        
</span><span id="DisulfideLoader.describe-392"><a href="#DisulfideLoader.describe-392"><span class="linenos">392</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;    =========== RCSB Disulfide Database Summary ==============&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-393"><a href="#DisulfideLoader.describe-393"><span class="linenos">393</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;       =========== Built: </span><span class="si">{</span><span class="n">timestr</span><span class="si">}</span><span class="s1"> ==============&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-394"><a href="#DisulfideLoader.describe-394"><span class="linenos">394</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;PDB IDs present:                    </span><span class="si">{</span><span class="n">pdbs</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-395"><a href="#DisulfideLoader.describe-395"><span class="linenos">395</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Disulfides loaded:                  </span><span class="si">{</span><span class="n">tot</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-396"><a href="#DisulfideLoader.describe-396"><span class="linenos">396</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Average structure resolution:       </span><span class="si">{</span><span class="n">res</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-397"><a href="#DisulfideLoader.describe-397"><span class="linenos">397</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lowest Energy Disulfide:            </span><span class="si">{</span><span class="n">ssMin</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-398"><a href="#DisulfideLoader.describe-398"><span class="linenos">398</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Highest Energy Disulfide:           </span><span class="si">{</span><span class="n">ssMax</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-399"><a href="#DisulfideLoader.describe-399"><span class="linenos">399</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Ca distance cutoff:                 </span><span class="si">{</span><span class="n">cutoff</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Å&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-400"><a href="#DisulfideLoader.describe-400"><span class="linenos">400</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total RAM Used:                     </span><span class="si">{</span><span class="n">ram</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> GB.&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.describe-401"><a href="#DisulfideLoader.describe-401"><span class="linenos">401</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;    ================= proteusPy: </span><span class="si">{</span><span class="n">vers</span><span class="si">}</span><span class="s1"> =======================&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Provides information about the Disulfide database contained in <code>self</code>.</p>

<p>Example:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="">proteusPy.DisulfideLoader</a></span> <span class="kn">import</span> <span class="n">Load_PDB_SS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PDB_SS</span> <span class="o">=</span> <span class="n">Load_PDB_SS</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PDB_SS</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="go">    =========== RCSB Disulfide Database Summary ==============</span>
<span class="go">PDB IDs present:                    35818</span>
<span class="go">Disulfides loaded:                  120697</span>
<span class="go">Average structure resolution:       2.34 Å</span>
<span class="go">Lowest Energy Disulfide:            2q7q_75D_140D</span>
<span class="go">Highest Energy Disulfide:           1toz_456A_467A</span>
<span class="go">Total RAM Used:                     29.26 GB.</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="DisulfideLoader.display_overlay" class="classattr">
                                        <input id="DisulfideLoader.display_overlay-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">display_overlay</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">pdbid</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.display_overlay-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.display_overlay"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.display_overlay-403"><a href="#DisulfideLoader.display_overlay-403"><span class="linenos">403</span></a>    <span class="k">def</span> <span class="nf">display_overlay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdbid</span><span class="p">):</span>
</span><span id="DisulfideLoader.display_overlay-404"><a href="#DisulfideLoader.display_overlay-404"><span class="linenos">404</span></a>        <span class="sd">&#39;&#39;&#39; </span>
</span><span id="DisulfideLoader.display_overlay-405"><a href="#DisulfideLoader.display_overlay-405"><span class="linenos">405</span></a><span class="sd">        Display all disulfides for a given PDB ID overlaid in stick mode against</span>
</span><span id="DisulfideLoader.display_overlay-406"><a href="#DisulfideLoader.display_overlay-406"><span class="linenos">406</span></a><span class="sd">        a common coordinate frame. This allows us to see all of the disulfides</span>
</span><span id="DisulfideLoader.display_overlay-407"><a href="#DisulfideLoader.display_overlay-407"><span class="linenos">407</span></a><span class="sd">        at one time in a single view. Colors vary smoothy between bonds.</span>
</span><span id="DisulfideLoader.display_overlay-408"><a href="#DisulfideLoader.display_overlay-408"><span class="linenos">408</span></a><span class="sd">        </span>
</span><span id="DisulfideLoader.display_overlay-409"><a href="#DisulfideLoader.display_overlay-409"><span class="linenos">409</span></a><span class="sd">        :param self: DisulfideLoader object initialized with the database.</span>
</span><span id="DisulfideLoader.display_overlay-410"><a href="#DisulfideLoader.display_overlay-410"><span class="linenos">410</span></a><span class="sd">        :param pdbid: the PDB id string, e.g. 4yys</span>
</span><span id="DisulfideLoader.display_overlay-411"><a href="#DisulfideLoader.display_overlay-411"><span class="linenos">411</span></a><span class="sd">        :return: None</span>
</span><span id="DisulfideLoader.display_overlay-412"><a href="#DisulfideLoader.display_overlay-412"><span class="linenos">412</span></a>
</span><span id="DisulfideLoader.display_overlay-413"><a href="#DisulfideLoader.display_overlay-413"><span class="linenos">413</span></a><span class="sd">        Example:</span>
</span><span id="DisulfideLoader.display_overlay-414"><a href="#DisulfideLoader.display_overlay-414"><span class="linenos">414</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.Disulfide import Disulfide</span>
</span><span id="DisulfideLoader.display_overlay-415"><a href="#DisulfideLoader.display_overlay-415"><span class="linenos">415</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideLoader import DisulfideLoader</span>
</span><span id="DisulfideLoader.display_overlay-416"><a href="#DisulfideLoader.display_overlay-416"><span class="linenos">416</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideList import DisulfideList</span>
</span><span id="DisulfideLoader.display_overlay-417"><a href="#DisulfideLoader.display_overlay-417"><span class="linenos">417</span></a><span class="sd">            </span>
</span><span id="DisulfideLoader.display_overlay-418"><a href="#DisulfideLoader.display_overlay-418"><span class="linenos">418</span></a><span class="sd">        Instantiate the Loader with the SS database subset.</span>
</span><span id="DisulfideLoader.display_overlay-419"><a href="#DisulfideLoader.display_overlay-419"><span class="linenos">419</span></a>
</span><span id="DisulfideLoader.display_overlay-420"><a href="#DisulfideLoader.display_overlay-420"><span class="linenos">420</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = DisulfideLoader(verbose=False, subset=True)</span>
</span><span id="DisulfideLoader.display_overlay-421"><a href="#DisulfideLoader.display_overlay-421"><span class="linenos">421</span></a><span class="sd">        </span>
</span><span id="DisulfideLoader.display_overlay-422"><a href="#DisulfideLoader.display_overlay-422"><span class="linenos">422</span></a><span class="sd">        Display the Disulfides from the PDB ID ```4yys```, overlaid onto</span>
</span><span id="DisulfideLoader.display_overlay-423"><a href="#DisulfideLoader.display_overlay-423"><span class="linenos">423</span></a><span class="sd">        a common reference (the proximal disulfides).</span>
</span><span id="DisulfideLoader.display_overlay-424"><a href="#DisulfideLoader.display_overlay-424"><span class="linenos">424</span></a>
</span><span id="DisulfideLoader.display_overlay-425"><a href="#DisulfideLoader.display_overlay-425"><span class="linenos">425</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS.display_overlay(&#39;4yys&#39;)</span>
</span><span id="DisulfideLoader.display_overlay-426"><a href="#DisulfideLoader.display_overlay-426"><span class="linenos">426</span></a>
</span><span id="DisulfideLoader.display_overlay-427"><a href="#DisulfideLoader.display_overlay-427"><span class="linenos">427</span></a><span class="sd">        You can also slice the loader and display as an overly.</span>
</span><span id="DisulfideLoader.display_overlay-428"><a href="#DisulfideLoader.display_overlay-428"><span class="linenos">428</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS[:8].display_overlay()</span>
</span><span id="DisulfideLoader.display_overlay-429"><a href="#DisulfideLoader.display_overlay-429"><span class="linenos">429</span></a>
</span><span id="DisulfideLoader.display_overlay-430"><a href="#DisulfideLoader.display_overlay-430"><span class="linenos">430</span></a><span class="sd">        &#39;&#39;&#39;</span> 
</span><span id="DisulfideLoader.display_overlay-431"><a href="#DisulfideLoader.display_overlay-431"><span class="linenos">431</span></a>
</span><span id="DisulfideLoader.display_overlay-432"><a href="#DisulfideLoader.display_overlay-432"><span class="linenos">432</span></a>        <span class="n">ssbonds</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">pdbid</span><span class="p">]</span>
</span><span id="DisulfideLoader.display_overlay-433"><a href="#DisulfideLoader.display_overlay-433"><span class="linenos">433</span></a>        <span class="n">ssbonds</span><span class="o">.</span><span class="n">display_overlay</span><span class="p">()</span>
</span><span id="DisulfideLoader.display_overlay-434"><a href="#DisulfideLoader.display_overlay-434"><span class="linenos">434</span></a>        <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>Display all disulfides for a given PDB ID overlaid in stick mode against
a common coordinate frame. This allows us to see all of the disulfides
at one time in a single view. Colors vary smoothy between bonds.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>self</strong>:  DisulfideLoader object initialized with the database.</li>
<li><strong>pdbid</strong>:  the PDB id string, e.g. 4yys</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>

<p>Example:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="Disulfide.html">proteusPy.Disulfide</a></span> <span class="kn">import</span> <span class="n">Disulfide</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="">proteusPy.DisulfideLoader</a></span> <span class="kn">import</span> <span class="n">DisulfideLoader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="DisulfideList.html">proteusPy.DisulfideList</a></span> <span class="kn">import</span> <span class="n">DisulfideList</span>
</code></pre>
</div>

<p>Instantiate the Loader with the SS database subset.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">PDB_SS</span> <span class="o">=</span> <span class="n">DisulfideLoader</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre>
</div>

<p>Display the Disulfides from the PDB ID <code>4yys</code>, overlaid onto
a common reference (the proximal disulfides).</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">PDB_SS</span><span class="o">.</span><span class="n">display_overlay</span><span class="p">(</span><span class="s1">&#39;4yys&#39;</span><span class="p">)</span>
</code></pre>
</div>

<p>You can also slice the loader and display as an overly.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">PDB_SS</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">display_overlay</span><span class="p">()</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="DisulfideLoader.getTorsions" class="classattr">
                                        <input id="DisulfideLoader.getTorsions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">getTorsions</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">pdbID</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>:</span></span>

                <label class="view-source-button" for="DisulfideLoader.getTorsions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.getTorsions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.getTorsions-437"><a href="#DisulfideLoader.getTorsions-437"><span class="linenos">437</span></a>    <span class="k">def</span> <span class="nf">getTorsions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdbID</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="DisulfideLoader.getTorsions-438"><a href="#DisulfideLoader.getTorsions-438"><span class="linenos">438</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader.getTorsions-439"><a href="#DisulfideLoader.getTorsions-439"><span class="linenos">439</span></a><span class="sd">        Return the torsions, distances and energies defined by Disulfide.Torsion_DF_cols</span>
</span><span id="DisulfideLoader.getTorsions-440"><a href="#DisulfideLoader.getTorsions-440"><span class="linenos">440</span></a>
</span><span id="DisulfideLoader.getTorsions-441"><a href="#DisulfideLoader.getTorsions-441"><span class="linenos">441</span></a><span class="sd">        :param pdbID: pdbID, defaults to None, meaning return entire dataset.</span>
</span><span id="DisulfideLoader.getTorsions-442"><a href="#DisulfideLoader.getTorsions-442"><span class="linenos">442</span></a><span class="sd">        :type pdbID: str, optional used to extract for a specific PDB structure. If not specified</span>
</span><span id="DisulfideLoader.getTorsions-443"><a href="#DisulfideLoader.getTorsions-443"><span class="linenos">443</span></a><span class="sd">            then return the entire dataset.</span>
</span><span id="DisulfideLoader.getTorsions-444"><a href="#DisulfideLoader.getTorsions-444"><span class="linenos">444</span></a><span class="sd">        :raises DisulfideParseWarning: Raised if not found</span>
</span><span id="DisulfideLoader.getTorsions-445"><a href="#DisulfideLoader.getTorsions-445"><span class="linenos">445</span></a><span class="sd">        :return: Torsions Dataframe</span>
</span><span id="DisulfideLoader.getTorsions-446"><a href="#DisulfideLoader.getTorsions-446"><span class="linenos">446</span></a><span class="sd">        :rtype: pd.DataFrame</span>
</span><span id="DisulfideLoader.getTorsions-447"><a href="#DisulfideLoader.getTorsions-447"><span class="linenos">447</span></a>
</span><span id="DisulfideLoader.getTorsions-448"><a href="#DisulfideLoader.getTorsions-448"><span class="linenos">448</span></a><span class="sd">        Example:</span>
</span><span id="DisulfideLoader.getTorsions-449"><a href="#DisulfideLoader.getTorsions-449"><span class="linenos">449</span></a><span class="sd">        &gt;&gt;&gt; from proteusPy.DisulfideLoader import DisulfideLoader</span>
</span><span id="DisulfideLoader.getTorsions-450"><a href="#DisulfideLoader.getTorsions-450"><span class="linenos">450</span></a><span class="sd">        &gt;&gt;&gt; PDB_SS = DisulfideLoader(verbose=False, subset=True)</span>
</span><span id="DisulfideLoader.getTorsions-451"><a href="#DisulfideLoader.getTorsions-451"><span class="linenos">451</span></a><span class="sd">        &gt;&gt;&gt; Tor_DF = PDB_SS.getTorsions()</span>
</span><span id="DisulfideLoader.getTorsions-452"><a href="#DisulfideLoader.getTorsions-452"><span class="linenos">452</span></a><span class="sd">        &gt;&gt;&gt; Tor_DF.describe()</span>
</span><span id="DisulfideLoader.getTorsions-453"><a href="#DisulfideLoader.getTorsions-453"><span class="linenos">453</span></a><span class="sd">                  proximal       distal         chi1         chi2         chi3         chi4  ...  ca_distance     phi_prox     psi_prox     phi_dist     psi_dist  torsion_length</span>
</span><span id="DisulfideLoader.getTorsions-454"><a href="#DisulfideLoader.getTorsions-454"><span class="linenos">454</span></a><span class="sd">        count  3393.000000  3393.000000  3393.000000  3393.000000  3393.000000  3393.000000  ...  3393.000000  3393.000000  3393.000000  3393.000000  3393.000000     3393.000000</span>
</span><span id="DisulfideLoader.getTorsions-455"><a href="#DisulfideLoader.getTorsions-455"><span class="linenos">455</span></a><span class="sd">        mean    231.513999   280.056587   -49.134436   -15.616297    -3.727982   -31.909496  ...     5.554563   -98.491326    63.029854   -95.890117    62.408772      225.242256</span>
</span><span id="DisulfideLoader.getTorsions-456"><a href="#DisulfideLoader.getTorsions-456"><span class="linenos">456</span></a><span class="sd">        std     292.300344   293.503989    95.456284   104.318483    93.894477   103.553641  ...     1.489138    44.275097    99.266921    44.796764    97.231632       53.309336</span>
</span><span id="DisulfideLoader.getTorsions-457"><a href="#DisulfideLoader.getTorsions-457"><span class="linenos">457</span></a><span class="sd">        min       1.000000     6.000000  -179.947368  -179.990782  -179.081812  -179.940602  ...     2.941898  -180.000000  -180.000000  -180.000000  -180.000000      116.478788</span>
</span><span id="DisulfideLoader.getTorsions-458"><a href="#DisulfideLoader.getTorsions-458"><span class="linenos">458</span></a><span class="sd">        25%      48.000000    96.000000   -83.281768   -88.455019   -87.763001   -95.240905  ...     5.075491  -129.605300   -26.792543  -123.131231   -25.503215      181.929048</span>
</span><span id="DisulfideLoader.getTorsions-459"><a href="#DisulfideLoader.getTorsions-459"><span class="linenos">459</span></a><span class="sd">        50%     136.000000   194.000000   -63.878076   -59.597437   -64.977491   -69.607516  ...     5.612046   -97.569676   112.772998   -97.956322   112.956483      225.617493</span>
</span><span id="DisulfideLoader.getTorsions-460"><a href="#DisulfideLoader.getTorsions-460"><span class="linenos">460</span></a><span class="sd">        75%     310.000000   361.000000   -47.459809    82.078365    94.169603    69.488862  ...     6.112471   -69.670087   143.781003   -70.485076   142.808862      263.003492</span>
</span><span id="DisulfideLoader.getTorsions-461"><a href="#DisulfideLoader.getTorsions-461"><span class="linenos">461</span></a><span class="sd">        max    2592.000000  2599.000000   179.918814   179.987671   179.554652   179.977181  ...    75.611323   177.021502   179.856474   178.886602   179.735964      368.022621</span>
</span><span id="DisulfideLoader.getTorsions-462"><a href="#DisulfideLoader.getTorsions-462"><span class="linenos">462</span></a><span class="sd">        &lt;BLANKLINE&gt;</span>
</span><span id="DisulfideLoader.getTorsions-463"><a href="#DisulfideLoader.getTorsions-463"><span class="linenos">463</span></a><span class="sd">        [8 rows x 14 columns]</span>
</span><span id="DisulfideLoader.getTorsions-464"><a href="#DisulfideLoader.getTorsions-464"><span class="linenos">464</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader.getTorsions-465"><a href="#DisulfideLoader.getTorsions-465"><span class="linenos">465</span></a>        <span class="n">res_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="DisulfideLoader.getTorsions-466"><a href="#DisulfideLoader.getTorsions-466"><span class="linenos">466</span></a>
</span><span id="DisulfideLoader.getTorsions-467"><a href="#DisulfideLoader.getTorsions-467"><span class="linenos">467</span></a>        <span class="k">if</span> <span class="n">pdbID</span><span class="p">:</span>
</span><span id="DisulfideLoader.getTorsions-468"><a href="#DisulfideLoader.getTorsions-468"><span class="linenos">468</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="DisulfideLoader.getTorsions-469"><a href="#DisulfideLoader.getTorsions-469"><span class="linenos">469</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SSDict</span><span class="p">[</span><span class="n">pdbID</span><span class="p">]</span>
</span><span id="DisulfideLoader.getTorsions-470"><a href="#DisulfideLoader.getTorsions-470"><span class="linenos">470</span></a>                <span class="n">sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">pdbID</span>
</span><span id="DisulfideLoader.getTorsions-471"><a href="#DisulfideLoader.getTorsions-471"><span class="linenos">471</span></a>                <span class="n">res_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">[</span><span class="n">sel</span><span class="p">]</span>
</span><span id="DisulfideLoader.getTorsions-472"><a href="#DisulfideLoader.getTorsions-472"><span class="linenos">472</span></a>                <span class="k">return</span> <span class="n">res_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DisulfideLoader.getTorsions-473"><a href="#DisulfideLoader.getTorsions-473"><span class="linenos">473</span></a>            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="DisulfideLoader.getTorsions-474"><a href="#DisulfideLoader.getTorsions-474"><span class="linenos">474</span></a>                <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;! Cannot find key </span><span class="si">{</span><span class="n">pdbID</span><span class="si">}</span><span class="s1"> in SSBond DB&#39;</span>
</span><span id="DisulfideLoader.getTorsions-475"><a href="#DisulfideLoader.getTorsions-475"><span class="linenos">475</span></a>                <span class="k">raise</span> <span class="n">DisulfideParseWarning</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
</span><span id="DisulfideLoader.getTorsions-476"><a href="#DisulfideLoader.getTorsions-476"><span class="linenos">476</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideLoader.getTorsions-477"><a href="#DisulfideLoader.getTorsions-477"><span class="linenos">477</span></a>            <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TorsionDF</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the torsions, distances and energies defined by Disulfide.Torsion_DF_cols</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>pdbID</strong>:  pdbID, defaults to None, meaning return entire dataset.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>DisulfideParseWarning</strong>:  Raised if not found</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Torsions Dataframe</p>
</blockquote>

<p>Example:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn"><a href="">proteusPy.DisulfideLoader</a></span> <span class="kn">import</span> <span class="n">DisulfideLoader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PDB_SS</span> <span class="o">=</span> <span class="n">DisulfideLoader</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tor_DF</span> <span class="o">=</span> <span class="n">PDB_SS</span><span class="o">.</span><span class="n">getTorsions</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Tor_DF</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="go">          proximal       distal         chi1         chi2         chi3         chi4  ...  ca_distance     phi_prox     psi_prox     phi_dist     psi_dist  torsion_length</span>
<span class="go">count  3393.000000  3393.000000  3393.000000  3393.000000  3393.000000  3393.000000  ...  3393.000000  3393.000000  3393.000000  3393.000000  3393.000000     3393.000000</span>
<span class="go">mean    231.513999   280.056587   -49.134436   -15.616297    -3.727982   -31.909496  ...     5.554563   -98.491326    63.029854   -95.890117    62.408772      225.242256</span>
<span class="go">std     292.300344   293.503989    95.456284   104.318483    93.894477   103.553641  ...     1.489138    44.275097    99.266921    44.796764    97.231632       53.309336</span>
<span class="go">min       1.000000     6.000000  -179.947368  -179.990782  -179.081812  -179.940602  ...     2.941898  -180.000000  -180.000000  -180.000000  -180.000000      116.478788</span>
<span class="go">25%      48.000000    96.000000   -83.281768   -88.455019   -87.763001   -95.240905  ...     5.075491  -129.605300   -26.792543  -123.131231   -25.503215      181.929048</span>
<span class="go">50%     136.000000   194.000000   -63.878076   -59.597437   -64.977491   -69.607516  ...     5.612046   -97.569676   112.772998   -97.956322   112.956483      225.617493</span>
<span class="go">75%     310.000000   361.000000   -47.459809    82.078365    94.169603    69.488862  ...     6.112471   -69.670087   143.781003   -70.485076   142.808862      263.003492</span>
<span class="go">max    2592.000000  2599.000000   179.918814   179.987671   179.554652   179.977181  ...    75.611323   177.021502   179.856474   178.886602   179.735964      368.022621</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">[8 rows x 14 columns]</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="DisulfideLoader.list_classes" class="classattr">
                                        <input id="DisulfideLoader.list_classes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">list_classes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.list_classes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.list_classes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.list_classes-479"><a href="#DisulfideLoader.list_classes-479"><span class="linenos">479</span></a>    <span class="k">def</span> <span class="nf">list_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideLoader.list_classes-480"><a href="#DisulfideLoader.list_classes-480"><span class="linenos">480</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classdict</span><span class="p">):</span>
</span><span id="DisulfideLoader.list_classes-481"><a href="#DisulfideLoader.list_classes-481"><span class="linenos">481</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Class: |</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">|, |</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1">|&#39;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="DisulfideLoader.quiet" class="classattr">
                                <div class="attr variable">
            <span class="name">quiet</span><span class="annotation">: bool</span>

        
    </div>
    <a class="headerlink" href="#DisulfideLoader.quiet"></a>
    
            <div class="docstring"><p>Sets the quiet attribute for the loader. This silences many of the BIO.PDB warnings.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>perm</strong>:  True or False</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideLoader.save" class="classattr">
                                        <input id="DisulfideLoader.save-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">savepath</span><span class="o">=</span><span class="s1">&#39;/Users/egs/repos/proteusPy/proteusPy/data/&#39;</span>,</span><span class="param">	<span class="n">subset</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">cutoff</span><span class="o">=-</span><span class="mf">1.0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideLoader.save-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.save"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.save-503"><a href="#DisulfideLoader.save-503"><span class="linenos">503</span></a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">savepath</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">):</span>
</span><span id="DisulfideLoader.save-504"><a href="#DisulfideLoader.save-504"><span class="linenos">504</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader.save-505"><a href="#DisulfideLoader.save-505"><span class="linenos">505</span></a><span class="sd">        Save a copy of the fully instantiated Loader to the specified file.</span>
</span><span id="DisulfideLoader.save-506"><a href="#DisulfideLoader.save-506"><span class="linenos">506</span></a>
</span><span id="DisulfideLoader.save-507"><a href="#DisulfideLoader.save-507"><span class="linenos">507</span></a><span class="sd">        :param savepath: Path to save the file, defaults to DATA_DIR</span>
</span><span id="DisulfideLoader.save-508"><a href="#DisulfideLoader.save-508"><span class="linenos">508</span></a><span class="sd">        :param fname: Filename, defaults to LOADER_FNAME</span>
</span><span id="DisulfideLoader.save-509"><a href="#DisulfideLoader.save-509"><span class="linenos">509</span></a><span class="sd">        :param verbose: Verbosity, defaults to False</span>
</span><span id="DisulfideLoader.save-510"><a href="#DisulfideLoader.save-510"><span class="linenos">510</span></a><span class="sd">        :param cutoff: Distance cutoff used to build the database, -1 means no cutoff.</span>
</span><span id="DisulfideLoader.save-511"><a href="#DisulfideLoader.save-511"><span class="linenos">511</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader.save-512"><a href="#DisulfideLoader.save-512"><span class="linenos">512</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">=</span> <span class="n">cutoff</span>
</span><span id="DisulfideLoader.save-513"><a href="#DisulfideLoader.save-513"><span class="linenos">513</span></a>        <span class="k">if</span> <span class="n">subset</span><span class="p">:</span>
</span><span id="DisulfideLoader.save-514"><a href="#DisulfideLoader.save-514"><span class="linenos">514</span></a>            <span class="n">fname</span> <span class="o">=</span> <span class="n">LOADER_SUBSET_FNAME</span>
</span><span id="DisulfideLoader.save-515"><a href="#DisulfideLoader.save-515"><span class="linenos">515</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideLoader.save-516"><a href="#DisulfideLoader.save-516"><span class="linenos">516</span></a>            <span class="n">fname</span> <span class="o">=</span> <span class="n">LOADER_FNAME</span>
</span><span id="DisulfideLoader.save-517"><a href="#DisulfideLoader.save-517"><span class="linenos">517</span></a>
</span><span id="DisulfideLoader.save-518"><a href="#DisulfideLoader.save-518"><span class="linenos">518</span></a>        <span class="n">_fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">savepath</span><span class="si">}{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="DisulfideLoader.save-519"><a href="#DisulfideLoader.save-519"><span class="linenos">519</span></a>
</span><span id="DisulfideLoader.save-520"><a href="#DisulfideLoader.save-520"><span class="linenos">520</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader.save-521"><a href="#DisulfideLoader.save-521"><span class="linenos">521</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; DisulfideLoader.save(): Writing </span><span class="si">{</span><span class="n">_fname</span><span class="si">}</span><span class="s1">... &#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.save-522"><a href="#DisulfideLoader.save-522"><span class="linenos">522</span></a>        
</span><span id="DisulfideLoader.save-523"><a href="#DisulfideLoader.save-523"><span class="linenos">523</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">_fname</span><span class="p">,</span> <span class="s1">&#39;wb+&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="DisulfideLoader.save-524"><a href="#DisulfideLoader.save-524"><span class="linenos">524</span></a>            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="DisulfideLoader.save-525"><a href="#DisulfideLoader.save-525"><span class="linenos">525</span></a>        
</span><span id="DisulfideLoader.save-526"><a href="#DisulfideLoader.save-526"><span class="linenos">526</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader.save-527"><a href="#DisulfideLoader.save-527"><span class="linenos">527</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; DisulfideLoader.save(): Done.&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Save a copy of the fully instantiated Loader to the specified file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>savepath</strong>:  Path to save the file, defaults to DATA_DIR</li>
<li><strong>fname</strong>:  Filename, defaults to LOADER_FNAME</li>
<li><strong>verbose</strong>:  Verbosity, defaults to False</li>
<li><strong>cutoff</strong>:  Distance cutoff used to build the database, -1 means no cutoff.</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideLoader.from_class" class="classattr">
                                        <input id="DisulfideLoader.from_class-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">from_class</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">classid</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="n"><a href="DisulfideList.html#DisulfideList">proteusPy.DisulfideList.DisulfideList</a></span>:</span></span>

                <label class="view-source-button" for="DisulfideLoader.from_class-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideLoader.from_class"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideLoader.from_class-529"><a href="#DisulfideLoader.from_class-529"><span class="linenos">529</span></a>    <span class="k">def</span> <span class="nf">from_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="DisulfideLoader.from_class-530"><a href="#DisulfideLoader.from_class-530"><span class="linenos">530</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideLoader.from_class-531"><a href="#DisulfideLoader.from_class-531"><span class="linenos">531</span></a><span class="sd">        Return a list of disulfides corresponding to the input class ID</span>
</span><span id="DisulfideLoader.from_class-532"><a href="#DisulfideLoader.from_class-532"><span class="linenos">532</span></a><span class="sd">        string.</span>
</span><span id="DisulfideLoader.from_class-533"><a href="#DisulfideLoader.from_class-533"><span class="linenos">533</span></a>
</span><span id="DisulfideLoader.from_class-534"><a href="#DisulfideLoader.from_class-534"><span class="linenos">534</span></a><span class="sd">        :param classid: Class ID, e.g. &#39;+RHStaple&#39;</span>
</span><span id="DisulfideLoader.from_class-535"><a href="#DisulfideLoader.from_class-535"><span class="linenos">535</span></a><span class="sd">        :return: DisulfideList of class members</span>
</span><span id="DisulfideLoader.from_class-536"><a href="#DisulfideLoader.from_class-536"><span class="linenos">536</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideLoader.from_class-537"><a href="#DisulfideLoader.from_class-537"><span class="linenos">537</span></a>        <span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</span><span id="DisulfideLoader.from_class-538"><a href="#DisulfideLoader.from_class-538"><span class="linenos">538</span></a>        <span class="kn">from</span> <span class="nn">proteusPy.ProteusGlobals</span> <span class="kn">import</span> <span class="n">PBAR_COLS</span>
</span><span id="DisulfideLoader.from_class-539"><a href="#DisulfideLoader.from_class-539"><span class="linenos">539</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="n">classid</span><span class="p">)</span>
</span><span id="DisulfideLoader.from_class-540"><a href="#DisulfideLoader.from_class-540"><span class="linenos">540</span></a>
</span><span id="DisulfideLoader.from_class-541"><a href="#DisulfideLoader.from_class-541"><span class="linenos">541</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DisulfideLoader.from_class-542"><a href="#DisulfideLoader.from_class-542"><span class="linenos">542</span></a>            <span class="n">sslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span><span class="p">[</span><span class="n">classid</span><span class="p">]</span>
</span><span id="DisulfideLoader.from_class-543"><a href="#DisulfideLoader.from_class-543"><span class="linenos">543</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideLoader.from_class-544"><a href="#DisulfideLoader.from_class-544"><span class="linenos">544</span></a>                <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">sslist</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">PBAR_COLS</span><span class="p">)</span>
</span><span id="DisulfideLoader.from_class-545"><a href="#DisulfideLoader.from_class-545"><span class="linenos">545</span></a>                <span class="k">for</span> <span class="n">ssid</span> <span class="ow">in</span> <span class="n">pbar</span><span class="p">:</span>
</span><span id="DisulfideLoader.from_class-546"><a href="#DisulfideLoader.from_class-546"><span class="linenos">546</span></a>                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ssid</span><span class="p">])</span>
</span><span id="DisulfideLoader.from_class-547"><a href="#DisulfideLoader.from_class-547"><span class="linenos">547</span></a>                <span class="k">return</span> <span class="n">res</span>
</span><span id="DisulfideLoader.from_class-548"><a href="#DisulfideLoader.from_class-548"><span class="linenos">548</span></a>
</span><span id="DisulfideLoader.from_class-549"><a href="#DisulfideLoader.from_class-549"><span class="linenos">549</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([</span><span class="bp">self</span><span class="p">[</span><span class="n">ssid</span><span class="p">]</span> <span class="k">for</span> <span class="n">ssid</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">],</span> <span class="n">classid</span><span class="p">)</span>
</span><span id="DisulfideLoader.from_class-550"><a href="#DisulfideLoader.from_class-550"><span class="linenos">550</span></a>            <span class="k">return</span> <span class="n">res</span>
</span><span id="DisulfideLoader.from_class-551"><a href="#DisulfideLoader.from_class-551"><span class="linenos">551</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="DisulfideLoader.from_class-552"><a href="#DisulfideLoader.from_class-552"><span class="linenos">552</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No class: </span><span class="si">{</span><span class="n">classid</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="DisulfideLoader.from_class-553"><a href="#DisulfideLoader.from_class-553"><span class="linenos">553</span></a>        <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>Return a list of disulfides corresponding to the input class ID
string.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>classid</strong>:  Class ID, e.g. '+RHStaple'</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>DisulfideList of class members</p>
</blockquote>
</div>


                            </div>
                </section>
                <section id="DisulfideClass_Constructor">
                            <input id="DisulfideClass_Constructor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DisulfideClass_Constructor</span>:

                <label class="view-source-button" for="DisulfideClass_Constructor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClass_Constructor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClass_Constructor-556"><a href="#DisulfideClass_Constructor-556"><span class="linenos">556</span></a><span class="k">class</span> <span class="nc">DisulfideClass_Constructor</span><span class="p">():</span>
</span><span id="DisulfideClass_Constructor-557"><a href="#DisulfideClass_Constructor-557"><span class="linenos">557</span></a>    <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideClass_Constructor-558"><a href="#DisulfideClass_Constructor-558"><span class="linenos">558</span></a><span class="sd">    Class manages structural classes for the disulfide bonds contained</span>
</span><span id="DisulfideClass_Constructor-559"><a href="#DisulfideClass_Constructor-559"><span class="linenos">559</span></a><span class="sd">    in the proteusPy disulfide database</span>
</span><span id="DisulfideClass_Constructor-560"><a href="#DisulfideClass_Constructor-560"><span class="linenos">560</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="DisulfideClass_Constructor-561"><a href="#DisulfideClass_Constructor-561"><span class="linenos">561</span></a>
</span><span id="DisulfideClass_Constructor-562"><a href="#DisulfideClass_Constructor-562"><span class="linenos">562</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bootstrap</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor-563"><a href="#DisulfideClass_Constructor-563"><span class="linenos">563</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="DisulfideClass_Constructor-564"><a href="#DisulfideClass_Constructor-564"><span class="linenos">564</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideClass_Constructor-565"><a href="#DisulfideClass_Constructor-565"><span class="linenos">565</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdf</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClass_Constructor-566"><a href="#DisulfideClass_Constructor-566"><span class="linenos">566</span></a>
</span><span id="DisulfideClass_Constructor-567"><a href="#DisulfideClass_Constructor-567"><span class="linenos">567</span></a>        <span class="k">if</span> <span class="n">bootstrap</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor-568"><a href="#DisulfideClass_Constructor-568"><span class="linenos">568</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor-569"><a href="#DisulfideClass_Constructor-569"><span class="linenos">569</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; DisulfideClass_Constructor(): Building SS classes...&#39;</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor-570"><a href="#DisulfideClass_Constructor-570"><span class="linenos">570</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">build_yourself</span><span class="p">()</span>
</span><span id="DisulfideClass_Constructor-571"><a href="#DisulfideClass_Constructor-571"><span class="linenos">571</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor-572"><a href="#DisulfideClass_Constructor-572"><span class="linenos">572</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_class_dict</span><span class="p">()</span>
</span><span id="DisulfideClass_Constructor-573"><a href="#DisulfideClass_Constructor-573"><span class="linenos">573</span></a>
</span><span id="DisulfideClass_Constructor-574"><a href="#DisulfideClass_Constructor-574"><span class="linenos">574</span></a>    <span class="k">def</span> <span class="nf">load_class_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}{</span><span class="n">SS_CLASS_DICT_FILE</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor-575"><a href="#DisulfideClass_Constructor-575"><span class="linenos">575</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor-576"><a href="#DisulfideClass_Constructor-576"><span class="linenos">576</span></a>            <span class="c1">#res = pickle.load(f)</span>
</span><span id="DisulfideClass_Constructor-577"><a href="#DisulfideClass_Constructor-577"><span class="linenos">577</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor-578"><a href="#DisulfideClass_Constructor-578"><span class="linenos">578</span></a>    
</span><span id="DisulfideClass_Constructor-579"><a href="#DisulfideClass_Constructor-579"><span class="linenos">579</span></a>    <span class="k">def</span> <span class="nf">build_class_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_df</span><span class="p">,</span> <span class="n">group_df</span><span class="p">):</span>
</span><span id="DisulfideClass_Constructor-580"><a href="#DisulfideClass_Constructor-580"><span class="linenos">580</span></a>        <span class="n">ss_id_col</span> <span class="o">=</span> <span class="n">group_df</span><span class="p">[</span><span class="s1">&#39;ss_id&#39;</span><span class="p">]</span>
</span><span id="DisulfideClass_Constructor-581"><a href="#DisulfideClass_Constructor-581"><span class="linenos">581</span></a>        <span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">class_df</span><span class="p">,</span> <span class="n">ss_id_col</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor-582"><a href="#DisulfideClass_Constructor-582"><span class="linenos">582</span></a>        <span class="k">return</span> <span class="n">result_df</span>
</span><span id="DisulfideClass_Constructor-583"><a href="#DisulfideClass_Constructor-583"><span class="linenos">583</span></a>
</span><span id="DisulfideClass_Constructor-584"><a href="#DisulfideClass_Constructor-584"><span class="linenos">584</span></a>    <span class="k">def</span> <span class="nf">list_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideClass_Constructor-585"><a href="#DisulfideClass_Constructor-585"><span class="linenos">585</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classdict</span><span class="p">):</span>
</span><span id="DisulfideClass_Constructor-586"><a href="#DisulfideClass_Constructor-586"><span class="linenos">586</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Class: |</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">|, |</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1">|&#39;</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor-587"><a href="#DisulfideClass_Constructor-587"><span class="linenos">587</span></a>
</span><span id="DisulfideClass_Constructor-588"><a href="#DisulfideClass_Constructor-588"><span class="linenos">588</span></a>    <span class="c1">#  class_cols = [&#39;Idx&#39;,&#39;chi1_s&#39;,&#39;chi2_s&#39;,&#39;chi3_s&#39;,&#39;chi4_s&#39;,&#39;chi5_s&#39;,&#39;class_id&#39;,&#39;SS_Classname&#39;,&#39;FXN&#39;,</span>
</span><span id="DisulfideClass_Constructor-589"><a href="#DisulfideClass_Constructor-589"><span class="linenos">589</span></a>    <span class="c1"># &#39;count&#39;,&#39;incidence&#39;,&#39;percentage&#39;,&#39;ca_distance_mean&#39;,</span>
</span><span id="DisulfideClass_Constructor-590"><a href="#DisulfideClass_Constructor-590"><span class="linenos">590</span></a>    <span class="c1"># &#39;ca_distance_std&#39;,&#39;torsion_length_mean&#39;,&#39;torsion_length_std&#39;,&#39;energy_mean&#39;,&#39;energy_std&#39;]</span>
</span><span id="DisulfideClass_Constructor-591"><a href="#DisulfideClass_Constructor-591"><span class="linenos">591</span></a>
</span><span id="DisulfideClass_Constructor-592"><a href="#DisulfideClass_Constructor-592"><span class="linenos">592</span></a>    <span class="k">def</span> <span class="nf">concat_dataframes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">):</span>
</span><span id="DisulfideClass_Constructor-593"><a href="#DisulfideClass_Constructor-593"><span class="linenos">593</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClass_Constructor-594"><a href="#DisulfideClass_Constructor-594"><span class="linenos">594</span></a><span class="sd">        Concatenates columns from one data frame into the other </span>
</span><span id="DisulfideClass_Constructor-595"><a href="#DisulfideClass_Constructor-595"><span class="linenos">595</span></a><span class="sd">        and returns the new result.</span>
</span><span id="DisulfideClass_Constructor-596"><a href="#DisulfideClass_Constructor-596"><span class="linenos">596</span></a>
</span><span id="DisulfideClass_Constructor-597"><a href="#DisulfideClass_Constructor-597"><span class="linenos">597</span></a><span class="sd">        Parameters</span>
</span><span id="DisulfideClass_Constructor-598"><a href="#DisulfideClass_Constructor-598"><span class="linenos">598</span></a><span class="sd">        ----------</span>
</span><span id="DisulfideClass_Constructor-599"><a href="#DisulfideClass_Constructor-599"><span class="linenos">599</span></a><span class="sd">        df1 : pandas.DataFrame</span>
</span><span id="DisulfideClass_Constructor-600"><a href="#DisulfideClass_Constructor-600"><span class="linenos">600</span></a><span class="sd">            The first data frame.</span>
</span><span id="DisulfideClass_Constructor-601"><a href="#DisulfideClass_Constructor-601"><span class="linenos">601</span></a><span class="sd">        df2 : pandas.DataFrame</span>
</span><span id="DisulfideClass_Constructor-602"><a href="#DisulfideClass_Constructor-602"><span class="linenos">602</span></a><span class="sd">            The second data frame.</span>
</span><span id="DisulfideClass_Constructor-603"><a href="#DisulfideClass_Constructor-603"><span class="linenos">603</span></a>
</span><span id="DisulfideClass_Constructor-604"><a href="#DisulfideClass_Constructor-604"><span class="linenos">604</span></a><span class="sd">        Returns</span>
</span><span id="DisulfideClass_Constructor-605"><a href="#DisulfideClass_Constructor-605"><span class="linenos">605</span></a><span class="sd">        -------</span>
</span><span id="DisulfideClass_Constructor-606"><a href="#DisulfideClass_Constructor-606"><span class="linenos">606</span></a><span class="sd">        pandas.DataFrame</span>
</span><span id="DisulfideClass_Constructor-607"><a href="#DisulfideClass_Constructor-607"><span class="linenos">607</span></a><span class="sd">            The concatenated data frame.</span>
</span><span id="DisulfideClass_Constructor-608"><a href="#DisulfideClass_Constructor-608"><span class="linenos">608</span></a>
</span><span id="DisulfideClass_Constructor-609"><a href="#DisulfideClass_Constructor-609"><span class="linenos">609</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClass_Constructor-610"><a href="#DisulfideClass_Constructor-610"><span class="linenos">610</span></a>        <span class="c1"># Merge the data frames based on the &#39;SS_Classname&#39; column</span>
</span><span id="DisulfideClass_Constructor-611"><a href="#DisulfideClass_Constructor-611"><span class="linenos">611</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;class_id&#39;</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor-612"><a href="#DisulfideClass_Constructor-612"><span class="linenos">612</span></a>
</span><span id="DisulfideClass_Constructor-613"><a href="#DisulfideClass_Constructor-613"><span class="linenos">613</span></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="DisulfideClass_Constructor-614"><a href="#DisulfideClass_Constructor-614"><span class="linenos">614</span></a>
</span><span id="DisulfideClass_Constructor-615"><a href="#DisulfideClass_Constructor-615"><span class="linenos">615</span></a>    <span class="k">def</span> <span class="nf">build_yourself</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideClass_Constructor-616"><a href="#DisulfideClass_Constructor-616"><span class="linenos">616</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideClass_Constructor-617"><a href="#DisulfideClass_Constructor-617"><span class="linenos">617</span></a><span class="sd">        Builds the internal dictionary mapping the disulfide class names to their respective members.</span>
</span><span id="DisulfideClass_Constructor-618"><a href="#DisulfideClass_Constructor-618"><span class="linenos">618</span></a><span class="sd">        The classnames are defined by the sign of the dihedral angles, per XXX&#39;, the list of SS within</span>
</span><span id="DisulfideClass_Constructor-619"><a href="#DisulfideClass_Constructor-619"><span class="linenos">619</span></a><span class="sd">        the database classified, and the resulting dict created.</span>
</span><span id="DisulfideClass_Constructor-620"><a href="#DisulfideClass_Constructor-620"><span class="linenos">620</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideClass_Constructor-621"><a href="#DisulfideClass_Constructor-621"><span class="linenos">621</span></a>
</span><span id="DisulfideClass_Constructor-622"><a href="#DisulfideClass_Constructor-622"><span class="linenos">622</span></a>        <span class="k">def</span> <span class="nf">ss_id_dict</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
</span><span id="DisulfideClass_Constructor-623"><a href="#DisulfideClass_Constructor-623"><span class="linenos">623</span></a>            <span class="n">ss_id_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SS_Classname&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ss_id&#39;</span><span class="p">]))</span>
</span><span id="DisulfideClass_Constructor-624"><a href="#DisulfideClass_Constructor-624"><span class="linenos">624</span></a>            <span class="k">return</span> <span class="n">ss_id_dict</span>
</span><span id="DisulfideClass_Constructor-625"><a href="#DisulfideClass_Constructor-625"><span class="linenos">625</span></a>
</span><span id="DisulfideClass_Constructor-626"><a href="#DisulfideClass_Constructor-626"><span class="linenos">626</span></a>        <span class="n">PDB_SS</span> <span class="o">=</span> <span class="n">Load_PDB_SS</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor-627"><a href="#DisulfideClass_Constructor-627"><span class="linenos">627</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor-628"><a href="#DisulfideClass_Constructor-628"><span class="linenos">628</span></a>            <span class="n">PDB_SS</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</span><span id="DisulfideClass_Constructor-629"><a href="#DisulfideClass_Constructor-629"><span class="linenos">629</span></a>
</span><span id="DisulfideClass_Constructor-630"><a href="#DisulfideClass_Constructor-630"><span class="linenos">630</span></a>        <span class="n">tors_df</span> <span class="o">=</span> <span class="n">PDB_SS</span><span class="o">.</span><span class="n">getTorsions</span><span class="p">()</span>
</span><span id="DisulfideClass_Constructor-631"><a href="#DisulfideClass_Constructor-631"><span class="linenos">631</span></a>
</span><span id="DisulfideClass_Constructor-632"><a href="#DisulfideClass_Constructor-632"><span class="linenos">632</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor-633"><a href="#DisulfideClass_Constructor-633"><span class="linenos">633</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; DisulfideClass_Constructor(): creating SS classes...&#39;</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor-634"><a href="#DisulfideClass_Constructor-634"><span class="linenos">634</span></a>
</span><span id="DisulfideClass_Constructor-635"><a href="#DisulfideClass_Constructor-635"><span class="linenos">635</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">create_classes</span><span class="p">(</span><span class="n">tors_df</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor-636"><a href="#DisulfideClass_Constructor-636"><span class="linenos">636</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">class_df</span> <span class="o">=</span> <span class="n">grouped</span>
</span><span id="DisulfideClass_Constructor-637"><a href="#DisulfideClass_Constructor-637"><span class="linenos">637</span></a>
</span><span id="DisulfideClass_Constructor-638"><a href="#DisulfideClass_Constructor-638"><span class="linenos">638</span></a>        <span class="n">grouped</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s1">PDB_ss_classes.csv&#39;</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor-639"><a href="#DisulfideClass_Constructor-639"><span class="linenos">639</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor-640"><a href="#DisulfideClass_Constructor-640"><span class="linenos">640</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">grouped</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor-641"><a href="#DisulfideClass_Constructor-641"><span class="linenos">641</span></a>
</span><span id="DisulfideClass_Constructor-642"><a href="#DisulfideClass_Constructor-642"><span class="linenos">642</span></a>        <span class="c1">#grouped_summary = grouped.drop(columns=[&#39;ss_id&#39;], axis=1)</span>
</span><span id="DisulfideClass_Constructor-643"><a href="#DisulfideClass_Constructor-643"><span class="linenos">643</span></a>        <span class="c1">#grouped_summary.to_csv(f&#39;{DATA_DIR}PDB_ss_classes_summary.csv&#39;)</span>
</span><span id="DisulfideClass_Constructor-644"><a href="#DisulfideClass_Constructor-644"><span class="linenos">644</span></a>        
</span><span id="DisulfideClass_Constructor-645"><a href="#DisulfideClass_Constructor-645"><span class="linenos">645</span></a>        <span class="c1"># this file is hand made. Do not change it. -egs-</span>
</span><span id="DisulfideClass_Constructor-646"><a href="#DisulfideClass_Constructor-646"><span class="linenos">646</span></a>        <span class="c1">#class_df = pd.read_csv(f&#39;{DATA_DIR}PDB_ss_classes_master2.csv&#39;, dtype={&#39;class_id&#39;: &#39;string&#39;, &#39;FXN&#39;: &#39;string&#39;, &#39;SS_Classname&#39;: &#39;string&#39;})</span>
</span><span id="DisulfideClass_Constructor-647"><a href="#DisulfideClass_Constructor-647"><span class="linenos">647</span></a>
</span><span id="DisulfideClass_Constructor-648"><a href="#DisulfideClass_Constructor-648"><span class="linenos">648</span></a>        <span class="c1"># !!! df = pd.read_csv(pd.compat.StringIO(csv_string))</span>
</span><span id="DisulfideClass_Constructor-649"><a href="#DisulfideClass_Constructor-649"><span class="linenos">649</span></a>        <span class="c1"># class_df = pd.read_csv(f&#39;{DATA_DIR}PDB_SS_class_definitions.csv&#39;, dtype={&#39;class_id&#39;: &#39;string&#39;, &#39;FXN&#39;: &#39;string&#39;, &#39;SS_Classname&#39;: &#39;string&#39;})</span>
</span><span id="DisulfideClass_Constructor-650"><a href="#DisulfideClass_Constructor-650"><span class="linenos">650</span></a>        
</span><span id="DisulfideClass_Constructor-651"><a href="#DisulfideClass_Constructor-651"><span class="linenos">651</span></a>        <span class="n">class_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">SS_CLASS_DEFINITIONS</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class_id&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;FXN&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;SS_Classname&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">})</span>
</span><span id="DisulfideClass_Constructor-652"><a href="#DisulfideClass_Constructor-652"><span class="linenos">652</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s1">&#39;FXN&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="DisulfideClass_Constructor-653"><a href="#DisulfideClass_Constructor-653"><span class="linenos">653</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s1">&#39;SS_Classname&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="DisulfideClass_Constructor-654"><a href="#DisulfideClass_Constructor-654"><span class="linenos">654</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s1">&#39;class_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="DisulfideClass_Constructor-655"><a href="#DisulfideClass_Constructor-655"><span class="linenos">655</span></a>
</span><span id="DisulfideClass_Constructor-656"><a href="#DisulfideClass_Constructor-656"><span class="linenos">656</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor-657"><a href="#DisulfideClass_Constructor-657"><span class="linenos">657</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; DisulfideClass_Constructor(): merging...&#39;</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor-658"><a href="#DisulfideClass_Constructor-658"><span class="linenos">658</span></a>
</span><span id="DisulfideClass_Constructor-659"><a href="#DisulfideClass_Constructor-659"><span class="linenos">659</span></a>        <span class="n">merged</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">concat_dataframes</span><span class="p">(</span><span class="n">class_df</span><span class="p">,</span> <span class="n">grouped</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor-660"><a href="#DisulfideClass_Constructor-660"><span class="linenos">660</span></a>        <span class="c1">#merged = self.build_class_df(class_df, grouped)</span>
</span><span id="DisulfideClass_Constructor-661"><a href="#DisulfideClass_Constructor-661"><span class="linenos">661</span></a>        <span class="n">merged</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Idx&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor-662"><a href="#DisulfideClass_Constructor-662"><span class="linenos">662</span></a>
</span><span id="DisulfideClass_Constructor-663"><a href="#DisulfideClass_Constructor-663"><span class="linenos">663</span></a>        <span class="n">classdict</span> <span class="o">=</span> <span class="n">ss_id_dict</span><span class="p">(</span><span class="n">merged</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor-664"><a href="#DisulfideClass_Constructor-664"><span class="linenos">664</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span> <span class="o">=</span> <span class="n">classdict</span>
</span><span id="DisulfideClass_Constructor-665"><a href="#DisulfideClass_Constructor-665"><span class="linenos">665</span></a>
</span><span id="DisulfideClass_Constructor-666"><a href="#DisulfideClass_Constructor-666"><span class="linenos">666</span></a>        <span class="n">merged</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s1">PDB_SS_merged.csv&#39;</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor-667"><a href="#DisulfideClass_Constructor-667"><span class="linenos">667</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdf</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DisulfideClass_Constructor-668"><a href="#DisulfideClass_Constructor-668"><span class="linenos">668</span></a>
</span><span id="DisulfideClass_Constructor-669"><a href="#DisulfideClass_Constructor-669"><span class="linenos">669</span></a>        <span class="n">fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}{</span><span class="n">SS_CLASS_DICT_FILE</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="DisulfideClass_Constructor-670"><a href="#DisulfideClass_Constructor-670"><span class="linenos">670</span></a>
</span><span id="DisulfideClass_Constructor-671"><a href="#DisulfideClass_Constructor-671"><span class="linenos">671</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor-672"><a href="#DisulfideClass_Constructor-672"><span class="linenos">672</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; DisulfideClass_Constructor(): writing </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor-673"><a href="#DisulfideClass_Constructor-673"><span class="linenos">673</span></a>
</span><span id="DisulfideClass_Constructor-674"><a href="#DisulfideClass_Constructor-674"><span class="linenos">674</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;wb+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor-675"><a href="#DisulfideClass_Constructor-675"><span class="linenos">675</span></a>            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">classdict</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor-676"><a href="#DisulfideClass_Constructor-676"><span class="linenos">676</span></a>
</span><span id="DisulfideClass_Constructor-677"><a href="#DisulfideClass_Constructor-677"><span class="linenos">677</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor-678"><a href="#DisulfideClass_Constructor-678"><span class="linenos">678</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; DisulfideClass_Constructor(): initialization complete.&#39;</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor-679"><a href="#DisulfideClass_Constructor-679"><span class="linenos">679</span></a>        
</span><span id="DisulfideClass_Constructor-680"><a href="#DisulfideClass_Constructor-680"><span class="linenos">680</span></a>        <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>Class manages structural classes for the disulfide bonds contained
in the proteusPy disulfide database</p>
</div>


                            <div id="DisulfideClass_Constructor.__init__" class="classattr">
                                        <input id="DisulfideClass_Constructor.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">DisulfideClass_Constructor</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="n">bootstrap</span><span class="o">=</span><span class="kc">False</span></span>)</span>

                <label class="view-source-button" for="DisulfideClass_Constructor.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClass_Constructor.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClass_Constructor.__init__-562"><a href="#DisulfideClass_Constructor.__init__-562"><span class="linenos">562</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bootstrap</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor.__init__-563"><a href="#DisulfideClass_Constructor.__init__-563"><span class="linenos">563</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="DisulfideClass_Constructor.__init__-564"><a href="#DisulfideClass_Constructor.__init__-564"><span class="linenos">564</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideClass_Constructor.__init__-565"><a href="#DisulfideClass_Constructor.__init__-565"><span class="linenos">565</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdf</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClass_Constructor.__init__-566"><a href="#DisulfideClass_Constructor.__init__-566"><span class="linenos">566</span></a>
</span><span id="DisulfideClass_Constructor.__init__-567"><a href="#DisulfideClass_Constructor.__init__-567"><span class="linenos">567</span></a>        <span class="k">if</span> <span class="n">bootstrap</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor.__init__-568"><a href="#DisulfideClass_Constructor.__init__-568"><span class="linenos">568</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor.__init__-569"><a href="#DisulfideClass_Constructor.__init__-569"><span class="linenos">569</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; DisulfideClass_Constructor(): Building SS classes...&#39;</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor.__init__-570"><a href="#DisulfideClass_Constructor.__init__-570"><span class="linenos">570</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">build_yourself</span><span class="p">()</span>
</span><span id="DisulfideClass_Constructor.__init__-571"><a href="#DisulfideClass_Constructor.__init__-571"><span class="linenos">571</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor.__init__-572"><a href="#DisulfideClass_Constructor.__init__-572"><span class="linenos">572</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_class_dict</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="DisulfideClass_Constructor.load_class_dict" class="classattr">
                                        <input id="DisulfideClass_Constructor.load_class_dict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_class_dict</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">fname</span><span class="o">=</span><span class="s1">&#39;/Users/egs/repos/proteusPy/proteusPy/data/PDB_ss_classes_dict.pkl&#39;</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="DisulfideClass_Constructor.load_class_dict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClass_Constructor.load_class_dict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClass_Constructor.load_class_dict-574"><a href="#DisulfideClass_Constructor.load_class_dict-574"><span class="linenos">574</span></a>    <span class="k">def</span> <span class="nf">load_class_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}{</span><span class="n">SS_CLASS_DICT_FILE</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor.load_class_dict-575"><a href="#DisulfideClass_Constructor.load_class_dict-575"><span class="linenos">575</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor.load_class_dict-576"><a href="#DisulfideClass_Constructor.load_class_dict-576"><span class="linenos">576</span></a>            <span class="c1">#res = pickle.load(f)</span>
</span><span id="DisulfideClass_Constructor.load_class_dict-577"><a href="#DisulfideClass_Constructor.load_class_dict-577"><span class="linenos">577</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="DisulfideClass_Constructor.build_class_df" class="classattr">
                                        <input id="DisulfideClass_Constructor.build_class_df-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">build_class_df</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">class_df</span>, </span><span class="param"><span class="n">group_df</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideClass_Constructor.build_class_df-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClass_Constructor.build_class_df"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClass_Constructor.build_class_df-579"><a href="#DisulfideClass_Constructor.build_class_df-579"><span class="linenos">579</span></a>    <span class="k">def</span> <span class="nf">build_class_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_df</span><span class="p">,</span> <span class="n">group_df</span><span class="p">):</span>
</span><span id="DisulfideClass_Constructor.build_class_df-580"><a href="#DisulfideClass_Constructor.build_class_df-580"><span class="linenos">580</span></a>        <span class="n">ss_id_col</span> <span class="o">=</span> <span class="n">group_df</span><span class="p">[</span><span class="s1">&#39;ss_id&#39;</span><span class="p">]</span>
</span><span id="DisulfideClass_Constructor.build_class_df-581"><a href="#DisulfideClass_Constructor.build_class_df-581"><span class="linenos">581</span></a>        <span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">class_df</span><span class="p">,</span> <span class="n">ss_id_col</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor.build_class_df-582"><a href="#DisulfideClass_Constructor.build_class_df-582"><span class="linenos">582</span></a>        <span class="k">return</span> <span class="n">result_df</span>
</span></pre></div>


    

                            </div>
                            <div id="DisulfideClass_Constructor.list_classes" class="classattr">
                                        <input id="DisulfideClass_Constructor.list_classes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">list_classes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideClass_Constructor.list_classes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClass_Constructor.list_classes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClass_Constructor.list_classes-584"><a href="#DisulfideClass_Constructor.list_classes-584"><span class="linenos">584</span></a>    <span class="k">def</span> <span class="nf">list_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideClass_Constructor.list_classes-585"><a href="#DisulfideClass_Constructor.list_classes-585"><span class="linenos">585</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classdict</span><span class="p">):</span>
</span><span id="DisulfideClass_Constructor.list_classes-586"><a href="#DisulfideClass_Constructor.list_classes-586"><span class="linenos">586</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Class: |</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">|, |</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1">|&#39;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="DisulfideClass_Constructor.concat_dataframes" class="classattr">
                                        <input id="DisulfideClass_Constructor.concat_dataframes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">concat_dataframes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">df1</span>, </span><span class="param"><span class="n">df2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideClass_Constructor.concat_dataframes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClass_Constructor.concat_dataframes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClass_Constructor.concat_dataframes-592"><a href="#DisulfideClass_Constructor.concat_dataframes-592"><span class="linenos">592</span></a>    <span class="k">def</span> <span class="nf">concat_dataframes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">):</span>
</span><span id="DisulfideClass_Constructor.concat_dataframes-593"><a href="#DisulfideClass_Constructor.concat_dataframes-593"><span class="linenos">593</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClass_Constructor.concat_dataframes-594"><a href="#DisulfideClass_Constructor.concat_dataframes-594"><span class="linenos">594</span></a><span class="sd">        Concatenates columns from one data frame into the other </span>
</span><span id="DisulfideClass_Constructor.concat_dataframes-595"><a href="#DisulfideClass_Constructor.concat_dataframes-595"><span class="linenos">595</span></a><span class="sd">        and returns the new result.</span>
</span><span id="DisulfideClass_Constructor.concat_dataframes-596"><a href="#DisulfideClass_Constructor.concat_dataframes-596"><span class="linenos">596</span></a>
</span><span id="DisulfideClass_Constructor.concat_dataframes-597"><a href="#DisulfideClass_Constructor.concat_dataframes-597"><span class="linenos">597</span></a><span class="sd">        Parameters</span>
</span><span id="DisulfideClass_Constructor.concat_dataframes-598"><a href="#DisulfideClass_Constructor.concat_dataframes-598"><span class="linenos">598</span></a><span class="sd">        ----------</span>
</span><span id="DisulfideClass_Constructor.concat_dataframes-599"><a href="#DisulfideClass_Constructor.concat_dataframes-599"><span class="linenos">599</span></a><span class="sd">        df1 : pandas.DataFrame</span>
</span><span id="DisulfideClass_Constructor.concat_dataframes-600"><a href="#DisulfideClass_Constructor.concat_dataframes-600"><span class="linenos">600</span></a><span class="sd">            The first data frame.</span>
</span><span id="DisulfideClass_Constructor.concat_dataframes-601"><a href="#DisulfideClass_Constructor.concat_dataframes-601"><span class="linenos">601</span></a><span class="sd">        df2 : pandas.DataFrame</span>
</span><span id="DisulfideClass_Constructor.concat_dataframes-602"><a href="#DisulfideClass_Constructor.concat_dataframes-602"><span class="linenos">602</span></a><span class="sd">            The second data frame.</span>
</span><span id="DisulfideClass_Constructor.concat_dataframes-603"><a href="#DisulfideClass_Constructor.concat_dataframes-603"><span class="linenos">603</span></a>
</span><span id="DisulfideClass_Constructor.concat_dataframes-604"><a href="#DisulfideClass_Constructor.concat_dataframes-604"><span class="linenos">604</span></a><span class="sd">        Returns</span>
</span><span id="DisulfideClass_Constructor.concat_dataframes-605"><a href="#DisulfideClass_Constructor.concat_dataframes-605"><span class="linenos">605</span></a><span class="sd">        -------</span>
</span><span id="DisulfideClass_Constructor.concat_dataframes-606"><a href="#DisulfideClass_Constructor.concat_dataframes-606"><span class="linenos">606</span></a><span class="sd">        pandas.DataFrame</span>
</span><span id="DisulfideClass_Constructor.concat_dataframes-607"><a href="#DisulfideClass_Constructor.concat_dataframes-607"><span class="linenos">607</span></a><span class="sd">            The concatenated data frame.</span>
</span><span id="DisulfideClass_Constructor.concat_dataframes-608"><a href="#DisulfideClass_Constructor.concat_dataframes-608"><span class="linenos">608</span></a>
</span><span id="DisulfideClass_Constructor.concat_dataframes-609"><a href="#DisulfideClass_Constructor.concat_dataframes-609"><span class="linenos">609</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClass_Constructor.concat_dataframes-610"><a href="#DisulfideClass_Constructor.concat_dataframes-610"><span class="linenos">610</span></a>        <span class="c1"># Merge the data frames based on the &#39;SS_Classname&#39; column</span>
</span><span id="DisulfideClass_Constructor.concat_dataframes-611"><a href="#DisulfideClass_Constructor.concat_dataframes-611"><span class="linenos">611</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;class_id&#39;</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor.concat_dataframes-612"><a href="#DisulfideClass_Constructor.concat_dataframes-612"><span class="linenos">612</span></a>
</span><span id="DisulfideClass_Constructor.concat_dataframes-613"><a href="#DisulfideClass_Constructor.concat_dataframes-613"><span class="linenos">613</span></a>        <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>Concatenates columns from one data frame into the other 
and returns the new result.</p>

<h2 id="parameters">Parameters</h2>

<p>df1 : pandas.DataFrame
    The first data frame.
df2 : pandas.DataFrame
    The second data frame.</p>

<h2 id="returns">Returns</h2>

<p>pandas.DataFrame
    The concatenated data frame.</p>
</div>


                            </div>
                            <div id="DisulfideClass_Constructor.build_yourself" class="classattr">
                                        <input id="DisulfideClass_Constructor.build_yourself-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">build_yourself</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideClass_Constructor.build_yourself-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClass_Constructor.build_yourself"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClass_Constructor.build_yourself-615"><a href="#DisulfideClass_Constructor.build_yourself-615"><span class="linenos">615</span></a>    <span class="k">def</span> <span class="nf">build_yourself</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DisulfideClass_Constructor.build_yourself-616"><a href="#DisulfideClass_Constructor.build_yourself-616"><span class="linenos">616</span></a>        <span class="sd">&#39;&#39;&#39;</span>
</span><span id="DisulfideClass_Constructor.build_yourself-617"><a href="#DisulfideClass_Constructor.build_yourself-617"><span class="linenos">617</span></a><span class="sd">        Builds the internal dictionary mapping the disulfide class names to their respective members.</span>
</span><span id="DisulfideClass_Constructor.build_yourself-618"><a href="#DisulfideClass_Constructor.build_yourself-618"><span class="linenos">618</span></a><span class="sd">        The classnames are defined by the sign of the dihedral angles, per XXX&#39;, the list of SS within</span>
</span><span id="DisulfideClass_Constructor.build_yourself-619"><a href="#DisulfideClass_Constructor.build_yourself-619"><span class="linenos">619</span></a><span class="sd">        the database classified, and the resulting dict created.</span>
</span><span id="DisulfideClass_Constructor.build_yourself-620"><a href="#DisulfideClass_Constructor.build_yourself-620"><span class="linenos">620</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="DisulfideClass_Constructor.build_yourself-621"><a href="#DisulfideClass_Constructor.build_yourself-621"><span class="linenos">621</span></a>
</span><span id="DisulfideClass_Constructor.build_yourself-622"><a href="#DisulfideClass_Constructor.build_yourself-622"><span class="linenos">622</span></a>        <span class="k">def</span> <span class="nf">ss_id_dict</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
</span><span id="DisulfideClass_Constructor.build_yourself-623"><a href="#DisulfideClass_Constructor.build_yourself-623"><span class="linenos">623</span></a>            <span class="n">ss_id_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SS_Classname&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ss_id&#39;</span><span class="p">]))</span>
</span><span id="DisulfideClass_Constructor.build_yourself-624"><a href="#DisulfideClass_Constructor.build_yourself-624"><span class="linenos">624</span></a>            <span class="k">return</span> <span class="n">ss_id_dict</span>
</span><span id="DisulfideClass_Constructor.build_yourself-625"><a href="#DisulfideClass_Constructor.build_yourself-625"><span class="linenos">625</span></a>
</span><span id="DisulfideClass_Constructor.build_yourself-626"><a href="#DisulfideClass_Constructor.build_yourself-626"><span class="linenos">626</span></a>        <span class="n">PDB_SS</span> <span class="o">=</span> <span class="n">Load_PDB_SS</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor.build_yourself-627"><a href="#DisulfideClass_Constructor.build_yourself-627"><span class="linenos">627</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor.build_yourself-628"><a href="#DisulfideClass_Constructor.build_yourself-628"><span class="linenos">628</span></a>            <span class="n">PDB_SS</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</span><span id="DisulfideClass_Constructor.build_yourself-629"><a href="#DisulfideClass_Constructor.build_yourself-629"><span class="linenos">629</span></a>
</span><span id="DisulfideClass_Constructor.build_yourself-630"><a href="#DisulfideClass_Constructor.build_yourself-630"><span class="linenos">630</span></a>        <span class="n">tors_df</span> <span class="o">=</span> <span class="n">PDB_SS</span><span class="o">.</span><span class="n">getTorsions</span><span class="p">()</span>
</span><span id="DisulfideClass_Constructor.build_yourself-631"><a href="#DisulfideClass_Constructor.build_yourself-631"><span class="linenos">631</span></a>
</span><span id="DisulfideClass_Constructor.build_yourself-632"><a href="#DisulfideClass_Constructor.build_yourself-632"><span class="linenos">632</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor.build_yourself-633"><a href="#DisulfideClass_Constructor.build_yourself-633"><span class="linenos">633</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; DisulfideClass_Constructor(): creating SS classes...&#39;</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor.build_yourself-634"><a href="#DisulfideClass_Constructor.build_yourself-634"><span class="linenos">634</span></a>
</span><span id="DisulfideClass_Constructor.build_yourself-635"><a href="#DisulfideClass_Constructor.build_yourself-635"><span class="linenos">635</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">create_classes</span><span class="p">(</span><span class="n">tors_df</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor.build_yourself-636"><a href="#DisulfideClass_Constructor.build_yourself-636"><span class="linenos">636</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">class_df</span> <span class="o">=</span> <span class="n">grouped</span>
</span><span id="DisulfideClass_Constructor.build_yourself-637"><a href="#DisulfideClass_Constructor.build_yourself-637"><span class="linenos">637</span></a>
</span><span id="DisulfideClass_Constructor.build_yourself-638"><a href="#DisulfideClass_Constructor.build_yourself-638"><span class="linenos">638</span></a>        <span class="n">grouped</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s1">PDB_ss_classes.csv&#39;</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor.build_yourself-639"><a href="#DisulfideClass_Constructor.build_yourself-639"><span class="linenos">639</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor.build_yourself-640"><a href="#DisulfideClass_Constructor.build_yourself-640"><span class="linenos">640</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">grouped</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor.build_yourself-641"><a href="#DisulfideClass_Constructor.build_yourself-641"><span class="linenos">641</span></a>
</span><span id="DisulfideClass_Constructor.build_yourself-642"><a href="#DisulfideClass_Constructor.build_yourself-642"><span class="linenos">642</span></a>        <span class="c1">#grouped_summary = grouped.drop(columns=[&#39;ss_id&#39;], axis=1)</span>
</span><span id="DisulfideClass_Constructor.build_yourself-643"><a href="#DisulfideClass_Constructor.build_yourself-643"><span class="linenos">643</span></a>        <span class="c1">#grouped_summary.to_csv(f&#39;{DATA_DIR}PDB_ss_classes_summary.csv&#39;)</span>
</span><span id="DisulfideClass_Constructor.build_yourself-644"><a href="#DisulfideClass_Constructor.build_yourself-644"><span class="linenos">644</span></a>        
</span><span id="DisulfideClass_Constructor.build_yourself-645"><a href="#DisulfideClass_Constructor.build_yourself-645"><span class="linenos">645</span></a>        <span class="c1"># this file is hand made. Do not change it. -egs-</span>
</span><span id="DisulfideClass_Constructor.build_yourself-646"><a href="#DisulfideClass_Constructor.build_yourself-646"><span class="linenos">646</span></a>        <span class="c1">#class_df = pd.read_csv(f&#39;{DATA_DIR}PDB_ss_classes_master2.csv&#39;, dtype={&#39;class_id&#39;: &#39;string&#39;, &#39;FXN&#39;: &#39;string&#39;, &#39;SS_Classname&#39;: &#39;string&#39;})</span>
</span><span id="DisulfideClass_Constructor.build_yourself-647"><a href="#DisulfideClass_Constructor.build_yourself-647"><span class="linenos">647</span></a>
</span><span id="DisulfideClass_Constructor.build_yourself-648"><a href="#DisulfideClass_Constructor.build_yourself-648"><span class="linenos">648</span></a>        <span class="c1"># !!! df = pd.read_csv(pd.compat.StringIO(csv_string))</span>
</span><span id="DisulfideClass_Constructor.build_yourself-649"><a href="#DisulfideClass_Constructor.build_yourself-649"><span class="linenos">649</span></a>        <span class="c1"># class_df = pd.read_csv(f&#39;{DATA_DIR}PDB_SS_class_definitions.csv&#39;, dtype={&#39;class_id&#39;: &#39;string&#39;, &#39;FXN&#39;: &#39;string&#39;, &#39;SS_Classname&#39;: &#39;string&#39;})</span>
</span><span id="DisulfideClass_Constructor.build_yourself-650"><a href="#DisulfideClass_Constructor.build_yourself-650"><span class="linenos">650</span></a>        
</span><span id="DisulfideClass_Constructor.build_yourself-651"><a href="#DisulfideClass_Constructor.build_yourself-651"><span class="linenos">651</span></a>        <span class="n">class_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">SS_CLASS_DEFINITIONS</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class_id&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;FXN&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;SS_Classname&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">})</span>
</span><span id="DisulfideClass_Constructor.build_yourself-652"><a href="#DisulfideClass_Constructor.build_yourself-652"><span class="linenos">652</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s1">&#39;FXN&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="DisulfideClass_Constructor.build_yourself-653"><a href="#DisulfideClass_Constructor.build_yourself-653"><span class="linenos">653</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s1">&#39;SS_Classname&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="DisulfideClass_Constructor.build_yourself-654"><a href="#DisulfideClass_Constructor.build_yourself-654"><span class="linenos">654</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s1">&#39;class_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="DisulfideClass_Constructor.build_yourself-655"><a href="#DisulfideClass_Constructor.build_yourself-655"><span class="linenos">655</span></a>
</span><span id="DisulfideClass_Constructor.build_yourself-656"><a href="#DisulfideClass_Constructor.build_yourself-656"><span class="linenos">656</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor.build_yourself-657"><a href="#DisulfideClass_Constructor.build_yourself-657"><span class="linenos">657</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; DisulfideClass_Constructor(): merging...&#39;</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor.build_yourself-658"><a href="#DisulfideClass_Constructor.build_yourself-658"><span class="linenos">658</span></a>
</span><span id="DisulfideClass_Constructor.build_yourself-659"><a href="#DisulfideClass_Constructor.build_yourself-659"><span class="linenos">659</span></a>        <span class="n">merged</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">concat_dataframes</span><span class="p">(</span><span class="n">class_df</span><span class="p">,</span> <span class="n">grouped</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor.build_yourself-660"><a href="#DisulfideClass_Constructor.build_yourself-660"><span class="linenos">660</span></a>        <span class="c1">#merged = self.build_class_df(class_df, grouped)</span>
</span><span id="DisulfideClass_Constructor.build_yourself-661"><a href="#DisulfideClass_Constructor.build_yourself-661"><span class="linenos">661</span></a>        <span class="n">merged</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Idx&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor.build_yourself-662"><a href="#DisulfideClass_Constructor.build_yourself-662"><span class="linenos">662</span></a>
</span><span id="DisulfideClass_Constructor.build_yourself-663"><a href="#DisulfideClass_Constructor.build_yourself-663"><span class="linenos">663</span></a>        <span class="n">classdict</span> <span class="o">=</span> <span class="n">ss_id_dict</span><span class="p">(</span><span class="n">merged</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor.build_yourself-664"><a href="#DisulfideClass_Constructor.build_yourself-664"><span class="linenos">664</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdict</span> <span class="o">=</span> <span class="n">classdict</span>
</span><span id="DisulfideClass_Constructor.build_yourself-665"><a href="#DisulfideClass_Constructor.build_yourself-665"><span class="linenos">665</span></a>
</span><span id="DisulfideClass_Constructor.build_yourself-666"><a href="#DisulfideClass_Constructor.build_yourself-666"><span class="linenos">666</span></a>        <span class="n">merged</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}</span><span class="s1">PDB_SS_merged.csv&#39;</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor.build_yourself-667"><a href="#DisulfideClass_Constructor.build_yourself-667"><span class="linenos">667</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classdf</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DisulfideClass_Constructor.build_yourself-668"><a href="#DisulfideClass_Constructor.build_yourself-668"><span class="linenos">668</span></a>
</span><span id="DisulfideClass_Constructor.build_yourself-669"><a href="#DisulfideClass_Constructor.build_yourself-669"><span class="linenos">669</span></a>        <span class="n">fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DATA_DIR</span><span class="si">}{</span><span class="n">SS_CLASS_DICT_FILE</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="DisulfideClass_Constructor.build_yourself-670"><a href="#DisulfideClass_Constructor.build_yourself-670"><span class="linenos">670</span></a>
</span><span id="DisulfideClass_Constructor.build_yourself-671"><a href="#DisulfideClass_Constructor.build_yourself-671"><span class="linenos">671</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor.build_yourself-672"><a href="#DisulfideClass_Constructor.build_yourself-672"><span class="linenos">672</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; DisulfideClass_Constructor(): writing </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor.build_yourself-673"><a href="#DisulfideClass_Constructor.build_yourself-673"><span class="linenos">673</span></a>
</span><span id="DisulfideClass_Constructor.build_yourself-674"><a href="#DisulfideClass_Constructor.build_yourself-674"><span class="linenos">674</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;wb+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor.build_yourself-675"><a href="#DisulfideClass_Constructor.build_yourself-675"><span class="linenos">675</span></a>            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">classdict</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor.build_yourself-676"><a href="#DisulfideClass_Constructor.build_yourself-676"><span class="linenos">676</span></a>
</span><span id="DisulfideClass_Constructor.build_yourself-677"><a href="#DisulfideClass_Constructor.build_yourself-677"><span class="linenos">677</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClass_Constructor.build_yourself-678"><a href="#DisulfideClass_Constructor.build_yourself-678"><span class="linenos">678</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; DisulfideClass_Constructor(): initialization complete.&#39;</span><span class="p">)</span>
</span><span id="DisulfideClass_Constructor.build_yourself-679"><a href="#DisulfideClass_Constructor.build_yourself-679"><span class="linenos">679</span></a>        
</span><span id="DisulfideClass_Constructor.build_yourself-680"><a href="#DisulfideClass_Constructor.build_yourself-680"><span class="linenos">680</span></a>        <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>Builds the internal dictionary mapping the disulfide class names to their respective members.
The classnames are defined by the sign of the dihedral angles, per XXX', the list of SS within
the database classified, and the resulting dict created.</p>
</div>


                            </div>
                </section>
                <section id="create_classes">
                            <input id="create_classes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_classes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">df</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="create_classes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_classes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_classes-684"><a href="#create_classes-684"><span class="linenos">684</span></a><span class="k">def</span> <span class="nf">create_classes</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
</span><span id="create_classes-685"><a href="#create_classes-685"><span class="linenos">685</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_classes-686"><a href="#create_classes-686"><span class="linenos">686</span></a><span class="sd">    Group the DataFrame by the sign of the chi columns and create a new class ID column for each unique grouping.</span>
</span><span id="create_classes-687"><a href="#create_classes-687"><span class="linenos">687</span></a>
</span><span id="create_classes-688"><a href="#create_classes-688"><span class="linenos">688</span></a><span class="sd">    :param df: A pandas DataFrame containing columns &#39;ss_id&#39;, &#39;chi1&#39;, &#39;chi2&#39;, &#39;chi3&#39;, &#39;chi4&#39;, &#39;chi5&#39;, &#39;ca_distance&#39;, &#39;cb_distance&#39;, &#39;torsion_length&#39;, and &#39;energy&#39;.</span>
</span><span id="create_classes-689"><a href="#create_classes-689"><span class="linenos">689</span></a><span class="sd">    :return: A pandas DataFrame containing columns &#39;class_id&#39;, &#39;ss_id&#39;, and &#39;count&#39;, where &#39;class_id&#39; is a unique identifier for each grouping of chi signs, &#39;ss_id&#39; is a list of all &#39;ss_id&#39; values in that grouping, and &#39;count&#39; is the number of rows in that grouping.</span>
</span><span id="create_classes-690"><a href="#create_classes-690"><span class="linenos">690</span></a><span class="sd">    </span>
</span><span id="create_classes-691"><a href="#create_classes-691"><span class="linenos">691</span></a><span class="sd">    Example:</span>
</span><span id="create_classes-692"><a href="#create_classes-692"><span class="linenos">692</span></a><span class="sd">    &gt;&gt;&gt; import pandas as pd</span>
</span><span id="create_classes-693"><a href="#create_classes-693"><span class="linenos">693</span></a><span class="sd">    &gt;&gt;&gt; df = pd.DataFrame({</span>
</span><span id="create_classes-694"><a href="#create_classes-694"><span class="linenos">694</span></a><span class="sd">    ...    &#39;ss_id&#39;: [1, 2, 3, 4, 5],</span>
</span><span id="create_classes-695"><a href="#create_classes-695"><span class="linenos">695</span></a><span class="sd">    ...    &#39;chi1&#39;: [1.0, -1.0, 1.0, 1.0, -1.0],</span>
</span><span id="create_classes-696"><a href="#create_classes-696"><span class="linenos">696</span></a><span class="sd">    ...    &#39;chi2&#39;: [-1.0, -1.0, -1.0, 1.0, 1.0],</span>
</span><span id="create_classes-697"><a href="#create_classes-697"><span class="linenos">697</span></a><span class="sd">    ...    &#39;chi3&#39;: [-1.0, 1.0, -1.0, 1.0, -1.0],</span>
</span><span id="create_classes-698"><a href="#create_classes-698"><span class="linenos">698</span></a><span class="sd">    ...    &#39;chi4&#39;: [1.0, -1.0, 1.0, -1.0, 1.0],</span>
</span><span id="create_classes-699"><a href="#create_classes-699"><span class="linenos">699</span></a><span class="sd">    ...    &#39;chi5&#39;: [1.0, -1.0, -1.0, -1.0, -1.0],</span>
</span><span id="create_classes-700"><a href="#create_classes-700"><span class="linenos">700</span></a><span class="sd">    ...    &#39;ca_distance&#39;: [3.1, 3.2, 3.3, 3.4, 3.5],</span>
</span><span id="create_classes-701"><a href="#create_classes-701"><span class="linenos">701</span></a><span class="sd">    ...    &#39;cb_distance&#39;: [3.1, 3.2, 3.3, 3.4, 3.5],</span>
</span><span id="create_classes-702"><a href="#create_classes-702"><span class="linenos">702</span></a><span class="sd">    ...    &#39;torsion_length&#39;: [120.1, 120.2, 120.3, 120.4, 121.0],</span>
</span><span id="create_classes-703"><a href="#create_classes-703"><span class="linenos">703</span></a><span class="sd">    ...    &#39;energy&#39;: [-2.3, -2.2, -2.1, -2.0, -1.9]</span>
</span><span id="create_classes-704"><a href="#create_classes-704"><span class="linenos">704</span></a><span class="sd">    ... })</span>
</span><span id="create_classes-705"><a href="#create_classes-705"><span class="linenos">705</span></a><span class="sd">    &gt;&gt;&gt; create_classes(df)</span>
</span><span id="create_classes-706"><a href="#create_classes-706"><span class="linenos">706</span></a><span class="sd">      class_id ss_id  count  incidence  percentage</span>
</span><span id="create_classes-707"><a href="#create_classes-707"><span class="linenos">707</span></a><span class="sd">    0    00200   [2]      1        0.2        20.0</span>
</span><span id="create_classes-708"><a href="#create_classes-708"><span class="linenos">708</span></a><span class="sd">    1    02020   [5]      1        0.2        20.0</span>
</span><span id="create_classes-709"><a href="#create_classes-709"><span class="linenos">709</span></a><span class="sd">    2    20020   [3]      1        0.2        20.0</span>
</span><span id="create_classes-710"><a href="#create_classes-710"><span class="linenos">710</span></a><span class="sd">    3    20022   [1]      1        0.2        20.0</span>
</span><span id="create_classes-711"><a href="#create_classes-711"><span class="linenos">711</span></a><span class="sd">    4    22200   [4]      1        0.2        20.0</span>
</span><span id="create_classes-712"><a href="#create_classes-712"><span class="linenos">712</span></a>
</span><span id="create_classes-713"><a href="#create_classes-713"><span class="linenos">713</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_classes-714"><a href="#create_classes-714"><span class="linenos">714</span></a>    <span class="c1"># Create new columns with the sign of each chi column</span>
</span><span id="create_classes-715"><a href="#create_classes-715"><span class="linenos">715</span></a>    <span class="n">chi_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;chi1&#39;</span><span class="p">,</span> <span class="s1">&#39;chi2&#39;</span><span class="p">,</span> <span class="s1">&#39;chi3&#39;</span><span class="p">,</span> <span class="s1">&#39;chi4&#39;</span><span class="p">,</span> <span class="s1">&#39;chi5&#39;</span><span class="p">]</span>
</span><span id="create_classes-716"><a href="#create_classes-716"><span class="linenos">716</span></a>    <span class="n">sign_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="o">+</span> <span class="s1">&#39;_s&#39;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">chi_columns</span><span class="p">]</span>
</span><span id="create_classes-717"><a href="#create_classes-717"><span class="linenos">717</span></a>    <span class="n">df</span><span class="p">[</span><span class="n">sign_columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">chi_columns</span><span class="p">]</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="create_classes-718"><a href="#create_classes-718"><span class="linenos">718</span></a>    
</span><span id="create_classes-719"><a href="#create_classes-719"><span class="linenos">719</span></a>    <span class="c1"># Create a new column with the class ID for each row</span>
</span><span id="create_classes-720"><a href="#create_classes-720"><span class="linenos">720</span></a>    <span class="n">class_id_column</span> <span class="o">=</span> <span class="s1">&#39;class_id&#39;</span>
</span><span id="create_classes-721"><a href="#create_classes-721"><span class="linenos">721</span></a>    <span class="n">df</span><span class="p">[</span><span class="n">class_id_column</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">sign_columns</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="create_classes-722"><a href="#create_classes-722"><span class="linenos">722</span></a>
</span><span id="create_classes-723"><a href="#create_classes-723"><span class="linenos">723</span></a>    <span class="c1"># Group the DataFrame by the class ID and return the grouped data</span>
</span><span id="create_classes-724"><a href="#create_classes-724"><span class="linenos">724</span></a>    <span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">class_id_column</span><span class="p">)[</span><span class="s1">&#39;ss_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="create_classes-725"><a href="#create_classes-725"><span class="linenos">725</span></a>    <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;ss_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="create_classes-726"><a href="#create_classes-726"><span class="linenos">726</span></a>    <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;incidence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;ss_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
</span><span id="create_classes-727"><a href="#create_classes-727"><span class="linenos">727</span></a>    <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;percentage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;incidence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
</span><span id="create_classes-728"><a href="#create_classes-728"><span class="linenos">728</span></a>
</span><span id="create_classes-729"><a href="#create_classes-729"><span class="linenos">729</span></a>    <span class="k">return</span> <span class="n">grouped</span>
</span></pre></div>


            <div class="docstring"><p>Group the DataFrame by the sign of the chi columns and create a new class ID column for each unique grouping.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>df</strong>:  A pandas DataFrame containing columns 'ss_id', 'chi1', 'chi2', 'chi3', 'chi4', 'chi5', 'ca_distance', 'cb_distance', 'torsion_length', and 'energy'.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A pandas DataFrame containing columns 'class_id', 'ss_id', and 'count', where 'class_id' is a unique identifier for each grouping of chi signs, 'ss_id' is a list of all 'ss_id' values in that grouping, and 'count' is the number of rows in that grouping.</p>
</blockquote>

<p>Example:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>   <span class="s1">&#39;ss_id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">... </span>   <span class="s1">&#39;chi1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="s1">&#39;chi2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="s1">&#39;chi3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="s1">&#39;chi4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="s1">&#39;chi5&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="s1">&#39;ca_distance&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.1</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">3.3</span><span class="p">,</span> <span class="mf">3.4</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">],</span>
<span class="gp">... </span>   <span class="s1">&#39;cb_distance&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.1</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">3.3</span><span class="p">,</span> <span class="mf">3.4</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">],</span>
<span class="gp">... </span>   <span class="s1">&#39;torsion_length&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">120.1</span><span class="p">,</span> <span class="mf">120.2</span><span class="p">,</span> <span class="mf">120.3</span><span class="p">,</span> <span class="mf">120.4</span><span class="p">,</span> <span class="mf">121.0</span><span class="p">],</span>
<span class="gp">... </span>   <span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.9</span><span class="p">]</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_classes</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">  class_id ss_id  count  incidence  percentage</span>
<span class="go">0    00200   [2]      1        0.2        20.0</span>
<span class="go">1    02020   [5]      1        0.2        20.0</span>
<span class="go">2    20020   [3]      1        0.2        20.0</span>
<span class="go">3    20022   [1]      1        0.2        20.0</span>
<span class="go">4    22200   [4]      1        0.2        20.0</span>
</code></pre>
</div>
</div>


                </section>
                <section id="Load_PDB_SS">
                            <input id="Load_PDB_SS-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">Load_PDB_SS</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">loadpath</span><span class="o">=</span><span class="s1">&#39;/Users/egs/repos/proteusPy/proteusPy/data/&#39;</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">subset</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="#DisulfideLoader">proteusPy.DisulfideLoader.DisulfideLoader</a></span>:</span></span>

                <label class="view-source-button" for="Load_PDB_SS-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Load_PDB_SS"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Load_PDB_SS-731"><a href="#Load_PDB_SS-731"><span class="linenos">731</span></a><span class="k">def</span> <span class="nf">Load_PDB_SS</span><span class="p">(</span><span class="n">loadpath</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideLoader</span><span class="p">:</span>
</span><span id="Load_PDB_SS-732"><a href="#Load_PDB_SS-732"><span class="linenos">732</span></a>    <span class="sd">&#39;&#39;&#39;</span>
</span><span id="Load_PDB_SS-733"><a href="#Load_PDB_SS-733"><span class="linenos">733</span></a><span class="sd">    Load the fully instantiated Disulfide database from the specified file. Use the</span>
</span><span id="Load_PDB_SS-734"><a href="#Load_PDB_SS-734"><span class="linenos">734</span></a><span class="sd">    defaults unless you are building the database by hand. *This is the function</span>
</span><span id="Load_PDB_SS-735"><a href="#Load_PDB_SS-735"><span class="linenos">735</span></a><span class="sd">    used to load the built database.*</span>
</span><span id="Load_PDB_SS-736"><a href="#Load_PDB_SS-736"><span class="linenos">736</span></a>
</span><span id="Load_PDB_SS-737"><a href="#Load_PDB_SS-737"><span class="linenos">737</span></a><span class="sd">    :param loadpath: Path from which to load, defaults to DATA_DIR</span>
</span><span id="Load_PDB_SS-738"><a href="#Load_PDB_SS-738"><span class="linenos">738</span></a><span class="sd">    :param fname: Filename, defaults to LOADER_FNAME</span>
</span><span id="Load_PDB_SS-739"><a href="#Load_PDB_SS-739"><span class="linenos">739</span></a><span class="sd">    :param verbose: Verbosity, defaults to False</span>
</span><span id="Load_PDB_SS-740"><a href="#Load_PDB_SS-740"><span class="linenos">740</span></a><span class="sd">    :param subset: If True, load the subset DB, otherwise load the full database</span>
</span><span id="Load_PDB_SS-741"><a href="#Load_PDB_SS-741"><span class="linenos">741</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="Load_PDB_SS-742"><a href="#Load_PDB_SS-742"><span class="linenos">742</span></a>    <span class="k">if</span> <span class="n">subset</span><span class="p">:</span>
</span><span id="Load_PDB_SS-743"><a href="#Load_PDB_SS-743"><span class="linenos">743</span></a>        <span class="n">_fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">loadpath</span><span class="si">}{</span><span class="n">LOADER_SUBSET_FNAME</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Load_PDB_SS-744"><a href="#Load_PDB_SS-744"><span class="linenos">744</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Load_PDB_SS-745"><a href="#Load_PDB_SS-745"><span class="linenos">745</span></a>        <span class="n">_fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">loadpath</span><span class="si">}{</span><span class="n">LOADER_FNAME</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Load_PDB_SS-746"><a href="#Load_PDB_SS-746"><span class="linenos">746</span></a>
</span><span id="Load_PDB_SS-747"><a href="#Load_PDB_SS-747"><span class="linenos">747</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Load_PDB_SS-748"><a href="#Load_PDB_SS-748"><span class="linenos">748</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;-&gt; load_PDB_SS(): Reading </span><span class="si">{</span><span class="n">_fname</span><span class="si">}</span><span class="s1">... &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="Load_PDB_SS-749"><a href="#Load_PDB_SS-749"><span class="linenos">749</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="Load_PDB_SS-750"><a href="#Load_PDB_SS-750"><span class="linenos">750</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">_fname</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="Load_PDB_SS-751"><a href="#Load_PDB_SS-751"><span class="linenos">751</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="Load_PDB_SS-752"><a href="#Load_PDB_SS-752"><span class="linenos">752</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Load_PDB_SS-753"><a href="#Load_PDB_SS-753"><span class="linenos">753</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;done.&#39;</span><span class="p">)</span>
</span><span id="Load_PDB_SS-754"><a href="#Load_PDB_SS-754"><span class="linenos">754</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="Load_PDB_SS-755"><a href="#Load_PDB_SS-755"><span class="linenos">755</span></a>    <span class="k">except</span><span class="p">:</span>
</span><span id="Load_PDB_SS-756"><a href="#Load_PDB_SS-756"><span class="linenos">756</span></a>        <span class="n">mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;-&gt; load_PDB_SS(): cannot open file </span><span class="si">{</span><span class="n">_fname</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Load_PDB_SS-757"><a href="#Load_PDB_SS-757"><span class="linenos">757</span></a>        <span class="k">raise</span> <span class="n">DisulfideIOException</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Load the fully instantiated Disulfide database from the specified file. Use the
defaults unless you are building the database by hand. <em>This is the function
used to load the built database.</em></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>loadpath</strong>:  Path from which to load, defaults to DATA_DIR</li>
<li><strong>fname</strong>:  Filename, defaults to LOADER_FNAME</li>
<li><strong>verbose</strong>:  Verbosity, defaults to False</li>
<li><strong>subset</strong>:  If True, load the subset DB, otherwise load the full database</li>
</ul>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>