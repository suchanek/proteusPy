<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>proteusPy.DisulfideClassManager API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../proteusPy.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;proteusPy</a>

            <img src="./logo.png" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#DisulfideClassManager">DisulfideClassManager</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DisulfideClassManager.__init__">DisulfideClassManager</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideClassManager.verbose">verbose</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideClassManager.binaryclass_dict">binaryclass_dict</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideClassManager.binaryclass_df">binaryclass_df</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideClassManager.eightclass_df">eightclass_df</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideClassManager.eightclass_dict">eightclass_dict</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideClassManager.consensus_binary_list">consensus_binary_list</a>
                        </li>
                        <li>
                                <a class="variable" href="#DisulfideClassManager.consensus_oct_list">consensus_oct_list</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassManager.load_consensus_file">load_consensus_file</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassManager.build_class_df">build_class_df</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassManager.class_to_sslist">class_to_sslist</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassManager.list_classes">list_classes</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassManager.concat_dataframes">concat_dataframes</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassManager.binary_to_class">binary_to_class</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassManager.build_classes">build_classes</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassManager.create_binary_classes">create_binary_classes</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassManager.create_classes">create_classes</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassManager.filter_class_by_percentage">filter_class_by_percentage</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassManager.get_binary_quadrant">get_binary_quadrant</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassManager.get_sixth_quadrant">get_sixth_quadrant</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassManager.get_eighth_quadrant">get_eighth_quadrant</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassManager.get_class_string">get_class_string</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassManager.class_string_from_dihedral">class_string_from_dihedral</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassManager.sslist_from_classid">sslist_from_classid</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassManager.class_to_binary">class_to_binary</a>
                        </li>
                        <li>
                                <a class="function" href="#DisulfideClassManager.get_class_df">get_class_df</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../proteusPy.html">proteusPy</a><wbr>.DisulfideClassManager    </h1>

                        <div class="docstring"><p>DisulfideBond Class Analysis Dictionary creation
Author: Eric G. Suchanek, PhD.
License: BSD
Last Modification: 2025-01-22 00:02:43 -egs-</p>

<p>Disulfide Class creation and manipulation. Binary classes using the +/- formalism of Hogg et al. 
(Biochem, 2006, 45, 7429-7433), are created for all 32 possible classes from the Disulfides 
extracted. Classes are named per Hogg's convention. This approach is extended to create 
eightfold classes based on the subdividing each dihedral angle chi1 - chi5 into 
8 equal segments, effectively quantizing them.</p>
</div>

                        <input id="mod-DisulfideClassManager-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-DisulfideClassManager-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">DisulfideBond Class Analysis Dictionary creation</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">Author: Eric G. Suchanek, PhD.</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">License: BSD</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">Last Modification: 2025-01-22 00:02:43 -egs-</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">Disulfide Class creation and manipulation. Binary classes using the +/- formalism of Hogg et al. </span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">(Biochem, 2006, 45, 7429-7433), are created for all 32 possible classes from the Disulfides </span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">extracted. Classes are named per Hogg&#39;s convention. This approach is extended to create </span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="sd">eightfold classes based on the subdividing each dihedral angle chi1 - chi5 into </span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="sd">8 equal segments, effectively quantizing them.</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="c1"># pylint: disable=C0301</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="c1"># pylint: disable=C0103</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">io</span><span class="w"> </span><span class="kn">import</span> <span class="n">StringIO</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="c1"># from proteusPy.DisulfideBase import DisulfideList</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">proteusPy.logger_config</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_logger</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">proteusPy.ProteusGlobals</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>    <span class="n">DATA_DIR</span><span class="p">,</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>    <span class="n">SS_CLASS_DEFINITIONS</span><span class="p">,</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>    <span class="n">SS_CONSENSUS_BIN_FILE</span><span class="p">,</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>    <span class="n">SS_CONSENSUS_OCT_FILE</span><span class="p">,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="p">)</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="n">_logger</span> <span class="o">=</span> <span class="n">create_logger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="n">_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="s2">&quot;INFO&quot;</span><span class="p">)</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DisulfideClassManager</span><span class="p">:</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">    This Class manages structural classes for the disulfide bonds contained</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">    in the proteusPy disulfide database.</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">    Class builds the internal dictionary mapping disulfides to class names.</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">    Disulfide binary classes are defined using the ± formalism described by</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">    Schmidt et al. (Biochem, 2006, 45, 7429-7433), across all 32 (2^5), possible</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">    binary sidechain torsional combinations. Classes are named per Schmidt&#39;s convention.</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">    The ``class_id`` represents the sign of each dihedral angle $\chi_{1} - \chi_{1&#39;}$</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">    where *0* represents *negative* dihedral angle and *2* a *positive* angle.</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">    |   class_id | SS_Classname   | FXN        |   count |   incidence |   percentage |</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">    |-----------:|:---------------|:-----------|--------:|------------:|-------------:|</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">    |      00000 | -LHSpiral      | UNK        |   40943 |  0.23359    |    23.359    |</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">    |      00002 | 00002          | UNK        |    9391 |  0.0535781  |     5.35781  |</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">    |      00020 | -LHHook        | UNK        |    4844 |  0.0276363  |     2.76363  |</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">    |      00022 | 00022          | UNK        |    2426 |  0.0138409  |     1.38409  |</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">    |      00200 | -RHStaple      | Allosteric |   16146 |  0.092117   |     9.2117   |</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">    |      00202 | 00202          | UNK        |    1396 |  0.00796454 |     0.796454 |</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">    |      00220 | 00220          | UNK        |    7238 |  0.0412946  |     4.12946  |</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">    |      00222 | 00222          | UNK        |    6658 |  0.0379856  |     3.79856  |</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">    |      02000 | 02000          | UNK        |    7104 |  0.0405301  |     4.05301  |</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">    |      02002 | 02002          | UNK        |    8044 |  0.0458931  |     4.58931  |</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">    |      02020 | -LHStaple      | UNK        |    3154 |  0.0179944  |     1.79944  |</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">    |      02022 | 02022          | UNK        |    1146 |  0.00653822 |     0.653822 |</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">    |      02200 | -RHHook        | UNK        |    7115 |  0.0405929  |     4.05929  |</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">    |      02202 | 02202          | UNK        |    1021 |  0.00582507 |     0.582507 |</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">    |      02220 | -RHSpiral      | UNK        |    8989 |  0.0512845  |     5.12845  |</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">    |      02222 | 02222          | UNK        |    7641 |  0.0435939  |     4.35939  |</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">    |      20000 | ±LHSpiral      | UNK        |    5007 |  0.0285662  |     2.85662  |</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">    |      20002 | +LHSpiral      | UNK        |    1611 |  0.00919117 |     0.919117 |</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">    |      20020 | ±LHHook        | UNK        |    1258 |  0.00717721 |     0.717721 |</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">    |      20022 | +LHHook        | UNK        |     823 |  0.00469542 |     0.469542 |</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">    |      20200 | ±RHStaple      | UNK        |     745 |  0.00425042 |     0.425042 |</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">    |      20202 | +RHStaple      | UNK        |     538 |  0.00306943 |     0.306943 |</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">    |      20220 | ±RHHook        | Catalytic  |    1907 |  0.0108799  |     1.08799  |</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">    |      20222 | 20222          | UNK        |    1159 |  0.00661239 |     0.661239 |</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">    |      22000 | -/+LHHook      | UNK        |    3652 |  0.0208356  |     2.08356  |</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">    |      22002 | 22002          | UNK        |    2052 |  0.0117072  |     1.17072  |</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">    |      22020 | ±LHStaple      | UNK        |    1791 |  0.0102181  |     1.02181  |</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">    |      22022 | +LHStaple      | UNK        |     579 |  0.00330334 |     0.330334 |</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">    |      22200 | -/+RHHook      | UNK        |    8169 |  0.0466062  |     4.66062  |</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">    |      22202 | +RHHook        | UNK        |     895 |  0.0051062  |     0.51062  |</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">    |      22220 | ±RHSpiral      | UNK        |    3581 |  0.0204305  |     2.04305  |</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">    |      22222 | +RHSpiral      | UNK        |    8254 |  0.0470912  |     4.70912  |</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loader</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_df</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_df</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">consensus_binary_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">consensus_oct_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>                <span class="s2">&quot;Loading binary consensus structure list from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">SS_CONSENSUS_BIN_FILE</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>            <span class="p">)</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">consensus_binary_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_consensus_file</span><span class="p">(</span><span class="n">octant</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>                <span class="s2">&quot;Loading octant consensus structure list from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">SS_CONSENSUS_OCT_FILE</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>            <span class="p">)</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">consensus_oct_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_consensus_file</span><span class="p">(</span><span class="n">octant</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_classes</span><span class="p">(</span><span class="n">loader</span><span class="p">)</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">        Implements indexing against a class ID string.</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">        Return an array of disulfide IDs given the input Class ID string.</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">        :param item: The class ID string to index.</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="sd">        :type item: str</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">        :return: An array of disulfide IDs corresponding to the class ID.</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="sd">        :rtype: np.ndarray</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a><span class="sd">        :raises ValueError: If an integer index is provided.</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="sd">        :raises DisulfideException: If the class ID is invalid.</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>        <span class="n">disulfides</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Integer indexing not supported. Use a string key.&quot;</span><span class="p">)</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>            <span class="n">disulfides</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_sslist</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>            <span class="k">return</span> <span class="n">disulfides</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>        <span class="k">return</span> <span class="n">disulfides</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_consensus_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fpath</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">),</span> <span class="n">octant</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Load the consensus file from the specified file.&quot;&quot;&quot;</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>        <span class="k">if</span> <span class="n">octant</span><span class="p">:</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>            <span class="n">fname</span> <span class="o">=</span> <span class="n">fpath</span> <span class="o">/</span> <span class="n">SS_CONSENSUS_OCT_FILE</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>            <span class="n">fname</span> <span class="o">=</span> <span class="n">fpath</span> <span class="o">/</span> <span class="n">SS_CONSENSUS_BIN_FILE</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">fname</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Cannot find file </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot find file </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build_class_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_df</span><span class="p">,</span> <span class="n">group_df</span><span class="p">):</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build a new DataFrame from the input DataFrames.&quot;&quot;&quot;</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>        <span class="n">ss_id_col</span> <span class="o">=</span> <span class="n">group_df</span><span class="p">[</span><span class="s2">&quot;ss_id&quot;</span><span class="p">]</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>        <span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">class_df</span><span class="p">,</span> <span class="n">ss_id_col</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>        <span class="k">return</span> <span class="n">result_df</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">class_to_sslist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clsid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="sd">        Return the list of disulfides corresponding to the input `clsid`.</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">        This list is a list of disulfide identifiers, not the Disulfide objects themselves.</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">        :param clsid: The class name to extract. Must be a string</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">        in the format &#39;11111&#39; or &#39;11111b&#39; or &#39;11111o&#39;. The suffix &#39;b&#39; or &#39;o&#39; indicates</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="sd">        binary or octant classes, respectively.</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a><span class="sd">        :type clsid: str</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">        :param base: The base class to use, 2 or 8. Default is 8.</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="sd">        :type base: int</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a><span class="sd">        :param verbose: If True, display progress bars, by default False.</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a><span class="sd">        :type verbose: bool</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a><span class="sd">        :return: The list of disulfide bonds from the class. NB: this is the list</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a><span class="sd">        of disulfide identifiers, not the Disulfide objects themselves.</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a><span class="sd">        :rtype: DisulfideList</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a><span class="sd">        :raises ValueError: If an invalid base value is provided.</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a><span class="sd">        :raises KeyError: If the clsid is not found in the dictionary.</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>        <span class="bp">cls</span> <span class="o">=</span> <span class="n">clsid</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">clsid</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid class ID: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">clsid</span><span class="p">)</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>        <span class="k">match</span> <span class="nb">len</span><span class="p">(</span><span class="n">clsid</span><span class="p">):</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>            <span class="k">case</span> <span class="mi">6</span><span class="p">:</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>                <span class="k">match</span> <span class="n">clsid</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>                    <span class="k">case</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>                        <span class="n">eightorbin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_dict</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>                    <span class="k">case</span> <span class="s2">&quot;o&quot;</span><span class="p">:</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>                        <span class="n">eightorbin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_dict</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>                    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>                        <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid class ID suffix: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">clsid</span><span class="p">)</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>                        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>            <span class="k">case</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>                <span class="k">match</span> <span class="n">base</span><span class="p">:</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>                    <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>                        <span class="n">eightorbin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_dict</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>                    <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>                        <span class="n">eightorbin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_dict</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>                    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>                        <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid base: </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>                        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid class ID length: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">clsid</span><span class="p">)</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>            <span class="n">ss_ids</span> <span class="o">=</span> <span class="n">eightorbin</span><span class="p">[</span><span class="bp">cls</span><span class="p">]</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Cannot find key </span><span class="si">%s</span><span class="s2"> in SSBond DB&quot;</span><span class="p">,</span> <span class="n">clsid</span><span class="p">)</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>        <span class="k">return</span> <span class="n">ss_ids</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a><span class="sd">        List the Disulfide structural classes.</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a><span class="sd">        :param self: The instance of the DisulfideClassManager class.</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a><span class="sd">        :type self: DisulfideClassManager</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a><span class="sd">        :param base: The base class to use, 2 or 8.</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a><span class="sd">        :type base: int</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a><span class="sd">        :return: None</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a><span class="sd">        :rtype: None</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a><span class="sd">        :raises ValueError: If an invalid base value is provided.</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>        <span class="k">match</span> <span class="n">base</span><span class="p">:</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>            <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_dict</span><span class="p">):</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class: |</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">|, |</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">|&quot;</span><span class="p">)</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>            <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eightclass_dict</span><span class="p">):</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class: |</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">|, |</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">|&quot;</span><span class="p">)</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be 2 or 8.&quot;</span><span class="p">)</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">concat_dataframes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">):</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a><span class="sd">        Concatenates columns from one data frame into the other</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="sd">        and returns the new result.</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">        Parameters</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="sd">        ----------</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a><span class="sd">        df1 : pandas.DataFrame</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="sd">            The first data frame.</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a><span class="sd">        df2 : pandas.DataFrame</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="sd">            The second data frame.</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a><span class="sd">        Returns</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a><span class="sd">        -------</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a><span class="sd">        pandas.DataFrame</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a><span class="sd">            The concatenated data frame.</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>        <span class="c1"># Merge the data frames based on the &#39;SS_Classname&#39; column</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;class_id&quot;</span><span class="p">)</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">binary_to_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a><span class="sd">        Convert a binary input string to a list of possible class strings based on the specified base.</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a><span class="sd">        Returns a list of all possible combinations of ordinal sections of a unit circle</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a><span class="sd">        divided into the specified number of equal segments, originating at 0 degrees, rotating counterclockwise,</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a><span class="sd">        based on the sign of each angle in the input string.</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a><span class="sd">        :param class_str: A string of length 5, where each character represents the sign</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a><span class="sd">        of an angle in the range of -180-180 degrees.</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a><span class="sd">        :type class_str: str</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a><span class="sd">        :param base: The base class to use, 6 or 8.</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="sd">        :type base: int</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a><span class="sd">        :return: A list of strings of length 5, representing all possible class strings.</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a><span class="sd">        :rtype: list</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a><span class="sd">        :raises ValueError: If an invalid base value is provided.</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>        <span class="k">match</span> <span class="n">base</span><span class="p">:</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>            <span class="k">case</span> <span class="mi">6</span><span class="p">:</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>                <span class="n">angle_maps</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;0&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">],</span> <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">]}</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>            <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>                <span class="n">angle_maps</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;0&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">],</span> <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">]}</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>            <span class="k">case</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>                <span class="n">angle_maps</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>                    <span class="s2">&quot;0&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="s2">&quot;9&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">],</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>                    <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">],</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>                <span class="p">}</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base value. Must be 6, 8, or 10.&quot;</span><span class="p">)</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>        <span class="n">class_lists</span> <span class="o">=</span> <span class="p">[</span><span class="n">angle_maps</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">class_str</span><span class="p">]</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>        <span class="n">class_combinations</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">class_lists</span><span class="p">)</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>        <span class="n">class_strings</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">combination</span><span class="p">)</span> <span class="k">for</span> <span class="n">combination</span> <span class="ow">in</span> <span class="n">class_combinations</span><span class="p">]</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>        <span class="k">return</span> <span class="n">class_strings</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loader</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="sd">        Build the internal structures needed for the binary and octant disulfide structural classes</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a><span class="sd">        based on dihedral angle rules.</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a><span class="sd">        :param loader: The DisulfideLoader object containing the data.</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a><span class="sd">        :type loader: DisulfideLoader</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a><span class="sd">        :return: None</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a><span class="sd">        :rtype: None</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">proteusPy</span><span class="w"> </span><span class="kn">import</span> <span class="n">__version__</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">__version__</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>        <span class="n">tors_df</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">getTorsions</span><span class="p">()</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating binary SS classes...&quot;</span><span class="p">)</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_binary_classes</span><span class="p">(</span><span class="n">tors_df</span><span class="p">)</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>        <span class="n">class_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>            <span class="n">StringIO</span><span class="p">(</span><span class="n">SS_CLASS_DEFINITIONS</span><span class="p">),</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>            <span class="n">dtype</span><span class="o">=</span><span class="p">{</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>                <span class="s2">&quot;class_id&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>                <span class="s2">&quot;FXN&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>                <span class="s2">&quot;SS_Classname&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>            <span class="p">},</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>        <span class="p">)</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s2">&quot;FXN&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s2">&quot;SS_Classname&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>        <span class="n">merged</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">concat_dataframes</span><span class="p">(</span><span class="n">class_df</span><span class="p">,</span> <span class="n">grouped</span><span class="p">)</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>        <span class="n">merged</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Idx&quot;</span><span class="p">,</span> <span class="s2">&quot;chi1_s&quot;</span><span class="p">,</span> <span class="s2">&quot;chi2_s&quot;</span><span class="p">,</span> <span class="s2">&quot;chi3_s&quot;</span><span class="p">,</span> <span class="s2">&quot;chi4_s&quot;</span><span class="p">,</span> <span class="s2">&quot;chi5_s&quot;</span><span class="p">],</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>            <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>        <span class="p">)</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>        <span class="n">classdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">merged</span><span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">],</span> <span class="n">merged</span><span class="p">[</span><span class="s2">&quot;ss_id&quot;</span><span class="p">]))</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_dict</span> <span class="o">=</span> <span class="n">classdict</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_df</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating eightfold SS classes...&quot;</span><span class="p">)</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>        <span class="n">grouped_eightclass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_classes</span><span class="p">(</span><span class="n">tors_df</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_df</span> <span class="o">=</span> <span class="n">grouped_eightclass</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>            <span class="nb">zip</span><span class="p">(</span><span class="n">grouped_eightclass</span><span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">],</span> <span class="n">grouped_eightclass</span><span class="p">[</span><span class="s2">&quot;ss_id&quot;</span><span class="p">])</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>        <span class="p">)</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Initialization complete.&quot;</span><span class="p">)</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>        <span class="k">return</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_binary_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a><span class="sd">        Group the DataFrame by the sign of the chi columns and create a new class ID column for each unique grouping.</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a><span class="sd">        :param df: A pandas DataFrame containing columns &#39;ss_id&#39;, &#39;chi1&#39;, &#39;chi2&#39;, &#39;chi3&#39;, &#39;chi4&#39;, &#39;chi5&#39;, &#39;ca_distance&#39;,</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a><span class="sd">        &#39;cb_distance&#39;, &#39;torsion_length&#39;, and &#39;energy&#39;.</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a><span class="sd">        :return: A pandas DataFrame containing columns &#39;class_id&#39;, &#39;ss_id&#39;, and &#39;count&#39;, where &#39;class_id&#39;</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a><span class="sd">         is a unique identifier for each grouping of chi signs, &#39;ss_id&#39; is a list of all &#39;ss_id&#39; values in that</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a><span class="sd">         grouping, and &#39;count&#39; is the number of rows in that grouping.</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>        <span class="c1"># Create new columns with the sign of each chi column</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>        <span class="n">chi_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;chi1&quot;</span><span class="p">,</span> <span class="s2">&quot;chi2&quot;</span><span class="p">,</span> <span class="s2">&quot;chi3&quot;</span><span class="p">,</span> <span class="s2">&quot;chi4&quot;</span><span class="p">,</span> <span class="s2">&quot;chi5&quot;</span><span class="p">]</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>        <span class="n">sign_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="o">+</span> <span class="s2">&quot;_s&quot;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">chi_columns</span><span class="p">]</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>        <span class="n">df</span><span class="p">[</span><span class="n">sign_columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">chi_columns</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>        <span class="c1"># Create a new column with the class ID for each row</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>        <span class="n">class_id_column</span> <span class="o">=</span> <span class="s2">&quot;class_id&quot;</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>        <span class="n">df</span><span class="p">[</span><span class="n">class_id_column</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">sign_columns</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>        <span class="p">)</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>        <span class="c1"># Group the DataFrame by the class ID and return the grouped data</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">class_id_column</span><span class="p">)[</span><span class="s2">&quot;ss_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>        <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;ss_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>        <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;incidence&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>        <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;percentage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;incidence&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>        <span class="k">return</span> <span class="n">grouped</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a><span class="sd">        Create a new DataFrame with 8-class encoding for input &#39;chi&#39; values.</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a><span class="sd">        The function takes a pandas DataFrame containing the following columns:</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a><span class="sd">        &#39;ss_id&#39;, &#39;chi1&#39;, &#39;chi2&#39;, &#39;chi3&#39;, &#39;chi4&#39;, &#39;chi5&#39;, &#39;ca_distance&#39;, &#39;cb_distance&#39;,</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a><span class="sd">        &#39;torsion_length&#39;, &#39;energy&#39;, and &#39;rho&#39;, and adds a class ID column based on the following rules:</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a><span class="sd">        1. A new column named `class_id` is added, which is the concatenation of the individual class IDs per Chi.</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a><span class="sd">        2. The DataFrame is grouped by the `class_id` column, and a new DataFrame is returned that shows the unique `ss_id` values for each group,</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a><span class="sd">        the count of unique `ss_id` values, the incidence of each group as a proportion of the total DataFrame, and</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a><span class="sd">        the percentage of incidence.</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a><span class="sd">        :param df: A pandas DataFrame containing columns &#39;ss_id&#39;, &#39;chi1&#39;, &#39;chi2&#39;, &#39;chi3&#39;, &#39;chi4&#39;, &#39;chi5&#39;,</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a><span class="sd">                &#39;ca_distance&#39;, &#39;cb_distance&#39;, &#39;torsion_length&#39;, &#39;energy&#39;, and &#39;rho&#39;</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a><span class="sd">        :return: The grouped DataFrame with the added class column.</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">]:</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Base must be either 2, 4, 6, 8, or 10&quot;</span><span class="p">)</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>        <span class="c1"># Apply get_class_string function to each chi column based on the specified base</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>        <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;chi1&quot;</span><span class="p">,</span> <span class="s2">&quot;chi2&quot;</span><span class="p">,</span> <span class="s2">&quot;chi3&quot;</span><span class="p">,</span> <span class="s2">&quot;chi4&quot;</span><span class="p">,</span> <span class="s2">&quot;chi5&quot;</span><span class="p">]:</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>            <span class="n">df</span><span class="p">[</span><span class="n">col_name</span> <span class="o">+</span> <span class="s2">&quot;_t&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">DisulfideClassManager</span><span class="o">.</span><span class="n">get_class_string</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>            <span class="p">)</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>        <span class="c1"># Concatenate the transformed chi columns to create class_id</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;chi1_t&quot;</span><span class="p">,</span> <span class="s2">&quot;chi2_t&quot;</span><span class="p">,</span> <span class="s2">&quot;chi3_t&quot;</span><span class="p">,</span> <span class="s2">&quot;chi4_t&quot;</span><span class="p">,</span> <span class="s2">&quot;chi5_t&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>            <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>        <span class="p">)</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>        <span class="c1"># Group by class_id and aggregate required statistics</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;class_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;ss_id&quot;</span><span class="p">:</span> <span class="s2">&quot;unique&quot;</span><span class="p">})</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>        <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;ss_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>        <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;incidence&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>        <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;percentage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;incidence&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>        <span class="k">return</span> <span class="n">grouped</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">filter_class_by_percentage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a><span class="sd">        Filter the specified class definitions by percentage.</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a><span class="sd">        :param cutoff: A numeric value specifying the minimum percentage required for a row to be included in the output</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a><span class="sd">        :param base: An optional integer specifying the class type to filter, defaults to 8</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a><span class="sd">        :return: A new Pandas DataFrame containing only rows where the percentage is greater than or equal to the cutoff</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a><span class="sd">        :rtype: pandas.DataFrame</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>        <span class="k">match</span> <span class="n">base</span><span class="p">:</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>            <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_df</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>            <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_df</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be 6 or 8.&quot;</span><span class="p">)</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>        <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;percentage&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">cutoff</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_binary_quadrant</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a><span class="sd">        Return the binary quadrant in which an angle in degrees lies if the area is described by dividing a unit circle into 2 equal segments.</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a><span class="sd">        :param angle_deg (float or array-like): The angle in degrees.</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a><span class="sd">        Returns:</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a><span class="sd">        :return str. The binary quadrant (0 or 2) that the angle belongs to.</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>        <span class="n">angle_deg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>        <span class="p">)</span>  <span class="c1"># Normalize the angle to the range [0, 360)</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">):</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>            <span class="k">if</span> <span class="n">angle_deg</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">angle_deg</span> <span class="o">&lt;</span> <span class="mi">180</span><span class="p">:</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>                <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>            <span class="k">if</span> <span class="n">angle_deg</span> <span class="o">&gt;=</span> <span class="mi">180</span> <span class="ow">and</span> <span class="n">angle_deg</span> <span class="o">&lt;</span> <span class="mi">360</span><span class="p">:</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>                <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>                <span class="s2">&quot;Invalid angle value: angle must be in the range [-360, 360).&quot;</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>            <span class="p">)</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>        <span class="n">quadrants</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">angle_deg</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">angle_deg</span> <span class="o">&lt;</span> <span class="mi">180</span><span class="p">),</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">quadrants</span><span class="p">)</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sixth_quadrant</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a><span class="sd">        Return the eighth quadrant in which an angle in degrees lies by dividing a unit circle into 8 equal segments.</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a><span class="sd">        :param angle_deg: float or array-like</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a><span class="sd">            The angle in degrees.</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a><span class="sd">        :return: str</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>        <span class="c1"># Normalize the angle to the range [0, 360)</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>        <span class="n">angle_deg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>        <span class="c1"># Calculate quadrant: each quadrant spans 60 degrees.</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>        <span class="c1"># The quadrant is computed as: quadrant = 6 - floor(angle_deg / 60)</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>        <span class="n">quadrant</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">floor_divide</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>        <span class="c1"># If the input was scalar (0-dim array), return a string.</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>        <span class="k">if</span> <span class="n">angle_deg</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">quadrant</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>            <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">quadrant</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_eighth_quadrant</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a><span class="sd">        Return the eighth quadrant in which an angle in degrees lies by dividing a unit circle into 8 equal segments.</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a><span class="sd">        :param angle_deg: float or array-like</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a><span class="sd">            The angle in degrees.</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a><span class="sd">        :return: str</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>        <span class="c1"># Normalize the angle to the range [0, 360)</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>        <span class="n">angle_deg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>        <span class="c1"># Calculate quadrant: each quadrant spans 45 degrees.</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>        <span class="c1"># The quadrant is computed as: quadrant = 8 - floor(angle_deg / 45)</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>        <span class="n">quadrant</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">floor_divide</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>        <span class="c1"># If the input was scalar (0-dim array), return a string.</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>        <span class="k">if</span> <span class="n">angle_deg</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">quadrant</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">quadrant</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_class_string</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a><span class="sd">        Return the segment corresponding to an angle in degrees when the circle is divided into</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a><span class="sd">        a specified number of equal segments. The segments are labeled in descending order, so that:</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a><span class="sd">            - For base=8, an angle in [0, 45) degrees returns &quot;8&quot;,</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a><span class="sd">            an angle in [45, 90) returns &quot;7&quot;, ...,</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a><span class="sd">            and an angle in [315, 360) returns &quot;1&quot;.</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a><span class="sd">        :param angle_deg: The angle in degrees. Single or array-like with length 5.</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a><span class="sd">        :type angle_deg: float or array-like</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a><span class="sd">        :param base: The number of segments (default is 8). For example, with base=8 each segment spans 45°,</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a><span class="sd">        with base=12 each spans 30°, etc.</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a><span class="sd">        :type base: int, optional, default=8, max=16, must be even.</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a><span class="sd">        :return: The label corresponding to the segment in which the input angle lies. For scalar input,</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a><span class="sd">                    a single string is returned; for array-like input, a NumPy array of strings is returned.</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a><span class="sd">        :rtype: str</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a><span class="sd">        :raises ValueError: If the base is out of range.</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>        <span class="c1"># Character map for the segment labels, technically up to base 36.</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>        <span class="n">char_map</span> <span class="o">=</span> <span class="s2">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>        <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>        <span class="c1"># Normalize the angle to [0, 360)</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>        <span class="n">angle_deg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>        <span class="c1"># Each segment spans 360/base degrees.</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>        <span class="n">segment_size</span> <span class="o">=</span> <span class="mi">360</span> <span class="o">/</span> <span class="n">base</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]:</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You must enter either 1 or 5 dihedral angles.&quot;</span><span class="p">)</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="o">&gt;</span> <span class="mi">16</span> <span class="ow">or</span> <span class="n">base</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">base</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be even and between 2 and 16.&quot;</span><span class="p">)</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a>            <span class="k">return</span> <span class="n">DisulfideClassManager</span><span class="o">.</span><span class="n">get_binary_quadrant</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>        <span class="c1"># Compute the segment number: subtract the segment index (via floor division) from base.</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>        <span class="n">segment</span> <span class="o">=</span> <span class="n">base</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">floor_divide</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">,</span> <span class="n">segment_size</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>        <span class="c1"># Return as string(s)</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a>        <span class="k">if</span> <span class="n">angle_deg</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>            <span class="k">return</span> <span class="n">char_map</span><span class="p">[</span><span class="n">segment</span><span class="o">.</span><span class="n">item</span><span class="p">()]</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">char_map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">segment</span><span class="p">)</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">class_string_from_dihedral</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a><span class="sd">        Return the class string for a set of dihedral angles, given the base.</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a><span class="sd">        :param args: One or five dihedral angles.</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a><span class="sd">        :type args: float or array-like</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a><span class="sd">        :param base: The base class to use, 2, 6, or 8. Defaults to 8.</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a><span class="sd">        :type base: int, optional</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a><span class="sd">        :return: The class string for the input dihedral angles.</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a><span class="sd">        :rtype: str</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a><span class="sd">        :raises ValueError: If the number of dihedral angles is not 1 or 5, or if the base is not 2, 6, or 8.</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]:</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You must enter either 1 or 5 dihedral angles.&quot;</span><span class="p">)</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="o">&gt;</span> <span class="mi">16</span> <span class="ow">or</span> <span class="n">base</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">base</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be between 2 and 16, and even.&quot;</span><span class="p">)</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>        <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>        <span class="k">match</span> <span class="nb">len</span><span class="p">(</span><span class="n">angles</span><span class="p">):</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>            <span class="k">case</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>                <span class="k">return</span> <span class="n">DisulfideClassManager</span><span class="o">.</span><span class="n">get_class_string</span><span class="p">(</span><span class="n">angles</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>            <span class="k">case</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a>                <span class="n">segments</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a>                    <span class="n">DisulfideClassManager</span><span class="o">.</span><span class="n">get_class_string</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a>                    <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">angles</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a>                <span class="p">]</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a>                <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid number of angles. Must be 1 or 5.&quot;</span><span class="p">)</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sslist_from_classid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a><span class="sd">        Return the &#39;ss_id&#39; value in the given DataFrame that corresponds to the</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a><span class="sd">        input &#39;cls&#39; string in the class description</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_df</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a>        <span class="k">elif</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_df</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be 2 or 8.&quot;</span><span class="p">)</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a>        <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">cls</span><span class="p">]</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Multiple rows found for class_id &#39;</span><span class="si">{</span><span class="bp">cls</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a>        <span class="k">return</span> <span class="n">filtered_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;ss_id&quot;</span><span class="p">]</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">class_to_binary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cls_str</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a><span class="sd">        Return a string of length 5 representing the ordinal section of a unit circle for an angle in range -180-180 degrees</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a><span class="sd">        into a string of 5 characters, where each character is either &#39;0&#39; if the corresponding input character represents a</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a><span class="sd">        negative angle or &#39;2&#39; if it represents a positive angle.</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a><span class="sd">        :param cls_str (str): A string of length 5 representing the ordinal section of a unit circle for an angle in range -180-180 degrees.</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a><span class="sd">        :param base (int): The base of the ordinal section (6 or 8).</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a><span class="sd">        :raises ValueError: If the base is not 6 or 8 or 10.</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a><span class="sd">        :return str: A string of length 5, where each character is either &#39;0&#39; or &#39;2&#39;, representing the sign of the corresponding input angle.</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">]:</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Base must be either 6, 8, or 10&quot;</span><span class="p">)</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a>
</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a>        <span class="n">output_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a>        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">cls_str</span><span class="p">:</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a>            <span class="k">match</span> <span class="n">base</span><span class="p">:</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a>                <span class="k">case</span> <span class="mi">6</span><span class="p">:</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a>                    <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">]:</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a>                        <span class="n">output_str</span> <span class="o">+=</span> <span class="s2">&quot;2&quot;</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a>                    <span class="k">elif</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">]:</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a>                        <span class="n">output_str</span> <span class="o">+=</span> <span class="s2">&quot;0&quot;</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a>                <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a>                    <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">]:</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a>                        <span class="n">output_str</span> <span class="o">+=</span> <span class="s2">&quot;2&quot;</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a>                    <span class="k">elif</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">]:</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a>                        <span class="n">output_str</span> <span class="o">+=</span> <span class="s2">&quot;0&quot;</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a>                <span class="k">case</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a>                    <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">]:</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a>                        <span class="n">output_str</span> <span class="o">+=</span> <span class="s2">&quot;2&quot;</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a>                    <span class="k">elif</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="s2">&quot;9&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">]:</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a>                        <span class="n">output_str</span> <span class="o">+=</span> <span class="s2">&quot;0&quot;</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a>                <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be either 6, 8, or 10&quot;</span><span class="p">)</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a>        <span class="k">return</span> <span class="n">output_str</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a>
</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_class_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a><span class="sd">        Get the Disulfide structural classes DataFrame.</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a>
</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a><span class="sd">        :param base: The base class to use, either 2 or 8. Defaults to 8.</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a><span class="sd">        :type base: int</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a><span class="sd">        :return: A DataFrame containing the class_id, count, incidence, and percentage columns.</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos">661</span></a><span class="sd">        :rtype: pandas.DataFrame</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos">662</span></a><span class="sd">        :raises ValueError: If the base is not 2 or 8.</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos">663</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos">664</span></a>        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="s2">&quot;incidence&quot;</span><span class="p">,</span> <span class="s2">&quot;percentage&quot;</span><span class="p">]</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos">665</span></a>        <span class="k">match</span> <span class="n">base</span><span class="p">:</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos">666</span></a>            <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos">667</span></a>                <span class="n">class_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_df</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos">668</span></a>            <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos">669</span></a>                <span class="n">class_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_df</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos">670</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos">671</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be 2, or 8.&quot;</span><span class="p">)</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos">672</span></a>
</span><span id="L-673"><a href="#L-673"><span class="linenos">673</span></a>        <span class="n">result_df</span> <span class="o">=</span> <span class="n">class_df</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos">674</span></a>        <span class="k">return</span> <span class="n">result_df</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos">675</span></a>
</span><span id="L-676"><a href="#L-676"><span class="linenos">676</span></a>
</span><span id="L-677"><a href="#L-677"><span class="linenos">677</span></a><span class="c1"># class definition ends</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos">678</span></a>
</span><span id="L-679"><a href="#L-679"><span class="linenos">679</span></a><span class="c1"># end of file</span>
</span></pre></div>


            </section>
                <section id="DisulfideClassManager">
                            <input id="DisulfideClassManager-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DisulfideClassManager</span>:

                <label class="view-source-button" for="DisulfideClassManager-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassManager"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassManager-39"><a href="#DisulfideClassManager-39"><span class="linenos"> 39</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DisulfideClassManager</span><span class="p">:</span>
</span><span id="DisulfideClassManager-40"><a href="#DisulfideClassManager-40"><span class="linenos"> 40</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-41"><a href="#DisulfideClassManager-41"><span class="linenos"> 41</span></a><span class="sd">    This Class manages structural classes for the disulfide bonds contained</span>
</span><span id="DisulfideClassManager-42"><a href="#DisulfideClassManager-42"><span class="linenos"> 42</span></a><span class="sd">    in the proteusPy disulfide database.</span>
</span><span id="DisulfideClassManager-43"><a href="#DisulfideClassManager-43"><span class="linenos"> 43</span></a>
</span><span id="DisulfideClassManager-44"><a href="#DisulfideClassManager-44"><span class="linenos"> 44</span></a><span class="sd">    Class builds the internal dictionary mapping disulfides to class names.</span>
</span><span id="DisulfideClassManager-45"><a href="#DisulfideClassManager-45"><span class="linenos"> 45</span></a>
</span><span id="DisulfideClassManager-46"><a href="#DisulfideClassManager-46"><span class="linenos"> 46</span></a><span class="sd">    Disulfide binary classes are defined using the ± formalism described by</span>
</span><span id="DisulfideClassManager-47"><a href="#DisulfideClassManager-47"><span class="linenos"> 47</span></a><span class="sd">    Schmidt et al. (Biochem, 2006, 45, 7429-7433), across all 32 (2^5), possible</span>
</span><span id="DisulfideClassManager-48"><a href="#DisulfideClassManager-48"><span class="linenos"> 48</span></a><span class="sd">    binary sidechain torsional combinations. Classes are named per Schmidt&#39;s convention.</span>
</span><span id="DisulfideClassManager-49"><a href="#DisulfideClassManager-49"><span class="linenos"> 49</span></a><span class="sd">    The ``class_id`` represents the sign of each dihedral angle $\chi_{1} - \chi_{1&#39;}$</span>
</span><span id="DisulfideClassManager-50"><a href="#DisulfideClassManager-50"><span class="linenos"> 50</span></a><span class="sd">    where *0* represents *negative* dihedral angle and *2* a *positive* angle.</span>
</span><span id="DisulfideClassManager-51"><a href="#DisulfideClassManager-51"><span class="linenos"> 51</span></a>
</span><span id="DisulfideClassManager-52"><a href="#DisulfideClassManager-52"><span class="linenos"> 52</span></a><span class="sd">    |   class_id | SS_Classname   | FXN        |   count |   incidence |   percentage |</span>
</span><span id="DisulfideClassManager-53"><a href="#DisulfideClassManager-53"><span class="linenos"> 53</span></a><span class="sd">    |-----------:|:---------------|:-----------|--------:|------------:|-------------:|</span>
</span><span id="DisulfideClassManager-54"><a href="#DisulfideClassManager-54"><span class="linenos"> 54</span></a><span class="sd">    |      00000 | -LHSpiral      | UNK        |   40943 |  0.23359    |    23.359    |</span>
</span><span id="DisulfideClassManager-55"><a href="#DisulfideClassManager-55"><span class="linenos"> 55</span></a><span class="sd">    |      00002 | 00002          | UNK        |    9391 |  0.0535781  |     5.35781  |</span>
</span><span id="DisulfideClassManager-56"><a href="#DisulfideClassManager-56"><span class="linenos"> 56</span></a><span class="sd">    |      00020 | -LHHook        | UNK        |    4844 |  0.0276363  |     2.76363  |</span>
</span><span id="DisulfideClassManager-57"><a href="#DisulfideClassManager-57"><span class="linenos"> 57</span></a><span class="sd">    |      00022 | 00022          | UNK        |    2426 |  0.0138409  |     1.38409  |</span>
</span><span id="DisulfideClassManager-58"><a href="#DisulfideClassManager-58"><span class="linenos"> 58</span></a><span class="sd">    |      00200 | -RHStaple      | Allosteric |   16146 |  0.092117   |     9.2117   |</span>
</span><span id="DisulfideClassManager-59"><a href="#DisulfideClassManager-59"><span class="linenos"> 59</span></a><span class="sd">    |      00202 | 00202          | UNK        |    1396 |  0.00796454 |     0.796454 |</span>
</span><span id="DisulfideClassManager-60"><a href="#DisulfideClassManager-60"><span class="linenos"> 60</span></a><span class="sd">    |      00220 | 00220          | UNK        |    7238 |  0.0412946  |     4.12946  |</span>
</span><span id="DisulfideClassManager-61"><a href="#DisulfideClassManager-61"><span class="linenos"> 61</span></a><span class="sd">    |      00222 | 00222          | UNK        |    6658 |  0.0379856  |     3.79856  |</span>
</span><span id="DisulfideClassManager-62"><a href="#DisulfideClassManager-62"><span class="linenos"> 62</span></a><span class="sd">    |      02000 | 02000          | UNK        |    7104 |  0.0405301  |     4.05301  |</span>
</span><span id="DisulfideClassManager-63"><a href="#DisulfideClassManager-63"><span class="linenos"> 63</span></a><span class="sd">    |      02002 | 02002          | UNK        |    8044 |  0.0458931  |     4.58931  |</span>
</span><span id="DisulfideClassManager-64"><a href="#DisulfideClassManager-64"><span class="linenos"> 64</span></a><span class="sd">    |      02020 | -LHStaple      | UNK        |    3154 |  0.0179944  |     1.79944  |</span>
</span><span id="DisulfideClassManager-65"><a href="#DisulfideClassManager-65"><span class="linenos"> 65</span></a><span class="sd">    |      02022 | 02022          | UNK        |    1146 |  0.00653822 |     0.653822 |</span>
</span><span id="DisulfideClassManager-66"><a href="#DisulfideClassManager-66"><span class="linenos"> 66</span></a><span class="sd">    |      02200 | -RHHook        | UNK        |    7115 |  0.0405929  |     4.05929  |</span>
</span><span id="DisulfideClassManager-67"><a href="#DisulfideClassManager-67"><span class="linenos"> 67</span></a><span class="sd">    |      02202 | 02202          | UNK        |    1021 |  0.00582507 |     0.582507 |</span>
</span><span id="DisulfideClassManager-68"><a href="#DisulfideClassManager-68"><span class="linenos"> 68</span></a><span class="sd">    |      02220 | -RHSpiral      | UNK        |    8989 |  0.0512845  |     5.12845  |</span>
</span><span id="DisulfideClassManager-69"><a href="#DisulfideClassManager-69"><span class="linenos"> 69</span></a><span class="sd">    |      02222 | 02222          | UNK        |    7641 |  0.0435939  |     4.35939  |</span>
</span><span id="DisulfideClassManager-70"><a href="#DisulfideClassManager-70"><span class="linenos"> 70</span></a><span class="sd">    |      20000 | ±LHSpiral      | UNK        |    5007 |  0.0285662  |     2.85662  |</span>
</span><span id="DisulfideClassManager-71"><a href="#DisulfideClassManager-71"><span class="linenos"> 71</span></a><span class="sd">    |      20002 | +LHSpiral      | UNK        |    1611 |  0.00919117 |     0.919117 |</span>
</span><span id="DisulfideClassManager-72"><a href="#DisulfideClassManager-72"><span class="linenos"> 72</span></a><span class="sd">    |      20020 | ±LHHook        | UNK        |    1258 |  0.00717721 |     0.717721 |</span>
</span><span id="DisulfideClassManager-73"><a href="#DisulfideClassManager-73"><span class="linenos"> 73</span></a><span class="sd">    |      20022 | +LHHook        | UNK        |     823 |  0.00469542 |     0.469542 |</span>
</span><span id="DisulfideClassManager-74"><a href="#DisulfideClassManager-74"><span class="linenos"> 74</span></a><span class="sd">    |      20200 | ±RHStaple      | UNK        |     745 |  0.00425042 |     0.425042 |</span>
</span><span id="DisulfideClassManager-75"><a href="#DisulfideClassManager-75"><span class="linenos"> 75</span></a><span class="sd">    |      20202 | +RHStaple      | UNK        |     538 |  0.00306943 |     0.306943 |</span>
</span><span id="DisulfideClassManager-76"><a href="#DisulfideClassManager-76"><span class="linenos"> 76</span></a><span class="sd">    |      20220 | ±RHHook        | Catalytic  |    1907 |  0.0108799  |     1.08799  |</span>
</span><span id="DisulfideClassManager-77"><a href="#DisulfideClassManager-77"><span class="linenos"> 77</span></a><span class="sd">    |      20222 | 20222          | UNK        |    1159 |  0.00661239 |     0.661239 |</span>
</span><span id="DisulfideClassManager-78"><a href="#DisulfideClassManager-78"><span class="linenos"> 78</span></a><span class="sd">    |      22000 | -/+LHHook      | UNK        |    3652 |  0.0208356  |     2.08356  |</span>
</span><span id="DisulfideClassManager-79"><a href="#DisulfideClassManager-79"><span class="linenos"> 79</span></a><span class="sd">    |      22002 | 22002          | UNK        |    2052 |  0.0117072  |     1.17072  |</span>
</span><span id="DisulfideClassManager-80"><a href="#DisulfideClassManager-80"><span class="linenos"> 80</span></a><span class="sd">    |      22020 | ±LHStaple      | UNK        |    1791 |  0.0102181  |     1.02181  |</span>
</span><span id="DisulfideClassManager-81"><a href="#DisulfideClassManager-81"><span class="linenos"> 81</span></a><span class="sd">    |      22022 | +LHStaple      | UNK        |     579 |  0.00330334 |     0.330334 |</span>
</span><span id="DisulfideClassManager-82"><a href="#DisulfideClassManager-82"><span class="linenos"> 82</span></a><span class="sd">    |      22200 | -/+RHHook      | UNK        |    8169 |  0.0466062  |     4.66062  |</span>
</span><span id="DisulfideClassManager-83"><a href="#DisulfideClassManager-83"><span class="linenos"> 83</span></a><span class="sd">    |      22202 | +RHHook        | UNK        |     895 |  0.0051062  |     0.51062  |</span>
</span><span id="DisulfideClassManager-84"><a href="#DisulfideClassManager-84"><span class="linenos"> 84</span></a><span class="sd">    |      22220 | ±RHSpiral      | UNK        |    3581 |  0.0204305  |     2.04305  |</span>
</span><span id="DisulfideClassManager-85"><a href="#DisulfideClassManager-85"><span class="linenos"> 85</span></a><span class="sd">    |      22222 | +RHSpiral      | UNK        |    8254 |  0.0470912  |     4.70912  |</span>
</span><span id="DisulfideClassManager-86"><a href="#DisulfideClassManager-86"><span class="linenos"> 86</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-87"><a href="#DisulfideClassManager-87"><span class="linenos"> 87</span></a>
</span><span id="DisulfideClassManager-88"><a href="#DisulfideClassManager-88"><span class="linenos"> 88</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loader</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassManager-89"><a href="#DisulfideClassManager-89"><span class="linenos"> 89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="DisulfideClassManager-90"><a href="#DisulfideClassManager-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideClassManager-91"><a href="#DisulfideClassManager-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_df</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClassManager-92"><a href="#DisulfideClassManager-92"><span class="linenos"> 92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_df</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClassManager-93"><a href="#DisulfideClassManager-93"><span class="linenos"> 93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideClassManager-94"><a href="#DisulfideClassManager-94"><span class="linenos"> 94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">consensus_binary_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClassManager-95"><a href="#DisulfideClassManager-95"><span class="linenos"> 95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">consensus_oct_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClassManager-96"><a href="#DisulfideClassManager-96"><span class="linenos"> 96</span></a>
</span><span id="DisulfideClassManager-97"><a href="#DisulfideClassManager-97"><span class="linenos"> 97</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClassManager-98"><a href="#DisulfideClassManager-98"><span class="linenos"> 98</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="DisulfideClassManager-99"><a href="#DisulfideClassManager-99"><span class="linenos"> 99</span></a>                <span class="s2">&quot;Loading binary consensus structure list from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">SS_CONSENSUS_BIN_FILE</span>
</span><span id="DisulfideClassManager-100"><a href="#DisulfideClassManager-100"><span class="linenos">100</span></a>            <span class="p">)</span>
</span><span id="DisulfideClassManager-101"><a href="#DisulfideClassManager-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">consensus_binary_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_consensus_file</span><span class="p">(</span><span class="n">octant</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="DisulfideClassManager-102"><a href="#DisulfideClassManager-102"><span class="linenos">102</span></a>
</span><span id="DisulfideClassManager-103"><a href="#DisulfideClassManager-103"><span class="linenos">103</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClassManager-104"><a href="#DisulfideClassManager-104"><span class="linenos">104</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="DisulfideClassManager-105"><a href="#DisulfideClassManager-105"><span class="linenos">105</span></a>                <span class="s2">&quot;Loading octant consensus structure list from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">SS_CONSENSUS_OCT_FILE</span>
</span><span id="DisulfideClassManager-106"><a href="#DisulfideClassManager-106"><span class="linenos">106</span></a>            <span class="p">)</span>
</span><span id="DisulfideClassManager-107"><a href="#DisulfideClassManager-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">consensus_oct_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_consensus_file</span><span class="p">(</span><span class="n">octant</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DisulfideClassManager-108"><a href="#DisulfideClassManager-108"><span class="linenos">108</span></a>
</span><span id="DisulfideClassManager-109"><a href="#DisulfideClassManager-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_classes</span><span class="p">(</span><span class="n">loader</span><span class="p">)</span>
</span><span id="DisulfideClassManager-110"><a href="#DisulfideClassManager-110"><span class="linenos">110</span></a>
</span><span id="DisulfideClassManager-111"><a href="#DisulfideClassManager-111"><span class="linenos">111</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="DisulfideClassManager-112"><a href="#DisulfideClassManager-112"><span class="linenos">112</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-113"><a href="#DisulfideClassManager-113"><span class="linenos">113</span></a><span class="sd">        Implements indexing against a class ID string.</span>
</span><span id="DisulfideClassManager-114"><a href="#DisulfideClassManager-114"><span class="linenos">114</span></a>
</span><span id="DisulfideClassManager-115"><a href="#DisulfideClassManager-115"><span class="linenos">115</span></a><span class="sd">        Return an array of disulfide IDs given the input Class ID string.</span>
</span><span id="DisulfideClassManager-116"><a href="#DisulfideClassManager-116"><span class="linenos">116</span></a>
</span><span id="DisulfideClassManager-117"><a href="#DisulfideClassManager-117"><span class="linenos">117</span></a><span class="sd">        :param item: The class ID string to index.</span>
</span><span id="DisulfideClassManager-118"><a href="#DisulfideClassManager-118"><span class="linenos">118</span></a><span class="sd">        :type item: str</span>
</span><span id="DisulfideClassManager-119"><a href="#DisulfideClassManager-119"><span class="linenos">119</span></a><span class="sd">        :return: An array of disulfide IDs corresponding to the class ID.</span>
</span><span id="DisulfideClassManager-120"><a href="#DisulfideClassManager-120"><span class="linenos">120</span></a><span class="sd">        :rtype: np.ndarray</span>
</span><span id="DisulfideClassManager-121"><a href="#DisulfideClassManager-121"><span class="linenos">121</span></a><span class="sd">        :raises ValueError: If an integer index is provided.</span>
</span><span id="DisulfideClassManager-122"><a href="#DisulfideClassManager-122"><span class="linenos">122</span></a><span class="sd">        :raises DisulfideException: If the class ID is invalid.</span>
</span><span id="DisulfideClassManager-123"><a href="#DisulfideClassManager-123"><span class="linenos">123</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-124"><a href="#DisulfideClassManager-124"><span class="linenos">124</span></a>        <span class="n">disulfides</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClassManager-125"><a href="#DisulfideClassManager-125"><span class="linenos">125</span></a>
</span><span id="DisulfideClassManager-126"><a href="#DisulfideClassManager-126"><span class="linenos">126</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="DisulfideClassManager-127"><a href="#DisulfideClassManager-127"><span class="linenos">127</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Integer indexing not supported. Use a string key.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-128"><a href="#DisulfideClassManager-128"><span class="linenos">128</span></a>
</span><span id="DisulfideClassManager-129"><a href="#DisulfideClassManager-129"><span class="linenos">129</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="DisulfideClassManager-130"><a href="#DisulfideClassManager-130"><span class="linenos">130</span></a>            <span class="n">disulfides</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_to_sslist</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span id="DisulfideClassManager-131"><a href="#DisulfideClassManager-131"><span class="linenos">131</span></a>            <span class="k">return</span> <span class="n">disulfides</span>
</span><span id="DisulfideClassManager-132"><a href="#DisulfideClassManager-132"><span class="linenos">132</span></a>
</span><span id="DisulfideClassManager-133"><a href="#DisulfideClassManager-133"><span class="linenos">133</span></a>        <span class="k">return</span> <span class="n">disulfides</span>
</span><span id="DisulfideClassManager-134"><a href="#DisulfideClassManager-134"><span class="linenos">134</span></a>
</span><span id="DisulfideClassManager-135"><a href="#DisulfideClassManager-135"><span class="linenos">135</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_consensus_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fpath</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">),</span> <span class="n">octant</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="DisulfideClassManager-136"><a href="#DisulfideClassManager-136"><span class="linenos">136</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Load the consensus file from the specified file.&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-137"><a href="#DisulfideClassManager-137"><span class="linenos">137</span></a>
</span><span id="DisulfideClassManager-138"><a href="#DisulfideClassManager-138"><span class="linenos">138</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClassManager-139"><a href="#DisulfideClassManager-139"><span class="linenos">139</span></a>        <span class="k">if</span> <span class="n">octant</span><span class="p">:</span>
</span><span id="DisulfideClassManager-140"><a href="#DisulfideClassManager-140"><span class="linenos">140</span></a>            <span class="n">fname</span> <span class="o">=</span> <span class="n">fpath</span> <span class="o">/</span> <span class="n">SS_CONSENSUS_OCT_FILE</span>
</span><span id="DisulfideClassManager-141"><a href="#DisulfideClassManager-141"><span class="linenos">141</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideClassManager-142"><a href="#DisulfideClassManager-142"><span class="linenos">142</span></a>            <span class="n">fname</span> <span class="o">=</span> <span class="n">fpath</span> <span class="o">/</span> <span class="n">SS_CONSENSUS_BIN_FILE</span>
</span><span id="DisulfideClassManager-143"><a href="#DisulfideClassManager-143"><span class="linenos">143</span></a>
</span><span id="DisulfideClassManager-144"><a href="#DisulfideClassManager-144"><span class="linenos">144</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">fname</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="DisulfideClassManager-145"><a href="#DisulfideClassManager-145"><span class="linenos">145</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Cannot find file </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
</span><span id="DisulfideClassManager-146"><a href="#DisulfideClassManager-146"><span class="linenos">146</span></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot find file </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-147"><a href="#DisulfideClassManager-147"><span class="linenos">147</span></a>
</span><span id="DisulfideClassManager-148"><a href="#DisulfideClassManager-148"><span class="linenos">148</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="DisulfideClassManager-149"><a href="#DisulfideClassManager-149"><span class="linenos">149</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="DisulfideClassManager-150"><a href="#DisulfideClassManager-150"><span class="linenos">150</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="DisulfideClassManager-151"><a href="#DisulfideClassManager-151"><span class="linenos">151</span></a>
</span><span id="DisulfideClassManager-152"><a href="#DisulfideClassManager-152"><span class="linenos">152</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build_class_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_df</span><span class="p">,</span> <span class="n">group_df</span><span class="p">):</span>
</span><span id="DisulfideClassManager-153"><a href="#DisulfideClassManager-153"><span class="linenos">153</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build a new DataFrame from the input DataFrames.&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-154"><a href="#DisulfideClassManager-154"><span class="linenos">154</span></a>        <span class="n">ss_id_col</span> <span class="o">=</span> <span class="n">group_df</span><span class="p">[</span><span class="s2">&quot;ss_id&quot;</span><span class="p">]</span>
</span><span id="DisulfideClassManager-155"><a href="#DisulfideClassManager-155"><span class="linenos">155</span></a>        <span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">class_df</span><span class="p">,</span> <span class="n">ss_id_col</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DisulfideClassManager-156"><a href="#DisulfideClassManager-156"><span class="linenos">156</span></a>        <span class="k">return</span> <span class="n">result_df</span>
</span><span id="DisulfideClassManager-157"><a href="#DisulfideClassManager-157"><span class="linenos">157</span></a>
</span><span id="DisulfideClassManager-158"><a href="#DisulfideClassManager-158"><span class="linenos">158</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">class_to_sslist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clsid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="DisulfideClassManager-159"><a href="#DisulfideClassManager-159"><span class="linenos">159</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-160"><a href="#DisulfideClassManager-160"><span class="linenos">160</span></a><span class="sd">        Return the list of disulfides corresponding to the input `clsid`.</span>
</span><span id="DisulfideClassManager-161"><a href="#DisulfideClassManager-161"><span class="linenos">161</span></a><span class="sd">        This list is a list of disulfide identifiers, not the Disulfide objects themselves.</span>
</span><span id="DisulfideClassManager-162"><a href="#DisulfideClassManager-162"><span class="linenos">162</span></a>
</span><span id="DisulfideClassManager-163"><a href="#DisulfideClassManager-163"><span class="linenos">163</span></a><span class="sd">        :param clsid: The class name to extract. Must be a string</span>
</span><span id="DisulfideClassManager-164"><a href="#DisulfideClassManager-164"><span class="linenos">164</span></a><span class="sd">        in the format &#39;11111&#39; or &#39;11111b&#39; or &#39;11111o&#39;. The suffix &#39;b&#39; or &#39;o&#39; indicates</span>
</span><span id="DisulfideClassManager-165"><a href="#DisulfideClassManager-165"><span class="linenos">165</span></a><span class="sd">        binary or octant classes, respectively.</span>
</span><span id="DisulfideClassManager-166"><a href="#DisulfideClassManager-166"><span class="linenos">166</span></a><span class="sd">        :type clsid: str</span>
</span><span id="DisulfideClassManager-167"><a href="#DisulfideClassManager-167"><span class="linenos">167</span></a><span class="sd">        :param base: The base class to use, 2 or 8. Default is 8.</span>
</span><span id="DisulfideClassManager-168"><a href="#DisulfideClassManager-168"><span class="linenos">168</span></a><span class="sd">        :type base: int</span>
</span><span id="DisulfideClassManager-169"><a href="#DisulfideClassManager-169"><span class="linenos">169</span></a><span class="sd">        :param verbose: If True, display progress bars, by default False.</span>
</span><span id="DisulfideClassManager-170"><a href="#DisulfideClassManager-170"><span class="linenos">170</span></a><span class="sd">        :type verbose: bool</span>
</span><span id="DisulfideClassManager-171"><a href="#DisulfideClassManager-171"><span class="linenos">171</span></a><span class="sd">        :return: The list of disulfide bonds from the class. NB: this is the list</span>
</span><span id="DisulfideClassManager-172"><a href="#DisulfideClassManager-172"><span class="linenos">172</span></a><span class="sd">        of disulfide identifiers, not the Disulfide objects themselves.</span>
</span><span id="DisulfideClassManager-173"><a href="#DisulfideClassManager-173"><span class="linenos">173</span></a><span class="sd">        :rtype: DisulfideList</span>
</span><span id="DisulfideClassManager-174"><a href="#DisulfideClassManager-174"><span class="linenos">174</span></a><span class="sd">        :raises ValueError: If an invalid base value is provided.</span>
</span><span id="DisulfideClassManager-175"><a href="#DisulfideClassManager-175"><span class="linenos">175</span></a><span class="sd">        :raises KeyError: If the clsid is not found in the dictionary.</span>
</span><span id="DisulfideClassManager-176"><a href="#DisulfideClassManager-176"><span class="linenos">176</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-177"><a href="#DisulfideClassManager-177"><span class="linenos">177</span></a>        <span class="bp">cls</span> <span class="o">=</span> <span class="n">clsid</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</span><span id="DisulfideClassManager-178"><a href="#DisulfideClassManager-178"><span class="linenos">178</span></a>
</span><span id="DisulfideClassManager-179"><a href="#DisulfideClassManager-179"><span class="linenos">179</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">clsid</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="DisulfideClassManager-180"><a href="#DisulfideClassManager-180"><span class="linenos">180</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid class ID: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">clsid</span><span class="p">)</span>
</span><span id="DisulfideClassManager-181"><a href="#DisulfideClassManager-181"><span class="linenos">181</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="DisulfideClassManager-182"><a href="#DisulfideClassManager-182"><span class="linenos">182</span></a>
</span><span id="DisulfideClassManager-183"><a href="#DisulfideClassManager-183"><span class="linenos">183</span></a>        <span class="k">match</span> <span class="nb">len</span><span class="p">(</span><span class="n">clsid</span><span class="p">):</span>
</span><span id="DisulfideClassManager-184"><a href="#DisulfideClassManager-184"><span class="linenos">184</span></a>            <span class="k">case</span> <span class="mi">6</span><span class="p">:</span>
</span><span id="DisulfideClassManager-185"><a href="#DisulfideClassManager-185"><span class="linenos">185</span></a>                <span class="k">match</span> <span class="n">clsid</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="DisulfideClassManager-186"><a href="#DisulfideClassManager-186"><span class="linenos">186</span></a>                    <span class="k">case</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
</span><span id="DisulfideClassManager-187"><a href="#DisulfideClassManager-187"><span class="linenos">187</span></a>                        <span class="n">eightorbin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_dict</span>
</span><span id="DisulfideClassManager-188"><a href="#DisulfideClassManager-188"><span class="linenos">188</span></a>                    <span class="k">case</span> <span class="s2">&quot;o&quot;</span><span class="p">:</span>
</span><span id="DisulfideClassManager-189"><a href="#DisulfideClassManager-189"><span class="linenos">189</span></a>                        <span class="n">eightorbin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_dict</span>
</span><span id="DisulfideClassManager-190"><a href="#DisulfideClassManager-190"><span class="linenos">190</span></a>                    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="DisulfideClassManager-191"><a href="#DisulfideClassManager-191"><span class="linenos">191</span></a>                        <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid class ID suffix: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">clsid</span><span class="p">)</span>
</span><span id="DisulfideClassManager-192"><a href="#DisulfideClassManager-192"><span class="linenos">192</span></a>                        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="DisulfideClassManager-193"><a href="#DisulfideClassManager-193"><span class="linenos">193</span></a>
</span><span id="DisulfideClassManager-194"><a href="#DisulfideClassManager-194"><span class="linenos">194</span></a>            <span class="k">case</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="DisulfideClassManager-195"><a href="#DisulfideClassManager-195"><span class="linenos">195</span></a>                <span class="k">match</span> <span class="n">base</span><span class="p">:</span>
</span><span id="DisulfideClassManager-196"><a href="#DisulfideClassManager-196"><span class="linenos">196</span></a>                    <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="DisulfideClassManager-197"><a href="#DisulfideClassManager-197"><span class="linenos">197</span></a>                        <span class="n">eightorbin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_dict</span>
</span><span id="DisulfideClassManager-198"><a href="#DisulfideClassManager-198"><span class="linenos">198</span></a>                    <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="DisulfideClassManager-199"><a href="#DisulfideClassManager-199"><span class="linenos">199</span></a>                        <span class="n">eightorbin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_dict</span>
</span><span id="DisulfideClassManager-200"><a href="#DisulfideClassManager-200"><span class="linenos">200</span></a>                    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="DisulfideClassManager-201"><a href="#DisulfideClassManager-201"><span class="linenos">201</span></a>                        <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid base: </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideClassManager-202"><a href="#DisulfideClassManager-202"><span class="linenos">202</span></a>                        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="DisulfideClassManager-203"><a href="#DisulfideClassManager-203"><span class="linenos">203</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="DisulfideClassManager-204"><a href="#DisulfideClassManager-204"><span class="linenos">204</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid class ID length: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">clsid</span><span class="p">)</span>
</span><span id="DisulfideClassManager-205"><a href="#DisulfideClassManager-205"><span class="linenos">205</span></a>                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="DisulfideClassManager-206"><a href="#DisulfideClassManager-206"><span class="linenos">206</span></a>
</span><span id="DisulfideClassManager-207"><a href="#DisulfideClassManager-207"><span class="linenos">207</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DisulfideClassManager-208"><a href="#DisulfideClassManager-208"><span class="linenos">208</span></a>            <span class="n">ss_ids</span> <span class="o">=</span> <span class="n">eightorbin</span><span class="p">[</span><span class="bp">cls</span><span class="p">]</span>
</span><span id="DisulfideClassManager-209"><a href="#DisulfideClassManager-209"><span class="linenos">209</span></a>
</span><span id="DisulfideClassManager-210"><a href="#DisulfideClassManager-210"><span class="linenos">210</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="DisulfideClassManager-211"><a href="#DisulfideClassManager-211"><span class="linenos">211</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Cannot find key </span><span class="si">%s</span><span class="s2"> in SSBond DB&quot;</span><span class="p">,</span> <span class="n">clsid</span><span class="p">)</span>
</span><span id="DisulfideClassManager-212"><a href="#DisulfideClassManager-212"><span class="linenos">212</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="DisulfideClassManager-213"><a href="#DisulfideClassManager-213"><span class="linenos">213</span></a>
</span><span id="DisulfideClassManager-214"><a href="#DisulfideClassManager-214"><span class="linenos">214</span></a>        <span class="k">return</span> <span class="n">ss_ids</span>
</span><span id="DisulfideClassManager-215"><a href="#DisulfideClassManager-215"><span class="linenos">215</span></a>
</span><span id="DisulfideClassManager-216"><a href="#DisulfideClassManager-216"><span class="linenos">216</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="DisulfideClassManager-217"><a href="#DisulfideClassManager-217"><span class="linenos">217</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-218"><a href="#DisulfideClassManager-218"><span class="linenos">218</span></a><span class="sd">        List the Disulfide structural classes.</span>
</span><span id="DisulfideClassManager-219"><a href="#DisulfideClassManager-219"><span class="linenos">219</span></a>
</span><span id="DisulfideClassManager-220"><a href="#DisulfideClassManager-220"><span class="linenos">220</span></a><span class="sd">        :param self: The instance of the DisulfideClassManager class.</span>
</span><span id="DisulfideClassManager-221"><a href="#DisulfideClassManager-221"><span class="linenos">221</span></a><span class="sd">        :type self: DisulfideClassManager</span>
</span><span id="DisulfideClassManager-222"><a href="#DisulfideClassManager-222"><span class="linenos">222</span></a><span class="sd">        :param base: The base class to use, 2 or 8.</span>
</span><span id="DisulfideClassManager-223"><a href="#DisulfideClassManager-223"><span class="linenos">223</span></a><span class="sd">        :type base: int</span>
</span><span id="DisulfideClassManager-224"><a href="#DisulfideClassManager-224"><span class="linenos">224</span></a><span class="sd">        :return: None</span>
</span><span id="DisulfideClassManager-225"><a href="#DisulfideClassManager-225"><span class="linenos">225</span></a><span class="sd">        :rtype: None</span>
</span><span id="DisulfideClassManager-226"><a href="#DisulfideClassManager-226"><span class="linenos">226</span></a><span class="sd">        :raises ValueError: If an invalid base value is provided.</span>
</span><span id="DisulfideClassManager-227"><a href="#DisulfideClassManager-227"><span class="linenos">227</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-228"><a href="#DisulfideClassManager-228"><span class="linenos">228</span></a>        <span class="k">match</span> <span class="n">base</span><span class="p">:</span>
</span><span id="DisulfideClassManager-229"><a href="#DisulfideClassManager-229"><span class="linenos">229</span></a>            <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="DisulfideClassManager-230"><a href="#DisulfideClassManager-230"><span class="linenos">230</span></a>                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_dict</span><span class="p">):</span>
</span><span id="DisulfideClassManager-231"><a href="#DisulfideClassManager-231"><span class="linenos">231</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class: |</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">|, |</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">|&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-232"><a href="#DisulfideClassManager-232"><span class="linenos">232</span></a>            <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="DisulfideClassManager-233"><a href="#DisulfideClassManager-233"><span class="linenos">233</span></a>                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eightclass_dict</span><span class="p">):</span>
</span><span id="DisulfideClassManager-234"><a href="#DisulfideClassManager-234"><span class="linenos">234</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class: |</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">|, |</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">|&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-235"><a href="#DisulfideClassManager-235"><span class="linenos">235</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="DisulfideClassManager-236"><a href="#DisulfideClassManager-236"><span class="linenos">236</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be 2 or 8.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-237"><a href="#DisulfideClassManager-237"><span class="linenos">237</span></a>
</span><span id="DisulfideClassManager-238"><a href="#DisulfideClassManager-238"><span class="linenos">238</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">concat_dataframes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">):</span>
</span><span id="DisulfideClassManager-239"><a href="#DisulfideClassManager-239"><span class="linenos">239</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-240"><a href="#DisulfideClassManager-240"><span class="linenos">240</span></a><span class="sd">        Concatenates columns from one data frame into the other</span>
</span><span id="DisulfideClassManager-241"><a href="#DisulfideClassManager-241"><span class="linenos">241</span></a><span class="sd">        and returns the new result.</span>
</span><span id="DisulfideClassManager-242"><a href="#DisulfideClassManager-242"><span class="linenos">242</span></a>
</span><span id="DisulfideClassManager-243"><a href="#DisulfideClassManager-243"><span class="linenos">243</span></a><span class="sd">        Parameters</span>
</span><span id="DisulfideClassManager-244"><a href="#DisulfideClassManager-244"><span class="linenos">244</span></a><span class="sd">        ----------</span>
</span><span id="DisulfideClassManager-245"><a href="#DisulfideClassManager-245"><span class="linenos">245</span></a><span class="sd">        df1 : pandas.DataFrame</span>
</span><span id="DisulfideClassManager-246"><a href="#DisulfideClassManager-246"><span class="linenos">246</span></a><span class="sd">            The first data frame.</span>
</span><span id="DisulfideClassManager-247"><a href="#DisulfideClassManager-247"><span class="linenos">247</span></a><span class="sd">        df2 : pandas.DataFrame</span>
</span><span id="DisulfideClassManager-248"><a href="#DisulfideClassManager-248"><span class="linenos">248</span></a><span class="sd">            The second data frame.</span>
</span><span id="DisulfideClassManager-249"><a href="#DisulfideClassManager-249"><span class="linenos">249</span></a>
</span><span id="DisulfideClassManager-250"><a href="#DisulfideClassManager-250"><span class="linenos">250</span></a><span class="sd">        Returns</span>
</span><span id="DisulfideClassManager-251"><a href="#DisulfideClassManager-251"><span class="linenos">251</span></a><span class="sd">        -------</span>
</span><span id="DisulfideClassManager-252"><a href="#DisulfideClassManager-252"><span class="linenos">252</span></a><span class="sd">        pandas.DataFrame</span>
</span><span id="DisulfideClassManager-253"><a href="#DisulfideClassManager-253"><span class="linenos">253</span></a><span class="sd">            The concatenated data frame.</span>
</span><span id="DisulfideClassManager-254"><a href="#DisulfideClassManager-254"><span class="linenos">254</span></a>
</span><span id="DisulfideClassManager-255"><a href="#DisulfideClassManager-255"><span class="linenos">255</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-256"><a href="#DisulfideClassManager-256"><span class="linenos">256</span></a>        <span class="c1"># Merge the data frames based on the &#39;SS_Classname&#39; column</span>
</span><span id="DisulfideClassManager-257"><a href="#DisulfideClassManager-257"><span class="linenos">257</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;class_id&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-258"><a href="#DisulfideClassManager-258"><span class="linenos">258</span></a>
</span><span id="DisulfideClassManager-259"><a href="#DisulfideClassManager-259"><span class="linenos">259</span></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="DisulfideClassManager-260"><a href="#DisulfideClassManager-260"><span class="linenos">260</span></a>
</span><span id="DisulfideClassManager-261"><a href="#DisulfideClassManager-261"><span class="linenos">261</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">binary_to_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="DisulfideClassManager-262"><a href="#DisulfideClassManager-262"><span class="linenos">262</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-263"><a href="#DisulfideClassManager-263"><span class="linenos">263</span></a><span class="sd">        Convert a binary input string to a list of possible class strings based on the specified base.</span>
</span><span id="DisulfideClassManager-264"><a href="#DisulfideClassManager-264"><span class="linenos">264</span></a>
</span><span id="DisulfideClassManager-265"><a href="#DisulfideClassManager-265"><span class="linenos">265</span></a><span class="sd">        Returns a list of all possible combinations of ordinal sections of a unit circle</span>
</span><span id="DisulfideClassManager-266"><a href="#DisulfideClassManager-266"><span class="linenos">266</span></a><span class="sd">        divided into the specified number of equal segments, originating at 0 degrees, rotating counterclockwise,</span>
</span><span id="DisulfideClassManager-267"><a href="#DisulfideClassManager-267"><span class="linenos">267</span></a><span class="sd">        based on the sign of each angle in the input string.</span>
</span><span id="DisulfideClassManager-268"><a href="#DisulfideClassManager-268"><span class="linenos">268</span></a>
</span><span id="DisulfideClassManager-269"><a href="#DisulfideClassManager-269"><span class="linenos">269</span></a><span class="sd">        :param class_str: A string of length 5, where each character represents the sign</span>
</span><span id="DisulfideClassManager-270"><a href="#DisulfideClassManager-270"><span class="linenos">270</span></a><span class="sd">        of an angle in the range of -180-180 degrees.</span>
</span><span id="DisulfideClassManager-271"><a href="#DisulfideClassManager-271"><span class="linenos">271</span></a><span class="sd">        :type class_str: str</span>
</span><span id="DisulfideClassManager-272"><a href="#DisulfideClassManager-272"><span class="linenos">272</span></a><span class="sd">        :param base: The base class to use, 6 or 8.</span>
</span><span id="DisulfideClassManager-273"><a href="#DisulfideClassManager-273"><span class="linenos">273</span></a><span class="sd">        :type base: int</span>
</span><span id="DisulfideClassManager-274"><a href="#DisulfideClassManager-274"><span class="linenos">274</span></a><span class="sd">        :return: A list of strings of length 5, representing all possible class strings.</span>
</span><span id="DisulfideClassManager-275"><a href="#DisulfideClassManager-275"><span class="linenos">275</span></a><span class="sd">        :rtype: list</span>
</span><span id="DisulfideClassManager-276"><a href="#DisulfideClassManager-276"><span class="linenos">276</span></a><span class="sd">        :raises ValueError: If an invalid base value is provided.</span>
</span><span id="DisulfideClassManager-277"><a href="#DisulfideClassManager-277"><span class="linenos">277</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-278"><a href="#DisulfideClassManager-278"><span class="linenos">278</span></a>        <span class="k">match</span> <span class="n">base</span><span class="p">:</span>
</span><span id="DisulfideClassManager-279"><a href="#DisulfideClassManager-279"><span class="linenos">279</span></a>            <span class="k">case</span> <span class="mi">6</span><span class="p">:</span>
</span><span id="DisulfideClassManager-280"><a href="#DisulfideClassManager-280"><span class="linenos">280</span></a>                <span class="n">angle_maps</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;0&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">],</span> <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">]}</span>
</span><span id="DisulfideClassManager-281"><a href="#DisulfideClassManager-281"><span class="linenos">281</span></a>            <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="DisulfideClassManager-282"><a href="#DisulfideClassManager-282"><span class="linenos">282</span></a>                <span class="n">angle_maps</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;0&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">],</span> <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">]}</span>
</span><span id="DisulfideClassManager-283"><a href="#DisulfideClassManager-283"><span class="linenos">283</span></a>            <span class="k">case</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="DisulfideClassManager-284"><a href="#DisulfideClassManager-284"><span class="linenos">284</span></a>                <span class="n">angle_maps</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DisulfideClassManager-285"><a href="#DisulfideClassManager-285"><span class="linenos">285</span></a>                    <span class="s2">&quot;0&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="s2">&quot;9&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">],</span>
</span><span id="DisulfideClassManager-286"><a href="#DisulfideClassManager-286"><span class="linenos">286</span></a>                    <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">],</span>
</span><span id="DisulfideClassManager-287"><a href="#DisulfideClassManager-287"><span class="linenos">287</span></a>                <span class="p">}</span>
</span><span id="DisulfideClassManager-288"><a href="#DisulfideClassManager-288"><span class="linenos">288</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="DisulfideClassManager-289"><a href="#DisulfideClassManager-289"><span class="linenos">289</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base value. Must be 6, 8, or 10.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-290"><a href="#DisulfideClassManager-290"><span class="linenos">290</span></a>
</span><span id="DisulfideClassManager-291"><a href="#DisulfideClassManager-291"><span class="linenos">291</span></a>        <span class="n">class_lists</span> <span class="o">=</span> <span class="p">[</span><span class="n">angle_maps</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">class_str</span><span class="p">]</span>
</span><span id="DisulfideClassManager-292"><a href="#DisulfideClassManager-292"><span class="linenos">292</span></a>        <span class="n">class_combinations</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">class_lists</span><span class="p">)</span>
</span><span id="DisulfideClassManager-293"><a href="#DisulfideClassManager-293"><span class="linenos">293</span></a>        <span class="n">class_strings</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">combination</span><span class="p">)</span> <span class="k">for</span> <span class="n">combination</span> <span class="ow">in</span> <span class="n">class_combinations</span><span class="p">]</span>
</span><span id="DisulfideClassManager-294"><a href="#DisulfideClassManager-294"><span class="linenos">294</span></a>        <span class="k">return</span> <span class="n">class_strings</span>
</span><span id="DisulfideClassManager-295"><a href="#DisulfideClassManager-295"><span class="linenos">295</span></a>
</span><span id="DisulfideClassManager-296"><a href="#DisulfideClassManager-296"><span class="linenos">296</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loader</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassManager-297"><a href="#DisulfideClassManager-297"><span class="linenos">297</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-298"><a href="#DisulfideClassManager-298"><span class="linenos">298</span></a><span class="sd">        Build the internal structures needed for the binary and octant disulfide structural classes</span>
</span><span id="DisulfideClassManager-299"><a href="#DisulfideClassManager-299"><span class="linenos">299</span></a><span class="sd">        based on dihedral angle rules.</span>
</span><span id="DisulfideClassManager-300"><a href="#DisulfideClassManager-300"><span class="linenos">300</span></a>
</span><span id="DisulfideClassManager-301"><a href="#DisulfideClassManager-301"><span class="linenos">301</span></a><span class="sd">        :param loader: The DisulfideLoader object containing the data.</span>
</span><span id="DisulfideClassManager-302"><a href="#DisulfideClassManager-302"><span class="linenos">302</span></a><span class="sd">        :type loader: DisulfideLoader</span>
</span><span id="DisulfideClassManager-303"><a href="#DisulfideClassManager-303"><span class="linenos">303</span></a><span class="sd">        :return: None</span>
</span><span id="DisulfideClassManager-304"><a href="#DisulfideClassManager-304"><span class="linenos">304</span></a><span class="sd">        :rtype: None</span>
</span><span id="DisulfideClassManager-305"><a href="#DisulfideClassManager-305"><span class="linenos">305</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-306"><a href="#DisulfideClassManager-306"><span class="linenos">306</span></a>
</span><span id="DisulfideClassManager-307"><a href="#DisulfideClassManager-307"><span class="linenos">307</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">proteusPy</span><span class="w"> </span><span class="kn">import</span> <span class="n">__version__</span>
</span><span id="DisulfideClassManager-308"><a href="#DisulfideClassManager-308"><span class="linenos">308</span></a>
</span><span id="DisulfideClassManager-309"><a href="#DisulfideClassManager-309"><span class="linenos">309</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">__version__</span>
</span><span id="DisulfideClassManager-310"><a href="#DisulfideClassManager-310"><span class="linenos">310</span></a>
</span><span id="DisulfideClassManager-311"><a href="#DisulfideClassManager-311"><span class="linenos">311</span></a>        <span class="n">tors_df</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">getTorsions</span><span class="p">()</span>
</span><span id="DisulfideClassManager-312"><a href="#DisulfideClassManager-312"><span class="linenos">312</span></a>
</span><span id="DisulfideClassManager-313"><a href="#DisulfideClassManager-313"><span class="linenos">313</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClassManager-314"><a href="#DisulfideClassManager-314"><span class="linenos">314</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating binary SS classes...&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-315"><a href="#DisulfideClassManager-315"><span class="linenos">315</span></a>
</span><span id="DisulfideClassManager-316"><a href="#DisulfideClassManager-316"><span class="linenos">316</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_binary_classes</span><span class="p">(</span><span class="n">tors_df</span><span class="p">)</span>
</span><span id="DisulfideClassManager-317"><a href="#DisulfideClassManager-317"><span class="linenos">317</span></a>
</span><span id="DisulfideClassManager-318"><a href="#DisulfideClassManager-318"><span class="linenos">318</span></a>        <span class="n">class_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
</span><span id="DisulfideClassManager-319"><a href="#DisulfideClassManager-319"><span class="linenos">319</span></a>            <span class="n">StringIO</span><span class="p">(</span><span class="n">SS_CLASS_DEFINITIONS</span><span class="p">),</span>
</span><span id="DisulfideClassManager-320"><a href="#DisulfideClassManager-320"><span class="linenos">320</span></a>            <span class="n">dtype</span><span class="o">=</span><span class="p">{</span>
</span><span id="DisulfideClassManager-321"><a href="#DisulfideClassManager-321"><span class="linenos">321</span></a>                <span class="s2">&quot;class_id&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassManager-322"><a href="#DisulfideClassManager-322"><span class="linenos">322</span></a>                <span class="s2">&quot;FXN&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassManager-323"><a href="#DisulfideClassManager-323"><span class="linenos">323</span></a>                <span class="s2">&quot;SS_Classname&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassManager-324"><a href="#DisulfideClassManager-324"><span class="linenos">324</span></a>            <span class="p">},</span>
</span><span id="DisulfideClassManager-325"><a href="#DisulfideClassManager-325"><span class="linenos">325</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassManager-326"><a href="#DisulfideClassManager-326"><span class="linenos">326</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s2">&quot;FXN&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="DisulfideClassManager-327"><a href="#DisulfideClassManager-327"><span class="linenos">327</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s2">&quot;SS_Classname&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="DisulfideClassManager-328"><a href="#DisulfideClassManager-328"><span class="linenos">328</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="DisulfideClassManager-329"><a href="#DisulfideClassManager-329"><span class="linenos">329</span></a>
</span><span id="DisulfideClassManager-330"><a href="#DisulfideClassManager-330"><span class="linenos">330</span></a>        <span class="n">merged</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">concat_dataframes</span><span class="p">(</span><span class="n">class_df</span><span class="p">,</span> <span class="n">grouped</span><span class="p">)</span>
</span><span id="DisulfideClassManager-331"><a href="#DisulfideClassManager-331"><span class="linenos">331</span></a>        <span class="n">merged</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
</span><span id="DisulfideClassManager-332"><a href="#DisulfideClassManager-332"><span class="linenos">332</span></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Idx&quot;</span><span class="p">,</span> <span class="s2">&quot;chi1_s&quot;</span><span class="p">,</span> <span class="s2">&quot;chi2_s&quot;</span><span class="p">,</span> <span class="s2">&quot;chi3_s&quot;</span><span class="p">,</span> <span class="s2">&quot;chi4_s&quot;</span><span class="p">,</span> <span class="s2">&quot;chi5_s&quot;</span><span class="p">],</span>
</span><span id="DisulfideClassManager-333"><a href="#DisulfideClassManager-333"><span class="linenos">333</span></a>            <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DisulfideClassManager-334"><a href="#DisulfideClassManager-334"><span class="linenos">334</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassManager-335"><a href="#DisulfideClassManager-335"><span class="linenos">335</span></a>
</span><span id="DisulfideClassManager-336"><a href="#DisulfideClassManager-336"><span class="linenos">336</span></a>        <span class="n">classdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">merged</span><span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">],</span> <span class="n">merged</span><span class="p">[</span><span class="s2">&quot;ss_id&quot;</span><span class="p">]))</span>
</span><span id="DisulfideClassManager-337"><a href="#DisulfideClassManager-337"><span class="linenos">337</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_dict</span> <span class="o">=</span> <span class="n">classdict</span>
</span><span id="DisulfideClassManager-338"><a href="#DisulfideClassManager-338"><span class="linenos">338</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_df</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DisulfideClassManager-339"><a href="#DisulfideClassManager-339"><span class="linenos">339</span></a>
</span><span id="DisulfideClassManager-340"><a href="#DisulfideClassManager-340"><span class="linenos">340</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClassManager-341"><a href="#DisulfideClassManager-341"><span class="linenos">341</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating eightfold SS classes...&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-342"><a href="#DisulfideClassManager-342"><span class="linenos">342</span></a>
</span><span id="DisulfideClassManager-343"><a href="#DisulfideClassManager-343"><span class="linenos">343</span></a>        <span class="n">grouped_eightclass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_classes</span><span class="p">(</span><span class="n">tors_df</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</span><span id="DisulfideClassManager-344"><a href="#DisulfideClassManager-344"><span class="linenos">344</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_df</span> <span class="o">=</span> <span class="n">grouped_eightclass</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DisulfideClassManager-345"><a href="#DisulfideClassManager-345"><span class="linenos">345</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="DisulfideClassManager-346"><a href="#DisulfideClassManager-346"><span class="linenos">346</span></a>            <span class="nb">zip</span><span class="p">(</span><span class="n">grouped_eightclass</span><span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">],</span> <span class="n">grouped_eightclass</span><span class="p">[</span><span class="s2">&quot;ss_id&quot;</span><span class="p">])</span>
</span><span id="DisulfideClassManager-347"><a href="#DisulfideClassManager-347"><span class="linenos">347</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassManager-348"><a href="#DisulfideClassManager-348"><span class="linenos">348</span></a>
</span><span id="DisulfideClassManager-349"><a href="#DisulfideClassManager-349"><span class="linenos">349</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClassManager-350"><a href="#DisulfideClassManager-350"><span class="linenos">350</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Initialization complete.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-351"><a href="#DisulfideClassManager-351"><span class="linenos">351</span></a>
</span><span id="DisulfideClassManager-352"><a href="#DisulfideClassManager-352"><span class="linenos">352</span></a>        <span class="k">return</span>
</span><span id="DisulfideClassManager-353"><a href="#DisulfideClassManager-353"><span class="linenos">353</span></a>
</span><span id="DisulfideClassManager-354"><a href="#DisulfideClassManager-354"><span class="linenos">354</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_binary_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="DisulfideClassManager-355"><a href="#DisulfideClassManager-355"><span class="linenos">355</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-356"><a href="#DisulfideClassManager-356"><span class="linenos">356</span></a><span class="sd">        Group the DataFrame by the sign of the chi columns and create a new class ID column for each unique grouping.</span>
</span><span id="DisulfideClassManager-357"><a href="#DisulfideClassManager-357"><span class="linenos">357</span></a>
</span><span id="DisulfideClassManager-358"><a href="#DisulfideClassManager-358"><span class="linenos">358</span></a><span class="sd">        :param df: A pandas DataFrame containing columns &#39;ss_id&#39;, &#39;chi1&#39;, &#39;chi2&#39;, &#39;chi3&#39;, &#39;chi4&#39;, &#39;chi5&#39;, &#39;ca_distance&#39;,</span>
</span><span id="DisulfideClassManager-359"><a href="#DisulfideClassManager-359"><span class="linenos">359</span></a><span class="sd">        &#39;cb_distance&#39;, &#39;torsion_length&#39;, and &#39;energy&#39;.</span>
</span><span id="DisulfideClassManager-360"><a href="#DisulfideClassManager-360"><span class="linenos">360</span></a><span class="sd">        :return: A pandas DataFrame containing columns &#39;class_id&#39;, &#39;ss_id&#39;, and &#39;count&#39;, where &#39;class_id&#39;</span>
</span><span id="DisulfideClassManager-361"><a href="#DisulfideClassManager-361"><span class="linenos">361</span></a><span class="sd">         is a unique identifier for each grouping of chi signs, &#39;ss_id&#39; is a list of all &#39;ss_id&#39; values in that</span>
</span><span id="DisulfideClassManager-362"><a href="#DisulfideClassManager-362"><span class="linenos">362</span></a><span class="sd">         grouping, and &#39;count&#39; is the number of rows in that grouping.</span>
</span><span id="DisulfideClassManager-363"><a href="#DisulfideClassManager-363"><span class="linenos">363</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-364"><a href="#DisulfideClassManager-364"><span class="linenos">364</span></a>        <span class="c1"># Create new columns with the sign of each chi column</span>
</span><span id="DisulfideClassManager-365"><a href="#DisulfideClassManager-365"><span class="linenos">365</span></a>        <span class="n">chi_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;chi1&quot;</span><span class="p">,</span> <span class="s2">&quot;chi2&quot;</span><span class="p">,</span> <span class="s2">&quot;chi3&quot;</span><span class="p">,</span> <span class="s2">&quot;chi4&quot;</span><span class="p">,</span> <span class="s2">&quot;chi5&quot;</span><span class="p">]</span>
</span><span id="DisulfideClassManager-366"><a href="#DisulfideClassManager-366"><span class="linenos">366</span></a>        <span class="n">sign_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="o">+</span> <span class="s2">&quot;_s&quot;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">chi_columns</span><span class="p">]</span>
</span><span id="DisulfideClassManager-367"><a href="#DisulfideClassManager-367"><span class="linenos">367</span></a>        <span class="n">df</span><span class="p">[</span><span class="n">sign_columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">chi_columns</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DisulfideClassManager-368"><a href="#DisulfideClassManager-368"><span class="linenos">368</span></a>
</span><span id="DisulfideClassManager-369"><a href="#DisulfideClassManager-369"><span class="linenos">369</span></a>        <span class="c1"># Create a new column with the class ID for each row</span>
</span><span id="DisulfideClassManager-370"><a href="#DisulfideClassManager-370"><span class="linenos">370</span></a>        <span class="n">class_id_column</span> <span class="o">=</span> <span class="s2">&quot;class_id&quot;</span>
</span><span id="DisulfideClassManager-371"><a href="#DisulfideClassManager-371"><span class="linenos">371</span></a>        <span class="n">df</span><span class="p">[</span><span class="n">class_id_column</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">sign_columns</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="DisulfideClassManager-372"><a href="#DisulfideClassManager-372"><span class="linenos">372</span></a>            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
</span><span id="DisulfideClassManager-373"><a href="#DisulfideClassManager-373"><span class="linenos">373</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassManager-374"><a href="#DisulfideClassManager-374"><span class="linenos">374</span></a>
</span><span id="DisulfideClassManager-375"><a href="#DisulfideClassManager-375"><span class="linenos">375</span></a>        <span class="c1"># Group the DataFrame by the class ID and return the grouped data</span>
</span><span id="DisulfideClassManager-376"><a href="#DisulfideClassManager-376"><span class="linenos">376</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">class_id_column</span><span class="p">)[</span><span class="s2">&quot;ss_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="DisulfideClassManager-377"><a href="#DisulfideClassManager-377"><span class="linenos">377</span></a>        <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;ss_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
</span><span id="DisulfideClassManager-378"><a href="#DisulfideClassManager-378"><span class="linenos">378</span></a>        <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;incidence&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="DisulfideClassManager-379"><a href="#DisulfideClassManager-379"><span class="linenos">379</span></a>        <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;percentage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;incidence&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="DisulfideClassManager-380"><a href="#DisulfideClassManager-380"><span class="linenos">380</span></a>
</span><span id="DisulfideClassManager-381"><a href="#DisulfideClassManager-381"><span class="linenos">381</span></a>        <span class="k">return</span> <span class="n">grouped</span>
</span><span id="DisulfideClassManager-382"><a href="#DisulfideClassManager-382"><span class="linenos">382</span></a>
</span><span id="DisulfideClassManager-383"><a href="#DisulfideClassManager-383"><span class="linenos">383</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="DisulfideClassManager-384"><a href="#DisulfideClassManager-384"><span class="linenos">384</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-385"><a href="#DisulfideClassManager-385"><span class="linenos">385</span></a><span class="sd">        Create a new DataFrame with 8-class encoding for input &#39;chi&#39; values.</span>
</span><span id="DisulfideClassManager-386"><a href="#DisulfideClassManager-386"><span class="linenos">386</span></a>
</span><span id="DisulfideClassManager-387"><a href="#DisulfideClassManager-387"><span class="linenos">387</span></a><span class="sd">        The function takes a pandas DataFrame containing the following columns:</span>
</span><span id="DisulfideClassManager-388"><a href="#DisulfideClassManager-388"><span class="linenos">388</span></a><span class="sd">        &#39;ss_id&#39;, &#39;chi1&#39;, &#39;chi2&#39;, &#39;chi3&#39;, &#39;chi4&#39;, &#39;chi5&#39;, &#39;ca_distance&#39;, &#39;cb_distance&#39;,</span>
</span><span id="DisulfideClassManager-389"><a href="#DisulfideClassManager-389"><span class="linenos">389</span></a><span class="sd">        &#39;torsion_length&#39;, &#39;energy&#39;, and &#39;rho&#39;, and adds a class ID column based on the following rules:</span>
</span><span id="DisulfideClassManager-390"><a href="#DisulfideClassManager-390"><span class="linenos">390</span></a>
</span><span id="DisulfideClassManager-391"><a href="#DisulfideClassManager-391"><span class="linenos">391</span></a><span class="sd">        1. A new column named `class_id` is added, which is the concatenation of the individual class IDs per Chi.</span>
</span><span id="DisulfideClassManager-392"><a href="#DisulfideClassManager-392"><span class="linenos">392</span></a><span class="sd">        2. The DataFrame is grouped by the `class_id` column, and a new DataFrame is returned that shows the unique `ss_id` values for each group,</span>
</span><span id="DisulfideClassManager-393"><a href="#DisulfideClassManager-393"><span class="linenos">393</span></a><span class="sd">        the count of unique `ss_id` values, the incidence of each group as a proportion of the total DataFrame, and</span>
</span><span id="DisulfideClassManager-394"><a href="#DisulfideClassManager-394"><span class="linenos">394</span></a><span class="sd">        the percentage of incidence.</span>
</span><span id="DisulfideClassManager-395"><a href="#DisulfideClassManager-395"><span class="linenos">395</span></a>
</span><span id="DisulfideClassManager-396"><a href="#DisulfideClassManager-396"><span class="linenos">396</span></a><span class="sd">        :param df: A pandas DataFrame containing columns &#39;ss_id&#39;, &#39;chi1&#39;, &#39;chi2&#39;, &#39;chi3&#39;, &#39;chi4&#39;, &#39;chi5&#39;,</span>
</span><span id="DisulfideClassManager-397"><a href="#DisulfideClassManager-397"><span class="linenos">397</span></a><span class="sd">                &#39;ca_distance&#39;, &#39;cb_distance&#39;, &#39;torsion_length&#39;, &#39;energy&#39;, and &#39;rho&#39;</span>
</span><span id="DisulfideClassManager-398"><a href="#DisulfideClassManager-398"><span class="linenos">398</span></a><span class="sd">        :return: The grouped DataFrame with the added class column.</span>
</span><span id="DisulfideClassManager-399"><a href="#DisulfideClassManager-399"><span class="linenos">399</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-400"><a href="#DisulfideClassManager-400"><span class="linenos">400</span></a>
</span><span id="DisulfideClassManager-401"><a href="#DisulfideClassManager-401"><span class="linenos">401</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">]:</span>
</span><span id="DisulfideClassManager-402"><a href="#DisulfideClassManager-402"><span class="linenos">402</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Base must be either 2, 4, 6, 8, or 10&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-403"><a href="#DisulfideClassManager-403"><span class="linenos">403</span></a>
</span><span id="DisulfideClassManager-404"><a href="#DisulfideClassManager-404"><span class="linenos">404</span></a>        <span class="c1"># Apply get_class_string function to each chi column based on the specified base</span>
</span><span id="DisulfideClassManager-405"><a href="#DisulfideClassManager-405"><span class="linenos">405</span></a>        <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;chi1&quot;</span><span class="p">,</span> <span class="s2">&quot;chi2&quot;</span><span class="p">,</span> <span class="s2">&quot;chi3&quot;</span><span class="p">,</span> <span class="s2">&quot;chi4&quot;</span><span class="p">,</span> <span class="s2">&quot;chi5&quot;</span><span class="p">]:</span>
</span><span id="DisulfideClassManager-406"><a href="#DisulfideClassManager-406"><span class="linenos">406</span></a>            <span class="n">df</span><span class="p">[</span><span class="n">col_name</span> <span class="o">+</span> <span class="s2">&quot;_t&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="DisulfideClassManager-407"><a href="#DisulfideClassManager-407"><span class="linenos">407</span></a>                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">DisulfideClassManager</span><span class="o">.</span><span class="n">get_class_string</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideClassManager-408"><a href="#DisulfideClassManager-408"><span class="linenos">408</span></a>            <span class="p">)</span>
</span><span id="DisulfideClassManager-409"><a href="#DisulfideClassManager-409"><span class="linenos">409</span></a>
</span><span id="DisulfideClassManager-410"><a href="#DisulfideClassManager-410"><span class="linenos">410</span></a>        <span class="c1"># Concatenate the transformed chi columns to create class_id</span>
</span><span id="DisulfideClassManager-411"><a href="#DisulfideClassManager-411"><span class="linenos">411</span></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;chi1_t&quot;</span><span class="p">,</span> <span class="s2">&quot;chi2_t&quot;</span><span class="p">,</span> <span class="s2">&quot;chi3_t&quot;</span><span class="p">,</span> <span class="s2">&quot;chi4_t&quot;</span><span class="p">,</span> <span class="s2">&quot;chi5_t&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
</span><span id="DisulfideClassManager-412"><a href="#DisulfideClassManager-412"><span class="linenos">412</span></a>            <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
</span><span id="DisulfideClassManager-413"><a href="#DisulfideClassManager-413"><span class="linenos">413</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassManager-414"><a href="#DisulfideClassManager-414"><span class="linenos">414</span></a>
</span><span id="DisulfideClassManager-415"><a href="#DisulfideClassManager-415"><span class="linenos">415</span></a>        <span class="c1"># Group by class_id and aggregate required statistics</span>
</span><span id="DisulfideClassManager-416"><a href="#DisulfideClassManager-416"><span class="linenos">416</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;class_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;ss_id&quot;</span><span class="p">:</span> <span class="s2">&quot;unique&quot;</span><span class="p">})</span>
</span><span id="DisulfideClassManager-417"><a href="#DisulfideClassManager-417"><span class="linenos">417</span></a>        <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;ss_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
</span><span id="DisulfideClassManager-418"><a href="#DisulfideClassManager-418"><span class="linenos">418</span></a>        <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;incidence&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="DisulfideClassManager-419"><a href="#DisulfideClassManager-419"><span class="linenos">419</span></a>        <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;percentage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;incidence&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="DisulfideClassManager-420"><a href="#DisulfideClassManager-420"><span class="linenos">420</span></a>
</span><span id="DisulfideClassManager-421"><a href="#DisulfideClassManager-421"><span class="linenos">421</span></a>        <span class="k">return</span> <span class="n">grouped</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="DisulfideClassManager-422"><a href="#DisulfideClassManager-422"><span class="linenos">422</span></a>
</span><span id="DisulfideClassManager-423"><a href="#DisulfideClassManager-423"><span class="linenos">423</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">filter_class_by_percentage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="DisulfideClassManager-424"><a href="#DisulfideClassManager-424"><span class="linenos">424</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-425"><a href="#DisulfideClassManager-425"><span class="linenos">425</span></a><span class="sd">        Filter the specified class definitions by percentage.</span>
</span><span id="DisulfideClassManager-426"><a href="#DisulfideClassManager-426"><span class="linenos">426</span></a>
</span><span id="DisulfideClassManager-427"><a href="#DisulfideClassManager-427"><span class="linenos">427</span></a><span class="sd">        :param cutoff: A numeric value specifying the minimum percentage required for a row to be included in the output</span>
</span><span id="DisulfideClassManager-428"><a href="#DisulfideClassManager-428"><span class="linenos">428</span></a><span class="sd">        :param base: An optional integer specifying the class type to filter, defaults to 8</span>
</span><span id="DisulfideClassManager-429"><a href="#DisulfideClassManager-429"><span class="linenos">429</span></a><span class="sd">        :return: A new Pandas DataFrame containing only rows where the percentage is greater than or equal to the cutoff</span>
</span><span id="DisulfideClassManager-430"><a href="#DisulfideClassManager-430"><span class="linenos">430</span></a><span class="sd">        :rtype: pandas.DataFrame</span>
</span><span id="DisulfideClassManager-431"><a href="#DisulfideClassManager-431"><span class="linenos">431</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-432"><a href="#DisulfideClassManager-432"><span class="linenos">432</span></a>
</span><span id="DisulfideClassManager-433"><a href="#DisulfideClassManager-433"><span class="linenos">433</span></a>        <span class="k">match</span> <span class="n">base</span><span class="p">:</span>
</span><span id="DisulfideClassManager-434"><a href="#DisulfideClassManager-434"><span class="linenos">434</span></a>            <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="DisulfideClassManager-435"><a href="#DisulfideClassManager-435"><span class="linenos">435</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_df</span>
</span><span id="DisulfideClassManager-436"><a href="#DisulfideClassManager-436"><span class="linenos">436</span></a>            <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="DisulfideClassManager-437"><a href="#DisulfideClassManager-437"><span class="linenos">437</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_df</span>
</span><span id="DisulfideClassManager-438"><a href="#DisulfideClassManager-438"><span class="linenos">438</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="DisulfideClassManager-439"><a href="#DisulfideClassManager-439"><span class="linenos">439</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be 6 or 8.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-440"><a href="#DisulfideClassManager-440"><span class="linenos">440</span></a>
</span><span id="DisulfideClassManager-441"><a href="#DisulfideClassManager-441"><span class="linenos">441</span></a>        <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;percentage&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">cutoff</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DisulfideClassManager-442"><a href="#DisulfideClassManager-442"><span class="linenos">442</span></a>
</span><span id="DisulfideClassManager-443"><a href="#DisulfideClassManager-443"><span class="linenos">443</span></a>    <span class="nd">@staticmethod</span>
</span><span id="DisulfideClassManager-444"><a href="#DisulfideClassManager-444"><span class="linenos">444</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_binary_quadrant</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="DisulfideClassManager-445"><a href="#DisulfideClassManager-445"><span class="linenos">445</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-446"><a href="#DisulfideClassManager-446"><span class="linenos">446</span></a><span class="sd">        Return the binary quadrant in which an angle in degrees lies if the area is described by dividing a unit circle into 2 equal segments.</span>
</span><span id="DisulfideClassManager-447"><a href="#DisulfideClassManager-447"><span class="linenos">447</span></a>
</span><span id="DisulfideClassManager-448"><a href="#DisulfideClassManager-448"><span class="linenos">448</span></a><span class="sd">        :param angle_deg (float or array-like): The angle in degrees.</span>
</span><span id="DisulfideClassManager-449"><a href="#DisulfideClassManager-449"><span class="linenos">449</span></a>
</span><span id="DisulfideClassManager-450"><a href="#DisulfideClassManager-450"><span class="linenos">450</span></a><span class="sd">        Returns:</span>
</span><span id="DisulfideClassManager-451"><a href="#DisulfideClassManager-451"><span class="linenos">451</span></a><span class="sd">        :return str. The binary quadrant (0 or 2) that the angle belongs to.</span>
</span><span id="DisulfideClassManager-452"><a href="#DisulfideClassManager-452"><span class="linenos">452</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-453"><a href="#DisulfideClassManager-453"><span class="linenos">453</span></a>        <span class="n">angle_deg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DisulfideClassManager-454"><a href="#DisulfideClassManager-454"><span class="linenos">454</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
</span><span id="DisulfideClassManager-455"><a href="#DisulfideClassManager-455"><span class="linenos">455</span></a>        <span class="p">)</span>  <span class="c1"># Normalize the angle to the range [0, 360)</span>
</span><span id="DisulfideClassManager-456"><a href="#DisulfideClassManager-456"><span class="linenos">456</span></a>
</span><span id="DisulfideClassManager-457"><a href="#DisulfideClassManager-457"><span class="linenos">457</span></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">):</span>
</span><span id="DisulfideClassManager-458"><a href="#DisulfideClassManager-458"><span class="linenos">458</span></a>            <span class="k">if</span> <span class="n">angle_deg</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">angle_deg</span> <span class="o">&lt;</span> <span class="mi">180</span><span class="p">:</span>
</span><span id="DisulfideClassManager-459"><a href="#DisulfideClassManager-459"><span class="linenos">459</span></a>                <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="DisulfideClassManager-460"><a href="#DisulfideClassManager-460"><span class="linenos">460</span></a>
</span><span id="DisulfideClassManager-461"><a href="#DisulfideClassManager-461"><span class="linenos">461</span></a>            <span class="k">if</span> <span class="n">angle_deg</span> <span class="o">&gt;=</span> <span class="mi">180</span> <span class="ow">and</span> <span class="n">angle_deg</span> <span class="o">&lt;</span> <span class="mi">360</span><span class="p">:</span>
</span><span id="DisulfideClassManager-462"><a href="#DisulfideClassManager-462"><span class="linenos">462</span></a>                <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DisulfideClassManager-463"><a href="#DisulfideClassManager-463"><span class="linenos">463</span></a>
</span><span id="DisulfideClassManager-464"><a href="#DisulfideClassManager-464"><span class="linenos">464</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="DisulfideClassManager-465"><a href="#DisulfideClassManager-465"><span class="linenos">465</span></a>                <span class="s2">&quot;Invalid angle value: angle must be in the range [-360, 360).&quot;</span>
</span><span id="DisulfideClassManager-466"><a href="#DisulfideClassManager-466"><span class="linenos">466</span></a>            <span class="p">)</span>
</span><span id="DisulfideClassManager-467"><a href="#DisulfideClassManager-467"><span class="linenos">467</span></a>
</span><span id="DisulfideClassManager-468"><a href="#DisulfideClassManager-468"><span class="linenos">468</span></a>        <span class="n">quadrants</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">angle_deg</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">angle_deg</span> <span class="o">&lt;</span> <span class="mi">180</span><span class="p">),</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-469"><a href="#DisulfideClassManager-469"><span class="linenos">469</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">quadrants</span><span class="p">)</span>
</span><span id="DisulfideClassManager-470"><a href="#DisulfideClassManager-470"><span class="linenos">470</span></a>
</span><span id="DisulfideClassManager-471"><a href="#DisulfideClassManager-471"><span class="linenos">471</span></a>    <span class="nd">@staticmethod</span>
</span><span id="DisulfideClassManager-472"><a href="#DisulfideClassManager-472"><span class="linenos">472</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sixth_quadrant</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="DisulfideClassManager-473"><a href="#DisulfideClassManager-473"><span class="linenos">473</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-474"><a href="#DisulfideClassManager-474"><span class="linenos">474</span></a><span class="sd">        Return the eighth quadrant in which an angle in degrees lies by dividing a unit circle into 8 equal segments.</span>
</span><span id="DisulfideClassManager-475"><a href="#DisulfideClassManager-475"><span class="linenos">475</span></a>
</span><span id="DisulfideClassManager-476"><a href="#DisulfideClassManager-476"><span class="linenos">476</span></a><span class="sd">        :param angle_deg: float or array-like</span>
</span><span id="DisulfideClassManager-477"><a href="#DisulfideClassManager-477"><span class="linenos">477</span></a><span class="sd">            The angle in degrees.</span>
</span><span id="DisulfideClassManager-478"><a href="#DisulfideClassManager-478"><span class="linenos">478</span></a><span class="sd">        :return: str</span>
</span><span id="DisulfideClassManager-479"><a href="#DisulfideClassManager-479"><span class="linenos">479</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-480"><a href="#DisulfideClassManager-480"><span class="linenos">480</span></a>        <span class="c1"># Normalize the angle to the range [0, 360)</span>
</span><span id="DisulfideClassManager-481"><a href="#DisulfideClassManager-481"><span class="linenos">481</span></a>        <span class="n">angle_deg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
</span><span id="DisulfideClassManager-482"><a href="#DisulfideClassManager-482"><span class="linenos">482</span></a>
</span><span id="DisulfideClassManager-483"><a href="#DisulfideClassManager-483"><span class="linenos">483</span></a>        <span class="c1"># Calculate quadrant: each quadrant spans 60 degrees.</span>
</span><span id="DisulfideClassManager-484"><a href="#DisulfideClassManager-484"><span class="linenos">484</span></a>        <span class="c1"># The quadrant is computed as: quadrant = 6 - floor(angle_deg / 60)</span>
</span><span id="DisulfideClassManager-485"><a href="#DisulfideClassManager-485"><span class="linenos">485</span></a>        <span class="n">quadrant</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">floor_divide</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="DisulfideClassManager-486"><a href="#DisulfideClassManager-486"><span class="linenos">486</span></a>
</span><span id="DisulfideClassManager-487"><a href="#DisulfideClassManager-487"><span class="linenos">487</span></a>        <span class="c1"># If the input was scalar (0-dim array), return a string.</span>
</span><span id="DisulfideClassManager-488"><a href="#DisulfideClassManager-488"><span class="linenos">488</span></a>        <span class="k">if</span> <span class="n">angle_deg</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DisulfideClassManager-489"><a href="#DisulfideClassManager-489"><span class="linenos">489</span></a>            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">quadrant</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</span><span id="DisulfideClassManager-490"><a href="#DisulfideClassManager-490"><span class="linenos">490</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideClassManager-491"><a href="#DisulfideClassManager-491"><span class="linenos">491</span></a>            <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">quadrant</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
</span><span id="DisulfideClassManager-492"><a href="#DisulfideClassManager-492"><span class="linenos">492</span></a>
</span><span id="DisulfideClassManager-493"><a href="#DisulfideClassManager-493"><span class="linenos">493</span></a>    <span class="nd">@staticmethod</span>
</span><span id="DisulfideClassManager-494"><a href="#DisulfideClassManager-494"><span class="linenos">494</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_eighth_quadrant</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="DisulfideClassManager-495"><a href="#DisulfideClassManager-495"><span class="linenos">495</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-496"><a href="#DisulfideClassManager-496"><span class="linenos">496</span></a><span class="sd">        Return the eighth quadrant in which an angle in degrees lies by dividing a unit circle into 8 equal segments.</span>
</span><span id="DisulfideClassManager-497"><a href="#DisulfideClassManager-497"><span class="linenos">497</span></a>
</span><span id="DisulfideClassManager-498"><a href="#DisulfideClassManager-498"><span class="linenos">498</span></a><span class="sd">        :param angle_deg: float or array-like</span>
</span><span id="DisulfideClassManager-499"><a href="#DisulfideClassManager-499"><span class="linenos">499</span></a><span class="sd">            The angle in degrees.</span>
</span><span id="DisulfideClassManager-500"><a href="#DisulfideClassManager-500"><span class="linenos">500</span></a><span class="sd">        :return: str</span>
</span><span id="DisulfideClassManager-501"><a href="#DisulfideClassManager-501"><span class="linenos">501</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-502"><a href="#DisulfideClassManager-502"><span class="linenos">502</span></a>
</span><span id="DisulfideClassManager-503"><a href="#DisulfideClassManager-503"><span class="linenos">503</span></a>        <span class="c1"># Normalize the angle to the range [0, 360)</span>
</span><span id="DisulfideClassManager-504"><a href="#DisulfideClassManager-504"><span class="linenos">504</span></a>        <span class="n">angle_deg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
</span><span id="DisulfideClassManager-505"><a href="#DisulfideClassManager-505"><span class="linenos">505</span></a>
</span><span id="DisulfideClassManager-506"><a href="#DisulfideClassManager-506"><span class="linenos">506</span></a>        <span class="c1"># Calculate quadrant: each quadrant spans 45 degrees.</span>
</span><span id="DisulfideClassManager-507"><a href="#DisulfideClassManager-507"><span class="linenos">507</span></a>        <span class="c1"># The quadrant is computed as: quadrant = 8 - floor(angle_deg / 45)</span>
</span><span id="DisulfideClassManager-508"><a href="#DisulfideClassManager-508"><span class="linenos">508</span></a>        <span class="n">quadrant</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">floor_divide</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="DisulfideClassManager-509"><a href="#DisulfideClassManager-509"><span class="linenos">509</span></a>
</span><span id="DisulfideClassManager-510"><a href="#DisulfideClassManager-510"><span class="linenos">510</span></a>        <span class="c1"># If the input was scalar (0-dim array), return a string.</span>
</span><span id="DisulfideClassManager-511"><a href="#DisulfideClassManager-511"><span class="linenos">511</span></a>        <span class="k">if</span> <span class="n">angle_deg</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DisulfideClassManager-512"><a href="#DisulfideClassManager-512"><span class="linenos">512</span></a>            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">quadrant</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</span><span id="DisulfideClassManager-513"><a href="#DisulfideClassManager-513"><span class="linenos">513</span></a>
</span><span id="DisulfideClassManager-514"><a href="#DisulfideClassManager-514"><span class="linenos">514</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">quadrant</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
</span><span id="DisulfideClassManager-515"><a href="#DisulfideClassManager-515"><span class="linenos">515</span></a>
</span><span id="DisulfideClassManager-516"><a href="#DisulfideClassManager-516"><span class="linenos">516</span></a>    <span class="nd">@staticmethod</span>
</span><span id="DisulfideClassManager-517"><a href="#DisulfideClassManager-517"><span class="linenos">517</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_class_string</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="DisulfideClassManager-518"><a href="#DisulfideClassManager-518"><span class="linenos">518</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-519"><a href="#DisulfideClassManager-519"><span class="linenos">519</span></a><span class="sd">        Return the segment corresponding to an angle in degrees when the circle is divided into</span>
</span><span id="DisulfideClassManager-520"><a href="#DisulfideClassManager-520"><span class="linenos">520</span></a><span class="sd">        a specified number of equal segments. The segments are labeled in descending order, so that:</span>
</span><span id="DisulfideClassManager-521"><a href="#DisulfideClassManager-521"><span class="linenos">521</span></a>
</span><span id="DisulfideClassManager-522"><a href="#DisulfideClassManager-522"><span class="linenos">522</span></a><span class="sd">            - For base=8, an angle in [0, 45) degrees returns &quot;8&quot;,</span>
</span><span id="DisulfideClassManager-523"><a href="#DisulfideClassManager-523"><span class="linenos">523</span></a><span class="sd">            an angle in [45, 90) returns &quot;7&quot;, ...,</span>
</span><span id="DisulfideClassManager-524"><a href="#DisulfideClassManager-524"><span class="linenos">524</span></a><span class="sd">            and an angle in [315, 360) returns &quot;1&quot;.</span>
</span><span id="DisulfideClassManager-525"><a href="#DisulfideClassManager-525"><span class="linenos">525</span></a>
</span><span id="DisulfideClassManager-526"><a href="#DisulfideClassManager-526"><span class="linenos">526</span></a><span class="sd">        :param angle_deg: The angle in degrees. Single or array-like with length 5.</span>
</span><span id="DisulfideClassManager-527"><a href="#DisulfideClassManager-527"><span class="linenos">527</span></a><span class="sd">        :type angle_deg: float or array-like</span>
</span><span id="DisulfideClassManager-528"><a href="#DisulfideClassManager-528"><span class="linenos">528</span></a><span class="sd">        :param base: The number of segments (default is 8). For example, with base=8 each segment spans 45°,</span>
</span><span id="DisulfideClassManager-529"><a href="#DisulfideClassManager-529"><span class="linenos">529</span></a><span class="sd">        with base=12 each spans 30°, etc.</span>
</span><span id="DisulfideClassManager-530"><a href="#DisulfideClassManager-530"><span class="linenos">530</span></a><span class="sd">        :type base: int, optional, default=8, max=16, must be even.</span>
</span><span id="DisulfideClassManager-531"><a href="#DisulfideClassManager-531"><span class="linenos">531</span></a><span class="sd">        :return: The label corresponding to the segment in which the input angle lies. For scalar input,</span>
</span><span id="DisulfideClassManager-532"><a href="#DisulfideClassManager-532"><span class="linenos">532</span></a><span class="sd">                    a single string is returned; for array-like input, a NumPy array of strings is returned.</span>
</span><span id="DisulfideClassManager-533"><a href="#DisulfideClassManager-533"><span class="linenos">533</span></a><span class="sd">        :rtype: str</span>
</span><span id="DisulfideClassManager-534"><a href="#DisulfideClassManager-534"><span class="linenos">534</span></a><span class="sd">        :raises ValueError: If the base is out of range.</span>
</span><span id="DisulfideClassManager-535"><a href="#DisulfideClassManager-535"><span class="linenos">535</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-536"><a href="#DisulfideClassManager-536"><span class="linenos">536</span></a>        <span class="c1"># Character map for the segment labels, technically up to base 36.</span>
</span><span id="DisulfideClassManager-537"><a href="#DisulfideClassManager-537"><span class="linenos">537</span></a>        <span class="n">char_map</span> <span class="o">=</span> <span class="s2">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>
</span><span id="DisulfideClassManager-538"><a href="#DisulfideClassManager-538"><span class="linenos">538</span></a>        <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</span><span id="DisulfideClassManager-539"><a href="#DisulfideClassManager-539"><span class="linenos">539</span></a>
</span><span id="DisulfideClassManager-540"><a href="#DisulfideClassManager-540"><span class="linenos">540</span></a>        <span class="c1"># Normalize the angle to [0, 360)</span>
</span><span id="DisulfideClassManager-541"><a href="#DisulfideClassManager-541"><span class="linenos">541</span></a>        <span class="n">angle_deg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
</span><span id="DisulfideClassManager-542"><a href="#DisulfideClassManager-542"><span class="linenos">542</span></a>
</span><span id="DisulfideClassManager-543"><a href="#DisulfideClassManager-543"><span class="linenos">543</span></a>        <span class="c1"># Each segment spans 360/base degrees.</span>
</span><span id="DisulfideClassManager-544"><a href="#DisulfideClassManager-544"><span class="linenos">544</span></a>        <span class="n">segment_size</span> <span class="o">=</span> <span class="mi">360</span> <span class="o">/</span> <span class="n">base</span>
</span><span id="DisulfideClassManager-545"><a href="#DisulfideClassManager-545"><span class="linenos">545</span></a>
</span><span id="DisulfideClassManager-546"><a href="#DisulfideClassManager-546"><span class="linenos">546</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]:</span>
</span><span id="DisulfideClassManager-547"><a href="#DisulfideClassManager-547"><span class="linenos">547</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You must enter either 1 or 5 dihedral angles.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-548"><a href="#DisulfideClassManager-548"><span class="linenos">548</span></a>
</span><span id="DisulfideClassManager-549"><a href="#DisulfideClassManager-549"><span class="linenos">549</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="o">&gt;</span> <span class="mi">16</span> <span class="ow">or</span> <span class="n">base</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">base</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DisulfideClassManager-550"><a href="#DisulfideClassManager-550"><span class="linenos">550</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be even and between 2 and 16.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-551"><a href="#DisulfideClassManager-551"><span class="linenos">551</span></a>
</span><span id="DisulfideClassManager-552"><a href="#DisulfideClassManager-552"><span class="linenos">552</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="DisulfideClassManager-553"><a href="#DisulfideClassManager-553"><span class="linenos">553</span></a>            <span class="k">return</span> <span class="n">DisulfideClassManager</span><span class="o">.</span><span class="n">get_binary_quadrant</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span>
</span><span id="DisulfideClassManager-554"><a href="#DisulfideClassManager-554"><span class="linenos">554</span></a>
</span><span id="DisulfideClassManager-555"><a href="#DisulfideClassManager-555"><span class="linenos">555</span></a>        <span class="c1"># Compute the segment number: subtract the segment index (via floor division) from base.</span>
</span><span id="DisulfideClassManager-556"><a href="#DisulfideClassManager-556"><span class="linenos">556</span></a>        <span class="n">segment</span> <span class="o">=</span> <span class="n">base</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">floor_divide</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">,</span> <span class="n">segment_size</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="DisulfideClassManager-557"><a href="#DisulfideClassManager-557"><span class="linenos">557</span></a>
</span><span id="DisulfideClassManager-558"><a href="#DisulfideClassManager-558"><span class="linenos">558</span></a>        <span class="c1"># Return as string(s)</span>
</span><span id="DisulfideClassManager-559"><a href="#DisulfideClassManager-559"><span class="linenos">559</span></a>        <span class="k">if</span> <span class="n">angle_deg</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DisulfideClassManager-560"><a href="#DisulfideClassManager-560"><span class="linenos">560</span></a>            <span class="k">return</span> <span class="n">char_map</span><span class="p">[</span><span class="n">segment</span><span class="o">.</span><span class="n">item</span><span class="p">()]</span>
</span><span id="DisulfideClassManager-561"><a href="#DisulfideClassManager-561"><span class="linenos">561</span></a>
</span><span id="DisulfideClassManager-562"><a href="#DisulfideClassManager-562"><span class="linenos">562</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">char_map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">segment</span><span class="p">)</span>
</span><span id="DisulfideClassManager-563"><a href="#DisulfideClassManager-563"><span class="linenos">563</span></a>
</span><span id="DisulfideClassManager-564"><a href="#DisulfideClassManager-564"><span class="linenos">564</span></a>    <span class="nd">@staticmethod</span>
</span><span id="DisulfideClassManager-565"><a href="#DisulfideClassManager-565"><span class="linenos">565</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">class_string_from_dihedral</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="DisulfideClassManager-566"><a href="#DisulfideClassManager-566"><span class="linenos">566</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-567"><a href="#DisulfideClassManager-567"><span class="linenos">567</span></a><span class="sd">        Return the class string for a set of dihedral angles, given the base.</span>
</span><span id="DisulfideClassManager-568"><a href="#DisulfideClassManager-568"><span class="linenos">568</span></a>
</span><span id="DisulfideClassManager-569"><a href="#DisulfideClassManager-569"><span class="linenos">569</span></a><span class="sd">        :param args: One or five dihedral angles.</span>
</span><span id="DisulfideClassManager-570"><a href="#DisulfideClassManager-570"><span class="linenos">570</span></a><span class="sd">        :type args: float or array-like</span>
</span><span id="DisulfideClassManager-571"><a href="#DisulfideClassManager-571"><span class="linenos">571</span></a><span class="sd">        :param base: The base class to use, 2, 6, or 8. Defaults to 8.</span>
</span><span id="DisulfideClassManager-572"><a href="#DisulfideClassManager-572"><span class="linenos">572</span></a><span class="sd">        :type base: int, optional</span>
</span><span id="DisulfideClassManager-573"><a href="#DisulfideClassManager-573"><span class="linenos">573</span></a><span class="sd">        :return: The class string for the input dihedral angles.</span>
</span><span id="DisulfideClassManager-574"><a href="#DisulfideClassManager-574"><span class="linenos">574</span></a><span class="sd">        :rtype: str</span>
</span><span id="DisulfideClassManager-575"><a href="#DisulfideClassManager-575"><span class="linenos">575</span></a><span class="sd">        :raises ValueError: If the number of dihedral angles is not 1 or 5, or if the base is not 2, 6, or 8.</span>
</span><span id="DisulfideClassManager-576"><a href="#DisulfideClassManager-576"><span class="linenos">576</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-577"><a href="#DisulfideClassManager-577"><span class="linenos">577</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]:</span>
</span><span id="DisulfideClassManager-578"><a href="#DisulfideClassManager-578"><span class="linenos">578</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You must enter either 1 or 5 dihedral angles.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-579"><a href="#DisulfideClassManager-579"><span class="linenos">579</span></a>
</span><span id="DisulfideClassManager-580"><a href="#DisulfideClassManager-580"><span class="linenos">580</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="o">&gt;</span> <span class="mi">16</span> <span class="ow">or</span> <span class="n">base</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">base</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DisulfideClassManager-581"><a href="#DisulfideClassManager-581"><span class="linenos">581</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be between 2 and 16, and even.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-582"><a href="#DisulfideClassManager-582"><span class="linenos">582</span></a>
</span><span id="DisulfideClassManager-583"><a href="#DisulfideClassManager-583"><span class="linenos">583</span></a>        <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</span><span id="DisulfideClassManager-584"><a href="#DisulfideClassManager-584"><span class="linenos">584</span></a>
</span><span id="DisulfideClassManager-585"><a href="#DisulfideClassManager-585"><span class="linenos">585</span></a>        <span class="k">match</span> <span class="nb">len</span><span class="p">(</span><span class="n">angles</span><span class="p">):</span>
</span><span id="DisulfideClassManager-586"><a href="#DisulfideClassManager-586"><span class="linenos">586</span></a>            <span class="k">case</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="DisulfideClassManager-587"><a href="#DisulfideClassManager-587"><span class="linenos">587</span></a>                <span class="k">return</span> <span class="n">DisulfideClassManager</span><span class="o">.</span><span class="n">get_class_string</span><span class="p">(</span><span class="n">angles</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideClassManager-588"><a href="#DisulfideClassManager-588"><span class="linenos">588</span></a>            <span class="k">case</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="DisulfideClassManager-589"><a href="#DisulfideClassManager-589"><span class="linenos">589</span></a>                <span class="n">segments</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DisulfideClassManager-590"><a href="#DisulfideClassManager-590"><span class="linenos">590</span></a>                    <span class="n">DisulfideClassManager</span><span class="o">.</span><span class="n">get_class_string</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideClassManager-591"><a href="#DisulfideClassManager-591"><span class="linenos">591</span></a>                    <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">angles</span>
</span><span id="DisulfideClassManager-592"><a href="#DisulfideClassManager-592"><span class="linenos">592</span></a>                <span class="p">]</span>
</span><span id="DisulfideClassManager-593"><a href="#DisulfideClassManager-593"><span class="linenos">593</span></a>                <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span>
</span><span id="DisulfideClassManager-594"><a href="#DisulfideClassManager-594"><span class="linenos">594</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="DisulfideClassManager-595"><a href="#DisulfideClassManager-595"><span class="linenos">595</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid number of angles. Must be 1 or 5.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-596"><a href="#DisulfideClassManager-596"><span class="linenos">596</span></a>
</span><span id="DisulfideClassManager-597"><a href="#DisulfideClassManager-597"><span class="linenos">597</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sslist_from_classid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="DisulfideClassManager-598"><a href="#DisulfideClassManager-598"><span class="linenos">598</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-599"><a href="#DisulfideClassManager-599"><span class="linenos">599</span></a><span class="sd">        Return the &#39;ss_id&#39; value in the given DataFrame that corresponds to the</span>
</span><span id="DisulfideClassManager-600"><a href="#DisulfideClassManager-600"><span class="linenos">600</span></a><span class="sd">        input &#39;cls&#39; string in the class description</span>
</span><span id="DisulfideClassManager-601"><a href="#DisulfideClassManager-601"><span class="linenos">601</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-602"><a href="#DisulfideClassManager-602"><span class="linenos">602</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="DisulfideClassManager-603"><a href="#DisulfideClassManager-603"><span class="linenos">603</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_df</span>
</span><span id="DisulfideClassManager-604"><a href="#DisulfideClassManager-604"><span class="linenos">604</span></a>        <span class="k">elif</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="DisulfideClassManager-605"><a href="#DisulfideClassManager-605"><span class="linenos">605</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_df</span>
</span><span id="DisulfideClassManager-606"><a href="#DisulfideClassManager-606"><span class="linenos">606</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideClassManager-607"><a href="#DisulfideClassManager-607"><span class="linenos">607</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be 2 or 8.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-608"><a href="#DisulfideClassManager-608"><span class="linenos">608</span></a>
</span><span id="DisulfideClassManager-609"><a href="#DisulfideClassManager-609"><span class="linenos">609</span></a>        <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">cls</span><span class="p">]</span>
</span><span id="DisulfideClassManager-610"><a href="#DisulfideClassManager-610"><span class="linenos">610</span></a>
</span><span id="DisulfideClassManager-611"><a href="#DisulfideClassManager-611"><span class="linenos">611</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DisulfideClassManager-612"><a href="#DisulfideClassManager-612"><span class="linenos">612</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="DisulfideClassManager-613"><a href="#DisulfideClassManager-613"><span class="linenos">613</span></a>
</span><span id="DisulfideClassManager-614"><a href="#DisulfideClassManager-614"><span class="linenos">614</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="DisulfideClassManager-615"><a href="#DisulfideClassManager-615"><span class="linenos">615</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Multiple rows found for class_id &#39;</span><span class="si">{</span><span class="bp">cls</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-616"><a href="#DisulfideClassManager-616"><span class="linenos">616</span></a>
</span><span id="DisulfideClassManager-617"><a href="#DisulfideClassManager-617"><span class="linenos">617</span></a>        <span class="k">return</span> <span class="n">filtered_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;ss_id&quot;</span><span class="p">]</span>
</span><span id="DisulfideClassManager-618"><a href="#DisulfideClassManager-618"><span class="linenos">618</span></a>
</span><span id="DisulfideClassManager-619"><a href="#DisulfideClassManager-619"><span class="linenos">619</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">class_to_binary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cls_str</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
</span><span id="DisulfideClassManager-620"><a href="#DisulfideClassManager-620"><span class="linenos">620</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-621"><a href="#DisulfideClassManager-621"><span class="linenos">621</span></a><span class="sd">        Return a string of length 5 representing the ordinal section of a unit circle for an angle in range -180-180 degrees</span>
</span><span id="DisulfideClassManager-622"><a href="#DisulfideClassManager-622"><span class="linenos">622</span></a><span class="sd">        into a string of 5 characters, where each character is either &#39;0&#39; if the corresponding input character represents a</span>
</span><span id="DisulfideClassManager-623"><a href="#DisulfideClassManager-623"><span class="linenos">623</span></a><span class="sd">        negative angle or &#39;2&#39; if it represents a positive angle.</span>
</span><span id="DisulfideClassManager-624"><a href="#DisulfideClassManager-624"><span class="linenos">624</span></a>
</span><span id="DisulfideClassManager-625"><a href="#DisulfideClassManager-625"><span class="linenos">625</span></a><span class="sd">        :param cls_str (str): A string of length 5 representing the ordinal section of a unit circle for an angle in range -180-180 degrees.</span>
</span><span id="DisulfideClassManager-626"><a href="#DisulfideClassManager-626"><span class="linenos">626</span></a><span class="sd">        :param base (int): The base of the ordinal section (6 or 8).</span>
</span><span id="DisulfideClassManager-627"><a href="#DisulfideClassManager-627"><span class="linenos">627</span></a><span class="sd">        :raises ValueError: If the base is not 6 or 8 or 10.</span>
</span><span id="DisulfideClassManager-628"><a href="#DisulfideClassManager-628"><span class="linenos">628</span></a><span class="sd">        :return str: A string of length 5, where each character is either &#39;0&#39; or &#39;2&#39;, representing the sign of the corresponding input angle.</span>
</span><span id="DisulfideClassManager-629"><a href="#DisulfideClassManager-629"><span class="linenos">629</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-630"><a href="#DisulfideClassManager-630"><span class="linenos">630</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">]:</span>
</span><span id="DisulfideClassManager-631"><a href="#DisulfideClassManager-631"><span class="linenos">631</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Base must be either 6, 8, or 10&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-632"><a href="#DisulfideClassManager-632"><span class="linenos">632</span></a>
</span><span id="DisulfideClassManager-633"><a href="#DisulfideClassManager-633"><span class="linenos">633</span></a>        <span class="n">output_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="DisulfideClassManager-634"><a href="#DisulfideClassManager-634"><span class="linenos">634</span></a>        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">cls_str</span><span class="p">:</span>
</span><span id="DisulfideClassManager-635"><a href="#DisulfideClassManager-635"><span class="linenos">635</span></a>            <span class="k">match</span> <span class="n">base</span><span class="p">:</span>
</span><span id="DisulfideClassManager-636"><a href="#DisulfideClassManager-636"><span class="linenos">636</span></a>                <span class="k">case</span> <span class="mi">6</span><span class="p">:</span>
</span><span id="DisulfideClassManager-637"><a href="#DisulfideClassManager-637"><span class="linenos">637</span></a>                    <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">]:</span>
</span><span id="DisulfideClassManager-638"><a href="#DisulfideClassManager-638"><span class="linenos">638</span></a>                        <span class="n">output_str</span> <span class="o">+=</span> <span class="s2">&quot;2&quot;</span>
</span><span id="DisulfideClassManager-639"><a href="#DisulfideClassManager-639"><span class="linenos">639</span></a>                    <span class="k">elif</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">]:</span>
</span><span id="DisulfideClassManager-640"><a href="#DisulfideClassManager-640"><span class="linenos">640</span></a>                        <span class="n">output_str</span> <span class="o">+=</span> <span class="s2">&quot;0&quot;</span>
</span><span id="DisulfideClassManager-641"><a href="#DisulfideClassManager-641"><span class="linenos">641</span></a>                <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="DisulfideClassManager-642"><a href="#DisulfideClassManager-642"><span class="linenos">642</span></a>                    <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">]:</span>
</span><span id="DisulfideClassManager-643"><a href="#DisulfideClassManager-643"><span class="linenos">643</span></a>                        <span class="n">output_str</span> <span class="o">+=</span> <span class="s2">&quot;2&quot;</span>
</span><span id="DisulfideClassManager-644"><a href="#DisulfideClassManager-644"><span class="linenos">644</span></a>                    <span class="k">elif</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">]:</span>
</span><span id="DisulfideClassManager-645"><a href="#DisulfideClassManager-645"><span class="linenos">645</span></a>                        <span class="n">output_str</span> <span class="o">+=</span> <span class="s2">&quot;0&quot;</span>
</span><span id="DisulfideClassManager-646"><a href="#DisulfideClassManager-646"><span class="linenos">646</span></a>                <span class="k">case</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="DisulfideClassManager-647"><a href="#DisulfideClassManager-647"><span class="linenos">647</span></a>                    <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">]:</span>
</span><span id="DisulfideClassManager-648"><a href="#DisulfideClassManager-648"><span class="linenos">648</span></a>                        <span class="n">output_str</span> <span class="o">+=</span> <span class="s2">&quot;2&quot;</span>
</span><span id="DisulfideClassManager-649"><a href="#DisulfideClassManager-649"><span class="linenos">649</span></a>                    <span class="k">elif</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="s2">&quot;9&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">]:</span>
</span><span id="DisulfideClassManager-650"><a href="#DisulfideClassManager-650"><span class="linenos">650</span></a>                        <span class="n">output_str</span> <span class="o">+=</span> <span class="s2">&quot;0&quot;</span>
</span><span id="DisulfideClassManager-651"><a href="#DisulfideClassManager-651"><span class="linenos">651</span></a>                <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="DisulfideClassManager-652"><a href="#DisulfideClassManager-652"><span class="linenos">652</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be either 6, 8, or 10&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-653"><a href="#DisulfideClassManager-653"><span class="linenos">653</span></a>        <span class="k">return</span> <span class="n">output_str</span>
</span><span id="DisulfideClassManager-654"><a href="#DisulfideClassManager-654"><span class="linenos">654</span></a>
</span><span id="DisulfideClassManager-655"><a href="#DisulfideClassManager-655"><span class="linenos">655</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_class_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
</span><span id="DisulfideClassManager-656"><a href="#DisulfideClassManager-656"><span class="linenos">656</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-657"><a href="#DisulfideClassManager-657"><span class="linenos">657</span></a><span class="sd">        Get the Disulfide structural classes DataFrame.</span>
</span><span id="DisulfideClassManager-658"><a href="#DisulfideClassManager-658"><span class="linenos">658</span></a>
</span><span id="DisulfideClassManager-659"><a href="#DisulfideClassManager-659"><span class="linenos">659</span></a><span class="sd">        :param base: The base class to use, either 2 or 8. Defaults to 8.</span>
</span><span id="DisulfideClassManager-660"><a href="#DisulfideClassManager-660"><span class="linenos">660</span></a><span class="sd">        :type base: int</span>
</span><span id="DisulfideClassManager-661"><a href="#DisulfideClassManager-661"><span class="linenos">661</span></a><span class="sd">        :return: A DataFrame containing the class_id, count, incidence, and percentage columns.</span>
</span><span id="DisulfideClassManager-662"><a href="#DisulfideClassManager-662"><span class="linenos">662</span></a><span class="sd">        :rtype: pandas.DataFrame</span>
</span><span id="DisulfideClassManager-663"><a href="#DisulfideClassManager-663"><span class="linenos">663</span></a><span class="sd">        :raises ValueError: If the base is not 2 or 8.</span>
</span><span id="DisulfideClassManager-664"><a href="#DisulfideClassManager-664"><span class="linenos">664</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager-665"><a href="#DisulfideClassManager-665"><span class="linenos">665</span></a>        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="s2">&quot;incidence&quot;</span><span class="p">,</span> <span class="s2">&quot;percentage&quot;</span><span class="p">]</span>
</span><span id="DisulfideClassManager-666"><a href="#DisulfideClassManager-666"><span class="linenos">666</span></a>        <span class="k">match</span> <span class="n">base</span><span class="p">:</span>
</span><span id="DisulfideClassManager-667"><a href="#DisulfideClassManager-667"><span class="linenos">667</span></a>            <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="DisulfideClassManager-668"><a href="#DisulfideClassManager-668"><span class="linenos">668</span></a>                <span class="n">class_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_df</span>
</span><span id="DisulfideClassManager-669"><a href="#DisulfideClassManager-669"><span class="linenos">669</span></a>            <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="DisulfideClassManager-670"><a href="#DisulfideClassManager-670"><span class="linenos">670</span></a>                <span class="n">class_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_df</span>
</span><span id="DisulfideClassManager-671"><a href="#DisulfideClassManager-671"><span class="linenos">671</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="DisulfideClassManager-672"><a href="#DisulfideClassManager-672"><span class="linenos">672</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be 2, or 8.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager-673"><a href="#DisulfideClassManager-673"><span class="linenos">673</span></a>
</span><span id="DisulfideClassManager-674"><a href="#DisulfideClassManager-674"><span class="linenos">674</span></a>        <span class="n">result_df</span> <span class="o">=</span> <span class="n">class_df</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span>
</span><span id="DisulfideClassManager-675"><a href="#DisulfideClassManager-675"><span class="linenos">675</span></a>        <span class="k">return</span> <span class="n">result_df</span>
</span></pre></div>


            <div class="docstring"><p>This Class manages structural classes for the disulfide bonds contained
in the proteusPy disulfide database.</p>

<p>Class builds the internal dictionary mapping disulfides to class names.</p>

<p>Disulfide binary classes are defined using the ± formalism described by
Schmidt et al. (Biochem, 2006, 45, 7429-7433), across all 32 (2^5), possible
binary sidechain torsional combinations. Classes are named per Schmidt's convention.
The <code>class_id</code> represents the sign of each dihedral angle $\chi_{1} - \chi_{1'}$
where <em>0</em> represents <em>negative</em> dihedral angle and <em>2</em> a <em>positive</em> angle.</p>

<table>
<thead>
<tr>
  <th style="text-align:right;">class_id</th>
  <th style="text-align:left;">SS_Classname</th>
  <th style="text-align:left;">FXN</th>
  <th style="text-align:right;">count</th>
  <th style="text-align:right;">incidence</th>
  <th style="text-align:right;">percentage</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:right;">00000</td>
  <td style="text-align:left;">-LHSpiral</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">40943</td>
  <td style="text-align:right;">0.23359</td>
  <td style="text-align:right;">23.359</td>
</tr>
<tr>
  <td style="text-align:right;">00002</td>
  <td style="text-align:left;">00002</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">9391</td>
  <td style="text-align:right;">0.0535781</td>
  <td style="text-align:right;">5.35781</td>
</tr>
<tr>
  <td style="text-align:right;">00020</td>
  <td style="text-align:left;">-LHHook</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">4844</td>
  <td style="text-align:right;">0.0276363</td>
  <td style="text-align:right;">2.76363</td>
</tr>
<tr>
  <td style="text-align:right;">00022</td>
  <td style="text-align:left;">00022</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">2426</td>
  <td style="text-align:right;">0.0138409</td>
  <td style="text-align:right;">1.38409</td>
</tr>
<tr>
  <td style="text-align:right;">00200</td>
  <td style="text-align:left;">-RHStaple</td>
  <td style="text-align:left;">Allosteric</td>
  <td style="text-align:right;">16146</td>
  <td style="text-align:right;">0.092117</td>
  <td style="text-align:right;">9.2117</td>
</tr>
<tr>
  <td style="text-align:right;">00202</td>
  <td style="text-align:left;">00202</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">1396</td>
  <td style="text-align:right;">0.00796454</td>
  <td style="text-align:right;">0.796454</td>
</tr>
<tr>
  <td style="text-align:right;">00220</td>
  <td style="text-align:left;">00220</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">7238</td>
  <td style="text-align:right;">0.0412946</td>
  <td style="text-align:right;">4.12946</td>
</tr>
<tr>
  <td style="text-align:right;">00222</td>
  <td style="text-align:left;">00222</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">6658</td>
  <td style="text-align:right;">0.0379856</td>
  <td style="text-align:right;">3.79856</td>
</tr>
<tr>
  <td style="text-align:right;">02000</td>
  <td style="text-align:left;">02000</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">7104</td>
  <td style="text-align:right;">0.0405301</td>
  <td style="text-align:right;">4.05301</td>
</tr>
<tr>
  <td style="text-align:right;">02002</td>
  <td style="text-align:left;">02002</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">8044</td>
  <td style="text-align:right;">0.0458931</td>
  <td style="text-align:right;">4.58931</td>
</tr>
<tr>
  <td style="text-align:right;">02020</td>
  <td style="text-align:left;">-LHStaple</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">3154</td>
  <td style="text-align:right;">0.0179944</td>
  <td style="text-align:right;">1.79944</td>
</tr>
<tr>
  <td style="text-align:right;">02022</td>
  <td style="text-align:left;">02022</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">1146</td>
  <td style="text-align:right;">0.00653822</td>
  <td style="text-align:right;">0.653822</td>
</tr>
<tr>
  <td style="text-align:right;">02200</td>
  <td style="text-align:left;">-RHHook</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">7115</td>
  <td style="text-align:right;">0.0405929</td>
  <td style="text-align:right;">4.05929</td>
</tr>
<tr>
  <td style="text-align:right;">02202</td>
  <td style="text-align:left;">02202</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">1021</td>
  <td style="text-align:right;">0.00582507</td>
  <td style="text-align:right;">0.582507</td>
</tr>
<tr>
  <td style="text-align:right;">02220</td>
  <td style="text-align:left;">-RHSpiral</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">8989</td>
  <td style="text-align:right;">0.0512845</td>
  <td style="text-align:right;">5.12845</td>
</tr>
<tr>
  <td style="text-align:right;">02222</td>
  <td style="text-align:left;">02222</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">7641</td>
  <td style="text-align:right;">0.0435939</td>
  <td style="text-align:right;">4.35939</td>
</tr>
<tr>
  <td style="text-align:right;">20000</td>
  <td style="text-align:left;">±LHSpiral</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">5007</td>
  <td style="text-align:right;">0.0285662</td>
  <td style="text-align:right;">2.85662</td>
</tr>
<tr>
  <td style="text-align:right;">20002</td>
  <td style="text-align:left;">+LHSpiral</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">1611</td>
  <td style="text-align:right;">0.00919117</td>
  <td style="text-align:right;">0.919117</td>
</tr>
<tr>
  <td style="text-align:right;">20020</td>
  <td style="text-align:left;">±LHHook</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">1258</td>
  <td style="text-align:right;">0.00717721</td>
  <td style="text-align:right;">0.717721</td>
</tr>
<tr>
  <td style="text-align:right;">20022</td>
  <td style="text-align:left;">+LHHook</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">823</td>
  <td style="text-align:right;">0.00469542</td>
  <td style="text-align:right;">0.469542</td>
</tr>
<tr>
  <td style="text-align:right;">20200</td>
  <td style="text-align:left;">±RHStaple</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">745</td>
  <td style="text-align:right;">0.00425042</td>
  <td style="text-align:right;">0.425042</td>
</tr>
<tr>
  <td style="text-align:right;">20202</td>
  <td style="text-align:left;">+RHStaple</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">538</td>
  <td style="text-align:right;">0.00306943</td>
  <td style="text-align:right;">0.306943</td>
</tr>
<tr>
  <td style="text-align:right;">20220</td>
  <td style="text-align:left;">±RHHook</td>
  <td style="text-align:left;">Catalytic</td>
  <td style="text-align:right;">1907</td>
  <td style="text-align:right;">0.0108799</td>
  <td style="text-align:right;">1.08799</td>
</tr>
<tr>
  <td style="text-align:right;">20222</td>
  <td style="text-align:left;">20222</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">1159</td>
  <td style="text-align:right;">0.00661239</td>
  <td style="text-align:right;">0.661239</td>
</tr>
<tr>
  <td style="text-align:right;">22000</td>
  <td style="text-align:left;">-/+LHHook</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">3652</td>
  <td style="text-align:right;">0.0208356</td>
  <td style="text-align:right;">2.08356</td>
</tr>
<tr>
  <td style="text-align:right;">22002</td>
  <td style="text-align:left;">22002</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">2052</td>
  <td style="text-align:right;">0.0117072</td>
  <td style="text-align:right;">1.17072</td>
</tr>
<tr>
  <td style="text-align:right;">22020</td>
  <td style="text-align:left;">±LHStaple</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">1791</td>
  <td style="text-align:right;">0.0102181</td>
  <td style="text-align:right;">1.02181</td>
</tr>
<tr>
  <td style="text-align:right;">22022</td>
  <td style="text-align:left;">+LHStaple</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">579</td>
  <td style="text-align:right;">0.00330334</td>
  <td style="text-align:right;">0.330334</td>
</tr>
<tr>
  <td style="text-align:right;">22200</td>
  <td style="text-align:left;">-/+RHHook</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">8169</td>
  <td style="text-align:right;">0.0466062</td>
  <td style="text-align:right;">4.66062</td>
</tr>
<tr>
  <td style="text-align:right;">22202</td>
  <td style="text-align:left;">+RHHook</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">895</td>
  <td style="text-align:right;">0.0051062</td>
  <td style="text-align:right;">0.51062</td>
</tr>
<tr>
  <td style="text-align:right;">22220</td>
  <td style="text-align:left;">±RHSpiral</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">3581</td>
  <td style="text-align:right;">0.0204305</td>
  <td style="text-align:right;">2.04305</td>
</tr>
<tr>
  <td style="text-align:right;">22222</td>
  <td style="text-align:left;">+RHSpiral</td>
  <td style="text-align:left;">UNK</td>
  <td style="text-align:right;">8254</td>
  <td style="text-align:right;">0.0470912</td>
  <td style="text-align:right;">4.70912</td>
</tr>
</tbody>
</table>
</div>


                            <div id="DisulfideClassManager.__init__" class="classattr">
                                        <input id="DisulfideClassManager.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">DisulfideClassManager</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">loader</span>, </span><span class="param"><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span></span>)</span>

                <label class="view-source-button" for="DisulfideClassManager.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassManager.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassManager.__init__-88"><a href="#DisulfideClassManager.__init__-88"><span class="linenos"> 88</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loader</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassManager.__init__-89"><a href="#DisulfideClassManager.__init__-89"><span class="linenos"> 89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="DisulfideClassManager.__init__-90"><a href="#DisulfideClassManager.__init__-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideClassManager.__init__-91"><a href="#DisulfideClassManager.__init__-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_df</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClassManager.__init__-92"><a href="#DisulfideClassManager.__init__-92"><span class="linenos"> 92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_df</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClassManager.__init__-93"><a href="#DisulfideClassManager.__init__-93"><span class="linenos"> 93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DisulfideClassManager.__init__-94"><a href="#DisulfideClassManager.__init__-94"><span class="linenos"> 94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">consensus_binary_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClassManager.__init__-95"><a href="#DisulfideClassManager.__init__-95"><span class="linenos"> 95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">consensus_oct_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClassManager.__init__-96"><a href="#DisulfideClassManager.__init__-96"><span class="linenos"> 96</span></a>
</span><span id="DisulfideClassManager.__init__-97"><a href="#DisulfideClassManager.__init__-97"><span class="linenos"> 97</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClassManager.__init__-98"><a href="#DisulfideClassManager.__init__-98"><span class="linenos"> 98</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="DisulfideClassManager.__init__-99"><a href="#DisulfideClassManager.__init__-99"><span class="linenos"> 99</span></a>                <span class="s2">&quot;Loading binary consensus structure list from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">SS_CONSENSUS_BIN_FILE</span>
</span><span id="DisulfideClassManager.__init__-100"><a href="#DisulfideClassManager.__init__-100"><span class="linenos">100</span></a>            <span class="p">)</span>
</span><span id="DisulfideClassManager.__init__-101"><a href="#DisulfideClassManager.__init__-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">consensus_binary_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_consensus_file</span><span class="p">(</span><span class="n">octant</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="DisulfideClassManager.__init__-102"><a href="#DisulfideClassManager.__init__-102"><span class="linenos">102</span></a>
</span><span id="DisulfideClassManager.__init__-103"><a href="#DisulfideClassManager.__init__-103"><span class="linenos">103</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClassManager.__init__-104"><a href="#DisulfideClassManager.__init__-104"><span class="linenos">104</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="DisulfideClassManager.__init__-105"><a href="#DisulfideClassManager.__init__-105"><span class="linenos">105</span></a>                <span class="s2">&quot;Loading octant consensus structure list from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">SS_CONSENSUS_OCT_FILE</span>
</span><span id="DisulfideClassManager.__init__-106"><a href="#DisulfideClassManager.__init__-106"><span class="linenos">106</span></a>            <span class="p">)</span>
</span><span id="DisulfideClassManager.__init__-107"><a href="#DisulfideClassManager.__init__-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">consensus_oct_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_consensus_file</span><span class="p">(</span><span class="n">octant</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DisulfideClassManager.__init__-108"><a href="#DisulfideClassManager.__init__-108"><span class="linenos">108</span></a>
</span><span id="DisulfideClassManager.__init__-109"><a href="#DisulfideClassManager.__init__-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">build_classes</span><span class="p">(</span><span class="n">loader</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="DisulfideClassManager.verbose" class="classattr">
                                <div class="attr variable">
            <span class="name">verbose</span>

        
    </div>
    <a class="headerlink" href="#DisulfideClassManager.verbose"></a>
    
    

                            </div>
                            <div id="DisulfideClassManager.binaryclass_dict" class="classattr">
                                <div class="attr variable">
            <span class="name">binaryclass_dict</span>

        
    </div>
    <a class="headerlink" href="#DisulfideClassManager.binaryclass_dict"></a>
    
    

                            </div>
                            <div id="DisulfideClassManager.binaryclass_df" class="classattr">
                                <div class="attr variable">
            <span class="name">binaryclass_df</span>

        
    </div>
    <a class="headerlink" href="#DisulfideClassManager.binaryclass_df"></a>
    
    

                            </div>
                            <div id="DisulfideClassManager.eightclass_df" class="classattr">
                                <div class="attr variable">
            <span class="name">eightclass_df</span>

        
    </div>
    <a class="headerlink" href="#DisulfideClassManager.eightclass_df"></a>
    
    

                            </div>
                            <div id="DisulfideClassManager.eightclass_dict" class="classattr">
                                <div class="attr variable">
            <span class="name">eightclass_dict</span>

        
    </div>
    <a class="headerlink" href="#DisulfideClassManager.eightclass_dict"></a>
    
    

                            </div>
                            <div id="DisulfideClassManager.consensus_binary_list" class="classattr">
                                <div class="attr variable">
            <span class="name">consensus_binary_list</span>

        
    </div>
    <a class="headerlink" href="#DisulfideClassManager.consensus_binary_list"></a>
    
    

                            </div>
                            <div id="DisulfideClassManager.consensus_oct_list" class="classattr">
                                <div class="attr variable">
            <span class="name">consensus_oct_list</span>

        
    </div>
    <a class="headerlink" href="#DisulfideClassManager.consensus_oct_list"></a>
    
    

                            </div>
                            <div id="DisulfideClassManager.load_consensus_file" class="classattr">
                                        <input id="DisulfideClassManager.load_consensus_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_consensus_file</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">fpath</span><span class="o">=</span><span class="n">PosixPath</span><span class="p">(</span><span class="s1">&#39;/Users/egs/repos/proteusPy/proteusPy/data&#39;</span><span class="p">)</span>,</span><span class="param">	<span class="n">octant</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideClassManager.load_consensus_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassManager.load_consensus_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassManager.load_consensus_file-135"><a href="#DisulfideClassManager.load_consensus_file-135"><span class="linenos">135</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_consensus_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fpath</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">),</span> <span class="n">octant</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="DisulfideClassManager.load_consensus_file-136"><a href="#DisulfideClassManager.load_consensus_file-136"><span class="linenos">136</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Load the consensus file from the specified file.&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.load_consensus_file-137"><a href="#DisulfideClassManager.load_consensus_file-137"><span class="linenos">137</span></a>
</span><span id="DisulfideClassManager.load_consensus_file-138"><a href="#DisulfideClassManager.load_consensus_file-138"><span class="linenos">138</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DisulfideClassManager.load_consensus_file-139"><a href="#DisulfideClassManager.load_consensus_file-139"><span class="linenos">139</span></a>        <span class="k">if</span> <span class="n">octant</span><span class="p">:</span>
</span><span id="DisulfideClassManager.load_consensus_file-140"><a href="#DisulfideClassManager.load_consensus_file-140"><span class="linenos">140</span></a>            <span class="n">fname</span> <span class="o">=</span> <span class="n">fpath</span> <span class="o">/</span> <span class="n">SS_CONSENSUS_OCT_FILE</span>
</span><span id="DisulfideClassManager.load_consensus_file-141"><a href="#DisulfideClassManager.load_consensus_file-141"><span class="linenos">141</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideClassManager.load_consensus_file-142"><a href="#DisulfideClassManager.load_consensus_file-142"><span class="linenos">142</span></a>            <span class="n">fname</span> <span class="o">=</span> <span class="n">fpath</span> <span class="o">/</span> <span class="n">SS_CONSENSUS_BIN_FILE</span>
</span><span id="DisulfideClassManager.load_consensus_file-143"><a href="#DisulfideClassManager.load_consensus_file-143"><span class="linenos">143</span></a>
</span><span id="DisulfideClassManager.load_consensus_file-144"><a href="#DisulfideClassManager.load_consensus_file-144"><span class="linenos">144</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">fname</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="DisulfideClassManager.load_consensus_file-145"><a href="#DisulfideClassManager.load_consensus_file-145"><span class="linenos">145</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Cannot find file </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
</span><span id="DisulfideClassManager.load_consensus_file-146"><a href="#DisulfideClassManager.load_consensus_file-146"><span class="linenos">146</span></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot find file </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager.load_consensus_file-147"><a href="#DisulfideClassManager.load_consensus_file-147"><span class="linenos">147</span></a>
</span><span id="DisulfideClassManager.load_consensus_file-148"><a href="#DisulfideClassManager.load_consensus_file-148"><span class="linenos">148</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="DisulfideClassManager.load_consensus_file-149"><a href="#DisulfideClassManager.load_consensus_file-149"><span class="linenos">149</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="DisulfideClassManager.load_consensus_file-150"><a href="#DisulfideClassManager.load_consensus_file-150"><span class="linenos">150</span></a>        <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Load the consensus file from the specified file.</p>
</div>


                            </div>
                            <div id="DisulfideClassManager.build_class_df" class="classattr">
                                        <input id="DisulfideClassManager.build_class_df-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">build_class_df</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">class_df</span>, </span><span class="param"><span class="n">group_df</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideClassManager.build_class_df-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassManager.build_class_df"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassManager.build_class_df-152"><a href="#DisulfideClassManager.build_class_df-152"><span class="linenos">152</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build_class_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_df</span><span class="p">,</span> <span class="n">group_df</span><span class="p">):</span>
</span><span id="DisulfideClassManager.build_class_df-153"><a href="#DisulfideClassManager.build_class_df-153"><span class="linenos">153</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build a new DataFrame from the input DataFrames.&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.build_class_df-154"><a href="#DisulfideClassManager.build_class_df-154"><span class="linenos">154</span></a>        <span class="n">ss_id_col</span> <span class="o">=</span> <span class="n">group_df</span><span class="p">[</span><span class="s2">&quot;ss_id&quot;</span><span class="p">]</span>
</span><span id="DisulfideClassManager.build_class_df-155"><a href="#DisulfideClassManager.build_class_df-155"><span class="linenos">155</span></a>        <span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">class_df</span><span class="p">,</span> <span class="n">ss_id_col</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DisulfideClassManager.build_class_df-156"><a href="#DisulfideClassManager.build_class_df-156"><span class="linenos">156</span></a>        <span class="k">return</span> <span class="n">result_df</span>
</span></pre></div>


            <div class="docstring"><p>Build a new DataFrame from the input DataFrames.</p>
</div>


                            </div>
                            <div id="DisulfideClassManager.class_to_sslist" class="classattr">
                                        <input id="DisulfideClassManager.class_to_sslist-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">class_to_sslist</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">clsid</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">base</span><span class="o">=</span><span class="mi">8</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassManager.class_to_sslist-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassManager.class_to_sslist"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassManager.class_to_sslist-158"><a href="#DisulfideClassManager.class_to_sslist-158"><span class="linenos">158</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">class_to_sslist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clsid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_to_sslist-159"><a href="#DisulfideClassManager.class_to_sslist-159"><span class="linenos">159</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.class_to_sslist-160"><a href="#DisulfideClassManager.class_to_sslist-160"><span class="linenos">160</span></a><span class="sd">        Return the list of disulfides corresponding to the input `clsid`.</span>
</span><span id="DisulfideClassManager.class_to_sslist-161"><a href="#DisulfideClassManager.class_to_sslist-161"><span class="linenos">161</span></a><span class="sd">        This list is a list of disulfide identifiers, not the Disulfide objects themselves.</span>
</span><span id="DisulfideClassManager.class_to_sslist-162"><a href="#DisulfideClassManager.class_to_sslist-162"><span class="linenos">162</span></a>
</span><span id="DisulfideClassManager.class_to_sslist-163"><a href="#DisulfideClassManager.class_to_sslist-163"><span class="linenos">163</span></a><span class="sd">        :param clsid: The class name to extract. Must be a string</span>
</span><span id="DisulfideClassManager.class_to_sslist-164"><a href="#DisulfideClassManager.class_to_sslist-164"><span class="linenos">164</span></a><span class="sd">        in the format &#39;11111&#39; or &#39;11111b&#39; or &#39;11111o&#39;. The suffix &#39;b&#39; or &#39;o&#39; indicates</span>
</span><span id="DisulfideClassManager.class_to_sslist-165"><a href="#DisulfideClassManager.class_to_sslist-165"><span class="linenos">165</span></a><span class="sd">        binary or octant classes, respectively.</span>
</span><span id="DisulfideClassManager.class_to_sslist-166"><a href="#DisulfideClassManager.class_to_sslist-166"><span class="linenos">166</span></a><span class="sd">        :type clsid: str</span>
</span><span id="DisulfideClassManager.class_to_sslist-167"><a href="#DisulfideClassManager.class_to_sslist-167"><span class="linenos">167</span></a><span class="sd">        :param base: The base class to use, 2 or 8. Default is 8.</span>
</span><span id="DisulfideClassManager.class_to_sslist-168"><a href="#DisulfideClassManager.class_to_sslist-168"><span class="linenos">168</span></a><span class="sd">        :type base: int</span>
</span><span id="DisulfideClassManager.class_to_sslist-169"><a href="#DisulfideClassManager.class_to_sslist-169"><span class="linenos">169</span></a><span class="sd">        :param verbose: If True, display progress bars, by default False.</span>
</span><span id="DisulfideClassManager.class_to_sslist-170"><a href="#DisulfideClassManager.class_to_sslist-170"><span class="linenos">170</span></a><span class="sd">        :type verbose: bool</span>
</span><span id="DisulfideClassManager.class_to_sslist-171"><a href="#DisulfideClassManager.class_to_sslist-171"><span class="linenos">171</span></a><span class="sd">        :return: The list of disulfide bonds from the class. NB: this is the list</span>
</span><span id="DisulfideClassManager.class_to_sslist-172"><a href="#DisulfideClassManager.class_to_sslist-172"><span class="linenos">172</span></a><span class="sd">        of disulfide identifiers, not the Disulfide objects themselves.</span>
</span><span id="DisulfideClassManager.class_to_sslist-173"><a href="#DisulfideClassManager.class_to_sslist-173"><span class="linenos">173</span></a><span class="sd">        :rtype: DisulfideList</span>
</span><span id="DisulfideClassManager.class_to_sslist-174"><a href="#DisulfideClassManager.class_to_sslist-174"><span class="linenos">174</span></a><span class="sd">        :raises ValueError: If an invalid base value is provided.</span>
</span><span id="DisulfideClassManager.class_to_sslist-175"><a href="#DisulfideClassManager.class_to_sslist-175"><span class="linenos">175</span></a><span class="sd">        :raises KeyError: If the clsid is not found in the dictionary.</span>
</span><span id="DisulfideClassManager.class_to_sslist-176"><a href="#DisulfideClassManager.class_to_sslist-176"><span class="linenos">176</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.class_to_sslist-177"><a href="#DisulfideClassManager.class_to_sslist-177"><span class="linenos">177</span></a>        <span class="bp">cls</span> <span class="o">=</span> <span class="n">clsid</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</span><span id="DisulfideClassManager.class_to_sslist-178"><a href="#DisulfideClassManager.class_to_sslist-178"><span class="linenos">178</span></a>
</span><span id="DisulfideClassManager.class_to_sslist-179"><a href="#DisulfideClassManager.class_to_sslist-179"><span class="linenos">179</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">clsid</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="DisulfideClassManager.class_to_sslist-180"><a href="#DisulfideClassManager.class_to_sslist-180"><span class="linenos">180</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid class ID: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">clsid</span><span class="p">)</span>
</span><span id="DisulfideClassManager.class_to_sslist-181"><a href="#DisulfideClassManager.class_to_sslist-181"><span class="linenos">181</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="DisulfideClassManager.class_to_sslist-182"><a href="#DisulfideClassManager.class_to_sslist-182"><span class="linenos">182</span></a>
</span><span id="DisulfideClassManager.class_to_sslist-183"><a href="#DisulfideClassManager.class_to_sslist-183"><span class="linenos">183</span></a>        <span class="k">match</span> <span class="nb">len</span><span class="p">(</span><span class="n">clsid</span><span class="p">):</span>
</span><span id="DisulfideClassManager.class_to_sslist-184"><a href="#DisulfideClassManager.class_to_sslist-184"><span class="linenos">184</span></a>            <span class="k">case</span> <span class="mi">6</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_to_sslist-185"><a href="#DisulfideClassManager.class_to_sslist-185"><span class="linenos">185</span></a>                <span class="k">match</span> <span class="n">clsid</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="DisulfideClassManager.class_to_sslist-186"><a href="#DisulfideClassManager.class_to_sslist-186"><span class="linenos">186</span></a>                    <span class="k">case</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_to_sslist-187"><a href="#DisulfideClassManager.class_to_sslist-187"><span class="linenos">187</span></a>                        <span class="n">eightorbin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_dict</span>
</span><span id="DisulfideClassManager.class_to_sslist-188"><a href="#DisulfideClassManager.class_to_sslist-188"><span class="linenos">188</span></a>                    <span class="k">case</span> <span class="s2">&quot;o&quot;</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_to_sslist-189"><a href="#DisulfideClassManager.class_to_sslist-189"><span class="linenos">189</span></a>                        <span class="n">eightorbin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_dict</span>
</span><span id="DisulfideClassManager.class_to_sslist-190"><a href="#DisulfideClassManager.class_to_sslist-190"><span class="linenos">190</span></a>                    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_to_sslist-191"><a href="#DisulfideClassManager.class_to_sslist-191"><span class="linenos">191</span></a>                        <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid class ID suffix: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">clsid</span><span class="p">)</span>
</span><span id="DisulfideClassManager.class_to_sslist-192"><a href="#DisulfideClassManager.class_to_sslist-192"><span class="linenos">192</span></a>                        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="DisulfideClassManager.class_to_sslist-193"><a href="#DisulfideClassManager.class_to_sslist-193"><span class="linenos">193</span></a>
</span><span id="DisulfideClassManager.class_to_sslist-194"><a href="#DisulfideClassManager.class_to_sslist-194"><span class="linenos">194</span></a>            <span class="k">case</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_to_sslist-195"><a href="#DisulfideClassManager.class_to_sslist-195"><span class="linenos">195</span></a>                <span class="k">match</span> <span class="n">base</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_to_sslist-196"><a href="#DisulfideClassManager.class_to_sslist-196"><span class="linenos">196</span></a>                    <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_to_sslist-197"><a href="#DisulfideClassManager.class_to_sslist-197"><span class="linenos">197</span></a>                        <span class="n">eightorbin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_dict</span>
</span><span id="DisulfideClassManager.class_to_sslist-198"><a href="#DisulfideClassManager.class_to_sslist-198"><span class="linenos">198</span></a>                    <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_to_sslist-199"><a href="#DisulfideClassManager.class_to_sslist-199"><span class="linenos">199</span></a>                        <span class="n">eightorbin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_dict</span>
</span><span id="DisulfideClassManager.class_to_sslist-200"><a href="#DisulfideClassManager.class_to_sslist-200"><span class="linenos">200</span></a>                    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_to_sslist-201"><a href="#DisulfideClassManager.class_to_sslist-201"><span class="linenos">201</span></a>                        <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid base: </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideClassManager.class_to_sslist-202"><a href="#DisulfideClassManager.class_to_sslist-202"><span class="linenos">202</span></a>                        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="DisulfideClassManager.class_to_sslist-203"><a href="#DisulfideClassManager.class_to_sslist-203"><span class="linenos">203</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_to_sslist-204"><a href="#DisulfideClassManager.class_to_sslist-204"><span class="linenos">204</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid class ID length: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">clsid</span><span class="p">)</span>
</span><span id="DisulfideClassManager.class_to_sslist-205"><a href="#DisulfideClassManager.class_to_sslist-205"><span class="linenos">205</span></a>                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="DisulfideClassManager.class_to_sslist-206"><a href="#DisulfideClassManager.class_to_sslist-206"><span class="linenos">206</span></a>
</span><span id="DisulfideClassManager.class_to_sslist-207"><a href="#DisulfideClassManager.class_to_sslist-207"><span class="linenos">207</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_to_sslist-208"><a href="#DisulfideClassManager.class_to_sslist-208"><span class="linenos">208</span></a>            <span class="n">ss_ids</span> <span class="o">=</span> <span class="n">eightorbin</span><span class="p">[</span><span class="bp">cls</span><span class="p">]</span>
</span><span id="DisulfideClassManager.class_to_sslist-209"><a href="#DisulfideClassManager.class_to_sslist-209"><span class="linenos">209</span></a>
</span><span id="DisulfideClassManager.class_to_sslist-210"><a href="#DisulfideClassManager.class_to_sslist-210"><span class="linenos">210</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_to_sslist-211"><a href="#DisulfideClassManager.class_to_sslist-211"><span class="linenos">211</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Cannot find key </span><span class="si">%s</span><span class="s2"> in SSBond DB&quot;</span><span class="p">,</span> <span class="n">clsid</span><span class="p">)</span>
</span><span id="DisulfideClassManager.class_to_sslist-212"><a href="#DisulfideClassManager.class_to_sslist-212"><span class="linenos">212</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="DisulfideClassManager.class_to_sslist-213"><a href="#DisulfideClassManager.class_to_sslist-213"><span class="linenos">213</span></a>
</span><span id="DisulfideClassManager.class_to_sslist-214"><a href="#DisulfideClassManager.class_to_sslist-214"><span class="linenos">214</span></a>        <span class="k">return</span> <span class="n">ss_ids</span>
</span></pre></div>


            <div class="docstring"><p>Return the list of disulfides corresponding to the input <code>clsid</code>.
This list is a list of disulfide identifiers, not the Disulfide objects themselves.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>clsid</strong>:  The class name to extract. Must be a string
in the format '11111' or '11111b' or '11111o'. The suffix 'b' or 'o' indicates
binary or octant classes, respectively.</li>
<li><strong>base</strong>:  The base class to use, 2 or 8. Default is 8.</li>
<li><strong>verbose</strong>:  If True, display progress bars, by default False.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The list of disulfide bonds from the class. NB: this is the list
  of disulfide identifiers, not the Disulfide objects themselves.</p>
</blockquote>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>:  If an invalid base value is provided.</li>
<li><strong>KeyError</strong>:  If the clsid is not found in the dictionary.</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideClassManager.list_classes" class="classattr">
                                        <input id="DisulfideClassManager.list_classes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">list_classes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">base</span><span class="o">=</span><span class="mi">2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideClassManager.list_classes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassManager.list_classes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassManager.list_classes-216"><a href="#DisulfideClassManager.list_classes-216"><span class="linenos">216</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="DisulfideClassManager.list_classes-217"><a href="#DisulfideClassManager.list_classes-217"><span class="linenos">217</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.list_classes-218"><a href="#DisulfideClassManager.list_classes-218"><span class="linenos">218</span></a><span class="sd">        List the Disulfide structural classes.</span>
</span><span id="DisulfideClassManager.list_classes-219"><a href="#DisulfideClassManager.list_classes-219"><span class="linenos">219</span></a>
</span><span id="DisulfideClassManager.list_classes-220"><a href="#DisulfideClassManager.list_classes-220"><span class="linenos">220</span></a><span class="sd">        :param self: The instance of the DisulfideClassManager class.</span>
</span><span id="DisulfideClassManager.list_classes-221"><a href="#DisulfideClassManager.list_classes-221"><span class="linenos">221</span></a><span class="sd">        :type self: DisulfideClassManager</span>
</span><span id="DisulfideClassManager.list_classes-222"><a href="#DisulfideClassManager.list_classes-222"><span class="linenos">222</span></a><span class="sd">        :param base: The base class to use, 2 or 8.</span>
</span><span id="DisulfideClassManager.list_classes-223"><a href="#DisulfideClassManager.list_classes-223"><span class="linenos">223</span></a><span class="sd">        :type base: int</span>
</span><span id="DisulfideClassManager.list_classes-224"><a href="#DisulfideClassManager.list_classes-224"><span class="linenos">224</span></a><span class="sd">        :return: None</span>
</span><span id="DisulfideClassManager.list_classes-225"><a href="#DisulfideClassManager.list_classes-225"><span class="linenos">225</span></a><span class="sd">        :rtype: None</span>
</span><span id="DisulfideClassManager.list_classes-226"><a href="#DisulfideClassManager.list_classes-226"><span class="linenos">226</span></a><span class="sd">        :raises ValueError: If an invalid base value is provided.</span>
</span><span id="DisulfideClassManager.list_classes-227"><a href="#DisulfideClassManager.list_classes-227"><span class="linenos">227</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.list_classes-228"><a href="#DisulfideClassManager.list_classes-228"><span class="linenos">228</span></a>        <span class="k">match</span> <span class="n">base</span><span class="p">:</span>
</span><span id="DisulfideClassManager.list_classes-229"><a href="#DisulfideClassManager.list_classes-229"><span class="linenos">229</span></a>            <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="DisulfideClassManager.list_classes-230"><a href="#DisulfideClassManager.list_classes-230"><span class="linenos">230</span></a>                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_dict</span><span class="p">):</span>
</span><span id="DisulfideClassManager.list_classes-231"><a href="#DisulfideClassManager.list_classes-231"><span class="linenos">231</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class: |</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">|, |</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">|&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager.list_classes-232"><a href="#DisulfideClassManager.list_classes-232"><span class="linenos">232</span></a>            <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="DisulfideClassManager.list_classes-233"><a href="#DisulfideClassManager.list_classes-233"><span class="linenos">233</span></a>                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eightclass_dict</span><span class="p">):</span>
</span><span id="DisulfideClassManager.list_classes-234"><a href="#DisulfideClassManager.list_classes-234"><span class="linenos">234</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Class: |</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">|, |</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">|&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager.list_classes-235"><a href="#DisulfideClassManager.list_classes-235"><span class="linenos">235</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="DisulfideClassManager.list_classes-236"><a href="#DisulfideClassManager.list_classes-236"><span class="linenos">236</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be 2 or 8.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>List the Disulfide structural classes.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>self</strong>:  The instance of the DisulfideClassManager class.</li>
<li><strong>base</strong>:  The base class to use, 2 or 8.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>:  If an invalid base value is provided.</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideClassManager.concat_dataframes" class="classattr">
                                        <input id="DisulfideClassManager.concat_dataframes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">concat_dataframes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">df1</span>, </span><span class="param"><span class="n">df2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideClassManager.concat_dataframes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassManager.concat_dataframes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassManager.concat_dataframes-238"><a href="#DisulfideClassManager.concat_dataframes-238"><span class="linenos">238</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">concat_dataframes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">):</span>
</span><span id="DisulfideClassManager.concat_dataframes-239"><a href="#DisulfideClassManager.concat_dataframes-239"><span class="linenos">239</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.concat_dataframes-240"><a href="#DisulfideClassManager.concat_dataframes-240"><span class="linenos">240</span></a><span class="sd">        Concatenates columns from one data frame into the other</span>
</span><span id="DisulfideClassManager.concat_dataframes-241"><a href="#DisulfideClassManager.concat_dataframes-241"><span class="linenos">241</span></a><span class="sd">        and returns the new result.</span>
</span><span id="DisulfideClassManager.concat_dataframes-242"><a href="#DisulfideClassManager.concat_dataframes-242"><span class="linenos">242</span></a>
</span><span id="DisulfideClassManager.concat_dataframes-243"><a href="#DisulfideClassManager.concat_dataframes-243"><span class="linenos">243</span></a><span class="sd">        Parameters</span>
</span><span id="DisulfideClassManager.concat_dataframes-244"><a href="#DisulfideClassManager.concat_dataframes-244"><span class="linenos">244</span></a><span class="sd">        ----------</span>
</span><span id="DisulfideClassManager.concat_dataframes-245"><a href="#DisulfideClassManager.concat_dataframes-245"><span class="linenos">245</span></a><span class="sd">        df1 : pandas.DataFrame</span>
</span><span id="DisulfideClassManager.concat_dataframes-246"><a href="#DisulfideClassManager.concat_dataframes-246"><span class="linenos">246</span></a><span class="sd">            The first data frame.</span>
</span><span id="DisulfideClassManager.concat_dataframes-247"><a href="#DisulfideClassManager.concat_dataframes-247"><span class="linenos">247</span></a><span class="sd">        df2 : pandas.DataFrame</span>
</span><span id="DisulfideClassManager.concat_dataframes-248"><a href="#DisulfideClassManager.concat_dataframes-248"><span class="linenos">248</span></a><span class="sd">            The second data frame.</span>
</span><span id="DisulfideClassManager.concat_dataframes-249"><a href="#DisulfideClassManager.concat_dataframes-249"><span class="linenos">249</span></a>
</span><span id="DisulfideClassManager.concat_dataframes-250"><a href="#DisulfideClassManager.concat_dataframes-250"><span class="linenos">250</span></a><span class="sd">        Returns</span>
</span><span id="DisulfideClassManager.concat_dataframes-251"><a href="#DisulfideClassManager.concat_dataframes-251"><span class="linenos">251</span></a><span class="sd">        -------</span>
</span><span id="DisulfideClassManager.concat_dataframes-252"><a href="#DisulfideClassManager.concat_dataframes-252"><span class="linenos">252</span></a><span class="sd">        pandas.DataFrame</span>
</span><span id="DisulfideClassManager.concat_dataframes-253"><a href="#DisulfideClassManager.concat_dataframes-253"><span class="linenos">253</span></a><span class="sd">            The concatenated data frame.</span>
</span><span id="DisulfideClassManager.concat_dataframes-254"><a href="#DisulfideClassManager.concat_dataframes-254"><span class="linenos">254</span></a>
</span><span id="DisulfideClassManager.concat_dataframes-255"><a href="#DisulfideClassManager.concat_dataframes-255"><span class="linenos">255</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.concat_dataframes-256"><a href="#DisulfideClassManager.concat_dataframes-256"><span class="linenos">256</span></a>        <span class="c1"># Merge the data frames based on the &#39;SS_Classname&#39; column</span>
</span><span id="DisulfideClassManager.concat_dataframes-257"><a href="#DisulfideClassManager.concat_dataframes-257"><span class="linenos">257</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;class_id&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager.concat_dataframes-258"><a href="#DisulfideClassManager.concat_dataframes-258"><span class="linenos">258</span></a>
</span><span id="DisulfideClassManager.concat_dataframes-259"><a href="#DisulfideClassManager.concat_dataframes-259"><span class="linenos">259</span></a>        <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>Concatenates columns from one data frame into the other
and returns the new result.</p>

<h2 id="parameters">Parameters</h2>

<p>df1 : pandas.DataFrame
    The first data frame.
df2 : pandas.DataFrame
    The second data frame.</p>

<h2 id="returns">Returns</h2>

<p>pandas.DataFrame
    The concatenated data frame.</p>
</div>


                            </div>
                            <div id="DisulfideClassManager.binary_to_class" class="classattr">
                                        <input id="DisulfideClassManager.binary_to_class-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">binary_to_class</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">class_str</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span></span><span class="return-annotation">) -> <span class="nb">list</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassManager.binary_to_class-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassManager.binary_to_class"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassManager.binary_to_class-261"><a href="#DisulfideClassManager.binary_to_class-261"><span class="linenos">261</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">binary_to_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="DisulfideClassManager.binary_to_class-262"><a href="#DisulfideClassManager.binary_to_class-262"><span class="linenos">262</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.binary_to_class-263"><a href="#DisulfideClassManager.binary_to_class-263"><span class="linenos">263</span></a><span class="sd">        Convert a binary input string to a list of possible class strings based on the specified base.</span>
</span><span id="DisulfideClassManager.binary_to_class-264"><a href="#DisulfideClassManager.binary_to_class-264"><span class="linenos">264</span></a>
</span><span id="DisulfideClassManager.binary_to_class-265"><a href="#DisulfideClassManager.binary_to_class-265"><span class="linenos">265</span></a><span class="sd">        Returns a list of all possible combinations of ordinal sections of a unit circle</span>
</span><span id="DisulfideClassManager.binary_to_class-266"><a href="#DisulfideClassManager.binary_to_class-266"><span class="linenos">266</span></a><span class="sd">        divided into the specified number of equal segments, originating at 0 degrees, rotating counterclockwise,</span>
</span><span id="DisulfideClassManager.binary_to_class-267"><a href="#DisulfideClassManager.binary_to_class-267"><span class="linenos">267</span></a><span class="sd">        based on the sign of each angle in the input string.</span>
</span><span id="DisulfideClassManager.binary_to_class-268"><a href="#DisulfideClassManager.binary_to_class-268"><span class="linenos">268</span></a>
</span><span id="DisulfideClassManager.binary_to_class-269"><a href="#DisulfideClassManager.binary_to_class-269"><span class="linenos">269</span></a><span class="sd">        :param class_str: A string of length 5, where each character represents the sign</span>
</span><span id="DisulfideClassManager.binary_to_class-270"><a href="#DisulfideClassManager.binary_to_class-270"><span class="linenos">270</span></a><span class="sd">        of an angle in the range of -180-180 degrees.</span>
</span><span id="DisulfideClassManager.binary_to_class-271"><a href="#DisulfideClassManager.binary_to_class-271"><span class="linenos">271</span></a><span class="sd">        :type class_str: str</span>
</span><span id="DisulfideClassManager.binary_to_class-272"><a href="#DisulfideClassManager.binary_to_class-272"><span class="linenos">272</span></a><span class="sd">        :param base: The base class to use, 6 or 8.</span>
</span><span id="DisulfideClassManager.binary_to_class-273"><a href="#DisulfideClassManager.binary_to_class-273"><span class="linenos">273</span></a><span class="sd">        :type base: int</span>
</span><span id="DisulfideClassManager.binary_to_class-274"><a href="#DisulfideClassManager.binary_to_class-274"><span class="linenos">274</span></a><span class="sd">        :return: A list of strings of length 5, representing all possible class strings.</span>
</span><span id="DisulfideClassManager.binary_to_class-275"><a href="#DisulfideClassManager.binary_to_class-275"><span class="linenos">275</span></a><span class="sd">        :rtype: list</span>
</span><span id="DisulfideClassManager.binary_to_class-276"><a href="#DisulfideClassManager.binary_to_class-276"><span class="linenos">276</span></a><span class="sd">        :raises ValueError: If an invalid base value is provided.</span>
</span><span id="DisulfideClassManager.binary_to_class-277"><a href="#DisulfideClassManager.binary_to_class-277"><span class="linenos">277</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.binary_to_class-278"><a href="#DisulfideClassManager.binary_to_class-278"><span class="linenos">278</span></a>        <span class="k">match</span> <span class="n">base</span><span class="p">:</span>
</span><span id="DisulfideClassManager.binary_to_class-279"><a href="#DisulfideClassManager.binary_to_class-279"><span class="linenos">279</span></a>            <span class="k">case</span> <span class="mi">6</span><span class="p">:</span>
</span><span id="DisulfideClassManager.binary_to_class-280"><a href="#DisulfideClassManager.binary_to_class-280"><span class="linenos">280</span></a>                <span class="n">angle_maps</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;0&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">],</span> <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">]}</span>
</span><span id="DisulfideClassManager.binary_to_class-281"><a href="#DisulfideClassManager.binary_to_class-281"><span class="linenos">281</span></a>            <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="DisulfideClassManager.binary_to_class-282"><a href="#DisulfideClassManager.binary_to_class-282"><span class="linenos">282</span></a>                <span class="n">angle_maps</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;0&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">],</span> <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">]}</span>
</span><span id="DisulfideClassManager.binary_to_class-283"><a href="#DisulfideClassManager.binary_to_class-283"><span class="linenos">283</span></a>            <span class="k">case</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="DisulfideClassManager.binary_to_class-284"><a href="#DisulfideClassManager.binary_to_class-284"><span class="linenos">284</span></a>                <span class="n">angle_maps</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DisulfideClassManager.binary_to_class-285"><a href="#DisulfideClassManager.binary_to_class-285"><span class="linenos">285</span></a>                    <span class="s2">&quot;0&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="s2">&quot;9&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">],</span>
</span><span id="DisulfideClassManager.binary_to_class-286"><a href="#DisulfideClassManager.binary_to_class-286"><span class="linenos">286</span></a>                    <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">],</span>
</span><span id="DisulfideClassManager.binary_to_class-287"><a href="#DisulfideClassManager.binary_to_class-287"><span class="linenos">287</span></a>                <span class="p">}</span>
</span><span id="DisulfideClassManager.binary_to_class-288"><a href="#DisulfideClassManager.binary_to_class-288"><span class="linenos">288</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="DisulfideClassManager.binary_to_class-289"><a href="#DisulfideClassManager.binary_to_class-289"><span class="linenos">289</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base value. Must be 6, 8, or 10.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager.binary_to_class-290"><a href="#DisulfideClassManager.binary_to_class-290"><span class="linenos">290</span></a>
</span><span id="DisulfideClassManager.binary_to_class-291"><a href="#DisulfideClassManager.binary_to_class-291"><span class="linenos">291</span></a>        <span class="n">class_lists</span> <span class="o">=</span> <span class="p">[</span><span class="n">angle_maps</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">class_str</span><span class="p">]</span>
</span><span id="DisulfideClassManager.binary_to_class-292"><a href="#DisulfideClassManager.binary_to_class-292"><span class="linenos">292</span></a>        <span class="n">class_combinations</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">class_lists</span><span class="p">)</span>
</span><span id="DisulfideClassManager.binary_to_class-293"><a href="#DisulfideClassManager.binary_to_class-293"><span class="linenos">293</span></a>        <span class="n">class_strings</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">combination</span><span class="p">)</span> <span class="k">for</span> <span class="n">combination</span> <span class="ow">in</span> <span class="n">class_combinations</span><span class="p">]</span>
</span><span id="DisulfideClassManager.binary_to_class-294"><a href="#DisulfideClassManager.binary_to_class-294"><span class="linenos">294</span></a>        <span class="k">return</span> <span class="n">class_strings</span>
</span></pre></div>


            <div class="docstring"><p>Convert a binary input string to a list of possible class strings based on the specified base.</p>

<p>Returns a list of all possible combinations of ordinal sections of a unit circle
divided into the specified number of equal segments, originating at 0 degrees, rotating counterclockwise,
based on the sign of each angle in the input string.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>class_str</strong>:  A string of length 5, where each character represents the sign
of an angle in the range of -180-180 degrees.</li>
<li><strong>base</strong>:  The base class to use, 6 or 8.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A list of strings of length 5, representing all possible class strings.</p>
</blockquote>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>:  If an invalid base value is provided.</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideClassManager.build_classes" class="classattr">
                                        <input id="DisulfideClassManager.build_classes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">build_classes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">loader</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassManager.build_classes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassManager.build_classes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassManager.build_classes-296"><a href="#DisulfideClassManager.build_classes-296"><span class="linenos">296</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loader</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DisulfideClassManager.build_classes-297"><a href="#DisulfideClassManager.build_classes-297"><span class="linenos">297</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.build_classes-298"><a href="#DisulfideClassManager.build_classes-298"><span class="linenos">298</span></a><span class="sd">        Build the internal structures needed for the binary and octant disulfide structural classes</span>
</span><span id="DisulfideClassManager.build_classes-299"><a href="#DisulfideClassManager.build_classes-299"><span class="linenos">299</span></a><span class="sd">        based on dihedral angle rules.</span>
</span><span id="DisulfideClassManager.build_classes-300"><a href="#DisulfideClassManager.build_classes-300"><span class="linenos">300</span></a>
</span><span id="DisulfideClassManager.build_classes-301"><a href="#DisulfideClassManager.build_classes-301"><span class="linenos">301</span></a><span class="sd">        :param loader: The DisulfideLoader object containing the data.</span>
</span><span id="DisulfideClassManager.build_classes-302"><a href="#DisulfideClassManager.build_classes-302"><span class="linenos">302</span></a><span class="sd">        :type loader: DisulfideLoader</span>
</span><span id="DisulfideClassManager.build_classes-303"><a href="#DisulfideClassManager.build_classes-303"><span class="linenos">303</span></a><span class="sd">        :return: None</span>
</span><span id="DisulfideClassManager.build_classes-304"><a href="#DisulfideClassManager.build_classes-304"><span class="linenos">304</span></a><span class="sd">        :rtype: None</span>
</span><span id="DisulfideClassManager.build_classes-305"><a href="#DisulfideClassManager.build_classes-305"><span class="linenos">305</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.build_classes-306"><a href="#DisulfideClassManager.build_classes-306"><span class="linenos">306</span></a>
</span><span id="DisulfideClassManager.build_classes-307"><a href="#DisulfideClassManager.build_classes-307"><span class="linenos">307</span></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">proteusPy</span><span class="w"> </span><span class="kn">import</span> <span class="n">__version__</span>
</span><span id="DisulfideClassManager.build_classes-308"><a href="#DisulfideClassManager.build_classes-308"><span class="linenos">308</span></a>
</span><span id="DisulfideClassManager.build_classes-309"><a href="#DisulfideClassManager.build_classes-309"><span class="linenos">309</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">__version__</span>
</span><span id="DisulfideClassManager.build_classes-310"><a href="#DisulfideClassManager.build_classes-310"><span class="linenos">310</span></a>
</span><span id="DisulfideClassManager.build_classes-311"><a href="#DisulfideClassManager.build_classes-311"><span class="linenos">311</span></a>        <span class="n">tors_df</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">getTorsions</span><span class="p">()</span>
</span><span id="DisulfideClassManager.build_classes-312"><a href="#DisulfideClassManager.build_classes-312"><span class="linenos">312</span></a>
</span><span id="DisulfideClassManager.build_classes-313"><a href="#DisulfideClassManager.build_classes-313"><span class="linenos">313</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClassManager.build_classes-314"><a href="#DisulfideClassManager.build_classes-314"><span class="linenos">314</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating binary SS classes...&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager.build_classes-315"><a href="#DisulfideClassManager.build_classes-315"><span class="linenos">315</span></a>
</span><span id="DisulfideClassManager.build_classes-316"><a href="#DisulfideClassManager.build_classes-316"><span class="linenos">316</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_binary_classes</span><span class="p">(</span><span class="n">tors_df</span><span class="p">)</span>
</span><span id="DisulfideClassManager.build_classes-317"><a href="#DisulfideClassManager.build_classes-317"><span class="linenos">317</span></a>
</span><span id="DisulfideClassManager.build_classes-318"><a href="#DisulfideClassManager.build_classes-318"><span class="linenos">318</span></a>        <span class="n">class_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
</span><span id="DisulfideClassManager.build_classes-319"><a href="#DisulfideClassManager.build_classes-319"><span class="linenos">319</span></a>            <span class="n">StringIO</span><span class="p">(</span><span class="n">SS_CLASS_DEFINITIONS</span><span class="p">),</span>
</span><span id="DisulfideClassManager.build_classes-320"><a href="#DisulfideClassManager.build_classes-320"><span class="linenos">320</span></a>            <span class="n">dtype</span><span class="o">=</span><span class="p">{</span>
</span><span id="DisulfideClassManager.build_classes-321"><a href="#DisulfideClassManager.build_classes-321"><span class="linenos">321</span></a>                <span class="s2">&quot;class_id&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassManager.build_classes-322"><a href="#DisulfideClassManager.build_classes-322"><span class="linenos">322</span></a>                <span class="s2">&quot;FXN&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassManager.build_classes-323"><a href="#DisulfideClassManager.build_classes-323"><span class="linenos">323</span></a>                <span class="s2">&quot;SS_Classname&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="DisulfideClassManager.build_classes-324"><a href="#DisulfideClassManager.build_classes-324"><span class="linenos">324</span></a>            <span class="p">},</span>
</span><span id="DisulfideClassManager.build_classes-325"><a href="#DisulfideClassManager.build_classes-325"><span class="linenos">325</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassManager.build_classes-326"><a href="#DisulfideClassManager.build_classes-326"><span class="linenos">326</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s2">&quot;FXN&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="DisulfideClassManager.build_classes-327"><a href="#DisulfideClassManager.build_classes-327"><span class="linenos">327</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s2">&quot;SS_Classname&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="DisulfideClassManager.build_classes-328"><a href="#DisulfideClassManager.build_classes-328"><span class="linenos">328</span></a>        <span class="n">class_df</span><span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="DisulfideClassManager.build_classes-329"><a href="#DisulfideClassManager.build_classes-329"><span class="linenos">329</span></a>
</span><span id="DisulfideClassManager.build_classes-330"><a href="#DisulfideClassManager.build_classes-330"><span class="linenos">330</span></a>        <span class="n">merged</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">concat_dataframes</span><span class="p">(</span><span class="n">class_df</span><span class="p">,</span> <span class="n">grouped</span><span class="p">)</span>
</span><span id="DisulfideClassManager.build_classes-331"><a href="#DisulfideClassManager.build_classes-331"><span class="linenos">331</span></a>        <span class="n">merged</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
</span><span id="DisulfideClassManager.build_classes-332"><a href="#DisulfideClassManager.build_classes-332"><span class="linenos">332</span></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Idx&quot;</span><span class="p">,</span> <span class="s2">&quot;chi1_s&quot;</span><span class="p">,</span> <span class="s2">&quot;chi2_s&quot;</span><span class="p">,</span> <span class="s2">&quot;chi3_s&quot;</span><span class="p">,</span> <span class="s2">&quot;chi4_s&quot;</span><span class="p">,</span> <span class="s2">&quot;chi5_s&quot;</span><span class="p">],</span>
</span><span id="DisulfideClassManager.build_classes-333"><a href="#DisulfideClassManager.build_classes-333"><span class="linenos">333</span></a>            <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DisulfideClassManager.build_classes-334"><a href="#DisulfideClassManager.build_classes-334"><span class="linenos">334</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassManager.build_classes-335"><a href="#DisulfideClassManager.build_classes-335"><span class="linenos">335</span></a>
</span><span id="DisulfideClassManager.build_classes-336"><a href="#DisulfideClassManager.build_classes-336"><span class="linenos">336</span></a>        <span class="n">classdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">merged</span><span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">],</span> <span class="n">merged</span><span class="p">[</span><span class="s2">&quot;ss_id&quot;</span><span class="p">]))</span>
</span><span id="DisulfideClassManager.build_classes-337"><a href="#DisulfideClassManager.build_classes-337"><span class="linenos">337</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_dict</span> <span class="o">=</span> <span class="n">classdict</span>
</span><span id="DisulfideClassManager.build_classes-338"><a href="#DisulfideClassManager.build_classes-338"><span class="linenos">338</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_df</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DisulfideClassManager.build_classes-339"><a href="#DisulfideClassManager.build_classes-339"><span class="linenos">339</span></a>
</span><span id="DisulfideClassManager.build_classes-340"><a href="#DisulfideClassManager.build_classes-340"><span class="linenos">340</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClassManager.build_classes-341"><a href="#DisulfideClassManager.build_classes-341"><span class="linenos">341</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating eightfold SS classes...&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager.build_classes-342"><a href="#DisulfideClassManager.build_classes-342"><span class="linenos">342</span></a>
</span><span id="DisulfideClassManager.build_classes-343"><a href="#DisulfideClassManager.build_classes-343"><span class="linenos">343</span></a>        <span class="n">grouped_eightclass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_classes</span><span class="p">(</span><span class="n">tors_df</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</span><span id="DisulfideClassManager.build_classes-344"><a href="#DisulfideClassManager.build_classes-344"><span class="linenos">344</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_df</span> <span class="o">=</span> <span class="n">grouped_eightclass</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="DisulfideClassManager.build_classes-345"><a href="#DisulfideClassManager.build_classes-345"><span class="linenos">345</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="DisulfideClassManager.build_classes-346"><a href="#DisulfideClassManager.build_classes-346"><span class="linenos">346</span></a>            <span class="nb">zip</span><span class="p">(</span><span class="n">grouped_eightclass</span><span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">],</span> <span class="n">grouped_eightclass</span><span class="p">[</span><span class="s2">&quot;ss_id&quot;</span><span class="p">])</span>
</span><span id="DisulfideClassManager.build_classes-347"><a href="#DisulfideClassManager.build_classes-347"><span class="linenos">347</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassManager.build_classes-348"><a href="#DisulfideClassManager.build_classes-348"><span class="linenos">348</span></a>
</span><span id="DisulfideClassManager.build_classes-349"><a href="#DisulfideClassManager.build_classes-349"><span class="linenos">349</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="DisulfideClassManager.build_classes-350"><a href="#DisulfideClassManager.build_classes-350"><span class="linenos">350</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Initialization complete.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager.build_classes-351"><a href="#DisulfideClassManager.build_classes-351"><span class="linenos">351</span></a>
</span><span id="DisulfideClassManager.build_classes-352"><a href="#DisulfideClassManager.build_classes-352"><span class="linenos">352</span></a>        <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>Build the internal structures needed for the binary and octant disulfide structural classes
based on dihedral angle rules.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>loader</strong>:  The DisulfideLoader object containing the data.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideClassManager.create_binary_classes" class="classattr">
                                        <input id="DisulfideClassManager.create_binary_classes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_binary_classes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">df</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassManager.create_binary_classes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassManager.create_binary_classes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassManager.create_binary_classes-354"><a href="#DisulfideClassManager.create_binary_classes-354"><span class="linenos">354</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_binary_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="DisulfideClassManager.create_binary_classes-355"><a href="#DisulfideClassManager.create_binary_classes-355"><span class="linenos">355</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.create_binary_classes-356"><a href="#DisulfideClassManager.create_binary_classes-356"><span class="linenos">356</span></a><span class="sd">        Group the DataFrame by the sign of the chi columns and create a new class ID column for each unique grouping.</span>
</span><span id="DisulfideClassManager.create_binary_classes-357"><a href="#DisulfideClassManager.create_binary_classes-357"><span class="linenos">357</span></a>
</span><span id="DisulfideClassManager.create_binary_classes-358"><a href="#DisulfideClassManager.create_binary_classes-358"><span class="linenos">358</span></a><span class="sd">        :param df: A pandas DataFrame containing columns &#39;ss_id&#39;, &#39;chi1&#39;, &#39;chi2&#39;, &#39;chi3&#39;, &#39;chi4&#39;, &#39;chi5&#39;, &#39;ca_distance&#39;,</span>
</span><span id="DisulfideClassManager.create_binary_classes-359"><a href="#DisulfideClassManager.create_binary_classes-359"><span class="linenos">359</span></a><span class="sd">        &#39;cb_distance&#39;, &#39;torsion_length&#39;, and &#39;energy&#39;.</span>
</span><span id="DisulfideClassManager.create_binary_classes-360"><a href="#DisulfideClassManager.create_binary_classes-360"><span class="linenos">360</span></a><span class="sd">        :return: A pandas DataFrame containing columns &#39;class_id&#39;, &#39;ss_id&#39;, and &#39;count&#39;, where &#39;class_id&#39;</span>
</span><span id="DisulfideClassManager.create_binary_classes-361"><a href="#DisulfideClassManager.create_binary_classes-361"><span class="linenos">361</span></a><span class="sd">         is a unique identifier for each grouping of chi signs, &#39;ss_id&#39; is a list of all &#39;ss_id&#39; values in that</span>
</span><span id="DisulfideClassManager.create_binary_classes-362"><a href="#DisulfideClassManager.create_binary_classes-362"><span class="linenos">362</span></a><span class="sd">         grouping, and &#39;count&#39; is the number of rows in that grouping.</span>
</span><span id="DisulfideClassManager.create_binary_classes-363"><a href="#DisulfideClassManager.create_binary_classes-363"><span class="linenos">363</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.create_binary_classes-364"><a href="#DisulfideClassManager.create_binary_classes-364"><span class="linenos">364</span></a>        <span class="c1"># Create new columns with the sign of each chi column</span>
</span><span id="DisulfideClassManager.create_binary_classes-365"><a href="#DisulfideClassManager.create_binary_classes-365"><span class="linenos">365</span></a>        <span class="n">chi_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;chi1&quot;</span><span class="p">,</span> <span class="s2">&quot;chi2&quot;</span><span class="p">,</span> <span class="s2">&quot;chi3&quot;</span><span class="p">,</span> <span class="s2">&quot;chi4&quot;</span><span class="p">,</span> <span class="s2">&quot;chi5&quot;</span><span class="p">]</span>
</span><span id="DisulfideClassManager.create_binary_classes-366"><a href="#DisulfideClassManager.create_binary_classes-366"><span class="linenos">366</span></a>        <span class="n">sign_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="o">+</span> <span class="s2">&quot;_s&quot;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">chi_columns</span><span class="p">]</span>
</span><span id="DisulfideClassManager.create_binary_classes-367"><a href="#DisulfideClassManager.create_binary_classes-367"><span class="linenos">367</span></a>        <span class="n">df</span><span class="p">[</span><span class="n">sign_columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">chi_columns</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DisulfideClassManager.create_binary_classes-368"><a href="#DisulfideClassManager.create_binary_classes-368"><span class="linenos">368</span></a>
</span><span id="DisulfideClassManager.create_binary_classes-369"><a href="#DisulfideClassManager.create_binary_classes-369"><span class="linenos">369</span></a>        <span class="c1"># Create a new column with the class ID for each row</span>
</span><span id="DisulfideClassManager.create_binary_classes-370"><a href="#DisulfideClassManager.create_binary_classes-370"><span class="linenos">370</span></a>        <span class="n">class_id_column</span> <span class="o">=</span> <span class="s2">&quot;class_id&quot;</span>
</span><span id="DisulfideClassManager.create_binary_classes-371"><a href="#DisulfideClassManager.create_binary_classes-371"><span class="linenos">371</span></a>        <span class="n">df</span><span class="p">[</span><span class="n">class_id_column</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">sign_columns</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="DisulfideClassManager.create_binary_classes-372"><a href="#DisulfideClassManager.create_binary_classes-372"><span class="linenos">372</span></a>            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
</span><span id="DisulfideClassManager.create_binary_classes-373"><a href="#DisulfideClassManager.create_binary_classes-373"><span class="linenos">373</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassManager.create_binary_classes-374"><a href="#DisulfideClassManager.create_binary_classes-374"><span class="linenos">374</span></a>
</span><span id="DisulfideClassManager.create_binary_classes-375"><a href="#DisulfideClassManager.create_binary_classes-375"><span class="linenos">375</span></a>        <span class="c1"># Group the DataFrame by the class ID and return the grouped data</span>
</span><span id="DisulfideClassManager.create_binary_classes-376"><a href="#DisulfideClassManager.create_binary_classes-376"><span class="linenos">376</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">class_id_column</span><span class="p">)[</span><span class="s2">&quot;ss_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="DisulfideClassManager.create_binary_classes-377"><a href="#DisulfideClassManager.create_binary_classes-377"><span class="linenos">377</span></a>        <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;ss_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
</span><span id="DisulfideClassManager.create_binary_classes-378"><a href="#DisulfideClassManager.create_binary_classes-378"><span class="linenos">378</span></a>        <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;incidence&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="DisulfideClassManager.create_binary_classes-379"><a href="#DisulfideClassManager.create_binary_classes-379"><span class="linenos">379</span></a>        <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;percentage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;incidence&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="DisulfideClassManager.create_binary_classes-380"><a href="#DisulfideClassManager.create_binary_classes-380"><span class="linenos">380</span></a>
</span><span id="DisulfideClassManager.create_binary_classes-381"><a href="#DisulfideClassManager.create_binary_classes-381"><span class="linenos">381</span></a>        <span class="k">return</span> <span class="n">grouped</span>
</span></pre></div>


            <div class="docstring"><p>Group the DataFrame by the sign of the chi columns and create a new class ID column for each unique grouping.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>df</strong>:  A pandas DataFrame containing columns 'ss_id', 'chi1', 'chi2', 'chi3', 'chi4', 'chi5', 'ca_distance',
'cb_distance', 'torsion_length', and 'energy'.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A pandas DataFrame containing columns 'class_id', 'ss_id', and 'count', where 'class_id'
   is a unique identifier for each grouping of chi signs, 'ss_id' is a list of all 'ss_id' values in that
   grouping, and 'count' is the number of rows in that grouping.</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideClassManager.create_classes" class="classattr">
                                        <input id="DisulfideClassManager.create_classes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_classes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">df</span>, </span><span class="param"><span class="n">base</span><span class="o">=</span><span class="mi">8</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassManager.create_classes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassManager.create_classes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassManager.create_classes-383"><a href="#DisulfideClassManager.create_classes-383"><span class="linenos">383</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="DisulfideClassManager.create_classes-384"><a href="#DisulfideClassManager.create_classes-384"><span class="linenos">384</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.create_classes-385"><a href="#DisulfideClassManager.create_classes-385"><span class="linenos">385</span></a><span class="sd">        Create a new DataFrame with 8-class encoding for input &#39;chi&#39; values.</span>
</span><span id="DisulfideClassManager.create_classes-386"><a href="#DisulfideClassManager.create_classes-386"><span class="linenos">386</span></a>
</span><span id="DisulfideClassManager.create_classes-387"><a href="#DisulfideClassManager.create_classes-387"><span class="linenos">387</span></a><span class="sd">        The function takes a pandas DataFrame containing the following columns:</span>
</span><span id="DisulfideClassManager.create_classes-388"><a href="#DisulfideClassManager.create_classes-388"><span class="linenos">388</span></a><span class="sd">        &#39;ss_id&#39;, &#39;chi1&#39;, &#39;chi2&#39;, &#39;chi3&#39;, &#39;chi4&#39;, &#39;chi5&#39;, &#39;ca_distance&#39;, &#39;cb_distance&#39;,</span>
</span><span id="DisulfideClassManager.create_classes-389"><a href="#DisulfideClassManager.create_classes-389"><span class="linenos">389</span></a><span class="sd">        &#39;torsion_length&#39;, &#39;energy&#39;, and &#39;rho&#39;, and adds a class ID column based on the following rules:</span>
</span><span id="DisulfideClassManager.create_classes-390"><a href="#DisulfideClassManager.create_classes-390"><span class="linenos">390</span></a>
</span><span id="DisulfideClassManager.create_classes-391"><a href="#DisulfideClassManager.create_classes-391"><span class="linenos">391</span></a><span class="sd">        1. A new column named `class_id` is added, which is the concatenation of the individual class IDs per Chi.</span>
</span><span id="DisulfideClassManager.create_classes-392"><a href="#DisulfideClassManager.create_classes-392"><span class="linenos">392</span></a><span class="sd">        2. The DataFrame is grouped by the `class_id` column, and a new DataFrame is returned that shows the unique `ss_id` values for each group,</span>
</span><span id="DisulfideClassManager.create_classes-393"><a href="#DisulfideClassManager.create_classes-393"><span class="linenos">393</span></a><span class="sd">        the count of unique `ss_id` values, the incidence of each group as a proportion of the total DataFrame, and</span>
</span><span id="DisulfideClassManager.create_classes-394"><a href="#DisulfideClassManager.create_classes-394"><span class="linenos">394</span></a><span class="sd">        the percentage of incidence.</span>
</span><span id="DisulfideClassManager.create_classes-395"><a href="#DisulfideClassManager.create_classes-395"><span class="linenos">395</span></a>
</span><span id="DisulfideClassManager.create_classes-396"><a href="#DisulfideClassManager.create_classes-396"><span class="linenos">396</span></a><span class="sd">        :param df: A pandas DataFrame containing columns &#39;ss_id&#39;, &#39;chi1&#39;, &#39;chi2&#39;, &#39;chi3&#39;, &#39;chi4&#39;, &#39;chi5&#39;,</span>
</span><span id="DisulfideClassManager.create_classes-397"><a href="#DisulfideClassManager.create_classes-397"><span class="linenos">397</span></a><span class="sd">                &#39;ca_distance&#39;, &#39;cb_distance&#39;, &#39;torsion_length&#39;, &#39;energy&#39;, and &#39;rho&#39;</span>
</span><span id="DisulfideClassManager.create_classes-398"><a href="#DisulfideClassManager.create_classes-398"><span class="linenos">398</span></a><span class="sd">        :return: The grouped DataFrame with the added class column.</span>
</span><span id="DisulfideClassManager.create_classes-399"><a href="#DisulfideClassManager.create_classes-399"><span class="linenos">399</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.create_classes-400"><a href="#DisulfideClassManager.create_classes-400"><span class="linenos">400</span></a>
</span><span id="DisulfideClassManager.create_classes-401"><a href="#DisulfideClassManager.create_classes-401"><span class="linenos">401</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">]:</span>
</span><span id="DisulfideClassManager.create_classes-402"><a href="#DisulfideClassManager.create_classes-402"><span class="linenos">402</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Base must be either 2, 4, 6, 8, or 10&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager.create_classes-403"><a href="#DisulfideClassManager.create_classes-403"><span class="linenos">403</span></a>
</span><span id="DisulfideClassManager.create_classes-404"><a href="#DisulfideClassManager.create_classes-404"><span class="linenos">404</span></a>        <span class="c1"># Apply get_class_string function to each chi column based on the specified base</span>
</span><span id="DisulfideClassManager.create_classes-405"><a href="#DisulfideClassManager.create_classes-405"><span class="linenos">405</span></a>        <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;chi1&quot;</span><span class="p">,</span> <span class="s2">&quot;chi2&quot;</span><span class="p">,</span> <span class="s2">&quot;chi3&quot;</span><span class="p">,</span> <span class="s2">&quot;chi4&quot;</span><span class="p">,</span> <span class="s2">&quot;chi5&quot;</span><span class="p">]:</span>
</span><span id="DisulfideClassManager.create_classes-406"><a href="#DisulfideClassManager.create_classes-406"><span class="linenos">406</span></a>            <span class="n">df</span><span class="p">[</span><span class="n">col_name</span> <span class="o">+</span> <span class="s2">&quot;_t&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="DisulfideClassManager.create_classes-407"><a href="#DisulfideClassManager.create_classes-407"><span class="linenos">407</span></a>                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">DisulfideClassManager</span><span class="o">.</span><span class="n">get_class_string</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideClassManager.create_classes-408"><a href="#DisulfideClassManager.create_classes-408"><span class="linenos">408</span></a>            <span class="p">)</span>
</span><span id="DisulfideClassManager.create_classes-409"><a href="#DisulfideClassManager.create_classes-409"><span class="linenos">409</span></a>
</span><span id="DisulfideClassManager.create_classes-410"><a href="#DisulfideClassManager.create_classes-410"><span class="linenos">410</span></a>        <span class="c1"># Concatenate the transformed chi columns to create class_id</span>
</span><span id="DisulfideClassManager.create_classes-411"><a href="#DisulfideClassManager.create_classes-411"><span class="linenos">411</span></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;chi1_t&quot;</span><span class="p">,</span> <span class="s2">&quot;chi2_t&quot;</span><span class="p">,</span> <span class="s2">&quot;chi3_t&quot;</span><span class="p">,</span> <span class="s2">&quot;chi4_t&quot;</span><span class="p">,</span> <span class="s2">&quot;chi5_t&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
</span><span id="DisulfideClassManager.create_classes-412"><a href="#DisulfideClassManager.create_classes-412"><span class="linenos">412</span></a>            <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
</span><span id="DisulfideClassManager.create_classes-413"><a href="#DisulfideClassManager.create_classes-413"><span class="linenos">413</span></a>        <span class="p">)</span>
</span><span id="DisulfideClassManager.create_classes-414"><a href="#DisulfideClassManager.create_classes-414"><span class="linenos">414</span></a>
</span><span id="DisulfideClassManager.create_classes-415"><a href="#DisulfideClassManager.create_classes-415"><span class="linenos">415</span></a>        <span class="c1"># Group by class_id and aggregate required statistics</span>
</span><span id="DisulfideClassManager.create_classes-416"><a href="#DisulfideClassManager.create_classes-416"><span class="linenos">416</span></a>        <span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;class_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;ss_id&quot;</span><span class="p">:</span> <span class="s2">&quot;unique&quot;</span><span class="p">})</span>
</span><span id="DisulfideClassManager.create_classes-417"><a href="#DisulfideClassManager.create_classes-417"><span class="linenos">417</span></a>        <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;ss_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
</span><span id="DisulfideClassManager.create_classes-418"><a href="#DisulfideClassManager.create_classes-418"><span class="linenos">418</span></a>        <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;incidence&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="DisulfideClassManager.create_classes-419"><a href="#DisulfideClassManager.create_classes-419"><span class="linenos">419</span></a>        <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;percentage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;incidence&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
</span><span id="DisulfideClassManager.create_classes-420"><a href="#DisulfideClassManager.create_classes-420"><span class="linenos">420</span></a>
</span><span id="DisulfideClassManager.create_classes-421"><a href="#DisulfideClassManager.create_classes-421"><span class="linenos">421</span></a>        <span class="k">return</span> <span class="n">grouped</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Create a new DataFrame with 8-class encoding for input 'chi' values.</p>

<p>The function takes a pandas DataFrame containing the following columns:
'ss_id', 'chi1', 'chi2', 'chi3', 'chi4', 'chi5', 'ca_distance', 'cb_distance',
'torsion_length', 'energy', and 'rho', and adds a class ID column based on the following rules:</p>

<ol>
<li>A new column named <code>class_id</code> is added, which is the concatenation of the individual class IDs per Chi.</li>
<li>The DataFrame is grouped by the <code>class_id</code> column, and a new DataFrame is returned that shows the unique <code>ss_id</code> values for each group,
the count of unique <code>ss_id</code> values, the incidence of each group as a proportion of the total DataFrame, and
the percentage of incidence.</li>
</ol>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>df</strong>:  A pandas DataFrame containing columns 'ss_id', 'chi1', 'chi2', 'chi3', 'chi4', 'chi5',
'ca_distance', 'cb_distance', 'torsion_length', 'energy', and 'rho'</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The grouped DataFrame with the added class column.</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideClassManager.filter_class_by_percentage" class="classattr">
                                        <input id="DisulfideClassManager.filter_class_by_percentage-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_class_by_percentage</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassManager.filter_class_by_percentage-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassManager.filter_class_by_percentage"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassManager.filter_class_by_percentage-423"><a href="#DisulfideClassManager.filter_class_by_percentage-423"><span class="linenos">423</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">filter_class_by_percentage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="DisulfideClassManager.filter_class_by_percentage-424"><a href="#DisulfideClassManager.filter_class_by_percentage-424"><span class="linenos">424</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.filter_class_by_percentage-425"><a href="#DisulfideClassManager.filter_class_by_percentage-425"><span class="linenos">425</span></a><span class="sd">        Filter the specified class definitions by percentage.</span>
</span><span id="DisulfideClassManager.filter_class_by_percentage-426"><a href="#DisulfideClassManager.filter_class_by_percentage-426"><span class="linenos">426</span></a>
</span><span id="DisulfideClassManager.filter_class_by_percentage-427"><a href="#DisulfideClassManager.filter_class_by_percentage-427"><span class="linenos">427</span></a><span class="sd">        :param cutoff: A numeric value specifying the minimum percentage required for a row to be included in the output</span>
</span><span id="DisulfideClassManager.filter_class_by_percentage-428"><a href="#DisulfideClassManager.filter_class_by_percentage-428"><span class="linenos">428</span></a><span class="sd">        :param base: An optional integer specifying the class type to filter, defaults to 8</span>
</span><span id="DisulfideClassManager.filter_class_by_percentage-429"><a href="#DisulfideClassManager.filter_class_by_percentage-429"><span class="linenos">429</span></a><span class="sd">        :return: A new Pandas DataFrame containing only rows where the percentage is greater than or equal to the cutoff</span>
</span><span id="DisulfideClassManager.filter_class_by_percentage-430"><a href="#DisulfideClassManager.filter_class_by_percentage-430"><span class="linenos">430</span></a><span class="sd">        :rtype: pandas.DataFrame</span>
</span><span id="DisulfideClassManager.filter_class_by_percentage-431"><a href="#DisulfideClassManager.filter_class_by_percentage-431"><span class="linenos">431</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.filter_class_by_percentage-432"><a href="#DisulfideClassManager.filter_class_by_percentage-432"><span class="linenos">432</span></a>
</span><span id="DisulfideClassManager.filter_class_by_percentage-433"><a href="#DisulfideClassManager.filter_class_by_percentage-433"><span class="linenos">433</span></a>        <span class="k">match</span> <span class="n">base</span><span class="p">:</span>
</span><span id="DisulfideClassManager.filter_class_by_percentage-434"><a href="#DisulfideClassManager.filter_class_by_percentage-434"><span class="linenos">434</span></a>            <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="DisulfideClassManager.filter_class_by_percentage-435"><a href="#DisulfideClassManager.filter_class_by_percentage-435"><span class="linenos">435</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_df</span>
</span><span id="DisulfideClassManager.filter_class_by_percentage-436"><a href="#DisulfideClassManager.filter_class_by_percentage-436"><span class="linenos">436</span></a>            <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="DisulfideClassManager.filter_class_by_percentage-437"><a href="#DisulfideClassManager.filter_class_by_percentage-437"><span class="linenos">437</span></a>                <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_df</span>
</span><span id="DisulfideClassManager.filter_class_by_percentage-438"><a href="#DisulfideClassManager.filter_class_by_percentage-438"><span class="linenos">438</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="DisulfideClassManager.filter_class_by_percentage-439"><a href="#DisulfideClassManager.filter_class_by_percentage-439"><span class="linenos">439</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be 6 or 8.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager.filter_class_by_percentage-440"><a href="#DisulfideClassManager.filter_class_by_percentage-440"><span class="linenos">440</span></a>
</span><span id="DisulfideClassManager.filter_class_by_percentage-441"><a href="#DisulfideClassManager.filter_class_by_percentage-441"><span class="linenos">441</span></a>        <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;percentage&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">cutoff</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Filter the specified class definitions by percentage.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>cutoff</strong>:  A numeric value specifying the minimum percentage required for a row to be included in the output</li>
<li><strong>base</strong>:  An optional integer specifying the class type to filter, defaults to 8</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A new Pandas DataFrame containing only rows where the percentage is greater than or equal to the cutoff</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideClassManager.get_binary_quadrant" class="classattr">
                                        <input id="DisulfideClassManager.get_binary_quadrant-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_binary_quadrant</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">angle_deg</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassManager.get_binary_quadrant-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassManager.get_binary_quadrant"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassManager.get_binary_quadrant-443"><a href="#DisulfideClassManager.get_binary_quadrant-443"><span class="linenos">443</span></a>    <span class="nd">@staticmethod</span>
</span><span id="DisulfideClassManager.get_binary_quadrant-444"><a href="#DisulfideClassManager.get_binary_quadrant-444"><span class="linenos">444</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_binary_quadrant</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="DisulfideClassManager.get_binary_quadrant-445"><a href="#DisulfideClassManager.get_binary_quadrant-445"><span class="linenos">445</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.get_binary_quadrant-446"><a href="#DisulfideClassManager.get_binary_quadrant-446"><span class="linenos">446</span></a><span class="sd">        Return the binary quadrant in which an angle in degrees lies if the area is described by dividing a unit circle into 2 equal segments.</span>
</span><span id="DisulfideClassManager.get_binary_quadrant-447"><a href="#DisulfideClassManager.get_binary_quadrant-447"><span class="linenos">447</span></a>
</span><span id="DisulfideClassManager.get_binary_quadrant-448"><a href="#DisulfideClassManager.get_binary_quadrant-448"><span class="linenos">448</span></a><span class="sd">        :param angle_deg (float or array-like): The angle in degrees.</span>
</span><span id="DisulfideClassManager.get_binary_quadrant-449"><a href="#DisulfideClassManager.get_binary_quadrant-449"><span class="linenos">449</span></a>
</span><span id="DisulfideClassManager.get_binary_quadrant-450"><a href="#DisulfideClassManager.get_binary_quadrant-450"><span class="linenos">450</span></a><span class="sd">        Returns:</span>
</span><span id="DisulfideClassManager.get_binary_quadrant-451"><a href="#DisulfideClassManager.get_binary_quadrant-451"><span class="linenos">451</span></a><span class="sd">        :return str. The binary quadrant (0 or 2) that the angle belongs to.</span>
</span><span id="DisulfideClassManager.get_binary_quadrant-452"><a href="#DisulfideClassManager.get_binary_quadrant-452"><span class="linenos">452</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.get_binary_quadrant-453"><a href="#DisulfideClassManager.get_binary_quadrant-453"><span class="linenos">453</span></a>        <span class="n">angle_deg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="DisulfideClassManager.get_binary_quadrant-454"><a href="#DisulfideClassManager.get_binary_quadrant-454"><span class="linenos">454</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
</span><span id="DisulfideClassManager.get_binary_quadrant-455"><a href="#DisulfideClassManager.get_binary_quadrant-455"><span class="linenos">455</span></a>        <span class="p">)</span>  <span class="c1"># Normalize the angle to the range [0, 360)</span>
</span><span id="DisulfideClassManager.get_binary_quadrant-456"><a href="#DisulfideClassManager.get_binary_quadrant-456"><span class="linenos">456</span></a>
</span><span id="DisulfideClassManager.get_binary_quadrant-457"><a href="#DisulfideClassManager.get_binary_quadrant-457"><span class="linenos">457</span></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">):</span>
</span><span id="DisulfideClassManager.get_binary_quadrant-458"><a href="#DisulfideClassManager.get_binary_quadrant-458"><span class="linenos">458</span></a>            <span class="k">if</span> <span class="n">angle_deg</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">angle_deg</span> <span class="o">&lt;</span> <span class="mi">180</span><span class="p">:</span>
</span><span id="DisulfideClassManager.get_binary_quadrant-459"><a href="#DisulfideClassManager.get_binary_quadrant-459"><span class="linenos">459</span></a>                <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="DisulfideClassManager.get_binary_quadrant-460"><a href="#DisulfideClassManager.get_binary_quadrant-460"><span class="linenos">460</span></a>
</span><span id="DisulfideClassManager.get_binary_quadrant-461"><a href="#DisulfideClassManager.get_binary_quadrant-461"><span class="linenos">461</span></a>            <span class="k">if</span> <span class="n">angle_deg</span> <span class="o">&gt;=</span> <span class="mi">180</span> <span class="ow">and</span> <span class="n">angle_deg</span> <span class="o">&lt;</span> <span class="mi">360</span><span class="p">:</span>
</span><span id="DisulfideClassManager.get_binary_quadrant-462"><a href="#DisulfideClassManager.get_binary_quadrant-462"><span class="linenos">462</span></a>                <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DisulfideClassManager.get_binary_quadrant-463"><a href="#DisulfideClassManager.get_binary_quadrant-463"><span class="linenos">463</span></a>
</span><span id="DisulfideClassManager.get_binary_quadrant-464"><a href="#DisulfideClassManager.get_binary_quadrant-464"><span class="linenos">464</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="DisulfideClassManager.get_binary_quadrant-465"><a href="#DisulfideClassManager.get_binary_quadrant-465"><span class="linenos">465</span></a>                <span class="s2">&quot;Invalid angle value: angle must be in the range [-360, 360).&quot;</span>
</span><span id="DisulfideClassManager.get_binary_quadrant-466"><a href="#DisulfideClassManager.get_binary_quadrant-466"><span class="linenos">466</span></a>            <span class="p">)</span>
</span><span id="DisulfideClassManager.get_binary_quadrant-467"><a href="#DisulfideClassManager.get_binary_quadrant-467"><span class="linenos">467</span></a>
</span><span id="DisulfideClassManager.get_binary_quadrant-468"><a href="#DisulfideClassManager.get_binary_quadrant-468"><span class="linenos">468</span></a>        <span class="n">quadrants</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">angle_deg</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">angle_deg</span> <span class="o">&lt;</span> <span class="mi">180</span><span class="p">),</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager.get_binary_quadrant-469"><a href="#DisulfideClassManager.get_binary_quadrant-469"><span class="linenos">469</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">quadrants</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the binary quadrant in which an angle in degrees lies if the area is described by dividing a unit circle into 2 equal segments.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>angle_deg (float or array-like)</strong>:  The angle in degrees.</li>
</ul>

<p>Returns:
:return str. The binary quadrant (0 or 2) that the angle belongs to.</p>
</div>


                            </div>
                            <div id="DisulfideClassManager.get_sixth_quadrant" class="classattr">
                                        <input id="DisulfideClassManager.get_sixth_quadrant-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_sixth_quadrant</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">angle_deg</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassManager.get_sixth_quadrant-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassManager.get_sixth_quadrant"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassManager.get_sixth_quadrant-471"><a href="#DisulfideClassManager.get_sixth_quadrant-471"><span class="linenos">471</span></a>    <span class="nd">@staticmethod</span>
</span><span id="DisulfideClassManager.get_sixth_quadrant-472"><a href="#DisulfideClassManager.get_sixth_quadrant-472"><span class="linenos">472</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_sixth_quadrant</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="DisulfideClassManager.get_sixth_quadrant-473"><a href="#DisulfideClassManager.get_sixth_quadrant-473"><span class="linenos">473</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.get_sixth_quadrant-474"><a href="#DisulfideClassManager.get_sixth_quadrant-474"><span class="linenos">474</span></a><span class="sd">        Return the eighth quadrant in which an angle in degrees lies by dividing a unit circle into 8 equal segments.</span>
</span><span id="DisulfideClassManager.get_sixth_quadrant-475"><a href="#DisulfideClassManager.get_sixth_quadrant-475"><span class="linenos">475</span></a>
</span><span id="DisulfideClassManager.get_sixth_quadrant-476"><a href="#DisulfideClassManager.get_sixth_quadrant-476"><span class="linenos">476</span></a><span class="sd">        :param angle_deg: float or array-like</span>
</span><span id="DisulfideClassManager.get_sixth_quadrant-477"><a href="#DisulfideClassManager.get_sixth_quadrant-477"><span class="linenos">477</span></a><span class="sd">            The angle in degrees.</span>
</span><span id="DisulfideClassManager.get_sixth_quadrant-478"><a href="#DisulfideClassManager.get_sixth_quadrant-478"><span class="linenos">478</span></a><span class="sd">        :return: str</span>
</span><span id="DisulfideClassManager.get_sixth_quadrant-479"><a href="#DisulfideClassManager.get_sixth_quadrant-479"><span class="linenos">479</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.get_sixth_quadrant-480"><a href="#DisulfideClassManager.get_sixth_quadrant-480"><span class="linenos">480</span></a>        <span class="c1"># Normalize the angle to the range [0, 360)</span>
</span><span id="DisulfideClassManager.get_sixth_quadrant-481"><a href="#DisulfideClassManager.get_sixth_quadrant-481"><span class="linenos">481</span></a>        <span class="n">angle_deg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
</span><span id="DisulfideClassManager.get_sixth_quadrant-482"><a href="#DisulfideClassManager.get_sixth_quadrant-482"><span class="linenos">482</span></a>
</span><span id="DisulfideClassManager.get_sixth_quadrant-483"><a href="#DisulfideClassManager.get_sixth_quadrant-483"><span class="linenos">483</span></a>        <span class="c1"># Calculate quadrant: each quadrant spans 60 degrees.</span>
</span><span id="DisulfideClassManager.get_sixth_quadrant-484"><a href="#DisulfideClassManager.get_sixth_quadrant-484"><span class="linenos">484</span></a>        <span class="c1"># The quadrant is computed as: quadrant = 6 - floor(angle_deg / 60)</span>
</span><span id="DisulfideClassManager.get_sixth_quadrant-485"><a href="#DisulfideClassManager.get_sixth_quadrant-485"><span class="linenos">485</span></a>        <span class="n">quadrant</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">floor_divide</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="DisulfideClassManager.get_sixth_quadrant-486"><a href="#DisulfideClassManager.get_sixth_quadrant-486"><span class="linenos">486</span></a>
</span><span id="DisulfideClassManager.get_sixth_quadrant-487"><a href="#DisulfideClassManager.get_sixth_quadrant-487"><span class="linenos">487</span></a>        <span class="c1"># If the input was scalar (0-dim array), return a string.</span>
</span><span id="DisulfideClassManager.get_sixth_quadrant-488"><a href="#DisulfideClassManager.get_sixth_quadrant-488"><span class="linenos">488</span></a>        <span class="k">if</span> <span class="n">angle_deg</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DisulfideClassManager.get_sixth_quadrant-489"><a href="#DisulfideClassManager.get_sixth_quadrant-489"><span class="linenos">489</span></a>            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">quadrant</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</span><span id="DisulfideClassManager.get_sixth_quadrant-490"><a href="#DisulfideClassManager.get_sixth_quadrant-490"><span class="linenos">490</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideClassManager.get_sixth_quadrant-491"><a href="#DisulfideClassManager.get_sixth_quadrant-491"><span class="linenos">491</span></a>            <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">quadrant</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Return the eighth quadrant in which an angle in degrees lies by dividing a unit circle into 8 equal segments.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>angle_deg</strong>:  float or array-like
The angle in degrees.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>str</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideClassManager.get_eighth_quadrant" class="classattr">
                                        <input id="DisulfideClassManager.get_eighth_quadrant-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_eighth_quadrant</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">angle_deg</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassManager.get_eighth_quadrant-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassManager.get_eighth_quadrant"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassManager.get_eighth_quadrant-493"><a href="#DisulfideClassManager.get_eighth_quadrant-493"><span class="linenos">493</span></a>    <span class="nd">@staticmethod</span>
</span><span id="DisulfideClassManager.get_eighth_quadrant-494"><a href="#DisulfideClassManager.get_eighth_quadrant-494"><span class="linenos">494</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_eighth_quadrant</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="DisulfideClassManager.get_eighth_quadrant-495"><a href="#DisulfideClassManager.get_eighth_quadrant-495"><span class="linenos">495</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.get_eighth_quadrant-496"><a href="#DisulfideClassManager.get_eighth_quadrant-496"><span class="linenos">496</span></a><span class="sd">        Return the eighth quadrant in which an angle in degrees lies by dividing a unit circle into 8 equal segments.</span>
</span><span id="DisulfideClassManager.get_eighth_quadrant-497"><a href="#DisulfideClassManager.get_eighth_quadrant-497"><span class="linenos">497</span></a>
</span><span id="DisulfideClassManager.get_eighth_quadrant-498"><a href="#DisulfideClassManager.get_eighth_quadrant-498"><span class="linenos">498</span></a><span class="sd">        :param angle_deg: float or array-like</span>
</span><span id="DisulfideClassManager.get_eighth_quadrant-499"><a href="#DisulfideClassManager.get_eighth_quadrant-499"><span class="linenos">499</span></a><span class="sd">            The angle in degrees.</span>
</span><span id="DisulfideClassManager.get_eighth_quadrant-500"><a href="#DisulfideClassManager.get_eighth_quadrant-500"><span class="linenos">500</span></a><span class="sd">        :return: str</span>
</span><span id="DisulfideClassManager.get_eighth_quadrant-501"><a href="#DisulfideClassManager.get_eighth_quadrant-501"><span class="linenos">501</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.get_eighth_quadrant-502"><a href="#DisulfideClassManager.get_eighth_quadrant-502"><span class="linenos">502</span></a>
</span><span id="DisulfideClassManager.get_eighth_quadrant-503"><a href="#DisulfideClassManager.get_eighth_quadrant-503"><span class="linenos">503</span></a>        <span class="c1"># Normalize the angle to the range [0, 360)</span>
</span><span id="DisulfideClassManager.get_eighth_quadrant-504"><a href="#DisulfideClassManager.get_eighth_quadrant-504"><span class="linenos">504</span></a>        <span class="n">angle_deg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
</span><span id="DisulfideClassManager.get_eighth_quadrant-505"><a href="#DisulfideClassManager.get_eighth_quadrant-505"><span class="linenos">505</span></a>
</span><span id="DisulfideClassManager.get_eighth_quadrant-506"><a href="#DisulfideClassManager.get_eighth_quadrant-506"><span class="linenos">506</span></a>        <span class="c1"># Calculate quadrant: each quadrant spans 45 degrees.</span>
</span><span id="DisulfideClassManager.get_eighth_quadrant-507"><a href="#DisulfideClassManager.get_eighth_quadrant-507"><span class="linenos">507</span></a>        <span class="c1"># The quadrant is computed as: quadrant = 8 - floor(angle_deg / 45)</span>
</span><span id="DisulfideClassManager.get_eighth_quadrant-508"><a href="#DisulfideClassManager.get_eighth_quadrant-508"><span class="linenos">508</span></a>        <span class="n">quadrant</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">floor_divide</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="DisulfideClassManager.get_eighth_quadrant-509"><a href="#DisulfideClassManager.get_eighth_quadrant-509"><span class="linenos">509</span></a>
</span><span id="DisulfideClassManager.get_eighth_quadrant-510"><a href="#DisulfideClassManager.get_eighth_quadrant-510"><span class="linenos">510</span></a>        <span class="c1"># If the input was scalar (0-dim array), return a string.</span>
</span><span id="DisulfideClassManager.get_eighth_quadrant-511"><a href="#DisulfideClassManager.get_eighth_quadrant-511"><span class="linenos">511</span></a>        <span class="k">if</span> <span class="n">angle_deg</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DisulfideClassManager.get_eighth_quadrant-512"><a href="#DisulfideClassManager.get_eighth_quadrant-512"><span class="linenos">512</span></a>            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">quadrant</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</span><span id="DisulfideClassManager.get_eighth_quadrant-513"><a href="#DisulfideClassManager.get_eighth_quadrant-513"><span class="linenos">513</span></a>
</span><span id="DisulfideClassManager.get_eighth_quadrant-514"><a href="#DisulfideClassManager.get_eighth_quadrant-514"><span class="linenos">514</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">quadrant</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Return the eighth quadrant in which an angle in degrees lies by dividing a unit circle into 8 equal segments.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>angle_deg</strong>:  float or array-like
The angle in degrees.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>str</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideClassManager.get_class_string" class="classattr">
                                        <input id="DisulfideClassManager.get_class_string-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_class_string</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="n">base</span><span class="o">=</span><span class="mi">8</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassManager.get_class_string-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassManager.get_class_string"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassManager.get_class_string-516"><a href="#DisulfideClassManager.get_class_string-516"><span class="linenos">516</span></a>    <span class="nd">@staticmethod</span>
</span><span id="DisulfideClassManager.get_class_string-517"><a href="#DisulfideClassManager.get_class_string-517"><span class="linenos">517</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_class_string</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="DisulfideClassManager.get_class_string-518"><a href="#DisulfideClassManager.get_class_string-518"><span class="linenos">518</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.get_class_string-519"><a href="#DisulfideClassManager.get_class_string-519"><span class="linenos">519</span></a><span class="sd">        Return the segment corresponding to an angle in degrees when the circle is divided into</span>
</span><span id="DisulfideClassManager.get_class_string-520"><a href="#DisulfideClassManager.get_class_string-520"><span class="linenos">520</span></a><span class="sd">        a specified number of equal segments. The segments are labeled in descending order, so that:</span>
</span><span id="DisulfideClassManager.get_class_string-521"><a href="#DisulfideClassManager.get_class_string-521"><span class="linenos">521</span></a>
</span><span id="DisulfideClassManager.get_class_string-522"><a href="#DisulfideClassManager.get_class_string-522"><span class="linenos">522</span></a><span class="sd">            - For base=8, an angle in [0, 45) degrees returns &quot;8&quot;,</span>
</span><span id="DisulfideClassManager.get_class_string-523"><a href="#DisulfideClassManager.get_class_string-523"><span class="linenos">523</span></a><span class="sd">            an angle in [45, 90) returns &quot;7&quot;, ...,</span>
</span><span id="DisulfideClassManager.get_class_string-524"><a href="#DisulfideClassManager.get_class_string-524"><span class="linenos">524</span></a><span class="sd">            and an angle in [315, 360) returns &quot;1&quot;.</span>
</span><span id="DisulfideClassManager.get_class_string-525"><a href="#DisulfideClassManager.get_class_string-525"><span class="linenos">525</span></a>
</span><span id="DisulfideClassManager.get_class_string-526"><a href="#DisulfideClassManager.get_class_string-526"><span class="linenos">526</span></a><span class="sd">        :param angle_deg: The angle in degrees. Single or array-like with length 5.</span>
</span><span id="DisulfideClassManager.get_class_string-527"><a href="#DisulfideClassManager.get_class_string-527"><span class="linenos">527</span></a><span class="sd">        :type angle_deg: float or array-like</span>
</span><span id="DisulfideClassManager.get_class_string-528"><a href="#DisulfideClassManager.get_class_string-528"><span class="linenos">528</span></a><span class="sd">        :param base: The number of segments (default is 8). For example, with base=8 each segment spans 45°,</span>
</span><span id="DisulfideClassManager.get_class_string-529"><a href="#DisulfideClassManager.get_class_string-529"><span class="linenos">529</span></a><span class="sd">        with base=12 each spans 30°, etc.</span>
</span><span id="DisulfideClassManager.get_class_string-530"><a href="#DisulfideClassManager.get_class_string-530"><span class="linenos">530</span></a><span class="sd">        :type base: int, optional, default=8, max=16, must be even.</span>
</span><span id="DisulfideClassManager.get_class_string-531"><a href="#DisulfideClassManager.get_class_string-531"><span class="linenos">531</span></a><span class="sd">        :return: The label corresponding to the segment in which the input angle lies. For scalar input,</span>
</span><span id="DisulfideClassManager.get_class_string-532"><a href="#DisulfideClassManager.get_class_string-532"><span class="linenos">532</span></a><span class="sd">                    a single string is returned; for array-like input, a NumPy array of strings is returned.</span>
</span><span id="DisulfideClassManager.get_class_string-533"><a href="#DisulfideClassManager.get_class_string-533"><span class="linenos">533</span></a><span class="sd">        :rtype: str</span>
</span><span id="DisulfideClassManager.get_class_string-534"><a href="#DisulfideClassManager.get_class_string-534"><span class="linenos">534</span></a><span class="sd">        :raises ValueError: If the base is out of range.</span>
</span><span id="DisulfideClassManager.get_class_string-535"><a href="#DisulfideClassManager.get_class_string-535"><span class="linenos">535</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.get_class_string-536"><a href="#DisulfideClassManager.get_class_string-536"><span class="linenos">536</span></a>        <span class="c1"># Character map for the segment labels, technically up to base 36.</span>
</span><span id="DisulfideClassManager.get_class_string-537"><a href="#DisulfideClassManager.get_class_string-537"><span class="linenos">537</span></a>        <span class="n">char_map</span> <span class="o">=</span> <span class="s2">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>
</span><span id="DisulfideClassManager.get_class_string-538"><a href="#DisulfideClassManager.get_class_string-538"><span class="linenos">538</span></a>        <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</span><span id="DisulfideClassManager.get_class_string-539"><a href="#DisulfideClassManager.get_class_string-539"><span class="linenos">539</span></a>
</span><span id="DisulfideClassManager.get_class_string-540"><a href="#DisulfideClassManager.get_class_string-540"><span class="linenos">540</span></a>        <span class="c1"># Normalize the angle to [0, 360)</span>
</span><span id="DisulfideClassManager.get_class_string-541"><a href="#DisulfideClassManager.get_class_string-541"><span class="linenos">541</span></a>        <span class="n">angle_deg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
</span><span id="DisulfideClassManager.get_class_string-542"><a href="#DisulfideClassManager.get_class_string-542"><span class="linenos">542</span></a>
</span><span id="DisulfideClassManager.get_class_string-543"><a href="#DisulfideClassManager.get_class_string-543"><span class="linenos">543</span></a>        <span class="c1"># Each segment spans 360/base degrees.</span>
</span><span id="DisulfideClassManager.get_class_string-544"><a href="#DisulfideClassManager.get_class_string-544"><span class="linenos">544</span></a>        <span class="n">segment_size</span> <span class="o">=</span> <span class="mi">360</span> <span class="o">/</span> <span class="n">base</span>
</span><span id="DisulfideClassManager.get_class_string-545"><a href="#DisulfideClassManager.get_class_string-545"><span class="linenos">545</span></a>
</span><span id="DisulfideClassManager.get_class_string-546"><a href="#DisulfideClassManager.get_class_string-546"><span class="linenos">546</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]:</span>
</span><span id="DisulfideClassManager.get_class_string-547"><a href="#DisulfideClassManager.get_class_string-547"><span class="linenos">547</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You must enter either 1 or 5 dihedral angles.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager.get_class_string-548"><a href="#DisulfideClassManager.get_class_string-548"><span class="linenos">548</span></a>
</span><span id="DisulfideClassManager.get_class_string-549"><a href="#DisulfideClassManager.get_class_string-549"><span class="linenos">549</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="o">&gt;</span> <span class="mi">16</span> <span class="ow">or</span> <span class="n">base</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">base</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DisulfideClassManager.get_class_string-550"><a href="#DisulfideClassManager.get_class_string-550"><span class="linenos">550</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be even and between 2 and 16.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager.get_class_string-551"><a href="#DisulfideClassManager.get_class_string-551"><span class="linenos">551</span></a>
</span><span id="DisulfideClassManager.get_class_string-552"><a href="#DisulfideClassManager.get_class_string-552"><span class="linenos">552</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="DisulfideClassManager.get_class_string-553"><a href="#DisulfideClassManager.get_class_string-553"><span class="linenos">553</span></a>            <span class="k">return</span> <span class="n">DisulfideClassManager</span><span class="o">.</span><span class="n">get_binary_quadrant</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">)</span>
</span><span id="DisulfideClassManager.get_class_string-554"><a href="#DisulfideClassManager.get_class_string-554"><span class="linenos">554</span></a>
</span><span id="DisulfideClassManager.get_class_string-555"><a href="#DisulfideClassManager.get_class_string-555"><span class="linenos">555</span></a>        <span class="c1"># Compute the segment number: subtract the segment index (via floor division) from base.</span>
</span><span id="DisulfideClassManager.get_class_string-556"><a href="#DisulfideClassManager.get_class_string-556"><span class="linenos">556</span></a>        <span class="n">segment</span> <span class="o">=</span> <span class="n">base</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">floor_divide</span><span class="p">(</span><span class="n">angle_deg</span><span class="p">,</span> <span class="n">segment_size</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="DisulfideClassManager.get_class_string-557"><a href="#DisulfideClassManager.get_class_string-557"><span class="linenos">557</span></a>
</span><span id="DisulfideClassManager.get_class_string-558"><a href="#DisulfideClassManager.get_class_string-558"><span class="linenos">558</span></a>        <span class="c1"># Return as string(s)</span>
</span><span id="DisulfideClassManager.get_class_string-559"><a href="#DisulfideClassManager.get_class_string-559"><span class="linenos">559</span></a>        <span class="k">if</span> <span class="n">angle_deg</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DisulfideClassManager.get_class_string-560"><a href="#DisulfideClassManager.get_class_string-560"><span class="linenos">560</span></a>            <span class="k">return</span> <span class="n">char_map</span><span class="p">[</span><span class="n">segment</span><span class="o">.</span><span class="n">item</span><span class="p">()]</span>
</span><span id="DisulfideClassManager.get_class_string-561"><a href="#DisulfideClassManager.get_class_string-561"><span class="linenos">561</span></a>
</span><span id="DisulfideClassManager.get_class_string-562"><a href="#DisulfideClassManager.get_class_string-562"><span class="linenos">562</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">char_map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">segment</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the segment corresponding to an angle in degrees when the circle is divided into
a specified number of equal segments. The segments are labeled in descending order, so that:</p>

<pre><code>- For base=8, an angle in [0, 45) degrees returns "8",
an angle in [45, 90) returns "7", ...,
and an angle in [315, 360) returns "1".
</code></pre>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>angle_deg</strong>:  The angle in degrees. Single or array-like with length 5.</li>
<li><strong>base</strong>:  The number of segments (default is 8). For example, with base=8 each segment spans 45°,
with base=12 each spans 30°, etc.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The label corresponding to the segment in which the input angle lies. For scalar input,
              a single string is returned; for array-like input, a NumPy array of strings is returned.</p>
</blockquote>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>:  If the base is out of range.</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideClassManager.class_string_from_dihedral" class="classattr">
                                        <input id="DisulfideClassManager.class_string_from_dihedral-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">class_string_from_dihedral</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="n">base</span><span class="o">=</span><span class="mi">8</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassManager.class_string_from_dihedral-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassManager.class_string_from_dihedral"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassManager.class_string_from_dihedral-564"><a href="#DisulfideClassManager.class_string_from_dihedral-564"><span class="linenos">564</span></a>    <span class="nd">@staticmethod</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-565"><a href="#DisulfideClassManager.class_string_from_dihedral-565"><span class="linenos">565</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">class_string_from_dihedral</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-566"><a href="#DisulfideClassManager.class_string_from_dihedral-566"><span class="linenos">566</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-567"><a href="#DisulfideClassManager.class_string_from_dihedral-567"><span class="linenos">567</span></a><span class="sd">        Return the class string for a set of dihedral angles, given the base.</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-568"><a href="#DisulfideClassManager.class_string_from_dihedral-568"><span class="linenos">568</span></a>
</span><span id="DisulfideClassManager.class_string_from_dihedral-569"><a href="#DisulfideClassManager.class_string_from_dihedral-569"><span class="linenos">569</span></a><span class="sd">        :param args: One or five dihedral angles.</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-570"><a href="#DisulfideClassManager.class_string_from_dihedral-570"><span class="linenos">570</span></a><span class="sd">        :type args: float or array-like</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-571"><a href="#DisulfideClassManager.class_string_from_dihedral-571"><span class="linenos">571</span></a><span class="sd">        :param base: The base class to use, 2, 6, or 8. Defaults to 8.</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-572"><a href="#DisulfideClassManager.class_string_from_dihedral-572"><span class="linenos">572</span></a><span class="sd">        :type base: int, optional</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-573"><a href="#DisulfideClassManager.class_string_from_dihedral-573"><span class="linenos">573</span></a><span class="sd">        :return: The class string for the input dihedral angles.</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-574"><a href="#DisulfideClassManager.class_string_from_dihedral-574"><span class="linenos">574</span></a><span class="sd">        :rtype: str</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-575"><a href="#DisulfideClassManager.class_string_from_dihedral-575"><span class="linenos">575</span></a><span class="sd">        :raises ValueError: If the number of dihedral angles is not 1 or 5, or if the base is not 2, 6, or 8.</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-576"><a href="#DisulfideClassManager.class_string_from_dihedral-576"><span class="linenos">576</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-577"><a href="#DisulfideClassManager.class_string_from_dihedral-577"><span class="linenos">577</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]:</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-578"><a href="#DisulfideClassManager.class_string_from_dihedral-578"><span class="linenos">578</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You must enter either 1 or 5 dihedral angles.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-579"><a href="#DisulfideClassManager.class_string_from_dihedral-579"><span class="linenos">579</span></a>
</span><span id="DisulfideClassManager.class_string_from_dihedral-580"><a href="#DisulfideClassManager.class_string_from_dihedral-580"><span class="linenos">580</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="o">&gt;</span> <span class="mi">16</span> <span class="ow">or</span> <span class="n">base</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">base</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-581"><a href="#DisulfideClassManager.class_string_from_dihedral-581"><span class="linenos">581</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be between 2 and 16, and even.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-582"><a href="#DisulfideClassManager.class_string_from_dihedral-582"><span class="linenos">582</span></a>
</span><span id="DisulfideClassManager.class_string_from_dihedral-583"><a href="#DisulfideClassManager.class_string_from_dihedral-583"><span class="linenos">583</span></a>        <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-584"><a href="#DisulfideClassManager.class_string_from_dihedral-584"><span class="linenos">584</span></a>
</span><span id="DisulfideClassManager.class_string_from_dihedral-585"><a href="#DisulfideClassManager.class_string_from_dihedral-585"><span class="linenos">585</span></a>        <span class="k">match</span> <span class="nb">len</span><span class="p">(</span><span class="n">angles</span><span class="p">):</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-586"><a href="#DisulfideClassManager.class_string_from_dihedral-586"><span class="linenos">586</span></a>            <span class="k">case</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-587"><a href="#DisulfideClassManager.class_string_from_dihedral-587"><span class="linenos">587</span></a>                <span class="k">return</span> <span class="n">DisulfideClassManager</span><span class="o">.</span><span class="n">get_class_string</span><span class="p">(</span><span class="n">angles</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-588"><a href="#DisulfideClassManager.class_string_from_dihedral-588"><span class="linenos">588</span></a>            <span class="k">case</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-589"><a href="#DisulfideClassManager.class_string_from_dihedral-589"><span class="linenos">589</span></a>                <span class="n">segments</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-590"><a href="#DisulfideClassManager.class_string_from_dihedral-590"><span class="linenos">590</span></a>                    <span class="n">DisulfideClassManager</span><span class="o">.</span><span class="n">get_class_string</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-591"><a href="#DisulfideClassManager.class_string_from_dihedral-591"><span class="linenos">591</span></a>                    <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">angles</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-592"><a href="#DisulfideClassManager.class_string_from_dihedral-592"><span class="linenos">592</span></a>                <span class="p">]</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-593"><a href="#DisulfideClassManager.class_string_from_dihedral-593"><span class="linenos">593</span></a>                <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-594"><a href="#DisulfideClassManager.class_string_from_dihedral-594"><span class="linenos">594</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_string_from_dihedral-595"><a href="#DisulfideClassManager.class_string_from_dihedral-595"><span class="linenos">595</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid number of angles. Must be 1 or 5.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the class string for a set of dihedral angles, given the base.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>args</strong>:  One or five dihedral angles.</li>
<li><strong>base</strong>:  The base class to use, 2, 6, or 8. Defaults to 8.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The class string for the input dihedral angles.</p>
</blockquote>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>:  If the number of dihedral angles is not 1 or 5, or if the base is not 2, 6, or 8.</li>
</ul>
</div>


                            </div>
                            <div id="DisulfideClassManager.sslist_from_classid" class="classattr">
                                        <input id="DisulfideClassManager.sslist_from_classid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sslist_from_classid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="bp">cls</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">base</span><span class="o">=</span><span class="mi">8</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>:</span></span>

                <label class="view-source-button" for="DisulfideClassManager.sslist_from_classid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassManager.sslist_from_classid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassManager.sslist_from_classid-597"><a href="#DisulfideClassManager.sslist_from_classid-597"><span class="linenos">597</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sslist_from_classid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="DisulfideClassManager.sslist_from_classid-598"><a href="#DisulfideClassManager.sslist_from_classid-598"><span class="linenos">598</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.sslist_from_classid-599"><a href="#DisulfideClassManager.sslist_from_classid-599"><span class="linenos">599</span></a><span class="sd">        Return the &#39;ss_id&#39; value in the given DataFrame that corresponds to the</span>
</span><span id="DisulfideClassManager.sslist_from_classid-600"><a href="#DisulfideClassManager.sslist_from_classid-600"><span class="linenos">600</span></a><span class="sd">        input &#39;cls&#39; string in the class description</span>
</span><span id="DisulfideClassManager.sslist_from_classid-601"><a href="#DisulfideClassManager.sslist_from_classid-601"><span class="linenos">601</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.sslist_from_classid-602"><a href="#DisulfideClassManager.sslist_from_classid-602"><span class="linenos">602</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="DisulfideClassManager.sslist_from_classid-603"><a href="#DisulfideClassManager.sslist_from_classid-603"><span class="linenos">603</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_df</span>
</span><span id="DisulfideClassManager.sslist_from_classid-604"><a href="#DisulfideClassManager.sslist_from_classid-604"><span class="linenos">604</span></a>        <span class="k">elif</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="DisulfideClassManager.sslist_from_classid-605"><a href="#DisulfideClassManager.sslist_from_classid-605"><span class="linenos">605</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_df</span>
</span><span id="DisulfideClassManager.sslist_from_classid-606"><a href="#DisulfideClassManager.sslist_from_classid-606"><span class="linenos">606</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DisulfideClassManager.sslist_from_classid-607"><a href="#DisulfideClassManager.sslist_from_classid-607"><span class="linenos">607</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be 2 or 8.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager.sslist_from_classid-608"><a href="#DisulfideClassManager.sslist_from_classid-608"><span class="linenos">608</span></a>
</span><span id="DisulfideClassManager.sslist_from_classid-609"><a href="#DisulfideClassManager.sslist_from_classid-609"><span class="linenos">609</span></a>        <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">cls</span><span class="p">]</span>
</span><span id="DisulfideClassManager.sslist_from_classid-610"><a href="#DisulfideClassManager.sslist_from_classid-610"><span class="linenos">610</span></a>
</span><span id="DisulfideClassManager.sslist_from_classid-611"><a href="#DisulfideClassManager.sslist_from_classid-611"><span class="linenos">611</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DisulfideClassManager.sslist_from_classid-612"><a href="#DisulfideClassManager.sslist_from_classid-612"><span class="linenos">612</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="DisulfideClassManager.sslist_from_classid-613"><a href="#DisulfideClassManager.sslist_from_classid-613"><span class="linenos">613</span></a>
</span><span id="DisulfideClassManager.sslist_from_classid-614"><a href="#DisulfideClassManager.sslist_from_classid-614"><span class="linenos">614</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="DisulfideClassManager.sslist_from_classid-615"><a href="#DisulfideClassManager.sslist_from_classid-615"><span class="linenos">615</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Multiple rows found for class_id &#39;</span><span class="si">{</span><span class="bp">cls</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager.sslist_from_classid-616"><a href="#DisulfideClassManager.sslist_from_classid-616"><span class="linenos">616</span></a>
</span><span id="DisulfideClassManager.sslist_from_classid-617"><a href="#DisulfideClassManager.sslist_from_classid-617"><span class="linenos">617</span></a>        <span class="k">return</span> <span class="n">filtered_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;ss_id&quot;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return the 'ss_id' value in the given DataFrame that corresponds to the
input 'cls' string in the class description</p>
</div>


                            </div>
                            <div id="DisulfideClassManager.class_to_binary" class="classattr">
                                        <input id="DisulfideClassManager.class_to_binary-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">class_to_binary</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">cls_str</span>, </span><span class="param"><span class="n">base</span><span class="o">=</span><span class="mi">8</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideClassManager.class_to_binary-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassManager.class_to_binary"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassManager.class_to_binary-619"><a href="#DisulfideClassManager.class_to_binary-619"><span class="linenos">619</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">class_to_binary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cls_str</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
</span><span id="DisulfideClassManager.class_to_binary-620"><a href="#DisulfideClassManager.class_to_binary-620"><span class="linenos">620</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.class_to_binary-621"><a href="#DisulfideClassManager.class_to_binary-621"><span class="linenos">621</span></a><span class="sd">        Return a string of length 5 representing the ordinal section of a unit circle for an angle in range -180-180 degrees</span>
</span><span id="DisulfideClassManager.class_to_binary-622"><a href="#DisulfideClassManager.class_to_binary-622"><span class="linenos">622</span></a><span class="sd">        into a string of 5 characters, where each character is either &#39;0&#39; if the corresponding input character represents a</span>
</span><span id="DisulfideClassManager.class_to_binary-623"><a href="#DisulfideClassManager.class_to_binary-623"><span class="linenos">623</span></a><span class="sd">        negative angle or &#39;2&#39; if it represents a positive angle.</span>
</span><span id="DisulfideClassManager.class_to_binary-624"><a href="#DisulfideClassManager.class_to_binary-624"><span class="linenos">624</span></a>
</span><span id="DisulfideClassManager.class_to_binary-625"><a href="#DisulfideClassManager.class_to_binary-625"><span class="linenos">625</span></a><span class="sd">        :param cls_str (str): A string of length 5 representing the ordinal section of a unit circle for an angle in range -180-180 degrees.</span>
</span><span id="DisulfideClassManager.class_to_binary-626"><a href="#DisulfideClassManager.class_to_binary-626"><span class="linenos">626</span></a><span class="sd">        :param base (int): The base of the ordinal section (6 or 8).</span>
</span><span id="DisulfideClassManager.class_to_binary-627"><a href="#DisulfideClassManager.class_to_binary-627"><span class="linenos">627</span></a><span class="sd">        :raises ValueError: If the base is not 6 or 8 or 10.</span>
</span><span id="DisulfideClassManager.class_to_binary-628"><a href="#DisulfideClassManager.class_to_binary-628"><span class="linenos">628</span></a><span class="sd">        :return str: A string of length 5, where each character is either &#39;0&#39; or &#39;2&#39;, representing the sign of the corresponding input angle.</span>
</span><span id="DisulfideClassManager.class_to_binary-629"><a href="#DisulfideClassManager.class_to_binary-629"><span class="linenos">629</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.class_to_binary-630"><a href="#DisulfideClassManager.class_to_binary-630"><span class="linenos">630</span></a>        <span class="k">if</span> <span class="n">base</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">]:</span>
</span><span id="DisulfideClassManager.class_to_binary-631"><a href="#DisulfideClassManager.class_to_binary-631"><span class="linenos">631</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Base must be either 6, 8, or 10&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager.class_to_binary-632"><a href="#DisulfideClassManager.class_to_binary-632"><span class="linenos">632</span></a>
</span><span id="DisulfideClassManager.class_to_binary-633"><a href="#DisulfideClassManager.class_to_binary-633"><span class="linenos">633</span></a>        <span class="n">output_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="DisulfideClassManager.class_to_binary-634"><a href="#DisulfideClassManager.class_to_binary-634"><span class="linenos">634</span></a>        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">cls_str</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_to_binary-635"><a href="#DisulfideClassManager.class_to_binary-635"><span class="linenos">635</span></a>            <span class="k">match</span> <span class="n">base</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_to_binary-636"><a href="#DisulfideClassManager.class_to_binary-636"><span class="linenos">636</span></a>                <span class="k">case</span> <span class="mi">6</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_to_binary-637"><a href="#DisulfideClassManager.class_to_binary-637"><span class="linenos">637</span></a>                    <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">]:</span>
</span><span id="DisulfideClassManager.class_to_binary-638"><a href="#DisulfideClassManager.class_to_binary-638"><span class="linenos">638</span></a>                        <span class="n">output_str</span> <span class="o">+=</span> <span class="s2">&quot;2&quot;</span>
</span><span id="DisulfideClassManager.class_to_binary-639"><a href="#DisulfideClassManager.class_to_binary-639"><span class="linenos">639</span></a>                    <span class="k">elif</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">]:</span>
</span><span id="DisulfideClassManager.class_to_binary-640"><a href="#DisulfideClassManager.class_to_binary-640"><span class="linenos">640</span></a>                        <span class="n">output_str</span> <span class="o">+=</span> <span class="s2">&quot;0&quot;</span>
</span><span id="DisulfideClassManager.class_to_binary-641"><a href="#DisulfideClassManager.class_to_binary-641"><span class="linenos">641</span></a>                <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_to_binary-642"><a href="#DisulfideClassManager.class_to_binary-642"><span class="linenos">642</span></a>                    <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">]:</span>
</span><span id="DisulfideClassManager.class_to_binary-643"><a href="#DisulfideClassManager.class_to_binary-643"><span class="linenos">643</span></a>                        <span class="n">output_str</span> <span class="o">+=</span> <span class="s2">&quot;2&quot;</span>
</span><span id="DisulfideClassManager.class_to_binary-644"><a href="#DisulfideClassManager.class_to_binary-644"><span class="linenos">644</span></a>                    <span class="k">elif</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">]:</span>
</span><span id="DisulfideClassManager.class_to_binary-645"><a href="#DisulfideClassManager.class_to_binary-645"><span class="linenos">645</span></a>                        <span class="n">output_str</span> <span class="o">+=</span> <span class="s2">&quot;0&quot;</span>
</span><span id="DisulfideClassManager.class_to_binary-646"><a href="#DisulfideClassManager.class_to_binary-646"><span class="linenos">646</span></a>                <span class="k">case</span> <span class="mi">10</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_to_binary-647"><a href="#DisulfideClassManager.class_to_binary-647"><span class="linenos">647</span></a>                    <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">]:</span>
</span><span id="DisulfideClassManager.class_to_binary-648"><a href="#DisulfideClassManager.class_to_binary-648"><span class="linenos">648</span></a>                        <span class="n">output_str</span> <span class="o">+=</span> <span class="s2">&quot;2&quot;</span>
</span><span id="DisulfideClassManager.class_to_binary-649"><a href="#DisulfideClassManager.class_to_binary-649"><span class="linenos">649</span></a>                    <span class="k">elif</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="s2">&quot;9&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">]:</span>
</span><span id="DisulfideClassManager.class_to_binary-650"><a href="#DisulfideClassManager.class_to_binary-650"><span class="linenos">650</span></a>                        <span class="n">output_str</span> <span class="o">+=</span> <span class="s2">&quot;0&quot;</span>
</span><span id="DisulfideClassManager.class_to_binary-651"><a href="#DisulfideClassManager.class_to_binary-651"><span class="linenos">651</span></a>                <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="DisulfideClassManager.class_to_binary-652"><a href="#DisulfideClassManager.class_to_binary-652"><span class="linenos">652</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be either 6, 8, or 10&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager.class_to_binary-653"><a href="#DisulfideClassManager.class_to_binary-653"><span class="linenos">653</span></a>        <span class="k">return</span> <span class="n">output_str</span>
</span></pre></div>


            <div class="docstring"><p>Return a string of length 5 representing the ordinal section of a unit circle for an angle in range -180-180 degrees
into a string of 5 characters, where each character is either '0' if the corresponding input character represents a
negative angle or '2' if it represents a positive angle.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>cls_str (str)</strong>:  A string of length 5 representing the ordinal section of a unit circle for an angle in range -180-180 degrees.</li>
<li><strong>base (int)</strong>:  The base of the ordinal section (6 or 8).</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>:  If the base is not 6 or 8 or 10.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A string of length 5, where each character is either '0' or '2', representing the sign of the corresponding input angle.</p>
</blockquote>
</div>


                            </div>
                            <div id="DisulfideClassManager.get_class_df" class="classattr">
                                        <input id="DisulfideClassManager.get_class_df-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_class_df</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">base</span><span class="o">=</span><span class="mi">8</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DisulfideClassManager.get_class_df-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DisulfideClassManager.get_class_df"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DisulfideClassManager.get_class_df-655"><a href="#DisulfideClassManager.get_class_df-655"><span class="linenos">655</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_class_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
</span><span id="DisulfideClassManager.get_class_df-656"><a href="#DisulfideClassManager.get_class_df-656"><span class="linenos">656</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.get_class_df-657"><a href="#DisulfideClassManager.get_class_df-657"><span class="linenos">657</span></a><span class="sd">        Get the Disulfide structural classes DataFrame.</span>
</span><span id="DisulfideClassManager.get_class_df-658"><a href="#DisulfideClassManager.get_class_df-658"><span class="linenos">658</span></a>
</span><span id="DisulfideClassManager.get_class_df-659"><a href="#DisulfideClassManager.get_class_df-659"><span class="linenos">659</span></a><span class="sd">        :param base: The base class to use, either 2 or 8. Defaults to 8.</span>
</span><span id="DisulfideClassManager.get_class_df-660"><a href="#DisulfideClassManager.get_class_df-660"><span class="linenos">660</span></a><span class="sd">        :type base: int</span>
</span><span id="DisulfideClassManager.get_class_df-661"><a href="#DisulfideClassManager.get_class_df-661"><span class="linenos">661</span></a><span class="sd">        :return: A DataFrame containing the class_id, count, incidence, and percentage columns.</span>
</span><span id="DisulfideClassManager.get_class_df-662"><a href="#DisulfideClassManager.get_class_df-662"><span class="linenos">662</span></a><span class="sd">        :rtype: pandas.DataFrame</span>
</span><span id="DisulfideClassManager.get_class_df-663"><a href="#DisulfideClassManager.get_class_df-663"><span class="linenos">663</span></a><span class="sd">        :raises ValueError: If the base is not 2 or 8.</span>
</span><span id="DisulfideClassManager.get_class_df-664"><a href="#DisulfideClassManager.get_class_df-664"><span class="linenos">664</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DisulfideClassManager.get_class_df-665"><a href="#DisulfideClassManager.get_class_df-665"><span class="linenos">665</span></a>        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;class_id&quot;</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="s2">&quot;incidence&quot;</span><span class="p">,</span> <span class="s2">&quot;percentage&quot;</span><span class="p">]</span>
</span><span id="DisulfideClassManager.get_class_df-666"><a href="#DisulfideClassManager.get_class_df-666"><span class="linenos">666</span></a>        <span class="k">match</span> <span class="n">base</span><span class="p">:</span>
</span><span id="DisulfideClassManager.get_class_df-667"><a href="#DisulfideClassManager.get_class_df-667"><span class="linenos">667</span></a>            <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="DisulfideClassManager.get_class_df-668"><a href="#DisulfideClassManager.get_class_df-668"><span class="linenos">668</span></a>                <span class="n">class_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binaryclass_df</span>
</span><span id="DisulfideClassManager.get_class_df-669"><a href="#DisulfideClassManager.get_class_df-669"><span class="linenos">669</span></a>            <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="DisulfideClassManager.get_class_df-670"><a href="#DisulfideClassManager.get_class_df-670"><span class="linenos">670</span></a>                <span class="n">class_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eightclass_df</span>
</span><span id="DisulfideClassManager.get_class_df-671"><a href="#DisulfideClassManager.get_class_df-671"><span class="linenos">671</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="DisulfideClassManager.get_class_df-672"><a href="#DisulfideClassManager.get_class_df-672"><span class="linenos">672</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid base. Must be 2, or 8.&quot;</span><span class="p">)</span>
</span><span id="DisulfideClassManager.get_class_df-673"><a href="#DisulfideClassManager.get_class_df-673"><span class="linenos">673</span></a>
</span><span id="DisulfideClassManager.get_class_df-674"><a href="#DisulfideClassManager.get_class_df-674"><span class="linenos">674</span></a>        <span class="n">result_df</span> <span class="o">=</span> <span class="n">class_df</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span>
</span><span id="DisulfideClassManager.get_class_df-675"><a href="#DisulfideClassManager.get_class_df-675"><span class="linenos">675</span></a>        <span class="k">return</span> <span class="n">result_df</span>
</span></pre></div>


            <div class="docstring"><p>Get the Disulfide structural classes DataFrame.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base</strong>:  The base class to use, either 2 or 8. Defaults to 8.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A DataFrame containing the class_id, count, incidence, and percentage columns.</p>
</blockquote>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>:  If the base is not 2 or 8.</li>
</ul>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>