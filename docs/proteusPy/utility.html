<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.6.0"/>
    <title>proteusPy.utility API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../proteusPy.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;proteusPy</a>

            <img src="./logo.png" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#PBAR_COLS">PBAR_COLS</a>
            </li>
            <li>
                    <a class="function" href="#distance_squared">distance_squared</a>
            </li>
            <li>
                    <a class="function" href="#get_jet_colormap">get_jet_colormap</a>
            </li>
            <li>
                    <a class="function" href="#grid_dimensions">grid_dimensions</a>
            </li>
            <li>
                    <a class="function" href="#extract_firstchain_ss">extract_firstchain_ss</a>
            </li>
            <li>
                    <a class="function" href="#prune_extra_ss">prune_extra_ss</a>
            </li>
            <li>
                    <a class="function" href="#download_file">download_file</a>
            </li>
            <li>
                    <a class="function" href="#get_memory_usage">get_memory_usage</a>
            </li>
            <li>
                    <a class="function" href="#get_object_size_mb">get_object_size_mb</a>
            </li>
            <li>
                    <a class="function" href="#print_memory_used">print_memory_used</a>
            </li>
            <li>
                    <a class="function" href="#image_to_ascii_art">image_to_ascii_art</a>
            </li>
            <li>
                    <a class="function" href="#generate_vector_dataframe">generate_vector_dataframe</a>
            </li>
            <li>
                    <a class="function" href="#sort_by_column">sort_by_column</a>
            </li>
            <li>
                    <a class="function" href="#plot_class_chart">plot_class_chart</a>
            </li>
            <li>
                    <a class="function" href="#retrieve_git_lfs_files">retrieve_git_lfs_files</a>
            </li>
            <li>
                    <a class="function" href="#display_ss_pymol">display_ss_pymol</a>
            </li>
            <li>
                    <a class="function" href="#parse_ssbond_header_rec">parse_ssbond_header_rec</a>
            </li>
            <li>
                    <a class="function" href="#Download_Disulfides">Download_Disulfides</a>
            </li>
            <li>
                    <a class="function" href="#remove_duplicate_ss">remove_duplicate_ss</a>
            </li>
            <li>
                    <a class="function" href="#Extract_Disulfides">Extract_Disulfides</a>
            </li>
            <li>
                    <a class="function" href="#Extract_Disulfides_From_List">Extract_Disulfides_From_List</a>
            </li>
            <li>
                    <a class="function" href="#Extract_Disulfide">Extract_Disulfide</a>
            </li>
            <li>
                    <a class="function" href="#get_macos_theme">get_macos_theme</a>
            </li>
            <li>
                    <a class="function" href="#create_deviation_dataframe">create_deviation_dataframe</a>
            </li>
            <li>
                    <a class="function" href="#calculate_std_cutoff">calculate_std_cutoff</a>
            </li>
            <li>
                    <a class="function" href="#calculate_percentile_cutoff">calculate_percentile_cutoff</a>
            </li>
            <li>
                    <a class="function" href="#filter_by_cutoffs">filter_by_cutoffs</a>
            </li>
            <li>
                    <a class="function" href="#bad_filter_by_cutoffs">bad_filter_by_cutoffs</a>
            </li>
            <li>
                    <a class="function" href="#save_list_to_file">save_list_to_file</a>
            </li>
            <li>
                    <a class="function" href="#load_list_from_file">load_list_from_file</a>
            </li>
            <li>
                    <a class="function" href="#set_logger_level_for_module">set_logger_level_for_module</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../proteusPy.html">proteusPy</a><wbr>.utility    </h1>

                        <div class="docstring"><p>Utility functions for the proteusPy package </p>

<p>Author: Eric G. Suchanek, PhD. </p>

<p>License: BSD</p>

<p>Copyright (c)2024 Eric G. Suchanek, PhD, all rights reserved</p>
</div>

                        <input id="mod-utility-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-utility-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="sd">Utility functions for the proteusPy package \n</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="sd">Author: Eric G. Suchanek, PhD. \n</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="sd">License: BSD\n</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="sd">Copyright (c)2024 Eric G. Suchanek, PhD, all rights reserved</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="c1"># Last modification 7/25/24 -egs-</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="kn">import</span> <span class="nn">copy</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="kn">import</span> <span class="nn">datetime</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="kn">import</span> <span class="nn">glob</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="kn">import</span> <span class="nn">logging</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="kn">import</span> <span class="nn">math</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="kn">import</span> <span class="nn">os</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="kn">import</span> <span class="nn">pickle</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a><span class="kn">import</span> <span class="nn">subprocess</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="kn">import</span> <span class="nn">time</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="kn">import</span> <span class="nn">psutil</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="kn">from</span> <span class="nn">proteusPy</span> <span class="kn">import</span> <span class="n">Disulfide</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="kn">from</span> <span class="nn">proteusPy.logger_config</span> <span class="kn">import</span> <span class="n">get_logger</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="n">_logger</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="c1"># Suppress findfont debug messages</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;matplotlib.font_manager&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="kn">from</span> <span class="nn">proteusPy</span> <span class="kn">import</span> <span class="n">DisulfideList</span><span class="p">,</span> <span class="n">__version__</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a><span class="kn">from</span> <span class="nn">proteusPy.DisulfideExceptions</span> <span class="kn">import</span> <span class="n">DisulfideIOException</span><span class="p">,</span> <span class="n">DisulfideParseWarning</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="kn">from</span> <span class="nn">proteusPy.ProteusPyWarning</span> <span class="kn">import</span> <span class="n">ProteusPyWarning</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a><span class="kn">from</span> <span class="nn">proteusPy.vector3D</span> <span class="kn">import</span> <span class="n">Vector3D</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a><span class="k">try</span><span class="p">:</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a>    <span class="c1"># Check if running in Jupyter</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a>    <span class="n">shell</span> <span class="o">=</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>  <span class="c1"># type: ignore</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a>    <span class="k">if</span> <span class="n">shell</span> <span class="o">==</span> <span class="s2">&quot;ZMQInteractiveShell&quot;</span><span class="p">:</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a>        <span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a>        <span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a><span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a>    <span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a><span class="kn">from</span> <span class="nn">tqdm.contrib.logging</span> <span class="kn">import</span> <span class="n">logging_redirect_tqdm</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a><span class="kn">from</span> <span class="nn">proteusPy.ProteusGlobals</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>    <span class="n">DATA_DIR</span><span class="p">,</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a>    <span class="n">MODEL_DIR</span><span class="p">,</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a>    <span class="n">PDB_DIR</span><span class="p">,</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>    <span class="n">PROBLEM_ID_FILE</span><span class="p">,</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a>    <span class="n">SS_ID_FILE</span><span class="p">,</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a>    <span class="n">SS_PICKLE_FILE</span><span class="p">,</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a><span class="p">)</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a><span class="n">PBAR_COLS</span> <span class="o">=</span> <span class="mi">80</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a><span class="k">def</span> <span class="nf">distance_squared</span><span class="p">(</span><span class="n">p1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">p2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a><span class="sd">    Return the square of the N-dimensional distance between the</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="sd">    two arrays.</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a><span class="sd">    :param np.array p1: N-dimensional array 1</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a><span class="sd">    :param np.array p2: N-dimensional array 2</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="sd">    :return: np.array N-dimensional distance squared Ã…^2</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a><span class="sd">    Example</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a><span class="sd">    &gt;&gt;&gt; from proteusPy import distance_squared</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a><span class="sd">    &gt;&gt;&gt; p1 = np.array([1.0, 0.0, 0.0])</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a><span class="sd">    &gt;&gt;&gt; p2 = np.array([0, 1.0, 0])</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a><span class="sd">    &gt;&gt;&gt; d = distance_squared(p1, p2)</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a><span class="sd">    &gt;&gt;&gt; d == float(2)</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a><span class="sd">    np.True_</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)))</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a><span class="k">def</span> <span class="nf">get_jet_colormap</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a><span class="sd">    Return an array of uniformly spaced RGB values using the &#39;jet&#39; colormap.</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a><span class="sd">    :param steps: The number of steps in the output array.</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a><span class="sd">    :return: An array of uniformly spaced RGB values using the &#39;jet&#39; colormap. The shape of the array is (steps, 3).</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a><span class="sd">    :rtype: numpy.ndarray</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a><span class="sd">    Example:</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a><span class="sd">        &gt;&gt;&gt; get_jet_colormap(5)</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a><span class="sd">        array([[  0,   0, 127],</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a><span class="sd">               [  0, 128, 255],</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a><span class="sd">               [124, 255, 121],</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a><span class="sd">               [255, 148,   0],</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a><span class="sd">               [127,   0,   0]], dtype=uint8)</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a>    <span class="kn">import</span> <span class="nn">matplotlib</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>    <span class="n">norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>    <span class="n">colormap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colormaps</span><span class="p">[</span><span class="s2">&quot;jet&quot;</span><span class="p">]</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a>    <span class="c1">#    colormap = cm.get_cmap(&quot;jet&quot;, steps)</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>    <span class="n">rgbcol</span> <span class="o">=</span> <span class="n">colormap</span><span class="p">(</span><span class="n">norm</span><span class="p">,</span> <span class="nb">bytes</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a>    <span class="k">return</span> <span class="n">rgbcol</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a><span class="k">def</span> <span class="nf">grid_dimensions</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a><span class="sd">    Compute the number of rows and columns needed to display a list of length `n`.</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a><span class="sd">    Args:</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a><span class="sd">        n (int): Length of input list</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a><span class="sd">    Returns:</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a><span class="sd">        tuple: Number of rows and columns required to display input list</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a>        <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a>    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>        <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>        <span class="n">root</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>        <span class="n">cols</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>        <span class="n">rows</span> <span class="o">=</span> <span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">cols</span> <span class="o">*</span> <span class="p">(</span><span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">n</span> <span class="k">else</span> <span class="n">cols</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>        <span class="k">return</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a><span class="c1"># given the full dictionary, walk through all the keys (PDB ID)</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a><span class="c1"># for each PDB_ID SS list, find and extract the SS for the first chain</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a><span class="c1"># update the &#39;pruned&#39; dict with the now shorter SS list</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a><span class="k">def</span> <span class="nf">extract_firstchain_ss</span><span class="p">(</span><span class="n">sslist</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a><span class="sd">    Extract disulfides from the first chain found in</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a><span class="sd">    the SSdict, returns them as a DisulfideList along with the</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a><span class="sd">    number of Xchain disulfides.</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a><span class="sd">    :param sslist: Starting SS list</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a><span class="sd">    :return: (Pruned SS list, xchain)</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>    <span class="kn">from</span> <span class="nn">proteusPy</span> <span class="kn">import</span> <span class="n">DisulfideList</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>    <span class="n">chain</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a>    <span class="n">chainlist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a>    <span class="n">pc</span> <span class="o">=</span> <span class="n">dc</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="n">sslist</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a>    <span class="n">xchain</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>    <span class="c1"># build list of chains</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>    <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">:</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a>        <span class="n">pc</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">proximal_chain</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>        <span class="n">dc</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">distal_chain</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>        <span class="k">if</span> <span class="n">pc</span> <span class="o">!=</span> <span class="n">dc</span><span class="p">:</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>            <span class="n">xchain</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;extract_firstchain_ss(): Cross chain ss: </span><span class="si">{</span><span class="n">ss</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>        <span class="n">chainlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pc</span><span class="p">)</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>        <span class="n">chain</span> <span class="o">=</span> <span class="n">chainlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;extract_firstchain_ss(): No chains found in SS list: </span><span class="si">{</span><span class="n">chain</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>        <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="n">xchain</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>    <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">:</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>        <span class="k">if</span> <span class="n">ss</span><span class="o">.</span><span class="n">proximal_chain</span> <span class="o">==</span> <span class="n">chain</span><span class="p">:</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>    <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="n">xchain</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a><span class="k">def</span> <span class="nf">prune_extra_ss</span><span class="p">(</span><span class="n">sslist</span><span class="p">):</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a><span class="sd">    Given a dict of disulfides, check for extra chains, grab only the disulfides from</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a><span class="sd">    the first chain and return a dict containing only the first chain disulfides</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a><span class="sd">    :param ssdict: input dictionary with disulfides</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>    <span class="n">xchain</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>    <span class="kn">from</span> <span class="nn">proteusPy</span> <span class="kn">import</span> <span class="n">DisulfideList</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>    <span class="c1"># print(f&#39;Processing: {ss} with: {sslist}&#39;)</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>    <span class="nb">id</span> <span class="o">=</span> <span class="n">sslist</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>    <span class="n">pruned_list</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="nb">id</span><span class="p">)</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>    <span class="n">pruned_list</span><span class="p">,</span> <span class="n">xchain</span> <span class="o">=</span> <span class="n">extract_firstchain_ss</span><span class="p">(</span><span class="n">sslist</span><span class="p">)</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">pruned_list</span><span class="p">),</span> <span class="n">xchain</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a><span class="k">def</span> <span class="nf">download_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a><span class="sd">    Download the given URL to the input directory</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a><span class="sd">    :param url: File URL</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a><span class="sd">    :param directory: Directory path for saving the file</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a><span class="sd">    :param verbose: Verbosity, defaults to False</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>    <span class="n">file_name</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>    <span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="n">file_name</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a>        <span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;wget&quot;</span><span class="p">,</span> <span class="s2">&quot;-P&quot;</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">url</span><span class="p">]</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Download complete.&quot;</span><span class="p">)</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2"> already exists in </span><span class="si">{</span><span class="n">directory</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a><span class="k">def</span> <span class="nf">get_memory_usage</span><span class="p">():</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a><span class="sd">    Returns the memory usage of the current process in megabytes (MB).</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a><span class="sd">    Returns:</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a><span class="sd">        float: The memory usage of the current process in megabytes (MB).</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>    <span class="n">process</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">()</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>    <span class="n">mem_info</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">memory_info</span><span class="p">()</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>    <span class="k">return</span> <span class="n">mem_info</span><span class="o">.</span><span class="n">rss</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a><span class="k">def</span> <span class="nf">get_object_size_mb</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>    <span class="kn">from</span> <span class="nn">pympler</span> <span class="kn">import</span> <span class="n">asizeof</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>    <span class="n">size_bytes</span> <span class="o">=</span> <span class="n">asizeof</span><span class="o">.</span><span class="n">asizeof</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>    <span class="n">size_mb</span> <span class="o">=</span> <span class="n">size_bytes</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>    <span class="k">return</span> <span class="n">size_mb</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a><span class="k">def</span> <span class="nf">print_memory_used</span><span class="p">():</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a><span class="sd">    Print memory used by the proteusPy process (GB).</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>    <span class="n">mem</span> <span class="o">=</span> <span class="n">get_memory_usage</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># to GB</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;proteusPy </span><span class="si">{</span><span class="n">__version__</span><span class="si">}</span><span class="s2">: Memory Used: </span><span class="si">{</span><span class="n">mem</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> GB&quot;</span><span class="p">)</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a><span class="k">def</span> <span class="nf">image_to_ascii_art</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">nwidth</span><span class="p">):</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a><span class="sd">    Convert an image to ASCII art of given text width.</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a><span class="sd">    Function takes an input filename and width and prints an ASCII art representation to console.</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a><span class="sd">    :param fname: Input filename.</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a><span class="sd">    :param nwidth: Output width in characters.</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>    <span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">minmax_scale</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>    <span class="c1"># Open the image file</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>    <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>    <span class="c1"># Resize the image to reduce the number of pixels</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>    <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">size</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>    <span class="n">aspect_ratio</span> <span class="o">=</span> <span class="n">height</span> <span class="o">/</span> <span class="n">width</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>    <span class="n">new_width</span> <span class="o">=</span> <span class="n">nwidth</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>    <span class="n">new_height</span> <span class="o">=</span> <span class="n">aspect_ratio</span> <span class="o">*</span> <span class="n">new_width</span> <span class="o">*</span> <span class="mf">0.55</span>  <span class="c1"># 0.55 is an adjustment factor</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>    <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="n">new_width</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">new_height</span><span class="p">)))</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>    <span class="c1"># Convert the image to grayscale.</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>    <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">)</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>    <span class="c1"># Define the ASCII character set to use (inverted colormap)</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>    <span class="n">char_set</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;@&quot;</span><span class="p">,</span> <span class="s2">&quot;#&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;&quot;</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">]</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>    <span class="c1"># Normalize the pixel values in the image.</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>    <span class="n">pixel_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">getdata</span><span class="p">())</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>    <span class="n">pixel_data_norm</span> <span class="o">=</span> <span class="n">minmax_scale</span><span class="p">(</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>        <span class="n">pixel_data</span><span class="p">,</span> <span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">char_set</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>    <span class="p">)</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>    <span class="n">pixel_data_norm</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pixel_data_norm</span><span class="p">]</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>    <span class="n">char_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">char_set</span><span class="p">[</span><span class="n">pixel</span><span class="p">]</span> <span class="k">for</span> <span class="n">pixel</span> <span class="ow">in</span> <span class="n">pixel_data_norm</span><span class="p">]</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>    <span class="c1"># Generate the ASCII art string</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>    <span class="n">ascii_art</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>        <span class="p">[</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>            <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">char_array</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">new_width</span><span class="p">)])</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">char_array</span><span class="p">),</span> <span class="n">new_width</span><span class="p">)</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>        <span class="p">]</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>    <span class="p">)</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>    <span class="c1"># Print the ASCII art string.</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>    <span class="nb">print</span><span class="p">(</span><span class="n">ascii_art</span><span class="p">)</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a><span class="k">def</span> <span class="nf">generate_vector_dataframe</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a><span class="sd">    Generate a pandas DataFrame containing all combinations for a vector of length 5 with a given base.</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a><span class="sd">    :param base: An integer representing the base of the vector elements. Must be 2, 3, or 4.</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a><span class="sd">    :return: A pandas DataFrame with columns &#39;chi1&#39;, &#39;chi2&#39;, &#39;chi3&#39;, &#39;chi4&#39;, &#39;chi5&#39;, where each row</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a><span class="sd">             contains all combinations for a vector of length 5 with the specified base. The symbols used</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a><span class="sd">             to represent the vector elements are &#39;-&#39; and &#39;+&#39; for base 2, &#39;-&#39; &#39;+&#39; and &#39;*&#39; for base 3,</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a><span class="sd">             and &#39;-&#39; &#39;+&#39; &#39;*&#39; and &#39;@&#39; for base 4.</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a><span class="sd">    :raises ValueError: If the specified base is not supported (i.e., not 2, 3, or 4).</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>    <span class="kn">import</span> <span class="nn">itertools</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>    <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>        <span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">]</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>    <span class="k">elif</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>        <span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">]</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a>    <span class="k">elif</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>        <span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;@&quot;</span><span class="p">]</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupported base&quot;</span><span class="p">)</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>    <span class="n">combinations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">combinations</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;chi1&quot;</span><span class="p">,</span> <span class="s2">&quot;chi2&quot;</span><span class="p">,</span> <span class="s2">&quot;chi3&quot;</span><span class="p">,</span> <span class="s2">&quot;chi4&quot;</span><span class="p">,</span> <span class="s2">&quot;chi5&quot;</span><span class="p">])</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>    <span class="k">return</span> <span class="n">df</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a><span class="k">def</span> <span class="nf">sort_by_column</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a><span class="sd">    Sort a Pandas DataFrame by the values in the &#39;incidence&#39; column in descending order.</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a><span class="sd">    :param df: The input DataFrame to be sorted.</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a><span class="sd">    :type df: pandas.DataFrame</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a><span class="sd">    :return: The sorted DataFrame.</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a><span class="sd">    :rtype: pandas.DataFrame</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>    <span class="n">sorted_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>    <span class="k">return</span> <span class="n">sorted_df</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a><span class="k">def</span> <span class="nf">plot_class_chart</span><span class="p">(</span><span class="n">classes</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a><span class="sd">    Create a Matplotlib pie chart with `classes` segments of equal size.</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a><span class="sd">    Parameters:</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a><span class="sd">        classes (int): The number of segments to create in the pie chart.</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a><span class="sd">    Returns:</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a><span class="sd">        None</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a><span class="sd">    Example:</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a><span class="sd">    &gt;&gt;&gt; plot_class_chart(4)</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a><span class="sd">    This will create a pie chart with 4 equal segments.</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>    <span class="kn">import</span> <span class="nn">matplotlib</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a>    <span class="kn">from</span> <span class="nn">proteusPy.angle_annotation</span> <span class="kn">import</span> <span class="n">AngleAnnotation</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>    <span class="c1"># Helper function to draw angle easily.</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>    <span class="k">def</span> <span class="nf">plot_angle</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">acol</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>        <span class="n">vec2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">angle</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">angle</span><span class="p">))])</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>        <span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[[</span><span class="n">length</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">vec2</span> <span class="o">*</span> <span class="n">length</span><span class="p">]</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">xy</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">acol</span><span class="p">)</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>        <span class="k">return</span> <span class="n">AngleAnnotation</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xy</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>    <span class="c1"># fig = plt.figure(figsize=(WIDTH, HEIGHT), dpi=DPI)</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>    <span class="c1"># ax1, ax2 = fig.subplots(1, 2, sharey=True, sharex=True)</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;SS Torsion Classes&quot;</span><span class="p">)</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a>    <span class="n">fig</span><span class="o">.</span><span class="n">set_dpi</span><span class="p">(</span><span class="mi">220</span><span class="p">)</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>    <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>  <span class="c1"># Need to draw the figure to define renderer</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>    <span class="c1"># Showcase different text positions.</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>    <span class="n">ax1</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;textposition&quot;</span><span class="p">)</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>    <span class="n">_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="mi">360</span><span class="o">/</span><span class="n">classes</span><span class="si">}</span><span class="s2">Â°$&quot;</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>    <span class="n">kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;points&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">_text</span><span class="p">)</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>    <span class="c1"># am6 = plot_angle(ax1, (2.0, 0), 60, textposition=&quot;inside&quot;, **kw)</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>    <span class="n">am7</span> <span class="o">=</span> <span class="n">plot_angle</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">360</span> <span class="o">/</span> <span class="n">classes</span><span class="p">,</span> <span class="n">textposition</span><span class="o">=</span><span class="s2">&quot;outside&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>    <span class="c1"># Create a list of segment values</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>    <span class="c1"># !!!</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">classes</span><span class="p">)]</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>    <span class="c1"># Create the pie chart</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>    <span class="c1"># fig, ax = plt.subplots()</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>    <span class="n">wedges</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>        <span class="n">values</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">counterclock</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wedgeprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mf">0.65</span><span class="p">)</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>    <span class="p">)</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>    <span class="c1"># Set the chart title and size</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">classes</span><span class="si">}</span><span class="s2">-Class Angular Layout&quot;</span><span class="p">)</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>    <span class="c1"># Set the segment colors</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>    <span class="n">color_palette</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colormaps</span><span class="p">[</span><span class="s2">&quot;tab20&quot;</span><span class="p">]</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>    <span class="c1"># color_palette = plt.cm.get_cmap(&quot;tab20&quot;, classes)</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>    <span class="n">ax1</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">color_palette</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">classes</span><span class="p">)])</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>    <span class="c1"># Create the legend</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>    <span class="n">legend_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Class </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">classes</span><span class="p">)]</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>    <span class="n">legend</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>        <span class="n">wedges</span><span class="p">,</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>        <span class="n">legend_labels</span><span class="p">,</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Classes&quot;</span><span class="p">,</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>        <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center left&quot;</span><span class="p">,</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>        <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>    <span class="p">)</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>    <span class="c1"># Set the legend fontsize</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">get_title</span><span class="p">(),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;large&quot;</span><span class="p">)</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">get_texts</span><span class="p">(),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">)</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>    <span class="c1"># Show the chart</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a><span class="k">def</span> <span class="nf">retrieve_git_lfs_files</span><span class="p">(</span><span class="n">repo_url</span><span class="p">,</span> <span class="n">objects</span><span class="p">):</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a><span class="sd">    Retrieves a git-lfs json object from a specified repo.</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a><span class="sd">    It does NOT download the file.</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>    <span class="kn">import</span> <span class="nn">requests</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>    <span class="n">batch_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">repo_url</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">/info/lfs/objects/batch&quot;</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>        <span class="s2">&quot;Accept&quot;</span><span class="p">:</span> <span class="s2">&quot;application/vnd.git-lfs+json&quot;</span><span class="p">,</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>        <span class="s2">&quot;Content-type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>    <span class="p">}</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;download&quot;</span><span class="p">,</span> <span class="s2">&quot;transfer&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;basic&quot;</span><span class="p">],</span> <span class="s2">&quot;objects&quot;</span><span class="p">:</span> <span class="n">objects</span><span class="p">}</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">batch_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>        <span class="c1"># Process the response or save the files</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>        <span class="c1"># For example, you can access the file contents using response.json()</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>        <span class="c1"># and save them to the desired location on your system.</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>        <span class="c1"># Handle error case</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a><span class="k">def</span> <span class="nf">display_ss_pymol</span><span class="p">(</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>    <span class="n">pdbid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>    <span class="n">proximal</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>    <span class="n">distal</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>    <span class="n">chain</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>    <span class="n">solvent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>    <span class="n">ray</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>    <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>    <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>    <span class="n">fname</span><span class="o">=</span><span class="s2">&quot;ss_pymol.png&quot;</span><span class="p">,</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a><span class="sd">    Visualizes specific residues within a given protein structure in PyMOL.</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a><span class="sd">    This function fetches a protein structure by its PDB ID, removes all other chains except</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a><span class="sd">    the specified one, and then shows the proximal and distal residues in spheres. Optionally,</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a><span class="sd">    it can also show solvent molecules as spheres.</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a><span class="sd">    Parameters:</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a><span class="sd">    - pdbid (str): The PDB ID of the protein structure to visualize.</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a><span class="sd">    - proximal (int): The residue number of the proximal residue to visualize.</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a><span class="sd">    - distal (int): The residue number of the distal residue to visualize.</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a><span class="sd">    - chain (str): The chain identifier of the residues to visualize.</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a><span class="sd">    - solvent (bool, optional): Whether to show solvent molecules. Defaults to True.</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a><span class="sd">    Returns:</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a><span class="sd">    - None</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>    <span class="kn">import</span> <span class="nn">pymolPy3</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>    <span class="n">pm</span> <span class="o">=</span> <span class="n">pymolPy3</span><span class="o">.</span><span class="n">pymolPy3</span><span class="p">()</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>    <span class="n">pm</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;fetch </span><span class="si">{</span><span class="n">pdbid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>    <span class="n">pm</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;remove not chain </span><span class="si">{</span><span class="n">chain</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>    <span class="n">pm</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;show spheres, resi </span><span class="si">{</span><span class="n">proximal</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">distal</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>    <span class="k">if</span> <span class="n">solvent</span><span class="p">:</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>        <span class="n">pm</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;show spheres, solvent&quot;</span><span class="p">)</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>    <span class="n">pm</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;color green, resi </span><span class="si">{</span><span class="n">proximal</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">distal</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>    <span class="n">pm</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;zoom resi </span><span class="si">{</span><span class="n">proximal</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">distal</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>    <span class="k">if</span> <span class="n">ray</span><span class="p">:</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>        <span class="n">pm</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ray </span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>        <span class="n">pm</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;png </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2">, dpi=</span><span class="si">{</span><span class="n">dpi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>    <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Press Enter to continue...&quot;</span><span class="p">)</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>    <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a><span class="k">def</span> <span class="nf">parse_ssbond_header_rec</span><span class="p">(</span><span class="n">ssbond_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a><span class="sd">    Parse the SSBOND dict returned by parse_pdb_header.</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a><span class="sd">    NB: Requires EGS-Modified BIO.parse_pdb_header.py.</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a><span class="sd">    This is used internally.</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a><span class="sd">    :param ssbond_dict: the input SSBOND dict</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a><span class="sd">    :return: A list of tuples representing the proximal,</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a><span class="sd">        distal residue ids for the Disulfide.</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parse_ssbond_header_rec(): </span><span class="si">{</span><span class="n">ssbond_dict</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>    <span class="n">disulfide_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>    <span class="k">for</span> <span class="n">ssb</span> <span class="ow">in</span> <span class="n">ssbond_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>        <span class="n">disulfide_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ssb</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>    <span class="k">return</span> <span class="n">disulfide_list</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a><span class="k">def</span> <span class="nf">Download_Disulfides</span><span class="p">(</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>    <span class="n">pdb_home</span><span class="o">=</span><span class="n">PDB_DIR</span><span class="p">,</span> <span class="n">model_home</span><span class="o">=</span><span class="n">MODEL_DIR</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">False</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a><span class="sd">    Read a comma separated list of PDB IDs and download them to the ``pdb_home`` path.</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a><span class="sd">    This utility function is used to download proteins containing at least one</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a><span class="sd">    SS bond with the ID list generated from: http://www.rcsb.org/.</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a><span class="sd">    This is the primary data loader for the proteusPy Disulfide analysis package.</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a><span class="sd">    The list of IDs represents files in the RCSB containing &gt; 1 disulfide bond,</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a><span class="sd">    and it contains over 39000 structures. The total download takes about 12 hours.</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a><span class="sd">    The function keeps track of downloaded files so it&#39;s possible to interrupt and</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a><span class="sd">    restart the download without duplicating effort.</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a><span class="sd">    :param pdb_home: Path for downloaded files, defaults to PDB_DIR</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a><span class="sd">    :param model_home: Path for extracted data, defaults to MODEL_DIR</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a><span class="sd">    :param verbose: Verbosity, defaults to False</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a><span class="sd">    :param reset: Reset the downloaded files index. Used to restart the download.</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a><span class="sd">    :raises DisulfideIOException: I/O error raised when the PDB file is not found.</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>    <span class="kn">import</span> <span class="nn">os</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>    <span class="kn">import</span> <span class="nn">time</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>    <span class="kn">from</span> <span class="nn">Bio.PDB</span> <span class="kn">import</span> <span class="n">PDBList</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>    <span class="n">donelines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>    <span class="n">SS_done</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>    <span class="n">ssfile</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">pdb_home</span><span class="p">)</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>    <span class="n">pdblist</span> <span class="o">=</span> <span class="n">PDBList</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>    <span class="n">ssfilename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_home</span><span class="si">}{</span><span class="n">SS_ID_FILE</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>    <span class="nb">print</span><span class="p">(</span><span class="n">ssfilename</span><span class="p">)</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>    <span class="c1"># list of IDs containing &gt;1 SSBond record</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>        <span class="n">ssfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">ssfilename</span><span class="p">)</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>        <span class="n">Line</span> <span class="o">=</span> <span class="n">ssfile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a>        <span class="k">raise</span> <span class="n">DisulfideIOException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot open file: </span><span class="si">{</span><span class="n">ssfile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a>    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>        <span class="n">entries</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span><span class="si">}</span><span class="s2"> entries&quot;</span><span class="p">)</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a>    <span class="n">completed</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;xxx&quot;</span><span class="p">}</span>  <span class="c1"># set to keep track of downloaded</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a>    <span class="c1"># file to track already downloaded entries.</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a>    <span class="k">if</span> <span class="n">reset</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a>        <span class="n">completed_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_home</span><span class="si">}</span><span class="s2">ss_completed.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>        <span class="n">donelines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>        <span class="n">SS_DONE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>        <span class="n">completed_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_home</span><span class="si">}</span><span class="s2">ss_completed.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">)</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>        <span class="n">donelines</span> <span class="o">=</span> <span class="n">completed_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">donelines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>        <span class="k">for</span> <span class="n">dl</span> <span class="ow">in</span> <span class="n">donelines</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>            <span class="c1"># create a list of pdb id already downloaded</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>            <span class="n">SS_done</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>    <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">SS_done</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>    <span class="n">completed</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">SS_done</span><span class="p">)</span>  <span class="c1"># update the completed set with what&#39;s downloaded</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>    <span class="c1"># Loop over all entries,</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>    <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">PBAR_COLS</span><span class="p">)</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">pbar</span><span class="p">:</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>        <span class="n">pbar</span><span class="o">.</span><span class="n">set_postfix</span><span class="p">({</span><span class="s2">&quot;Entry&quot;</span><span class="p">:</span> <span class="n">entry</span><span class="p">})</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>        <span class="k">if</span> <span class="n">entry</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">completed</span><span class="p">:</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>            <span class="k">if</span> <span class="n">pdblist</span><span class="o">.</span><span class="n">retrieve_pdb_file</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s2">&quot;pdb&quot;</span><span class="p">,</span> <span class="n">pdir</span><span class="o">=</span><span class="n">pdb_home</span><span class="p">):</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>                <span class="n">completed</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>                <span class="n">completed_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>    <span class="n">completed_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>    <span class="n">elapsed</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Overall files processed: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Complete. Elapsed time: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed</span><span class="p">)</span><span class="si">}</span><span class="s2"> (h:m:s)&quot;</span><span class="p">)</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>    <span class="k">return</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a><span class="k">def</span> <span class="nf">remove_duplicate_ss</span><span class="p">(</span><span class="n">sslist</span><span class="p">:</span> <span class="n">DisulfideList</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Disulfide</span><span class="p">]:</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>    <span class="n">pruned</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>    <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">:</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>        <span class="k">if</span> <span class="n">ss</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pruned</span><span class="p">:</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>            <span class="n">pruned</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>    <span class="k">return</span> <span class="n">pruned</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a><span class="c1"># Function extracts the disulfide bonds from the PDB files and creates the .pkl files</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a><span class="c1"># needed for the proteusPy.DisulfideLoader.DisulfideLoader class.</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a><span class="k">def</span> <span class="nf">Extract_Disulfides</span><span class="p">(</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>    <span class="n">numb</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>    <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>    <span class="n">pdbdir</span><span class="o">=</span><span class="n">PDB_DIR</span><span class="p">,</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>    <span class="n">baddir</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">PDB_DIR</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;bad&quot;</span><span class="p">,</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>    <span class="n">datadir</span><span class="o">=</span><span class="n">MODEL_DIR</span><span class="p">,</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>    <span class="n">picklefile</span><span class="o">=</span><span class="n">SS_PICKLE_FILE</span><span class="p">,</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>    <span class="n">problemfile</span><span class="o">=</span><span class="n">PROBLEM_ID_FILE</span><span class="p">,</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>    <span class="n">dist_cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>    <span class="n">prune</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a><span class="sd">    Read the PDB files contained in ``pdbdir`` and create the .pkl files needed for the</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a><span class="sd">    proteusPy.DisulfideLoader.DisulfideLoader class.</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a><span class="sd">    The ```Disulfide``` objects are contained in a ```DisulfideList``` object and</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a><span class="sd">    ```Dict``` within these files. In addition, .csv files containing all of</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a><span class="sd">    the torsions for the disulfides and problem IDs are written. The optional</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a><span class="sd">    ```dist_cutoff``` allows for removal of Disufides whose CÎ±-CÎ± distance is &gt;</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a><span class="sd">    than the cutoff value. If it&#39;s -1.0 then the function keeps all Disulfides.</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a><span class="sd">    :param numb:           Number of entries to process, defaults to all</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a><span class="sd">    :param verbose:        More messages</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a><span class="sd">    :param quiet:          Turn off DisulfideConstruction warnings</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a><span class="sd">    :param pdbdir:         Path to PDB files</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a><span class="sd">    :param datadir:        Path to resulting .pkl files</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a><span class="sd">    :param picklefile:     Name of the disulfide .pkl file</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a><span class="sd">    :param problemfile:    Name of the .csv file containing problem ids</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a><span class="sd">    :param dist_cutoff:    Ca distance cutoff to reject a Disulfide.</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a><span class="sd">    :param prune:          Move bad files to bad directory, defaults to True</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>    <span class="k">def</span> <span class="nf">name_to_id</span><span class="p">(</span><span class="n">fname</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a><span class="sd">        Returns the PDB ID from the filename.</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a><span class="sd">        :param fname: Complete PDB filename</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a><span class="sd">        :return: PDB ID</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>        <span class="n">ent</span> <span class="o">=</span> <span class="n">fname</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>        <span class="k">return</span> <span class="n">ent</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>    <span class="kn">import</span> <span class="nn">shutil</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>    <span class="kn">from</span> <span class="nn">proteusPy</span> <span class="kn">import</span> <span class="n">DisulfideList</span><span class="p">,</span> <span class="n">load_disulfides_from_id</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>    <span class="kn">from</span> <span class="nn">proteusPy.Disulfide</span> <span class="kn">import</span> <span class="n">Torsion_DF_Cols</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>    <span class="k">if</span> <span class="n">quiet</span><span class="p">:</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>    <span class="n">bad_dir</span> <span class="o">=</span> <span class="n">baddir</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>    <span class="n">entrylist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>    <span class="n">sslist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>    <span class="n">problem_ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>    <span class="n">bad</span> <span class="o">=</span> <span class="n">bad_dist</span> <span class="o">=</span> <span class="n">tot</span> <span class="o">=</span> <span class="n">cnt</span> <span class="o">=</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>    <span class="c1"># we use the specialized list class DisulfideList to contain our disulfides</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>    <span class="c1"># we&#39;ll use a dict to store DisulfideList objects, indexed by the structure ID</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>    <span class="n">All_ss_list</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s2">&quot;PDB_SS&quot;</span><span class="p">)</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>    <span class="n">All_ss_dict2</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># new dict of pointers to indices</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>    <span class="c1"># Build a list of PDB files in PDB_DIR that are readable. These files were downloaded</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>    <span class="c1"># via the RCSB web query interface for structures containing &gt;= 1 SS Bond.</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">pdbdir</span><span class="p">)</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>    <span class="n">ss_filelist</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.ent&quot;</span><span class="p">)</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>    <span class="c1"># the filenames are in the form pdb{entry}.ent, I loop through them and extract</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>    <span class="c1"># the PDB ID, with Disulfide.name_to_id(), then add to entrylist.</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">ss_filelist</span><span class="p">:</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>        <span class="n">entrylist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name_to_id</span><span class="p">(</span><span class="n">entry</span><span class="p">))</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PDB Ids: </span><span class="si">{</span><span class="n">entrylist</span><span class="si">}</span><span class="s2">, len: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">entrylist</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>    <span class="k">if</span> <span class="n">numb</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>        <span class="n">tot</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">entrylist</span><span class="p">)</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>        <span class="n">tot</span> <span class="o">=</span> <span class="n">numb</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a>    <span class="c1"># create a dataframe with the following columns for the disulfide conformations</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a>    <span class="c1"># extracted from the structure</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>    <span class="c1"># SS_df = pd.DataFrame(columns=Torsion_DF_Cols)</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>    <span class="c1"># define a tqdm progressbar using the fully loaded entrylist list.</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>    <span class="c1"># If numb is passed then</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>    <span class="c1"># only do the last numb entries.</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>    <span class="c1"># loop over ss_filelist, create disulfides and initialize them</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>    <span class="c1"># the logging_redirect_tqdm() context manager will redirect the logging output</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>    <span class="c1"># to the tqdm progress bar.</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>    <span class="k">with</span> <span class="n">logging_redirect_tqdm</span><span class="p">(</span><span class="n">loggers</span><span class="o">=</span><span class="p">[</span><span class="n">_logger</span><span class="p">]):</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>        <span class="k">if</span> <span class="n">numb</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>            <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">entrylist</span><span class="p">[:</span><span class="n">numb</span><span class="p">],</span> <span class="n">ncols</span><span class="o">=</span><span class="n">PBAR_COLS</span><span class="p">,</span> <span class="n">mininterval</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>            <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">entrylist</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">PBAR_COLS</span><span class="p">,</span> <span class="n">mininterval</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">pbar</span><span class="p">:</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>            <span class="n">_sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="n">entry</span><span class="p">)</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>            <span class="c1"># returns an empty list if none are found.</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>            <span class="n">_sslist</span> <span class="o">=</span> <span class="n">load_disulfides_from_id</span><span class="p">(</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>                <span class="n">entry</span><span class="p">,</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>                <span class="n">model_numb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>                <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>                <span class="n">quiet</span><span class="o">=</span><span class="n">quiet</span><span class="p">,</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>                <span class="n">pdb_dir</span><span class="o">=</span><span class="n">pdbdir</span><span class="p">,</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>                <span class="n">cutoff</span><span class="o">=</span><span class="n">dist_cutoff</span><span class="p">,</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>            <span class="p">)</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>            <span class="c1"># sslist, xchain = prune_extra_ss(_sslist)</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>            <span class="c1"># sslist = _sslist</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_sslist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>                <span class="n">sslist</span> <span class="o">=</span> <span class="n">remove_duplicate_ss</span><span class="p">(</span><span class="n">_sslist</span><span class="p">)</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>                <span class="n">sslist2</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list to hold indices for ss_dict2</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>                <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">:</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>                    <span class="n">All_ss_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>                    <span class="n">new_row</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span><span class="p">,</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">proximal</span><span class="p">,</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">distal</span><span class="p">,</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">chi1</span><span class="p">,</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">chi2</span><span class="p">,</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">chi3</span><span class="p">,</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">chi4</span><span class="p">,</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">chi5</span><span class="p">,</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">ca_distance</span><span class="p">,</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">cb_distance</span><span class="p">,</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">phiprox</span><span class="p">,</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">psiprox</span><span class="p">,</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">phidist</span><span class="p">,</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">psidist</span><span class="p">,</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">torsion_length</span><span class="p">,</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">rho</span><span class="p">,</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>                    <span class="p">]</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a>                    <span class="c1"># add the row to the end of the dataframe</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>                    <span class="c1"># SS_df.loc[len(SS_df.index)] = new_row.copy()  # deep copy</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>                    <span class="n">sslist2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>                    <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>                    <span class="n">tot</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>                <span class="c1"># All_ss_dict[entry] = sslist</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>                <span class="c1"># print(f&#39;Entry: {entry}. Dict indices: {sslist2}&#39;)</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>                <span class="n">All_ss_dict2</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span> <span class="o">=</span> <span class="n">sslist2</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>                <span class="c1"># print(f&#39;{entry} ss dict adding: {sslist2}&#39;)</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1">## _sslist is empty!</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>                <span class="n">bad</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>                <span class="n">problem_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>                    <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Extract_Disulfides(): No SS parsed for: </span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>                <span class="k">if</span> <span class="n">prune</span><span class="p">:</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>                    <span class="n">fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;pdb</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">.ent&quot;</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>                    <span class="c1"># Construct the full path for the new destination file</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>                    <span class="n">destination_file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">bad_dir</span><span class="p">)</span> <span class="o">/</span> <span class="n">fname</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>                    <span class="c1"># Copy the file to the new destination with the correct filename</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>                    <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>                        <span class="sa">f</span><span class="s2">&quot;Extract_Disulfides(): Moving </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">destination_file_path</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>                    <span class="p">)</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>                    <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">destination_file_path</span><span class="p">)</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>                <span class="k">continue</span>  <span class="c1">## this entry has no SS bonds, so we break the loop and move on to the next entry</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>                <span class="n">pbar</span><span class="o">.</span><span class="n">set_postfix</span><span class="p">({</span><span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;NoSS&quot;</span><span class="p">:</span> <span class="n">bad</span><span class="p">,</span> <span class="s2">&quot;Cnt&quot;</span><span class="p">:</span> <span class="n">cnt</span><span class="p">})</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>    <span class="n">pbar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>    <span class="k">if</span> <span class="n">bad</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>        <span class="n">prob_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>        <span class="n">problem_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">prob_cols</span><span class="p">)</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>        <span class="n">problem_df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">problem_ids</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>            <span class="p">(</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>                <span class="sa">f</span><span class="s2">&quot;Found and moved: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">problem_ids</span><span class="p">)</span><span class="si">}</span><span class="s2"> non-parsable structures.&quot;</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>                <span class="sa">f</span><span class="s2">&quot;Saving problem IDs to file: </span><span class="si">{</span><span class="n">Path</span><span class="p">(</span><span class="n">datadir</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">problemfile</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>            <span class="p">)</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>        <span class="p">)</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>        <span class="n">problem_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">datadir</span><span class="p">)</span> <span class="o">/</span> <span class="n">problemfile</span><span class="p">)</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1">## no bad files found</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No non-parsable structures found.&quot;</span><span class="p">)</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>    <span class="k">if</span> <span class="n">bad_dist</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found and ignored: </span><span class="si">{</span><span class="n">bad_dist</span><span class="si">}</span><span class="s2"> long SS bonds.&quot;</span><span class="p">)</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Extract_Disulfides(): No problems found.&quot;</span><span class="p">)</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>    <span class="c1"># dump the all_ss list of disulfides to a .pkl file. ~520 MB.</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>    <span class="n">fname</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">datadir</span><span class="p">)</span> <span class="o">/</span> <span class="n">picklefile</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">All_ss_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> Disulfides to file: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;wb+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">All_ss_list</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>    <span class="n">elapsed</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>            <span class="sa">f</span><span class="s2">&quot;Disulfide Extraction complete! Elapsed time:</span><span class="se">\</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a><span class="s2">    	    </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed</span><span class="p">)</span><span class="si">}</span><span class="s2"> (h:m:s)&quot;</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>        <span class="p">)</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>    <span class="c1"># return to original directory</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>    <span class="c1"># restore the logger level</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>    <span class="k">if</span> <span class="n">quiet</span><span class="p">:</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>    <span class="k">return</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a><span class="k">def</span> <span class="nf">Extract_Disulfides_From_List</span><span class="p">(</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>    <span class="n">numb</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>    <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>    <span class="n">pdbdir</span><span class="o">=</span><span class="n">PDB_DIR</span><span class="p">,</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>    <span class="n">baddir</span><span class="o">=</span><span class="n">PDB_DIR</span> <span class="o">+</span> <span class="s2">&quot;/bad/&quot;</span><span class="p">,</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a>    <span class="n">datadir</span><span class="o">=</span><span class="n">MODEL_DIR</span><span class="p">,</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>    <span class="n">picklefile</span><span class="o">=</span><span class="n">SS_PICKLE_FILE</span><span class="p">,</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a>    <span class="n">problemfile</span><span class="o">=</span><span class="n">PROBLEM_ID_FILE</span><span class="p">,</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a>    <span class="n">dist_cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>    <span class="n">prune</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>    <span class="n">sslist</span><span class="o">=</span><span class="p">[],</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a><span class="sd">    Read the PDB files contained in ``pdbdir`` and create the .pkl files needed for the</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a><span class="sd">    proteusPy.DisulfideLoader.DisulfideLoader class.</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a><span class="sd">    The ```Disulfide``` objects are contained in a ```DisulfideList``` object and</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a><span class="sd">    ```Dict``` within these files. In addition, .csv files containing all of</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a><span class="sd">    the torsions for the disulfides and problem IDs are written. The optional</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a><span class="sd">    ```dist_cutoff``` allows for removal of Disufides whose CÎ±-CÎ± distance is &gt;</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a><span class="sd">    than the cutoff value. If it&#39;s -1.0 then the function keeps all Disulfides.</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a><span class="sd">    :param numb:           Number of entries to process, defaults to all</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a><span class="sd">    :param verbose:        More messages</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a><span class="sd">    :param quiet:          Turn off DisulfideConstruction warnings</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a><span class="sd">    :param pdbdir:         Path to PDB files</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a><span class="sd">    :param datadir:        Path to resulting .pkl files</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a><span class="sd">    :param picklefile:     Name of the disulfide .pkl file</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a><span class="sd">    :param torsionfile:    Name of the disulfide torsion file .csv created</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a><span class="sd">    :param problemfile:    Name of the .csv file containing problem ids</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a><span class="sd">    :param dist_cutoff:    Ca distance cutoff to reject a Disulfide.</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a><span class="sd">    :param prune:          Move bad files to bad directory, defaults to True</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>    <span class="kn">import</span> <span class="nn">shutil</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>    <span class="kn">from</span> <span class="nn">proteusPy</span> <span class="kn">import</span> <span class="n">DisulfideList</span><span class="p">,</span> <span class="n">load_disulfides_from_id</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a>    <span class="kn">from</span> <span class="nn">proteusPy.Disulfide</span> <span class="kn">import</span> <span class="n">Torsion_DF_Cols</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>    <span class="k">if</span> <span class="n">quiet</span><span class="p">:</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>    <span class="n">bad_dir</span> <span class="o">=</span> <span class="n">baddir</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>    <span class="n">entrylist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>    <span class="n">problem_ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>    <span class="n">bad</span> <span class="o">=</span> <span class="n">bad_dist</span> <span class="o">=</span> <span class="n">tot</span> <span class="o">=</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>    <span class="c1"># we use the specialized list class DisulfideList to contain our disulfides</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>    <span class="c1"># we&#39;ll use a dict to store DisulfideList objects, indexed by the structure ID</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>    <span class="n">All_ss_list</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s2">&quot;PDB_SS&quot;</span><span class="p">)</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>    <span class="n">All_ss_dict2</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># new dict of pointers to indices</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">pdbdir</span><span class="p">)</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>    <span class="n">entrylist</span> <span class="o">=</span> <span class="n">sslist</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>            <span class="sa">f</span><span class="s2">&quot;Extract_Disulfides(): PDB Ids: </span><span class="si">{</span><span class="n">entrylist</span><span class="si">}</span><span class="s2">, len: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">entrylist</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>        <span class="p">)</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>    <span class="c1"># create a dataframe with the following columns for the disulfide conformations</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>    <span class="c1"># extracted from the structure</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>    <span class="c1"># SS_df = pd.DataFrame(columns=Torsion_DF_Cols)</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>    <span class="c1"># define a tqdm progressbar using the fully loaded entrylist list.</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>    <span class="c1"># If numb is passed then</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>    <span class="c1"># only do the last numb entries.</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>    <span class="c1"># loop over ss_filelist, create disulfides and initialize them</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>    <span class="c1"># the logging_redirect_tqdm() context manager will redirect the logging output</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>    <span class="c1"># to the tqdm progress bar.</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>    <span class="k">with</span> <span class="n">logging_redirect_tqdm</span><span class="p">(</span><span class="n">loggers</span><span class="o">=</span><span class="p">[</span><span class="n">_logger</span><span class="p">]):</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>        <span class="k">if</span> <span class="n">numb</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>            <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">entrylist</span><span class="p">[:</span><span class="n">numb</span><span class="p">],</span> <span class="n">ncols</span><span class="o">=</span><span class="n">PBAR_COLS</span><span class="p">)</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>            <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">entrylist</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">PBAR_COLS</span><span class="p">)</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">pbar</span><span class="p">:</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>            <span class="n">_sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="n">entry</span><span class="p">)</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>            <span class="c1"># returns an empty list if none are found.</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>            <span class="n">_sslist</span> <span class="o">=</span> <span class="n">load_disulfides_from_id</span><span class="p">(</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>                <span class="n">entry</span><span class="p">,</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>                <span class="n">model_numb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>                <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>                <span class="n">quiet</span><span class="o">=</span><span class="n">quiet</span><span class="p">,</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>                <span class="n">pdb_dir</span><span class="o">=</span><span class="n">pdbdir</span><span class="p">,</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>                <span class="n">cutoff</span><span class="o">=</span><span class="n">dist_cutoff</span><span class="p">,</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>            <span class="p">)</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>            <span class="c1"># sslist, xchain = prune_extra_ss(_sslist)</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>            <span class="c1"># sslist = _sslist</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_sslist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>                <span class="n">sslist</span> <span class="o">=</span> <span class="n">remove_duplicate_ss</span><span class="p">(</span><span class="n">_sslist</span><span class="p">)</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>                <span class="n">sslist2</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list to hold indices for ss_dict2</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>                <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">:</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>                    <span class="n">All_ss_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>                    <span class="n">new_row</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span><span class="p">,</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">proximal</span><span class="p">,</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">distal</span><span class="p">,</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">chi1</span><span class="p">,</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">chi2</span><span class="p">,</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">chi3</span><span class="p">,</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">chi4</span><span class="p">,</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">chi5</span><span class="p">,</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">ca_distance</span><span class="p">,</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">cb_distance</span><span class="p">,</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">phiprox</span><span class="p">,</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">psiprox</span><span class="p">,</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">phidist</span><span class="p">,</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">psidist</span><span class="p">,</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">torsion_length</span><span class="p">,</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">rho</span><span class="p">,</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>                    <span class="p">]</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>                    <span class="c1"># add the row to the end of the dataframe</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>                    <span class="c1"># SS_df.loc[len(SS_df.index)] = new_row.copy()  # deep copy</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>                    <span class="n">sslist2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>                    <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>                    <span class="n">tot</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>                <span class="c1"># All_ss_dict[entry] = sslist</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>                <span class="c1"># print(f&#39;Entry: {entry}. Dict indices: {sslist2}&#39;)</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>                <span class="n">All_ss_dict2</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span> <span class="o">=</span> <span class="n">sslist2</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>                <span class="c1"># print(f&#39;{entry} ss dict adding: {sslist2}&#39;)</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1">## _sslist is empty!</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>                <span class="n">bad</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>                <span class="n">problem_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>                    <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Extract_Disulfides(): No SS parsed for: </span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>                <span class="k">if</span> <span class="n">prune</span><span class="p">:</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>                    <span class="n">fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;pdb</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">.ent&quot;</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>                    <span class="c1"># Construct the full path for the new destination file</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>                    <span class="n">destination_file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">bad_dir</span><span class="p">)</span> <span class="o">/</span> <span class="n">fname</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>                    <span class="c1"># Copy the file to the new destination with the correct filename</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>                    <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>                        <span class="sa">f</span><span class="s2">&quot;Extract_Disulfides(): Moving </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">destination_file_path</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>                    <span class="p">)</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a>                    <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">destination_file_path</span><span class="p">)</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a>                <span class="k">continue</span>  <span class="c1">## this entry has no SS bonds, so we break the loop and move on to the next entry</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>            <span class="n">pbar</span><span class="o">.</span><span class="n">set_postfix</span><span class="p">(</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>                <span class="p">{</span><span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;NoSS&quot;</span><span class="p">:</span> <span class="n">bad</span><span class="p">,</span> <span class="s2">&quot;Cnt&quot;</span><span class="p">:</span> <span class="n">tot</span><span class="p">}</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>            <span class="p">)</span>  <span class="c1"># update the progress bar</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>    <span class="k">if</span> <span class="n">bad</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>        <span class="n">prob_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>        <span class="n">problem_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">prob_cols</span><span class="p">)</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>        <span class="n">problem_df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">problem_ids</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>            <span class="p">(</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>                <span class="sa">f</span><span class="s2">&quot;Found and moved: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">problem_ids</span><span class="p">)</span><span class="si">}</span><span class="s2"> non-parsable structures.&quot;</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>                <span class="sa">f</span><span class="s2">&quot;Saving problem IDs to file: </span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">problemfile</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>            <span class="p">)</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>        <span class="p">)</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>        <span class="n">problem_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">datadir</span> <span class="o">/</span> <span class="n">problemfile</span><span class="p">))</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1">## no bad files found</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Extract_Disulfides(): No non-parsable structures found.&quot;</span><span class="p">)</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>    <span class="k">if</span> <span class="n">bad_dist</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found and ignored: </span><span class="si">{</span><span class="n">bad_dist</span><span class="si">}</span><span class="s2"> long SS bonds.&quot;</span><span class="p">)</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No problems found.&quot;</span><span class="p">)</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>    <span class="c1"># dump the all_ss list of disulfides to a .pkl file. ~520 MB.</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>    <span class="n">fname</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">datadir</span><span class="p">)</span> <span class="o">/</span> <span class="n">picklefile</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">All_ss_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> Disulfides to file: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;wb+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">All_ss_list</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>    <span class="n">elapsed</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>            <span class="sa">f</span><span class="s2">&quot;Disulfide Extraction complete! Elapsed time:</span><span class="se">\</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a><span class="s2">    	    </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed</span><span class="p">)</span><span class="si">}</span><span class="s2"> (h:m:s)&quot;</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a>        <span class="p">)</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>    <span class="c1"># return to original directory</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>    <span class="c1"># restore the logger level</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a>    <span class="k">if</span> <span class="n">quiet</span><span class="p">:</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a>    <span class="k">return</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a><span class="k">def</span> <span class="nf">Extract_Disulfide</span><span class="p">(</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a>    <span class="n">pdbid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pdbdir</span><span class="o">=</span><span class="n">PDB_DIR</span><span class="p">,</span> <span class="n">xtra</span><span class="o">=</span><span class="kc">True</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a><span class="sd">    Read the PDB file represented by `pdbid` and return a ``DisulfideList``</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a><span class="sd">    containing the Disulfide bonds found.</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a><span class="sd">    :param verbose:        Display more messages</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a><span class="sd">    :param quiet:          Turn off DisulfideConstruction warnings</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a><span class="sd">    :param pdbdir:         path to PDB files</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a><span class="sd">    :param xtra:           Prune duplicate disulfides</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>    <span class="kn">import</span> <span class="nn">glob</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>    <span class="kn">import</span> <span class="nn">os</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>    <span class="kn">import</span> <span class="nn">shutil</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>    <span class="kn">import</span> <span class="nn">time</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>    <span class="kn">import</span> <span class="nn">proteusPy</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>    <span class="kn">from</span> <span class="nn">proteusPy</span> <span class="kn">import</span> <span class="n">DisulfideList</span><span class="p">,</span> <span class="n">load_disulfides_from_id</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>    <span class="k">def</span> <span class="nf">extract_id_from_filename</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a><span class="sd">        Extract the ID from a filename formatted as &#39;pdb{id}.ent&#39;.</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a><span class="sd">        Parameters:</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a><span class="sd">        - filename (str): The filename to extract the ID from.</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a><span class="sd">        Returns:</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a><span class="sd">        - str: The extracted ID.</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a>        <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>        <span class="c1"># Check if the filename follows the expected format</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a>        <span class="k">if</span> <span class="n">basename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;pdb&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.ent&quot;</span><span class="p">):</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a>            <span class="c1"># Extract the ID part of the filename</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>            <span class="k">return</span> <span class="n">filename</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>            <span class="n">mess</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>                <span class="sa">f</span><span class="s2">&quot;Filename </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> does not follow the expected format &#39;pdbid .ent&#39;&quot;</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>            <span class="p">)</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>    <span class="c1"># Build a list of PDB files in PDB_DIR that are readable. These files were downloaded</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>    <span class="c1"># via the RCSB web query interface for structures containing &gt;= 1 SS Bond.</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>    <span class="nb">id</span> <span class="o">=</span> <span class="n">extract_id_from_filename</span><span class="p">(</span><span class="n">pdbid</span><span class="p">)</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>    <span class="c1"># returns an empty list if none are found.</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>    <span class="n">_sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="nb">id</span><span class="p">)</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>    <span class="n">_sslist</span> <span class="o">=</span> <span class="n">load_disulfides_from_id</span><span class="p">(</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>        <span class="nb">id</span><span class="p">,</span> <span class="n">model_numb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="n">quiet</span><span class="p">,</span> <span class="n">pdb_dir</span><span class="o">=</span><span class="n">pdbdir</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>    <span class="p">)</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_sslist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">_sslist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--&gt; Can&#39;t find SSBonds: </span><span class="si">{</span><span class="n">pdbid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>        <span class="k">return</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="nb">id</span><span class="p">)</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>    <span class="c1"># return to original directory</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>    <span class="k">return</span> <span class="n">_sslist</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a><span class="k">def</span> <span class="nf">get_macos_theme</span><span class="p">():</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a><span class="sd">    Determine the display theme for a macOS computer using AppleScript.</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a><span class="sd">    Returns:</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a><span class="sd">    :return str: &#39;light&#39;, &#39;dark&#39;, or &#39;none&#39; based on the current display theme.</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a><span class="sd">    Example:</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a><span class="sd">    &gt;&gt;&gt; get_macos_theme()</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a><span class="sd">    &#39;dark&#39;</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a>        <span class="c1"># AppleScript to get the appearance setting</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a>        <span class="n">script</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a><span class="s2">        tell application &quot;System Events&quot;</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a><span class="s2">            tell appearance preferences</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a><span class="s2">                if (dark mode) then</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a><span class="s2">                    return &quot;dark&quot;</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a><span class="s2">                else</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a><span class="s2">                    return &quot;light&quot;</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a><span class="s2">                end if</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a><span class="s2">            end tell</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a><span class="s2">        end tell</span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a><span class="s2">        &quot;&quot;&quot;</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a>        <span class="c1"># Run the AppleScript</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a>            <span class="p">[</span><span class="s2">&quot;osascript&quot;</span><span class="p">,</span> <span class="s2">&quot;-e&quot;</span><span class="p">,</span> <span class="n">script</span><span class="p">],</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a>            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a>            <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a>            <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a>        <span class="p">)</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a>        <span class="c1"># Check the output</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a>        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a>            <span class="n">theme</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a>            <span class="k">if</span> <span class="n">theme</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;dark&quot;</span><span class="p">,</span> <span class="s2">&quot;light&quot;</span><span class="p">]:</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a>                <span class="k">return</span> <span class="n">theme</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a>                <span class="k">return</span> <span class="s2">&quot;none&quot;</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a>            <span class="k">return</span> <span class="s2">&quot;none&quot;</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a>        <span class="c1"># In case of any exception, return &#39;none&#39;</span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a>        <span class="k">return</span> <span class="s2">&quot;none&quot;</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a><span class="c1"># functions to calculate statistics and filter disulfide lists via pandas</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a><span class="k">def</span> <span class="nf">create_deviation_dataframe</span><span class="p">(</span><span class="n">disulfide_list</span><span class="p">):</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a><span class="sd">    Create a DataFrame with columns PDB_ID, SS_Name, Angle_Deviation, Distance_Deviation, Ca Distance</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a><span class="sd">    from a list of disulfides.</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a><span class="sd">    :param disulfide_list: List of disulfide objects.</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a><span class="sd">    :type proteusPy.DisulfideList: list</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a><span class="sd">    :return: DataFrame containing the disulfide information.</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a><span class="sd">    :rtype: pd.DataFrame</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a>    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a>        <span class="s2">&quot;PDB_ID&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>        <span class="s2">&quot;Resolution&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>        <span class="s2">&quot;SS_Name&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>        <span class="s2">&quot;Angle_Deviation&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>        <span class="s2">&quot;Bondlength_Deviation&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>        <span class="s2">&quot;Ca_Distance&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>    <span class="p">}</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>    <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">disulfide_list</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Processing...&quot;</span><span class="p">):</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>        <span class="n">pdb_id</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>        <span class="n">resolution</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>        <span class="n">ca_distance</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">ca_distance</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a>        <span class="n">angle_deviation</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">bond_angle_ideality</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a>        <span class="n">distance_deviation</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">bond_length_ideality</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;PDB_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">)</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Resolution&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;SS_Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Angle_Deviation&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle_deviation</span><span class="p">)</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Bondlength_Deviation&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">distance_deviation</span><span class="p">)</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Ca_Distance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ca_distance</span><span class="p">)</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a>    <span class="k">return</span> <span class="n">df</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a><span class="k">def</span> <span class="nf">calculate_std_cutoff</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">num_std</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a><span class="sd">    Calculate cutoff based on standard deviation.</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a><span class="sd">    :param df: DataFrame containing the deviations.</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a><span class="sd">    :type df: pd.DataFrame</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a><span class="sd">    :param column: Column name for which to calculate the cutoff.</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a><span class="sd">    :type column: str</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a><span class="sd">    :param num_std: Number of standard deviations to use for the cutoff.</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a><span class="sd">    :type num_std: int</span>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a><span class="sd">    :return: Cutoff value.</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a><span class="sd">    :rtype: float</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a>    <span class="n">mean</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a>    <span class="n">std</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a>    <span class="n">cutoff</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">num_std</span> <span class="o">*</span> <span class="n">std</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a>    <span class="k">return</span> <span class="n">cutoff</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a><span class="k">def</span> <span class="nf">calculate_percentile_cutoff</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="mi">95</span><span class="p">):</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a><span class="sd">    Calculate cutoff based on percentile.</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a><span class="sd">    :param df: DataFrame containing the deviations.</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a><span class="sd">    :type df: pd.DataFrame</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a><span class="sd">    :param column: Column name for which to calculate the cutoff.</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a><span class="sd">    :type column: str</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a><span class="sd">    :param percentile: Percentile to use for the cutoff.</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a><span class="sd">    :type percentile: int</span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a><span class="sd">    :return: Cutoff value.</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a><span class="sd">    :rtype: float</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a>    <span class="n">cutoff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">percentile</span><span class="p">)</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a>    <span class="k">return</span> <span class="n">cutoff</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a><span class="k">def</span> <span class="nf">filter_by_cutoffs</span><span class="p">(</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a>    <span class="n">df</span><span class="p">,</span> <span class="n">length_cutoff</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">angle_cutoff</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ca_cutoff</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">minimum_distance</span><span class="o">=</span><span class="mf">2.0</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a><span class="p">):</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a><span class="sd">    Filter the DataFrame based on distance, angle, and Ca distance cutoffs. Ca cutoff</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a><span class="sd">    dominates the filter and will override the distance and angle cutoffs. Note: The</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a><span class="sd">    filter is applied if the Ca distance is less than or equal to 2.0 Angstroms, since</span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a><span class="sd">    this is physically impossible.</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a><span class="sd">    :param df: DataFrame containing the deviations.</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a><span class="sd">    :type df: pd.DataFrame</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a><span class="sd">    :param length_cutoff: Cutoff value for Bond Length Deviation.</span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a><span class="sd">    :type distance_cutoff: float</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a><span class="sd">    :param angle_cutoff: Cutoff value for angle deviation.</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a><span class="sd">    :type angle_cutoff: float</span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a><span class="sd">    :param ca_cutoff: Cutoff value for Ca distance.</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a><span class="sd">    :type ca_cutoff: float</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a><span class="sd">    :return: Filtered DataFrame.</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a><span class="sd">    :rtype: pd.DataFrame</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a>    <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a>        <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Bondlength_Deviation&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">length_cutoff</span><span class="p">)</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a>        <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Angle_Deviation&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">angle_cutoff</span><span class="p">)</span>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a>        <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Ca_Distance&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">minimum_distance</span><span class="p">)</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a>        <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Ca_Distance&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">ca_cutoff</span><span class="p">)</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a>    <span class="p">]</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a>    <span class="k">return</span> <span class="n">filtered_df</span>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a><span class="k">def</span> <span class="nf">bad_filter_by_cutoffs</span><span class="p">(</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a>    <span class="n">df</span><span class="p">,</span> <span class="n">distance_cutoff</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">angle_cutoff</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ca_cutoff</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">minimum_distance</span><span class="o">=</span><span class="mf">2.0</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a><span class="p">):</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a><span class="sd">    Return the DataFrame objects that are GREATER than the cutoff based on distance,</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a><span class="sd">    angle, and Ca distance cutoffs. Used to get the bad structures. Ca cutoff</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a><span class="sd">    dominates the filter and will override the distance and angle cutoffs.</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a><span class="sd">    :param df: DataFrame containing the deviations.</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a><span class="sd">    :type df: pd.DataFrame</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a><span class="sd">    :param distance_cutoff: Cutoff value for Bond Length Deviation.</span>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a><span class="sd">    :type distance_cutoff: float</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a><span class="sd">    :param angle_cutoff: Cutoff value for angle deviation.</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a><span class="sd">    :type angle_cutoff: float</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a><span class="sd">    :param ca_cutoff: Cutoff value for Ca distance.</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a><span class="sd">    :type ca_cutoff: float</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a><span class="sd">    :return: Filtered DataFrame.</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a><span class="sd">    :rtype: pd.DataFrame</span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a>    <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a>        <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Bondlength_Deviation&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">distance_cutoff</span><span class="p">)</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a>        <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Angle_Deviation&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">angle_cutoff</span><span class="p">)</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a>        <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Ca_Distance&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">ca_cutoff</span><span class="p">)</span>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a>        <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Ca_Distance&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">minimum_distance</span><span class="p">)</span>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a>    <span class="p">]</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a>    <span class="k">return</span> <span class="n">filtered_df</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a><span class="k">def</span> <span class="nf">save_list_to_file</span><span class="p">(</span><span class="n">input_list</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a><span class="sd">    Save the input list to a file using pickle.</span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a><span class="sd">    :param input_list: List to be saved.</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a><span class="sd">    :type input_list: list</span>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a><span class="sd">    :param filename: Name of the file where the list will be saved.</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a><span class="sd">    :type filename: str</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a>        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">input_list</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a><span class="k">def</span> <span class="nf">load_list_from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a><span class="sd">    Load a list from a file using pickle.</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a><span class="sd">    This function reads a list from a file that was previously saved using the pickle module.</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a><span class="sd">    :param filename: Name of the file from which the list will be loaded.</span>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a><span class="sd">    :type filename: str</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a><span class="sd">    :return: The list that was loaded from the file.</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a><span class="sd">    :rtype: list</span>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a>        <span class="n">loaded_list</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a>    <span class="k">return</span> <span class="n">loaded_list</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a><span class="k">def</span> <span class="nf">set_logger_level_for_module</span><span class="p">(</span><span class="n">pkg_name</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a><span class="sd">    Set the logging level for all loggers within a specified package.</span>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a><span class="sd">    This function iterates through all registered loggers and sets the logging</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a><span class="sd">    level for those that belong to the specified package.</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a><span class="sd">    :param pkg_name: The name of the package for which to set the logging level.</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a><span class="sd">    :type pkg_name: str</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a><span class="sd">    :param level: The logging level to set (e.g., &#39;DEBUG&#39;, &#39;INFO&#39;, &#39;WARNING&#39;, &#39;ERROR&#39;, &#39;CRITICAL&#39;).</span>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a><span class="sd">                  If not specified, the logging level will not be changed.</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a><span class="sd">    :type level: str, optional</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a><span class="sd">    :return: A list of logger names that were found and had their levels set.</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a><span class="sd">    :rtype: list</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a>    <span class="n">logger_dict</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">loggerDict</span>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a>    <span class="n">registered_loggers</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a>        <span class="n">name</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a>        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">logger_dict</span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">logger_dict</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">)</span> <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">pkg_name</span><span class="p">)</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a>    <span class="p">]</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>    <span class="k">for</span> <span class="n">logger_name</span> <span class="ow">in</span> <span class="n">registered_loggers</span><span class="p">:</span>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a>        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">logger_name</span><span class="p">)</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a>        <span class="k">if</span> <span class="n">level</span><span class="p">:</span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a>    <span class="k">return</span> <span class="n">registered_loggers</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a>    <span class="kn">import</span> <span class="nn">doctest</span>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a>    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">()</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a><span class="c1"># end of file</span>
</span></pre></div>


            </section>
                <section id="PBAR_COLS">
                    <div class="attr variable">
            <span class="name">PBAR_COLS</span>        =
<span class="default_value">80</span>

        
    </div>
    <a class="headerlink" href="#PBAR_COLS"></a>
    
    

                </section>
                <section id="distance_squared">
                            <input id="distance_squared-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">distance_squared</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">p1</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="n">array</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">p2</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="n">array</span><span class="o">&gt;</span></span><span class="return-annotation">) -> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="n">array</span><span class="o">&gt;</span>:</span></span>

                <label class="view-source-button" for="distance_squared-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#distance_squared"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="distance_squared-67"><a href="#distance_squared-67"><span class="linenos">67</span></a><span class="k">def</span> <span class="nf">distance_squared</span><span class="p">(</span><span class="n">p1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">p2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
</span><span id="distance_squared-68"><a href="#distance_squared-68"><span class="linenos">68</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="distance_squared-69"><a href="#distance_squared-69"><span class="linenos">69</span></a><span class="sd">    Return the square of the N-dimensional distance between the</span>
</span><span id="distance_squared-70"><a href="#distance_squared-70"><span class="linenos">70</span></a><span class="sd">    two arrays.</span>
</span><span id="distance_squared-71"><a href="#distance_squared-71"><span class="linenos">71</span></a>
</span><span id="distance_squared-72"><a href="#distance_squared-72"><span class="linenos">72</span></a><span class="sd">    :param np.array p1: N-dimensional array 1</span>
</span><span id="distance_squared-73"><a href="#distance_squared-73"><span class="linenos">73</span></a><span class="sd">    :param np.array p2: N-dimensional array 2</span>
</span><span id="distance_squared-74"><a href="#distance_squared-74"><span class="linenos">74</span></a><span class="sd">    :return: np.array N-dimensional distance squared Ã…^2</span>
</span><span id="distance_squared-75"><a href="#distance_squared-75"><span class="linenos">75</span></a>
</span><span id="distance_squared-76"><a href="#distance_squared-76"><span class="linenos">76</span></a><span class="sd">    Example</span>
</span><span id="distance_squared-77"><a href="#distance_squared-77"><span class="linenos">77</span></a><span class="sd">    &gt;&gt;&gt; from proteusPy import distance_squared</span>
</span><span id="distance_squared-78"><a href="#distance_squared-78"><span class="linenos">78</span></a><span class="sd">    &gt;&gt;&gt; p1 = np.array([1.0, 0.0, 0.0])</span>
</span><span id="distance_squared-79"><a href="#distance_squared-79"><span class="linenos">79</span></a><span class="sd">    &gt;&gt;&gt; p2 = np.array([0, 1.0, 0])</span>
</span><span id="distance_squared-80"><a href="#distance_squared-80"><span class="linenos">80</span></a><span class="sd">    &gt;&gt;&gt; d = distance_squared(p1, p2)</span>
</span><span id="distance_squared-81"><a href="#distance_squared-81"><span class="linenos">81</span></a><span class="sd">    &gt;&gt;&gt; d == float(2)</span>
</span><span id="distance_squared-82"><a href="#distance_squared-82"><span class="linenos">82</span></a><span class="sd">    np.True_</span>
</span><span id="distance_squared-83"><a href="#distance_squared-83"><span class="linenos">83</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="distance_squared-84"><a href="#distance_squared-84"><span class="linenos">84</span></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)))</span>
</span></pre></div>


            <div class="docstring"><p>Return the square of the N-dimensional distance between the
two arrays.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>np.array p1</strong>:  N-dimensional array 1</li>
<li><strong>np.array p2</strong>:  N-dimensional array 2</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>np.array N-dimensional distance squared Ã…^2</p>
</blockquote>

<p>Example</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">proteusPy</span> <span class="kn">import</span> <span class="n">distance_squared</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">distance_squared</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">np.True_</span>
</code></pre>
</div>
</div>


                </section>
                <section id="get_jet_colormap">
                            <input id="get_jet_colormap-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_jet_colormap</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">steps</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_jet_colormap-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_jet_colormap"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_jet_colormap-87"><a href="#get_jet_colormap-87"><span class="linenos"> 87</span></a><span class="k">def</span> <span class="nf">get_jet_colormap</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
</span><span id="get_jet_colormap-88"><a href="#get_jet_colormap-88"><span class="linenos"> 88</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="get_jet_colormap-89"><a href="#get_jet_colormap-89"><span class="linenos"> 89</span></a><span class="sd">    Return an array of uniformly spaced RGB values using the &#39;jet&#39; colormap.</span>
</span><span id="get_jet_colormap-90"><a href="#get_jet_colormap-90"><span class="linenos"> 90</span></a>
</span><span id="get_jet_colormap-91"><a href="#get_jet_colormap-91"><span class="linenos"> 91</span></a><span class="sd">    :param steps: The number of steps in the output array.</span>
</span><span id="get_jet_colormap-92"><a href="#get_jet_colormap-92"><span class="linenos"> 92</span></a>
</span><span id="get_jet_colormap-93"><a href="#get_jet_colormap-93"><span class="linenos"> 93</span></a><span class="sd">    :return: An array of uniformly spaced RGB values using the &#39;jet&#39; colormap. The shape of the array is (steps, 3).</span>
</span><span id="get_jet_colormap-94"><a href="#get_jet_colormap-94"><span class="linenos"> 94</span></a><span class="sd">    :rtype: numpy.ndarray</span>
</span><span id="get_jet_colormap-95"><a href="#get_jet_colormap-95"><span class="linenos"> 95</span></a>
</span><span id="get_jet_colormap-96"><a href="#get_jet_colormap-96"><span class="linenos"> 96</span></a><span class="sd">    Example:</span>
</span><span id="get_jet_colormap-97"><a href="#get_jet_colormap-97"><span class="linenos"> 97</span></a><span class="sd">        &gt;&gt;&gt; get_jet_colormap(5)</span>
</span><span id="get_jet_colormap-98"><a href="#get_jet_colormap-98"><span class="linenos"> 98</span></a><span class="sd">        array([[  0,   0, 127],</span>
</span><span id="get_jet_colormap-99"><a href="#get_jet_colormap-99"><span class="linenos"> 99</span></a><span class="sd">               [  0, 128, 255],</span>
</span><span id="get_jet_colormap-100"><a href="#get_jet_colormap-100"><span class="linenos">100</span></a><span class="sd">               [124, 255, 121],</span>
</span><span id="get_jet_colormap-101"><a href="#get_jet_colormap-101"><span class="linenos">101</span></a><span class="sd">               [255, 148,   0],</span>
</span><span id="get_jet_colormap-102"><a href="#get_jet_colormap-102"><span class="linenos">102</span></a><span class="sd">               [127,   0,   0]], dtype=uint8)</span>
</span><span id="get_jet_colormap-103"><a href="#get_jet_colormap-103"><span class="linenos">103</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_jet_colormap-104"><a href="#get_jet_colormap-104"><span class="linenos">104</span></a>    <span class="kn">import</span> <span class="nn">matplotlib</span>
</span><span id="get_jet_colormap-105"><a href="#get_jet_colormap-105"><span class="linenos">105</span></a>
</span><span id="get_jet_colormap-106"><a href="#get_jet_colormap-106"><span class="linenos">106</span></a>    <span class="n">norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span>
</span><span id="get_jet_colormap-107"><a href="#get_jet_colormap-107"><span class="linenos">107</span></a>    <span class="n">colormap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colormaps</span><span class="p">[</span><span class="s2">&quot;jet&quot;</span><span class="p">]</span>
</span><span id="get_jet_colormap-108"><a href="#get_jet_colormap-108"><span class="linenos">108</span></a>    <span class="c1">#    colormap = cm.get_cmap(&quot;jet&quot;, steps)</span>
</span><span id="get_jet_colormap-109"><a href="#get_jet_colormap-109"><span class="linenos">109</span></a>    <span class="n">rgbcol</span> <span class="o">=</span> <span class="n">colormap</span><span class="p">(</span><span class="n">norm</span><span class="p">,</span> <span class="nb">bytes</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</span><span id="get_jet_colormap-110"><a href="#get_jet_colormap-110"><span class="linenos">110</span></a>
</span><span id="get_jet_colormap-111"><a href="#get_jet_colormap-111"><span class="linenos">111</span></a>    <span class="k">return</span> <span class="n">rgbcol</span>
</span></pre></div>


            <div class="docstring"><p>Return an array of uniformly spaced RGB values using the 'jet' colormap.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>steps</strong>:  The number of steps in the output array.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>An array of uniformly spaced RGB values using the 'jet' colormap. The shape of the array is (steps, 3).</p>
</blockquote>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>get_jet_colormap(5)
          array([[  0,   0, 127],
                 [  0, 128, 255],
                 [124, 255, 121],
                 [255, 148,   0],
                 [127,   0,   0]], dtype=uint8)</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                </section>
                <section id="grid_dimensions">
                            <input id="grid_dimensions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">grid_dimensions</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">n</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="nb">tuple</span>:</span></span>

                <label class="view-source-button" for="grid_dimensions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#grid_dimensions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="grid_dimensions-114"><a href="#grid_dimensions-114"><span class="linenos">114</span></a><span class="k">def</span> <span class="nf">grid_dimensions</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="grid_dimensions-115"><a href="#grid_dimensions-115"><span class="linenos">115</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="grid_dimensions-116"><a href="#grid_dimensions-116"><span class="linenos">116</span></a><span class="sd">    Compute the number of rows and columns needed to display a list of length `n`.</span>
</span><span id="grid_dimensions-117"><a href="#grid_dimensions-117"><span class="linenos">117</span></a>
</span><span id="grid_dimensions-118"><a href="#grid_dimensions-118"><span class="linenos">118</span></a><span class="sd">    Args:</span>
</span><span id="grid_dimensions-119"><a href="#grid_dimensions-119"><span class="linenos">119</span></a><span class="sd">        n (int): Length of input list</span>
</span><span id="grid_dimensions-120"><a href="#grid_dimensions-120"><span class="linenos">120</span></a>
</span><span id="grid_dimensions-121"><a href="#grid_dimensions-121"><span class="linenos">121</span></a><span class="sd">    Returns:</span>
</span><span id="grid_dimensions-122"><a href="#grid_dimensions-122"><span class="linenos">122</span></a><span class="sd">        tuple: Number of rows and columns required to display input list</span>
</span><span id="grid_dimensions-123"><a href="#grid_dimensions-123"><span class="linenos">123</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="grid_dimensions-124"><a href="#grid_dimensions-124"><span class="linenos">124</span></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="grid_dimensions-125"><a href="#grid_dimensions-125"><span class="linenos">125</span></a>        <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="grid_dimensions-126"><a href="#grid_dimensions-126"><span class="linenos">126</span></a>    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="grid_dimensions-127"><a href="#grid_dimensions-127"><span class="linenos">127</span></a>        <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
</span><span id="grid_dimensions-128"><a href="#grid_dimensions-128"><span class="linenos">128</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="grid_dimensions-129"><a href="#grid_dimensions-129"><span class="linenos">129</span></a>        <span class="n">root</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span id="grid_dimensions-130"><a href="#grid_dimensions-130"><span class="linenos">130</span></a>        <span class="n">cols</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</span><span id="grid_dimensions-131"><a href="#grid_dimensions-131"><span class="linenos">131</span></a>        <span class="n">rows</span> <span class="o">=</span> <span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">cols</span> <span class="o">*</span> <span class="p">(</span><span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">n</span> <span class="k">else</span> <span class="n">cols</span>
</span><span id="grid_dimensions-132"><a href="#grid_dimensions-132"><span class="linenos">132</span></a>        <span class="k">return</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span>
</span></pre></div>


            <div class="docstring"><p>Compute the number of rows and columns needed to display a list of length <code>n</code>.</p>

<p>Args:
    n (int): Length of input list</p>

<p>Returns:
    tuple: Number of rows and columns required to display input list</p>
</div>


                </section>
                <section id="extract_firstchain_ss">
                            <input id="extract_firstchain_ss-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">extract_firstchain_ss</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">sslist</span>, </span><span class="param"><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="extract_firstchain_ss-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#extract_firstchain_ss"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="extract_firstchain_ss-140"><a href="#extract_firstchain_ss-140"><span class="linenos">140</span></a><span class="k">def</span> <span class="nf">extract_firstchain_ss</span><span class="p">(</span><span class="n">sslist</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="extract_firstchain_ss-141"><a href="#extract_firstchain_ss-141"><span class="linenos">141</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="extract_firstchain_ss-142"><a href="#extract_firstchain_ss-142"><span class="linenos">142</span></a><span class="sd">    Extract disulfides from the first chain found in</span>
</span><span id="extract_firstchain_ss-143"><a href="#extract_firstchain_ss-143"><span class="linenos">143</span></a><span class="sd">    the SSdict, returns them as a DisulfideList along with the</span>
</span><span id="extract_firstchain_ss-144"><a href="#extract_firstchain_ss-144"><span class="linenos">144</span></a><span class="sd">    number of Xchain disulfides.</span>
</span><span id="extract_firstchain_ss-145"><a href="#extract_firstchain_ss-145"><span class="linenos">145</span></a>
</span><span id="extract_firstchain_ss-146"><a href="#extract_firstchain_ss-146"><span class="linenos">146</span></a><span class="sd">    :param sslist: Starting SS list</span>
</span><span id="extract_firstchain_ss-147"><a href="#extract_firstchain_ss-147"><span class="linenos">147</span></a><span class="sd">    :return: (Pruned SS list, xchain)</span>
</span><span id="extract_firstchain_ss-148"><a href="#extract_firstchain_ss-148"><span class="linenos">148</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="extract_firstchain_ss-149"><a href="#extract_firstchain_ss-149"><span class="linenos">149</span></a>    <span class="kn">from</span> <span class="nn">proteusPy</span> <span class="kn">import</span> <span class="n">DisulfideList</span>
</span><span id="extract_firstchain_ss-150"><a href="#extract_firstchain_ss-150"><span class="linenos">150</span></a>
</span><span id="extract_firstchain_ss-151"><a href="#extract_firstchain_ss-151"><span class="linenos">151</span></a>    <span class="n">chain</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="extract_firstchain_ss-152"><a href="#extract_firstchain_ss-152"><span class="linenos">152</span></a>    <span class="n">chainlist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="extract_firstchain_ss-153"><a href="#extract_firstchain_ss-153"><span class="linenos">153</span></a>    <span class="n">pc</span> <span class="o">=</span> <span class="n">dc</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="extract_firstchain_ss-154"><a href="#extract_firstchain_ss-154"><span class="linenos">154</span></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="n">sslist</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</span><span id="extract_firstchain_ss-155"><a href="#extract_firstchain_ss-155"><span class="linenos">155</span></a>    <span class="n">xchain</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="extract_firstchain_ss-156"><a href="#extract_firstchain_ss-156"><span class="linenos">156</span></a>
</span><span id="extract_firstchain_ss-157"><a href="#extract_firstchain_ss-157"><span class="linenos">157</span></a>    <span class="c1"># build list of chains</span>
</span><span id="extract_firstchain_ss-158"><a href="#extract_firstchain_ss-158"><span class="linenos">158</span></a>    <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">:</span>
</span><span id="extract_firstchain_ss-159"><a href="#extract_firstchain_ss-159"><span class="linenos">159</span></a>        <span class="n">pc</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">proximal_chain</span>
</span><span id="extract_firstchain_ss-160"><a href="#extract_firstchain_ss-160"><span class="linenos">160</span></a>        <span class="n">dc</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">distal_chain</span>
</span><span id="extract_firstchain_ss-161"><a href="#extract_firstchain_ss-161"><span class="linenos">161</span></a>        <span class="k">if</span> <span class="n">pc</span> <span class="o">!=</span> <span class="n">dc</span><span class="p">:</span>
</span><span id="extract_firstchain_ss-162"><a href="#extract_firstchain_ss-162"><span class="linenos">162</span></a>            <span class="n">xchain</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="extract_firstchain_ss-163"><a href="#extract_firstchain_ss-163"><span class="linenos">163</span></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="extract_firstchain_ss-164"><a href="#extract_firstchain_ss-164"><span class="linenos">164</span></a>                <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;extract_firstchain_ss(): Cross chain ss: </span><span class="si">{</span><span class="n">ss</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="extract_firstchain_ss-165"><a href="#extract_firstchain_ss-165"><span class="linenos">165</span></a>        <span class="n">chainlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pc</span><span class="p">)</span>
</span><span id="extract_firstchain_ss-166"><a href="#extract_firstchain_ss-166"><span class="linenos">166</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="extract_firstchain_ss-167"><a href="#extract_firstchain_ss-167"><span class="linenos">167</span></a>        <span class="n">chain</span> <span class="o">=</span> <span class="n">chainlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="extract_firstchain_ss-168"><a href="#extract_firstchain_ss-168"><span class="linenos">168</span></a>    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
</span><span id="extract_firstchain_ss-169"><a href="#extract_firstchain_ss-169"><span class="linenos">169</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;extract_firstchain_ss(): No chains found in SS list: </span><span class="si">{</span><span class="n">chain</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="extract_firstchain_ss-170"><a href="#extract_firstchain_ss-170"><span class="linenos">170</span></a>        <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="n">xchain</span>
</span><span id="extract_firstchain_ss-171"><a href="#extract_firstchain_ss-171"><span class="linenos">171</span></a>
</span><span id="extract_firstchain_ss-172"><a href="#extract_firstchain_ss-172"><span class="linenos">172</span></a>    <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">:</span>
</span><span id="extract_firstchain_ss-173"><a href="#extract_firstchain_ss-173"><span class="linenos">173</span></a>        <span class="k">if</span> <span class="n">ss</span><span class="o">.</span><span class="n">proximal_chain</span> <span class="o">==</span> <span class="n">chain</span><span class="p">:</span>
</span><span id="extract_firstchain_ss-174"><a href="#extract_firstchain_ss-174"><span class="linenos">174</span></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
</span><span id="extract_firstchain_ss-175"><a href="#extract_firstchain_ss-175"><span class="linenos">175</span></a>
</span><span id="extract_firstchain_ss-176"><a href="#extract_firstchain_ss-176"><span class="linenos">176</span></a>    <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="n">xchain</span>
</span></pre></div>


            <div class="docstring"><p>Extract disulfides from the first chain found in
the SSdict, returns them as a DisulfideList along with the
number of Xchain disulfides.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>sslist</strong>:  Starting SS list</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>(Pruned SS list, xchain)</p>
</blockquote>
</div>


                </section>
                <section id="prune_extra_ss">
                            <input id="prune_extra_ss-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">prune_extra_ss</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">sslist</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="prune_extra_ss-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#prune_extra_ss"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="prune_extra_ss-179"><a href="#prune_extra_ss-179"><span class="linenos">179</span></a><span class="k">def</span> <span class="nf">prune_extra_ss</span><span class="p">(</span><span class="n">sslist</span><span class="p">):</span>
</span><span id="prune_extra_ss-180"><a href="#prune_extra_ss-180"><span class="linenos">180</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="prune_extra_ss-181"><a href="#prune_extra_ss-181"><span class="linenos">181</span></a><span class="sd">    Given a dict of disulfides, check for extra chains, grab only the disulfides from</span>
</span><span id="prune_extra_ss-182"><a href="#prune_extra_ss-182"><span class="linenos">182</span></a><span class="sd">    the first chain and return a dict containing only the first chain disulfides</span>
</span><span id="prune_extra_ss-183"><a href="#prune_extra_ss-183"><span class="linenos">183</span></a>
</span><span id="prune_extra_ss-184"><a href="#prune_extra_ss-184"><span class="linenos">184</span></a><span class="sd">    :param ssdict: input dictionary with disulfides</span>
</span><span id="prune_extra_ss-185"><a href="#prune_extra_ss-185"><span class="linenos">185</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="prune_extra_ss-186"><a href="#prune_extra_ss-186"><span class="linenos">186</span></a>    <span class="n">xchain</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="prune_extra_ss-187"><a href="#prune_extra_ss-187"><span class="linenos">187</span></a>    <span class="kn">from</span> <span class="nn">proteusPy</span> <span class="kn">import</span> <span class="n">DisulfideList</span>
</span><span id="prune_extra_ss-188"><a href="#prune_extra_ss-188"><span class="linenos">188</span></a>
</span><span id="prune_extra_ss-189"><a href="#prune_extra_ss-189"><span class="linenos">189</span></a>    <span class="c1"># print(f&#39;Processing: {ss} with: {sslist}&#39;)</span>
</span><span id="prune_extra_ss-190"><a href="#prune_extra_ss-190"><span class="linenos">190</span></a>    <span class="nb">id</span> <span class="o">=</span> <span class="n">sslist</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="prune_extra_ss-191"><a href="#prune_extra_ss-191"><span class="linenos">191</span></a>    <span class="n">pruned_list</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="nb">id</span><span class="p">)</span>
</span><span id="prune_extra_ss-192"><a href="#prune_extra_ss-192"><span class="linenos">192</span></a>    <span class="n">pruned_list</span><span class="p">,</span> <span class="n">xchain</span> <span class="o">=</span> <span class="n">extract_firstchain_ss</span><span class="p">(</span><span class="n">sslist</span><span class="p">)</span>
</span><span id="prune_extra_ss-193"><a href="#prune_extra_ss-193"><span class="linenos">193</span></a>
</span><span id="prune_extra_ss-194"><a href="#prune_extra_ss-194"><span class="linenos">194</span></a>    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">pruned_list</span><span class="p">),</span> <span class="n">xchain</span>
</span></pre></div>


            <div class="docstring"><p>Given a dict of disulfides, check for extra chains, grab only the disulfides from
the first chain and return a dict containing only the first chain disulfides</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>ssdict</strong>:  input dictionary with disulfides</li>
</ul>
</div>


                </section>
                <section id="download_file">
                            <input id="download_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">download_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">url</span>, </span><span class="param"><span class="n">directory</span>, </span><span class="param"><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="download_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#download_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="download_file-197"><a href="#download_file-197"><span class="linenos">197</span></a><span class="k">def</span> <span class="nf">download_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="download_file-198"><a href="#download_file-198"><span class="linenos">198</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="download_file-199"><a href="#download_file-199"><span class="linenos">199</span></a><span class="sd">    Download the given URL to the input directory</span>
</span><span id="download_file-200"><a href="#download_file-200"><span class="linenos">200</span></a>
</span><span id="download_file-201"><a href="#download_file-201"><span class="linenos">201</span></a><span class="sd">    :param url: File URL</span>
</span><span id="download_file-202"><a href="#download_file-202"><span class="linenos">202</span></a><span class="sd">    :param directory: Directory path for saving the file</span>
</span><span id="download_file-203"><a href="#download_file-203"><span class="linenos">203</span></a><span class="sd">    :param verbose: Verbosity, defaults to False</span>
</span><span id="download_file-204"><a href="#download_file-204"><span class="linenos">204</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="download_file-205"><a href="#download_file-205"><span class="linenos">205</span></a>    <span class="n">file_name</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="download_file-206"><a href="#download_file-206"><span class="linenos">206</span></a>    <span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">/</span> <span class="n">file_name</span>
</span><span id="download_file-207"><a href="#download_file-207"><span class="linenos">207</span></a>
</span><span id="download_file-208"><a href="#download_file-208"><span class="linenos">208</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
</span><span id="download_file-209"><a href="#download_file-209"><span class="linenos">209</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="download_file-210"><a href="#download_file-210"><span class="linenos">210</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
</span><span id="download_file-211"><a href="#download_file-211"><span class="linenos">211</span></a>        <span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;wget&quot;</span><span class="p">,</span> <span class="s2">&quot;-P&quot;</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">url</span><span class="p">]</span>
</span><span id="download_file-212"><a href="#download_file-212"><span class="linenos">212</span></a>        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="download_file-213"><a href="#download_file-213"><span class="linenos">213</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Download complete.&quot;</span><span class="p">)</span>
</span><span id="download_file-214"><a href="#download_file-214"><span class="linenos">214</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="download_file-215"><a href="#download_file-215"><span class="linenos">215</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2"> already exists in </span><span class="si">{</span><span class="n">directory</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Download the given URL to the input directory</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>url</strong>:  File URL</li>
<li><strong>directory</strong>:  Directory path for saving the file</li>
<li><strong>verbose</strong>:  Verbosity, defaults to False</li>
</ul>
</div>


                </section>
                <section id="get_memory_usage">
                            <input id="get_memory_usage-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_memory_usage</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_memory_usage-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_memory_usage"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_memory_usage-218"><a href="#get_memory_usage-218"><span class="linenos">218</span></a><span class="k">def</span> <span class="nf">get_memory_usage</span><span class="p">():</span>
</span><span id="get_memory_usage-219"><a href="#get_memory_usage-219"><span class="linenos">219</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="get_memory_usage-220"><a href="#get_memory_usage-220"><span class="linenos">220</span></a><span class="sd">    Returns the memory usage of the current process in megabytes (MB).</span>
</span><span id="get_memory_usage-221"><a href="#get_memory_usage-221"><span class="linenos">221</span></a>
</span><span id="get_memory_usage-222"><a href="#get_memory_usage-222"><span class="linenos">222</span></a><span class="sd">    Returns:</span>
</span><span id="get_memory_usage-223"><a href="#get_memory_usage-223"><span class="linenos">223</span></a><span class="sd">        float: The memory usage of the current process in megabytes (MB).</span>
</span><span id="get_memory_usage-224"><a href="#get_memory_usage-224"><span class="linenos">224</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_memory_usage-225"><a href="#get_memory_usage-225"><span class="linenos">225</span></a>
</span><span id="get_memory_usage-226"><a href="#get_memory_usage-226"><span class="linenos">226</span></a>    <span class="n">process</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">()</span>
</span><span id="get_memory_usage-227"><a href="#get_memory_usage-227"><span class="linenos">227</span></a>    <span class="n">mem_info</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">memory_info</span><span class="p">()</span>
</span><span id="get_memory_usage-228"><a href="#get_memory_usage-228"><span class="linenos">228</span></a>    <span class="k">return</span> <span class="n">mem_info</span><span class="o">.</span><span class="n">rss</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the memory usage of the current process in megabytes (MB).</p>

<p>Returns:
    float: The memory usage of the current process in megabytes (MB).</p>
</div>


                </section>
                <section id="get_object_size_mb">
                            <input id="get_object_size_mb-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_object_size_mb</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">obj</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_object_size_mb-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_object_size_mb"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_object_size_mb-231"><a href="#get_object_size_mb-231"><span class="linenos">231</span></a><span class="k">def</span> <span class="nf">get_object_size_mb</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
</span><span id="get_object_size_mb-232"><a href="#get_object_size_mb-232"><span class="linenos">232</span></a>    <span class="kn">from</span> <span class="nn">pympler</span> <span class="kn">import</span> <span class="n">asizeof</span>
</span><span id="get_object_size_mb-233"><a href="#get_object_size_mb-233"><span class="linenos">233</span></a>
</span><span id="get_object_size_mb-234"><a href="#get_object_size_mb-234"><span class="linenos">234</span></a>    <span class="n">size_bytes</span> <span class="o">=</span> <span class="n">asizeof</span><span class="o">.</span><span class="n">asizeof</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</span><span id="get_object_size_mb-235"><a href="#get_object_size_mb-235"><span class="linenos">235</span></a>    <span class="n">size_mb</span> <span class="o">=</span> <span class="n">size_bytes</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="get_object_size_mb-236"><a href="#get_object_size_mb-236"><span class="linenos">236</span></a>    <span class="k">return</span> <span class="n">size_mb</span>
</span></pre></div>


    

                </section>
                <section id="print_memory_used">
                            <input id="print_memory_used-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">print_memory_used</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="print_memory_used-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#print_memory_used"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="print_memory_used-239"><a href="#print_memory_used-239"><span class="linenos">239</span></a><span class="k">def</span> <span class="nf">print_memory_used</span><span class="p">():</span>
</span><span id="print_memory_used-240"><a href="#print_memory_used-240"><span class="linenos">240</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="print_memory_used-241"><a href="#print_memory_used-241"><span class="linenos">241</span></a><span class="sd">    Print memory used by the proteusPy process (GB).</span>
</span><span id="print_memory_used-242"><a href="#print_memory_used-242"><span class="linenos">242</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="print_memory_used-243"><a href="#print_memory_used-243"><span class="linenos">243</span></a>    <span class="n">mem</span> <span class="o">=</span> <span class="n">get_memory_usage</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># to GB</span>
</span><span id="print_memory_used-244"><a href="#print_memory_used-244"><span class="linenos">244</span></a>
</span><span id="print_memory_used-245"><a href="#print_memory_used-245"><span class="linenos">245</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;proteusPy </span><span class="si">{</span><span class="n">__version__</span><span class="si">}</span><span class="s2">: Memory Used: </span><span class="si">{</span><span class="n">mem</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> GB&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Print memory used by the proteusPy process (GB).</p>
</div>


                </section>
                <section id="image_to_ascii_art">
                            <input id="image_to_ascii_art-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">image_to_ascii_art</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">fname</span>, </span><span class="param"><span class="n">nwidth</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="image_to_ascii_art-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#image_to_ascii_art"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="image_to_ascii_art-248"><a href="#image_to_ascii_art-248"><span class="linenos">248</span></a><span class="k">def</span> <span class="nf">image_to_ascii_art</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">nwidth</span><span class="p">):</span>
</span><span id="image_to_ascii_art-249"><a href="#image_to_ascii_art-249"><span class="linenos">249</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="image_to_ascii_art-250"><a href="#image_to_ascii_art-250"><span class="linenos">250</span></a><span class="sd">    Convert an image to ASCII art of given text width.</span>
</span><span id="image_to_ascii_art-251"><a href="#image_to_ascii_art-251"><span class="linenos">251</span></a>
</span><span id="image_to_ascii_art-252"><a href="#image_to_ascii_art-252"><span class="linenos">252</span></a><span class="sd">    Function takes an input filename and width and prints an ASCII art representation to console.</span>
</span><span id="image_to_ascii_art-253"><a href="#image_to_ascii_art-253"><span class="linenos">253</span></a>
</span><span id="image_to_ascii_art-254"><a href="#image_to_ascii_art-254"><span class="linenos">254</span></a><span class="sd">    :param fname: Input filename.</span>
</span><span id="image_to_ascii_art-255"><a href="#image_to_ascii_art-255"><span class="linenos">255</span></a><span class="sd">    :param nwidth: Output width in characters.</span>
</span><span id="image_to_ascii_art-256"><a href="#image_to_ascii_art-256"><span class="linenos">256</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="image_to_ascii_art-257"><a href="#image_to_ascii_art-257"><span class="linenos">257</span></a>    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
</span><span id="image_to_ascii_art-258"><a href="#image_to_ascii_art-258"><span class="linenos">258</span></a>    <span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">minmax_scale</span>
</span><span id="image_to_ascii_art-259"><a href="#image_to_ascii_art-259"><span class="linenos">259</span></a>
</span><span id="image_to_ascii_art-260"><a href="#image_to_ascii_art-260"><span class="linenos">260</span></a>    <span class="c1"># Open the image file</span>
</span><span id="image_to_ascii_art-261"><a href="#image_to_ascii_art-261"><span class="linenos">261</span></a>    <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
</span><span id="image_to_ascii_art-262"><a href="#image_to_ascii_art-262"><span class="linenos">262</span></a>
</span><span id="image_to_ascii_art-263"><a href="#image_to_ascii_art-263"><span class="linenos">263</span></a>    <span class="c1"># Resize the image to reduce the number of pixels</span>
</span><span id="image_to_ascii_art-264"><a href="#image_to_ascii_art-264"><span class="linenos">264</span></a>    <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">size</span>
</span><span id="image_to_ascii_art-265"><a href="#image_to_ascii_art-265"><span class="linenos">265</span></a>    <span class="n">aspect_ratio</span> <span class="o">=</span> <span class="n">height</span> <span class="o">/</span> <span class="n">width</span>
</span><span id="image_to_ascii_art-266"><a href="#image_to_ascii_art-266"><span class="linenos">266</span></a>    <span class="n">new_width</span> <span class="o">=</span> <span class="n">nwidth</span>
</span><span id="image_to_ascii_art-267"><a href="#image_to_ascii_art-267"><span class="linenos">267</span></a>    <span class="n">new_height</span> <span class="o">=</span> <span class="n">aspect_ratio</span> <span class="o">*</span> <span class="n">new_width</span> <span class="o">*</span> <span class="mf">0.55</span>  <span class="c1"># 0.55 is an adjustment factor</span>
</span><span id="image_to_ascii_art-268"><a href="#image_to_ascii_art-268"><span class="linenos">268</span></a>    <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="n">new_width</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">new_height</span><span class="p">)))</span>
</span><span id="image_to_ascii_art-269"><a href="#image_to_ascii_art-269"><span class="linenos">269</span></a>
</span><span id="image_to_ascii_art-270"><a href="#image_to_ascii_art-270"><span class="linenos">270</span></a>    <span class="c1"># Convert the image to grayscale.</span>
</span><span id="image_to_ascii_art-271"><a href="#image_to_ascii_art-271"><span class="linenos">271</span></a>    <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">)</span>
</span><span id="image_to_ascii_art-272"><a href="#image_to_ascii_art-272"><span class="linenos">272</span></a>
</span><span id="image_to_ascii_art-273"><a href="#image_to_ascii_art-273"><span class="linenos">273</span></a>    <span class="c1"># Define the ASCII character set to use (inverted colormap)</span>
</span><span id="image_to_ascii_art-274"><a href="#image_to_ascii_art-274"><span class="linenos">274</span></a>    <span class="n">char_set</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;@&quot;</span><span class="p">,</span> <span class="s2">&quot;#&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;&quot;</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">]</span>
</span><span id="image_to_ascii_art-275"><a href="#image_to_ascii_art-275"><span class="linenos">275</span></a>
</span><span id="image_to_ascii_art-276"><a href="#image_to_ascii_art-276"><span class="linenos">276</span></a>    <span class="c1"># Normalize the pixel values in the image.</span>
</span><span id="image_to_ascii_art-277"><a href="#image_to_ascii_art-277"><span class="linenos">277</span></a>    <span class="n">pixel_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">getdata</span><span class="p">())</span>
</span><span id="image_to_ascii_art-278"><a href="#image_to_ascii_art-278"><span class="linenos">278</span></a>    <span class="n">pixel_data_norm</span> <span class="o">=</span> <span class="n">minmax_scale</span><span class="p">(</span>
</span><span id="image_to_ascii_art-279"><a href="#image_to_ascii_art-279"><span class="linenos">279</span></a>        <span class="n">pixel_data</span><span class="p">,</span> <span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">char_set</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span>
</span><span id="image_to_ascii_art-280"><a href="#image_to_ascii_art-280"><span class="linenos">280</span></a>    <span class="p">)</span>
</span><span id="image_to_ascii_art-281"><a href="#image_to_ascii_art-281"><span class="linenos">281</span></a>    <span class="n">pixel_data_norm</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pixel_data_norm</span><span class="p">]</span>
</span><span id="image_to_ascii_art-282"><a href="#image_to_ascii_art-282"><span class="linenos">282</span></a>
</span><span id="image_to_ascii_art-283"><a href="#image_to_ascii_art-283"><span class="linenos">283</span></a>    <span class="n">char_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">char_set</span><span class="p">[</span><span class="n">pixel</span><span class="p">]</span> <span class="k">for</span> <span class="n">pixel</span> <span class="ow">in</span> <span class="n">pixel_data_norm</span><span class="p">]</span>
</span><span id="image_to_ascii_art-284"><a href="#image_to_ascii_art-284"><span class="linenos">284</span></a>    <span class="c1"># Generate the ASCII art string</span>
</span><span id="image_to_ascii_art-285"><a href="#image_to_ascii_art-285"><span class="linenos">285</span></a>    <span class="n">ascii_art</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="image_to_ascii_art-286"><a href="#image_to_ascii_art-286"><span class="linenos">286</span></a>        <span class="p">[</span>
</span><span id="image_to_ascii_art-287"><a href="#image_to_ascii_art-287"><span class="linenos">287</span></a>            <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">char_array</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">new_width</span><span class="p">)])</span>
</span><span id="image_to_ascii_art-288"><a href="#image_to_ascii_art-288"><span class="linenos">288</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">char_array</span><span class="p">),</span> <span class="n">new_width</span><span class="p">)</span>
</span><span id="image_to_ascii_art-289"><a href="#image_to_ascii_art-289"><span class="linenos">289</span></a>        <span class="p">]</span>
</span><span id="image_to_ascii_art-290"><a href="#image_to_ascii_art-290"><span class="linenos">290</span></a>    <span class="p">)</span>
</span><span id="image_to_ascii_art-291"><a href="#image_to_ascii_art-291"><span class="linenos">291</span></a>
</span><span id="image_to_ascii_art-292"><a href="#image_to_ascii_art-292"><span class="linenos">292</span></a>    <span class="c1"># Print the ASCII art string.</span>
</span><span id="image_to_ascii_art-293"><a href="#image_to_ascii_art-293"><span class="linenos">293</span></a>    <span class="nb">print</span><span class="p">(</span><span class="n">ascii_art</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Convert an image to ASCII art of given text width.</p>

<p>Function takes an input filename and width and prints an ASCII art representation to console.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>fname</strong>:  Input filename.</li>
<li><strong>nwidth</strong>:  Output width in characters.</li>
</ul>
</div>


                </section>
                <section id="generate_vector_dataframe">
                            <input id="generate_vector_dataframe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_vector_dataframe</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">base</span><span class="o">=</span><span class="mi">3</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="generate_vector_dataframe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#generate_vector_dataframe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="generate_vector_dataframe-296"><a href="#generate_vector_dataframe-296"><span class="linenos">296</span></a><span class="k">def</span> <span class="nf">generate_vector_dataframe</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
</span><span id="generate_vector_dataframe-297"><a href="#generate_vector_dataframe-297"><span class="linenos">297</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="generate_vector_dataframe-298"><a href="#generate_vector_dataframe-298"><span class="linenos">298</span></a><span class="sd">    Generate a pandas DataFrame containing all combinations for a vector of length 5 with a given base.</span>
</span><span id="generate_vector_dataframe-299"><a href="#generate_vector_dataframe-299"><span class="linenos">299</span></a>
</span><span id="generate_vector_dataframe-300"><a href="#generate_vector_dataframe-300"><span class="linenos">300</span></a><span class="sd">    :param base: An integer representing the base of the vector elements. Must be 2, 3, or 4.</span>
</span><span id="generate_vector_dataframe-301"><a href="#generate_vector_dataframe-301"><span class="linenos">301</span></a><span class="sd">    :return: A pandas DataFrame with columns &#39;chi1&#39;, &#39;chi2&#39;, &#39;chi3&#39;, &#39;chi4&#39;, &#39;chi5&#39;, where each row</span>
</span><span id="generate_vector_dataframe-302"><a href="#generate_vector_dataframe-302"><span class="linenos">302</span></a><span class="sd">             contains all combinations for a vector of length 5 with the specified base. The symbols used</span>
</span><span id="generate_vector_dataframe-303"><a href="#generate_vector_dataframe-303"><span class="linenos">303</span></a><span class="sd">             to represent the vector elements are &#39;-&#39; and &#39;+&#39; for base 2, &#39;-&#39; &#39;+&#39; and &#39;*&#39; for base 3,</span>
</span><span id="generate_vector_dataframe-304"><a href="#generate_vector_dataframe-304"><span class="linenos">304</span></a><span class="sd">             and &#39;-&#39; &#39;+&#39; &#39;*&#39; and &#39;@&#39; for base 4.</span>
</span><span id="generate_vector_dataframe-305"><a href="#generate_vector_dataframe-305"><span class="linenos">305</span></a><span class="sd">    :raises ValueError: If the specified base is not supported (i.e., not 2, 3, or 4).</span>
</span><span id="generate_vector_dataframe-306"><a href="#generate_vector_dataframe-306"><span class="linenos">306</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="generate_vector_dataframe-307"><a href="#generate_vector_dataframe-307"><span class="linenos">307</span></a>    <span class="kn">import</span> <span class="nn">itertools</span>
</span><span id="generate_vector_dataframe-308"><a href="#generate_vector_dataframe-308"><span class="linenos">308</span></a>
</span><span id="generate_vector_dataframe-309"><a href="#generate_vector_dataframe-309"><span class="linenos">309</span></a>    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="generate_vector_dataframe-310"><a href="#generate_vector_dataframe-310"><span class="linenos">310</span></a>
</span><span id="generate_vector_dataframe-311"><a href="#generate_vector_dataframe-311"><span class="linenos">311</span></a>    <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="generate_vector_dataframe-312"><a href="#generate_vector_dataframe-312"><span class="linenos">312</span></a>        <span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">]</span>
</span><span id="generate_vector_dataframe-313"><a href="#generate_vector_dataframe-313"><span class="linenos">313</span></a>    <span class="k">elif</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="generate_vector_dataframe-314"><a href="#generate_vector_dataframe-314"><span class="linenos">314</span></a>        <span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">]</span>
</span><span id="generate_vector_dataframe-315"><a href="#generate_vector_dataframe-315"><span class="linenos">315</span></a>    <span class="k">elif</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="generate_vector_dataframe-316"><a href="#generate_vector_dataframe-316"><span class="linenos">316</span></a>        <span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;@&quot;</span><span class="p">]</span>
</span><span id="generate_vector_dataframe-317"><a href="#generate_vector_dataframe-317"><span class="linenos">317</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="generate_vector_dataframe-318"><a href="#generate_vector_dataframe-318"><span class="linenos">318</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupported base&quot;</span><span class="p">)</span>
</span><span id="generate_vector_dataframe-319"><a href="#generate_vector_dataframe-319"><span class="linenos">319</span></a>
</span><span id="generate_vector_dataframe-320"><a href="#generate_vector_dataframe-320"><span class="linenos">320</span></a>    <span class="n">combinations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</span><span id="generate_vector_dataframe-321"><a href="#generate_vector_dataframe-321"><span class="linenos">321</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">combinations</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;chi1&quot;</span><span class="p">,</span> <span class="s2">&quot;chi2&quot;</span><span class="p">,</span> <span class="s2">&quot;chi3&quot;</span><span class="p">,</span> <span class="s2">&quot;chi4&quot;</span><span class="p">,</span> <span class="s2">&quot;chi5&quot;</span><span class="p">])</span>
</span><span id="generate_vector_dataframe-322"><a href="#generate_vector_dataframe-322"><span class="linenos">322</span></a>    <span class="k">return</span> <span class="n">df</span>
</span></pre></div>


            <div class="docstring"><p>Generate a pandas DataFrame containing all combinations for a vector of length 5 with a given base.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base</strong>:  An integer representing the base of the vector elements. Must be 2, 3, or 4.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A pandas DataFrame with columns 'chi1', 'chi2', 'chi3', 'chi4', 'chi5', where each row
           contains all combinations for a vector of length 5 with the specified base. The symbols used
           to represent the vector elements are '-' and '+' for base 2, '-' '+' and '<em>' for base 3,
           and '-' '+' '</em>' and '@' for base 4.</p>
</blockquote>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>:  If the specified base is not supported (i.e., not 2, 3, or 4).</li>
</ul>
</div>


                </section>
                <section id="sort_by_column">
                            <input id="sort_by_column-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sort_by_column</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">df</span>, </span><span class="param"><span class="n">column</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="sort_by_column-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#sort_by_column"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="sort_by_column-325"><a href="#sort_by_column-325"><span class="linenos">325</span></a><span class="k">def</span> <span class="nf">sort_by_column</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
</span><span id="sort_by_column-326"><a href="#sort_by_column-326"><span class="linenos">326</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="sort_by_column-327"><a href="#sort_by_column-327"><span class="linenos">327</span></a><span class="sd">    Sort a Pandas DataFrame by the values in the &#39;incidence&#39; column in descending order.</span>
</span><span id="sort_by_column-328"><a href="#sort_by_column-328"><span class="linenos">328</span></a>
</span><span id="sort_by_column-329"><a href="#sort_by_column-329"><span class="linenos">329</span></a><span class="sd">    :param df: The input DataFrame to be sorted.</span>
</span><span id="sort_by_column-330"><a href="#sort_by_column-330"><span class="linenos">330</span></a><span class="sd">    :type df: pandas.DataFrame</span>
</span><span id="sort_by_column-331"><a href="#sort_by_column-331"><span class="linenos">331</span></a><span class="sd">    :return: The sorted DataFrame.</span>
</span><span id="sort_by_column-332"><a href="#sort_by_column-332"><span class="linenos">332</span></a><span class="sd">    :rtype: pandas.DataFrame</span>
</span><span id="sort_by_column-333"><a href="#sort_by_column-333"><span class="linenos">333</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="sort_by_column-334"><a href="#sort_by_column-334"><span class="linenos">334</span></a>    <span class="n">sorted_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="sort_by_column-335"><a href="#sort_by_column-335"><span class="linenos">335</span></a>    <span class="k">return</span> <span class="n">sorted_df</span>
</span></pre></div>


            <div class="docstring"><p>Sort a Pandas DataFrame by the values in the 'incidence' column in descending order.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>df</strong>:  The input DataFrame to be sorted.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The sorted DataFrame.</p>
</blockquote>
</div>


                </section>
                <section id="plot_class_chart">
                            <input id="plot_class_chart-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_class_chart</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">classes</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="plot_class_chart-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#plot_class_chart"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="plot_class_chart-338"><a href="#plot_class_chart-338"><span class="linenos">338</span></a><span class="k">def</span> <span class="nf">plot_class_chart</span><span class="p">(</span><span class="n">classes</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="plot_class_chart-339"><a href="#plot_class_chart-339"><span class="linenos">339</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="plot_class_chart-340"><a href="#plot_class_chart-340"><span class="linenos">340</span></a><span class="sd">    Create a Matplotlib pie chart with `classes` segments of equal size.</span>
</span><span id="plot_class_chart-341"><a href="#plot_class_chart-341"><span class="linenos">341</span></a>
</span><span id="plot_class_chart-342"><a href="#plot_class_chart-342"><span class="linenos">342</span></a><span class="sd">    Parameters:</span>
</span><span id="plot_class_chart-343"><a href="#plot_class_chart-343"><span class="linenos">343</span></a><span class="sd">        classes (int): The number of segments to create in the pie chart.</span>
</span><span id="plot_class_chart-344"><a href="#plot_class_chart-344"><span class="linenos">344</span></a>
</span><span id="plot_class_chart-345"><a href="#plot_class_chart-345"><span class="linenos">345</span></a><span class="sd">    Returns:</span>
</span><span id="plot_class_chart-346"><a href="#plot_class_chart-346"><span class="linenos">346</span></a><span class="sd">        None</span>
</span><span id="plot_class_chart-347"><a href="#plot_class_chart-347"><span class="linenos">347</span></a>
</span><span id="plot_class_chart-348"><a href="#plot_class_chart-348"><span class="linenos">348</span></a><span class="sd">    Example:</span>
</span><span id="plot_class_chart-349"><a href="#plot_class_chart-349"><span class="linenos">349</span></a><span class="sd">    &gt;&gt;&gt; plot_class_chart(4)</span>
</span><span id="plot_class_chart-350"><a href="#plot_class_chart-350"><span class="linenos">350</span></a>
</span><span id="plot_class_chart-351"><a href="#plot_class_chart-351"><span class="linenos">351</span></a><span class="sd">    This will create a pie chart with 4 equal segments.</span>
</span><span id="plot_class_chart-352"><a href="#plot_class_chart-352"><span class="linenos">352</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="plot_class_chart-353"><a href="#plot_class_chart-353"><span class="linenos">353</span></a>    <span class="kn">import</span> <span class="nn">matplotlib</span>
</span><span id="plot_class_chart-354"><a href="#plot_class_chart-354"><span class="linenos">354</span></a>    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="plot_class_chart-355"><a href="#plot_class_chart-355"><span class="linenos">355</span></a>    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="plot_class_chart-356"><a href="#plot_class_chart-356"><span class="linenos">356</span></a>
</span><span id="plot_class_chart-357"><a href="#plot_class_chart-357"><span class="linenos">357</span></a>    <span class="kn">from</span> <span class="nn">proteusPy.angle_annotation</span> <span class="kn">import</span> <span class="n">AngleAnnotation</span>
</span><span id="plot_class_chart-358"><a href="#plot_class_chart-358"><span class="linenos">358</span></a>
</span><span id="plot_class_chart-359"><a href="#plot_class_chart-359"><span class="linenos">359</span></a>    <span class="c1"># Helper function to draw angle easily.</span>
</span><span id="plot_class_chart-360"><a href="#plot_class_chart-360"><span class="linenos">360</span></a>    <span class="k">def</span> <span class="nf">plot_angle</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">acol</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="plot_class_chart-361"><a href="#plot_class_chart-361"><span class="linenos">361</span></a>        <span class="n">vec2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">angle</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">angle</span><span class="p">))])</span>
</span><span id="plot_class_chart-362"><a href="#plot_class_chart-362"><span class="linenos">362</span></a>        <span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[[</span><span class="n">length</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">vec2</span> <span class="o">*</span> <span class="n">length</span><span class="p">]</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="plot_class_chart-363"><a href="#plot_class_chart-363"><span class="linenos">363</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">xy</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">acol</span><span class="p">)</span>
</span><span id="plot_class_chart-364"><a href="#plot_class_chart-364"><span class="linenos">364</span></a>        <span class="k">return</span> <span class="n">AngleAnnotation</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xy</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="plot_class_chart-365"><a href="#plot_class_chart-365"><span class="linenos">365</span></a>
</span><span id="plot_class_chart-366"><a href="#plot_class_chart-366"><span class="linenos">366</span></a>    <span class="c1"># fig = plt.figure(figsize=(WIDTH, HEIGHT), dpi=DPI)</span>
</span><span id="plot_class_chart-367"><a href="#plot_class_chart-367"><span class="linenos">367</span></a>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="plot_class_chart-368"><a href="#plot_class_chart-368"><span class="linenos">368</span></a>
</span><span id="plot_class_chart-369"><a href="#plot_class_chart-369"><span class="linenos">369</span></a>    <span class="c1"># ax1, ax2 = fig.subplots(1, 2, sharey=True, sharex=True)</span>
</span><span id="plot_class_chart-370"><a href="#plot_class_chart-370"><span class="linenos">370</span></a>
</span><span id="plot_class_chart-371"><a href="#plot_class_chart-371"><span class="linenos">371</span></a>    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;SS Torsion Classes&quot;</span><span class="p">)</span>
</span><span id="plot_class_chart-372"><a href="#plot_class_chart-372"><span class="linenos">372</span></a>    <span class="n">fig</span><span class="o">.</span><span class="n">set_dpi</span><span class="p">(</span><span class="mi">220</span><span class="p">)</span>
</span><span id="plot_class_chart-373"><a href="#plot_class_chart-373"><span class="linenos">373</span></a>    <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</span><span id="plot_class_chart-374"><a href="#plot_class_chart-374"><span class="linenos">374</span></a>
</span><span id="plot_class_chart-375"><a href="#plot_class_chart-375"><span class="linenos">375</span></a>    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>  <span class="c1"># Need to draw the figure to define renderer</span>
</span><span id="plot_class_chart-376"><a href="#plot_class_chart-376"><span class="linenos">376</span></a>
</span><span id="plot_class_chart-377"><a href="#plot_class_chart-377"><span class="linenos">377</span></a>    <span class="c1"># Showcase different text positions.</span>
</span><span id="plot_class_chart-378"><a href="#plot_class_chart-378"><span class="linenos">378</span></a>    <span class="n">ax1</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</span><span id="plot_class_chart-379"><a href="#plot_class_chart-379"><span class="linenos">379</span></a>    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;textposition&quot;</span><span class="p">)</span>
</span><span id="plot_class_chart-380"><a href="#plot_class_chart-380"><span class="linenos">380</span></a>    <span class="n">_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="mi">360</span><span class="o">/</span><span class="n">classes</span><span class="si">}</span><span class="s2">Â°$&quot;</span>
</span><span id="plot_class_chart-381"><a href="#plot_class_chart-381"><span class="linenos">381</span></a>    <span class="n">kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;points&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">_text</span><span class="p">)</span>
</span><span id="plot_class_chart-382"><a href="#plot_class_chart-382"><span class="linenos">382</span></a>
</span><span id="plot_class_chart-383"><a href="#plot_class_chart-383"><span class="linenos">383</span></a>    <span class="c1"># am6 = plot_angle(ax1, (2.0, 0), 60, textposition=&quot;inside&quot;, **kw)</span>
</span><span id="plot_class_chart-384"><a href="#plot_class_chart-384"><span class="linenos">384</span></a>    <span class="n">am7</span> <span class="o">=</span> <span class="n">plot_angle</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">360</span> <span class="o">/</span> <span class="n">classes</span><span class="p">,</span> <span class="n">textposition</span><span class="o">=</span><span class="s2">&quot;outside&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
</span><span id="plot_class_chart-385"><a href="#plot_class_chart-385"><span class="linenos">385</span></a>
</span><span id="plot_class_chart-386"><a href="#plot_class_chart-386"><span class="linenos">386</span></a>    <span class="c1"># Create a list of segment values</span>
</span><span id="plot_class_chart-387"><a href="#plot_class_chart-387"><span class="linenos">387</span></a>    <span class="c1"># !!!</span>
</span><span id="plot_class_chart-388"><a href="#plot_class_chart-388"><span class="linenos">388</span></a>    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">classes</span><span class="p">)]</span>
</span><span id="plot_class_chart-389"><a href="#plot_class_chart-389"><span class="linenos">389</span></a>
</span><span id="plot_class_chart-390"><a href="#plot_class_chart-390"><span class="linenos">390</span></a>    <span class="c1"># Create the pie chart</span>
</span><span id="plot_class_chart-391"><a href="#plot_class_chart-391"><span class="linenos">391</span></a>    <span class="c1"># fig, ax = plt.subplots()</span>
</span><span id="plot_class_chart-392"><a href="#plot_class_chart-392"><span class="linenos">392</span></a>    <span class="n">wedges</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span>
</span><span id="plot_class_chart-393"><a href="#plot_class_chart-393"><span class="linenos">393</span></a>        <span class="n">values</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">counterclock</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wedgeprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mf">0.65</span><span class="p">)</span>
</span><span id="plot_class_chart-394"><a href="#plot_class_chart-394"><span class="linenos">394</span></a>    <span class="p">)</span>
</span><span id="plot_class_chart-395"><a href="#plot_class_chart-395"><span class="linenos">395</span></a>
</span><span id="plot_class_chart-396"><a href="#plot_class_chart-396"><span class="linenos">396</span></a>    <span class="c1"># Set the chart title and size</span>
</span><span id="plot_class_chart-397"><a href="#plot_class_chart-397"><span class="linenos">397</span></a>    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">classes</span><span class="si">}</span><span class="s2">-Class Angular Layout&quot;</span><span class="p">)</span>
</span><span id="plot_class_chart-398"><a href="#plot_class_chart-398"><span class="linenos">398</span></a>
</span><span id="plot_class_chart-399"><a href="#plot_class_chart-399"><span class="linenos">399</span></a>    <span class="c1"># Set the segment colors</span>
</span><span id="plot_class_chart-400"><a href="#plot_class_chart-400"><span class="linenos">400</span></a>    <span class="n">color_palette</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colormaps</span><span class="p">[</span><span class="s2">&quot;tab20&quot;</span><span class="p">]</span>
</span><span id="plot_class_chart-401"><a href="#plot_class_chart-401"><span class="linenos">401</span></a>
</span><span id="plot_class_chart-402"><a href="#plot_class_chart-402"><span class="linenos">402</span></a>    <span class="c1"># color_palette = plt.cm.get_cmap(&quot;tab20&quot;, classes)</span>
</span><span id="plot_class_chart-403"><a href="#plot_class_chart-403"><span class="linenos">403</span></a>    <span class="n">ax1</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">color_palette</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">classes</span><span class="p">)])</span>
</span><span id="plot_class_chart-404"><a href="#plot_class_chart-404"><span class="linenos">404</span></a>
</span><span id="plot_class_chart-405"><a href="#plot_class_chart-405"><span class="linenos">405</span></a>    <span class="c1"># Create the legend</span>
</span><span id="plot_class_chart-406"><a href="#plot_class_chart-406"><span class="linenos">406</span></a>    <span class="n">legend_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Class </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">classes</span><span class="p">)]</span>
</span><span id="plot_class_chart-407"><a href="#plot_class_chart-407"><span class="linenos">407</span></a>    <span class="n">legend</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
</span><span id="plot_class_chart-408"><a href="#plot_class_chart-408"><span class="linenos">408</span></a>        <span class="n">wedges</span><span class="p">,</span>
</span><span id="plot_class_chart-409"><a href="#plot_class_chart-409"><span class="linenos">409</span></a>        <span class="n">legend_labels</span><span class="p">,</span>
</span><span id="plot_class_chart-410"><a href="#plot_class_chart-410"><span class="linenos">410</span></a>        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Classes&quot;</span><span class="p">,</span>
</span><span id="plot_class_chart-411"><a href="#plot_class_chart-411"><span class="linenos">411</span></a>        <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center left&quot;</span><span class="p">,</span>
</span><span id="plot_class_chart-412"><a href="#plot_class_chart-412"><span class="linenos">412</span></a>        <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
</span><span id="plot_class_chart-413"><a href="#plot_class_chart-413"><span class="linenos">413</span></a>    <span class="p">)</span>
</span><span id="plot_class_chart-414"><a href="#plot_class_chart-414"><span class="linenos">414</span></a>
</span><span id="plot_class_chart-415"><a href="#plot_class_chart-415"><span class="linenos">415</span></a>    <span class="c1"># Set the legend fontsize</span>
</span><span id="plot_class_chart-416"><a href="#plot_class_chart-416"><span class="linenos">416</span></a>    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">get_title</span><span class="p">(),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;large&quot;</span><span class="p">)</span>
</span><span id="plot_class_chart-417"><a href="#plot_class_chart-417"><span class="linenos">417</span></a>    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">get_texts</span><span class="p">(),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">)</span>
</span><span id="plot_class_chart-418"><a href="#plot_class_chart-418"><span class="linenos">418</span></a>
</span><span id="plot_class_chart-419"><a href="#plot_class_chart-419"><span class="linenos">419</span></a>    <span class="c1"># Show the chart</span>
</span><span id="plot_class_chart-420"><a href="#plot_class_chart-420"><span class="linenos">420</span></a>    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Create a Matplotlib pie chart with <code>classes</code> segments of equal size.</p>

<p>Parameters:
    classes (int): The number of segments to create in the pie chart.</p>

<p>Returns:
    None</p>

<p>Example:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_class_chart</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</code></pre>
</div>

<p>This will create a pie chart with 4 equal segments.</p>
</div>


                </section>
                <section id="retrieve_git_lfs_files">
                            <input id="retrieve_git_lfs_files-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">retrieve_git_lfs_files</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">repo_url</span>, </span><span class="param"><span class="n">objects</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="retrieve_git_lfs_files-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#retrieve_git_lfs_files"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="retrieve_git_lfs_files-423"><a href="#retrieve_git_lfs_files-423"><span class="linenos">423</span></a><span class="k">def</span> <span class="nf">retrieve_git_lfs_files</span><span class="p">(</span><span class="n">repo_url</span><span class="p">,</span> <span class="n">objects</span><span class="p">):</span>
</span><span id="retrieve_git_lfs_files-424"><a href="#retrieve_git_lfs_files-424"><span class="linenos">424</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="retrieve_git_lfs_files-425"><a href="#retrieve_git_lfs_files-425"><span class="linenos">425</span></a><span class="sd">    Retrieves a git-lfs json object from a specified repo.</span>
</span><span id="retrieve_git_lfs_files-426"><a href="#retrieve_git_lfs_files-426"><span class="linenos">426</span></a><span class="sd">    It does NOT download the file.</span>
</span><span id="retrieve_git_lfs_files-427"><a href="#retrieve_git_lfs_files-427"><span class="linenos">427</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="retrieve_git_lfs_files-428"><a href="#retrieve_git_lfs_files-428"><span class="linenos">428</span></a>    <span class="kn">import</span> <span class="nn">requests</span>
</span><span id="retrieve_git_lfs_files-429"><a href="#retrieve_git_lfs_files-429"><span class="linenos">429</span></a>
</span><span id="retrieve_git_lfs_files-430"><a href="#retrieve_git_lfs_files-430"><span class="linenos">430</span></a>    <span class="n">batch_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">repo_url</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">/info/lfs/objects/batch&quot;</span>
</span><span id="retrieve_git_lfs_files-431"><a href="#retrieve_git_lfs_files-431"><span class="linenos">431</span></a>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="retrieve_git_lfs_files-432"><a href="#retrieve_git_lfs_files-432"><span class="linenos">432</span></a>        <span class="s2">&quot;Accept&quot;</span><span class="p">:</span> <span class="s2">&quot;application/vnd.git-lfs+json&quot;</span><span class="p">,</span>
</span><span id="retrieve_git_lfs_files-433"><a href="#retrieve_git_lfs_files-433"><span class="linenos">433</span></a>        <span class="s2">&quot;Content-type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
</span><span id="retrieve_git_lfs_files-434"><a href="#retrieve_git_lfs_files-434"><span class="linenos">434</span></a>    <span class="p">}</span>
</span><span id="retrieve_git_lfs_files-435"><a href="#retrieve_git_lfs_files-435"><span class="linenos">435</span></a>    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;download&quot;</span><span class="p">,</span> <span class="s2">&quot;transfer&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;basic&quot;</span><span class="p">],</span> <span class="s2">&quot;objects&quot;</span><span class="p">:</span> <span class="n">objects</span><span class="p">}</span>
</span><span id="retrieve_git_lfs_files-436"><a href="#retrieve_git_lfs_files-436"><span class="linenos">436</span></a>
</span><span id="retrieve_git_lfs_files-437"><a href="#retrieve_git_lfs_files-437"><span class="linenos">437</span></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">batch_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="retrieve_git_lfs_files-438"><a href="#retrieve_git_lfs_files-438"><span class="linenos">438</span></a>    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
</span><span id="retrieve_git_lfs_files-439"><a href="#retrieve_git_lfs_files-439"><span class="linenos">439</span></a>        <span class="c1"># Process the response or save the files</span>
</span><span id="retrieve_git_lfs_files-440"><a href="#retrieve_git_lfs_files-440"><span class="linenos">440</span></a>        <span class="c1"># For example, you can access the file contents using response.json()</span>
</span><span id="retrieve_git_lfs_files-441"><a href="#retrieve_git_lfs_files-441"><span class="linenos">441</span></a>        <span class="c1"># and save them to the desired location on your system.</span>
</span><span id="retrieve_git_lfs_files-442"><a href="#retrieve_git_lfs_files-442"><span class="linenos">442</span></a>        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span><span id="retrieve_git_lfs_files-443"><a href="#retrieve_git_lfs_files-443"><span class="linenos">443</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="retrieve_git_lfs_files-444"><a href="#retrieve_git_lfs_files-444"><span class="linenos">444</span></a>        <span class="c1"># Handle error case</span>
</span><span id="retrieve_git_lfs_files-445"><a href="#retrieve_git_lfs_files-445"><span class="linenos">445</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="retrieve_git_lfs_files-446"><a href="#retrieve_git_lfs_files-446"><span class="linenos">446</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Retrieves a git-lfs json object from a specified repo.
It does NOT download the file.</p>
</div>


                </section>
                <section id="display_ss_pymol">
                            <input id="display_ss_pymol-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">display_ss_pymol</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">pdbid</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">proximal</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">distal</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">chain</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">solvent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">ray</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">width</span><span class="o">=</span><span class="mi">800</span>,</span><span class="param">	<span class="n">height</span><span class="o">=</span><span class="mi">600</span>,</span><span class="param">	<span class="n">dpi</span><span class="o">=</span><span class="mi">300</span>,</span><span class="param">	<span class="n">fname</span><span class="o">=</span><span class="s1">&#39;ss_pymol.png&#39;</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="display_ss_pymol-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#display_ss_pymol"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="display_ss_pymol-449"><a href="#display_ss_pymol-449"><span class="linenos">449</span></a><span class="k">def</span> <span class="nf">display_ss_pymol</span><span class="p">(</span>
</span><span id="display_ss_pymol-450"><a href="#display_ss_pymol-450"><span class="linenos">450</span></a>    <span class="n">pdbid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="display_ss_pymol-451"><a href="#display_ss_pymol-451"><span class="linenos">451</span></a>    <span class="n">proximal</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="display_ss_pymol-452"><a href="#display_ss_pymol-452"><span class="linenos">452</span></a>    <span class="n">distal</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="display_ss_pymol-453"><a href="#display_ss_pymol-453"><span class="linenos">453</span></a>    <span class="n">chain</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="display_ss_pymol-454"><a href="#display_ss_pymol-454"><span class="linenos">454</span></a>    <span class="n">solvent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="display_ss_pymol-455"><a href="#display_ss_pymol-455"><span class="linenos">455</span></a>    <span class="n">ray</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="display_ss_pymol-456"><a href="#display_ss_pymol-456"><span class="linenos">456</span></a>    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
</span><span id="display_ss_pymol-457"><a href="#display_ss_pymol-457"><span class="linenos">457</span></a>    <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
</span><span id="display_ss_pymol-458"><a href="#display_ss_pymol-458"><span class="linenos">458</span></a>    <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
</span><span id="display_ss_pymol-459"><a href="#display_ss_pymol-459"><span class="linenos">459</span></a>    <span class="n">fname</span><span class="o">=</span><span class="s2">&quot;ss_pymol.png&quot;</span><span class="p">,</span>
</span><span id="display_ss_pymol-460"><a href="#display_ss_pymol-460"><span class="linenos">460</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="display_ss_pymol-461"><a href="#display_ss_pymol-461"><span class="linenos">461</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="display_ss_pymol-462"><a href="#display_ss_pymol-462"><span class="linenos">462</span></a><span class="sd">    Visualizes specific residues within a given protein structure in PyMOL.</span>
</span><span id="display_ss_pymol-463"><a href="#display_ss_pymol-463"><span class="linenos">463</span></a>
</span><span id="display_ss_pymol-464"><a href="#display_ss_pymol-464"><span class="linenos">464</span></a><span class="sd">    This function fetches a protein structure by its PDB ID, removes all other chains except</span>
</span><span id="display_ss_pymol-465"><a href="#display_ss_pymol-465"><span class="linenos">465</span></a><span class="sd">    the specified one, and then shows the proximal and distal residues in spheres. Optionally,</span>
</span><span id="display_ss_pymol-466"><a href="#display_ss_pymol-466"><span class="linenos">466</span></a><span class="sd">    it can also show solvent molecules as spheres.</span>
</span><span id="display_ss_pymol-467"><a href="#display_ss_pymol-467"><span class="linenos">467</span></a>
</span><span id="display_ss_pymol-468"><a href="#display_ss_pymol-468"><span class="linenos">468</span></a><span class="sd">    Parameters:</span>
</span><span id="display_ss_pymol-469"><a href="#display_ss_pymol-469"><span class="linenos">469</span></a><span class="sd">    - pdbid (str): The PDB ID of the protein structure to visualize.</span>
</span><span id="display_ss_pymol-470"><a href="#display_ss_pymol-470"><span class="linenos">470</span></a><span class="sd">    - proximal (int): The residue number of the proximal residue to visualize.</span>
</span><span id="display_ss_pymol-471"><a href="#display_ss_pymol-471"><span class="linenos">471</span></a><span class="sd">    - distal (int): The residue number of the distal residue to visualize.</span>
</span><span id="display_ss_pymol-472"><a href="#display_ss_pymol-472"><span class="linenos">472</span></a><span class="sd">    - chain (str): The chain identifier of the residues to visualize.</span>
</span><span id="display_ss_pymol-473"><a href="#display_ss_pymol-473"><span class="linenos">473</span></a><span class="sd">    - solvent (bool, optional): Whether to show solvent molecules. Defaults to True.</span>
</span><span id="display_ss_pymol-474"><a href="#display_ss_pymol-474"><span class="linenos">474</span></a>
</span><span id="display_ss_pymol-475"><a href="#display_ss_pymol-475"><span class="linenos">475</span></a><span class="sd">    Returns:</span>
</span><span id="display_ss_pymol-476"><a href="#display_ss_pymol-476"><span class="linenos">476</span></a><span class="sd">    - None</span>
</span><span id="display_ss_pymol-477"><a href="#display_ss_pymol-477"><span class="linenos">477</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="display_ss_pymol-478"><a href="#display_ss_pymol-478"><span class="linenos">478</span></a>    <span class="kn">import</span> <span class="nn">pymolPy3</span>
</span><span id="display_ss_pymol-479"><a href="#display_ss_pymol-479"><span class="linenos">479</span></a>
</span><span id="display_ss_pymol-480"><a href="#display_ss_pymol-480"><span class="linenos">480</span></a>    <span class="n">pm</span> <span class="o">=</span> <span class="n">pymolPy3</span><span class="o">.</span><span class="n">pymolPy3</span><span class="p">()</span>
</span><span id="display_ss_pymol-481"><a href="#display_ss_pymol-481"><span class="linenos">481</span></a>
</span><span id="display_ss_pymol-482"><a href="#display_ss_pymol-482"><span class="linenos">482</span></a>    <span class="n">pm</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;fetch </span><span class="si">{</span><span class="n">pdbid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="display_ss_pymol-483"><a href="#display_ss_pymol-483"><span class="linenos">483</span></a>    <span class="n">pm</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;remove not chain </span><span class="si">{</span><span class="n">chain</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="display_ss_pymol-484"><a href="#display_ss_pymol-484"><span class="linenos">484</span></a>    <span class="n">pm</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;show spheres, resi </span><span class="si">{</span><span class="n">proximal</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">distal</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="display_ss_pymol-485"><a href="#display_ss_pymol-485"><span class="linenos">485</span></a>    <span class="k">if</span> <span class="n">solvent</span><span class="p">:</span>
</span><span id="display_ss_pymol-486"><a href="#display_ss_pymol-486"><span class="linenos">486</span></a>        <span class="n">pm</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;show spheres, solvent&quot;</span><span class="p">)</span>
</span><span id="display_ss_pymol-487"><a href="#display_ss_pymol-487"><span class="linenos">487</span></a>
</span><span id="display_ss_pymol-488"><a href="#display_ss_pymol-488"><span class="linenos">488</span></a>    <span class="n">pm</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;color green, resi </span><span class="si">{</span><span class="n">proximal</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">distal</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="display_ss_pymol-489"><a href="#display_ss_pymol-489"><span class="linenos">489</span></a>    <span class="n">pm</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;zoom resi </span><span class="si">{</span><span class="n">proximal</span><span class="si">}</span><span class="s2">+</span><span class="si">{</span><span class="n">distal</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="display_ss_pymol-490"><a href="#display_ss_pymol-490"><span class="linenos">490</span></a>    <span class="k">if</span> <span class="n">ray</span><span class="p">:</span>
</span><span id="display_ss_pymol-491"><a href="#display_ss_pymol-491"><span class="linenos">491</span></a>        <span class="n">pm</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ray </span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="display_ss_pymol-492"><a href="#display_ss_pymol-492"><span class="linenos">492</span></a>        <span class="n">pm</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;png </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2">, dpi=</span><span class="si">{</span><span class="n">dpi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="display_ss_pymol-493"><a href="#display_ss_pymol-493"><span class="linenos">493</span></a>
</span><span id="display_ss_pymol-494"><a href="#display_ss_pymol-494"><span class="linenos">494</span></a>    <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Press Enter to continue...&quot;</span><span class="p">)</span>
</span><span id="display_ss_pymol-495"><a href="#display_ss_pymol-495"><span class="linenos">495</span></a>    <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Visualizes specific residues within a given protein structure in PyMOL.</p>

<p>This function fetches a protein structure by its PDB ID, removes all other chains except
the specified one, and then shows the proximal and distal residues in spheres. Optionally,
it can also show solvent molecules as spheres.</p>

<p>Parameters:</p>

<ul>
<li>pdbid (str): The PDB ID of the protein structure to visualize.</li>
<li>proximal (int): The residue number of the proximal residue to visualize.</li>
<li>distal (int): The residue number of the distal residue to visualize.</li>
<li>chain (str): The chain identifier of the residues to visualize.</li>
<li>solvent (bool, optional): Whether to show solvent molecules. Defaults to True.</li>
</ul>

<p>Returns:</p>

<ul>
<li>None</li>
</ul>
</div>


                </section>
                <section id="parse_ssbond_header_rec">
                            <input id="parse_ssbond_header_rec-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parse_ssbond_header_rec</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">ssbond_dict</span><span class="p">:</span> <span class="nb">dict</span>, </span><span class="param"><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">list</span>:</span></span>

                <label class="view-source-button" for="parse_ssbond_header_rec-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#parse_ssbond_header_rec"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="parse_ssbond_header_rec-498"><a href="#parse_ssbond_header_rec-498"><span class="linenos">498</span></a><span class="k">def</span> <span class="nf">parse_ssbond_header_rec</span><span class="p">(</span><span class="n">ssbond_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="parse_ssbond_header_rec-499"><a href="#parse_ssbond_header_rec-499"><span class="linenos">499</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="parse_ssbond_header_rec-500"><a href="#parse_ssbond_header_rec-500"><span class="linenos">500</span></a><span class="sd">    Parse the SSBOND dict returned by parse_pdb_header.</span>
</span><span id="parse_ssbond_header_rec-501"><a href="#parse_ssbond_header_rec-501"><span class="linenos">501</span></a><span class="sd">    NB: Requires EGS-Modified BIO.parse_pdb_header.py.</span>
</span><span id="parse_ssbond_header_rec-502"><a href="#parse_ssbond_header_rec-502"><span class="linenos">502</span></a><span class="sd">    This is used internally.</span>
</span><span id="parse_ssbond_header_rec-503"><a href="#parse_ssbond_header_rec-503"><span class="linenos">503</span></a>
</span><span id="parse_ssbond_header_rec-504"><a href="#parse_ssbond_header_rec-504"><span class="linenos">504</span></a><span class="sd">    :param ssbond_dict: the input SSBOND dict</span>
</span><span id="parse_ssbond_header_rec-505"><a href="#parse_ssbond_header_rec-505"><span class="linenos">505</span></a><span class="sd">    :return: A list of tuples representing the proximal,</span>
</span><span id="parse_ssbond_header_rec-506"><a href="#parse_ssbond_header_rec-506"><span class="linenos">506</span></a><span class="sd">        distal residue ids for the Disulfide.</span>
</span><span id="parse_ssbond_header_rec-507"><a href="#parse_ssbond_header_rec-507"><span class="linenos">507</span></a>
</span><span id="parse_ssbond_header_rec-508"><a href="#parse_ssbond_header_rec-508"><span class="linenos">508</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="parse_ssbond_header_rec-509"><a href="#parse_ssbond_header_rec-509"><span class="linenos">509</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="parse_ssbond_header_rec-510"><a href="#parse_ssbond_header_rec-510"><span class="linenos">510</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parse_ssbond_header_rec(): </span><span class="si">{</span><span class="n">ssbond_dict</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="parse_ssbond_header_rec-511"><a href="#parse_ssbond_header_rec-511"><span class="linenos">511</span></a>
</span><span id="parse_ssbond_header_rec-512"><a href="#parse_ssbond_header_rec-512"><span class="linenos">512</span></a>    <span class="n">disulfide_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="parse_ssbond_header_rec-513"><a href="#parse_ssbond_header_rec-513"><span class="linenos">513</span></a>    <span class="k">for</span> <span class="n">ssb</span> <span class="ow">in</span> <span class="n">ssbond_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="parse_ssbond_header_rec-514"><a href="#parse_ssbond_header_rec-514"><span class="linenos">514</span></a>        <span class="n">disulfide_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ssb</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="parse_ssbond_header_rec-515"><a href="#parse_ssbond_header_rec-515"><span class="linenos">515</span></a>
</span><span id="parse_ssbond_header_rec-516"><a href="#parse_ssbond_header_rec-516"><span class="linenos">516</span></a>    <span class="k">return</span> <span class="n">disulfide_list</span>
</span></pre></div>


            <div class="docstring"><p>Parse the SSBOND dict returned by parse_pdb_header.
NB: Requires EGS-Modified BIO.parse_pdb_header.py.
This is used internally.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>ssbond_dict</strong>:  the input SSBOND dict</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A list of tuples representing the proximal,
      distal residue ids for the Disulfide.</p>
</blockquote>
</div>


                </section>
                <section id="Download_Disulfides">
                            <input id="Download_Disulfides-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">Download_Disulfides</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">pdb_home</span><span class="o">=</span><span class="s1">&#39;/Users/egs/PDB/&#39;</span>,</span><span class="param">	<span class="n">model_home</span><span class="o">=</span><span class="s1">&#39;/Users/egs/PDB/good/&#39;</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">reset</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Download_Disulfides-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Download_Disulfides"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Download_Disulfides-519"><a href="#Download_Disulfides-519"><span class="linenos">519</span></a><span class="k">def</span> <span class="nf">Download_Disulfides</span><span class="p">(</span>
</span><span id="Download_Disulfides-520"><a href="#Download_Disulfides-520"><span class="linenos">520</span></a>    <span class="n">pdb_home</span><span class="o">=</span><span class="n">PDB_DIR</span><span class="p">,</span> <span class="n">model_home</span><span class="o">=</span><span class="n">MODEL_DIR</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">False</span>
</span><span id="Download_Disulfides-521"><a href="#Download_Disulfides-521"><span class="linenos">521</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Download_Disulfides-522"><a href="#Download_Disulfides-522"><span class="linenos">522</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Download_Disulfides-523"><a href="#Download_Disulfides-523"><span class="linenos">523</span></a><span class="sd">    Read a comma separated list of PDB IDs and download them to the ``pdb_home`` path.</span>
</span><span id="Download_Disulfides-524"><a href="#Download_Disulfides-524"><span class="linenos">524</span></a>
</span><span id="Download_Disulfides-525"><a href="#Download_Disulfides-525"><span class="linenos">525</span></a><span class="sd">    This utility function is used to download proteins containing at least one</span>
</span><span id="Download_Disulfides-526"><a href="#Download_Disulfides-526"><span class="linenos">526</span></a><span class="sd">    SS bond with the ID list generated from: http://www.rcsb.org/.</span>
</span><span id="Download_Disulfides-527"><a href="#Download_Disulfides-527"><span class="linenos">527</span></a>
</span><span id="Download_Disulfides-528"><a href="#Download_Disulfides-528"><span class="linenos">528</span></a><span class="sd">    This is the primary data loader for the proteusPy Disulfide analysis package.</span>
</span><span id="Download_Disulfides-529"><a href="#Download_Disulfides-529"><span class="linenos">529</span></a><span class="sd">    The list of IDs represents files in the RCSB containing &gt; 1 disulfide bond,</span>
</span><span id="Download_Disulfides-530"><a href="#Download_Disulfides-530"><span class="linenos">530</span></a><span class="sd">    and it contains over 39000 structures. The total download takes about 12 hours.</span>
</span><span id="Download_Disulfides-531"><a href="#Download_Disulfides-531"><span class="linenos">531</span></a><span class="sd">    The function keeps track of downloaded files so it&#39;s possible to interrupt and</span>
</span><span id="Download_Disulfides-532"><a href="#Download_Disulfides-532"><span class="linenos">532</span></a><span class="sd">    restart the download without duplicating effort.</span>
</span><span id="Download_Disulfides-533"><a href="#Download_Disulfides-533"><span class="linenos">533</span></a>
</span><span id="Download_Disulfides-534"><a href="#Download_Disulfides-534"><span class="linenos">534</span></a><span class="sd">    :param pdb_home: Path for downloaded files, defaults to PDB_DIR</span>
</span><span id="Download_Disulfides-535"><a href="#Download_Disulfides-535"><span class="linenos">535</span></a><span class="sd">    :param model_home: Path for extracted data, defaults to MODEL_DIR</span>
</span><span id="Download_Disulfides-536"><a href="#Download_Disulfides-536"><span class="linenos">536</span></a><span class="sd">    :param verbose: Verbosity, defaults to False</span>
</span><span id="Download_Disulfides-537"><a href="#Download_Disulfides-537"><span class="linenos">537</span></a><span class="sd">    :param reset: Reset the downloaded files index. Used to restart the download.</span>
</span><span id="Download_Disulfides-538"><a href="#Download_Disulfides-538"><span class="linenos">538</span></a><span class="sd">    :raises DisulfideIOException: I/O error raised when the PDB file is not found.</span>
</span><span id="Download_Disulfides-539"><a href="#Download_Disulfides-539"><span class="linenos">539</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Download_Disulfides-540"><a href="#Download_Disulfides-540"><span class="linenos">540</span></a>    <span class="kn">import</span> <span class="nn">os</span>
</span><span id="Download_Disulfides-541"><a href="#Download_Disulfides-541"><span class="linenos">541</span></a>    <span class="kn">import</span> <span class="nn">time</span>
</span><span id="Download_Disulfides-542"><a href="#Download_Disulfides-542"><span class="linenos">542</span></a>
</span><span id="Download_Disulfides-543"><a href="#Download_Disulfides-543"><span class="linenos">543</span></a>    <span class="kn">from</span> <span class="nn">Bio.PDB</span> <span class="kn">import</span> <span class="n">PDBList</span>
</span><span id="Download_Disulfides-544"><a href="#Download_Disulfides-544"><span class="linenos">544</span></a>
</span><span id="Download_Disulfides-545"><a href="#Download_Disulfides-545"><span class="linenos">545</span></a>    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Download_Disulfides-546"><a href="#Download_Disulfides-546"><span class="linenos">546</span></a>    <span class="n">donelines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Download_Disulfides-547"><a href="#Download_Disulfides-547"><span class="linenos">547</span></a>    <span class="n">SS_done</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Download_Disulfides-548"><a href="#Download_Disulfides-548"><span class="linenos">548</span></a>    <span class="n">ssfile</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Download_Disulfides-549"><a href="#Download_Disulfides-549"><span class="linenos">549</span></a>
</span><span id="Download_Disulfides-550"><a href="#Download_Disulfides-550"><span class="linenos">550</span></a>    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</span><span id="Download_Disulfides-551"><a href="#Download_Disulfides-551"><span class="linenos">551</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">pdb_home</span><span class="p">)</span>
</span><span id="Download_Disulfides-552"><a href="#Download_Disulfides-552"><span class="linenos">552</span></a>
</span><span id="Download_Disulfides-553"><a href="#Download_Disulfides-553"><span class="linenos">553</span></a>    <span class="n">pdblist</span> <span class="o">=</span> <span class="n">PDBList</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="Download_Disulfides-554"><a href="#Download_Disulfides-554"><span class="linenos">554</span></a>    <span class="n">ssfilename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_home</span><span class="si">}{</span><span class="n">SS_ID_FILE</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Download_Disulfides-555"><a href="#Download_Disulfides-555"><span class="linenos">555</span></a>    <span class="nb">print</span><span class="p">(</span><span class="n">ssfilename</span><span class="p">)</span>
</span><span id="Download_Disulfides-556"><a href="#Download_Disulfides-556"><span class="linenos">556</span></a>
</span><span id="Download_Disulfides-557"><a href="#Download_Disulfides-557"><span class="linenos">557</span></a>    <span class="c1"># list of IDs containing &gt;1 SSBond record</span>
</span><span id="Download_Disulfides-558"><a href="#Download_Disulfides-558"><span class="linenos">558</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="Download_Disulfides-559"><a href="#Download_Disulfides-559"><span class="linenos">559</span></a>        <span class="n">ssfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">ssfilename</span><span class="p">)</span>
</span><span id="Download_Disulfides-560"><a href="#Download_Disulfides-560"><span class="linenos">560</span></a>        <span class="n">Line</span> <span class="o">=</span> <span class="n">ssfile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="Download_Disulfides-561"><a href="#Download_Disulfides-561"><span class="linenos">561</span></a>    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="Download_Disulfides-562"><a href="#Download_Disulfides-562"><span class="linenos">562</span></a>        <span class="k">raise</span> <span class="n">DisulfideIOException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot open file: </span><span class="si">{</span><span class="n">ssfile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Download_Disulfides-563"><a href="#Download_Disulfides-563"><span class="linenos">563</span></a>
</span><span id="Download_Disulfides-564"><a href="#Download_Disulfides-564"><span class="linenos">564</span></a>    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">Line</span><span class="p">:</span>
</span><span id="Download_Disulfides-565"><a href="#Download_Disulfides-565"><span class="linenos">565</span></a>        <span class="n">entries</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
</span><span id="Download_Disulfides-566"><a href="#Download_Disulfides-566"><span class="linenos">566</span></a>
</span><span id="Download_Disulfides-567"><a href="#Download_Disulfides-567"><span class="linenos">567</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span><span class="si">}</span><span class="s2"> entries&quot;</span><span class="p">)</span>
</span><span id="Download_Disulfides-568"><a href="#Download_Disulfides-568"><span class="linenos">568</span></a>    <span class="n">completed</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;xxx&quot;</span><span class="p">}</span>  <span class="c1"># set to keep track of downloaded</span>
</span><span id="Download_Disulfides-569"><a href="#Download_Disulfides-569"><span class="linenos">569</span></a>
</span><span id="Download_Disulfides-570"><a href="#Download_Disulfides-570"><span class="linenos">570</span></a>    <span class="c1"># file to track already downloaded entries.</span>
</span><span id="Download_Disulfides-571"><a href="#Download_Disulfides-571"><span class="linenos">571</span></a>    <span class="k">if</span> <span class="n">reset</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Download_Disulfides-572"><a href="#Download_Disulfides-572"><span class="linenos">572</span></a>        <span class="n">completed_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_home</span><span class="si">}</span><span class="s2">ss_completed.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
</span><span id="Download_Disulfides-573"><a href="#Download_Disulfides-573"><span class="linenos">573</span></a>        <span class="n">donelines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Download_Disulfides-574"><a href="#Download_Disulfides-574"><span class="linenos">574</span></a>        <span class="n">SS_DONE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Download_Disulfides-575"><a href="#Download_Disulfides-575"><span class="linenos">575</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Download_Disulfides-576"><a href="#Download_Disulfides-576"><span class="linenos">576</span></a>        <span class="n">completed_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_home</span><span class="si">}</span><span class="s2">ss_completed.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">)</span>
</span><span id="Download_Disulfides-577"><a href="#Download_Disulfides-577"><span class="linenos">577</span></a>        <span class="n">donelines</span> <span class="o">=</span> <span class="n">completed_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="Download_Disulfides-578"><a href="#Download_Disulfides-578"><span class="linenos">578</span></a>
</span><span id="Download_Disulfides-579"><a href="#Download_Disulfides-579"><span class="linenos">579</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">donelines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Download_Disulfides-580"><a href="#Download_Disulfides-580"><span class="linenos">580</span></a>        <span class="k">for</span> <span class="n">dl</span> <span class="ow">in</span> <span class="n">donelines</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="Download_Disulfides-581"><a href="#Download_Disulfides-581"><span class="linenos">581</span></a>            <span class="c1"># create a list of pdb id already downloaded</span>
</span><span id="Download_Disulfides-582"><a href="#Download_Disulfides-582"><span class="linenos">582</span></a>            <span class="n">SS_done</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
</span><span id="Download_Disulfides-583"><a href="#Download_Disulfides-583"><span class="linenos">583</span></a>
</span><span id="Download_Disulfides-584"><a href="#Download_Disulfides-584"><span class="linenos">584</span></a>    <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">SS_done</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Download_Disulfides-585"><a href="#Download_Disulfides-585"><span class="linenos">585</span></a>    <span class="n">completed</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">SS_done</span><span class="p">)</span>  <span class="c1"># update the completed set with what&#39;s downloaded</span>
</span><span id="Download_Disulfides-586"><a href="#Download_Disulfides-586"><span class="linenos">586</span></a>
</span><span id="Download_Disulfides-587"><a href="#Download_Disulfides-587"><span class="linenos">587</span></a>    <span class="c1"># Loop over all entries,</span>
</span><span id="Download_Disulfides-588"><a href="#Download_Disulfides-588"><span class="linenos">588</span></a>    <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">PBAR_COLS</span><span class="p">)</span>
</span><span id="Download_Disulfides-589"><a href="#Download_Disulfides-589"><span class="linenos">589</span></a>    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">pbar</span><span class="p">:</span>
</span><span id="Download_Disulfides-590"><a href="#Download_Disulfides-590"><span class="linenos">590</span></a>        <span class="n">pbar</span><span class="o">.</span><span class="n">set_postfix</span><span class="p">({</span><span class="s2">&quot;Entry&quot;</span><span class="p">:</span> <span class="n">entry</span><span class="p">})</span>
</span><span id="Download_Disulfides-591"><a href="#Download_Disulfides-591"><span class="linenos">591</span></a>        <span class="k">if</span> <span class="n">entry</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">completed</span><span class="p">:</span>
</span><span id="Download_Disulfides-592"><a href="#Download_Disulfides-592"><span class="linenos">592</span></a>            <span class="k">if</span> <span class="n">pdblist</span><span class="o">.</span><span class="n">retrieve_pdb_file</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s2">&quot;pdb&quot;</span><span class="p">,</span> <span class="n">pdir</span><span class="o">=</span><span class="n">pdb_home</span><span class="p">):</span>
</span><span id="Download_Disulfides-593"><a href="#Download_Disulfides-593"><span class="linenos">593</span></a>                <span class="n">completed</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span><span id="Download_Disulfides-594"><a href="#Download_Disulfides-594"><span class="linenos">594</span></a>                <span class="n">completed_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
</span><span id="Download_Disulfides-595"><a href="#Download_Disulfides-595"><span class="linenos">595</span></a>                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Download_Disulfides-596"><a href="#Download_Disulfides-596"><span class="linenos">596</span></a>
</span><span id="Download_Disulfides-597"><a href="#Download_Disulfides-597"><span class="linenos">597</span></a>    <span class="n">completed_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Download_Disulfides-598"><a href="#Download_Disulfides-598"><span class="linenos">598</span></a>
</span><span id="Download_Disulfides-599"><a href="#Download_Disulfides-599"><span class="linenos">599</span></a>    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Download_Disulfides-600"><a href="#Download_Disulfides-600"><span class="linenos">600</span></a>    <span class="n">elapsed</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>
</span><span id="Download_Disulfides-601"><a href="#Download_Disulfides-601"><span class="linenos">601</span></a>
</span><span id="Download_Disulfides-602"><a href="#Download_Disulfides-602"><span class="linenos">602</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Overall files processed: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Download_Disulfides-603"><a href="#Download_Disulfides-603"><span class="linenos">603</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Complete. Elapsed time: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed</span><span class="p">)</span><span class="si">}</span><span class="s2"> (h:m:s)&quot;</span><span class="p">)</span>
</span><span id="Download_Disulfides-604"><a href="#Download_Disulfides-604"><span class="linenos">604</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
</span><span id="Download_Disulfides-605"><a href="#Download_Disulfides-605"><span class="linenos">605</span></a>    <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>Read a comma separated list of PDB IDs and download them to the <code>pdb_home</code> path.</p>

<p>This utility function is used to download proteins containing at least one
SS bond with the ID list generated from: <a href="http://www.rcsb.org/">http://www.rcsb.org/</a>.</p>

<p>This is the primary data loader for the proteusPy Disulfide analysis package.
The list of IDs represents files in the RCSB containing &gt; 1 disulfide bond,
and it contains over 39000 structures. The total download takes about 12 hours.
The function keeps track of downloaded files so it's possible to interrupt and
restart the download without duplicating effort.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>pdb_home</strong>:  Path for downloaded files, defaults to PDB_DIR</li>
<li><strong>model_home</strong>:  Path for extracted data, defaults to MODEL_DIR</li>
<li><strong>verbose</strong>:  Verbosity, defaults to False</li>
<li><strong>reset</strong>:  Reset the downloaded files index. Used to restart the download.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>DisulfideIOException</strong>:  I/O error raised when the PDB file is not found.</li>
</ul>
</div>


                </section>
                <section id="remove_duplicate_ss">
                            <input id="remove_duplicate_ss-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_duplicate_ss</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">sslist</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">module</span> <span class="s1">&#39;<a href="DisulfideList.html">proteusPy.DisulfideList</a>&#39;</span> <span class="kn">from</span> <span class="s1">&#39;/Users/egs/repos/proteusPy/proteusPy/DisulfideList.py&#39;</span><span class="o">&gt;</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="o">&lt;</span><span class="n">module</span> <span class="s1">&#39;<a href="Disulfide.html">proteusPy.Disulfide</a>&#39;</span> <span class="kn">from</span> <span class="s1">&#39;/Users/egs/repos/proteusPy/proteusPy/Disulfide.py&#39;</span><span class="o">&gt;</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="remove_duplicate_ss-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#remove_duplicate_ss"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="remove_duplicate_ss-608"><a href="#remove_duplicate_ss-608"><span class="linenos">608</span></a><span class="k">def</span> <span class="nf">remove_duplicate_ss</span><span class="p">(</span><span class="n">sslist</span><span class="p">:</span> <span class="n">DisulfideList</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Disulfide</span><span class="p">]:</span>
</span><span id="remove_duplicate_ss-609"><a href="#remove_duplicate_ss-609"><span class="linenos">609</span></a>    <span class="n">pruned</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="remove_duplicate_ss-610"><a href="#remove_duplicate_ss-610"><span class="linenos">610</span></a>    <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">:</span>
</span><span id="remove_duplicate_ss-611"><a href="#remove_duplicate_ss-611"><span class="linenos">611</span></a>        <span class="k">if</span> <span class="n">ss</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pruned</span><span class="p">:</span>
</span><span id="remove_duplicate_ss-612"><a href="#remove_duplicate_ss-612"><span class="linenos">612</span></a>            <span class="n">pruned</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
</span><span id="remove_duplicate_ss-613"><a href="#remove_duplicate_ss-613"><span class="linenos">613</span></a>    <span class="k">return</span> <span class="n">pruned</span>
</span></pre></div>


    

                </section>
                <section id="Extract_Disulfides">
                            <input id="Extract_Disulfides-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">Extract_Disulfides</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">numb</span><span class="o">=-</span><span class="mi">1</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">quiet</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">pdbdir</span><span class="o">=</span><span class="s1">&#39;/Users/egs/PDB/&#39;</span>,</span><span class="param">	<span class="n">baddir</span><span class="o">=</span><span class="n">PosixPath</span><span class="p">(</span><span class="s1">&#39;/Users/egs/PDB/bad&#39;</span><span class="p">)</span>,</span><span class="param">	<span class="n">datadir</span><span class="o">=</span><span class="s1">&#39;/Users/egs/PDB/good/&#39;</span>,</span><span class="param">	<span class="n">picklefile</span><span class="o">=</span><span class="s1">&#39;PDB_all_ss.pkl&#39;</span>,</span><span class="param">	<span class="n">problemfile</span><span class="o">=</span><span class="s1">&#39;PDB_all_SS_problems.csv&#39;</span>,</span><span class="param">	<span class="n">dist_cutoff</span><span class="o">=-</span><span class="mf">1.0</span>,</span><span class="param">	<span class="n">prune</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Extract_Disulfides-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Extract_Disulfides"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Extract_Disulfides-620"><a href="#Extract_Disulfides-620"><span class="linenos">620</span></a><span class="k">def</span> <span class="nf">Extract_Disulfides</span><span class="p">(</span>
</span><span id="Extract_Disulfides-621"><a href="#Extract_Disulfides-621"><span class="linenos">621</span></a>    <span class="n">numb</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Extract_Disulfides-622"><a href="#Extract_Disulfides-622"><span class="linenos">622</span></a>    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Extract_Disulfides-623"><a href="#Extract_Disulfides-623"><span class="linenos">623</span></a>    <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Extract_Disulfides-624"><a href="#Extract_Disulfides-624"><span class="linenos">624</span></a>    <span class="n">pdbdir</span><span class="o">=</span><span class="n">PDB_DIR</span><span class="p">,</span>
</span><span id="Extract_Disulfides-625"><a href="#Extract_Disulfides-625"><span class="linenos">625</span></a>    <span class="n">baddir</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">PDB_DIR</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;bad&quot;</span><span class="p">,</span>
</span><span id="Extract_Disulfides-626"><a href="#Extract_Disulfides-626"><span class="linenos">626</span></a>    <span class="n">datadir</span><span class="o">=</span><span class="n">MODEL_DIR</span><span class="p">,</span>
</span><span id="Extract_Disulfides-627"><a href="#Extract_Disulfides-627"><span class="linenos">627</span></a>    <span class="n">picklefile</span><span class="o">=</span><span class="n">SS_PICKLE_FILE</span><span class="p">,</span>
</span><span id="Extract_Disulfides-628"><a href="#Extract_Disulfides-628"><span class="linenos">628</span></a>    <span class="n">problemfile</span><span class="o">=</span><span class="n">PROBLEM_ID_FILE</span><span class="p">,</span>
</span><span id="Extract_Disulfides-629"><a href="#Extract_Disulfides-629"><span class="linenos">629</span></a>    <span class="n">dist_cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="Extract_Disulfides-630"><a href="#Extract_Disulfides-630"><span class="linenos">630</span></a>    <span class="n">prune</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Extract_Disulfides-631"><a href="#Extract_Disulfides-631"><span class="linenos">631</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Extract_Disulfides-632"><a href="#Extract_Disulfides-632"><span class="linenos">632</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Extract_Disulfides-633"><a href="#Extract_Disulfides-633"><span class="linenos">633</span></a><span class="sd">    Read the PDB files contained in ``pdbdir`` and create the .pkl files needed for the</span>
</span><span id="Extract_Disulfides-634"><a href="#Extract_Disulfides-634"><span class="linenos">634</span></a><span class="sd">    proteusPy.DisulfideLoader.DisulfideLoader class.</span>
</span><span id="Extract_Disulfides-635"><a href="#Extract_Disulfides-635"><span class="linenos">635</span></a><span class="sd">    The ```Disulfide``` objects are contained in a ```DisulfideList``` object and</span>
</span><span id="Extract_Disulfides-636"><a href="#Extract_Disulfides-636"><span class="linenos">636</span></a><span class="sd">    ```Dict``` within these files. In addition, .csv files containing all of</span>
</span><span id="Extract_Disulfides-637"><a href="#Extract_Disulfides-637"><span class="linenos">637</span></a><span class="sd">    the torsions for the disulfides and problem IDs are written. The optional</span>
</span><span id="Extract_Disulfides-638"><a href="#Extract_Disulfides-638"><span class="linenos">638</span></a><span class="sd">    ```dist_cutoff``` allows for removal of Disufides whose CÎ±-CÎ± distance is &gt;</span>
</span><span id="Extract_Disulfides-639"><a href="#Extract_Disulfides-639"><span class="linenos">639</span></a><span class="sd">    than the cutoff value. If it&#39;s -1.0 then the function keeps all Disulfides.</span>
</span><span id="Extract_Disulfides-640"><a href="#Extract_Disulfides-640"><span class="linenos">640</span></a>
</span><span id="Extract_Disulfides-641"><a href="#Extract_Disulfides-641"><span class="linenos">641</span></a><span class="sd">    :param numb:           Number of entries to process, defaults to all</span>
</span><span id="Extract_Disulfides-642"><a href="#Extract_Disulfides-642"><span class="linenos">642</span></a><span class="sd">    :param verbose:        More messages</span>
</span><span id="Extract_Disulfides-643"><a href="#Extract_Disulfides-643"><span class="linenos">643</span></a><span class="sd">    :param quiet:          Turn off DisulfideConstruction warnings</span>
</span><span id="Extract_Disulfides-644"><a href="#Extract_Disulfides-644"><span class="linenos">644</span></a><span class="sd">    :param pdbdir:         Path to PDB files</span>
</span><span id="Extract_Disulfides-645"><a href="#Extract_Disulfides-645"><span class="linenos">645</span></a><span class="sd">    :param datadir:        Path to resulting .pkl files</span>
</span><span id="Extract_Disulfides-646"><a href="#Extract_Disulfides-646"><span class="linenos">646</span></a><span class="sd">    :param picklefile:     Name of the disulfide .pkl file</span>
</span><span id="Extract_Disulfides-647"><a href="#Extract_Disulfides-647"><span class="linenos">647</span></a><span class="sd">    :param problemfile:    Name of the .csv file containing problem ids</span>
</span><span id="Extract_Disulfides-648"><a href="#Extract_Disulfides-648"><span class="linenos">648</span></a><span class="sd">    :param dist_cutoff:    Ca distance cutoff to reject a Disulfide.</span>
</span><span id="Extract_Disulfides-649"><a href="#Extract_Disulfides-649"><span class="linenos">649</span></a><span class="sd">    :param prune:          Move bad files to bad directory, defaults to True</span>
</span><span id="Extract_Disulfides-650"><a href="#Extract_Disulfides-650"><span class="linenos">650</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Extract_Disulfides-651"><a href="#Extract_Disulfides-651"><span class="linenos">651</span></a>
</span><span id="Extract_Disulfides-652"><a href="#Extract_Disulfides-652"><span class="linenos">652</span></a>    <span class="k">def</span> <span class="nf">name_to_id</span><span class="p">(</span><span class="n">fname</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Extract_Disulfides-653"><a href="#Extract_Disulfides-653"><span class="linenos">653</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Extract_Disulfides-654"><a href="#Extract_Disulfides-654"><span class="linenos">654</span></a><span class="sd">        Returns the PDB ID from the filename.</span>
</span><span id="Extract_Disulfides-655"><a href="#Extract_Disulfides-655"><span class="linenos">655</span></a>
</span><span id="Extract_Disulfides-656"><a href="#Extract_Disulfides-656"><span class="linenos">656</span></a><span class="sd">        :param fname: Complete PDB filename</span>
</span><span id="Extract_Disulfides-657"><a href="#Extract_Disulfides-657"><span class="linenos">657</span></a><span class="sd">        :return: PDB ID</span>
</span><span id="Extract_Disulfides-658"><a href="#Extract_Disulfides-658"><span class="linenos">658</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Extract_Disulfides-659"><a href="#Extract_Disulfides-659"><span class="linenos">659</span></a>        <span class="n">ent</span> <span class="o">=</span> <span class="n">fname</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Extract_Disulfides-660"><a href="#Extract_Disulfides-660"><span class="linenos">660</span></a>        <span class="k">return</span> <span class="n">ent</span>
</span><span id="Extract_Disulfides-661"><a href="#Extract_Disulfides-661"><span class="linenos">661</span></a>
</span><span id="Extract_Disulfides-662"><a href="#Extract_Disulfides-662"><span class="linenos">662</span></a>    <span class="kn">import</span> <span class="nn">shutil</span>
</span><span id="Extract_Disulfides-663"><a href="#Extract_Disulfides-663"><span class="linenos">663</span></a>
</span><span id="Extract_Disulfides-664"><a href="#Extract_Disulfides-664"><span class="linenos">664</span></a>    <span class="kn">from</span> <span class="nn">proteusPy</span> <span class="kn">import</span> <span class="n">DisulfideList</span><span class="p">,</span> <span class="n">load_disulfides_from_id</span>
</span><span id="Extract_Disulfides-665"><a href="#Extract_Disulfides-665"><span class="linenos">665</span></a>    <span class="kn">from</span> <span class="nn">proteusPy.Disulfide</span> <span class="kn">import</span> <span class="n">Torsion_DF_Cols</span>
</span><span id="Extract_Disulfides-666"><a href="#Extract_Disulfides-666"><span class="linenos">666</span></a>
</span><span id="Extract_Disulfides-667"><a href="#Extract_Disulfides-667"><span class="linenos">667</span></a>    <span class="k">if</span> <span class="n">quiet</span><span class="p">:</span>
</span><span id="Extract_Disulfides-668"><a href="#Extract_Disulfides-668"><span class="linenos">668</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
</span><span id="Extract_Disulfides-669"><a href="#Extract_Disulfides-669"><span class="linenos">669</span></a>
</span><span id="Extract_Disulfides-670"><a href="#Extract_Disulfides-670"><span class="linenos">670</span></a>    <span class="n">bad_dir</span> <span class="o">=</span> <span class="n">baddir</span>
</span><span id="Extract_Disulfides-671"><a href="#Extract_Disulfides-671"><span class="linenos">671</span></a>
</span><span id="Extract_Disulfides-672"><a href="#Extract_Disulfides-672"><span class="linenos">672</span></a>    <span class="n">entrylist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Extract_Disulfides-673"><a href="#Extract_Disulfides-673"><span class="linenos">673</span></a>    <span class="n">sslist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Extract_Disulfides-674"><a href="#Extract_Disulfides-674"><span class="linenos">674</span></a>    <span class="n">problem_ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Extract_Disulfides-675"><a href="#Extract_Disulfides-675"><span class="linenos">675</span></a>    <span class="n">bad</span> <span class="o">=</span> <span class="n">bad_dist</span> <span class="o">=</span> <span class="n">tot</span> <span class="o">=</span> <span class="n">cnt</span> <span class="o">=</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Extract_Disulfides-676"><a href="#Extract_Disulfides-676"><span class="linenos">676</span></a>
</span><span id="Extract_Disulfides-677"><a href="#Extract_Disulfides-677"><span class="linenos">677</span></a>    <span class="c1"># we use the specialized list class DisulfideList to contain our disulfides</span>
</span><span id="Extract_Disulfides-678"><a href="#Extract_Disulfides-678"><span class="linenos">678</span></a>    <span class="c1"># we&#39;ll use a dict to store DisulfideList objects, indexed by the structure ID</span>
</span><span id="Extract_Disulfides-679"><a href="#Extract_Disulfides-679"><span class="linenos">679</span></a>    <span class="n">All_ss_list</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s2">&quot;PDB_SS&quot;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-680"><a href="#Extract_Disulfides-680"><span class="linenos">680</span></a>    <span class="n">All_ss_dict2</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># new dict of pointers to indices</span>
</span><span id="Extract_Disulfides-681"><a href="#Extract_Disulfides-681"><span class="linenos">681</span></a>
</span><span id="Extract_Disulfides-682"><a href="#Extract_Disulfides-682"><span class="linenos">682</span></a>    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Extract_Disulfides-683"><a href="#Extract_Disulfides-683"><span class="linenos">683</span></a>    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</span><span id="Extract_Disulfides-684"><a href="#Extract_Disulfides-684"><span class="linenos">684</span></a>
</span><span id="Extract_Disulfides-685"><a href="#Extract_Disulfides-685"><span class="linenos">685</span></a>    <span class="c1"># Build a list of PDB files in PDB_DIR that are readable. These files were downloaded</span>
</span><span id="Extract_Disulfides-686"><a href="#Extract_Disulfides-686"><span class="linenos">686</span></a>    <span class="c1"># via the RCSB web query interface for structures containing &gt;= 1 SS Bond.</span>
</span><span id="Extract_Disulfides-687"><a href="#Extract_Disulfides-687"><span class="linenos">687</span></a>
</span><span id="Extract_Disulfides-688"><a href="#Extract_Disulfides-688"><span class="linenos">688</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">pdbdir</span><span class="p">)</span>
</span><span id="Extract_Disulfides-689"><a href="#Extract_Disulfides-689"><span class="linenos">689</span></a>
</span><span id="Extract_Disulfides-690"><a href="#Extract_Disulfides-690"><span class="linenos">690</span></a>    <span class="n">ss_filelist</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.ent&quot;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-691"><a href="#Extract_Disulfides-691"><span class="linenos">691</span></a>
</span><span id="Extract_Disulfides-692"><a href="#Extract_Disulfides-692"><span class="linenos">692</span></a>    <span class="c1"># the filenames are in the form pdb{entry}.ent, I loop through them and extract</span>
</span><span id="Extract_Disulfides-693"><a href="#Extract_Disulfides-693"><span class="linenos">693</span></a>    <span class="c1"># the PDB ID, with Disulfide.name_to_id(), then add to entrylist.</span>
</span><span id="Extract_Disulfides-694"><a href="#Extract_Disulfides-694"><span class="linenos">694</span></a>
</span><span id="Extract_Disulfides-695"><a href="#Extract_Disulfides-695"><span class="linenos">695</span></a>    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">ss_filelist</span><span class="p">:</span>
</span><span id="Extract_Disulfides-696"><a href="#Extract_Disulfides-696"><span class="linenos">696</span></a>        <span class="n">entrylist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name_to_id</span><span class="p">(</span><span class="n">entry</span><span class="p">))</span>
</span><span id="Extract_Disulfides-697"><a href="#Extract_Disulfides-697"><span class="linenos">697</span></a>
</span><span id="Extract_Disulfides-698"><a href="#Extract_Disulfides-698"><span class="linenos">698</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Extract_Disulfides-699"><a href="#Extract_Disulfides-699"><span class="linenos">699</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PDB Ids: </span><span class="si">{</span><span class="n">entrylist</span><span class="si">}</span><span class="s2">, len: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">entrylist</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-700"><a href="#Extract_Disulfides-700"><span class="linenos">700</span></a>
</span><span id="Extract_Disulfides-701"><a href="#Extract_Disulfides-701"><span class="linenos">701</span></a>    <span class="k">if</span> <span class="n">numb</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Extract_Disulfides-702"><a href="#Extract_Disulfides-702"><span class="linenos">702</span></a>        <span class="n">tot</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">entrylist</span><span class="p">)</span>
</span><span id="Extract_Disulfides-703"><a href="#Extract_Disulfides-703"><span class="linenos">703</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Extract_Disulfides-704"><a href="#Extract_Disulfides-704"><span class="linenos">704</span></a>        <span class="n">tot</span> <span class="o">=</span> <span class="n">numb</span>
</span><span id="Extract_Disulfides-705"><a href="#Extract_Disulfides-705"><span class="linenos">705</span></a>
</span><span id="Extract_Disulfides-706"><a href="#Extract_Disulfides-706"><span class="linenos">706</span></a>    <span class="c1"># create a dataframe with the following columns for the disulfide conformations</span>
</span><span id="Extract_Disulfides-707"><a href="#Extract_Disulfides-707"><span class="linenos">707</span></a>    <span class="c1"># extracted from the structure</span>
</span><span id="Extract_Disulfides-708"><a href="#Extract_Disulfides-708"><span class="linenos">708</span></a>
</span><span id="Extract_Disulfides-709"><a href="#Extract_Disulfides-709"><span class="linenos">709</span></a>    <span class="c1"># SS_df = pd.DataFrame(columns=Torsion_DF_Cols)</span>
</span><span id="Extract_Disulfides-710"><a href="#Extract_Disulfides-710"><span class="linenos">710</span></a>
</span><span id="Extract_Disulfides-711"><a href="#Extract_Disulfides-711"><span class="linenos">711</span></a>    <span class="c1"># define a tqdm progressbar using the fully loaded entrylist list.</span>
</span><span id="Extract_Disulfides-712"><a href="#Extract_Disulfides-712"><span class="linenos">712</span></a>    <span class="c1"># If numb is passed then</span>
</span><span id="Extract_Disulfides-713"><a href="#Extract_Disulfides-713"><span class="linenos">713</span></a>    <span class="c1"># only do the last numb entries.</span>
</span><span id="Extract_Disulfides-714"><a href="#Extract_Disulfides-714"><span class="linenos">714</span></a>
</span><span id="Extract_Disulfides-715"><a href="#Extract_Disulfides-715"><span class="linenos">715</span></a>    <span class="c1"># loop over ss_filelist, create disulfides and initialize them</span>
</span><span id="Extract_Disulfides-716"><a href="#Extract_Disulfides-716"><span class="linenos">716</span></a>    <span class="c1"># the logging_redirect_tqdm() context manager will redirect the logging output</span>
</span><span id="Extract_Disulfides-717"><a href="#Extract_Disulfides-717"><span class="linenos">717</span></a>    <span class="c1"># to the tqdm progress bar.</span>
</span><span id="Extract_Disulfides-718"><a href="#Extract_Disulfides-718"><span class="linenos">718</span></a>
</span><span id="Extract_Disulfides-719"><a href="#Extract_Disulfides-719"><span class="linenos">719</span></a>    <span class="k">with</span> <span class="n">logging_redirect_tqdm</span><span class="p">(</span><span class="n">loggers</span><span class="o">=</span><span class="p">[</span><span class="n">_logger</span><span class="p">]):</span>
</span><span id="Extract_Disulfides-720"><a href="#Extract_Disulfides-720"><span class="linenos">720</span></a>        <span class="k">if</span> <span class="n">numb</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Extract_Disulfides-721"><a href="#Extract_Disulfides-721"><span class="linenos">721</span></a>            <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">entrylist</span><span class="p">[:</span><span class="n">numb</span><span class="p">],</span> <span class="n">ncols</span><span class="o">=</span><span class="n">PBAR_COLS</span><span class="p">,</span> <span class="n">mininterval</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="Extract_Disulfides-722"><a href="#Extract_Disulfides-722"><span class="linenos">722</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Extract_Disulfides-723"><a href="#Extract_Disulfides-723"><span class="linenos">723</span></a>            <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">entrylist</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">PBAR_COLS</span><span class="p">,</span> <span class="n">mininterval</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="Extract_Disulfides-724"><a href="#Extract_Disulfides-724"><span class="linenos">724</span></a>
</span><span id="Extract_Disulfides-725"><a href="#Extract_Disulfides-725"><span class="linenos">725</span></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">pbar</span><span class="p">:</span>
</span><span id="Extract_Disulfides-726"><a href="#Extract_Disulfides-726"><span class="linenos">726</span></a>            <span class="n">_sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="n">entry</span><span class="p">)</span>
</span><span id="Extract_Disulfides-727"><a href="#Extract_Disulfides-727"><span class="linenos">727</span></a>
</span><span id="Extract_Disulfides-728"><a href="#Extract_Disulfides-728"><span class="linenos">728</span></a>            <span class="c1"># returns an empty list if none are found.</span>
</span><span id="Extract_Disulfides-729"><a href="#Extract_Disulfides-729"><span class="linenos">729</span></a>            <span class="n">_sslist</span> <span class="o">=</span> <span class="n">load_disulfides_from_id</span><span class="p">(</span>
</span><span id="Extract_Disulfides-730"><a href="#Extract_Disulfides-730"><span class="linenos">730</span></a>                <span class="n">entry</span><span class="p">,</span>
</span><span id="Extract_Disulfides-731"><a href="#Extract_Disulfides-731"><span class="linenos">731</span></a>                <span class="n">model_numb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Extract_Disulfides-732"><a href="#Extract_Disulfides-732"><span class="linenos">732</span></a>                <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="Extract_Disulfides-733"><a href="#Extract_Disulfides-733"><span class="linenos">733</span></a>                <span class="n">quiet</span><span class="o">=</span><span class="n">quiet</span><span class="p">,</span>
</span><span id="Extract_Disulfides-734"><a href="#Extract_Disulfides-734"><span class="linenos">734</span></a>                <span class="n">pdb_dir</span><span class="o">=</span><span class="n">pdbdir</span><span class="p">,</span>
</span><span id="Extract_Disulfides-735"><a href="#Extract_Disulfides-735"><span class="linenos">735</span></a>                <span class="n">cutoff</span><span class="o">=</span><span class="n">dist_cutoff</span><span class="p">,</span>
</span><span id="Extract_Disulfides-736"><a href="#Extract_Disulfides-736"><span class="linenos">736</span></a>            <span class="p">)</span>
</span><span id="Extract_Disulfides-737"><a href="#Extract_Disulfides-737"><span class="linenos">737</span></a>
</span><span id="Extract_Disulfides-738"><a href="#Extract_Disulfides-738"><span class="linenos">738</span></a>            <span class="c1"># sslist, xchain = prune_extra_ss(_sslist)</span>
</span><span id="Extract_Disulfides-739"><a href="#Extract_Disulfides-739"><span class="linenos">739</span></a>            <span class="c1"># sslist = _sslist</span>
</span><span id="Extract_Disulfides-740"><a href="#Extract_Disulfides-740"><span class="linenos">740</span></a>
</span><span id="Extract_Disulfides-741"><a href="#Extract_Disulfides-741"><span class="linenos">741</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_sslist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Extract_Disulfides-742"><a href="#Extract_Disulfides-742"><span class="linenos">742</span></a>                <span class="n">sslist</span> <span class="o">=</span> <span class="n">remove_duplicate_ss</span><span class="p">(</span><span class="n">_sslist</span><span class="p">)</span>
</span><span id="Extract_Disulfides-743"><a href="#Extract_Disulfides-743"><span class="linenos">743</span></a>                <span class="n">sslist2</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list to hold indices for ss_dict2</span>
</span><span id="Extract_Disulfides-744"><a href="#Extract_Disulfides-744"><span class="linenos">744</span></a>                <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">:</span>
</span><span id="Extract_Disulfides-745"><a href="#Extract_Disulfides-745"><span class="linenos">745</span></a>                    <span class="n">All_ss_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
</span><span id="Extract_Disulfides-746"><a href="#Extract_Disulfides-746"><span class="linenos">746</span></a>                    <span class="n">new_row</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="Extract_Disulfides-747"><a href="#Extract_Disulfides-747"><span class="linenos">747</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span><span class="p">,</span>
</span><span id="Extract_Disulfides-748"><a href="#Extract_Disulfides-748"><span class="linenos">748</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="Extract_Disulfides-749"><a href="#Extract_Disulfides-749"><span class="linenos">749</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">proximal</span><span class="p">,</span>
</span><span id="Extract_Disulfides-750"><a href="#Extract_Disulfides-750"><span class="linenos">750</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">distal</span><span class="p">,</span>
</span><span id="Extract_Disulfides-751"><a href="#Extract_Disulfides-751"><span class="linenos">751</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">chi1</span><span class="p">,</span>
</span><span id="Extract_Disulfides-752"><a href="#Extract_Disulfides-752"><span class="linenos">752</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">chi2</span><span class="p">,</span>
</span><span id="Extract_Disulfides-753"><a href="#Extract_Disulfides-753"><span class="linenos">753</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">chi3</span><span class="p">,</span>
</span><span id="Extract_Disulfides-754"><a href="#Extract_Disulfides-754"><span class="linenos">754</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">chi4</span><span class="p">,</span>
</span><span id="Extract_Disulfides-755"><a href="#Extract_Disulfides-755"><span class="linenos">755</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">chi5</span><span class="p">,</span>
</span><span id="Extract_Disulfides-756"><a href="#Extract_Disulfides-756"><span class="linenos">756</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span>
</span><span id="Extract_Disulfides-757"><a href="#Extract_Disulfides-757"><span class="linenos">757</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">ca_distance</span><span class="p">,</span>
</span><span id="Extract_Disulfides-758"><a href="#Extract_Disulfides-758"><span class="linenos">758</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">cb_distance</span><span class="p">,</span>
</span><span id="Extract_Disulfides-759"><a href="#Extract_Disulfides-759"><span class="linenos">759</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">phiprox</span><span class="p">,</span>
</span><span id="Extract_Disulfides-760"><a href="#Extract_Disulfides-760"><span class="linenos">760</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">psiprox</span><span class="p">,</span>
</span><span id="Extract_Disulfides-761"><a href="#Extract_Disulfides-761"><span class="linenos">761</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">phidist</span><span class="p">,</span>
</span><span id="Extract_Disulfides-762"><a href="#Extract_Disulfides-762"><span class="linenos">762</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">psidist</span><span class="p">,</span>
</span><span id="Extract_Disulfides-763"><a href="#Extract_Disulfides-763"><span class="linenos">763</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">torsion_length</span><span class="p">,</span>
</span><span id="Extract_Disulfides-764"><a href="#Extract_Disulfides-764"><span class="linenos">764</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">rho</span><span class="p">,</span>
</span><span id="Extract_Disulfides-765"><a href="#Extract_Disulfides-765"><span class="linenos">765</span></a>                    <span class="p">]</span>
</span><span id="Extract_Disulfides-766"><a href="#Extract_Disulfides-766"><span class="linenos">766</span></a>
</span><span id="Extract_Disulfides-767"><a href="#Extract_Disulfides-767"><span class="linenos">767</span></a>                    <span class="c1"># add the row to the end of the dataframe</span>
</span><span id="Extract_Disulfides-768"><a href="#Extract_Disulfides-768"><span class="linenos">768</span></a>                    <span class="c1"># SS_df.loc[len(SS_df.index)] = new_row.copy()  # deep copy</span>
</span><span id="Extract_Disulfides-769"><a href="#Extract_Disulfides-769"><span class="linenos">769</span></a>                    <span class="n">sslist2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
</span><span id="Extract_Disulfides-770"><a href="#Extract_Disulfides-770"><span class="linenos">770</span></a>                    <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Extract_Disulfides-771"><a href="#Extract_Disulfides-771"><span class="linenos">771</span></a>                    <span class="n">tot</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Extract_Disulfides-772"><a href="#Extract_Disulfides-772"><span class="linenos">772</span></a>
</span><span id="Extract_Disulfides-773"><a href="#Extract_Disulfides-773"><span class="linenos">773</span></a>                <span class="c1"># All_ss_dict[entry] = sslist</span>
</span><span id="Extract_Disulfides-774"><a href="#Extract_Disulfides-774"><span class="linenos">774</span></a>                <span class="c1"># print(f&#39;Entry: {entry}. Dict indices: {sslist2}&#39;)</span>
</span><span id="Extract_Disulfides-775"><a href="#Extract_Disulfides-775"><span class="linenos">775</span></a>                <span class="n">All_ss_dict2</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span> <span class="o">=</span> <span class="n">sslist2</span>
</span><span id="Extract_Disulfides-776"><a href="#Extract_Disulfides-776"><span class="linenos">776</span></a>
</span><span id="Extract_Disulfides-777"><a href="#Extract_Disulfides-777"><span class="linenos">777</span></a>                <span class="c1"># print(f&#39;{entry} ss dict adding: {sslist2}&#39;)</span>
</span><span id="Extract_Disulfides-778"><a href="#Extract_Disulfides-778"><span class="linenos">778</span></a>
</span><span id="Extract_Disulfides-779"><a href="#Extract_Disulfides-779"><span class="linenos">779</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1">## _sslist is empty!</span>
</span><span id="Extract_Disulfides-780"><a href="#Extract_Disulfides-780"><span class="linenos">780</span></a>                <span class="n">bad</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Extract_Disulfides-781"><a href="#Extract_Disulfides-781"><span class="linenos">781</span></a>                <span class="n">problem_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span><span id="Extract_Disulfides-782"><a href="#Extract_Disulfides-782"><span class="linenos">782</span></a>                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Extract_Disulfides-783"><a href="#Extract_Disulfides-783"><span class="linenos">783</span></a>                    <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Extract_Disulfides(): No SS parsed for: </span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-784"><a href="#Extract_Disulfides-784"><span class="linenos">784</span></a>
</span><span id="Extract_Disulfides-785"><a href="#Extract_Disulfides-785"><span class="linenos">785</span></a>                <span class="k">if</span> <span class="n">prune</span><span class="p">:</span>
</span><span id="Extract_Disulfides-786"><a href="#Extract_Disulfides-786"><span class="linenos">786</span></a>                    <span class="n">fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;pdb</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">.ent&quot;</span>
</span><span id="Extract_Disulfides-787"><a href="#Extract_Disulfides-787"><span class="linenos">787</span></a>                    <span class="c1"># Construct the full path for the new destination file</span>
</span><span id="Extract_Disulfides-788"><a href="#Extract_Disulfides-788"><span class="linenos">788</span></a>                    <span class="n">destination_file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">bad_dir</span><span class="p">)</span> <span class="o">/</span> <span class="n">fname</span>
</span><span id="Extract_Disulfides-789"><a href="#Extract_Disulfides-789"><span class="linenos">789</span></a>
</span><span id="Extract_Disulfides-790"><a href="#Extract_Disulfides-790"><span class="linenos">790</span></a>                    <span class="c1"># Copy the file to the new destination with the correct filename</span>
</span><span id="Extract_Disulfides-791"><a href="#Extract_Disulfides-791"><span class="linenos">791</span></a>                    <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="Extract_Disulfides-792"><a href="#Extract_Disulfides-792"><span class="linenos">792</span></a>                        <span class="sa">f</span><span class="s2">&quot;Extract_Disulfides(): Moving </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">destination_file_path</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Extract_Disulfides-793"><a href="#Extract_Disulfides-793"><span class="linenos">793</span></a>                    <span class="p">)</span>
</span><span id="Extract_Disulfides-794"><a href="#Extract_Disulfides-794"><span class="linenos">794</span></a>                    <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">destination_file_path</span><span class="p">)</span>
</span><span id="Extract_Disulfides-795"><a href="#Extract_Disulfides-795"><span class="linenos">795</span></a>                <span class="k">continue</span>  <span class="c1">## this entry has no SS bonds, so we break the loop and move on to the next entry</span>
</span><span id="Extract_Disulfides-796"><a href="#Extract_Disulfides-796"><span class="linenos">796</span></a>
</span><span id="Extract_Disulfides-797"><a href="#Extract_Disulfides-797"><span class="linenos">797</span></a>            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Extract_Disulfides-798"><a href="#Extract_Disulfides-798"><span class="linenos">798</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Extract_Disulfides-799"><a href="#Extract_Disulfides-799"><span class="linenos">799</span></a>                <span class="n">pbar</span><span class="o">.</span><span class="n">set_postfix</span><span class="p">({</span><span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;NoSS&quot;</span><span class="p">:</span> <span class="n">bad</span><span class="p">,</span> <span class="s2">&quot;Cnt&quot;</span><span class="p">:</span> <span class="n">cnt</span><span class="p">})</span>
</span><span id="Extract_Disulfides-800"><a href="#Extract_Disulfides-800"><span class="linenos">800</span></a>
</span><span id="Extract_Disulfides-801"><a href="#Extract_Disulfides-801"><span class="linenos">801</span></a>    <span class="n">pbar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Extract_Disulfides-802"><a href="#Extract_Disulfides-802"><span class="linenos">802</span></a>
</span><span id="Extract_Disulfides-803"><a href="#Extract_Disulfides-803"><span class="linenos">803</span></a>    <span class="k">if</span> <span class="n">bad</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Extract_Disulfides-804"><a href="#Extract_Disulfides-804"><span class="linenos">804</span></a>        <span class="n">prob_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="Extract_Disulfides-805"><a href="#Extract_Disulfides-805"><span class="linenos">805</span></a>        <span class="n">problem_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">prob_cols</span><span class="p">)</span>
</span><span id="Extract_Disulfides-806"><a href="#Extract_Disulfides-806"><span class="linenos">806</span></a>        <span class="n">problem_df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">problem_ids</span>
</span><span id="Extract_Disulfides-807"><a href="#Extract_Disulfides-807"><span class="linenos">807</span></a>
</span><span id="Extract_Disulfides-808"><a href="#Extract_Disulfides-808"><span class="linenos">808</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="Extract_Disulfides-809"><a href="#Extract_Disulfides-809"><span class="linenos">809</span></a>            <span class="p">(</span>
</span><span id="Extract_Disulfides-810"><a href="#Extract_Disulfides-810"><span class="linenos">810</span></a>                <span class="sa">f</span><span class="s2">&quot;Found and moved: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">problem_ids</span><span class="p">)</span><span class="si">}</span><span class="s2"> non-parsable structures.&quot;</span>
</span><span id="Extract_Disulfides-811"><a href="#Extract_Disulfides-811"><span class="linenos">811</span></a>                <span class="sa">f</span><span class="s2">&quot;Saving problem IDs to file: </span><span class="si">{</span><span class="n">Path</span><span class="p">(</span><span class="n">datadir</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">problemfile</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Extract_Disulfides-812"><a href="#Extract_Disulfides-812"><span class="linenos">812</span></a>            <span class="p">)</span>
</span><span id="Extract_Disulfides-813"><a href="#Extract_Disulfides-813"><span class="linenos">813</span></a>        <span class="p">)</span>
</span><span id="Extract_Disulfides-814"><a href="#Extract_Disulfides-814"><span class="linenos">814</span></a>
</span><span id="Extract_Disulfides-815"><a href="#Extract_Disulfides-815"><span class="linenos">815</span></a>        <span class="n">problem_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">datadir</span><span class="p">)</span> <span class="o">/</span> <span class="n">problemfile</span><span class="p">)</span>
</span><span id="Extract_Disulfides-816"><a href="#Extract_Disulfides-816"><span class="linenos">816</span></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1">## no bad files found</span>
</span><span id="Extract_Disulfides-817"><a href="#Extract_Disulfides-817"><span class="linenos">817</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Extract_Disulfides-818"><a href="#Extract_Disulfides-818"><span class="linenos">818</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No non-parsable structures found.&quot;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-819"><a href="#Extract_Disulfides-819"><span class="linenos">819</span></a>
</span><span id="Extract_Disulfides-820"><a href="#Extract_Disulfides-820"><span class="linenos">820</span></a>    <span class="k">if</span> <span class="n">bad_dist</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Extract_Disulfides-821"><a href="#Extract_Disulfides-821"><span class="linenos">821</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Extract_Disulfides-822"><a href="#Extract_Disulfides-822"><span class="linenos">822</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found and ignored: </span><span class="si">{</span><span class="n">bad_dist</span><span class="si">}</span><span class="s2"> long SS bonds.&quot;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-823"><a href="#Extract_Disulfides-823"><span class="linenos">823</span></a>
</span><span id="Extract_Disulfides-824"><a href="#Extract_Disulfides-824"><span class="linenos">824</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Extract_Disulfides-825"><a href="#Extract_Disulfides-825"><span class="linenos">825</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Extract_Disulfides-826"><a href="#Extract_Disulfides-826"><span class="linenos">826</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Extract_Disulfides(): No problems found.&quot;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-827"><a href="#Extract_Disulfides-827"><span class="linenos">827</span></a>
</span><span id="Extract_Disulfides-828"><a href="#Extract_Disulfides-828"><span class="linenos">828</span></a>    <span class="c1"># dump the all_ss list of disulfides to a .pkl file. ~520 MB.</span>
</span><span id="Extract_Disulfides-829"><a href="#Extract_Disulfides-829"><span class="linenos">829</span></a>    <span class="n">fname</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">datadir</span><span class="p">)</span> <span class="o">/</span> <span class="n">picklefile</span>
</span><span id="Extract_Disulfides-830"><a href="#Extract_Disulfides-830"><span class="linenos">830</span></a>
</span><span id="Extract_Disulfides-831"><a href="#Extract_Disulfides-831"><span class="linenos">831</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Extract_Disulfides-832"><a href="#Extract_Disulfides-832"><span class="linenos">832</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">All_ss_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> Disulfides to file: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Extract_Disulfides-833"><a href="#Extract_Disulfides-833"><span class="linenos">833</span></a>
</span><span id="Extract_Disulfides-834"><a href="#Extract_Disulfides-834"><span class="linenos">834</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;wb+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="Extract_Disulfides-835"><a href="#Extract_Disulfides-835"><span class="linenos">835</span></a>        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">All_ss_list</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="Extract_Disulfides-836"><a href="#Extract_Disulfides-836"><span class="linenos">836</span></a>
</span><span id="Extract_Disulfides-837"><a href="#Extract_Disulfides-837"><span class="linenos">837</span></a>    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Extract_Disulfides-838"><a href="#Extract_Disulfides-838"><span class="linenos">838</span></a>    <span class="n">elapsed</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>
</span><span id="Extract_Disulfides-839"><a href="#Extract_Disulfides-839"><span class="linenos">839</span></a>
</span><span id="Extract_Disulfides-840"><a href="#Extract_Disulfides-840"><span class="linenos">840</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Extract_Disulfides-841"><a href="#Extract_Disulfides-841"><span class="linenos">841</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="Extract_Disulfides-842"><a href="#Extract_Disulfides-842"><span class="linenos">842</span></a>            <span class="sa">f</span><span class="s2">&quot;Disulfide Extraction complete! Elapsed time:</span><span class="se">\</span>
</span><span id="Extract_Disulfides-843"><a href="#Extract_Disulfides-843"><span class="linenos">843</span></a><span class="s2">    	    </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed</span><span class="p">)</span><span class="si">}</span><span class="s2"> (h:m:s)&quot;</span>
</span><span id="Extract_Disulfides-844"><a href="#Extract_Disulfides-844"><span class="linenos">844</span></a>        <span class="p">)</span>
</span><span id="Extract_Disulfides-845"><a href="#Extract_Disulfides-845"><span class="linenos">845</span></a>
</span><span id="Extract_Disulfides-846"><a href="#Extract_Disulfides-846"><span class="linenos">846</span></a>    <span class="c1"># return to original directory</span>
</span><span id="Extract_Disulfides-847"><a href="#Extract_Disulfides-847"><span class="linenos">847</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
</span><span id="Extract_Disulfides-848"><a href="#Extract_Disulfides-848"><span class="linenos">848</span></a>
</span><span id="Extract_Disulfides-849"><a href="#Extract_Disulfides-849"><span class="linenos">849</span></a>    <span class="c1"># restore the logger level</span>
</span><span id="Extract_Disulfides-850"><a href="#Extract_Disulfides-850"><span class="linenos">850</span></a>    <span class="k">if</span> <span class="n">quiet</span><span class="p">:</span>
</span><span id="Extract_Disulfides-851"><a href="#Extract_Disulfides-851"><span class="linenos">851</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
</span><span id="Extract_Disulfides-852"><a href="#Extract_Disulfides-852"><span class="linenos">852</span></a>    <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>Read the PDB files contained in <code>pdbdir</code> and create the .pkl files needed for the
<a href="DisulfideLoader.html#DisulfideLoader">proteusPy.DisulfideLoader.DisulfideLoader</a> class.
The <code>Disulfide</code> objects are contained in a <code>DisulfideList</code> object and
<code>Dict</code> within these files. In addition, .csv files containing all of
the torsions for the disulfides and problem IDs are written. The optional
<code>dist_cutoff</code> allows for removal of Disufides whose CÎ±-CÎ± distance is &gt;
than the cutoff value. If it's -1.0 then the function keeps all Disulfides.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>numb</strong>:            Number of entries to process, defaults to all</li>
<li><strong>verbose</strong>:         More messages</li>
<li><strong>quiet</strong>:           Turn off DisulfideConstruction warnings</li>
<li><strong>pdbdir</strong>:          Path to PDB files</li>
<li><strong>datadir</strong>:         Path to resulting .pkl files</li>
<li><strong>picklefile</strong>:      Name of the disulfide .pkl file</li>
<li><strong>problemfile</strong>:     Name of the .csv file containing problem ids</li>
<li><strong>dist_cutoff</strong>:     Ca distance cutoff to reject a Disulfide.</li>
<li><strong>prune</strong>:           Move bad files to bad directory, defaults to True</li>
</ul>
</div>


                </section>
                <section id="Extract_Disulfides_From_List">
                            <input id="Extract_Disulfides_From_List-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">Extract_Disulfides_From_List</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">numb</span><span class="o">=-</span><span class="mi">1</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">quiet</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">pdbdir</span><span class="o">=</span><span class="s1">&#39;/Users/egs/PDB/&#39;</span>,</span><span class="param">	<span class="n">baddir</span><span class="o">=</span><span class="s1">&#39;/Users/egs/PDB//bad/&#39;</span>,</span><span class="param">	<span class="n">datadir</span><span class="o">=</span><span class="s1">&#39;/Users/egs/PDB/good/&#39;</span>,</span><span class="param">	<span class="n">picklefile</span><span class="o">=</span><span class="s1">&#39;PDB_all_ss.pkl&#39;</span>,</span><span class="param">	<span class="n">problemfile</span><span class="o">=</span><span class="s1">&#39;PDB_all_SS_problems.csv&#39;</span>,</span><span class="param">	<span class="n">dist_cutoff</span><span class="o">=-</span><span class="mf">1.0</span>,</span><span class="param">	<span class="n">prune</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">sslist</span><span class="o">=</span><span class="p">[]</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Extract_Disulfides_From_List-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Extract_Disulfides_From_List"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Extract_Disulfides_From_List-855"><a href="#Extract_Disulfides_From_List-855"><span class="linenos"> 855</span></a><span class="k">def</span> <span class="nf">Extract_Disulfides_From_List</span><span class="p">(</span>
</span><span id="Extract_Disulfides_From_List-856"><a href="#Extract_Disulfides_From_List-856"><span class="linenos"> 856</span></a>    <span class="n">numb</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-857"><a href="#Extract_Disulfides_From_List-857"><span class="linenos"> 857</span></a>    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-858"><a href="#Extract_Disulfides_From_List-858"><span class="linenos"> 858</span></a>    <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-859"><a href="#Extract_Disulfides_From_List-859"><span class="linenos"> 859</span></a>    <span class="n">pdbdir</span><span class="o">=</span><span class="n">PDB_DIR</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-860"><a href="#Extract_Disulfides_From_List-860"><span class="linenos"> 860</span></a>    <span class="n">baddir</span><span class="o">=</span><span class="n">PDB_DIR</span> <span class="o">+</span> <span class="s2">&quot;/bad/&quot;</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-861"><a href="#Extract_Disulfides_From_List-861"><span class="linenos"> 861</span></a>    <span class="n">datadir</span><span class="o">=</span><span class="n">MODEL_DIR</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-862"><a href="#Extract_Disulfides_From_List-862"><span class="linenos"> 862</span></a>    <span class="n">picklefile</span><span class="o">=</span><span class="n">SS_PICKLE_FILE</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-863"><a href="#Extract_Disulfides_From_List-863"><span class="linenos"> 863</span></a>    <span class="n">problemfile</span><span class="o">=</span><span class="n">PROBLEM_ID_FILE</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-864"><a href="#Extract_Disulfides_From_List-864"><span class="linenos"> 864</span></a>    <span class="n">dist_cutoff</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-865"><a href="#Extract_Disulfides_From_List-865"><span class="linenos"> 865</span></a>    <span class="n">prune</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-866"><a href="#Extract_Disulfides_From_List-866"><span class="linenos"> 866</span></a>    <span class="n">sslist</span><span class="o">=</span><span class="p">[],</span>
</span><span id="Extract_Disulfides_From_List-867"><a href="#Extract_Disulfides_From_List-867"><span class="linenos"> 867</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Extract_Disulfides_From_List-868"><a href="#Extract_Disulfides_From_List-868"><span class="linenos"> 868</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Extract_Disulfides_From_List-869"><a href="#Extract_Disulfides_From_List-869"><span class="linenos"> 869</span></a><span class="sd">    Read the PDB files contained in ``pdbdir`` and create the .pkl files needed for the</span>
</span><span id="Extract_Disulfides_From_List-870"><a href="#Extract_Disulfides_From_List-870"><span class="linenos"> 870</span></a><span class="sd">    proteusPy.DisulfideLoader.DisulfideLoader class.</span>
</span><span id="Extract_Disulfides_From_List-871"><a href="#Extract_Disulfides_From_List-871"><span class="linenos"> 871</span></a><span class="sd">    The ```Disulfide``` objects are contained in a ```DisulfideList``` object and</span>
</span><span id="Extract_Disulfides_From_List-872"><a href="#Extract_Disulfides_From_List-872"><span class="linenos"> 872</span></a><span class="sd">    ```Dict``` within these files. In addition, .csv files containing all of</span>
</span><span id="Extract_Disulfides_From_List-873"><a href="#Extract_Disulfides_From_List-873"><span class="linenos"> 873</span></a><span class="sd">    the torsions for the disulfides and problem IDs are written. The optional</span>
</span><span id="Extract_Disulfides_From_List-874"><a href="#Extract_Disulfides_From_List-874"><span class="linenos"> 874</span></a><span class="sd">    ```dist_cutoff``` allows for removal of Disufides whose CÎ±-CÎ± distance is &gt;</span>
</span><span id="Extract_Disulfides_From_List-875"><a href="#Extract_Disulfides_From_List-875"><span class="linenos"> 875</span></a><span class="sd">    than the cutoff value. If it&#39;s -1.0 then the function keeps all Disulfides.</span>
</span><span id="Extract_Disulfides_From_List-876"><a href="#Extract_Disulfides_From_List-876"><span class="linenos"> 876</span></a>
</span><span id="Extract_Disulfides_From_List-877"><a href="#Extract_Disulfides_From_List-877"><span class="linenos"> 877</span></a><span class="sd">    :param numb:           Number of entries to process, defaults to all</span>
</span><span id="Extract_Disulfides_From_List-878"><a href="#Extract_Disulfides_From_List-878"><span class="linenos"> 878</span></a><span class="sd">    :param verbose:        More messages</span>
</span><span id="Extract_Disulfides_From_List-879"><a href="#Extract_Disulfides_From_List-879"><span class="linenos"> 879</span></a><span class="sd">    :param quiet:          Turn off DisulfideConstruction warnings</span>
</span><span id="Extract_Disulfides_From_List-880"><a href="#Extract_Disulfides_From_List-880"><span class="linenos"> 880</span></a><span class="sd">    :param pdbdir:         Path to PDB files</span>
</span><span id="Extract_Disulfides_From_List-881"><a href="#Extract_Disulfides_From_List-881"><span class="linenos"> 881</span></a><span class="sd">    :param datadir:        Path to resulting .pkl files</span>
</span><span id="Extract_Disulfides_From_List-882"><a href="#Extract_Disulfides_From_List-882"><span class="linenos"> 882</span></a><span class="sd">    :param picklefile:     Name of the disulfide .pkl file</span>
</span><span id="Extract_Disulfides_From_List-883"><a href="#Extract_Disulfides_From_List-883"><span class="linenos"> 883</span></a><span class="sd">    :param torsionfile:    Name of the disulfide torsion file .csv created</span>
</span><span id="Extract_Disulfides_From_List-884"><a href="#Extract_Disulfides_From_List-884"><span class="linenos"> 884</span></a><span class="sd">    :param problemfile:    Name of the .csv file containing problem ids</span>
</span><span id="Extract_Disulfides_From_List-885"><a href="#Extract_Disulfides_From_List-885"><span class="linenos"> 885</span></a><span class="sd">    :param dist_cutoff:    Ca distance cutoff to reject a Disulfide.</span>
</span><span id="Extract_Disulfides_From_List-886"><a href="#Extract_Disulfides_From_List-886"><span class="linenos"> 886</span></a><span class="sd">    :param prune:          Move bad files to bad directory, defaults to True</span>
</span><span id="Extract_Disulfides_From_List-887"><a href="#Extract_Disulfides_From_List-887"><span class="linenos"> 887</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Extract_Disulfides_From_List-888"><a href="#Extract_Disulfides_From_List-888"><span class="linenos"> 888</span></a>
</span><span id="Extract_Disulfides_From_List-889"><a href="#Extract_Disulfides_From_List-889"><span class="linenos"> 889</span></a>    <span class="kn">import</span> <span class="nn">shutil</span>
</span><span id="Extract_Disulfides_From_List-890"><a href="#Extract_Disulfides_From_List-890"><span class="linenos"> 890</span></a>
</span><span id="Extract_Disulfides_From_List-891"><a href="#Extract_Disulfides_From_List-891"><span class="linenos"> 891</span></a>    <span class="kn">from</span> <span class="nn">proteusPy</span> <span class="kn">import</span> <span class="n">DisulfideList</span><span class="p">,</span> <span class="n">load_disulfides_from_id</span>
</span><span id="Extract_Disulfides_From_List-892"><a href="#Extract_Disulfides_From_List-892"><span class="linenos"> 892</span></a>    <span class="kn">from</span> <span class="nn">proteusPy.Disulfide</span> <span class="kn">import</span> <span class="n">Torsion_DF_Cols</span>
</span><span id="Extract_Disulfides_From_List-893"><a href="#Extract_Disulfides_From_List-893"><span class="linenos"> 893</span></a>
</span><span id="Extract_Disulfides_From_List-894"><a href="#Extract_Disulfides_From_List-894"><span class="linenos"> 894</span></a>    <span class="k">if</span> <span class="n">quiet</span><span class="p">:</span>
</span><span id="Extract_Disulfides_From_List-895"><a href="#Extract_Disulfides_From_List-895"><span class="linenos"> 895</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-896"><a href="#Extract_Disulfides_From_List-896"><span class="linenos"> 896</span></a>
</span><span id="Extract_Disulfides_From_List-897"><a href="#Extract_Disulfides_From_List-897"><span class="linenos"> 897</span></a>    <span class="n">bad_dir</span> <span class="o">=</span> <span class="n">baddir</span>
</span><span id="Extract_Disulfides_From_List-898"><a href="#Extract_Disulfides_From_List-898"><span class="linenos"> 898</span></a>
</span><span id="Extract_Disulfides_From_List-899"><a href="#Extract_Disulfides_From_List-899"><span class="linenos"> 899</span></a>    <span class="n">entrylist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Extract_Disulfides_From_List-900"><a href="#Extract_Disulfides_From_List-900"><span class="linenos"> 900</span></a>    <span class="n">problem_ids</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Extract_Disulfides_From_List-901"><a href="#Extract_Disulfides_From_List-901"><span class="linenos"> 901</span></a>    <span class="n">bad</span> <span class="o">=</span> <span class="n">bad_dist</span> <span class="o">=</span> <span class="n">tot</span> <span class="o">=</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Extract_Disulfides_From_List-902"><a href="#Extract_Disulfides_From_List-902"><span class="linenos"> 902</span></a>
</span><span id="Extract_Disulfides_From_List-903"><a href="#Extract_Disulfides_From_List-903"><span class="linenos"> 903</span></a>    <span class="c1"># we use the specialized list class DisulfideList to contain our disulfides</span>
</span><span id="Extract_Disulfides_From_List-904"><a href="#Extract_Disulfides_From_List-904"><span class="linenos"> 904</span></a>    <span class="c1"># we&#39;ll use a dict to store DisulfideList objects, indexed by the structure ID</span>
</span><span id="Extract_Disulfides_From_List-905"><a href="#Extract_Disulfides_From_List-905"><span class="linenos"> 905</span></a>    <span class="n">All_ss_list</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="s2">&quot;PDB_SS&quot;</span><span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-906"><a href="#Extract_Disulfides_From_List-906"><span class="linenos"> 906</span></a>    <span class="n">All_ss_dict2</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># new dict of pointers to indices</span>
</span><span id="Extract_Disulfides_From_List-907"><a href="#Extract_Disulfides_From_List-907"><span class="linenos"> 907</span></a>
</span><span id="Extract_Disulfides_From_List-908"><a href="#Extract_Disulfides_From_List-908"><span class="linenos"> 908</span></a>    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Extract_Disulfides_From_List-909"><a href="#Extract_Disulfides_From_List-909"><span class="linenos"> 909</span></a>    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</span><span id="Extract_Disulfides_From_List-910"><a href="#Extract_Disulfides_From_List-910"><span class="linenos"> 910</span></a>
</span><span id="Extract_Disulfides_From_List-911"><a href="#Extract_Disulfides_From_List-911"><span class="linenos"> 911</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">pdbdir</span><span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-912"><a href="#Extract_Disulfides_From_List-912"><span class="linenos"> 912</span></a>
</span><span id="Extract_Disulfides_From_List-913"><a href="#Extract_Disulfides_From_List-913"><span class="linenos"> 913</span></a>    <span class="n">entrylist</span> <span class="o">=</span> <span class="n">sslist</span>
</span><span id="Extract_Disulfides_From_List-914"><a href="#Extract_Disulfides_From_List-914"><span class="linenos"> 914</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Extract_Disulfides_From_List-915"><a href="#Extract_Disulfides_From_List-915"><span class="linenos"> 915</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="Extract_Disulfides_From_List-916"><a href="#Extract_Disulfides_From_List-916"><span class="linenos"> 916</span></a>            <span class="sa">f</span><span class="s2">&quot;Extract_Disulfides(): PDB Ids: </span><span class="si">{</span><span class="n">entrylist</span><span class="si">}</span><span class="s2">, len: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">entrylist</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Extract_Disulfides_From_List-917"><a href="#Extract_Disulfides_From_List-917"><span class="linenos"> 917</span></a>        <span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-918"><a href="#Extract_Disulfides_From_List-918"><span class="linenos"> 918</span></a>
</span><span id="Extract_Disulfides_From_List-919"><a href="#Extract_Disulfides_From_List-919"><span class="linenos"> 919</span></a>    <span class="c1"># create a dataframe with the following columns for the disulfide conformations</span>
</span><span id="Extract_Disulfides_From_List-920"><a href="#Extract_Disulfides_From_List-920"><span class="linenos"> 920</span></a>    <span class="c1"># extracted from the structure</span>
</span><span id="Extract_Disulfides_From_List-921"><a href="#Extract_Disulfides_From_List-921"><span class="linenos"> 921</span></a>
</span><span id="Extract_Disulfides_From_List-922"><a href="#Extract_Disulfides_From_List-922"><span class="linenos"> 922</span></a>    <span class="c1"># SS_df = pd.DataFrame(columns=Torsion_DF_Cols)</span>
</span><span id="Extract_Disulfides_From_List-923"><a href="#Extract_Disulfides_From_List-923"><span class="linenos"> 923</span></a>
</span><span id="Extract_Disulfides_From_List-924"><a href="#Extract_Disulfides_From_List-924"><span class="linenos"> 924</span></a>    <span class="c1"># define a tqdm progressbar using the fully loaded entrylist list.</span>
</span><span id="Extract_Disulfides_From_List-925"><a href="#Extract_Disulfides_From_List-925"><span class="linenos"> 925</span></a>    <span class="c1"># If numb is passed then</span>
</span><span id="Extract_Disulfides_From_List-926"><a href="#Extract_Disulfides_From_List-926"><span class="linenos"> 926</span></a>    <span class="c1"># only do the last numb entries.</span>
</span><span id="Extract_Disulfides_From_List-927"><a href="#Extract_Disulfides_From_List-927"><span class="linenos"> 927</span></a>
</span><span id="Extract_Disulfides_From_List-928"><a href="#Extract_Disulfides_From_List-928"><span class="linenos"> 928</span></a>    <span class="c1"># loop over ss_filelist, create disulfides and initialize them</span>
</span><span id="Extract_Disulfides_From_List-929"><a href="#Extract_Disulfides_From_List-929"><span class="linenos"> 929</span></a>    <span class="c1"># the logging_redirect_tqdm() context manager will redirect the logging output</span>
</span><span id="Extract_Disulfides_From_List-930"><a href="#Extract_Disulfides_From_List-930"><span class="linenos"> 930</span></a>    <span class="c1"># to the tqdm progress bar.</span>
</span><span id="Extract_Disulfides_From_List-931"><a href="#Extract_Disulfides_From_List-931"><span class="linenos"> 931</span></a>
</span><span id="Extract_Disulfides_From_List-932"><a href="#Extract_Disulfides_From_List-932"><span class="linenos"> 932</span></a>    <span class="k">with</span> <span class="n">logging_redirect_tqdm</span><span class="p">(</span><span class="n">loggers</span><span class="o">=</span><span class="p">[</span><span class="n">_logger</span><span class="p">]):</span>
</span><span id="Extract_Disulfides_From_List-933"><a href="#Extract_Disulfides_From_List-933"><span class="linenos"> 933</span></a>        <span class="k">if</span> <span class="n">numb</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Extract_Disulfides_From_List-934"><a href="#Extract_Disulfides_From_List-934"><span class="linenos"> 934</span></a>            <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">entrylist</span><span class="p">[:</span><span class="n">numb</span><span class="p">],</span> <span class="n">ncols</span><span class="o">=</span><span class="n">PBAR_COLS</span><span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-935"><a href="#Extract_Disulfides_From_List-935"><span class="linenos"> 935</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Extract_Disulfides_From_List-936"><a href="#Extract_Disulfides_From_List-936"><span class="linenos"> 936</span></a>            <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">entrylist</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">PBAR_COLS</span><span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-937"><a href="#Extract_Disulfides_From_List-937"><span class="linenos"> 937</span></a>
</span><span id="Extract_Disulfides_From_List-938"><a href="#Extract_Disulfides_From_List-938"><span class="linenos"> 938</span></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">pbar</span><span class="p">:</span>
</span><span id="Extract_Disulfides_From_List-939"><a href="#Extract_Disulfides_From_List-939"><span class="linenos"> 939</span></a>            <span class="n">_sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="n">entry</span><span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-940"><a href="#Extract_Disulfides_From_List-940"><span class="linenos"> 940</span></a>
</span><span id="Extract_Disulfides_From_List-941"><a href="#Extract_Disulfides_From_List-941"><span class="linenos"> 941</span></a>            <span class="c1"># returns an empty list if none are found.</span>
</span><span id="Extract_Disulfides_From_List-942"><a href="#Extract_Disulfides_From_List-942"><span class="linenos"> 942</span></a>            <span class="n">_sslist</span> <span class="o">=</span> <span class="n">load_disulfides_from_id</span><span class="p">(</span>
</span><span id="Extract_Disulfides_From_List-943"><a href="#Extract_Disulfides_From_List-943"><span class="linenos"> 943</span></a>                <span class="n">entry</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-944"><a href="#Extract_Disulfides_From_List-944"><span class="linenos"> 944</span></a>                <span class="n">model_numb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-945"><a href="#Extract_Disulfides_From_List-945"><span class="linenos"> 945</span></a>                <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-946"><a href="#Extract_Disulfides_From_List-946"><span class="linenos"> 946</span></a>                <span class="n">quiet</span><span class="o">=</span><span class="n">quiet</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-947"><a href="#Extract_Disulfides_From_List-947"><span class="linenos"> 947</span></a>                <span class="n">pdb_dir</span><span class="o">=</span><span class="n">pdbdir</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-948"><a href="#Extract_Disulfides_From_List-948"><span class="linenos"> 948</span></a>                <span class="n">cutoff</span><span class="o">=</span><span class="n">dist_cutoff</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-949"><a href="#Extract_Disulfides_From_List-949"><span class="linenos"> 949</span></a>            <span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-950"><a href="#Extract_Disulfides_From_List-950"><span class="linenos"> 950</span></a>
</span><span id="Extract_Disulfides_From_List-951"><a href="#Extract_Disulfides_From_List-951"><span class="linenos"> 951</span></a>            <span class="c1"># sslist, xchain = prune_extra_ss(_sslist)</span>
</span><span id="Extract_Disulfides_From_List-952"><a href="#Extract_Disulfides_From_List-952"><span class="linenos"> 952</span></a>            <span class="c1"># sslist = _sslist</span>
</span><span id="Extract_Disulfides_From_List-953"><a href="#Extract_Disulfides_From_List-953"><span class="linenos"> 953</span></a>
</span><span id="Extract_Disulfides_From_List-954"><a href="#Extract_Disulfides_From_List-954"><span class="linenos"> 954</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_sslist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Extract_Disulfides_From_List-955"><a href="#Extract_Disulfides_From_List-955"><span class="linenos"> 955</span></a>                <span class="n">sslist</span> <span class="o">=</span> <span class="n">remove_duplicate_ss</span><span class="p">(</span><span class="n">_sslist</span><span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-956"><a href="#Extract_Disulfides_From_List-956"><span class="linenos"> 956</span></a>                <span class="n">sslist2</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list to hold indices for ss_dict2</span>
</span><span id="Extract_Disulfides_From_List-957"><a href="#Extract_Disulfides_From_List-957"><span class="linenos"> 957</span></a>                <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">sslist</span><span class="p">:</span>
</span><span id="Extract_Disulfides_From_List-958"><a href="#Extract_Disulfides_From_List-958"><span class="linenos"> 958</span></a>                    <span class="n">All_ss_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-959"><a href="#Extract_Disulfides_From_List-959"><span class="linenos"> 959</span></a>                    <span class="n">new_row</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="Extract_Disulfides_From_List-960"><a href="#Extract_Disulfides_From_List-960"><span class="linenos"> 960</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-961"><a href="#Extract_Disulfides_From_List-961"><span class="linenos"> 961</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-962"><a href="#Extract_Disulfides_From_List-962"><span class="linenos"> 962</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">proximal</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-963"><a href="#Extract_Disulfides_From_List-963"><span class="linenos"> 963</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">distal</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-964"><a href="#Extract_Disulfides_From_List-964"><span class="linenos"> 964</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">chi1</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-965"><a href="#Extract_Disulfides_From_List-965"><span class="linenos"> 965</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">chi2</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-966"><a href="#Extract_Disulfides_From_List-966"><span class="linenos"> 966</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">chi3</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-967"><a href="#Extract_Disulfides_From_List-967"><span class="linenos"> 967</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">chi4</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-968"><a href="#Extract_Disulfides_From_List-968"><span class="linenos"> 968</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">chi5</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-969"><a href="#Extract_Disulfides_From_List-969"><span class="linenos"> 969</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-970"><a href="#Extract_Disulfides_From_List-970"><span class="linenos"> 970</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">ca_distance</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-971"><a href="#Extract_Disulfides_From_List-971"><span class="linenos"> 971</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">cb_distance</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-972"><a href="#Extract_Disulfides_From_List-972"><span class="linenos"> 972</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">phiprox</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-973"><a href="#Extract_Disulfides_From_List-973"><span class="linenos"> 973</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">psiprox</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-974"><a href="#Extract_Disulfides_From_List-974"><span class="linenos"> 974</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">phidist</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-975"><a href="#Extract_Disulfides_From_List-975"><span class="linenos"> 975</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">psidist</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-976"><a href="#Extract_Disulfides_From_List-976"><span class="linenos"> 976</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">torsion_length</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-977"><a href="#Extract_Disulfides_From_List-977"><span class="linenos"> 977</span></a>                        <span class="n">ss</span><span class="o">.</span><span class="n">rho</span><span class="p">,</span>
</span><span id="Extract_Disulfides_From_List-978"><a href="#Extract_Disulfides_From_List-978"><span class="linenos"> 978</span></a>                    <span class="p">]</span>
</span><span id="Extract_Disulfides_From_List-979"><a href="#Extract_Disulfides_From_List-979"><span class="linenos"> 979</span></a>
</span><span id="Extract_Disulfides_From_List-980"><a href="#Extract_Disulfides_From_List-980"><span class="linenos"> 980</span></a>                    <span class="c1"># add the row to the end of the dataframe</span>
</span><span id="Extract_Disulfides_From_List-981"><a href="#Extract_Disulfides_From_List-981"><span class="linenos"> 981</span></a>                    <span class="c1"># SS_df.loc[len(SS_df.index)] = new_row.copy()  # deep copy</span>
</span><span id="Extract_Disulfides_From_List-982"><a href="#Extract_Disulfides_From_List-982"><span class="linenos"> 982</span></a>                    <span class="n">sslist2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-983"><a href="#Extract_Disulfides_From_List-983"><span class="linenos"> 983</span></a>                    <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Extract_Disulfides_From_List-984"><a href="#Extract_Disulfides_From_List-984"><span class="linenos"> 984</span></a>                    <span class="n">tot</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Extract_Disulfides_From_List-985"><a href="#Extract_Disulfides_From_List-985"><span class="linenos"> 985</span></a>
</span><span id="Extract_Disulfides_From_List-986"><a href="#Extract_Disulfides_From_List-986"><span class="linenos"> 986</span></a>                <span class="c1"># All_ss_dict[entry] = sslist</span>
</span><span id="Extract_Disulfides_From_List-987"><a href="#Extract_Disulfides_From_List-987"><span class="linenos"> 987</span></a>                <span class="c1"># print(f&#39;Entry: {entry}. Dict indices: {sslist2}&#39;)</span>
</span><span id="Extract_Disulfides_From_List-988"><a href="#Extract_Disulfides_From_List-988"><span class="linenos"> 988</span></a>                <span class="n">All_ss_dict2</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span> <span class="o">=</span> <span class="n">sslist2</span>
</span><span id="Extract_Disulfides_From_List-989"><a href="#Extract_Disulfides_From_List-989"><span class="linenos"> 989</span></a>
</span><span id="Extract_Disulfides_From_List-990"><a href="#Extract_Disulfides_From_List-990"><span class="linenos"> 990</span></a>                <span class="c1"># print(f&#39;{entry} ss dict adding: {sslist2}&#39;)</span>
</span><span id="Extract_Disulfides_From_List-991"><a href="#Extract_Disulfides_From_List-991"><span class="linenos"> 991</span></a>
</span><span id="Extract_Disulfides_From_List-992"><a href="#Extract_Disulfides_From_List-992"><span class="linenos"> 992</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1">## _sslist is empty!</span>
</span><span id="Extract_Disulfides_From_List-993"><a href="#Extract_Disulfides_From_List-993"><span class="linenos"> 993</span></a>                <span class="n">bad</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Extract_Disulfides_From_List-994"><a href="#Extract_Disulfides_From_List-994"><span class="linenos"> 994</span></a>                <span class="n">problem_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-995"><a href="#Extract_Disulfides_From_List-995"><span class="linenos"> 995</span></a>                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Extract_Disulfides_From_List-996"><a href="#Extract_Disulfides_From_List-996"><span class="linenos"> 996</span></a>                    <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Extract_Disulfides(): No SS parsed for: </span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-997"><a href="#Extract_Disulfides_From_List-997"><span class="linenos"> 997</span></a>                <span class="k">if</span> <span class="n">prune</span><span class="p">:</span>
</span><span id="Extract_Disulfides_From_List-998"><a href="#Extract_Disulfides_From_List-998"><span class="linenos"> 998</span></a>                    <span class="n">fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;pdb</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">.ent&quot;</span>
</span><span id="Extract_Disulfides_From_List-999"><a href="#Extract_Disulfides_From_List-999"><span class="linenos"> 999</span></a>                    <span class="c1"># Construct the full path for the new destination file</span>
</span><span id="Extract_Disulfides_From_List-1000"><a href="#Extract_Disulfides_From_List-1000"><span class="linenos">1000</span></a>                    <span class="n">destination_file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">bad_dir</span><span class="p">)</span> <span class="o">/</span> <span class="n">fname</span>
</span><span id="Extract_Disulfides_From_List-1001"><a href="#Extract_Disulfides_From_List-1001"><span class="linenos">1001</span></a>                    <span class="c1"># Copy the file to the new destination with the correct filename</span>
</span><span id="Extract_Disulfides_From_List-1002"><a href="#Extract_Disulfides_From_List-1002"><span class="linenos">1002</span></a>                    <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="Extract_Disulfides_From_List-1003"><a href="#Extract_Disulfides_From_List-1003"><span class="linenos">1003</span></a>                        <span class="sa">f</span><span class="s2">&quot;Extract_Disulfides(): Moving </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">destination_file_path</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Extract_Disulfides_From_List-1004"><a href="#Extract_Disulfides_From_List-1004"><span class="linenos">1004</span></a>                    <span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-1005"><a href="#Extract_Disulfides_From_List-1005"><span class="linenos">1005</span></a>                    <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">destination_file_path</span><span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-1006"><a href="#Extract_Disulfides_From_List-1006"><span class="linenos">1006</span></a>                <span class="k">continue</span>  <span class="c1">## this entry has no SS bonds, so we break the loop and move on to the next entry</span>
</span><span id="Extract_Disulfides_From_List-1007"><a href="#Extract_Disulfides_From_List-1007"><span class="linenos">1007</span></a>
</span><span id="Extract_Disulfides_From_List-1008"><a href="#Extract_Disulfides_From_List-1008"><span class="linenos">1008</span></a>            <span class="n">pbar</span><span class="o">.</span><span class="n">set_postfix</span><span class="p">(</span>
</span><span id="Extract_Disulfides_From_List-1009"><a href="#Extract_Disulfides_From_List-1009"><span class="linenos">1009</span></a>                <span class="p">{</span><span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;NoSS&quot;</span><span class="p">:</span> <span class="n">bad</span><span class="p">,</span> <span class="s2">&quot;Cnt&quot;</span><span class="p">:</span> <span class="n">tot</span><span class="p">}</span>
</span><span id="Extract_Disulfides_From_List-1010"><a href="#Extract_Disulfides_From_List-1010"><span class="linenos">1010</span></a>            <span class="p">)</span>  <span class="c1"># update the progress bar</span>
</span><span id="Extract_Disulfides_From_List-1011"><a href="#Extract_Disulfides_From_List-1011"><span class="linenos">1011</span></a>
</span><span id="Extract_Disulfides_From_List-1012"><a href="#Extract_Disulfides_From_List-1012"><span class="linenos">1012</span></a>    <span class="k">if</span> <span class="n">bad</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Extract_Disulfides_From_List-1013"><a href="#Extract_Disulfides_From_List-1013"><span class="linenos">1013</span></a>        <span class="n">prob_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="Extract_Disulfides_From_List-1014"><a href="#Extract_Disulfides_From_List-1014"><span class="linenos">1014</span></a>        <span class="n">problem_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">prob_cols</span><span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-1015"><a href="#Extract_Disulfides_From_List-1015"><span class="linenos">1015</span></a>        <span class="n">problem_df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">problem_ids</span>
</span><span id="Extract_Disulfides_From_List-1016"><a href="#Extract_Disulfides_From_List-1016"><span class="linenos">1016</span></a>
</span><span id="Extract_Disulfides_From_List-1017"><a href="#Extract_Disulfides_From_List-1017"><span class="linenos">1017</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="Extract_Disulfides_From_List-1018"><a href="#Extract_Disulfides_From_List-1018"><span class="linenos">1018</span></a>            <span class="p">(</span>
</span><span id="Extract_Disulfides_From_List-1019"><a href="#Extract_Disulfides_From_List-1019"><span class="linenos">1019</span></a>                <span class="sa">f</span><span class="s2">&quot;Found and moved: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">problem_ids</span><span class="p">)</span><span class="si">}</span><span class="s2"> non-parsable structures.&quot;</span>
</span><span id="Extract_Disulfides_From_List-1020"><a href="#Extract_Disulfides_From_List-1020"><span class="linenos">1020</span></a>                <span class="sa">f</span><span class="s2">&quot;Saving problem IDs to file: </span><span class="si">{</span><span class="n">datadir</span><span class="si">}{</span><span class="n">problemfile</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Extract_Disulfides_From_List-1021"><a href="#Extract_Disulfides_From_List-1021"><span class="linenos">1021</span></a>            <span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-1022"><a href="#Extract_Disulfides_From_List-1022"><span class="linenos">1022</span></a>        <span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-1023"><a href="#Extract_Disulfides_From_List-1023"><span class="linenos">1023</span></a>
</span><span id="Extract_Disulfides_From_List-1024"><a href="#Extract_Disulfides_From_List-1024"><span class="linenos">1024</span></a>        <span class="n">problem_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">datadir</span> <span class="o">/</span> <span class="n">problemfile</span><span class="p">))</span>
</span><span id="Extract_Disulfides_From_List-1025"><a href="#Extract_Disulfides_From_List-1025"><span class="linenos">1025</span></a>
</span><span id="Extract_Disulfides_From_List-1026"><a href="#Extract_Disulfides_From_List-1026"><span class="linenos">1026</span></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1">## no bad files found</span>
</span><span id="Extract_Disulfides_From_List-1027"><a href="#Extract_Disulfides_From_List-1027"><span class="linenos">1027</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Extract_Disulfides_From_List-1028"><a href="#Extract_Disulfides_From_List-1028"><span class="linenos">1028</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Extract_Disulfides(): No non-parsable structures found.&quot;</span><span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-1029"><a href="#Extract_Disulfides_From_List-1029"><span class="linenos">1029</span></a>
</span><span id="Extract_Disulfides_From_List-1030"><a href="#Extract_Disulfides_From_List-1030"><span class="linenos">1030</span></a>    <span class="k">if</span> <span class="n">bad_dist</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Extract_Disulfides_From_List-1031"><a href="#Extract_Disulfides_From_List-1031"><span class="linenos">1031</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Extract_Disulfides_From_List-1032"><a href="#Extract_Disulfides_From_List-1032"><span class="linenos">1032</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found and ignored: </span><span class="si">{</span><span class="n">bad_dist</span><span class="si">}</span><span class="s2"> long SS bonds.&quot;</span><span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-1033"><a href="#Extract_Disulfides_From_List-1033"><span class="linenos">1033</span></a>
</span><span id="Extract_Disulfides_From_List-1034"><a href="#Extract_Disulfides_From_List-1034"><span class="linenos">1034</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Extract_Disulfides_From_List-1035"><a href="#Extract_Disulfides_From_List-1035"><span class="linenos">1035</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Extract_Disulfides_From_List-1036"><a href="#Extract_Disulfides_From_List-1036"><span class="linenos">1036</span></a>            <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No problems found.&quot;</span><span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-1037"><a href="#Extract_Disulfides_From_List-1037"><span class="linenos">1037</span></a>
</span><span id="Extract_Disulfides_From_List-1038"><a href="#Extract_Disulfides_From_List-1038"><span class="linenos">1038</span></a>    <span class="c1"># dump the all_ss list of disulfides to a .pkl file. ~520 MB.</span>
</span><span id="Extract_Disulfides_From_List-1039"><a href="#Extract_Disulfides_From_List-1039"><span class="linenos">1039</span></a>    <span class="n">fname</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">datadir</span><span class="p">)</span> <span class="o">/</span> <span class="n">picklefile</span>
</span><span id="Extract_Disulfides_From_List-1040"><a href="#Extract_Disulfides_From_List-1040"><span class="linenos">1040</span></a>
</span><span id="Extract_Disulfides_From_List-1041"><a href="#Extract_Disulfides_From_List-1041"><span class="linenos">1041</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Extract_Disulfides_From_List-1042"><a href="#Extract_Disulfides_From_List-1042"><span class="linenos">1042</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">All_ss_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> Disulfides to file: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-1043"><a href="#Extract_Disulfides_From_List-1043"><span class="linenos">1043</span></a>
</span><span id="Extract_Disulfides_From_List-1044"><a href="#Extract_Disulfides_From_List-1044"><span class="linenos">1044</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;wb+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="Extract_Disulfides_From_List-1045"><a href="#Extract_Disulfides_From_List-1045"><span class="linenos">1045</span></a>        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">All_ss_list</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-1046"><a href="#Extract_Disulfides_From_List-1046"><span class="linenos">1046</span></a>
</span><span id="Extract_Disulfides_From_List-1047"><a href="#Extract_Disulfides_From_List-1047"><span class="linenos">1047</span></a>    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Extract_Disulfides_From_List-1048"><a href="#Extract_Disulfides_From_List-1048"><span class="linenos">1048</span></a>    <span class="n">elapsed</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>
</span><span id="Extract_Disulfides_From_List-1049"><a href="#Extract_Disulfides_From_List-1049"><span class="linenos">1049</span></a>
</span><span id="Extract_Disulfides_From_List-1050"><a href="#Extract_Disulfides_From_List-1050"><span class="linenos">1050</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="Extract_Disulfides_From_List-1051"><a href="#Extract_Disulfides_From_List-1051"><span class="linenos">1051</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="Extract_Disulfides_From_List-1052"><a href="#Extract_Disulfides_From_List-1052"><span class="linenos">1052</span></a>            <span class="sa">f</span><span class="s2">&quot;Disulfide Extraction complete! Elapsed time:</span><span class="se">\</span>
</span><span id="Extract_Disulfides_From_List-1053"><a href="#Extract_Disulfides_From_List-1053"><span class="linenos">1053</span></a><span class="s2">    	    </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">elapsed</span><span class="p">)</span><span class="si">}</span><span class="s2"> (h:m:s)&quot;</span>
</span><span id="Extract_Disulfides_From_List-1054"><a href="#Extract_Disulfides_From_List-1054"><span class="linenos">1054</span></a>        <span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-1055"><a href="#Extract_Disulfides_From_List-1055"><span class="linenos">1055</span></a>
</span><span id="Extract_Disulfides_From_List-1056"><a href="#Extract_Disulfides_From_List-1056"><span class="linenos">1056</span></a>    <span class="c1"># return to original directory</span>
</span><span id="Extract_Disulfides_From_List-1057"><a href="#Extract_Disulfides_From_List-1057"><span class="linenos">1057</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-1058"><a href="#Extract_Disulfides_From_List-1058"><span class="linenos">1058</span></a>
</span><span id="Extract_Disulfides_From_List-1059"><a href="#Extract_Disulfides_From_List-1059"><span class="linenos">1059</span></a>    <span class="c1"># restore the logger level</span>
</span><span id="Extract_Disulfides_From_List-1060"><a href="#Extract_Disulfides_From_List-1060"><span class="linenos">1060</span></a>    <span class="k">if</span> <span class="n">quiet</span><span class="p">:</span>
</span><span id="Extract_Disulfides_From_List-1061"><a href="#Extract_Disulfides_From_List-1061"><span class="linenos">1061</span></a>        <span class="n">_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
</span><span id="Extract_Disulfides_From_List-1062"><a href="#Extract_Disulfides_From_List-1062"><span class="linenos">1062</span></a>    <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>Read the PDB files contained in <code>pdbdir</code> and create the .pkl files needed for the
<a href="DisulfideLoader.html#DisulfideLoader">proteusPy.DisulfideLoader.DisulfideLoader</a> class.
The <code>Disulfide</code> objects are contained in a <code>DisulfideList</code> object and
<code>Dict</code> within these files. In addition, .csv files containing all of
the torsions for the disulfides and problem IDs are written. The optional
<code>dist_cutoff</code> allows for removal of Disufides whose CÎ±-CÎ± distance is &gt;
than the cutoff value. If it's -1.0 then the function keeps all Disulfides.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>numb</strong>:            Number of entries to process, defaults to all</li>
<li><strong>verbose</strong>:         More messages</li>
<li><strong>quiet</strong>:           Turn off DisulfideConstruction warnings</li>
<li><strong>pdbdir</strong>:          Path to PDB files</li>
<li><strong>datadir</strong>:         Path to resulting .pkl files</li>
<li><strong>picklefile</strong>:      Name of the disulfide .pkl file</li>
<li><strong>torsionfile</strong>:     Name of the disulfide torsion file .csv created</li>
<li><strong>problemfile</strong>:     Name of the .csv file containing problem ids</li>
<li><strong>dist_cutoff</strong>:     Ca distance cutoff to reject a Disulfide.</li>
<li><strong>prune</strong>:           Move bad files to bad directory, defaults to True</li>
</ul>
</div>


                </section>
                <section id="Extract_Disulfide">
                            <input id="Extract_Disulfide-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">Extract_Disulfide</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">pdbid</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">quiet</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">pdbdir</span><span class="o">=</span><span class="s1">&#39;/Users/egs/PDB/&#39;</span>,</span><span class="param">	<span class="n">xtra</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">) -> <span class="o">&lt;</span><span class="n">module</span> <span class="s1">&#39;<a href="DisulfideList.html">proteusPy.DisulfideList</a>&#39;</span> <span class="kn">from</span> <span class="s1">&#39;/Users/egs/repos/proteusPy/proteusPy/DisulfideList.py&#39;</span><span class="o">&gt;</span>:</span></span>

                <label class="view-source-button" for="Extract_Disulfide-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Extract_Disulfide"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Extract_Disulfide-1065"><a href="#Extract_Disulfide-1065"><span class="linenos">1065</span></a><span class="k">def</span> <span class="nf">Extract_Disulfide</span><span class="p">(</span>
</span><span id="Extract_Disulfide-1066"><a href="#Extract_Disulfide-1066"><span class="linenos">1066</span></a>    <span class="n">pdbid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pdbdir</span><span class="o">=</span><span class="n">PDB_DIR</span><span class="p">,</span> <span class="n">xtra</span><span class="o">=</span><span class="kc">True</span>
</span><span id="Extract_Disulfide-1067"><a href="#Extract_Disulfide-1067"><span class="linenos">1067</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DisulfideList</span><span class="p">:</span>
</span><span id="Extract_Disulfide-1068"><a href="#Extract_Disulfide-1068"><span class="linenos">1068</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Extract_Disulfide-1069"><a href="#Extract_Disulfide-1069"><span class="linenos">1069</span></a><span class="sd">    Read the PDB file represented by `pdbid` and return a ``DisulfideList``</span>
</span><span id="Extract_Disulfide-1070"><a href="#Extract_Disulfide-1070"><span class="linenos">1070</span></a><span class="sd">    containing the Disulfide bonds found.</span>
</span><span id="Extract_Disulfide-1071"><a href="#Extract_Disulfide-1071"><span class="linenos">1071</span></a>
</span><span id="Extract_Disulfide-1072"><a href="#Extract_Disulfide-1072"><span class="linenos">1072</span></a><span class="sd">    :param verbose:        Display more messages</span>
</span><span id="Extract_Disulfide-1073"><a href="#Extract_Disulfide-1073"><span class="linenos">1073</span></a><span class="sd">    :param quiet:          Turn off DisulfideConstruction warnings</span>
</span><span id="Extract_Disulfide-1074"><a href="#Extract_Disulfide-1074"><span class="linenos">1074</span></a><span class="sd">    :param pdbdir:         path to PDB files</span>
</span><span id="Extract_Disulfide-1075"><a href="#Extract_Disulfide-1075"><span class="linenos">1075</span></a><span class="sd">    :param xtra:           Prune duplicate disulfides</span>
</span><span id="Extract_Disulfide-1076"><a href="#Extract_Disulfide-1076"><span class="linenos">1076</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Extract_Disulfide-1077"><a href="#Extract_Disulfide-1077"><span class="linenos">1077</span></a>
</span><span id="Extract_Disulfide-1078"><a href="#Extract_Disulfide-1078"><span class="linenos">1078</span></a>    <span class="kn">import</span> <span class="nn">glob</span>
</span><span id="Extract_Disulfide-1079"><a href="#Extract_Disulfide-1079"><span class="linenos">1079</span></a>    <span class="kn">import</span> <span class="nn">os</span>
</span><span id="Extract_Disulfide-1080"><a href="#Extract_Disulfide-1080"><span class="linenos">1080</span></a>    <span class="kn">import</span> <span class="nn">shutil</span>
</span><span id="Extract_Disulfide-1081"><a href="#Extract_Disulfide-1081"><span class="linenos">1081</span></a>    <span class="kn">import</span> <span class="nn">time</span>
</span><span id="Extract_Disulfide-1082"><a href="#Extract_Disulfide-1082"><span class="linenos">1082</span></a>
</span><span id="Extract_Disulfide-1083"><a href="#Extract_Disulfide-1083"><span class="linenos">1083</span></a>    <span class="kn">import</span> <span class="nn">proteusPy</span>
</span><span id="Extract_Disulfide-1084"><a href="#Extract_Disulfide-1084"><span class="linenos">1084</span></a>    <span class="kn">from</span> <span class="nn">proteusPy</span> <span class="kn">import</span> <span class="n">DisulfideList</span><span class="p">,</span> <span class="n">load_disulfides_from_id</span>
</span><span id="Extract_Disulfide-1085"><a href="#Extract_Disulfide-1085"><span class="linenos">1085</span></a>
</span><span id="Extract_Disulfide-1086"><a href="#Extract_Disulfide-1086"><span class="linenos">1086</span></a>    <span class="k">def</span> <span class="nf">extract_id_from_filename</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="Extract_Disulfide-1087"><a href="#Extract_Disulfide-1087"><span class="linenos">1087</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Extract_Disulfide-1088"><a href="#Extract_Disulfide-1088"><span class="linenos">1088</span></a><span class="sd">        Extract the ID from a filename formatted as &#39;pdb{id}.ent&#39;.</span>
</span><span id="Extract_Disulfide-1089"><a href="#Extract_Disulfide-1089"><span class="linenos">1089</span></a>
</span><span id="Extract_Disulfide-1090"><a href="#Extract_Disulfide-1090"><span class="linenos">1090</span></a><span class="sd">        Parameters:</span>
</span><span id="Extract_Disulfide-1091"><a href="#Extract_Disulfide-1091"><span class="linenos">1091</span></a><span class="sd">        - filename (str): The filename to extract the ID from.</span>
</span><span id="Extract_Disulfide-1092"><a href="#Extract_Disulfide-1092"><span class="linenos">1092</span></a>
</span><span id="Extract_Disulfide-1093"><a href="#Extract_Disulfide-1093"><span class="linenos">1093</span></a><span class="sd">        Returns:</span>
</span><span id="Extract_Disulfide-1094"><a href="#Extract_Disulfide-1094"><span class="linenos">1094</span></a><span class="sd">        - str: The extracted ID.</span>
</span><span id="Extract_Disulfide-1095"><a href="#Extract_Disulfide-1095"><span class="linenos">1095</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Extract_Disulfide-1096"><a href="#Extract_Disulfide-1096"><span class="linenos">1096</span></a>        <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="Extract_Disulfide-1097"><a href="#Extract_Disulfide-1097"><span class="linenos">1097</span></a>        <span class="c1"># Check if the filename follows the expected format</span>
</span><span id="Extract_Disulfide-1098"><a href="#Extract_Disulfide-1098"><span class="linenos">1098</span></a>        <span class="k">if</span> <span class="n">basename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;pdb&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.ent&quot;</span><span class="p">):</span>
</span><span id="Extract_Disulfide-1099"><a href="#Extract_Disulfide-1099"><span class="linenos">1099</span></a>            <span class="c1"># Extract the ID part of the filename</span>
</span><span id="Extract_Disulfide-1100"><a href="#Extract_Disulfide-1100"><span class="linenos">1100</span></a>            <span class="k">return</span> <span class="n">filename</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Extract_Disulfide-1101"><a href="#Extract_Disulfide-1101"><span class="linenos">1101</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Extract_Disulfide-1102"><a href="#Extract_Disulfide-1102"><span class="linenos">1102</span></a>            <span class="n">mess</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Extract_Disulfide-1103"><a href="#Extract_Disulfide-1103"><span class="linenos">1103</span></a>                <span class="sa">f</span><span class="s2">&quot;Filename </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> does not follow the expected format &#39;pdbid .ent&#39;&quot;</span>
</span><span id="Extract_Disulfide-1104"><a href="#Extract_Disulfide-1104"><span class="linenos">1104</span></a>            <span class="p">)</span>
</span><span id="Extract_Disulfide-1105"><a href="#Extract_Disulfide-1105"><span class="linenos">1105</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
</span><span id="Extract_Disulfide-1106"><a href="#Extract_Disulfide-1106"><span class="linenos">1106</span></a>
</span><span id="Extract_Disulfide-1107"><a href="#Extract_Disulfide-1107"><span class="linenos">1107</span></a>    <span class="c1"># Build a list of PDB files in PDB_DIR that are readable. These files were downloaded</span>
</span><span id="Extract_Disulfide-1108"><a href="#Extract_Disulfide-1108"><span class="linenos">1108</span></a>    <span class="c1"># via the RCSB web query interface for structures containing &gt;= 1 SS Bond.</span>
</span><span id="Extract_Disulfide-1109"><a href="#Extract_Disulfide-1109"><span class="linenos">1109</span></a>
</span><span id="Extract_Disulfide-1110"><a href="#Extract_Disulfide-1110"><span class="linenos">1110</span></a>    <span class="nb">id</span> <span class="o">=</span> <span class="n">extract_id_from_filename</span><span class="p">(</span><span class="n">pdbid</span><span class="p">)</span>
</span><span id="Extract_Disulfide-1111"><a href="#Extract_Disulfide-1111"><span class="linenos">1111</span></a>
</span><span id="Extract_Disulfide-1112"><a href="#Extract_Disulfide-1112"><span class="linenos">1112</span></a>    <span class="c1"># returns an empty list if none are found.</span>
</span><span id="Extract_Disulfide-1113"><a href="#Extract_Disulfide-1113"><span class="linenos">1113</span></a>    <span class="n">_sslist</span> <span class="o">=</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="nb">id</span><span class="p">)</span>
</span><span id="Extract_Disulfide-1114"><a href="#Extract_Disulfide-1114"><span class="linenos">1114</span></a>    <span class="n">_sslist</span> <span class="o">=</span> <span class="n">load_disulfides_from_id</span><span class="p">(</span>
</span><span id="Extract_Disulfide-1115"><a href="#Extract_Disulfide-1115"><span class="linenos">1115</span></a>        <span class="nb">id</span><span class="p">,</span> <span class="n">model_numb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="n">quiet</span><span class="p">,</span> <span class="n">pdb_dir</span><span class="o">=</span><span class="n">pdbdir</span>
</span><span id="Extract_Disulfide-1116"><a href="#Extract_Disulfide-1116"><span class="linenos">1116</span></a>    <span class="p">)</span>
</span><span id="Extract_Disulfide-1117"><a href="#Extract_Disulfide-1117"><span class="linenos">1117</span></a>
</span><span id="Extract_Disulfide-1118"><a href="#Extract_Disulfide-1118"><span class="linenos">1118</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_sslist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">_sslist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Extract_Disulfide-1119"><a href="#Extract_Disulfide-1119"><span class="linenos">1119</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--&gt; Can&#39;t find SSBonds: </span><span class="si">{</span><span class="n">pdbid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Extract_Disulfide-1120"><a href="#Extract_Disulfide-1120"><span class="linenos">1120</span></a>        <span class="k">return</span> <span class="n">DisulfideList</span><span class="p">([],</span> <span class="nb">id</span><span class="p">)</span>
</span><span id="Extract_Disulfide-1121"><a href="#Extract_Disulfide-1121"><span class="linenos">1121</span></a>
</span><span id="Extract_Disulfide-1122"><a href="#Extract_Disulfide-1122"><span class="linenos">1122</span></a>    <span class="c1"># return to original directory</span>
</span><span id="Extract_Disulfide-1123"><a href="#Extract_Disulfide-1123"><span class="linenos">1123</span></a>    <span class="k">return</span> <span class="n">_sslist</span>
</span></pre></div>


            <div class="docstring"><p>Read the PDB file represented by <code>pdbid</code> and return a <code>DisulfideList</code>
containing the Disulfide bonds found.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>verbose</strong>:         Display more messages</li>
<li><strong>quiet</strong>:           Turn off DisulfideConstruction warnings</li>
<li><strong>pdbdir</strong>:          path to PDB files</li>
<li><strong>xtra</strong>:            Prune duplicate disulfides</li>
</ul>
</div>


                </section>
                <section id="get_macos_theme">
                            <input id="get_macos_theme-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_macos_theme</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_macos_theme-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_macos_theme"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_macos_theme-1126"><a href="#get_macos_theme-1126"><span class="linenos">1126</span></a><span class="k">def</span> <span class="nf">get_macos_theme</span><span class="p">():</span>
</span><span id="get_macos_theme-1127"><a href="#get_macos_theme-1127"><span class="linenos">1127</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="get_macos_theme-1128"><a href="#get_macos_theme-1128"><span class="linenos">1128</span></a><span class="sd">    Determine the display theme for a macOS computer using AppleScript.</span>
</span><span id="get_macos_theme-1129"><a href="#get_macos_theme-1129"><span class="linenos">1129</span></a>
</span><span id="get_macos_theme-1130"><a href="#get_macos_theme-1130"><span class="linenos">1130</span></a><span class="sd">    Returns:</span>
</span><span id="get_macos_theme-1131"><a href="#get_macos_theme-1131"><span class="linenos">1131</span></a><span class="sd">    :return str: &#39;light&#39;, &#39;dark&#39;, or &#39;none&#39; based on the current display theme.</span>
</span><span id="get_macos_theme-1132"><a href="#get_macos_theme-1132"><span class="linenos">1132</span></a>
</span><span id="get_macos_theme-1133"><a href="#get_macos_theme-1133"><span class="linenos">1133</span></a><span class="sd">    Example:</span>
</span><span id="get_macos_theme-1134"><a href="#get_macos_theme-1134"><span class="linenos">1134</span></a><span class="sd">    &gt;&gt;&gt; get_macos_theme()</span>
</span><span id="get_macos_theme-1135"><a href="#get_macos_theme-1135"><span class="linenos">1135</span></a><span class="sd">    &#39;dark&#39;</span>
</span><span id="get_macos_theme-1136"><a href="#get_macos_theme-1136"><span class="linenos">1136</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_macos_theme-1137"><a href="#get_macos_theme-1137"><span class="linenos">1137</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="get_macos_theme-1138"><a href="#get_macos_theme-1138"><span class="linenos">1138</span></a>        <span class="c1"># AppleScript to get the appearance setting</span>
</span><span id="get_macos_theme-1139"><a href="#get_macos_theme-1139"><span class="linenos">1139</span></a>        <span class="n">script</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="get_macos_theme-1140"><a href="#get_macos_theme-1140"><span class="linenos">1140</span></a><span class="s2">        tell application &quot;System Events&quot;</span>
</span><span id="get_macos_theme-1141"><a href="#get_macos_theme-1141"><span class="linenos">1141</span></a><span class="s2">            tell appearance preferences</span>
</span><span id="get_macos_theme-1142"><a href="#get_macos_theme-1142"><span class="linenos">1142</span></a><span class="s2">                if (dark mode) then</span>
</span><span id="get_macos_theme-1143"><a href="#get_macos_theme-1143"><span class="linenos">1143</span></a><span class="s2">                    return &quot;dark&quot;</span>
</span><span id="get_macos_theme-1144"><a href="#get_macos_theme-1144"><span class="linenos">1144</span></a><span class="s2">                else</span>
</span><span id="get_macos_theme-1145"><a href="#get_macos_theme-1145"><span class="linenos">1145</span></a><span class="s2">                    return &quot;light&quot;</span>
</span><span id="get_macos_theme-1146"><a href="#get_macos_theme-1146"><span class="linenos">1146</span></a><span class="s2">                end if</span>
</span><span id="get_macos_theme-1147"><a href="#get_macos_theme-1147"><span class="linenos">1147</span></a><span class="s2">            end tell</span>
</span><span id="get_macos_theme-1148"><a href="#get_macos_theme-1148"><span class="linenos">1148</span></a><span class="s2">        end tell</span>
</span><span id="get_macos_theme-1149"><a href="#get_macos_theme-1149"><span class="linenos">1149</span></a><span class="s2">        &quot;&quot;&quot;</span>
</span><span id="get_macos_theme-1150"><a href="#get_macos_theme-1150"><span class="linenos">1150</span></a>        <span class="c1"># Run the AppleScript</span>
</span><span id="get_macos_theme-1151"><a href="#get_macos_theme-1151"><span class="linenos">1151</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
</span><span id="get_macos_theme-1152"><a href="#get_macos_theme-1152"><span class="linenos">1152</span></a>            <span class="p">[</span><span class="s2">&quot;osascript&quot;</span><span class="p">,</span> <span class="s2">&quot;-e&quot;</span><span class="p">,</span> <span class="n">script</span><span class="p">],</span>
</span><span id="get_macos_theme-1153"><a href="#get_macos_theme-1153"><span class="linenos">1153</span></a>            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
</span><span id="get_macos_theme-1154"><a href="#get_macos_theme-1154"><span class="linenos">1154</span></a>            <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
</span><span id="get_macos_theme-1155"><a href="#get_macos_theme-1155"><span class="linenos">1155</span></a>            <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="get_macos_theme-1156"><a href="#get_macos_theme-1156"><span class="linenos">1156</span></a>        <span class="p">)</span>
</span><span id="get_macos_theme-1157"><a href="#get_macos_theme-1157"><span class="linenos">1157</span></a>
</span><span id="get_macos_theme-1158"><a href="#get_macos_theme-1158"><span class="linenos">1158</span></a>        <span class="c1"># Check the output</span>
</span><span id="get_macos_theme-1159"><a href="#get_macos_theme-1159"><span class="linenos">1159</span></a>        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="get_macos_theme-1160"><a href="#get_macos_theme-1160"><span class="linenos">1160</span></a>            <span class="n">theme</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="get_macos_theme-1161"><a href="#get_macos_theme-1161"><span class="linenos">1161</span></a>            <span class="k">if</span> <span class="n">theme</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;dark&quot;</span><span class="p">,</span> <span class="s2">&quot;light&quot;</span><span class="p">]:</span>
</span><span id="get_macos_theme-1162"><a href="#get_macos_theme-1162"><span class="linenos">1162</span></a>                <span class="k">return</span> <span class="n">theme</span>
</span><span id="get_macos_theme-1163"><a href="#get_macos_theme-1163"><span class="linenos">1163</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="get_macos_theme-1164"><a href="#get_macos_theme-1164"><span class="linenos">1164</span></a>                <span class="k">return</span> <span class="s2">&quot;none&quot;</span>
</span><span id="get_macos_theme-1165"><a href="#get_macos_theme-1165"><span class="linenos">1165</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="get_macos_theme-1166"><a href="#get_macos_theme-1166"><span class="linenos">1166</span></a>            <span class="k">return</span> <span class="s2">&quot;none&quot;</span>
</span><span id="get_macos_theme-1167"><a href="#get_macos_theme-1167"><span class="linenos">1167</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="get_macos_theme-1168"><a href="#get_macos_theme-1168"><span class="linenos">1168</span></a>        <span class="c1"># In case of any exception, return &#39;none&#39;</span>
</span><span id="get_macos_theme-1169"><a href="#get_macos_theme-1169"><span class="linenos">1169</span></a>        <span class="k">return</span> <span class="s2">&quot;none&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Determine the display theme for a macOS computer using AppleScript.</p>

<p>Returns:</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>'light', 'dark', or 'none' based on the current display theme.</p>
</blockquote>

<p>Example:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">get_macos_theme</span><span class="p">()</span>
<span class="go">&#39;dark&#39;</span>
</code></pre>
</div>
</div>


                </section>
                <section id="create_deviation_dataframe">
                            <input id="create_deviation_dataframe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_deviation_dataframe</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">disulfide_list</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="create_deviation_dataframe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_deviation_dataframe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_deviation_dataframe-1175"><a href="#create_deviation_dataframe-1175"><span class="linenos">1175</span></a><span class="k">def</span> <span class="nf">create_deviation_dataframe</span><span class="p">(</span><span class="n">disulfide_list</span><span class="p">):</span>
</span><span id="create_deviation_dataframe-1176"><a href="#create_deviation_dataframe-1176"><span class="linenos">1176</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_deviation_dataframe-1177"><a href="#create_deviation_dataframe-1177"><span class="linenos">1177</span></a><span class="sd">    Create a DataFrame with columns PDB_ID, SS_Name, Angle_Deviation, Distance_Deviation, Ca Distance</span>
</span><span id="create_deviation_dataframe-1178"><a href="#create_deviation_dataframe-1178"><span class="linenos">1178</span></a><span class="sd">    from a list of disulfides.</span>
</span><span id="create_deviation_dataframe-1179"><a href="#create_deviation_dataframe-1179"><span class="linenos">1179</span></a>
</span><span id="create_deviation_dataframe-1180"><a href="#create_deviation_dataframe-1180"><span class="linenos">1180</span></a><span class="sd">    :param disulfide_list: List of disulfide objects.</span>
</span><span id="create_deviation_dataframe-1181"><a href="#create_deviation_dataframe-1181"><span class="linenos">1181</span></a><span class="sd">    :type proteusPy.DisulfideList: list</span>
</span><span id="create_deviation_dataframe-1182"><a href="#create_deviation_dataframe-1182"><span class="linenos">1182</span></a><span class="sd">    :return: DataFrame containing the disulfide information.</span>
</span><span id="create_deviation_dataframe-1183"><a href="#create_deviation_dataframe-1183"><span class="linenos">1183</span></a><span class="sd">    :rtype: pd.DataFrame</span>
</span><span id="create_deviation_dataframe-1184"><a href="#create_deviation_dataframe-1184"><span class="linenos">1184</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="create_deviation_dataframe-1185"><a href="#create_deviation_dataframe-1185"><span class="linenos">1185</span></a>    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="create_deviation_dataframe-1186"><a href="#create_deviation_dataframe-1186"><span class="linenos">1186</span></a>        <span class="s2">&quot;PDB_ID&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="create_deviation_dataframe-1187"><a href="#create_deviation_dataframe-1187"><span class="linenos">1187</span></a>        <span class="s2">&quot;Resolution&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="create_deviation_dataframe-1188"><a href="#create_deviation_dataframe-1188"><span class="linenos">1188</span></a>        <span class="s2">&quot;SS_Name&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="create_deviation_dataframe-1189"><a href="#create_deviation_dataframe-1189"><span class="linenos">1189</span></a>        <span class="s2">&quot;Angle_Deviation&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="create_deviation_dataframe-1190"><a href="#create_deviation_dataframe-1190"><span class="linenos">1190</span></a>        <span class="s2">&quot;Bondlength_Deviation&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="create_deviation_dataframe-1191"><a href="#create_deviation_dataframe-1191"><span class="linenos">1191</span></a>        <span class="s2">&quot;Ca_Distance&quot;</span><span class="p">:</span> <span class="p">[],</span>
</span><span id="create_deviation_dataframe-1192"><a href="#create_deviation_dataframe-1192"><span class="linenos">1192</span></a>    <span class="p">}</span>
</span><span id="create_deviation_dataframe-1193"><a href="#create_deviation_dataframe-1193"><span class="linenos">1193</span></a>
</span><span id="create_deviation_dataframe-1194"><a href="#create_deviation_dataframe-1194"><span class="linenos">1194</span></a>    <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">disulfide_list</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Processing...&quot;</span><span class="p">):</span>
</span><span id="create_deviation_dataframe-1195"><a href="#create_deviation_dataframe-1195"><span class="linenos">1195</span></a>        <span class="n">pdb_id</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">pdb_id</span>
</span><span id="create_deviation_dataframe-1196"><a href="#create_deviation_dataframe-1196"><span class="linenos">1196</span></a>        <span class="n">resolution</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="create_deviation_dataframe-1197"><a href="#create_deviation_dataframe-1197"><span class="linenos">1197</span></a>        <span class="n">ca_distance</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">ca_distance</span>
</span><span id="create_deviation_dataframe-1198"><a href="#create_deviation_dataframe-1198"><span class="linenos">1198</span></a>        <span class="n">angle_deviation</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">bond_angle_ideality</span>
</span><span id="create_deviation_dataframe-1199"><a href="#create_deviation_dataframe-1199"><span class="linenos">1199</span></a>        <span class="n">distance_deviation</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">bond_length_ideality</span>
</span><span id="create_deviation_dataframe-1200"><a href="#create_deviation_dataframe-1200"><span class="linenos">1200</span></a>
</span><span id="create_deviation_dataframe-1201"><a href="#create_deviation_dataframe-1201"><span class="linenos">1201</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;PDB_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">)</span>
</span><span id="create_deviation_dataframe-1202"><a href="#create_deviation_dataframe-1202"><span class="linenos">1202</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Resolution&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>
</span><span id="create_deviation_dataframe-1203"><a href="#create_deviation_dataframe-1203"><span class="linenos">1203</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;SS_Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="create_deviation_dataframe-1204"><a href="#create_deviation_dataframe-1204"><span class="linenos">1204</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Angle_Deviation&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle_deviation</span><span class="p">)</span>
</span><span id="create_deviation_dataframe-1205"><a href="#create_deviation_dataframe-1205"><span class="linenos">1205</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Bondlength_Deviation&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">distance_deviation</span><span class="p">)</span>
</span><span id="create_deviation_dataframe-1206"><a href="#create_deviation_dataframe-1206"><span class="linenos">1206</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Ca_Distance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ca_distance</span><span class="p">)</span>
</span><span id="create_deviation_dataframe-1207"><a href="#create_deviation_dataframe-1207"><span class="linenos">1207</span></a>
</span><span id="create_deviation_dataframe-1208"><a href="#create_deviation_dataframe-1208"><span class="linenos">1208</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="create_deviation_dataframe-1209"><a href="#create_deviation_dataframe-1209"><span class="linenos">1209</span></a>    <span class="k">return</span> <span class="n">df</span>
</span></pre></div>


            <div class="docstring"><p>Create a DataFrame with columns PDB_ID, SS_Name, Angle_Deviation, Distance_Deviation, Ca Distance
from a list of disulfides.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>disulfide_list</strong>:  List of disulfide objects.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>DataFrame containing the disulfide information.</p>
</blockquote>
</div>


                </section>
                <section id="calculate_std_cutoff">
                            <input id="calculate_std_cutoff-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calculate_std_cutoff</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">df</span>, </span><span class="param"><span class="n">column</span>, </span><span class="param"><span class="n">num_std</span><span class="o">=</span><span class="mi">2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="calculate_std_cutoff-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#calculate_std_cutoff"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="calculate_std_cutoff-1212"><a href="#calculate_std_cutoff-1212"><span class="linenos">1212</span></a><span class="k">def</span> <span class="nf">calculate_std_cutoff</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">num_std</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</span><span id="calculate_std_cutoff-1213"><a href="#calculate_std_cutoff-1213"><span class="linenos">1213</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="calculate_std_cutoff-1214"><a href="#calculate_std_cutoff-1214"><span class="linenos">1214</span></a><span class="sd">    Calculate cutoff based on standard deviation.</span>
</span><span id="calculate_std_cutoff-1215"><a href="#calculate_std_cutoff-1215"><span class="linenos">1215</span></a>
</span><span id="calculate_std_cutoff-1216"><a href="#calculate_std_cutoff-1216"><span class="linenos">1216</span></a><span class="sd">    :param df: DataFrame containing the deviations.</span>
</span><span id="calculate_std_cutoff-1217"><a href="#calculate_std_cutoff-1217"><span class="linenos">1217</span></a><span class="sd">    :type df: pd.DataFrame</span>
</span><span id="calculate_std_cutoff-1218"><a href="#calculate_std_cutoff-1218"><span class="linenos">1218</span></a><span class="sd">    :param column: Column name for which to calculate the cutoff.</span>
</span><span id="calculate_std_cutoff-1219"><a href="#calculate_std_cutoff-1219"><span class="linenos">1219</span></a><span class="sd">    :type column: str</span>
</span><span id="calculate_std_cutoff-1220"><a href="#calculate_std_cutoff-1220"><span class="linenos">1220</span></a><span class="sd">    :param num_std: Number of standard deviations to use for the cutoff.</span>
</span><span id="calculate_std_cutoff-1221"><a href="#calculate_std_cutoff-1221"><span class="linenos">1221</span></a><span class="sd">    :type num_std: int</span>
</span><span id="calculate_std_cutoff-1222"><a href="#calculate_std_cutoff-1222"><span class="linenos">1222</span></a><span class="sd">    :return: Cutoff value.</span>
</span><span id="calculate_std_cutoff-1223"><a href="#calculate_std_cutoff-1223"><span class="linenos">1223</span></a><span class="sd">    :rtype: float</span>
</span><span id="calculate_std_cutoff-1224"><a href="#calculate_std_cutoff-1224"><span class="linenos">1224</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="calculate_std_cutoff-1225"><a href="#calculate_std_cutoff-1225"><span class="linenos">1225</span></a>    <span class="n">mean</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span id="calculate_std_cutoff-1226"><a href="#calculate_std_cutoff-1226"><span class="linenos">1226</span></a>    <span class="n">std</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</span><span id="calculate_std_cutoff-1227"><a href="#calculate_std_cutoff-1227"><span class="linenos">1227</span></a>    <span class="n">cutoff</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">num_std</span> <span class="o">*</span> <span class="n">std</span>
</span><span id="calculate_std_cutoff-1228"><a href="#calculate_std_cutoff-1228"><span class="linenos">1228</span></a>    <span class="k">return</span> <span class="n">cutoff</span>
</span></pre></div>


            <div class="docstring"><p>Calculate cutoff based on standard deviation.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>df</strong>:  DataFrame containing the deviations.</li>
<li><strong>column</strong>:  Column name for which to calculate the cutoff.</li>
<li><strong>num_std</strong>:  Number of standard deviations to use for the cutoff.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Cutoff value.</p>
</blockquote>
</div>


                </section>
                <section id="calculate_percentile_cutoff">
                            <input id="calculate_percentile_cutoff-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calculate_percentile_cutoff</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">df</span>, </span><span class="param"><span class="n">column</span>, </span><span class="param"><span class="n">percentile</span><span class="o">=</span><span class="mi">95</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="calculate_percentile_cutoff-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#calculate_percentile_cutoff"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="calculate_percentile_cutoff-1231"><a href="#calculate_percentile_cutoff-1231"><span class="linenos">1231</span></a><span class="k">def</span> <span class="nf">calculate_percentile_cutoff</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="mi">95</span><span class="p">):</span>
</span><span id="calculate_percentile_cutoff-1232"><a href="#calculate_percentile_cutoff-1232"><span class="linenos">1232</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="calculate_percentile_cutoff-1233"><a href="#calculate_percentile_cutoff-1233"><span class="linenos">1233</span></a><span class="sd">    Calculate cutoff based on percentile.</span>
</span><span id="calculate_percentile_cutoff-1234"><a href="#calculate_percentile_cutoff-1234"><span class="linenos">1234</span></a>
</span><span id="calculate_percentile_cutoff-1235"><a href="#calculate_percentile_cutoff-1235"><span class="linenos">1235</span></a><span class="sd">    :param df: DataFrame containing the deviations.</span>
</span><span id="calculate_percentile_cutoff-1236"><a href="#calculate_percentile_cutoff-1236"><span class="linenos">1236</span></a><span class="sd">    :type df: pd.DataFrame</span>
</span><span id="calculate_percentile_cutoff-1237"><a href="#calculate_percentile_cutoff-1237"><span class="linenos">1237</span></a><span class="sd">    :param column: Column name for which to calculate the cutoff.</span>
</span><span id="calculate_percentile_cutoff-1238"><a href="#calculate_percentile_cutoff-1238"><span class="linenos">1238</span></a><span class="sd">    :type column: str</span>
</span><span id="calculate_percentile_cutoff-1239"><a href="#calculate_percentile_cutoff-1239"><span class="linenos">1239</span></a><span class="sd">    :param percentile: Percentile to use for the cutoff.</span>
</span><span id="calculate_percentile_cutoff-1240"><a href="#calculate_percentile_cutoff-1240"><span class="linenos">1240</span></a><span class="sd">    :type percentile: int</span>
</span><span id="calculate_percentile_cutoff-1241"><a href="#calculate_percentile_cutoff-1241"><span class="linenos">1241</span></a><span class="sd">    :return: Cutoff value.</span>
</span><span id="calculate_percentile_cutoff-1242"><a href="#calculate_percentile_cutoff-1242"><span class="linenos">1242</span></a><span class="sd">    :rtype: float</span>
</span><span id="calculate_percentile_cutoff-1243"><a href="#calculate_percentile_cutoff-1243"><span class="linenos">1243</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="calculate_percentile_cutoff-1244"><a href="#calculate_percentile_cutoff-1244"><span class="linenos">1244</span></a>    <span class="n">cutoff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">percentile</span><span class="p">)</span>
</span><span id="calculate_percentile_cutoff-1245"><a href="#calculate_percentile_cutoff-1245"><span class="linenos">1245</span></a>    <span class="k">return</span> <span class="n">cutoff</span>
</span></pre></div>


            <div class="docstring"><p>Calculate cutoff based on percentile.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>df</strong>:  DataFrame containing the deviations.</li>
<li><strong>column</strong>:  Column name for which to calculate the cutoff.</li>
<li><strong>percentile</strong>:  Percentile to use for the cutoff.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Cutoff value.</p>
</blockquote>
</div>


                </section>
                <section id="filter_by_cutoffs">
                            <input id="filter_by_cutoffs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_by_cutoffs</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">df</span>,</span><span class="param">	<span class="n">length_cutoff</span><span class="o">=</span><span class="mf">1.0</span>,</span><span class="param">	<span class="n">angle_cutoff</span><span class="o">=</span><span class="mf">1.0</span>,</span><span class="param">	<span class="n">ca_cutoff</span><span class="o">=</span><span class="mf">8.0</span>,</span><span class="param">	<span class="n">minimum_distance</span><span class="o">=</span><span class="mf">2.0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="filter_by_cutoffs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#filter_by_cutoffs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="filter_by_cutoffs-1248"><a href="#filter_by_cutoffs-1248"><span class="linenos">1248</span></a><span class="k">def</span> <span class="nf">filter_by_cutoffs</span><span class="p">(</span>
</span><span id="filter_by_cutoffs-1249"><a href="#filter_by_cutoffs-1249"><span class="linenos">1249</span></a>    <span class="n">df</span><span class="p">,</span> <span class="n">length_cutoff</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">angle_cutoff</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ca_cutoff</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">minimum_distance</span><span class="o">=</span><span class="mf">2.0</span>
</span><span id="filter_by_cutoffs-1250"><a href="#filter_by_cutoffs-1250"><span class="linenos">1250</span></a><span class="p">):</span>
</span><span id="filter_by_cutoffs-1251"><a href="#filter_by_cutoffs-1251"><span class="linenos">1251</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="filter_by_cutoffs-1252"><a href="#filter_by_cutoffs-1252"><span class="linenos">1252</span></a><span class="sd">    Filter the DataFrame based on distance, angle, and Ca distance cutoffs. Ca cutoff</span>
</span><span id="filter_by_cutoffs-1253"><a href="#filter_by_cutoffs-1253"><span class="linenos">1253</span></a><span class="sd">    dominates the filter and will override the distance and angle cutoffs. Note: The</span>
</span><span id="filter_by_cutoffs-1254"><a href="#filter_by_cutoffs-1254"><span class="linenos">1254</span></a><span class="sd">    filter is applied if the Ca distance is less than or equal to 2.0 Angstroms, since</span>
</span><span id="filter_by_cutoffs-1255"><a href="#filter_by_cutoffs-1255"><span class="linenos">1255</span></a><span class="sd">    this is physically impossible.</span>
</span><span id="filter_by_cutoffs-1256"><a href="#filter_by_cutoffs-1256"><span class="linenos">1256</span></a>
</span><span id="filter_by_cutoffs-1257"><a href="#filter_by_cutoffs-1257"><span class="linenos">1257</span></a><span class="sd">    :param df: DataFrame containing the deviations.</span>
</span><span id="filter_by_cutoffs-1258"><a href="#filter_by_cutoffs-1258"><span class="linenos">1258</span></a><span class="sd">    :type df: pd.DataFrame</span>
</span><span id="filter_by_cutoffs-1259"><a href="#filter_by_cutoffs-1259"><span class="linenos">1259</span></a><span class="sd">    :param length_cutoff: Cutoff value for Bond Length Deviation.</span>
</span><span id="filter_by_cutoffs-1260"><a href="#filter_by_cutoffs-1260"><span class="linenos">1260</span></a><span class="sd">    :type distance_cutoff: float</span>
</span><span id="filter_by_cutoffs-1261"><a href="#filter_by_cutoffs-1261"><span class="linenos">1261</span></a><span class="sd">    :param angle_cutoff: Cutoff value for angle deviation.</span>
</span><span id="filter_by_cutoffs-1262"><a href="#filter_by_cutoffs-1262"><span class="linenos">1262</span></a><span class="sd">    :type angle_cutoff: float</span>
</span><span id="filter_by_cutoffs-1263"><a href="#filter_by_cutoffs-1263"><span class="linenos">1263</span></a><span class="sd">    :param ca_cutoff: Cutoff value for Ca distance.</span>
</span><span id="filter_by_cutoffs-1264"><a href="#filter_by_cutoffs-1264"><span class="linenos">1264</span></a><span class="sd">    :type ca_cutoff: float</span>
</span><span id="filter_by_cutoffs-1265"><a href="#filter_by_cutoffs-1265"><span class="linenos">1265</span></a><span class="sd">    :return: Filtered DataFrame.</span>
</span><span id="filter_by_cutoffs-1266"><a href="#filter_by_cutoffs-1266"><span class="linenos">1266</span></a><span class="sd">    :rtype: pd.DataFrame</span>
</span><span id="filter_by_cutoffs-1267"><a href="#filter_by_cutoffs-1267"><span class="linenos">1267</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="filter_by_cutoffs-1268"><a href="#filter_by_cutoffs-1268"><span class="linenos">1268</span></a>    <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>
</span><span id="filter_by_cutoffs-1269"><a href="#filter_by_cutoffs-1269"><span class="linenos">1269</span></a>        <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Bondlength_Deviation&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">length_cutoff</span><span class="p">)</span>
</span><span id="filter_by_cutoffs-1270"><a href="#filter_by_cutoffs-1270"><span class="linenos">1270</span></a>        <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Angle_Deviation&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">angle_cutoff</span><span class="p">)</span>
</span><span id="filter_by_cutoffs-1271"><a href="#filter_by_cutoffs-1271"><span class="linenos">1271</span></a>        <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Ca_Distance&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">minimum_distance</span><span class="p">)</span>
</span><span id="filter_by_cutoffs-1272"><a href="#filter_by_cutoffs-1272"><span class="linenos">1272</span></a>        <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Ca_Distance&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">ca_cutoff</span><span class="p">)</span>
</span><span id="filter_by_cutoffs-1273"><a href="#filter_by_cutoffs-1273"><span class="linenos">1273</span></a>    <span class="p">]</span>
</span><span id="filter_by_cutoffs-1274"><a href="#filter_by_cutoffs-1274"><span class="linenos">1274</span></a>    <span class="k">return</span> <span class="n">filtered_df</span>
</span></pre></div>


            <div class="docstring"><p>Filter the DataFrame based on distance, angle, and Ca distance cutoffs. Ca cutoff
dominates the filter and will override the distance and angle cutoffs. Note: The
filter is applied if the Ca distance is less than or equal to 2.0 Angstroms, since
this is physically impossible.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>df</strong>:  DataFrame containing the deviations.</li>
<li><strong>length_cutoff</strong>:  Cutoff value for Bond Length Deviation.</li>
<li><strong>angle_cutoff</strong>:  Cutoff value for angle deviation.</li>
<li><strong>ca_cutoff</strong>:  Cutoff value for Ca distance.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Filtered DataFrame.</p>
</blockquote>
</div>


                </section>
                <section id="bad_filter_by_cutoffs">
                            <input id="bad_filter_by_cutoffs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">bad_filter_by_cutoffs</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">df</span>,</span><span class="param">	<span class="n">distance_cutoff</span><span class="o">=</span><span class="mf">1.0</span>,</span><span class="param">	<span class="n">angle_cutoff</span><span class="o">=</span><span class="mf">1.0</span>,</span><span class="param">	<span class="n">ca_cutoff</span><span class="o">=</span><span class="mf">8.0</span>,</span><span class="param">	<span class="n">minimum_distance</span><span class="o">=</span><span class="mf">2.0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="bad_filter_by_cutoffs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#bad_filter_by_cutoffs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="bad_filter_by_cutoffs-1277"><a href="#bad_filter_by_cutoffs-1277"><span class="linenos">1277</span></a><span class="k">def</span> <span class="nf">bad_filter_by_cutoffs</span><span class="p">(</span>
</span><span id="bad_filter_by_cutoffs-1278"><a href="#bad_filter_by_cutoffs-1278"><span class="linenos">1278</span></a>    <span class="n">df</span><span class="p">,</span> <span class="n">distance_cutoff</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">angle_cutoff</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ca_cutoff</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">minimum_distance</span><span class="o">=</span><span class="mf">2.0</span>
</span><span id="bad_filter_by_cutoffs-1279"><a href="#bad_filter_by_cutoffs-1279"><span class="linenos">1279</span></a><span class="p">):</span>
</span><span id="bad_filter_by_cutoffs-1280"><a href="#bad_filter_by_cutoffs-1280"><span class="linenos">1280</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="bad_filter_by_cutoffs-1281"><a href="#bad_filter_by_cutoffs-1281"><span class="linenos">1281</span></a><span class="sd">    Return the DataFrame objects that are GREATER than the cutoff based on distance,</span>
</span><span id="bad_filter_by_cutoffs-1282"><a href="#bad_filter_by_cutoffs-1282"><span class="linenos">1282</span></a><span class="sd">    angle, and Ca distance cutoffs. Used to get the bad structures. Ca cutoff</span>
</span><span id="bad_filter_by_cutoffs-1283"><a href="#bad_filter_by_cutoffs-1283"><span class="linenos">1283</span></a><span class="sd">    dominates the filter and will override the distance and angle cutoffs.</span>
</span><span id="bad_filter_by_cutoffs-1284"><a href="#bad_filter_by_cutoffs-1284"><span class="linenos">1284</span></a>
</span><span id="bad_filter_by_cutoffs-1285"><a href="#bad_filter_by_cutoffs-1285"><span class="linenos">1285</span></a><span class="sd">    :param df: DataFrame containing the deviations.</span>
</span><span id="bad_filter_by_cutoffs-1286"><a href="#bad_filter_by_cutoffs-1286"><span class="linenos">1286</span></a><span class="sd">    :type df: pd.DataFrame</span>
</span><span id="bad_filter_by_cutoffs-1287"><a href="#bad_filter_by_cutoffs-1287"><span class="linenos">1287</span></a><span class="sd">    :param distance_cutoff: Cutoff value for Bond Length Deviation.</span>
</span><span id="bad_filter_by_cutoffs-1288"><a href="#bad_filter_by_cutoffs-1288"><span class="linenos">1288</span></a><span class="sd">    :type distance_cutoff: float</span>
</span><span id="bad_filter_by_cutoffs-1289"><a href="#bad_filter_by_cutoffs-1289"><span class="linenos">1289</span></a><span class="sd">    :param angle_cutoff: Cutoff value for angle deviation.</span>
</span><span id="bad_filter_by_cutoffs-1290"><a href="#bad_filter_by_cutoffs-1290"><span class="linenos">1290</span></a><span class="sd">    :type angle_cutoff: float</span>
</span><span id="bad_filter_by_cutoffs-1291"><a href="#bad_filter_by_cutoffs-1291"><span class="linenos">1291</span></a><span class="sd">    :param ca_cutoff: Cutoff value for Ca distance.</span>
</span><span id="bad_filter_by_cutoffs-1292"><a href="#bad_filter_by_cutoffs-1292"><span class="linenos">1292</span></a><span class="sd">    :type ca_cutoff: float</span>
</span><span id="bad_filter_by_cutoffs-1293"><a href="#bad_filter_by_cutoffs-1293"><span class="linenos">1293</span></a><span class="sd">    :return: Filtered DataFrame.</span>
</span><span id="bad_filter_by_cutoffs-1294"><a href="#bad_filter_by_cutoffs-1294"><span class="linenos">1294</span></a><span class="sd">    :rtype: pd.DataFrame</span>
</span><span id="bad_filter_by_cutoffs-1295"><a href="#bad_filter_by_cutoffs-1295"><span class="linenos">1295</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="bad_filter_by_cutoffs-1296"><a href="#bad_filter_by_cutoffs-1296"><span class="linenos">1296</span></a>    <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>
</span><span id="bad_filter_by_cutoffs-1297"><a href="#bad_filter_by_cutoffs-1297"><span class="linenos">1297</span></a>        <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Bondlength_Deviation&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">distance_cutoff</span><span class="p">)</span>
</span><span id="bad_filter_by_cutoffs-1298"><a href="#bad_filter_by_cutoffs-1298"><span class="linenos">1298</span></a>        <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Angle_Deviation&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">angle_cutoff</span><span class="p">)</span>
</span><span id="bad_filter_by_cutoffs-1299"><a href="#bad_filter_by_cutoffs-1299"><span class="linenos">1299</span></a>        <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Ca_Distance&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">ca_cutoff</span><span class="p">)</span>
</span><span id="bad_filter_by_cutoffs-1300"><a href="#bad_filter_by_cutoffs-1300"><span class="linenos">1300</span></a>        <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Ca_Distance&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">minimum_distance</span><span class="p">)</span>
</span><span id="bad_filter_by_cutoffs-1301"><a href="#bad_filter_by_cutoffs-1301"><span class="linenos">1301</span></a>    <span class="p">]</span>
</span><span id="bad_filter_by_cutoffs-1302"><a href="#bad_filter_by_cutoffs-1302"><span class="linenos">1302</span></a>    <span class="k">return</span> <span class="n">filtered_df</span>
</span></pre></div>


            <div class="docstring"><p>Return the DataFrame objects that are GREATER than the cutoff based on distance,
angle, and Ca distance cutoffs. Used to get the bad structures. Ca cutoff
dominates the filter and will override the distance and angle cutoffs.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>df</strong>:  DataFrame containing the deviations.</li>
<li><strong>distance_cutoff</strong>:  Cutoff value for Bond Length Deviation.</li>
<li><strong>angle_cutoff</strong>:  Cutoff value for angle deviation.</li>
<li><strong>ca_cutoff</strong>:  Cutoff value for Ca distance.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Filtered DataFrame.</p>
</blockquote>
</div>


                </section>
                <section id="save_list_to_file">
                            <input id="save_list_to_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save_list_to_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">input_list</span>, </span><span class="param"><span class="n">filename</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="save_list_to_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#save_list_to_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="save_list_to_file-1305"><a href="#save_list_to_file-1305"><span class="linenos">1305</span></a><span class="k">def</span> <span class="nf">save_list_to_file</span><span class="p">(</span><span class="n">input_list</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="save_list_to_file-1306"><a href="#save_list_to_file-1306"><span class="linenos">1306</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="save_list_to_file-1307"><a href="#save_list_to_file-1307"><span class="linenos">1307</span></a><span class="sd">    Save the input list to a file using pickle.</span>
</span><span id="save_list_to_file-1308"><a href="#save_list_to_file-1308"><span class="linenos">1308</span></a>
</span><span id="save_list_to_file-1309"><a href="#save_list_to_file-1309"><span class="linenos">1309</span></a><span class="sd">    :param input_list: List to be saved.</span>
</span><span id="save_list_to_file-1310"><a href="#save_list_to_file-1310"><span class="linenos">1310</span></a><span class="sd">    :type input_list: list</span>
</span><span id="save_list_to_file-1311"><a href="#save_list_to_file-1311"><span class="linenos">1311</span></a><span class="sd">    :param filename: Name of the file where the list will be saved.</span>
</span><span id="save_list_to_file-1312"><a href="#save_list_to_file-1312"><span class="linenos">1312</span></a><span class="sd">    :type filename: str</span>
</span><span id="save_list_to_file-1313"><a href="#save_list_to_file-1313"><span class="linenos">1313</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="save_list_to_file-1314"><a href="#save_list_to_file-1314"><span class="linenos">1314</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="save_list_to_file-1315"><a href="#save_list_to_file-1315"><span class="linenos">1315</span></a>        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">input_list</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Save the input list to a file using pickle.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>input_list</strong>:  List to be saved.</li>
<li><strong>filename</strong>:  Name of the file where the list will be saved.</li>
</ul>
</div>


                </section>
                <section id="load_list_from_file">
                            <input id="load_list_from_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_list_from_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">filename</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="load_list_from_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#load_list_from_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="load_list_from_file-1318"><a href="#load_list_from_file-1318"><span class="linenos">1318</span></a><span class="k">def</span> <span class="nf">load_list_from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
</span><span id="load_list_from_file-1319"><a href="#load_list_from_file-1319"><span class="linenos">1319</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="load_list_from_file-1320"><a href="#load_list_from_file-1320"><span class="linenos">1320</span></a><span class="sd">    Load a list from a file using pickle.</span>
</span><span id="load_list_from_file-1321"><a href="#load_list_from_file-1321"><span class="linenos">1321</span></a>
</span><span id="load_list_from_file-1322"><a href="#load_list_from_file-1322"><span class="linenos">1322</span></a><span class="sd">    This function reads a list from a file that was previously saved using the pickle module.</span>
</span><span id="load_list_from_file-1323"><a href="#load_list_from_file-1323"><span class="linenos">1323</span></a>
</span><span id="load_list_from_file-1324"><a href="#load_list_from_file-1324"><span class="linenos">1324</span></a><span class="sd">    :param filename: Name of the file from which the list will be loaded.</span>
</span><span id="load_list_from_file-1325"><a href="#load_list_from_file-1325"><span class="linenos">1325</span></a><span class="sd">    :type filename: str</span>
</span><span id="load_list_from_file-1326"><a href="#load_list_from_file-1326"><span class="linenos">1326</span></a><span class="sd">    :return: The list that was loaded from the file.</span>
</span><span id="load_list_from_file-1327"><a href="#load_list_from_file-1327"><span class="linenos">1327</span></a><span class="sd">    :rtype: list</span>
</span><span id="load_list_from_file-1328"><a href="#load_list_from_file-1328"><span class="linenos">1328</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="load_list_from_file-1329"><a href="#load_list_from_file-1329"><span class="linenos">1329</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="load_list_from_file-1330"><a href="#load_list_from_file-1330"><span class="linenos">1330</span></a>        <span class="n">loaded_list</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span><span id="load_list_from_file-1331"><a href="#load_list_from_file-1331"><span class="linenos">1331</span></a>    <span class="k">return</span> <span class="n">loaded_list</span>
</span></pre></div>


            <div class="docstring"><p>Load a list from a file using pickle.</p>

<p>This function reads a list from a file that was previously saved using the pickle module.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>filename</strong>:  Name of the file from which the list will be loaded.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The list that was loaded from the file.</p>
</blockquote>
</div>


                </section>
                <section id="set_logger_level_for_module">
                            <input id="set_logger_level_for_module-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_logger_level_for_module</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">pkg_name</span>, </span><span class="param"><span class="n">level</span><span class="o">=</span><span class="s1">&#39;&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="set_logger_level_for_module-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#set_logger_level_for_module"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="set_logger_level_for_module-1334"><a href="#set_logger_level_for_module-1334"><span class="linenos">1334</span></a><span class="k">def</span> <span class="nf">set_logger_level_for_module</span><span class="p">(</span><span class="n">pkg_name</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
</span><span id="set_logger_level_for_module-1335"><a href="#set_logger_level_for_module-1335"><span class="linenos">1335</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="set_logger_level_for_module-1336"><a href="#set_logger_level_for_module-1336"><span class="linenos">1336</span></a><span class="sd">    Set the logging level for all loggers within a specified package.</span>
</span><span id="set_logger_level_for_module-1337"><a href="#set_logger_level_for_module-1337"><span class="linenos">1337</span></a>
</span><span id="set_logger_level_for_module-1338"><a href="#set_logger_level_for_module-1338"><span class="linenos">1338</span></a><span class="sd">    This function iterates through all registered loggers and sets the logging</span>
</span><span id="set_logger_level_for_module-1339"><a href="#set_logger_level_for_module-1339"><span class="linenos">1339</span></a><span class="sd">    level for those that belong to the specified package.</span>
</span><span id="set_logger_level_for_module-1340"><a href="#set_logger_level_for_module-1340"><span class="linenos">1340</span></a>
</span><span id="set_logger_level_for_module-1341"><a href="#set_logger_level_for_module-1341"><span class="linenos">1341</span></a><span class="sd">    :param pkg_name: The name of the package for which to set the logging level.</span>
</span><span id="set_logger_level_for_module-1342"><a href="#set_logger_level_for_module-1342"><span class="linenos">1342</span></a><span class="sd">    :type pkg_name: str</span>
</span><span id="set_logger_level_for_module-1343"><a href="#set_logger_level_for_module-1343"><span class="linenos">1343</span></a><span class="sd">    :param level: The logging level to set (e.g., &#39;DEBUG&#39;, &#39;INFO&#39;, &#39;WARNING&#39;, &#39;ERROR&#39;, &#39;CRITICAL&#39;).</span>
</span><span id="set_logger_level_for_module-1344"><a href="#set_logger_level_for_module-1344"><span class="linenos">1344</span></a><span class="sd">                  If not specified, the logging level will not be changed.</span>
</span><span id="set_logger_level_for_module-1345"><a href="#set_logger_level_for_module-1345"><span class="linenos">1345</span></a><span class="sd">    :type level: str, optional</span>
</span><span id="set_logger_level_for_module-1346"><a href="#set_logger_level_for_module-1346"><span class="linenos">1346</span></a><span class="sd">    :return: A list of logger names that were found and had their levels set.</span>
</span><span id="set_logger_level_for_module-1347"><a href="#set_logger_level_for_module-1347"><span class="linenos">1347</span></a><span class="sd">    :rtype: list</span>
</span><span id="set_logger_level_for_module-1348"><a href="#set_logger_level_for_module-1348"><span class="linenos">1348</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="set_logger_level_for_module-1349"><a href="#set_logger_level_for_module-1349"><span class="linenos">1349</span></a>    <span class="n">logger_dict</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">loggerDict</span>
</span><span id="set_logger_level_for_module-1350"><a href="#set_logger_level_for_module-1350"><span class="linenos">1350</span></a>    <span class="n">registered_loggers</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="set_logger_level_for_module-1351"><a href="#set_logger_level_for_module-1351"><span class="linenos">1351</span></a>        <span class="n">name</span>
</span><span id="set_logger_level_for_module-1352"><a href="#set_logger_level_for_module-1352"><span class="linenos">1352</span></a>        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">logger_dict</span>
</span><span id="set_logger_level_for_module-1353"><a href="#set_logger_level_for_module-1353"><span class="linenos">1353</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">logger_dict</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">)</span> <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">pkg_name</span><span class="p">)</span>
</span><span id="set_logger_level_for_module-1354"><a href="#set_logger_level_for_module-1354"><span class="linenos">1354</span></a>    <span class="p">]</span>
</span><span id="set_logger_level_for_module-1355"><a href="#set_logger_level_for_module-1355"><span class="linenos">1355</span></a>    <span class="k">for</span> <span class="n">logger_name</span> <span class="ow">in</span> <span class="n">registered_loggers</span><span class="p">:</span>
</span><span id="set_logger_level_for_module-1356"><a href="#set_logger_level_for_module-1356"><span class="linenos">1356</span></a>        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">logger_name</span><span class="p">)</span>
</span><span id="set_logger_level_for_module-1357"><a href="#set_logger_level_for_module-1357"><span class="linenos">1357</span></a>        <span class="k">if</span> <span class="n">level</span><span class="p">:</span>
</span><span id="set_logger_level_for_module-1358"><a href="#set_logger_level_for_module-1358"><span class="linenos">1358</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
</span><span id="set_logger_level_for_module-1359"><a href="#set_logger_level_for_module-1359"><span class="linenos">1359</span></a>
</span><span id="set_logger_level_for_module-1360"><a href="#set_logger_level_for_module-1360"><span class="linenos">1360</span></a>    <span class="k">return</span> <span class="n">registered_loggers</span>
</span></pre></div>


            <div class="docstring"><p>Set the logging level for all loggers within a specified package.</p>

<p>This function iterates through all registered loggers and sets the logging
level for those that belong to the specified package.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>pkg_name</strong>:  The name of the package for which to set the logging level.</li>
<li><strong>level</strong>:  The logging level to set (e.g., 'DEBUG', 'INFO', 'WARNING', 'ERROR', 'CRITICAL').
If not specified, the logging level will not be changed.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A list of logger names that were found and had their levels set.</p>
</blockquote>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>